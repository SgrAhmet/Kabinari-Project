/*! For license information please see main.8aaba493.js.LICENSE.txt */
(()=>{var e={446:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,r=36e5,n="millisecond",i="second",s="minute",a="hour",o="day",l="week",c="month",u="quarter",h="year",d="date",f="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||t[0])+"]"}},v=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},y={s:v,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),i=r%60;return(t<=0?"+":"-")+v(n,2,"0")+":"+v(i,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),i=t.clone().add(n,c),s=r-i<0,a=t.clone().add(n+(s?-1:1),c);return+(-(n+(r-i)/(s?i-a:a-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:h,w:l,d:o,D:d,h:a,m:s,s:i,ms:n,Q:u}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},b="en",w={};w[b]=g;var x="$isDayjsObject",S=function(e){return e instanceof A||!(!e||!e[x])},_=function e(t,r,n){var i;if(!t)return b;if("string"==typeof t){var s=t.toLowerCase();w[s]&&(i=s),r&&(w[s]=r,i=s);var a=t.split("-");if(!i&&a.length>1)return e(a[0])}else{var o=t.name;w[o]=t,i=o}return!n&&i&&(b=i),i||!n&&b},C=function(e,t){if(S(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new A(r)},E=y;E.l=_,E.i=S,E.w=function(e,t){return C(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var A=function(){function g(e){this.$L=_(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[x]=!0}var v=g.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(E.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(p);if(n){var i=n[2]-1||0,s=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,s)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,s)}}return new Date(t)}(e),this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return E},v.isValid=function(){return!(this.$d.toString()===f)},v.isSame=function(e,t){var r=C(e);return this.startOf(t)<=r&&r<=this.endOf(t)},v.isAfter=function(e,t){return C(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<C(e)},v.$g=function(e,t,r){return E.u(e)?this[t]:this.set(r,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var r=this,n=!!E.u(t)||t,u=E.p(e),f=function(e,t){var i=E.w(r.$u?Date.UTC(r.$y,t,e):new Date(r.$y,t,e),r);return n?i:i.endOf(o)},p=function(e,t){return E.w(r.toDate()[e].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),r)},m=this.$W,g=this.$M,v=this.$D,y="set"+(this.$u?"UTC":"");switch(u){case h:return n?f(1,0):f(31,11);case c:return n?f(1,g):f(0,g+1);case l:var b=this.$locale().weekStart||0,w=(m<b?m+7:m)-b;return f(n?v-w:v+(6-w),g);case o:case d:return p(y+"Hours",0);case a:return p(y+"Minutes",1);case s:return p(y+"Seconds",2);case i:return p(y+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var r,l=E.p(e),u="set"+(this.$u?"UTC":""),f=(r={},r[o]=u+"Date",r[d]=u+"Date",r[c]=u+"Month",r[h]=u+"FullYear",r[a]=u+"Hours",r[s]=u+"Minutes",r[i]=u+"Seconds",r[n]=u+"Milliseconds",r)[l],p=l===o?this.$D+(t-this.$W):t;if(l===c||l===h){var m=this.clone().set(d,1);m.$d[f](p),m.init(),this.$d=m.set(d,Math.min(this.$D,m.daysInMonth())).$d}else f&&this.$d[f](p);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[E.p(e)]()},v.add=function(n,u){var d,f=this;n=Number(n);var p=E.p(u),m=function(e){var t=C(f);return E.w(t.date(t.date()+Math.round(e*n)),f)};if(p===c)return this.set(c,this.$M+n);if(p===h)return this.set(h,this.$y+n);if(p===o)return m(1);if(p===l)return m(7);var g=(d={},d[s]=t,d[a]=r,d[i]=e,d)[p]||1,v=this.$d.getTime()+n*g;return E.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||f;var n=e||"YYYY-MM-DDTHH:mm:ssZ",i=E.z(this),s=this.$H,a=this.$m,o=this.$M,l=r.weekdays,c=r.months,u=r.meridiem,h=function(e,r,i,s){return e&&(e[r]||e(t,n))||i[r].slice(0,s)},d=function(e){return E.s(s%12||12,e,"0")},p=u||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(m,(function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return E.s(t.$y,4,"0");case"M":return o+1;case"MM":return E.s(o+1,2,"0");case"MMM":return h(r.monthsShort,o,c,3);case"MMMM":return h(c,o);case"D":return t.$D;case"DD":return E.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return h(r.weekdaysMin,t.$W,l,2);case"ddd":return h(r.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(s);case"HH":return E.s(s,2,"0");case"h":return d(1);case"hh":return d(2);case"a":return p(s,a,!0);case"A":return p(s,a,!1);case"m":return String(a);case"mm":return E.s(a,2,"0");case"s":return String(t.$s);case"ss":return E.s(t.$s,2,"0");case"SSS":return E.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(n,d,f){var p,m=this,g=E.p(d),v=C(n),y=(v.utcOffset()-this.utcOffset())*t,b=this-v,w=function(){return E.m(m,v)};switch(g){case h:p=w()/12;break;case c:p=w();break;case u:p=w()/3;break;case l:p=(b-y)/6048e5;break;case o:p=(b-y)/864e5;break;case a:p=b/r;break;case s:p=b/t;break;case i:p=b/e;break;default:p=b}return f?p:E.a(p)},v.daysInMonth=function(){return this.endOf(c).$D},v.$locale=function(){return w[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=_(e,t,!0);return n&&(r.$L=n),r},v.clone=function(){return E.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},g}(),M=A.prototype;return C.prototype=M,[["$ms",n],["$s",i],["$m",s],["$H",a],["$W",o],["$M",c],["$y",h],["$D",d]].forEach((function(e){M[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),C.extend=function(e,t){return e.$i||(e(t,A,C),e.$i=!0),C},C.locale=_,C.isDayjs=S,C.unix=function(e){return C(1e3*e)},C.en=w[b],C.Ls=w,C.p={},C}()},76:function(e){e.exports=function(){"use strict";return function(e,t){var r=t.prototype,n=r.format;r.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return n.bind(this)(e);var i=this.$utils(),s=(e||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,(function(e){switch(e){case"Q":return Math.ceil((t.$M+1)/3);case"Do":return r.ordinal(t.$D);case"gggg":return t.weekYear();case"GGGG":return t.isoWeekYear();case"wo":return r.ordinal(t.week(),"W");case"w":case"ww":return i.s(t.week(),"w"===e?1:2,"0");case"W":case"WW":return i.s(t.isoWeek(),"W"===e?1:2,"0");case"k":case"kk":return i.s(String(0===t.$H?24:t.$H),"k"===e?1:2,"0");case"X":return Math.floor(t.$d.getTime()/1e3);case"x":return t.$d.getTime();case"z":return"["+t.offsetName()+"]";case"zzz":return"["+t.offsetName("long")+"]";default:return e}}));return n.bind(this)(s)}}}()},988:function(e){e.exports=function(){"use strict";var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d/,n=/\d\d/,i=/\d\d?/,s=/\d*[^-_:/,()\s\d]+/,a={},o=function(e){return(e=+e)+(e>68?1900:2e3)},l=function(e){return function(t){this[e]=+t}},c=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e)return 0;if("Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),r=60*t[1]+(+t[2]||0);return 0===r?0:"+"===t[0]?-r:r}(e)}],u=function(e){var t=a[e];return t&&(t.indexOf?t:t.s.concat(t.f))},h=function(e,t){var r,n=a.meridiem;if(n){for(var i=1;i<=24;i+=1)if(e.indexOf(n(i,0,t))>-1){r=i>12;break}}else r=e===(t?"pm":"PM");return r},d={A:[s,function(e){this.afternoon=h(e,!1)}],a:[s,function(e){this.afternoon=h(e,!0)}],Q:[r,function(e){this.month=3*(e-1)+1}],S:[r,function(e){this.milliseconds=100*+e}],SS:[n,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[i,l("seconds")],ss:[i,l("seconds")],m:[i,l("minutes")],mm:[i,l("minutes")],H:[i,l("hours")],h:[i,l("hours")],HH:[i,l("hours")],hh:[i,l("hours")],D:[i,l("day")],DD:[n,l("day")],Do:[s,function(e){var t=a.ordinal,r=e.match(/\d+/);if(this.day=r[0],t)for(var n=1;n<=31;n+=1)t(n).replace(/\[|\]/g,"")===e&&(this.day=n)}],w:[i,l("week")],ww:[n,l("week")],M:[i,l("month")],MM:[n,l("month")],MMM:[s,function(e){var t=u("months"),r=(u("monthsShort")||t.map((function(e){return e.slice(0,3)}))).indexOf(e)+1;if(r<1)throw new Error;this.month=r%12||r}],MMMM:[s,function(e){var t=u("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,l("year")],YY:[n,function(e){this.year=o(e)}],YYYY:[/\d{4}/,l("year")],Z:c,ZZ:c};function f(r){var n,i;n=r,i=a&&a.formats;for(var s=(r=n.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,r,n){var s=n&&n.toUpperCase();return r||i[n]||e[n]||i[s].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,r){return t||r.slice(1)}))}))).match(t),o=s.length,l=0;l<o;l+=1){var c=s[l],u=d[c],h=u&&u[0],f=u&&u[1];s[l]=f?{regex:h,parser:f}:c.replace(/^\[|\]$/g,"")}return function(e){for(var t={},r=0,n=0;r<o;r+=1){var i=s[r];if("string"==typeof i)n+=i.length;else{var a=i.regex,l=i.parser,c=e.slice(n),u=a.exec(c)[0];l.call(t,u),e=e.replace(u,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var r=e.hours;t?r<12&&(e.hours+=12):12===r&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,r){r.p.customParseFormat=!0,e&&e.parseTwoDigitYear&&(o=e.parseTwoDigitYear);var n=t.prototype,i=n.parse;n.parse=function(e){var t=e.date,n=e.utc,s=e.args;this.$u=n;var o=s[1];if("string"==typeof o){var l=!0===s[2],c=!0===s[3],u=l||c,h=s[2];c&&(h=s[2]),a=this.$locale(),!l&&h&&(a=r.Ls[h]),this.$d=function(e,t,r,n){try{if(["x","X"].indexOf(t)>-1)return new Date(("X"===t?1e3:1)*e);var i=f(t)(e),s=i.year,a=i.month,o=i.day,l=i.hours,c=i.minutes,u=i.seconds,h=i.milliseconds,d=i.zone,p=i.week,m=new Date,g=o||(s||a?1:m.getDate()),v=s||m.getFullYear(),y=0;s&&!a||(y=a>0?a-1:m.getMonth());var b,w=l||0,x=c||0,S=u||0,_=h||0;return d?new Date(Date.UTC(v,y,g,w,x,S,_+60*d.offset*1e3)):r?new Date(Date.UTC(v,y,g,w,x,S,_)):(b=new Date(v,y,g,w,x,S,_),p&&(b=n(b).week(p).toDate()),b)}catch(e){return new Date("")}}(t,o,n,r),this.init(),h&&!0!==h&&(this.$L=this.locale(h).$L),u&&t!=this.format(o)&&(this.$d=new Date("")),a={}}else if(o instanceof Array)for(var d=o.length,p=1;p<=d;p+=1){s[1]=o[p-1];var m=r.apply(this,s);if(m.isValid()){this.$d=m.$d,this.$L=m.$L,this.init();break}p===d&&(this.$d=new Date(""))}else i.call(this,e)}}}()},525:function(e){e.exports=function(){"use strict";return function(e,t,r){t.prototype.isBetween=function(e,t,n,i){var s=r(e),a=r(t),o="("===(i=i||"()")[0],l=")"===i[1];return(o?this.isAfter(s,n):!this.isBefore(s,n))&&(l?this.isBefore(a,n):!this.isAfter(a,n))||(o?this.isBefore(s,n):!this.isAfter(s,n))&&(l?this.isAfter(a,n):!this.isBefore(a,n))}}}()},443:function(e){e.exports=function(){"use strict";var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(t,r,n){var i=r.prototype,s=i.format;n.en.formats=e,i.format=function(t){void 0===t&&(t="YYYY-MM-DDTHH:mm:ssZ");var r=this.$locale().formats,n=function(t,r){return t.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,n,i){var s=i&&i.toUpperCase();return n||r[i]||e[i]||r[s].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,r){return t||r.slice(1)}))}))}(t,void 0===r?{}:r);return s.call(this,n)}}}()},865:function(e){e.exports=function(){"use strict";var e="week",t="year";return function(r,n,i){var s=n.prototype;s.week=function(r){if(void 0===r&&(r=null),null!==r)return this.add(7*(r-this.week()),"day");var n=this.$locale().yearStart||1;if(11===this.month()&&this.date()>25){var s=i(this).startOf(t).add(1,t).date(n),a=i(this).endOf(e);if(s.isBefore(a))return 1}var o=i(this).startOf(t).date(n).startOf(e).subtract(1,"millisecond"),l=this.diff(o,e,!0);return l<0?i(this).startOf("week").week():Math.ceil(l)},s.weeks=function(e){return void 0===e&&(e=null),this.week(e)}}}()},223:(e,t,r)=>{var n=r(897).default,i=r(344).default,s=r(958).default,a=r(881).default;e.exports=function e(t,r,n){function i(a,o){if(!r[a]){if(!t[a]){if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[a]={exports:{}};t[a][0].call(c.exports,(function(e){return i(t[a][1][e]||e)}),c,c.exports,e,t,r,n)}return r[a].exports}for(var s=void 0,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,r){"use strict";const n=e("fs"),i=e("fast-csv"),s=e("dayjs/plugin/customParseFormat"),a=e("dayjs/plugin/utc"),o=e("dayjs").extend(s).extend(a),l=e("../utils/stream-buf"),{fs:{exists:c}}=e("../utils/utils"),u={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}};t.exports=class{constructor(e){this.workbook=e,this.worksheet=null}async readFile(e,t){if(t=t||{},!await c(e))throw new Error("File not found: "+e);const r=n.createReadStream(e),i=await this.read(r,t);return r.close(),i}read(e,t){return t=t||{},new Promise(((r,n)=>{const s=this.workbook.addWorksheet(t.sheetName),a=t.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],l=t.map||function(e){if(""===e)return null;const t=Number(e);if(!Number.isNaN(t)&&t!==1/0)return t;const r=a.reduce(((t,r)=>{if(t)return t;const n=o(e,r,!0);return n.isValid()?n:null}),null);if(r)return new Date(r.valueOf());const n=u[e];return void 0!==n?n:e},c=i.parse(t.parserOptions).on("data",(e=>{s.addRow(e.map(l))})).on("end",(()=>{c.emit("worksheet",s)}));c.on("worksheet",r).on("error",n),e.pipe(c)}))}createInputStream(){throw new Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(e,t){return new Promise(((r,n)=>{t=t||{};const s=this.workbook.getWorksheet(t.sheetName||t.sheetId),a=i.format(t.formatterOptions);e.on("finish",(()=>{r()})),a.on("error",n),a.pipe(e);const{dateFormat:l,dateUTC:c}=t,u=t.map||(e=>{if(e){if(e.text||e.hyperlink)return e.hyperlink||e.text||"";if(e.formula||e.result)return e.result||"";if(e instanceof Date)return l?c?o.utc(e).format(l):o(e).format(l):c?o.utc(e).format():o(e).format();if(e.error)return e.error;if("object"==typeof e)return JSON.stringify(e)}return e}),h=void 0===t.includeEmptyRows||t.includeEmptyRows;let d=1;s&&s.eachRow(((e,t)=>{if(h)for(;d++<t-1;)a.write([]);const{values:r}=e;r.shift(),a.write(r.map(u)),d=t})),a.end()}))}writeFile(e,t){const r={encoding:(t=t||{}).encoding||"utf8"},i=n.createWriteStream(e,r);return this.write(i,t)}async writeBuffer(e){const t=new l;return await this.write(t,e),t.read()}}},{"../utils/stream-buf":24,"../utils/utils":27,dayjs:391,"dayjs/plugin/customParseFormat":392,"dayjs/plugin/utc":393,"fast-csv":424,fs:216}],2:[function(e,t,r){"use strict";const n=e("../utils/col-cache");class i{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(this.worksheet=e,t)if("string"==typeof t){const e=n.decodeAddress(t);this.nativeCol=e.col+r,this.nativeColOff=0,this.nativeRow=e.row+r,this.nativeRowOff=0}else void 0!==t.nativeCol?(this.nativeCol=t.nativeCol||0,this.nativeColOff=t.nativeColOff||0,this.nativeRow=t.nativeRow||0,this.nativeRowOff=t.nativeRowOff||0):void 0!==t.col?(this.col=t.col+r,this.row=t.row+r):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0);else this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0}static asInstance(e){return e instanceof i||null==e?e:new i(e)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(e){this.nativeCol=Math.floor(e),this.nativeColOff=Math.floor((e-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(e){this.nativeRow=Math.floor(e),this.nativeRowOff=Math.floor((e-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(1e4*this.worksheet.getColumn(this.nativeCol+1).width):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(1e4*this.worksheet.getRow(this.nativeRow+1).height):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(e){this.nativeCol=e.nativeCol,this.nativeColOff=e.nativeColOff,this.nativeRow=e.nativeRow,this.nativeRowOff=e.nativeRowOff}}t.exports=i},{"../utils/col-cache":19}],3:[function(e,t,r){"use strict";const n=e("../utils/col-cache"),i=e("../utils/under-dash"),s=e("./enums"),{slideFormula:a}=e("../utils/shared-formula"),o=e("./note");class l{constructor(e,t,r){if(!e||!t)throw new Error("A Cell needs a Row");this._row=e,this._column=t,n.validateAddress(r),this._address=r,this._value=c.create(l.Types.Null,this),this.style=this._mergeStyle(e.style,t.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(e){this.style.numFmt=e}get font(){return this.style.font}set font(e){this.style.font=e}get alignment(){return this.style.alignment}set alignment(e){this.style.alignment=e}get border(){return this.style.border}set border(e){this.style.border=e}get fill(){return this.style.fill}set fill(e){this.style.fill=e}get protection(){return this.style.protection}set protection(e){this.style.protection=e}_mergeStyle(e,t,r){const n=e&&e.numFmt||t&&t.numFmt;n&&(r.numFmt=n);const i=e&&e.font||t&&t.font;i&&(r.font=i);const s=e&&e.alignment||t&&t.alignment;s&&(r.alignment=s);const a=e&&e.border||t&&t.border;a&&(r.border=a);const o=e&&e.fill||t&&t.fill;o&&(r.fill=o);const l=e&&e.protection||t&&t.protection;return l&&(r.protection=l),r}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return"$".concat(this._column.letter,"$").concat(this.row)}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===l.Types.Merge}merge(e,t){this._value.release(),this._value=c.create(l.Types.Merge,this,e),t||(this.style=e.style)}unmerge(){this.type===l.Types.Merge&&(this._value.release(),this._value=c.create(l.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(e){return this._value.type===l.Types.Merge&&this._value.isMergedTo(e)}get master(){return this.type===l.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===l.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(e){this.type!==l.Types.Merge?(this._value.release(),this._value=c.create(c.getType(e),this,e)):this._value.master.value=e}get note(){return this._comment&&this._comment.note}set note(e){this._comment=new o(e)}get text(){return this._value.toString()}get html(){return i.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(e){this.type===l.Types.String&&(this._value=c.create(l.Types.Hyperlink,this,{text:this._value.value,hyperlink:e}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){const{worksheet:e}=this._row;return{sheetName:e.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(e){this.names=[e]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(e){const{definedNames:t}=this.workbook;t.removeAllNames(this.fullAddress),e.forEach((e=>{t.addEx(this.fullAddress,e)}))}addName(e){this.workbook.definedNames.addEx(this.fullAddress,e)}removeName(e){this.workbook.definedNames.removeEx(this.fullAddress,e)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(e){this._dataValidations.add(this.address,e)}get model(){const{model:e}=this._value;return e.style=this.style,this._comment&&(e.comment=this._comment.model),e}set model(e){this._value.release(),this._value=c.create(e.type,this),this._value.model=e,e.comment&&"note"===e.comment.type&&(this._comment=o.fromModel(e.comment)),e.style?this.style=e.style:this.style={}}}l.Types=s.ValueType;const c={getType:e=>null==e?l.Types.Null:e instanceof String||"string"==typeof e?l.Types.String:"number"==typeof e?l.Types.Number:"boolean"==typeof e?l.Types.Boolean:e instanceof Date?l.Types.Date:e.text&&e.hyperlink?l.Types.Hyperlink:e.formula||e.sharedFormula?l.Types.Formula:e.richText?l.Types.RichText:e.sharedString?l.Types.SharedString:e.error?l.Types.Error:l.Types.JSON,types:[{t:l.Types.Null,f:class{constructor(e){this.model={address:e.address,type:l.Types.Null}}get value(){return null}set value(e){}get type(){return l.Types.Null}get effectiveType(){return l.Types.Null}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return""}release(){}toString(){return""}}},{t:l.Types.Number,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.Number,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.Number}get effectiveType(){return l.Types.Number}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:l.Types.String,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.String,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.String}get effectiveType(){return l.Types.String}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return'"'.concat(this.model.value.replace(/"/g,'""'),'"')}release(){}toString(){return this.model.value}}},{t:l.Types.Date,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.Date,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.Date}get effectiveType(){return l.Types.Date}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}}},{t:l.Types.Hyperlink,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.Hyperlink,text:t?t.text:void 0,hyperlink:t?t.hyperlink:void 0},t&&t.tooltip&&(this.model.tooltip=t.tooltip)}get value(){const e={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(e.tooltip=this.model.tooltip),e}set value(e){this.model={text:e.text,hyperlink:e.hyperlink},e.tooltip&&(this.model.tooltip=e.tooltip)}get text(){return this.model.text}set text(e){this.model.text=e}get hyperlink(){return this.model.hyperlink}set hyperlink(e){this.model.hyperlink=e}get type(){return l.Types.Hyperlink}get effectiveType(){return l.Types.Hyperlink}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}}},{t:l.Types.Formula,f:class{constructor(e,t){this.cell=e,this.model={address:e.address,type:l.Types.Formula,shareType:t?t.shareType:void 0,ref:t?t.ref:void 0,formula:t?t.formula:void 0,sharedFormula:t?t.sharedFormula:void 0,result:t?t.result:void 0}}_copyModel(e){const t={},r=r=>{const n=e[r];n&&(t[r]=n)};return r("formula"),r("result"),r("ref"),r("shareType"),r("sharedFormula"),t}get value(){return this._copyModel(this.model)}set value(e){this.model=this._copyModel(e)}validate(e){switch(c.getType(e)){case l.Types.Null:case l.Types.String:case l.Types.Number:case l.Types.Date:break;case l.Types.Hyperlink:case l.Types.Formula:default:throw new Error("Cannot process that type of result value")}}get dependencies(){return{ranges:this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),cells:this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g)}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(e){this.model.formula=e}get formulaType(){return this.model.formula?s.FormulaType.Master:this.model.sharedFormula?s.FormulaType.Shared:s.FormulaType.None}get result(){return this.model.result}set result(e){this.model.result=e}get type(){return l.Types.Formula}get effectiveType(){const e=this.model.result;return null==e?s.ValueType.Null:e instanceof String||"string"==typeof e?s.ValueType.String:"number"==typeof e?s.ValueType.Number:e instanceof Date?s.ValueType.Date:e.text&&e.hyperlink?s.ValueType.Hyperlink:e.formula?s.ValueType.Formula:s.ValueType.Null}get address(){return this.model.address}set address(e){this.model.address=e}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){const{worksheet:e}=this.cell,t=e.findCell(this.model.sharedFormula);this._translatedFormula=t&&a(t.formula,t.address,this.model.address)}return this._translatedFormula}toCsvString(){return""+(this.model.result||"")}release(){}toString(){return this.model.result?this.model.result.toString():""}}},{t:l.Types.Merge,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.Merge,master:t?t.address:void 0},this._master=t,t&&t.addMergeRef()}get value(){return this._master.value}set value(e){e instanceof l?(this._master&&this._master.releaseMergeRef(),e.addMergeRef(),this._master=e):this._master.value=e}isMergedTo(e){return e===this._master}get master(){return this._master}get type(){return l.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}}},{t:l.Types.JSON,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.String,value:JSON.stringify(t),rawValue:t}}get value(){return this.model.rawValue}set value(e){this.model.rawValue=e,this.model.value=JSON.stringify(e)}get type(){return l.Types.String}get effectiveType(){return l.Types.String}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}}},{t:l.Types.SharedString,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.SharedString,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.SharedString}get effectiveType(){return l.Types.SharedString}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:l.Types.RichText,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.String,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}toString(){return this.model.value.richText.map((e=>e.text)).join("")}get type(){return l.Types.RichText}get effectiveType(){return l.Types.RichText}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return'"'.concat(this.text.replace(/"/g,'""'),'"')}release(){}}},{t:l.Types.Boolean,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.Boolean,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.Boolean}get effectiveType(){return l.Types.Boolean}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}}},{t:l.Types.Error,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.Error,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.Error}get effectiveType(){return l.Types.Error}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}}}].reduce(((e,t)=>(e[t.t]=t.f,e)),[]),create(e,t,r){const n=this.types[e];if(!n)throw new Error("Could not create Value of type "+e);return new n(t,r)}};t.exports=l},{"../utils/col-cache":19,"../utils/shared-formula":23,"../utils/under-dash":26,"./enums":7,"./note":9}],4:[function(e,t,r){"use strict";const n=e("../utils/under-dash"),i=e("./enums"),s=e("../utils/col-cache");class a{constructor(e,t,r){this._worksheet=e,this._number=t,!1!==r&&(this.defn=r)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return s.n2l(this._number)}get isCustomWidth(){return void 0!==this.width&&9!==this.width}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(e){e?(this.key=e.key,this.width=void 0!==e.width?e.width:9,this.outlineLevel=e.outlineLevel,e.style?this.style=e.style:this.style={},this.header=e.header,this._hidden=!!e.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(e){void 0!==e?(this._header=e,this.headers.forEach(((e,t)=>{this._worksheet.getCell(t+1,this.number).value=e}))):this._header=void 0}get key(){return this._key}set key(e){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=e,e&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(e){this._hidden=e}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(e){this._outlineLevel=e}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(e){return this.width===e.width&&this.hidden===e.hidden&&this.outlineLevel===e.outlineLevel&&n.isEqual(this.style,e.style)}get isDefault(){if(this.isCustomWidth)return!1;if(this.hidden)return!1;if(this.outlineLevel)return!1;const e=this.style;return!e||!(e.font||e.numFmt||e.alignment||e.border||e.fill||e.protection)}get headerCount(){return this.headers.length}eachCell(e,t){const r=this.number;t||(t=e,e=null),this._worksheet.eachRow(e,((e,n)=>{t(e.getCell(r),n)}))}get values(){const e=[];return this.eachCell(((t,r)=>{t&&t.type!==i.ValueType.Null&&(e[r]=t.value)})),e}set values(e){if(!e)return;const t=this.number;let r=0;e.hasOwnProperty("0")&&(r=1),e.forEach(((e,n)=>{this._worksheet.getCell(n+r,t).value=e}))}_applyStyle(e,t){return this.style[e]=t,this.eachCell((r=>{r[e]=t})),t}get numFmt(){return this.style.numFmt}set numFmt(e){this._applyStyle("numFmt",e)}get font(){return this.style.font}set font(e){this._applyStyle("font",e)}get alignment(){return this.style.alignment}set alignment(e){this._applyStyle("alignment",e)}get protection(){return this.style.protection}set protection(e){this._applyStyle("protection",e)}get border(){return this.style.border}set border(e){this._applyStyle("border",e)}get fill(){return this.style.fill}set fill(e){this._applyStyle("fill",e)}static toModel(e){const t=[];let r=null;return e&&e.forEach(((e,n)=>{e.isDefault?r&&(r=null):r&&e.equivalentTo(r)?r.max=n+1:(r={min:n+1,max:n+1,width:void 0!==e.width?e.width:9,style:e.style,isCustomWidth:e.isCustomWidth,hidden:e.hidden,outlineLevel:e.outlineLevel,collapsed:e.collapsed},t.push(r))})),t.length?t:void 0}static fromModel(e,t){const r=[];let n=1,i=0;for(t=(t=t||[]).sort((function(e,t){return e.min-t.min}));i<t.length;){const s=t[i++];for(;n<s.min;)r.push(new a(e,n++));for(;n<=s.max;)r.push(new a(e,n++,s))}return r.length?r:null}}t.exports=a},{"../utils/col-cache":19,"../utils/under-dash":26,"./enums":7}],5:[function(e,t,r){"use strict";t.exports=class{constructor(e){this.model=e||{}}add(e,t){return this.model[e]=t}find(e){return this.model[e]}remove(e){this.model[e]=void 0}}},{}],6:[function(e,t,r){"use strict";const n=e("../utils/under-dash"),i=e("../utils/col-cache"),s=e("../utils/cell-matrix"),a=e("./range"),o=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/;t.exports=class{constructor(){this.matrixMap={}}getMatrix(e){return this.matrixMap[e]||(this.matrixMap[e]=new s)}add(e,t){const r=i.decodeEx(e);this.addEx(r,t)}addEx(e,t){const r=this.getMatrix(t);if(e.top)for(let n=e.left;n<=e.right;n++)for(let t=e.top;t<=e.bottom;t++){const s={sheetName:e.sheetName,address:i.n2l(n)+t,row:t,col:n};r.addCellEx(s)}else r.addCellEx(e)}remove(e,t){const r=i.decodeEx(e);this.removeEx(r,t)}removeEx(e,t){this.getMatrix(t).removeCellEx(e)}removeAllNames(e){n.each(this.matrixMap,(t=>{t.removeCellEx(e)}))}forEach(e){n.each(this.matrixMap,((t,r)=>{t.forEach((t=>{e(r,t)}))}))}getNames(e){return this.getNamesEx(i.decodeEx(e))}getNamesEx(e){return n.map(this.matrixMap,((t,r)=>t.findCellEx(e)&&r)).filter(Boolean)}_explore(e,t){t.mark=!1;const{sheetName:r}=t,n=new a(t.row,t.col,t.row,t.col,r);let i,s;function o(i,s){const a=e.findCellAt(r,i,t.col);return!(!a||!a.mark)&&(n[s]=i,a.mark=!1,!0)}for(s=t.row-1;o(s,"top");s--);for(s=t.row+1;o(s,"bottom");s++);function l(t,i){const a=[];for(s=n.top;s<=n.bottom;s++){const n=e.findCellAt(r,s,t);if(!n||!n.mark)return!1;a.push(n)}n[i]=t;for(let e=0;e<a.length;e++)a[e].mark=!1;return!0}for(i=t.col-1;l(i,"left");i--);for(i=t.col+1;l(i,"right");i++);return n}getRanges(e,t){return(t=t||this.matrixMap[e])?(t.forEach((e=>{e.mark=!0})),{name:e,ranges:t.map((e=>e.mark&&this._explore(t,e))).filter(Boolean).map((e=>e.$shortRange))}):{name:e,ranges:[]}}normaliseMatrix(e,t){e.forEachInSheet(t,((e,t,r)=>{e&&(e.row===t&&e.col===r||(e.row=t,e.col=r,e.address=i.n2l(r)+t))}))}spliceRows(e,t,r,i){n.each(this.matrixMap,(n=>{n.spliceRows(e,t,r,i),this.normaliseMatrix(n,e)}))}spliceColumns(e,t,r,i){n.each(this.matrixMap,(n=>{n.spliceColumns(e,t,r,i),this.normaliseMatrix(n,e)}))}get model(){return n.map(this.matrixMap,((e,t)=>this.getRanges(t,e))).filter((e=>e.ranges.length))}set model(e){const t=this.matrixMap={};e.forEach((e=>{const r=t[e.name]=new s;e.ranges.forEach((e=>{o.test(e.split("!").pop()||"")&&r.addCell(e)}))}))}}},{"../utils/cell-matrix":18,"../utils/col-cache":19,"../utils/under-dash":26,"./range":10}],7:[function(e,t,r){"use strict";t.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}},{}],8:[function(e,t,r){"use strict";const n=e("../utils/col-cache"),i=e("./anchor");t.exports=class{constructor(e,t){this.worksheet=e,this.model=t}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw new Error("Invalid Image Type")}}set model(e){let{type:t,imageId:r,range:s,hyperlinks:a}=e;if(this.type=t,this.imageId=r,"image"===t)if("string"==typeof s){const e=n.decode(s);this.range={tl:new i(this.worksheet,{col:e.left,row:e.top},-1),br:new i(this.worksheet,{col:e.right,row:e.bottom},0),editAs:"oneCell"}}else this.range={tl:new i(this.worksheet,s.tl,0),br:s.br&&new i(this.worksheet,s.br,0),ext:s.ext,editAs:s.editAs,hyperlinks:a||s.hyperlinks}}}},{"../utils/col-cache":19,"./anchor":2}],9:[function(e,t,r){"use strict";const n=e("../utils/under-dash");class i{constructor(e){this.note=e}get model(){let e=null;return e="string"===typeof this.note?{type:"note",note:{texts:[{text:this.note}]}}:{type:"note",note:this.note},n.deepMerge({},i.DEFAULT_CONFIGS,e)}set model(e){const{note:t}=e,{texts:r}=t;1===r.length&&1===Object.keys(r[0]).length?this.note=r[0].text:this.note=t}static fromModel(e){const t=new i;return t.model=e,t}}i.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},t.exports=i},{"../utils/under-dash":26}],10:[function(e,t,r){"use strict";const n=e("../utils/col-cache");class i{constructor(){this.decode(arguments)}setTLBR(e,t,r,i,s){if(arguments.length<4){const i=n.decodeAddress(e),a=n.decodeAddress(t);this.model={top:Math.min(i.row,a.row),left:Math.min(i.col,a.col),bottom:Math.max(i.row,a.row),right:Math.max(i.col,a.col),sheetName:r},this.setTLBR(i.row,i.col,a.row,a.col,s)}else this.model={top:Math.min(e,r),left:Math.min(t,i),bottom:Math.max(e,r),right:Math.max(t,i),sheetName:s}}decode(e){switch(e.length){case 5:this.setTLBR(e[0],e[1],e[2],e[3],e[4]);break;case 4:this.setTLBR(e[0],e[1],e[2],e[3]);break;case 3:this.setTLBR(e[0],e[1],e[2]);break;case 2:this.setTLBR(e[0],e[1]);break;case 1:{const t=e[0];if(t instanceof i)this.model={top:t.model.top,left:t.model.left,bottom:t.model.bottom,right:t.model.right,sheetName:t.sheetName};else if(t instanceof Array)this.decode(t);else if(t.top&&t.left&&t.bottom&&t.right)this.model={top:t.top,left:t.left,bottom:t.bottom,right:t.right,sheetName:t.sheetName};else{const e=n.decodeEx(t);e.top?this.model={top:e.top,left:e.left,bottom:e.bottom,right:e.right,sheetName:e.sheetName}:this.model={top:e.row,left:e.col,bottom:e.row,right:e.col,sheetName:e.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error("Invalid number of arguments to _getDimensions() - "+e.length)}}get top(){return this.model.top||1}set top(e){this.model.top=e}get left(){return this.model.left||1}set left(e){this.model.left=e}get bottom(){return this.model.bottom||1}set bottom(e){this.model.bottom=e}get right(){return this.model.right||1}set right(e){this.model.right=e}get sheetName(){return this.model.sheetName}set sheetName(e){this.model.sheetName=e}get _serialisedSheetName(){const{sheetName:e}=this.model;return e?/^[a-zA-Z0-9]*$/.test(e)?e+"!":"'".concat(e,"'!"):""}expand(e,t,r,n){(!this.model.top||e<this.top)&&(this.top=e),(!this.model.left||t<this.left)&&(this.left=t),(!this.model.bottom||r>this.bottom)&&(this.bottom=r),(!this.model.right||n>this.right)&&(this.right=n)}expandRow(e){if(e){const{dimensions:t,number:r}=e;t&&this.expand(r,t.min,r,t.max)}}expandToAddress(e){const t=n.decodeEx(e);this.expand(t.row,t.col,t.row,t.col)}get tl(){return n.n2l(this.left)+this.top}get $t$l(){return"$".concat(n.n2l(this.left),"$").concat(this.top)}get br(){return n.n2l(this.right)+this.bottom}get $b$r(){return"$".concat(n.n2l(this.right),"$").concat(this.bottom)}get range(){return"".concat(this._serialisedSheetName+this.tl,":").concat(this.br)}get $range(){return"".concat(this._serialisedSheetName+this.$t$l,":").concat(this.$b$r)}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(e){return(!e.sheetName||!this.sheetName||e.sheetName===this.sheetName)&&!(e.bottom<this.top)&&!(e.top>this.bottom)&&!(e.right<this.left)&&!(e.left>this.right)}contains(e){const t=n.decodeEx(e);return this.containsEx(t)}containsEx(e){return(!e.sheetName||!this.sheetName||e.sheetName===this.sheetName)&&e.row>=this.top&&e.row<=this.bottom&&e.col>=this.left&&e.col<=this.right}forEachAddress(e){for(let t=this.left;t<=this.right;t++)for(let r=this.top;r<=this.bottom;r++)e(n.encodeAddress(r,t),r,t)}}t.exports=i},{"../utils/col-cache":19}],11:[function(e,t,r){"use strict";const n=e("../utils/under-dash"),i=e("./enums"),s=e("../utils/col-cache"),a=e("./cell");t.exports=class{constructor(e,t){this._worksheet=e,this._number=t,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(e){return this._cells[e-1]}getCellEx(e){let t=this._cells[e.col-1];if(!t){const r=this._worksheet.getColumn(e.col);t=new a(this,r,e.address),this._cells[e.col-1]=t}return t}getCell(e){if("string"==typeof e){const t=this._worksheet.getColumnKey(e);e=t?t.number:s.l2n(e)}return this._cells[e-1]||this.getCellEx({address:s.encodeAddress(this._number,e),row:this._number,col:e})}splice(e,t){const r=e+t;for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];const a=i.length-t,o=this._cells.length;let l,c,u;if(a<0)for(l=e+i.length;l<=o;l++)u=this._cells[l-1],c=this._cells[l-a-1],c?(u=this.getCell(l),u.value=c.value,u.style=c.style,u._comment=c._comment):u&&(u.value=null,u.style={},u._comment=void 0);else if(a>0)for(l=o;l>=r;l--)c=this._cells[l-1],c?(u=this.getCell(l+a),u.value=c.value,u.style=c.style,u._comment=c._comment):this._cells[l+a-1]=void 0;for(l=0;l<i.length;l++)u=this.getCell(e+l),u.value=i[l],u.style={},u._comment=void 0}eachCell(e,t){if(t||(t=e,e=null),e&&e.includeEmpty){const e=this._cells.length;for(let r=1;r<=e;r++)t(this.getCell(r),r)}else this._cells.forEach(((e,r)=>{e&&e.type!==i.ValueType.Null&&t(e,r+1)}))}addPageBreak(e,t){const r=this._worksheet,n=Math.max(0,e-1)||0,i=Math.max(0,t-1)||16838,s={id:this._number,max:i,man:1};n&&(s.min=n),r.rowBreaks.push(s)}get values(){const e=[];return this._cells.forEach((t=>{t&&t.type!==i.ValueType.Null&&(e[t.col]=t.value)})),e}set values(e){if(this._cells=[],e)if(e instanceof Array){let t=0;e.hasOwnProperty("0")&&(t=1),e.forEach(((e,r)=>{void 0!==e&&(this.getCellEx({address:s.encodeAddress(this._number,r+t),row:this._number,col:r+t}).value=e)}))}else this._worksheet.eachColumnKey(((t,r)=>{void 0!==e[r]&&(this.getCellEx({address:s.encodeAddress(this._number,t.number),row:this._number,col:t.number}).value=e[r])}))}get hasValues(){return n.some(this._cells,(e=>e&&e.type!==i.ValueType.Null))}get cellCount(){return this._cells.length}get actualCellCount(){let e=0;return this.eachCell((()=>{e++})),e}get dimensions(){let e=0,t=0;return this._cells.forEach((r=>{r&&r.type!==i.ValueType.Null&&((!e||e>r.col)&&(e=r.col),t<r.col&&(t=r.col))})),e>0?{min:e,max:t}:null}_applyStyle(e,t){return this.style[e]=t,this._cells.forEach((r=>{r&&(r[e]=t)})),t}get numFmt(){return this.style.numFmt}set numFmt(e){this._applyStyle("numFmt",e)}get font(){return this.style.font}set font(e){this._applyStyle("font",e)}get alignment(){return this.style.alignment}set alignment(e){this._applyStyle("alignment",e)}get protection(){return this.style.protection}set protection(e){this._applyStyle("protection",e)}get border(){return this.style.border}set border(e){this._applyStyle("border",e)}get fill(){return this.style.fill}set fill(e){this._applyStyle("fill",e)}get hidden(){return!!this._hidden}set hidden(e){this._hidden=e}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(e){this._outlineLevel=e}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){const e=[];let t=0,r=0;return this._cells.forEach((n=>{if(n){const i=n.model;i&&((!t||t>n.col)&&(t=n.col),r<n.col&&(r=n.col),e.push(i))}})),this.height||e.length?{cells:e,number:this.number,min:t,max:r,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(e){if(e.number!==this._number)throw new Error("Invalid row number in model");let t;this._cells=[],e.cells.forEach((e=>{switch(e.type){case a.Types.Merge:break;default:{let r;if(e.address)r=s.decodeAddress(e.address);else if(t){const{row:e}=t,n=t.col+1;r={row:e,col:n,address:s.encodeAddress(e,n),$col$row:"$".concat(s.n2l(n),"$").concat(e)}}t=r,this.getCellEx(r).model=e;break}}})),e.height?this.height=e.height:delete this.height,this.hidden=e.hidden,this.outlineLevel=e.outlineLevel||0,this.style=e.style&&JSON.parse(JSON.stringify(e.style))||{}}}},{"../utils/col-cache":19,"../utils/under-dash":26,"./cell":3,"./enums":7}],12:[function(e,t,r){"use strict";const n=e("../utils/col-cache");class i{constructor(e,t,r){this.table=e,this.column=t,this.index=r}_set(e,t){this.table.cacheState(),this.column[e]=t}get name(){return this.column.name}set name(e){this._set("name",e)}get filterButton(){return this.column.filterButton}set filterButton(e){this.column.filterButton=e}get style(){return this.column.style}set style(e){this.column.style=e}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(e){this._set("totalsRowLabel",e)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(e){this._set("totalsRowFunction",e)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(e){this._set("totalsRowResult",e)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(e){this._set("totalsRowFormula",e)}}t.exports=class{constructor(e,t){this.worksheet=e,t&&(this.table=t,this.validate(),this.store())}getFormula(e){switch(e.totalsRowFunction){case"none":return null;case"average":return"SUBTOTAL(101,".concat(this.table.name,"[").concat(e.name,"])");case"countNums":return"SUBTOTAL(102,".concat(this.table.name,"[").concat(e.name,"])");case"count":return"SUBTOTAL(103,".concat(this.table.name,"[").concat(e.name,"])");case"max":return"SUBTOTAL(104,".concat(this.table.name,"[").concat(e.name,"])");case"min":return"SUBTOTAL(105,".concat(this.table.name,"[").concat(e.name,"])");case"stdDev":return"SUBTOTAL(106,".concat(this.table.name,"[").concat(e.name,"])");case"var":return"SUBTOTAL(107,".concat(this.table.name,"[").concat(e.name,"])");case"sum":return"SUBTOTAL(109,".concat(this.table.name,"[").concat(e.name,"])");case"custom":return e.totalsRowFormula;default:throw new Error("Invalid Totals Row Function: "+e.totalsRowFunction)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){const{table:e}=this,t=(e,t,r)=>{void 0===e[t]&&(e[t]=r)};t(e,"headerRow",!0),t(e,"totalsRow",!1),t(e,"style",{}),t(e.style,"theme","TableStyleMedium2"),t(e.style,"showFirstColumn",!1),t(e.style,"showLastColumn",!1),t(e.style,"showRowStripes",!1),t(e.style,"showColumnStripes",!1);const r=(e,t)=>{if(!e)throw new Error(t)};r(e.ref,"Table must have ref"),r(e.columns,"Table must have column definitions"),r(e.rows,"Table must have row definitions"),e.tl=n.decodeAddress(e.ref);const{row:i,col:s}=e.tl;r(i>0,"Table must be on valid row"),r(s>0,"Table must be on valid col");const{width:a,filterHeight:o,tableHeight:l}=this;e.autoFilterRef=n.encode(i,s,i+o-1,s+a-1),e.tableRef=n.encode(i,s,i+l-1,s+a-1),e.columns.forEach(((e,n)=>{r(e.name,"Column ".concat(n," must have a name")),0===n?t(e,"totalsRowLabel","Total"):(t(e,"totalsRowFunction","none"),e.totalsRowFormula=this.getFormula(e))}))}store(){const e=(e,t)=>{t&&Object.keys(t).forEach((r=>{e[r]=t[r]}))},{worksheet:t,table:r}=this,{row:n,col:i}=r.tl;let s=0;if(r.headerRow){const a=t.getRow(n+s++);r.columns.forEach(((t,r)=>{const{style:n,name:s}=t,o=a.getCell(i+r);o.value=s,e(o,n)}))}if(r.rows.forEach((a=>{const o=t.getRow(n+s++);a.forEach(((t,n)=>{const s=o.getCell(i+n);s.value=t,e(s,r.columns[n].style)}))})),r.totalsRow){const a=t.getRow(n+s++);r.columns.forEach(((t,r)=>{const n=a.getCell(i+r);if(0===r)n.value=t.totalsRowLabel;else{const e=this.getFormula(t);n.value=e?{formula:t.totalsRowFormula,result:t.totalsRowResult}:null}e(n,t.style)}))}}load(e){const{table:t}=this,{row:r,col:n}=t.tl;let i=0;if(t.headerRow){const s=e.getRow(r+i++);t.columns.forEach(((e,t)=>{s.getCell(n+t).value=e.name}))}if(t.rows.forEach((t=>{const s=e.getRow(r+i++);t.forEach(((e,t)=>{s.getCell(n+t).value=e}))})),t.totalsRow){const s=e.getRow(r+i++);t.columns.forEach(((e,t)=>{const r=s.getCell(n+t);0===t?r.value=e.totalsRowLabel:this.getFormula(e)&&(r.value={formula:e.totalsRowFormula,result:e.totalsRowResult})}))}}get model(){return this.table}set model(e){this.table=e}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();const e=n.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let t=0;t<this._cache.tableHeight;t++){const r=this.worksheet.getRow(e.row+t);for(let t=0;t<this._cache.width;t++)r.getCell(e.col+t).value=null}else{for(let t=this.tableHeight;t<this._cache.tableHeight;t++){const r=this.worksheet.getRow(e.row+t);for(let t=0;t<this._cache.width;t++)r.getCell(e.col+t).value=null}for(let t=0;t<this.tableHeight;t++){const r=this.worksheet.getRow(e.row+t);for(let t=this.width;t<this._cache.width;t++)r.getCell(e.col+t).value=null}}this.store()}addRow(e,t){this.cacheState(),void 0===t?this.table.rows.push(e):this.table.rows.splice(t,0,e)}removeRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cacheState(),this.table.rows.splice(e,t)}getColumn(e){const t=this.table.columns[e];return new i(this,t,e)}addColumn(e,t,r){this.cacheState(),void 0===r?(this.table.columns.push(e),this.table.rows.forEach(((e,r)=>{e.push(t[r])}))):(this.table.columns.splice(r,0,e),this.table.rows.forEach(((e,n)=>{e.splice(r,0,t[n])})))}removeColumns(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cacheState(),this.table.columns.splice(e,t),this.table.rows.forEach((r=>{r.splice(e,t)}))}_assign(e,t,r){this.cacheState(),e[t]=r}get ref(){return this.table.ref}set ref(e){this._assign(this.table,"ref",e)}get name(){return this.table.name}set name(e){this.table.name=e}get displayName(){return this.table.displyName||this.table.name}set displayNamename(e){this.table.displayName=e}get headerRow(){return this.table.headerRow}set headerRow(e){this._assign(this.table,"headerRow",e)}get totalsRow(){return this.table.totalsRow}set totalsRow(e){this._assign(this.table,"totalsRow",e)}get theme(){return this.table.style.name}set theme(e){this.table.style.name=e}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(e){this.table.style.showFirstColumn=e}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(e){this.table.style.showLastColumn=e}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(e){this.table.style.showRowStripes=e}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(e){this.table.style.showColumnStripes=e}}},{"../utils/col-cache":19}],13:[function(e,t,r){"use strict";const n=e("./worksheet"),i=e("./defined-names"),s=e("../xlsx/xlsx"),a=e("../csv/csv");t.exports=class{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new i}get xlsx(){return this._xlsx||(this._xlsx=new s(this)),this._xlsx}get csv(){return this._csv||(this._csv=new a(this)),this._csv}get nextId(){for(let e=1;e<this._worksheets.length;e++)if(!this._worksheets[e])return e;return this._worksheets.length||1}addWorksheet(e,t){const r=this.nextId;t&&("string"==typeof t?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),t={properties:{tabColor:{argb:t}}}):(t.argb||t.theme||t.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),t={properties:{tabColor:t}}));const i=this._worksheets.reduce(((e,t)=>(t&&t.orderNo)>e?t.orderNo:e),0),s=Object.assign({},t,{id:r,name:e,orderNo:i+1,workbook:this}),a=new n(s);return this._worksheets[r]=a,a}removeWorksheetEx(e){delete this._worksheets[e.id]}removeWorksheet(e){const t=this.getWorksheet(e);t&&t.destroy()}getWorksheet(e){return void 0===e?this._worksheets.find(Boolean):"number"==typeof e?this._worksheets[e]:"string"==typeof e?this._worksheets.find((t=>t&&t.name===e)):void 0}get worksheets(){return this._worksheets.slice(1).sort(((e,t)=>e.orderNo-t.orderNo)).filter(Boolean)}eachSheet(e){this.worksheets.forEach((t=>{e(t,t.id)}))}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(e){const t=this.media.length;return this.media.push(Object.assign({},e,{type:"image"})),t}getImage(e){return this.media[e]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map((e=>e.model)),sheets:this.worksheets.map((e=>e.model)).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(e){this.creator=e.creator,this.lastModifiedBy=e.lastModifiedBy,this.lastPrinted=e.lastPrinted,this.created=e.created,this.modified=e.modified,this.company=e.company,this.manager=e.manager,this.title=e.title,this.subject=e.subject,this.keywords=e.keywords,this.category=e.category,this.description=e.description,this.language=e.language,this.revision=e.revision,this.contentStatus=e.contentStatus,this.properties=e.properties,this.calcProperties=e.calcProperties,this._worksheets=[],e.worksheets.forEach((t=>{const{id:r,name:i,state:s}=t,a=e.sheets&&e.sheets.findIndex((e=>e.id===r));(this._worksheets[r]=new n({id:r,name:i,orderNo:a,state:s,workbook:this})).model=t})),this._definedNames.model=e.definedNames,this.views=e.views,this._themes=e.themes,this.media=e.media||[]}}},{"../csv/csv":1,"../xlsx/xlsx":144,"./defined-names":6,"./worksheet":14}],14:[function(e,t,r){"use strict";const n=e("../utils/under-dash"),i=e("../utils/col-cache"),s=e("./range"),a=e("./row"),o=e("./column"),l=e("./enums"),c=e("./image"),u=e("./table"),h=e("./data-validations"),d=e("../utils/encryptor"),{copyStyle:f}=e("../utils/copy-style");t.exports=class{constructor(e){e=e||{},this._workbook=e.workbook,this.id=e.id,this.orderNo=e.orderNo,this.name=e.name,this.state=e.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},e.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!(!e.pageSetup||!e.pageSetup.fitToWidth&&!e.pageSetup.fitToHeight||e.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},e.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},e.headerFooter),this.dataValidations=new h,this.views=e.views||[],this.autoFilter=e.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get name(){return this._name}set name(e){if(void 0===e&&(e="sheet"+this.id),this._name!==e){if("string"!=typeof e)throw new Error("The name has to be a string.");if(""===e)throw new Error("The name can't be empty.");if("History"===e)throw new Error('The name "History" is protected. Please use a different name.');if(/[*?:/\\[\]]/.test(e))throw new Error("Worksheet name ".concat(e," cannot include any of the following characters: * ? : \\ / [ ]"));if(/(^')|('$)/.test(e))throw new Error("The first or last character of worksheet name cannot be a single quotation mark: "+e);if(e&&e.length>31&&(console.warn("Worksheet name ".concat(e," exceeds 31 chars. This will be truncated")),e=e.substring(0,31)),this._workbook._worksheets.find((t=>t&&t.name.toLowerCase()===e.toLowerCase())))throw new Error("Worksheet name already exists: "+e);this._name=e}}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){const e=new s;return this._rows.forEach((t=>{if(t){const r=t.dimensions;r&&e.expand(t.number,r.min,t.number,r.max)}})),e}get columns(){return this._columns}set columns(e){this._headerRowCount=e.reduce(((e,t)=>{const r=(t.header?1:t.headers&&t.headers.length)||0;return Math.max(e,r)}),0);let t=1;const r=this._columns=[];e.forEach((e=>{const n=new o(this,t++,!1);r.push(n),n.defn=e}))}getColumnKey(e){return this._keys[e]}setColumnKey(e,t){this._keys[e]=t}deleteColumnKey(e){delete this._keys[e]}eachColumnKey(e){n.each(this._keys,e)}getColumn(e){if("string"==typeof e){const t=this._keys[e];if(t)return t;e=i.l2n(e)}if(this._columns||(this._columns=[]),e>this._columns.length){let t=this._columns.length+1;for(;t<=e;)this._columns.push(new o(this,t++))}return this._columns[e-1]}spliceColumns(e,t){const r=this._rows.length;for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];if(i.length>0)for(let c=0;c<r;c++){const r=[e,t];i.forEach((e=>{r.push(e[c]||null)}));const n=this.getRow(c+1);n.splice.apply(n,r)}else this._rows.forEach((r=>{r&&r.splice(e,t)}));const a=i.length-t,o=e+t,l=this._columns.length;if(a<0)for(let c=e+i.length;c<=l;c++)this.getColumn(c).defn=this.getColumn(c-a).defn;else if(a>0)for(let c=l;c>=o;c--)this.getColumn(c+a).defn=this.getColumn(c).defn;for(let c=e;c<e+i.length;c++)this.getColumn(c).defn=null;this.workbook.definedNames.spliceColumns(this.name,e,t,i.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let e=0;return this.eachRow((t=>{e=Math.max(e,t.cellCount)})),e}get actualColumnCount(){const e=[];let t=0;return this.eachRow((r=>{r.eachCell((r=>{let{col:n}=r;e[n]||(e[n]=!0,t++)}))})),t}_commitRow(){}get _lastRowNumber(){const e=this._rows;let t=e.length;for(;t>0&&void 0===e[t-1];)t--;return t}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(e){return this._rows[e-1]}findRows(e,t){return this._rows.slice(e-1,e-1+t)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let e=0;return this.eachRow((()=>{e++})),e}getRow(e){let t=this._rows[e-1];return t||(t=this._rows[e-1]=new a(this,e)),t}getRows(e,t){if(t<1)return;const r=[];for(let n=e;n<e+t;n++)r.push(this.getRow(n));return r}addRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"n";const r=this._nextRow,n=this.getRow(r);return n.values=e,this._setStyleOption(r,"i"===t[0]?t:"n"),n}addRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"n";const r=[];return e.forEach((e=>{r.push(this.addRow(e,t))})),r}insertRow(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"n";return this.spliceRows(e,0,t),this._setStyleOption(e,r),this.getRow(e)}insertRows(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"n";if(this.spliceRows(e,0,...t),"n"!==r)for(let n=0;n<t.length;n++)"o"===r[0]&&void 0!==this.findRow(t.length+e+n)?this._copyStyle(t.length+e+n,e+n,"+"===r[1]):"i"===r[0]&&void 0!==this.findRow(e-1)&&this._copyStyle(e-1,e+n,"+"===r[1]);return this.getRows(e,t.length)}_setStyleOption(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"n";"o"===t[0]&&void 0!==this.findRow(e+1)?this._copyStyle(e+1,e,"+"===t[1]):"i"===t[0]&&void 0!==this.findRow(e-1)&&this._copyStyle(e-1,e,"+"===t[1])}_copyStyle(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this.getRow(e),i=this.getRow(t);i.style=f(n.style),n.eachCell({includeEmpty:r},((e,t)=>{i.getCell(t).style=f(e.style)})),i.height=n.height}duplicateRow(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this._rows[e-1],i=new Array(t).fill(n.values);this.spliceRows(e+1,r?0:t,...i);for(let s=0;s<t;s++){const t=this._rows[e+s];t.style=n.style,t.height=n.height,n.eachCell({includeEmpty:!0},((e,r)=>{t.getCell(r).style=e.style}))}}spliceRows(e,t){const r=e+t;for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];const a=i.length,o=a-t,l=this._rows.length;let c,u;if(o<0)for(e===l&&(this._rows[l-1]=void 0),c=r;c<=l;c++)if(u=this._rows[c-1],u){const e=this.getRow(c+o);e.values=u.values,e.style=u.style,e.height=u.height,u.eachCell({includeEmpty:!0},((t,r)=>{e.getCell(r).style=t.style})),this._rows[c-1]=void 0}else this._rows[c+o-1]=void 0;else if(o>0)for(c=l;c>=r;c--)if(u=this._rows[c-1],u){const e=this.getRow(c+o);e.values=u.values,e.style=u.style,e.height=u.height,u.eachCell({includeEmpty:!0},((t,r)=>{if(e.getCell(r).style=t.style,"MergeValue"===t._value.constructor.name){const e=this.getRow(t._row._number+a).getCell(r),n=t._value._master,i=this.getRow(n._row._number+a).getCell(n._column._number);e.merge(i)}}))}else this._rows[c+o-1]=void 0;for(c=0;c<a;c++){const t=this.getRow(e+c);t.style={},t.values=i[c]}this.workbook.definedNames.spliceRows(this.name,e,t,a)}eachRow(e,t){if(t||(t=e,e=void 0),e&&e.includeEmpty){const e=this._rows.length;for(let r=1;r<=e;r++)t(this.getRow(r),r)}else this._rows.forEach((e=>{e&&e.hasValues&&t(e,e.number)}))}getSheetValues(){const e=[];return this._rows.forEach((t=>{t&&(e[t.number]=t.values)})),e}findCell(e,t){const r=i.getAddress(e,t),n=this._rows[r.row-1];return n?n.findCell(r.col):void 0}getCell(e,t){const r=i.getAddress(e,t);return this.getRow(r.row).getCellEx(r)}mergeCells(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const n=new s(t);this._mergeCellsInternal(n)}mergeCellsWithoutStyle(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const n=new s(t);this._mergeCellsInternal(n,!0)}_mergeCellsInternal(e,t){n.each(this._merges,(t=>{if(t.intersects(e))throw new Error("Cannot merge already merged cells")}));const r=this.getCell(e.top,e.left);for(let n=e.top;n<=e.bottom;n++)for(let i=e.left;i<=e.right;i++)(n>e.top||i>e.left)&&this.getCell(n,i).merge(r,t);this._merges[r.address]=e}_unMergeMaster(e){const t=this._merges[e.address];if(t){for(let e=t.top;e<=t.bottom;e++)for(let r=t.left;r<=t.right;r++)this.getCell(e,r).unmerge();delete this._merges[e.address]}}get hasMerges(){return n.some(this._merges,Boolean)}unMergeCells(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const n=new s(t);for(let i=n.top;i<=n.bottom;i++)for(let e=n.left;e<=n.right;e++){const t=this.findCell(i,e);t&&(t.type===l.ValueType.Merge?this._unMergeMaster(t.master):this._merges[t.address]&&this._unMergeMaster(t))}}fillFormula(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"shared";const s=i.decode(e),{top:a,left:o,bottom:l,right:c}=s,u=c-o+1,h=i.encodeAddress(a,o),d="shared"===n;let f;f="function"==typeof r?r:Array.isArray(r)?Array.isArray(r[0])?(e,t)=>r[e-a][t-o]:(e,t)=>r[(e-a)*u+(t-o)]:()=>{};let p=!0;for(let i=a;i<=l;i++)for(let r=o;r<=c;r++)p?(this.getCell(i,r).value={shareType:n,formula:t,ref:e,result:f(i,r)},p=!1):this.getCell(i,r).value=d?{sharedFormula:h,result:f(i,r)}:f(i,r)}addImage(e,t){const r={type:"image",imageId:e,range:t};this._media.push(new c(this,r))}getImages(){return this._media.filter((e=>"image"===e.type))}addBackgroundImage(e){const t={type:"background",imageId:e};this._media.push(new c(this,t))}getBackgroundImageId(){const e=this._media.find((e=>"background"===e.type));return e&&e.imageId}protect(e,t){return new Promise((r=>{this.sheetProtection={sheet:!0},t&&"spinCount"in t&&(t.spinCount=Number.isFinite(t.spinCount)?Math.round(Math.max(0,t.spinCount)):1e5),e&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=d.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=t&&"spinCount"in t?t.spinCount:1e5,this.sheetProtection.hashValue=d.convertPasswordToHash(e,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),t&&(this.sheetProtection=Object.assign(this.sheetProtection,t),!e&&"spinCount"in t&&delete this.sheetProtection.spinCount),r()}))}unprotect(){this.sheetProtection=null}addTable(e){const t=new u(this,e);return this.tables[e.name]=t,t}getTable(e){return this.tables[e]}removeTable(e){delete this.tables[e]}getTables(){return Object.values(this.tables)}addConditionalFormatting(e){this.conditionalFormattings.push(e)}removeConditionalFormatting(e){"number"==typeof e?this.conditionalFormattings.splice(e,1):this.conditionalFormattings=e instanceof Function?this.conditionalFormattings.filter(e):[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(e){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=e}get model(){const e={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map((e=>e.model)),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map((e=>e.model)),conditionalFormattings:this.conditionalFormattings};e.cols=o.toModel(this.columns);const t=e.rows=[],r=e.dimensions=new s;return this._rows.forEach((e=>{const n=e&&e.model;n&&(r.expand(n.number,n.min,n.number,n.max),t.push(n))})),e.merges=[],n.each(this._merges,(t=>{e.merges.push(t.range)})),e}_parseRows(e){this._rows=[],e.rows.forEach((e=>{const t=new a(this,e.number);this._rows[t.number-1]=t,t.model=e}))}_parseMergeCells(e){n.each(e.mergeCells,(e=>{this.mergeCellsWithoutStyle(e)}))}set model(e){this.name=e.name,this._columns=o.fromModel(this,e.cols),this._parseRows(e),this._parseMergeCells(e),this.dataValidations=new h(e.dataValidations),this.properties=e.properties,this.pageSetup=e.pageSetup,this.headerFooter=e.headerFooter,this.views=e.views,this.autoFilter=e.autoFilter,this._media=e.media.map((e=>new c(this,e))),this.sheetProtection=e.sheetProtection,this.tables=e.tables.reduce(((e,t)=>{const r=new u;return r.model=t,e[t.name]=r,e}),{}),this.conditionalFormattings=e.conditionalFormattings}}},{"../utils/col-cache":19,"../utils/copy-style":20,"../utils/encryptor":21,"../utils/under-dash":26,"./column":4,"./data-validations":5,"./enums":7,"./image":8,"./range":10,"./row":11,"./table":12}],15:[function(e,t,r){"use strict";e("core-js/modules/es.promise"),e("core-js/modules/es.promise.finally"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.values"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.async-iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.find-index"),e("core-js/modules/es.array.find"),e("core-js/modules/es.string.from-code-point"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.number.is-nan"),e("regenerator-runtime/runtime");const n={Workbook:e("./doc/workbook")},i=e("./doc/enums");Object.keys(i).forEach((e=>{n[e]=i[e]})),t.exports=n},{"./doc/enums":7,"./doc/workbook":13,"core-js/modules/es.array.find":359,"core-js/modules/es.array.find-index":358,"core-js/modules/es.array.includes":360,"core-js/modules/es.array.iterator":361,"core-js/modules/es.number.is-nan":363,"core-js/modules/es.object.assign":364,"core-js/modules/es.object.keys":366,"core-js/modules/es.object.values":367,"core-js/modules/es.promise":372,"core-js/modules/es.promise.finally":371,"core-js/modules/es.string.from-code-point":376,"core-js/modules/es.string.includes":377,"core-js/modules/es.symbol":381,"core-js/modules/es.symbol.async-iterator":378,"regenerator-runtime/runtime":492}],16:[function(e,t,r){"use strict";const n="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8");r.bufferToString=function(e){return"string"==typeof e?e:n?n.decode(e):e.toString()}},{}],17:[function(e,t,r){"use strict";const n="undefined"==typeof TextEncoder?null:new TextEncoder("utf-8"),{Buffer:i}=e("buffer");r.stringToBuffer=function(e){return"string"!=typeof e?e:n?i.from(n.encode(e).buffer):i.from(e)}},{buffer:220}],18:[function(e,t,r){"use strict";const n=e("./under-dash"),i=e("./col-cache");t.exports=class{constructor(e){this.template=e,this.sheets={}}addCell(e){this.addCellEx(i.decodeEx(e))}getCell(e){return this.findCellEx(i.decodeEx(e),!0)}findCell(e){return this.findCellEx(i.decodeEx(e),!1)}findCellAt(e,t,r){const n=this.sheets[e],i=n&&n[t];return i&&i[r]}addCellEx(e){if(e.top)for(let t=e.top;t<=e.bottom;t++)for(let r=e.left;r<=e.right;r++)this.getCellAt(e.sheetName,t,r);else this.findCellEx(e,!0)}getCellEx(e){return this.findCellEx(e,!0)}findCellEx(e,t){const r=this.findSheet(e,t),n=this.findSheetRow(r,e,t);return this.findRowCell(n,e,t)}getCellAt(e,t,r){const n=this.sheets[e]||(this.sheets[e]=[]),s=n[t]||(n[t]=[]);return s[r]||(s[r]={sheetName:e,address:i.n2l(r)+t,row:t,col:r})}removeCellEx(e){const t=this.findSheet(e);if(!t)return;const r=this.findSheetRow(t,e);r&&delete r[e.col]}forEachInSheet(e,t){const r=this.sheets[e];r&&r.forEach(((e,r)=>{e&&e.forEach(((e,n)=>{e&&t(e,r,n)}))}))}forEach(e){n.each(this.sheets,((t,r)=>{this.forEachInSheet(r,e)}))}map(e){const t=[];return this.forEach((r=>{t.push(e(r))})),t}findSheet(e,t){const r=e.sheetName;return this.sheets[r]?this.sheets[r]:t?this.sheets[r]=[]:void 0}findSheetRow(e,t,r){const{row:n}=t;return e&&e[n]?e[n]:r?e[n]=[]:void 0}findRowCell(e,t,r){const{col:n}=t;return e&&e[n]?e[n]:r?e[n]=this.template?Object.assign(t,JSON.parse(JSON.stringify(this.template))):t:void 0}spliceRows(e,t,r,n){const i=this.sheets[e];if(i){const e=[];for(let t=0;t<n;t++)e.push([]);i.splice(t,r,...e)}}spliceColumns(e,t,r,i){const s=this.sheets[e];if(s){const e=[];for(let t=0;t<i;t++)e.push(null);n.each(s,(n=>{n.splice(t,r,...e)}))}}}},{"./col-cache":19,"./under-dash":26}],19:[function(e,t,r){"use strict";const i=/^[A-Z]+\d+$/,s={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:e=>e<=26?1:e<=676?2:3,_fill(e){let t,r,n,i,s,a=1;if(e>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&e>=1){for(;a<=26;)t=this._dictionary[a-1],this._n2l[a]=t,this._l2n[t]=a,a++;this._l2nFill=1}if(this._l2nFill<2&&e>=2){for(a=27;a<=702;)r=a-27,n=r%26,i=Math.floor(r/26),t=this._dictionary[i]+this._dictionary[n],this._n2l[a]=t,this._l2n[t]=a,a++;this._l2nFill=2}if(this._l2nFill<3&&e>=3){for(a=703;a<=16384;)r=a-703,n=r%26,i=Math.floor(r/26)%26,s=Math.floor(r/676),t=this._dictionary[s]+this._dictionary[i]+this._dictionary[n],this._n2l[a]=t,this._l2n[t]=a,a++;this._l2nFill=3}},l2n(e){if(this._l2n[e]||this._fill(e.length),!this._l2n[e])throw new Error("Out of bounds. Invalid column letter: "+e);return this._l2n[e]},n2l(e){if(e<1||e>16384)throw new Error(e+" is out of bounds. Excel supports columns from 1 to 16384");return this._n2l[e]||this._fill(this._level(e)),this._n2l[e]},_hash:{},validateAddress(e){if(!i.test(e))throw new Error("Invalid Address: "+e);return!0},decodeAddress(e){const t=e.length<5&&this._hash[e];if(t)return t;let r=!1,n="",i=0,s=!1,a="",o=0;for(let c,u=0;u<e.length;u++)if(c=e.charCodeAt(u),!s&&c>=65&&c<=90)r=!0,n+=e[u],i=26*i+c-64;else if(c>=48&&c<=57)s=!0,a+=e[u],o=10*o+c-48;else if(s&&r&&36!==c)break;if(r){if(i>16384)throw new Error("Out of bounds. Invalid column letter: "+n)}else i=void 0;s||(o=void 0);const l={address:e=n+a,col:i,row:o,$col$row:"$".concat(n,"$").concat(a)};return i<=100&&o<=100&&(this._hash[e]=l,this._hash[l.$col$row]=l),l},getAddress(e,t){if(t){const r=this.n2l(t)+e;return this.decodeAddress(r)}return this.decodeAddress(e)},decode(e){const t=e.split(":");if(2===t.length){const e=this.decodeAddress(t[0]),r=this.decodeAddress(t[1]),n={top:Math.min(e.row,r.row),left:Math.min(e.col,r.col),bottom:Math.max(e.row,r.row),right:Math.max(e.col,r.col)};return n.tl=this.n2l(n.left)+n.top,n.br=this.n2l(n.right)+n.bottom,n.dimensions="".concat(n.tl,":").concat(n.br),n}return this.decodeAddress(e)},decodeEx(e){const t=e.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),r=t[1]||t[2],i=t[3],s=i.split(":");if(s.length>1){let e=this.decodeAddress(s[0]),t=this.decodeAddress(s[1]);const n=Math.min(e.row,t.row),i=Math.min(e.col,t.col),a=Math.max(e.row,t.row),o=Math.max(e.col,t.col);return e=this.n2l(i)+n,t=this.n2l(o)+a,{top:n,left:i,bottom:a,right:o,sheetName:r,tl:{address:e,col:i,row:n,$col$row:"$".concat(this.n2l(i),"$").concat(n),sheetName:r},br:{address:t,col:o,row:a,$col$row:"$".concat(this.n2l(o),"$").concat(a),sheetName:r},dimensions:"".concat(e,":").concat(t)}}if(i.startsWith("#"))return r?{sheetName:r,error:i}:{error:i};const a=this.decodeAddress(i);return r?n({sheetName:r},a):a},encodeAddress:(e,t)=>s.n2l(t)+e,encode(){switch(arguments.length){case 2:return s.encodeAddress(arguments[0],arguments[1]);case 4:return"".concat(s.encodeAddress(arguments[0],arguments[1]),":").concat(s.encodeAddress(arguments[2],arguments[3]));default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange(e,t){const[r,n,,i,s]=e,[a,o]=t;return a>=r&&a<=i&&o>=n&&o<=s}};t.exports=s},{}],20:[function(e,t,r){"use strict";const i=(e,t)=>n(n({},e),t.reduce(((t,r)=>(e[r]&&(t[r]=n({},e[r])),t)),{})),s=function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];e[r]&&(t[r]=i(e[r],n))};r.copyStyle=e=>{if(!e)return e;if(t=e,0===Object.keys(t).length)return{};var t;const r=n({},e);return s(e,r,"font",["color"]),s(e,r,"alignment"),s(e,r,"protection"),e.border&&(s(e,r,"border"),s(e.border,r.border,"top",["color"]),s(e.border,r.border,"left",["color"]),s(e.border,r.border,"bottom",["color"]),s(e.border,r.border,"right",["color"]),s(e.border,r.border,"diagonal",["color"])),e.fill&&(s(e,r,"fill",["fgColor","bgColor","center"]),e.fill.stops&&(r.fill.stops=e.fill.stops.map((e=>i(e,["color"]))))),r}},{}],21:[function(e,t,r){(function(r){(function(){"use strict";const n=e("crypto"),i={hash(e){const t=n.createHash(e);for(var i=arguments.length,s=new Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];return t.update(r.concat(s)),t.digest()},convertPasswordToHash(e,t,i,s){if(t=t.toLowerCase(),n.getHashes().indexOf(t)<0)throw new Error("Hash algorithm '".concat(t,"' not supported!"));const a=r.from(e,"utf16le");let o=this.hash(t,r.from(i,"base64"),a);for(let n=0;n<s;n++){const e=r.alloc(4);e.writeUInt32LE(n,0),o=this.hash(t,o,e)}return o.toString("base64")},randomBytes:e=>n.randomBytes(e)};t.exports=i}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220,crypto:390}],22:[function(e,t,r){"use strict";const{SaxesParser:n}=e("saxes"),{PassThrough:o}=e("readable-stream"),{bufferToString:l}=e("./browser-buffer-decode");t.exports=function(){var e=s((function*(e){e.pipe&&!e[Symbol.asyncIterator]&&(e=e.pipe(new o));const t=new n;let r;t.on("error",(e=>{r=e}));let s=[];t.on("opentag",(e=>s.push({eventType:"opentag",value:e}))),t.on("text",(e=>s.push({eventType:"text",value:e}))),t.on("closetag",(e=>s.push({eventType:"closetag",value:e})));var c,u=!1,h=!1;try{for(var d,f=a(e);u=!(d=yield i(f.next())).done;u=!1){const e=d.value;if(t.write(l(e)),r)throw r;yield s,s=[]}}catch(p){h=!0,c=p}finally{try{u&&null!=f.return&&(yield i(f.return()))}finally{if(h)throw c}}}));return function(t){return e.apply(this,arguments)}}()},{"./browser-buffer-decode":16,"readable-stream":491,saxes:496}],23:[function(e,t,r){"use strict";const n=e("./col-cache"),i=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,s=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;t.exports={slideFormula:function(e,t,r){const a=n.decode(t),o=n.decode(r);return e.replace(i,((e,t,r,i,l)=>{if(l)return e;const c=s.exec(i);if(c){const r=c[1],i=c[2].toUpperCase(),s=c[3],l=c[4];if(i.length>3||3===i.length&&i>"XFD")return e;let u=n.l2n(i),h=parseInt(l,10);return r||(u+=o.col-a.col),s||(h+=o.row-a.row),(t||"")+(r||"")+n.n2l(u)+(s||"")+h}return e}))}}},{"./col-cache":19}],24:[function(e,t,r){(function(r,n){(function(){"use strict";const i=e("readable-stream"),s=e("./utils"),a=e("./string-buf");class o{constructor(e,t){this._data=e,this._encoding=t}get length(){return this.toBuffer().length}copy(e,t,r,n){return this.toBuffer().copy(e,t,r,n)}toBuffer(){return this._buffer||(this._buffer=n.from(this._data,this._encoding)),this._buffer}}class l{constructor(e){this._data=e}get length(){return this._data.length}copy(e,t,r,n){return this._data._buf.copy(e,t,r,n)}toBuffer(){return this._data.toBuffer()}}class c{constructor(e){this._data=e}get length(){return this._data.length}copy(e,t,r,n){this._data.copy(e,t,r,n)}toBuffer(){return this._data}}class u{constructor(e){this.size=e,this.buffer=n.alloc(e),this.iRead=0,this.iWrite=0}toBuffer(){if(0===this.iRead&&this.iWrite===this.size)return this.buffer;const e=n.alloc(this.iWrite-this.iRead);return this.buffer.copy(e,0,this.iRead,this.iWrite),e}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(e){let t;return 0===e?null:void 0===e||e>=this.length?(t=this.toBuffer(),this.iRead=this.iWrite,t):(t=n.alloc(e),this.buffer.copy(t,0,this.iRead,e),this.iRead+=e,t)}write(e,t,r){const n=Math.min(r,this.size-this.iWrite);return e.copy(this.buffer,this.iWrite,t,t+n),this.iWrite+=n,n}}const h=function(e){e=e||{},this.bufSize=e.bufSize||1048576,this.buffers=[],this.batch=e.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};s.inherits(h,i.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return n.concat(this.buffers.map((e=>e.toBuffer())))}},_getWritableBuffer(){if(this.buffers.length){const e=this.buffers[this.buffers.length-1];if(!e.full)return e}const e=new u(this.bufSize);return this.buffers.push(e),e},async _pipe(e){await Promise.all(this.pipes.map((function(t){return new Promise((r=>{t.write(e.toBuffer(),(()=>{r()}))}))})))},_writeToBuffers(e){let t=0;const r=e.length;for(;t<r;)t+=this._getWritableBuffer().write(e,t,r-t)},async write(e,t,i){let u;if(t instanceof Function&&(i=t,t="utf8"),i=i||s.nop,e instanceof a)u=new l(e);else if(e instanceof n)u=new c(e);else{if(!("string"==typeof e||e instanceof String||e instanceof ArrayBuffer))throw new Error("Chunk must be one of type String, Buffer or StringBuf.");u=new o(e,t)}if(this.pipes.length)if(this.batch)for(this._writeToBuffers(u);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(u),r.nextTick(i)):(await this._pipe(u),i());else this.paused||this.emit("data",u.toBuffer()),this._writeToBuffers(u),this.emit("readable");return!0},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(e,t,r){const n=e=>{e?r(e):(this._flush(),this.pipes.forEach((e=>{e.end()})),this.emit("finish"))};e?this.write(e,t,n):n()},read(e){let t;if(e){for(t=[];e&&this.buffers.length&&!this.buffers[0].eod;){const r=this.buffers[0],n=r.read(e);e-=n.length,t.push(n),r.eod&&r.full&&this.buffers.shift()}return n.concat(t)}return t=this.buffers.map((e=>e.toBuffer())).filter(Boolean),this.buffers=[],n.concat(t)},setEncoding(e){this.encoding=e},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(e){this.pipes.push(e),!this.paused&&this.buffers.length&&this.end()},unpipe(e){this.pipes=this.pipes.filter((t=>t!==e))},unshift(){throw new Error("Not Implemented")},wrap(){throw new Error("Not Implemented")}}),t.exports=h}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"./string-buf":25,"./utils":27,_process:467,buffer:220,"readable-stream":491}],25:[function(e,t,r){(function(e){(function(){"use strict";t.exports=class{constructor(t){this._buf=e.alloc(t&&t.size||16384),this._encoding=t&&t.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=e.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(e){e=e||0,this._buffer=void 0,this._inPos=e}_grow(t){let r=2*this._buf.length;for(;r<t;)r*=2;const n=e.alloc(r);this._buf.copy(n,0),this._buf=n}addText(e){this._buffer=void 0;let t=this._inPos+this._buf.write(e,this._inPos,this._encoding);for(;t>=this._buf.length-4;)this._grow(this._inPos+e.length),t=this._inPos+this._buf.write(e,this._inPos,this._encoding);this._inPos=t}addStringBuf(e){e.length&&(this._buffer=void 0,this.length+e.length>this.capacity&&this._grow(this.length+e.length),e._buf.copy(this._buf,this._inPos,0,e.length),this._inPos+=e.length)}}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220}],26:[function(e,t,r){"use strict";const{toString:n}=Object.prototype,i=/["&<>]/,s={each:function(e,t){e&&(Array.isArray(e)?e.forEach(t):Object.keys(e).forEach((r=>{t(e[r],r)})))},some:function(e,t){return!!e&&(Array.isArray(e)?e.some(t):Object.keys(e).some((r=>t(e[r],r))))},every:function(e,t){return!e||(Array.isArray(e)?e.every(t):Object.keys(e).every((r=>t(e[r],r))))},map:function(e,t){return e?Array.isArray(e)?e.map(t):Object.keys(e).map((r=>t(e[r],r))):[]},keyBy:(e,t)=>e.reduce(((e,r)=>(e[r[t]]=r,e)),{}),isEqual:function(e,t){const r=typeof e,n=typeof t,i=Array.isArray(e),a=Array.isArray(t);let o;if(r!==n)return!1;if("object"===typeof e){if(i||a)return!(!i||!a)&&e.length===t.length&&e.every(((e,r)=>{const n=t[r];return s.isEqual(e,n)}));if(null===e||null===t)return e===t;if(o=Object.keys(e),Object.keys(t).length!==o.length)return!1;for(const e of o)if(!t.hasOwnProperty(e))return!1;return s.every(e,((e,r)=>{const n=t[r];return s.isEqual(e,n)}))}return e===t},escapeHtml(e){const t=i.exec(e);if(!t)return e;let r="",n="",s=0,a=t.index;for(;a<e.length;a++){switch(e.charAt(a)){case'"':n="&quot;";break;case"&":n="&amp;";break;case"'":n="&apos;";break;case"<":n="&lt;";break;case">":n="&gt;";break;default:continue}s!==a&&(r+=e.substring(s,a)),s=a+1,r+=n}return s!==a?r+e.substring(s,a):r},strcmp:(e,t)=>e<t?-1:e>t?1:0,isUndefined:e=>"[object Undefined]"===n.call(e),isObject:e=>"[object Object]"===n.call(e),deepMerge(){const e=arguments[0]||{},{length:t}=arguments;let r,n,i;function a(t,a){r=e[a],i=Array.isArray(t),s.isObject(t)||i?(i?(i=!1,n=r&&Array.isArray(r)?r:[]):n=r&&s.isObject(r)?r:{},e[a]=s.deepMerge(n,t)):s.isUndefined(t)||(e[a]=t)}for(let o=0;o<t;o++)s.each(arguments[o],a);return e}};t.exports=s},{}],27:[function(e,t,n){(function(r,n){(function(){"use strict";const i=e("fs"),s=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,a={nop(){},promiseImmediate:e=>new Promise((t=>{r.setImmediate?n((()=>{t(e)})):setTimeout((()=>{t(e)}),1)})),inherits:function(e,t,r,n){e.super_=t,n||(n=r,r=null),r&&Object.keys(r).forEach((t=>{Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}));const i={constructor:{value:e,enumerable:!1,writable:!1,configurable:!0}};n&&Object.keys(n).forEach((e=>{i[e]=Object.getOwnPropertyDescriptor(n,e)})),e.prototype=Object.create(t.prototype,i)},dateToExcel:(e,t)=>25569+e.getTime()/864e5-(t?1462:0),excelToDate(e,t){const r=Math.round(24*(e-25569+(t?1462:0))*3600*1e3);return new Date(r)},parsePath(e){const t=e.lastIndexOf("/");return{path:e.substring(0,t),name:e.substring(t+1)}},getRelsPath(e){const t=a.parsePath(e);return"".concat(t.path,"/_rels/").concat(t.name,".rels")},xmlEncode(e){const t=s.exec(e);if(!t)return e;let r="",n="",i=0,a=t.index;for(;a<e.length;a++){const t=e.charCodeAt(a);switch(t){case 34:n="&quot;";break;case 38:n="&amp;";break;case 39:n="&apos;";break;case 60:n="&lt;";break;case 62:n="&gt;";break;case 127:n="";break;default:if(t<=31&&(t<=8||t>=11&&13!==t)){n="";break}continue}i!==a&&(r+=e.substring(i,a)),i=a+1,n&&(r+=n)}return i!==a?r+e.substring(i,a):r},xmlDecode:e=>e.replace(/&([a-z]*);/g,(e=>{switch(e){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return e}})),validInt(e){const t=parseInt(e,10);return Number.isNaN(t)?0:t},isDateFmt:e=>!!e&&null!==(e=(e=e.replace(/\[[^\]]*]/g,"")).replace(/"[^"]*"/g,"")).match(/[ymdhMsb]+/),fs:{exists:e=>new Promise((t=>{i.access(e,i.constants.F_OK,(e=>{t(!e)}))}))},toIsoDateString:e=>e.toIsoString().subsstr(0,10),parseBoolean:e=>!0===e||"true"===e||1===e||"1"===e};t.exports=a}).call(this)}).call(this,"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{fs:216,timers:523}],28:[function(e,t,r){"use strict";const n=e("./under-dash"),i=e("./utils");function s(e,t,r){e.push(" ".concat(t,'="').concat(i.xmlEncode(r.toString()),'"'))}function a(e,t){if(t){const r=[];n.each(t,((e,t)=>{void 0!==e&&s(r,t,e)})),e.push(r.join(""))}}class o{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(e){const t=this._xml;t.push("<?xml"),a(t,e),t.push("?>\n")}openNode(e,t){const r=this.tos,n=this._xml;r&&this.open&&n.push(">"),this._stack.push(e),n.push("<"),n.push(e),a(n,t),this.leaf=!0,this.open=!0}addAttribute(e,t){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");void 0!==t&&s(this._xml,e,t)}addAttributes(e){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");a(this._xml,e)}writeText(e){const t=this._xml;this.open&&(t.push(">"),this.open=!1),this.leaf=!1,t.push(i.xmlEncode(e.toString()))}writeXml(e){this.open&&(this._xml.push(">"),this.open=!1),this.leaf=!1,this._xml.push(e)}closeNode(){const e=this._stack.pop(),t=this._xml;this.leaf?t.push("/>"):(t.push("</"),t.push(e),t.push(">")),this.open=!1,this.leaf=!1}leafNode(e,t,r){this.openNode(e,t),void 0!==r&&this.writeText(r),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){const e=this._rollbacks.pop();this._xml.length>e.xml&&this._xml.splice(e.xml,this._xml.length-e.xml),this._stack.length>e.stack&&this._stack.splice(e.stack,this._stack.length-e.stack),this.leaf=e.leaf,this.open=e.open}get xml(){return this.closeAll(),this._xml.join("")}}o.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},t.exports=o},{"./under-dash":26,"./utils":27}],29:[function(e,t,r){(function(r){(function(){"use strict";const n=e("events"),i=e("jszip"),s=e("./stream-buf"),{stringToBuffer:a}=e("./browser-buffer-encode");class o extends n.EventEmitter{constructor(e){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},e),this.zip=new i,this.stream=new s}append(e,t){t.hasOwnProperty("base64")&&t.base64?this.zip.file(t.name,e,{base64:!0}):(r.browser&&"string"==typeof e&&(e=a(e)),this.zip.file(t.name,e))}async finalize(){const e=await this.zip.generateAsync(this.options);this.stream.end(e),this.emit("finish")}read(e){return this.stream.read(e)}setEncoding(e){return this.stream.setEncoding(e)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(e,t){return this.stream.pipe(e,t)}unpipe(e){return this.stream.unpipe(e)}unshift(e){return this.stream.unshift(e)}wrap(e){return this.stream.wrap(e)}}t.exports={ZipWriter:o}}).call(this)}).call(this,e("_process"))},{"./browser-buffer-encode":17,"./stream-buf":24,_process:467,events:422,jszip:441}],30:[function(e,t,r){"use strict";t.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"\u5e74"m"\u6708"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"\u5e74" mm"\u6708" dd"\u65e5"'},28:{"zh-tw":'[$-404]e"\u5e74"m"\u6708"d"\u65e5"',"zh-cn":'m"\u6708"d"\u65e5"',"ja-jp":'[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e"\u5e74"m"\u6708"d"\u65e5"',"zh-cn":'m"\u6708"d"\u65e5"',"ja-jp":'[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy"\u5e74"m"\u6708"d"\u65e5"',"zh-cn":'yyyy"\u5e74"m"\u6708"d"\u65e5"',"ja-jp":'yyyy"\u5e74"m"\u6708"d"\u65e5"',"ko-kr":'yyyy"\ub144" mm"\uc6d4" dd"\uc77c"'},32:{"zh-tw":'hh"\u6642"mm"\u5206"',"zh-cn":'h"\u65f6"mm"\u5206"',"ja-jp":'h"\u6642"mm"\u5206"',"ko-kr":'h"\uc2dc" mm"\ubd84"'},33:{"zh-tw":'hh"\u6642"mm"\u5206"ss"\u79d2"',"zh-cn":'h"\u65f6"mm"\u5206"ss"\u79d2"',"ja-jp":'h"\u6642"mm"\u5206"ss"\u79d2"',"ko-kr":'h"\uc2dc" mm"\ubd84" ss"\ucd08"'},34:{"zh-tw":'\u4e0a\u5348/\u4e0b\u5348 hh"\u6642"mm"\u5206"',"zh-cn":'\u4e0a\u5348/\u4e0b\u5348 h"\u65f6"mm"\u5206"',"ja-jp":'yyyy"\u5e74"m"\u6708"',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'\u4e0a\u5348/\u4e0b\u5348 hh"\u6642"mm"\u5206"ss"\u79d2"',"zh-cn":'\u4e0a\u5348/\u4e0b\u5348 h"\u65f6"mm"\u5206"ss"\u79d2"',"ja-jp":'m"\u6708"d"\u65e5"',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"\u5e74"m"\u6708"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"\u5e74" mm"\u6708" dd"\u65e5"'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"\u5e74"m"\u6708"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"\u5e74" mm"\u6708" dd"\u65e5"'},51:{"zh-tw":'[$-404]e"\u5e74"m"\u6708"d"\u65e5"',"zh-cn":'m"\u6708"d"\u65e5"',"ja-jp":'[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',"ko-kr":"mm-dd"},52:{"zh-tw":'\u4e0a\u5348/\u4e0b\u5348 hh"\u6642"mm"\u5206"',"zh-cn":'yyyy"\u5e74"m"\u6708"',"ja-jp":'yyyy"\u5e74"m"\u6708"',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'\u4e0a\u5348/\u4e0b\u5348 hh"\u6642"mm"\u5206"ss"\u79d2"',"zh-cn":'m"\u6708"d"\u65e5"',"ja-jp":'m"\u6708"d"\u65e5"',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e"\u5e74"m"\u6708"d"\u65e5"',"zh-cn":'m"\u6708"d"\u65e5"',"ja-jp":'[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',"ko-kr":"mm-dd"},55:{"zh-tw":'\u4e0a\u5348/\u4e0b\u5348 hh"\u6642"mm"\u5206"',"zh-cn":'\u4e0a\u5348/\u4e0b\u5348 h"\u65f6"mm"\u5206"',"ja-jp":'yyyy"\u5e74"m"\u6708"',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'\u4e0a\u5348/\u4e0b\u5348 hh"\u6642"mm"\u5206"ss"\u79d2"',"zh-cn":'\u4e0a\u5348/\u4e0b\u5348 h"\u65f6"mm"\u5206"ss"\u79d2"',"ja-jp":'m"\u6708"d"\u65e5"',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"\u5e74"m"\u6708"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"\u5e74" mm"\u6708" dd"\u65e5"'},58:{"zh-tw":'[$-404]e"\u5e74"m"\u6708"d"\u65e5"',"zh-cn":'m"\u6708"d"\u65e5"',"ja-jp":'[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}},{}],31:[function(e,t,r){"use strict";t.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}},{}],32:[function(e,t,r){"use strict";const n=e("../../utils/parse-sax"),i=e("../../utils/xml-stream");class s{prepare(){}render(){}parseOpen(e){}parseText(e){}parseClose(e){}reconcile(e,t){}reset(){this.model=null,this.map&&Object.values(this.map).forEach((e=>{e instanceof s?e.reset():e.xform&&e.xform.reset()}))}mergeModel(e){this.model=Object.assign(this.model||{},e)}async parse(e){var t,r=!1,n=!1;try{for(var i,s=a(e);r=!(i=await s.next()).done;r=!1){const e=i.value;for(const{eventType:t,value:r}of e)if("opentag"===t)this.parseOpen(r);else if("text"===t)this.parseText(r);else if("closetag"===t&&!this.parseClose(r.name))return this.model}}catch(o){n=!0,t=o}finally{try{r&&null!=s.return&&await s.return()}finally{if(n)throw t}}return this.model}async parseStream(e){return this.parse(n(e))}get xml(){return this.toXml(this.model)}toXml(e){const t=new i;return this.render(t,e),t.xml}static toAttribute(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===e){if(r)return t}else if(r||e!==t)return e.toString()}static toStringAttribute(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return s.toAttribute(e,t,r)}static toStringValue(e,t){return void 0===e?t:e}static toBoolAttribute(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===e){if(r)return t}else if(r||e!==t)return e?"1":"0"}static toBoolValue(e,t){return void 0===e?t:"1"===e}static toIntAttribute(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return s.toAttribute(e,t,r)}static toIntValue(e,t){return void 0===e?t:parseInt(e,10)}static toFloatAttribute(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return s.toAttribute(e,t,r)}static toFloatValue(e,t){return void 0===e?t:parseFloat(e)}}t.exports=s},{"../../utils/parse-sax":22,"../../utils/xml-stream":28}],33:[function(e,t,r){"use strict";const n=e("../base-xform"),i=e("../../../utils/col-cache");function s(e){try{return i.decodeEx(e),!0}catch(e){return!1}}function a(e){const t=[];let r=!1,n="";return e.split(",").forEach((e=>{if(!e)return;const i=(e.match(/'/g)||[]).length;if(!i)return void(r?n+=e+",":s(e)&&t.push(e));const a=i%2==0;!r&&a&&s(e)?t.push(e):r&&!a?(r=!1,s(n+e)&&t.push(n+e),n=""):(r=!0,n+=e+",")})),t}t.exports=class extends n{render(e,t){e.openNode("definedName",{name:t.name,localSheetId:t.localSheetId}),e.writeText(t.ranges.join(",")),e.closeNode()}parseOpen(e){return"definedName"===e.name&&(this._parsedName=e.attributes.name,this._parsedLocalSheetId=e.attributes.localSheetId,this._parsedText=[],!0)}parseText(e){this._parsedText.push(e)}parseClose(){return this.model={name:this._parsedName,ranges:a(this._parsedText.join(""))},void 0!==this._parsedLocalSheetId&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}}},{"../../../utils/col-cache":19,"../base-xform":32}],34:[function(e,t,r){"use strict";const n=e("../../../utils/utils"),i=e("../base-xform");t.exports=class extends i{render(e,t){e.leafNode("sheet",{sheetId:t.id,name:t.name,state:t.state,"r:id":t.rId})}parseOpen(e){return"sheet"===e.name&&(this.model={name:n.xmlDecode(e.attributes.name),id:parseInt(e.attributes.sheetId,10),state:e.attributes.state,rId:e.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/utils":27,"../base-xform":32}],35:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{render(e,t){e.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:t.fullCalcOnLoad?1:void 0})}parseOpen(e){return"calcPr"===e.name&&(this.model={},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],36:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{render(e,t){e.leafNode("workbookPr",{date1904:t.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(e){return"workbookPr"===e.name&&(this.model={date1904:"1"===e.attributes.date1904},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],37:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{render(e,t){const r={xWindow:t.x||0,yWindow:t.y||0,windowWidth:t.width||12e3,windowHeight:t.height||24e3,firstSheet:t.firstSheet,activeTab:t.activeTab};t.visibility&&"visible"!==t.visibility&&(r.visibility=t.visibility),e.leafNode("workbookView",r)}parseOpen(e){if("workbookView"===e.name){const t=this.model={},r=function(e,r,n){const i=void 0!==r?t[e]=r:n;void 0!==i&&(t[e]=i)},n=function(e,r,n){const i=void 0!==r?t[e]=parseInt(r,10):n;void 0!==i&&(t[e]=i)};return n("x",e.attributes.xWindow,0),n("y",e.attributes.yWindow,0),n("width",e.attributes.windowWidth,25e3),n("height",e.attributes.windowHeight,1e4),r("visibility",e.attributes.visibility,"visible"),n("activeTab",e.attributes.activeTab,void 0),n("firstSheet",e.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],38:[function(e,t,r){"use strict";const n=e("../../../utils/under-dash"),i=e("../../../utils/col-cache"),s=e("../../../utils/xml-stream"),a=e("../base-xform"),o=e("../static-xform"),l=e("../list-xform"),c=e("./defined-name-xform"),u=e("./sheet-xform"),h=e("./workbook-view-xform"),d=e("./workbook-properties-xform"),f=e("./workbook-calc-properties-xform");class p extends a{constructor(){super(),this.map={fileVersion:p.STATIC_XFORMS.fileVersion,workbookPr:new d,bookViews:new l({tag:"bookViews",count:!1,childXform:new h}),sheets:new l({tag:"sheets",count:!1,childXform:new u}),definedNames:new l({tag:"definedNames",count:!1,childXform:new c}),calcPr:new f}}prepare(e){e.sheets=e.worksheets;const t=[];let r=0;e.sheets.forEach((e=>{if(e.pageSetup&&e.pageSetup.printArea&&e.pageSetup.printArea.split("&&").forEach((n=>{const i=n.split(":"),s={name:"_xlnm.Print_Area",ranges:["'".concat(e.name,"'!$").concat(i[0],":$").concat(i[1])],localSheetId:r};t.push(s)})),e.pageSetup&&(e.pageSetup.printTitlesRow||e.pageSetup.printTitlesColumn)){const n=[];if(e.pageSetup.printTitlesColumn){const t=e.pageSetup.printTitlesColumn.split(":");n.push("'".concat(e.name,"'!$").concat(t[0],":$").concat(t[1]))}if(e.pageSetup.printTitlesRow){const t=e.pageSetup.printTitlesRow.split(":");n.push("'".concat(e.name,"'!$").concat(t[0],":$").concat(t[1]))}const i={name:"_xlnm.Print_Titles",ranges:n,localSheetId:r};t.push(i)}r++})),t.length&&(e.definedNames=e.definedNames.concat(t)),(e.media||[]).forEach(((e,t)=>{e.name=e.type+(t+1)}))}render(e,t){e.openXml(s.StdDocAttributes),e.openNode("workbook",p.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(e),this.map.workbookPr.render(e,t.properties),this.map.bookViews.render(e,t.views),this.map.sheets.render(e,t.sheets),this.map.definedNames.render(e,t.definedNames),this.map.calcPr.render(e,t.calcProperties),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):("workbook"===e.name||(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):"workbook"!==e||(this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1)}reconcile(e){const t=(e.workbookRels||[]).reduce(((e,t)=>(e[t.Id]=t,e)),{}),r=[];let s,a=0;(e.sheets||[]).forEach((n=>{const i=t[n.rId];i&&(s=e.worksheetHash["xl/"+i.Target.replace(/^(\s|\/xl\/)+/,"")],s&&(s.name=n.name,s.id=n.id,s.state=n.state,r[a++]=s))}));const o=[];n.each(e.definedNames,(e=>{if("_xlnm.Print_Area"===e.name){if(s=r[e.localSheetId],s){s.pageSetup||(s.pageSetup={});const t=i.decodeEx(e.ranges[0]);s.pageSetup.printArea=s.pageSetup.printArea?"".concat(s.pageSetup.printArea,"&&").concat(t.dimensions):t.dimensions}}else if("_xlnm.Print_Titles"===e.name){if(s=r[e.localSheetId],s){s.pageSetup||(s.pageSetup={});const t=e.ranges.join(","),r=/\$/g,n=/\$\d+:\$\d+/,i=t.match(n);if(i&&i.length){const e=i[0];s.pageSetup.printTitlesRow=e.replace(r,"")}const a=/\$[A-Z]+:\$[A-Z]+/,o=t.match(a);if(o&&o.length){const e=o[0];s.pageSetup.printTitlesColumn=e.replace(r,"")}}}else o.push(e)})),e.definedNames=o,e.media.forEach(((e,t)=>{e.index=t}))}}p.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},p.STATIC_XFORMS={fileVersion:new o({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})},t.exports=p},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./defined-name-xform":33,"./sheet-xform":34,"./workbook-calc-properties-xform":35,"./workbook-properties-xform":36,"./workbook-view-xform":37}],39:[function(e,t,r){"use strict";const i=e("../strings/rich-text-xform"),s=e("../../../utils/utils"),a=e("../base-xform"),o=t.exports=function(e){this.model=e};s.inherits(o,a,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new i),this._richTextXform},render(e,t){t=t||this.model,e.openNode("comment",{ref:t.ref,authorId:0}),e.openNode("text"),t&&t.note&&t.note.texts&&t.note.texts.forEach((t=>{this.richTextXform.render(e,t)})),e.closeNode(),e.closeNode()},parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"comment":return this.model=n({type:"note",note:{texts:[]}},e.attributes),!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(e),!0;default:return!1}},parseText(e){this.parser&&this.parser.parseText(e)},parseClose(e){switch(e){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(e),!0}}})},{"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],40:[function(e,t,r){"use strict";const n=e("../../../utils/xml-stream"),i=e("../../../utils/utils"),s=e("../base-xform"),a=e("./comment-xform"),o=t.exports=function(){this.map={comment:new a}};i.inherits(o,s,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(e,t){t=t||this.model,e.openXml(n.StdDocAttributes),e.openNode("comments",o.COMMENTS_ATTRIBUTES),e.openNode("authors"),e.leafNode("author",null,"Author"),e.closeNode(),e.openNode("commentList"),t.comments.forEach((t=>{this.map.comment.render(e,t)})),e.closeNode(),e.closeNode()},parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(e),!0;default:return!1}},parseText(e){this.parser&&this.parser.parseText(e)},parseClose(e){switch(e){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(e),!0}}})},{"../../../utils/utils":27,"../../../utils/xml-stream":28,"../base-xform":32,"./comment-xform":39}],41:[function(e,t,r){"use strict";const n=e("../../base-xform");t.exports=class extends n{constructor(e){super(),this._model=e}get tag(){return this._model&&this._model.tag}render(e,t,r){(t===r[2]||"x:SizeWithCells"===this.tag&&t===r[1])&&e.leafNode(this.tag)}parseOpen(e){return e.name===this.tag&&(this.model={},this.model[this.tag]=!0,!0)}parseText(){}parseClose(){return!1}}},{"../../base-xform":32}],42:[function(e,t,r){"use strict";const n=e("../../base-xform");t.exports=class extends n{constructor(e){super(),this._model=e}get tag(){return this._model&&this._model.tag}render(e,t){e.leafNode(this.tag,null,t)}parseOpen(e){return e.name===this.tag&&(this.text="",!0)}parseText(e){this.text=e}parseClose(){return!1}}},{"../../base-xform":32}],43:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"x:Anchor"}getAnchorRect(e){const t=Math.floor(e.left),r=Math.floor(68*(e.left-t)),n=Math.floor(e.top),i=Math.floor(18*(e.top-n)),s=Math.floor(e.right),a=Math.floor(68*(e.right-s)),o=Math.floor(e.bottom);return[t,r,n,i,s,a,o,Math.floor(18*(e.bottom-o))]}getDefaultRect(e){const t=e.col,r=Math.max(e.row-2,0);return[t,6,r,14,t+2,2,r+4,16]}render(e,t){const r=t.anchor?this.getAnchorRect(t.anchor):this.getDefaultRect(t.refAddress);e.leafNode("x:Anchor",null,r.join(", "))}parseOpen(e){return e.name===this.tag&&(this.text="",!0)}parseText(e){this.text=e}parseClose(){return!1}}},{"../base-xform":32}],44:[function(e,t,r){"use strict";const n=e("../base-xform"),i=e("./vml-anchor-xform"),s=e("./style/vml-protection-xform"),a=e("./style/vml-position-xform"),o=["twoCells","oneCells","absolute"];t.exports=class extends n{constructor(){super(),this.map={"x:Anchor":new i,"x:Locked":new s({tag:"x:Locked"}),"x:LockText":new s({tag:"x:LockText"}),"x:SizeWithCells":new a({tag:"x:SizeWithCells"}),"x:MoveWithCells":new a({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(e,t){const{protection:r,editAs:n}=t.note;e.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(e,n,o),this.map["x:SizeWithCells"].render(e,n,o),this.map["x:Anchor"].render(e,t),this.map["x:Locked"].render(e,r.locked),e.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(e,r.lockText),e.leafNode("x:Row",null,t.refAddress.row-1),e.leafNode("x:Column",null,t.refAddress.col-1),e.closeNode()}parseOpen(e){return e.name===this.tag?(this.reset(),this.model={anchor:[],protection:{},editAs:""}):(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.normalizeModel(),!1)}normalizeModel(){const e=Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model),t=Object.keys(e).length;this.model.editAs=o[t],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}}},{"../base-xform":32,"./style/vml-position-xform":41,"./style/vml-protection-xform":42,"./vml-anchor-xform":43}],45:[function(e,t,r){"use strict";const n=e("../../../utils/xml-stream"),i=e("../base-xform"),s=e("./vml-shape-xform");class a extends i{constructor(){super(),this.map={"v:shape":new s}}get tag(){return"xml"}render(e,t){e.openXml(n.StdDocAttributes),e.openNode(this.tag,a.DRAWING_ATTRIBUTES),e.openNode("o:shapelayout",{"v:ext":"edit"}),e.leafNode("o:idmap",{"v:ext":"edit",data:1}),e.closeNode(),e.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),e.leafNode("v:stroke",{joinstyle:"miter"}),e.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),e.closeNode(),t.comments.forEach(((t,r)=>{this.map["v:shape"].render(e,t,r)})),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):(e.name===this.tag?(this.reset(),this.model={comments:[]}):(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0):e!==this.tag}reconcile(e,t){e.anchors.forEach((e=>{e.br?this.map["xdr:twoCellAnchor"].reconcile(e,t):this.map["xdr:oneCellAnchor"].reconcile(e,t)}))}}a.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},t.exports=a},{"../../../utils/xml-stream":28,"../base-xform":32,"./vml-shape-xform":46}],46:[function(e,t,r){"use strict";const n=e("../base-xform"),i=e("./vml-textbox-xform"),s=e("./vml-client-data-xform");class a extends n{constructor(){super(),this.map={"v:textbox":new i,"x:ClientData":new s}}get tag(){return"v:shape"}render(e,t,r){e.openNode("v:shape",a.V_SHAPE_ATTRIBUTES(t,r)),e.leafNode("v:fill",{color2:"infoBackground [80]"}),e.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),e.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(e,t),this.map["x:ClientData"].render(e,t),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):(e.name===this.tag?(this.reset(),this.model={margins:{insetmode:e.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}}):(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1)}}a.V_SHAPE_ATTRIBUTES=(e,t)=>({id:"_x0000_s"+(1025+t),type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":e.note.margins&&e.note.margins.insetmode}),t.exports=a},{"../base-xform":32,"./vml-client-data-xform":44,"./vml-textbox-xform":47}],47:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"v:textbox"}conversionUnit(e,t,r){return"".concat(parseFloat(e)*t.toFixed(2)).concat(r)}reverseConversionUnit(e){return(e||"").split(",").map((e=>Number(parseFloat(this.conversionUnit(parseFloat(e),.1,"")).toFixed(2))))}render(e,t){const r={style:"mso-direction-alt:auto"};if(t&&t.note){let{inset:e}=t.note&&t.note.margins;Array.isArray(e)&&(e=e.map((e=>this.conversionUnit(e,10,"mm"))).join(",")),e&&(r.inset=e)}e.openNode("v:textbox",r),e.leafNode("div",{style:"text-align:left"}),e.closeNode()}parseOpen(e){return e.name!==this.tag||(this.model={inset:this.reverseConversionUnit(e.attributes.inset)},!0)}parseText(){}parseClose(e){return e!==this.tag}}},{"../base-xform":32}],48:[function(e,t,r){"use strict";const n=e("./base-xform");t.exports=class extends n{createNewModel(e){return{}}parseOpen(e){return this.parser=this.parser||this.map[e.name],this.parser?(this.parser.parseOpen(e),!0):e.name===this.tag&&(this.model=this.createNewModel(e),!0)}parseText(e){this.parser&&this.parser.parseText(e)}onParserClose(e,t){this.model[e]=t.model}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.onParserClose(e,this.parser),this.parser=void 0),!0):e!==this.tag}}},{"./base-xform":32}],49:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{render(e,t){e.openNode("HeadingPairs"),e.openNode("vt:vector",{size:2,baseType:"variant"}),e.openNode("vt:variant"),e.leafNode("vt:lpstr",void 0,"Worksheets"),e.closeNode(),e.openNode("vt:variant"),e.leafNode("vt:i4",void 0,t.length),e.closeNode(),e.closeNode(),e.closeNode()}parseOpen(e){return"HeadingPairs"===e.name}parseText(){}parseClose(e){return"HeadingPairs"!==e}}},{"../base-xform":32}],50:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{render(e,t){e.openNode("TitlesOfParts"),e.openNode("vt:vector",{size:t.length,baseType:"lpstr"}),t.forEach((t=>{e.leafNode("vt:lpstr",void 0,t.name)})),e.closeNode(),e.closeNode()}parseOpen(e){return"TitlesOfParts"===e.name}parseText(){}parseClose(e){return"TitlesOfParts"!==e}}},{"../base-xform":32}],51:[function(e,t,r){"use strict";const n=e("../../../utils/xml-stream"),i=e("../base-xform"),s=e("../simple/string-xform"),a=e("./app-heading-pairs-xform"),o=e("./app-titles-of-parts-xform");class l extends i{constructor(){super(),this.map={Company:new s({tag:"Company"}),Manager:new s({tag:"Manager"}),HeadingPairs:new a,TitleOfParts:new o}}render(e,t){e.openXml(n.StdDocAttributes),e.openNode("Properties",l.PROPERTY_ATTRIBUTES),e.leafNode("Application",void 0,"Microsoft Excel"),e.leafNode("DocSecurity",void 0,"0"),e.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(e,t.worksheets),this.map.TitleOfParts.render(e,t.worksheets),this.map.Company.render(e,t.company||""),this.map.Manager.render(e,t.manager),e.leafNode("LinksUpToDate",void 0,"false"),e.leafNode("SharedDoc",void 0,"false"),e.leafNode("HyperlinksChanged",void 0,"false"),e.leafNode("AppVersion",void 0,"16.0300"),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):"Properties"===e.name||(this.parser=this.map[e.name],!!this.parser&&(this.parser.parseOpen(e),!0))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):"Properties"!==e||(this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1)}}l.DateFormat=function(e){return e.toISOString().replace(/[.]\d{3,6}/,"")},l.DateAttrs={"xsi:type":"dcterms:W3CDTF"},l.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},t.exports=l},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/string-xform":119,"./app-heading-pairs-xform":49,"./app-titles-of-parts-xform":50}],52:[function(e,t,r){"use strict";const n=e("../../../utils/xml-stream"),i=e("../base-xform");class s extends i{render(e,t){e.openXml(n.StdDocAttributes),e.openNode("Types",s.PROPERTY_ATTRIBUTES);const r={};(t.media||[]).forEach((t=>{if("image"===t.type){const n=t.extension;r[n]||(r[n]=!0,e.leafNode("Default",{Extension:n,ContentType:"image/"+n}))}})),e.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),e.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),e.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),t.worksheets.forEach((t=>{const r="/xl/worksheets/sheet".concat(t.id,".xml");e.leafNode("Override",{PartName:r,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})})),e.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),e.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),t.sharedStrings&&t.sharedStrings.count&&e.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),t.tables&&t.tables.forEach((t=>{e.leafNode("Override",{PartName:"/xl/tables/"+t.target,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})})),t.drawings&&t.drawings.forEach((t=>{e.leafNode("Override",{PartName:"/xl/drawings/".concat(t.name,".xml"),ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})})),t.commentRefs&&(e.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),t.commentRefs.forEach((t=>{let{commentName:r}=t;e.leafNode("Override",{PartName:"/xl/".concat(r,".xml"),ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})}))),e.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),e.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),e.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}}s.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},t.exports=s},{"../../../utils/xml-stream":28,"../base-xform":32}],53:[function(e,t,r){"use strict";const n=e("../../../utils/xml-stream"),i=e("../base-xform"),s=e("../simple/date-xform"),a=e("../simple/string-xform"),o=e("../simple/integer-xform");class l extends i{constructor(){super(),this.map={"dc:creator":new a({tag:"dc:creator"}),"dc:title":new a({tag:"dc:title"}),"dc:subject":new a({tag:"dc:subject"}),"dc:description":new a({tag:"dc:description"}),"dc:identifier":new a({tag:"dc:identifier"}),"dc:language":new a({tag:"dc:language"}),"cp:keywords":new a({tag:"cp:keywords"}),"cp:category":new a({tag:"cp:category"}),"cp:lastModifiedBy":new a({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new s({tag:"cp:lastPrinted",format:l.DateFormat}),"cp:revision":new o({tag:"cp:revision"}),"cp:version":new a({tag:"cp:version"}),"cp:contentStatus":new a({tag:"cp:contentStatus"}),"cp:contentType":new a({tag:"cp:contentType"}),"dcterms:created":new s({tag:"dcterms:created",attrs:l.DateAttrs,format:l.DateFormat}),"dcterms:modified":new s({tag:"dcterms:modified",attrs:l.DateAttrs,format:l.DateFormat})}}render(e,t){e.openXml(n.StdDocAttributes),e.openNode("cp:coreProperties",l.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(e,t.creator),this.map["dc:title"].render(e,t.title),this.map["dc:subject"].render(e,t.subject),this.map["dc:description"].render(e,t.description),this.map["dc:identifier"].render(e,t.identifier),this.map["dc:language"].render(e,t.language),this.map["cp:keywords"].render(e,t.keywords),this.map["cp:category"].render(e,t.category),this.map["cp:lastModifiedBy"].render(e,t.lastModifiedBy),this.map["cp:lastPrinted"].render(e,t.lastPrinted),this.map["cp:revision"].render(e,t.revision),this.map["cp:version"].render(e,t.version),this.map["cp:contentStatus"].render(e,t.contentStatus),this.map["cp:contentType"].render(e,t.contentType),this.map["dcterms:created"].render(e,t.created),this.map["dcterms:modified"].render(e,t.modified),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[e.name],this.parser)return this.parser.parseOpen(e),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(e))}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error("Unexpected xml node in parseClose: "+e)}}}l.DateFormat=function(e){return e.toISOString().replace(/[.]\d{3}/,"")},l.DateAttrs={"xsi:type":"dcterms:W3CDTF"},l.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},t.exports=l},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/date-xform":117,"../simple/integer-xform":118,"../simple/string-xform":119}],54:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{render(e,t){e.leafNode("Relationship",t)}parseOpen(e){return"Relationship"===e.name&&(this.model=e.attributes,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],55:[function(e,t,r){"use strict";const n=e("../../../utils/xml-stream"),i=e("../base-xform"),s=e("./relationship-xform");class a extends i{constructor(){super(),this.map={Relationship:new s}}render(e,t){t=t||this._values,e.openXml(n.StdDocAttributes),e.openNode("Relationships",a.RELATIONSHIPS_ATTRIBUTES),t.forEach((t=>{this.map.Relationship.render(e,t)})),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if("Relationships"===e.name)return this.model=[],!0;if(this.parser=this.map[e.name],this.parser)return this.parser.parseOpen(e),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(e))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.push(this.parser.model),this.parser=void 0),!0;if("Relationships"===e)return!1;throw new Error("Unexpected xml node in parseClose: "+e)}}a.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},t.exports=a},{"../../../utils/xml-stream":28,"../base-xform":32,"./relationship-xform":54}],56:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):(e.name===this.tag?(this.reset(),this.model={range:{editAs:e.attributes.editAs||"oneCell"}}):(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0)}parseText(e){this.parser&&this.parser.parseText(e)}reconcilePicture(e,t){if(e&&e.rId){const r=t.rels[e.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(r){const e=r[1],n=t.mediaIndex[e];return t.media[n]}}}}},{"../base-xform":32}],57:[function(e,t,r){"use strict";const n=e("../base-xform"),i=e("./blip-xform");t.exports=class extends n{constructor(){super(),this.map={"a:blip":new i}}get tag(){return"xdr:blipFill"}render(e,t){e.openNode(this.tag),this.map["a:blip"].render(e,t),e.openNode("a:stretch"),e.leafNode("a:fillRect"),e.closeNode(),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):(e.name===this.tag?this.reset():(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0)}parseText(){}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model=this.map["a:blip"].model,!1)}}},{"../base-xform":32,"./blip-xform":58}],58:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"a:blip"}render(e,t){e.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":t.rId,cstate:"print"})}parseOpen(e){return e.name!==this.tag||(this.model={rId:e.attributes["r:embed"]},!0)}parseText(){}parseClose(e){return e!==this.tag}}},{"../base-xform":32}],59:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"xdr:cNvPicPr"}render(e){e.openNode(this.tag),e.leafNode("a:picLocks",{noChangeAspect:"1"}),e.closeNode()}parseOpen(e){return e.name,this.tag,!0}parseText(){}parseClose(e){return e!==this.tag}}},{"../base-xform":32}],60:[function(e,t,r){"use strict";const n=e("../base-xform"),i=e("./hlink-click-xform"),s=e("./ext-lst-xform");t.exports=class extends n{constructor(){super(),this.map={"a:hlinkClick":new i,"a:extLst":new s}}get tag(){return"xdr:cNvPr"}render(e,t){e.openNode(this.tag,{id:t.index,name:"Picture "+t.index}),this.map["a:hlinkClick"].render(e,t),this.map["a:extLst"].render(e,t),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):(e.name===this.tag?this.reset():(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0)}parseText(){}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model=this.map["a:hlinkClick"].model,!1)}}},{"../base-xform":32,"./ext-lst-xform":63,"./hlink-click-xform":65}],61:[function(e,t,r){"use strict";const n=e("../base-xform"),i=e("../simple/integer-xform");t.exports=class extends n{constructor(e){super(),this.tag=e.tag,this.map={"xdr:col":new i({tag:"xdr:col",zero:!0}),"xdr:colOff":new i({tag:"xdr:colOff",zero:!0}),"xdr:row":new i({tag:"xdr:row",zero:!0}),"xdr:rowOff":new i({tag:"xdr:rowOff",zero:!0})}}render(e,t){e.openNode(this.tag),this.map["xdr:col"].render(e,t.nativeCol),this.map["xdr:colOff"].render(e,t.nativeColOff),this.map["xdr:row"].render(e,t.nativeRow),this.map["xdr:rowOff"].render(e,t.nativeRowOff),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):(e.name===this.tag?this.reset():(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1)}}},{"../base-xform":32,"../simple/integer-xform":118}],62:[function(e,t,r){"use strict";const n=e("../../../utils/col-cache"),i=e("../../../utils/xml-stream"),s=e("../base-xform"),a=e("./two-cell-anchor-xform"),o=e("./one-cell-anchor-xform");class l extends s{constructor(){super(),this.map={"xdr:twoCellAnchor":new a,"xdr:oneCellAnchor":new o}}prepare(e){e.anchors.forEach(((e,t)=>{e.anchorType=function(e){return("string"==typeof e.range?n.decode(e.range):e.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor"}(e),this.map[e.anchorType].prepare(e,{index:t})}))}get tag(){return"xdr:wsDr"}render(e,t){e.openXml(i.StdDocAttributes),e.openNode(this.tag,l.DRAWING_ATTRIBUTES),t.anchors.forEach((t=>{this.map[t.anchorType].render(e,t)})),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):(e.name===this.tag?(this.reset(),this.model={anchors:[]}):(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0):e!==this.tag}reconcile(e,t){e.anchors.forEach((e=>{e.br?this.map["xdr:twoCellAnchor"].reconcile(e,t):this.map["xdr:oneCellAnchor"].reconcile(e,t)}))}}l.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},t.exports=l},{"../../../utils/col-cache":19,"../../../utils/xml-stream":28,"../base-xform":32,"./one-cell-anchor-xform":67,"./two-cell-anchor-xform":70}],63:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"a:extLst"}render(e){e.openNode(this.tag),e.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),e.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),e.closeNode(),e.closeNode()}parseOpen(e){return e.name,this.tag,!0}parseText(){}parseClose(e){return e!==this.tag}}},{"../base-xform":32}],64:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{constructor(e){super(),this.tag=e.tag,this.map={}}render(e,t){e.openNode(this.tag);const r=Math.floor(9525*t.width),n=Math.floor(9525*t.height);e.addAttribute("cx",r),e.addAttribute("cy",n),e.closeNode()}parseOpen(e){return e.name===this.tag&&(this.model={width:parseInt(e.attributes.cx||"0",10)/9525,height:parseInt(e.attributes.cy||"0",10)/9525},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],65:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"a:hlinkClick"}render(e,t){t.hyperlinks&&t.hyperlinks.rId&&e.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":t.hyperlinks.rId,tooltip:t.hyperlinks.tooltip})}parseOpen(e){return e.name!==this.tag||(this.model={hyperlinks:{rId:e.attributes["r:id"],tooltip:e.attributes.tooltip}},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],66:[function(e,t,r){"use strict";const n=e("../base-xform"),i=e("./c-nv-pr-xform"),s=e("./c-nv-pic-pr-xform");t.exports=class extends n{constructor(){super(),this.map={"xdr:cNvPr":new i,"xdr:cNvPicPr":new s}}get tag(){return"xdr:nvPicPr"}render(e,t){e.openNode(this.tag),this.map["xdr:cNvPr"].render(e,t),this.map["xdr:cNvPicPr"].render(e,t),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):(e.name===this.tag?this.reset():(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0)}parseText(){}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model=this.map["xdr:cNvPr"].model,!1)}}},{"../base-xform":32,"./c-nv-pic-pr-xform":59,"./c-nv-pr-xform":60}],67:[function(e,t,r){"use strict";const n=e("./base-cell-anchor-xform"),i=e("../static-xform"),s=e("./cell-position-xform"),a=e("./ext-xform"),o=e("./pic-xform");t.exports=class extends n{constructor(){super(),this.map={"xdr:from":new s({tag:"xdr:from"}),"xdr:ext":new a({tag:"xdr:ext"}),"xdr:pic":new o,"xdr:clientData":new i({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(e,t){this.map["xdr:pic"].prepare(e.picture,t)}render(e,t){e.openNode(this.tag,{editAs:t.range.editAs||"oneCell"}),this.map["xdr:from"].render(e,t.range.tl),this.map["xdr:ext"].render(e,t.range.ext),this.map["xdr:pic"].render(e,t.picture),this.map["xdr:clientData"].render(e,{}),e.closeNode()}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1)}reconcile(e,t){e.medium=this.reconcilePicture(e.picture,t)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./ext-xform":64,"./pic-xform":68}],68:[function(e,t,r){"use strict";const n=e("../base-xform"),i=e("../static-xform"),s=e("./blip-fill-xform"),a=e("./nv-pic-pr-xform"),o=e("./sp-pr");t.exports=class extends n{constructor(){super(),this.map={"xdr:nvPicPr":new a,"xdr:blipFill":new s,"xdr:spPr":new i(o)}}get tag(){return"xdr:pic"}prepare(e,t){e.index=t.index+1}render(e,t){e.openNode(this.tag),this.map["xdr:nvPicPr"].render(e,t),this.map["xdr:blipFill"].render(e,t),this.map["xdr:spPr"].render(e,t),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):(e.name===this.tag?this.reset():(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0)}parseText(){}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.mergeModel(this.parser.model),this.parser=void 0),!0):e!==this.tag}}},{"../base-xform":32,"../static-xform":120,"./blip-fill-xform":57,"./nv-pic-pr-xform":66,"./sp-pr":69}],69:[function(e,t,r){"use strict";t.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}},{}],70:[function(e,t,r){"use strict";const n=e("./base-cell-anchor-xform"),i=e("../static-xform"),s=e("./cell-position-xform"),a=e("./pic-xform");t.exports=class extends n{constructor(){super(),this.map={"xdr:from":new s({tag:"xdr:from"}),"xdr:to":new s({tag:"xdr:to"}),"xdr:pic":new a,"xdr:clientData":new i({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(e,t){this.map["xdr:pic"].prepare(e.picture,t)}render(e,t){e.openNode(this.tag,{editAs:t.range.editAs||"oneCell"}),this.map["xdr:from"].render(e,t.range.tl),this.map["xdr:to"].render(e,t.range.br),this.map["xdr:pic"].render(e,t.picture),this.map["xdr:clientData"].render(e,{}),e.closeNode()}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1)}reconcile(e,t){e.medium=this.reconcilePicture(e.picture,t)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./pic-xform":68}],71:[function(e,t,r){"use strict";const n=e("./base-xform");t.exports=class extends n{constructor(e){super(),this.tag=e.tag,this.always=!!e.always,this.count=e.count,this.empty=e.empty,this.$count=e.$count||"count",this.$=e.$,this.childXform=e.childXform,this.maxItems=e.maxItems}prepare(e,t){const{childXform:r}=this;e&&e.forEach(((e,n)=>{t.index=n,r.prepare(e,t)}))}render(e,t){if(this.always||t&&t.length){e.openNode(this.tag,this.$),this.count&&e.addAttribute(this.$count,t&&t.length||0);const{childXform:r}=this;(t||[]).forEach(((t,n)=>{r.render(e,t,n)})),e.closeNode()}else this.empty&&e.leafNode(this.tag)}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):e.name===this.tag?(this.model=[],!0):!!this.childXform.parseOpen(e)&&(this.parser=this.childXform,!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw new Error("Max ".concat(this.childXform.tag," count (").concat(this.maxItems,") exceeded"));return!0}return!1}reconcile(e,t){if(e){const{childXform:r}=this;e.forEach((e=>{r.reconcile(e,t)}))}}}},{"./base-xform":32}],72:[function(e,t,r){"use strict";const n=e("../../../utils/col-cache"),i=e("../base-xform");t.exports=class extends i{get tag(){return"autoFilter"}render(e,t){if(t)if("string"==typeof t)e.leafNode("autoFilter",{ref:t});else{const r=function(e){return"string"==typeof e?e:n.getAddress(e.row,e.column).address},i=r(t.from),s=r(t.to);i&&s&&e.leafNode("autoFilter",{ref:"".concat(i,":").concat(s)})}}parseOpen(e){"autoFilter"===e.name&&(this.model=e.attributes.ref)}}},{"../../../utils/col-cache":19,"../base-xform":32}],73:[function(e,t,r){"use strict";const i=e("../../../utils/utils"),s=e("../base-xform"),a=e("../../../doc/range"),o=e("../../../doc/enums"),l=e("../strings/rich-text-xform");function c(e){if(null==e)return o.ValueType.Null;if(e instanceof String||"string"==typeof e)return o.ValueType.String;if("number"==typeof e)return o.ValueType.Number;if("boolean"==typeof e)return o.ValueType.Boolean;if(e instanceof Date)return o.ValueType.Date;if(e.text&&e.hyperlink)return o.ValueType.Hyperlink;if(e.formula)return o.ValueType.Formula;if(e.error)return o.ValueType.Error;throw new Error("I could not understand type of value")}t.exports=class extends s{constructor(){super(),this.richTextXForm=new l}get tag(){return"c"}prepare(e,t){const r=t.styles.addStyleModel(e.style||{},function(e){return e.type===o.ValueType.Formula?c(e.result):e.type}(e));switch(r&&(e.styleId=r),e.comment&&t.comments.push(n(n({},e.comment),{},{ref:e.address})),e.type){case o.ValueType.String:case o.ValueType.RichText:t.sharedStrings&&(e.ssId=t.sharedStrings.add(e.value));break;case o.ValueType.Date:t.date1904&&(e.date1904=!0);break;case o.ValueType.Hyperlink:t.sharedStrings&&void 0!==e.text&&null!==e.text&&(e.ssId=t.sharedStrings.add(e.text)),t.hyperlinks.push({address:e.address,target:e.hyperlink,tooltip:e.tooltip});break;case o.ValueType.Merge:t.merges.add(e);break;case o.ValueType.Formula:if(t.date1904&&(e.date1904=!0),"shared"===e.shareType&&(e.si=t.siFormulae++),e.formula)t.formulae[e.address]=e;else if(e.sharedFormula){const r=t.formulae[e.sharedFormula];if(!r)throw new Error("Shared Formula master must exist above and or left of clone for cell "+e.address);void 0===r.si?(r.shareType="shared",r.si=t.siFormulae++,r.range=new a(r.address,e.address)):r.range&&r.range.expandToAddress(e.address),e.si=r.si}}}renderFormula(e,t){let r=null;switch(t.shareType){case"shared":r={t:"shared",ref:t.ref||t.range.range,si:t.si};break;case"array":r={t:"array",ref:t.ref};break;default:void 0!==t.si&&(r={t:"shared",si:t.si})}switch(c(t.result)){case o.ValueType.Null:e.leafNode("f",r,t.formula);break;case o.ValueType.String:e.addAttribute("t","str"),e.leafNode("f",r,t.formula),e.leafNode("v",null,t.result);break;case o.ValueType.Number:e.leafNode("f",r,t.formula),e.leafNode("v",null,t.result);break;case o.ValueType.Boolean:e.addAttribute("t","b"),e.leafNode("f",r,t.formula),e.leafNode("v",null,t.result?1:0);break;case o.ValueType.Error:e.addAttribute("t","e"),e.leafNode("f",r,t.formula),e.leafNode("v",null,t.result.error);break;case o.ValueType.Date:e.leafNode("f",r,t.formula),e.leafNode("v",null,i.dateToExcel(t.result,t.date1904));break;default:throw new Error("I could not understand type of value")}}render(e,t){if(t.type!==o.ValueType.Null||t.styleId){switch(e.openNode("c"),e.addAttribute("r",t.address),t.styleId&&e.addAttribute("s",t.styleId),t.type){case o.ValueType.Null:break;case o.ValueType.Number:e.leafNode("v",null,t.value);break;case o.ValueType.Boolean:e.addAttribute("t","b"),e.leafNode("v",null,t.value?"1":"0");break;case o.ValueType.Error:e.addAttribute("t","e"),e.leafNode("v",null,t.value.error);break;case o.ValueType.String:case o.ValueType.RichText:void 0!==t.ssId?(e.addAttribute("t","s"),e.leafNode("v",null,t.ssId)):t.value&&t.value.richText?(e.addAttribute("t","inlineStr"),e.openNode("is"),t.value.richText.forEach((t=>{this.richTextXForm.render(e,t)})),e.closeNode("is")):(e.addAttribute("t","str"),e.leafNode("v",null,t.value));break;case o.ValueType.Date:e.leafNode("v",null,i.dateToExcel(t.value,t.date1904));break;case o.ValueType.Hyperlink:void 0!==t.ssId?(e.addAttribute("t","s"),e.leafNode("v",null,t.ssId)):(e.addAttribute("t","str"),e.leafNode("v",null,t.text));break;case o.ValueType.Formula:this.renderFormula(e,t);case o.ValueType.Merge:}e.closeNode()}}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"c":return this.model={address:e.attributes.r},this.t=e.attributes.t,e.attributes.s&&(this.model.styleId=parseInt(e.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=e.attributes.si,this.model.shareType=e.attributes.t,this.model.ref=e.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){if(this.parser)this.parser.parseText(e);else switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+e:e;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+e:e:this.model.value=this.model.value?this.model.value+e:e}}parseClose(e){switch(e){case"c":{const{model:e}=this;if(e.formula||e.shareType)e.type=o.ValueType.Formula,e.value&&("str"===this.t?e.result=i.xmlDecode(e.value):"b"===this.t?e.result=0!==parseInt(e.value,10):"e"===this.t?e.result={error:e.value}:e.result=parseFloat(e.value),e.value=void 0);else if(void 0!==e.value)switch(this.t){case"s":e.type=o.ValueType.String,e.value=parseInt(e.value,10);break;case"str":e.type=o.ValueType.String,e.value=i.xmlDecode(e.value);break;case"inlineStr":e.type=o.ValueType.String;break;case"b":e.type=o.ValueType.Boolean,e.value=0!==parseInt(e.value,10);break;case"e":e.type=o.ValueType.Error,e.value={error:e.value};break;default:e.type=o.ValueType.Number,e.value=parseFloat(e.value)}else e.styleId?e.type=o.ValueType.Null:e.type=o.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?(this.parser.parseClose(e),!0):(this.currentNode=void 0,!0);case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return!!this.parser&&(this.parser.parseClose(e),!0)}}reconcile(e,t){const r=e.styleId&&t.styles&&t.styles.getStyleModel(e.styleId);switch(r&&(e.style=r),void 0!==e.styleId&&(e.styleId=void 0),e.type){case o.ValueType.String:"number"==typeof e.value&&t.sharedStrings&&(e.value=t.sharedStrings.getString(e.value)),e.value.richText&&(e.type=o.ValueType.RichText);break;case o.ValueType.Number:r&&i.isDateFmt(r.numFmt)&&(e.type=o.ValueType.Date,e.value=i.excelToDate(e.value,t.date1904));break;case o.ValueType.Formula:void 0!==e.result&&r&&i.isDateFmt(r.numFmt)&&(e.result=i.excelToDate(e.result,t.date1904)),"shared"===e.shareType&&(e.ref?t.formulae[e.si]=e.address:(e.sharedFormula=t.formulae[e.si],delete e.shareType),delete e.si)}const n=t.hyperlinkMap[e.address];n&&(e.type===o.ValueType.Formula?(e.text=e.result,e.result=void 0):(e.text=e.value,e.value=void 0),e.type=o.ValueType.Hyperlink,e.hyperlink=n);const s=t.commentsMap&&t.commentsMap[e.address];s&&(e.comment=s)}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],74:[function(e,t,r){"use strict";const n=e("../../base-xform");t.exports=class extends n{get tag(){return"x14:cfIcon"}render(e,t){e.leafNode(this.tag,{iconSet:t.iconSet,iconId:t.iconId})}parseOpen(e){let{attributes:t}=e;this.model={iconSet:t.iconSet,iconId:n.toIntValue(t.iconId)}}parseClose(e){return e!==this.tag}}},{"../../base-xform":32}],75:[function(e,t,r){"use strict";const{v4:n}=e("uuid"),i=e("../../base-xform"),s=e("../../composite-xform"),a=e("./databar-ext-xform"),o=e("./icon-set-ext-xform"),l={"3Triangles":!0,"3Stars":!0,"5Boxes":!0};class c extends s{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new a,"x14:iconSet":this.iconSetXform=new o}}get tag(){return"x14:cfRule"}static isExt(e){return"dataBar"===e.type?a.isExt(e):!("iconSet"!==e.type||!e.custom&&!l[e.iconSet])}prepare(e){c.isExt(e)&&(e.x14Id="{".concat(n(),"}").toUpperCase())}render(e,t){if(c.isExt(t))switch(t.type){case"dataBar":this.renderDataBar(e,t);break;case"iconSet":this.renderIconSet(e,t)}}renderDataBar(e,t){e.openNode(this.tag,{type:"dataBar",id:t.x14Id}),this.databarXform.render(e,t),e.closeNode()}renderIconSet(e,t){e.openNode(this.tag,{type:"iconSet",priority:t.priority,id:t.x14Id||"{".concat(n(),"}")}),this.iconSetXform.render(e,t),e.closeNode()}createNewModel(e){let{attributes:t}=e;return{type:t.type,x14Id:t.id,priority:i.toIntValue(t.priority)}}onParserClose(e,t){Object.assign(this.model,t.model)}}t.exports=c},{"../../base-xform":32,"../../composite-xform":48,"./databar-ext-xform":79,"./icon-set-ext-xform":81,uuid:528}],76:[function(e,t,r){"use strict";const n=e("../../composite-xform"),i=e("./f-ext-xform");t.exports=class extends n{constructor(){super(),this.map={"xm:f":this.fExtXform=new i}}get tag(){return"x14:cfvo"}render(e,t){e.openNode(this.tag,{type:t.type}),void 0!==t.value&&this.fExtXform.render(e,t.value),e.closeNode()}createNewModel(e){return{type:e.attributes.type}}onParserClose(e,t){"xm:f"===e&&(this.model.value=t.model?parseFloat(t.model):0)}}},{"../../composite-xform":48,"./f-ext-xform":80}],77:[function(e,t,r){"use strict";const n=e("../../composite-xform"),i=e("./sqref-ext-xform"),s=e("./cf-rule-ext-xform");t.exports=class extends n{constructor(){super(),this.map={"xm:sqref":this.sqRef=new i,"x14:cfRule":this.cfRule=new s}}get tag(){return"x14:conditionalFormatting"}prepare(e,t){e.rules.forEach((e=>{this.cfRule.prepare(e,t)}))}render(e,t){t.rules.some(s.isExt)&&(e.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),t.rules.filter(s.isExt).forEach((t=>this.cfRule.render(e,t))),this.sqRef.render(e,t.ref),e.closeNode())}createNewModel(){return{rules:[]}}onParserClose(e,t){switch(e){case"xm:sqref":this.model.ref=t.model;break;case"x14:cfRule":this.model.rules.push(t.model)}}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./sqref-ext-xform":82}],78:[function(e,t,r){"use strict";const n=e("../../composite-xform"),i=e("./cf-rule-ext-xform"),s=e("./conditional-formatting-ext-xform");t.exports=class extends n{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new s}}get tag(){return"x14:conditionalFormattings"}hasContent(e){return void 0===e.hasExtContent&&(e.hasExtContent=e.some((e=>e.rules.some(i.isExt)))),e.hasExtContent}prepare(e,t){e.forEach((e=>{this.cfXform.prepare(e,t)}))}render(e,t){this.hasContent(t)&&(e.openNode(this.tag),t.forEach((t=>this.cfXform.render(e,t))),e.closeNode())}createNewModel(){return[]}onParserClose(e,t){this.model.push(t.model)}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./conditional-formatting-ext-xform":77}],79:[function(e,t,r){"use strict";const n=e("../../base-xform"),i=e("../../composite-xform"),s=e("../../style/color-xform"),a=e("./cfvo-ext-xform");t.exports=class extends i{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new a,"x14:borderColor":this.borderColorXform=new s("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new s("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new s("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new s("x14:axisColor")}}static isExt(e){return!e.gradient}get tag(){return"x14:dataBar"}render(e,t){e.openNode(this.tag,{minLength:n.toIntAttribute(t.minLength,0,!0),maxLength:n.toIntAttribute(t.maxLength,100,!0),border:n.toBoolAttribute(t.border,!1),gradient:n.toBoolAttribute(t.gradient,!0),negativeBarColorSameAsPositive:n.toBoolAttribute(t.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:n.toBoolAttribute(t.negativeBarBorderColorSameAsPositive,!0),axisPosition:n.toAttribute(t.axisPosition,"auto"),direction:n.toAttribute(t.direction,"leftToRight")}),t.cfvo.forEach((t=>{this.cfvoXform.render(e,t)})),this.borderColorXform.render(e,t.borderColor),this.negativeBorderColorXform.render(e,t.negativeBorderColor),this.negativeFillColorXform.render(e,t.negativeFillColor),this.axisColorXform.render(e,t.axisColor),e.closeNode()}createNewModel(e){let{attributes:t}=e;return{cfvo:[],minLength:n.toIntValue(t.minLength,0),maxLength:n.toIntValue(t.maxLength,100),border:n.toBoolValue(t.border,!1),gradient:n.toBoolValue(t.gradient,!0),negativeBarColorSameAsPositive:n.toBoolValue(t.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:n.toBoolValue(t.negativeBarBorderColorSameAsPositive,!0),axisPosition:n.toStringValue(t.axisPosition,"auto"),direction:n.toStringValue(t.direction,"leftToRight")}}onParserClose(e,t){const[,r]=e.split(":");"cfvo"===r?this.model.cfvo.push(t.model):this.model[r]=t.model}}},{"../../base-xform":32,"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-ext-xform":76}],80:[function(e,t,r){"use strict";const n=e("../../base-xform");t.exports=class extends n{get tag(){return"xm:f"}render(e,t){e.leafNode(this.tag,null,t)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}}},{"../../base-xform":32}],81:[function(e,t,r){"use strict";const n=e("../../base-xform"),i=e("../../composite-xform"),s=e("./cfvo-ext-xform"),a=e("./cf-icon-ext-xform");t.exports=class extends i{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new s,"x14:cfIcon":this.cfIconXform=new a}}get tag(){return"x14:iconSet"}render(e,t){e.openNode(this.tag,{iconSet:n.toStringAttribute(t.iconSet),reverse:n.toBoolAttribute(t.reverse,!1),showValue:n.toBoolAttribute(t.showValue,!0),custom:n.toBoolAttribute(t.icons,!1)}),t.cfvo.forEach((t=>{this.cfvoXform.render(e,t)})),t.icons&&t.icons.forEach(((t,r)=>{t.iconId=r,this.cfIconXform.render(e,t)})),e.closeNode()}createNewModel(e){let{attributes:t}=e;return{cfvo:[],iconSet:n.toStringValue(t.iconSet,"3TrafficLights"),reverse:n.toBoolValue(t.reverse,!1),showValue:n.toBoolValue(t.showValue,!0)}}onParserClose(e,t){const[,r]=e.split(":");switch(r){case"cfvo":this.model.cfvo.push(t.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(t.model);break;default:this.model[r]=t.model}}}},{"../../base-xform":32,"../../composite-xform":48,"./cf-icon-ext-xform":74,"./cfvo-ext-xform":76}],82:[function(e,t,r){"use strict";const n=e("../../base-xform");t.exports=class extends n{get tag(){return"xm:sqref"}render(e,t){e.leafNode(this.tag,null,t)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}}},{"../../base-xform":32}],83:[function(e,t,r){"use strict";const i=e("../../base-xform"),s=e("../../composite-xform"),a=e("../../../../doc/range"),o=e("./databar-xform"),l=e("./ext-lst-ref-xform"),c=e("./formula-xform"),u=e("./color-scale-xform"),h=e("./icon-set-xform"),d={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},f=e=>{const{type:t,operator:r}=e;switch(t){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:t};default:return{type:t,operator:r}}};class p extends s{constructor(){super(),this.map={dataBar:this.databarXform=new o,extLst:this.extLstRefXform=new l,formula:this.formulaXform=new c,colorScale:this.colorScaleXform=new u,iconSet:this.iconSetXform=new h}}get tag(){return"cfRule"}static isPrimitive(e){return"iconSet"!==e.type||!e.custom&&!d[e.iconSet]}render(e,t){switch(t.type){case"expression":this.renderExpression(e,t);break;case"cellIs":this.renderCellIs(e,t);break;case"top10":this.renderTop10(e,t);break;case"aboveAverage":this.renderAboveAverage(e,t);break;case"dataBar":this.renderDataBar(e,t);break;case"colorScale":this.renderColorScale(e,t);break;case"iconSet":this.renderIconSet(e,t);break;case"containsText":this.renderText(e,t);break;case"timePeriod":this.renderTimePeriod(e,t)}}renderExpression(e,t){e.openNode(this.tag,{type:"expression",dxfId:t.dxfId,priority:t.priority}),this.formulaXform.render(e,t.formulae[0]),e.closeNode()}renderCellIs(e,t){e.openNode(this.tag,{type:"cellIs",dxfId:t.dxfId,priority:t.priority,operator:t.operator}),t.formulae.forEach((t=>{this.formulaXform.render(e,t)})),e.closeNode()}renderTop10(e,t){e.leafNode(this.tag,{type:"top10",dxfId:t.dxfId,priority:t.priority,percent:i.toBoolAttribute(t.percent,!1),bottom:i.toBoolAttribute(t.bottom,!1),rank:i.toIntValue(t.rank,10,!0)})}renderAboveAverage(e,t){e.leafNode(this.tag,{type:"aboveAverage",dxfId:t.dxfId,priority:t.priority,aboveAverage:i.toBoolAttribute(t.aboveAverage,!0)})}renderDataBar(e,t){e.openNode(this.tag,{type:"dataBar",priority:t.priority}),this.databarXform.render(e,t),this.extLstRefXform.render(e,t),e.closeNode()}renderColorScale(e,t){e.openNode(this.tag,{type:"colorScale",priority:t.priority}),this.colorScaleXform.render(e,t),e.closeNode()}renderIconSet(e,t){p.isPrimitive(t)&&(e.openNode(this.tag,{type:"iconSet",priority:t.priority}),this.iconSetXform.render(e,t),e.closeNode())}renderText(e,t){e.openNode(this.tag,{type:t.operator,dxfId:t.dxfId,priority:t.priority,operator:i.toStringAttribute(t.operator,"containsText")});const r=(e=>{if(e.formulae&&e.formulae[0])return e.formulae[0];const t=new a(e.ref),{tl:r}=t;switch(e.operator){case"containsText":return'NOT(ISERROR(SEARCH("'.concat(e.text,'",').concat(r,")))");case"containsBlanks":return"LEN(TRIM(".concat(r,"))=0");case"notContainsBlanks":return"LEN(TRIM(".concat(r,"))>0");case"containsErrors":return"ISERROR(".concat(r,")");case"notContainsErrors":return"NOT(ISERROR(".concat(r,"))");default:return}})(t);r&&this.formulaXform.render(e,r),e.closeNode()}renderTimePeriod(e,t){e.openNode(this.tag,{type:"timePeriod",dxfId:t.dxfId,priority:t.priority,timePeriod:t.timePeriod});const r=(e=>{if(e.formulae&&e.formulae[0])return e.formulae[0];const t=new a(e.ref),{tl:r}=t;switch(e.timePeriod){case"thisWeek":return"AND(TODAY()-ROUNDDOWN(".concat(r,",0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(").concat(r,",0)-TODAY()<=7-WEEKDAY(TODAY()))");case"lastWeek":return"AND(TODAY()-ROUNDDOWN(".concat(r,",0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(").concat(r,",0)<(WEEKDAY(TODAY())+7))");case"nextWeek":return"AND(ROUNDDOWN(".concat(r,",0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(").concat(r,",0)-TODAY()<(15-WEEKDAY(TODAY())))");case"yesterday":return"FLOOR(".concat(r,",1)=TODAY()-1");case"today":return"FLOOR(".concat(r,",1)=TODAY()");case"tomorrow":return"FLOOR(".concat(r,",1)=TODAY()+1");case"last7Days":return"AND(TODAY()-FLOOR(".concat(r,",1)<=6,FLOOR(").concat(r,",1)<=TODAY())");case"lastMonth":return"AND(MONTH(".concat(r,")=MONTH(EDATE(TODAY(),0-1)),YEAR(").concat(r,")=YEAR(EDATE(TODAY(),0-1)))");case"thisMonth":return"AND(MONTH(".concat(r,")=MONTH(TODAY()),YEAR(").concat(r,")=YEAR(TODAY()))");case"nextMonth":return"AND(MONTH(".concat(r,")=MONTH(EDATE(TODAY(),0+1)),YEAR(").concat(r,")=YEAR(EDATE(TODAY(),0+1)))");default:return}})(t);r&&this.formulaXform.render(e,r),e.closeNode()}createNewModel(e){let{attributes:t}=e;return n(n({},f(t)),{},{dxfId:i.toIntValue(t.dxfId),priority:i.toIntValue(t.priority),timePeriod:t.timePeriod,percent:i.toBoolValue(t.percent),bottom:i.toBoolValue(t.bottom),rank:i.toIntValue(t.rank),aboveAverage:i.toBoolValue(t.aboveAverage)})}onParserClose(e,t){switch(e){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,t.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(t.model)}}}t.exports=p},{"../../../../doc/range":10,"../../base-xform":32,"../../composite-xform":48,"./color-scale-xform":85,"./databar-xform":88,"./ext-lst-ref-xform":89,"./formula-xform":90,"./icon-set-xform":91}],84:[function(e,t,r){"use strict";const n=e("../../base-xform");t.exports=class extends n{get tag(){return"cfvo"}render(e,t){e.leafNode(this.tag,{type:t.type,val:t.value})}parseOpen(e){this.model={type:e.attributes.type,value:n.toFloatValue(e.attributes.val)}}parseClose(e){return e!==this.tag}}},{"../../base-xform":32}],85:[function(e,t,r){"use strict";const n=e("../../composite-xform"),i=e("../../style/color-xform"),s=e("./cfvo-xform");t.exports=class extends n{constructor(){super(),this.map={cfvo:this.cfvoXform=new s,color:this.colorXform=new i}}get tag(){return"colorScale"}render(e,t){e.openNode(this.tag),t.cfvo.forEach((t=>{this.cfvoXform.render(e,t)})),t.color.forEach((t=>{this.colorXform.render(e,t)})),e.closeNode()}createNewModel(e){return{cfvo:[],color:[]}}onParserClose(e,t){this.model[e].push(t.model)}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],86:[function(e,t,r){"use strict";const n=e("../../composite-xform"),i=e("./cf-rule-xform");t.exports=class extends n{constructor(){super(),this.map={cfRule:new i}}get tag(){return"conditionalFormatting"}render(e,t){t.rules.some(i.isPrimitive)&&(e.openNode(this.tag,{sqref:t.ref}),t.rules.forEach((r=>{i.isPrimitive(r)&&(r.ref=t.ref,this.map.cfRule.render(e,r))})),e.closeNode())}createNewModel(e){let{attributes:t}=e;return{ref:t.sqref,rules:[]}}onParserClose(e,t){this.model.rules.push(t.model)}}},{"../../composite-xform":48,"./cf-rule-xform":83}],87:[function(e,t,r){"use strict";const n=e("../../base-xform"),i=e("./conditional-formatting-xform");t.exports=class extends n{constructor(){super(),this.cfXform=new i}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(e,t){let r=e.reduce(((e,t)=>Math.max(e,...t.rules.map((e=>e.priority||0)))),1);e.forEach((e=>{e.rules.forEach((e=>{e.priority||(e.priority=r++),e.style&&(e.dxfId=t.styles.addDxfStyle(e.style))}))}))}render(e,t){t.forEach((t=>{this.cfXform.render(e,t)}))}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):"conditionalFormatting"===e.name&&(this.parser=this.cfXform,this.parser.parseOpen(e),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return!!this.parser&&(!!this.parser.parseClose(e)||(this.model.push(this.parser.model),this.parser=void 0,!1))}reconcile(e,t){e.forEach((e=>{e.rules.forEach((e=>{void 0!==e.dxfId&&(e.style=t.styles.getDxfStyle(e.dxfId),delete e.dxfId)}))}))}}},{"../../base-xform":32,"./conditional-formatting-xform":86}],88:[function(e,t,r){"use strict";const n=e("../../composite-xform"),i=e("../../style/color-xform"),s=e("./cfvo-xform");t.exports=class extends n{constructor(){super(),this.map={cfvo:this.cfvoXform=new s,color:this.colorXform=new i}}get tag(){return"dataBar"}render(e,t){e.openNode(this.tag),t.cfvo.forEach((t=>{this.cfvoXform.render(e,t)})),this.colorXform.render(e,t.color),e.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(e,t){switch(e){case"cfvo":this.model.cfvo.push(t.model);break;case"color":this.model.color=t.model}}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],89:[function(e,t,r){"use strict";const n=e("../../base-xform"),i=e("../../composite-xform");class s extends n{get tag(){return"x14:id"}render(e,t){e.leafNode(this.tag,null,t)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}}class a extends i{constructor(){super(),this.map={"x14:id":this.idXform=new s}}get tag(){return"ext"}render(e,t){e.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(e,t.x14Id),e.closeNode()}createNewModel(){return{}}onParserClose(e,t){this.model.x14Id=t.model}}t.exports=class extends i{constructor(){super(),this.map={ext:new a}}get tag(){return"extLst"}render(e,t){e.openNode(this.tag),this.map.ext.render(e,t),e.closeNode()}createNewModel(){return{}}onParserClose(e,t){Object.assign(this.model,t.model)}}},{"../../base-xform":32,"../../composite-xform":48}],90:[function(e,t,r){"use strict";const n=e("../../base-xform");t.exports=class extends n{get tag(){return"formula"}render(e,t){e.leafNode(this.tag,null,t)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}}},{"../../base-xform":32}],91:[function(e,t,r){"use strict";const n=e("../../base-xform"),i=e("../../composite-xform"),s=e("./cfvo-xform");t.exports=class extends i{constructor(){super(),this.map={cfvo:this.cfvoXform=new s}}get tag(){return"iconSet"}render(e,t){e.openNode(this.tag,{iconSet:n.toStringAttribute(t.iconSet,"3TrafficLights"),reverse:n.toBoolAttribute(t.reverse,!1),showValue:n.toBoolAttribute(t.showValue,!0)}),t.cfvo.forEach((t=>{this.cfvoXform.render(e,t)})),e.closeNode()}createNewModel(e){let{attributes:t}=e;return{iconSet:n.toStringValue(t.iconSet,"3TrafficLights"),reverse:n.toBoolValue(t.reverse),showValue:n.toBoolValue(t.showValue),cfvo:[]}}onParserClose(e,t){this.model[e].push(t.model)}}},{"../../base-xform":32,"../../composite-xform":48,"./cfvo-xform":84}],92:[function(e,t,r){"use strict";const n=e("../../../utils/utils"),i=e("../base-xform");t.exports=class extends i{get tag(){return"col"}prepare(e,t){const r=t.styles.addStyleModel(e.style||{});r&&(e.styleId=r)}render(e,t){e.openNode("col"),e.addAttribute("min",t.min),e.addAttribute("max",t.max),t.width&&e.addAttribute("width",t.width),t.styleId&&e.addAttribute("style",t.styleId),t.hidden&&e.addAttribute("hidden","1"),t.bestFit&&e.addAttribute("bestFit","1"),t.outlineLevel&&e.addAttribute("outlineLevel",t.outlineLevel),t.collapsed&&e.addAttribute("collapsed","1"),e.addAttribute("customWidth","1"),e.closeNode()}parseOpen(e){if("col"===e.name){const t=this.model={min:parseInt(e.attributes.min||"0",10),max:parseInt(e.attributes.max||"0",10),width:void 0===e.attributes.width?void 0:parseFloat(e.attributes.width||"0")};return e.attributes.style&&(t.styleId=parseInt(e.attributes.style,10)),n.parseBoolean(e.attributes.hidden)&&(t.hidden=!0),n.parseBoolean(e.attributes.bestFit)&&(t.bestFit=!0),e.attributes.outlineLevel&&(t.outlineLevel=parseInt(e.attributes.outlineLevel,10)),n.parseBoolean(e.attributes.collapsed)&&(t.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(e,t){e.styleId&&(e.style=t.styles.getStyleModel(e.styleId))}}},{"../../../utils/utils":27,"../base-xform":32}],93:[function(e,t,r){"use strict";const i=e("../../../utils/under-dash"),s=e("../../../utils/utils"),a=e("../../../utils/col-cache"),o=e("../base-xform"),l=e("../../../doc/range");function c(e,t,r,n){const i=t[r];void 0!==i?e[r]=i:void 0!==n&&(e[r]=n)}function u(e,t,r,n){const i=t[r];void 0!==i?e[r]=s.parseBoolean(i):void 0!==n&&(e[r]=n)}t.exports=class extends o{get tag(){return"dataValidations"}render(e,t){const r=function(e){const t=i.map(e,((e,t)=>({address:t,dataValidation:e,marked:!1}))).sort(((e,t)=>i.strcmp(e.address,t.address))),r=i.keyBy(t,"address"),s=(t,r,n)=>{for(let s=0;s<r;s++){const r=a.encodeAddress(t.row+s,n);if(!e[r]||!i.isEqual(e[t.address],e[r]))return!1}return!0};return t.map((t=>{if(!t.marked){const o=a.decodeEx(t.address);if(o.dimensions)return r[o.dimensions].marked=!0,n(n({},t.dataValidation),{},{sqref:t.address});let l=1,c=a.encodeAddress(o.row+l,o.col);for(;e[c]&&i.isEqual(t.dataValidation,e[c]);)l++,c=a.encodeAddress(o.row+l,o.col);let u=1;for(;s(o,l,o.col+u);)u++;for(let e=0;e<l;e++)for(let t=0;t<u;t++)c=a.encodeAddress(o.row+e,o.col+t),r[c].marked=!0;if(l>1||u>1){const e=o.row+(l-1),r=o.col+(u-1);return n(n({},t.dataValidation),{},{sqref:"".concat(t.address,":").concat(a.encodeAddress(e,r))})}return n(n({},t.dataValidation),{},{sqref:t.address})}return null})).filter(Boolean)}(t);r.length&&(e.openNode("dataValidations",{count:r.length}),r.forEach((t=>{e.openNode("dataValidation"),"any"!==t.type&&(e.addAttribute("type",t.type),t.operator&&"list"!==t.type&&"between"!==t.operator&&e.addAttribute("operator",t.operator),t.allowBlank&&e.addAttribute("allowBlank","1")),t.showInputMessage&&e.addAttribute("showInputMessage","1"),t.promptTitle&&e.addAttribute("promptTitle",t.promptTitle),t.prompt&&e.addAttribute("prompt",t.prompt),t.showErrorMessage&&e.addAttribute("showErrorMessage","1"),t.errorStyle&&e.addAttribute("errorStyle",t.errorStyle),t.errorTitle&&e.addAttribute("errorTitle",t.errorTitle),t.error&&e.addAttribute("error",t.error),e.addAttribute("sqref",t.sqref),(t.formulae||[]).forEach(((r,n)=>{e.openNode("formula"+(n+1)),"date"===t.type?e.writeText(s.dateToExcel(new Date(r))):e.writeText(r),e.closeNode()})),e.closeNode()})),e.closeNode())}parseOpen(e){switch(e.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=e.attributes.sqref;const t={type:e.attributes.type||"any",formulae:[]};switch(e.attributes.type&&u(t,e.attributes,"allowBlank"),u(t,e.attributes,"showInputMessage"),u(t,e.attributes,"showErrorMessage"),t.type){case"any":case"list":case"custom":break;default:c(t,e.attributes,"operator","between")}return c(t,e.attributes,"promptTitle"),c(t,e.attributes,"prompt"),c(t,e.attributes,"errorStyle"),c(t,e.attributes,"errorTitle"),c(t,e.attributes,"error"),this._dataValidation=t,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(e){this._formula&&this._formula.push(e)}parseClose(e){switch(e){case"dataValidations":return!1;case"dataValidation":return this._dataValidation.formulae&&this._dataValidation.formulae.length||(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach((e=>{e.includes(":")?new l(e).forEachAddress((e=>{this.model[e]=this._dataValidation})):this.model[e]=this._dataValidation})),!0;case"formula1":case"formula2":{let e=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":e=parseInt(e,10);break;case"decimal":e=parseFloat(e);break;case"date":e=s.excelToDate(parseFloat(e))}return this._dataValidation.formulae.push(e),this._formula=void 0,!0}default:return!0}}}},{"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/utils":27,"../base-xform":32}],94:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"dimension"}render(e,t){t&&e.leafNode("dimension",{ref:t})}parseOpen(e){return"dimension"===e.name&&(this.model=e.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],95:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"drawing"}render(e,t){t&&e.leafNode(this.tag,{"r:id":t.rId})}parseOpen(e){return e.name===this.tag&&(this.model={rId:e.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],96:[function(e,t,r){"use strict";const n=e("../composite-xform"),i=e("./cf-ext/conditional-formattings-ext-xform");class s extends n{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new i}}get tag(){return"ext"}hasContent(e){return this.conditionalFormattings.hasContent(e.conditionalFormattings)}prepare(e,t){this.conditionalFormattings.prepare(e.conditionalFormattings,t)}render(e,t){e.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(e,t.conditionalFormattings),e.closeNode()}createNewModel(){return{}}onParserClose(e,t){this.model[e]=t.model}}t.exports=class extends n{constructor(){super(),this.map={ext:this.ext=new s}}get tag(){return"extLst"}prepare(e,t){this.ext.prepare(e,t)}hasContent(e){return this.ext.hasContent(e)}render(e,t){this.hasContent(t)&&(e.openNode("extLst"),this.ext.render(e,t),e.closeNode())}createNewModel(){return{}}onParserClose(e,t){Object.assign(this.model,t.model)}}},{"../composite-xform":48,"./cf-ext/conditional-formattings-ext-xform":78}],97:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"headerFooter"}render(e,t){if(t){e.addRollback();let r=!1;e.openNode("headerFooter"),t.differentFirst&&(e.addAttribute("differentFirst","1"),r=!0),t.differentOddEven&&(e.addAttribute("differentOddEven","1"),r=!0),t.oddHeader&&"string"==typeof t.oddHeader&&(e.leafNode("oddHeader",null,t.oddHeader),r=!0),t.oddFooter&&"string"==typeof t.oddFooter&&(e.leafNode("oddFooter",null,t.oddFooter),r=!0),t.evenHeader&&"string"==typeof t.evenHeader&&(e.leafNode("evenHeader",null,t.evenHeader),r=!0),t.evenFooter&&"string"==typeof t.evenFooter&&(e.leafNode("evenFooter",null,t.evenFooter),r=!0),t.firstHeader&&"string"==typeof t.firstHeader&&(e.leafNode("firstHeader",null,t.firstHeader),r=!0),t.firstFooter&&"string"==typeof t.firstFooter&&(e.leafNode("firstFooter",null,t.firstFooter),r=!0),r?(e.closeNode(),e.commit()):e.rollback()}}parseOpen(e){switch(e.name){case"headerFooter":return this.model={},e.attributes.differentFirst&&(this.model.differentFirst=1===parseInt(e.attributes.differentFirst,0)),e.attributes.differentOddEven&&(this.model.differentOddEven=1===parseInt(e.attributes.differentOddEven,0)),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(e){switch(this.currentNode){case"oddHeader":this.model.oddHeader=e;break;case"oddFooter":this.model.oddFooter=e;break;case"evenHeader":this.model.evenHeader=e;break;case"evenFooter":this.model.evenFooter=e;break;case"firstHeader":this.model.firstHeader=e;break;case"firstFooter":this.model.firstFooter=e}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}}},{"../base-xform":32}],98:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"hyperlink"}render(e,t){this.isInternalLink(t)?e.leafNode("hyperlink",{ref:t.address,"r:id":t.rId,tooltip:t.tooltip,location:t.target}):e.leafNode("hyperlink",{ref:t.address,"r:id":t.rId,tooltip:t.tooltip})}parseOpen(e){return"hyperlink"===e.name&&(this.model={address:e.attributes.ref,rId:e.attributes["r:id"],tooltip:e.attributes.tooltip},e.attributes.location&&(this.model.target=e.attributes.location),!0)}parseText(){}parseClose(){return!1}isInternalLink(e){return e.target&&/^[^!]+![a-zA-Z]+[\d]+$/.test(e.target)}}},{"../base-xform":32}],99:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"mergeCell"}render(e,t){e.leafNode("mergeCell",{ref:t})}parseOpen(e){return"mergeCell"===e.name&&(this.model=e.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],100:[function(e,t,r){"use strict";const n=e("../../../utils/under-dash"),i=e("../../../doc/range"),s=e("../../../utils/col-cache"),a=e("../../../doc/enums");t.exports=class{constructor(){this.merges={}}add(e){if(this.merges[e.master])this.merges[e.master].expandToAddress(e.address);else{const t="".concat(e.master,":").concat(e.address);this.merges[e.master]=new i(t)}}get mergeCells(){return n.map(this.merges,(e=>e.range))}reconcile(e,t){n.each(e,(e=>{const r=s.decode(e);for(let n=r.top;n<=r.bottom;n++){const e=t[n-1];for(let t=r.left;t<=r.right;t++){const i=e.cells[t-1];i?i.type===a.ValueType.Merge&&(i.master=r.tl):e.cells[t]={type:a.ValueType.Null,address:s.encodeAddress(n,t)}}}}))}getMasterAddress(e){const t=this.hash[e];return t&&t.tl}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26}],101:[function(e,t,r){"use strict";const n=e("../base-xform"),i=e=>void 0!==e;t.exports=class extends n{get tag(){return"outlinePr"}render(e,t){return!(!t||!i(t.summaryBelow)&&!i(t.summaryRight))&&(e.leafNode(this.tag,{summaryBelow:i(t.summaryBelow)?Number(t.summaryBelow):void 0,summaryRight:i(t.summaryRight)?Number(t.summaryRight):void 0}),!0)}parseOpen(e){return e.name===this.tag&&(this.model={summaryBelow:i(e.attributes.summaryBelow)?Boolean(Number(e.attributes.summaryBelow)):void 0,summaryRight:i(e.attributes.summaryRight)?Boolean(Number(e.attributes.summaryRight)):void 0},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],102:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"brk"}render(e,t){e.leafNode("brk",t)}parseOpen(e){return"brk"===e.name&&(this.model=e.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],103:[function(e,t,r){"use strict";const n=e("../../../utils/under-dash"),i=e("../base-xform");t.exports=class extends i{get tag(){return"pageMargins"}render(e,t){if(t){const r={left:t.left,right:t.right,top:t.top,bottom:t.bottom,header:t.header,footer:t.footer};n.some(r,(e=>void 0!==e))&&e.leafNode(this.tag,r)}}parseOpen(e){return e.name===this.tag&&(this.model={left:parseFloat(e.attributes.left||.7),right:parseFloat(e.attributes.right||.7),top:parseFloat(e.attributes.top||.75),bottom:parseFloat(e.attributes.bottom||.75),header:parseFloat(e.attributes.header||.3),footer:parseFloat(e.attributes.footer||.3)},!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],104:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"pageSetUpPr"}render(e,t){return!(!t||!t.fitToPage)&&(e.leafNode(this.tag,{fitToPage:t.fitToPage?"1":void 0}),!0)}parseOpen(e){return e.name===this.tag&&(this.model={fitToPage:"1"===e.attributes.fitToPage},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],105:[function(e,t,r){"use strict";const n=e("../../../utils/under-dash"),i=e("../base-xform");function s(e){return e?"1":void 0}function a(e){if("overThenDown"===e)return e}function o(e){switch(e){case"atEnd":case"asDisplyed":return e;default:return}}function l(e){switch(e){case"dash":case"blank":case"NA":return e;default:return}}t.exports=class extends i{get tag(){return"pageSetup"}render(e,t){if(t){const r={paperSize:t.paperSize,orientation:t.orientation,horizontalDpi:t.horizontalDpi,verticalDpi:t.verticalDpi,pageOrder:a(t.pageOrder),blackAndWhite:s(t.blackAndWhite),draft:s(t.draft),cellComments:o(t.cellComments),errors:l(t.errors),scale:t.scale,fitToWidth:t.fitToWidth,fitToHeight:t.fitToHeight,firstPageNumber:t.firstPageNumber,useFirstPageNumber:s(t.firstPageNumber),usePrinterDefaults:s(t.usePrinterDefaults),copies:t.copies};n.some(r,(e=>void 0!==e))&&e.leafNode(this.tag,r)}}parseOpen(e){return e.name===this.tag&&(this.model={paperSize:(t=e.attributes.paperSize,void 0!==t?parseInt(t,10):void 0),orientation:e.attributes.orientation||"portrait",horizontalDpi:parseInt(e.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(e.attributes.verticalDpi||"4294967295",10),pageOrder:e.attributes.pageOrder||"downThenOver",blackAndWhite:"1"===e.attributes.blackAndWhite,draft:"1"===e.attributes.draft,cellComments:e.attributes.cellComments||"None",errors:e.attributes.errors||"displayed",scale:parseInt(e.attributes.scale||"100",10),fitToWidth:parseInt(e.attributes.fitToWidth||"1",10),fitToHeight:parseInt(e.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(e.attributes.firstPageNumber||"1",10),useFirstPageNumber:"1"===e.attributes.useFirstPageNumber,usePrinterDefaults:"1"===e.attributes.usePrinterDefaults,copies:parseInt(e.attributes.copies||"1",10)},!0);var t}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],106:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"picture"}render(e,t){t&&e.leafNode(this.tag,{"r:id":t.rId})}parseOpen(e){return e.name===this.tag&&(this.model={rId:e.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],107:[function(e,t,r){"use strict";const n=e("../../../utils/under-dash"),i=e("../base-xform");function s(e){return e?"1":void 0}t.exports=class extends i{get tag(){return"printOptions"}render(e,t){if(t){const r={headings:s(t.showRowColHeaders),gridLines:s(t.showGridLines),horizontalCentered:s(t.horizontalCentered),verticalCentered:s(t.verticalCentered)};n.some(r,(e=>void 0!==e))&&e.leafNode(this.tag,r)}}parseOpen(e){return e.name===this.tag&&(this.model={showRowColHeaders:"1"===e.attributes.headings,showGridLines:"1"===e.attributes.gridLines,horizontalCentered:"1"===e.attributes.horizontalCentered,verticalCentered:"1"===e.attributes.verticalCentered},!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],108:[function(e,t,r){"use strict";const n=e("./page-breaks-xform"),i=e("../list-xform");t.exports=class extends i{constructor(){super({tag:"rowBreaks",count:!0,childXform:new n})}render(e,t){if(t&&t.length){e.openNode(this.tag,this.$),this.count&&(e.addAttribute(this.$count,t.length),e.addAttribute("manualBreakCount",t.length));const{childXform:r}=this;t.forEach((t=>{r.render(e,t)})),e.closeNode()}else this.empty&&e.leafNode(this.tag)}}},{"../list-xform":71,"./page-breaks-xform":102}],109:[function(e,t,r){"use strict";const n=e("../base-xform"),i=e("../../../utils/utils"),s=e("./cell-xform");t.exports=class extends n{constructor(e){super(),this.maxItems=e&&e.maxItems,this.map={c:new s}}get tag(){return"row"}prepare(e,t){const r=t.styles.addStyleModel(e.style);r&&(e.styleId=r);const n=this.map.c;e.cells.forEach((e=>{n.prepare(e,t)}))}render(e,t,r){e.openNode("row"),e.addAttribute("r",t.number),t.height&&(e.addAttribute("ht",t.height),e.addAttribute("customHeight","1")),t.hidden&&e.addAttribute("hidden","1"),t.min>0&&t.max>0&&t.min<=t.max&&e.addAttribute("spans","".concat(t.min,":").concat(t.max)),t.styleId&&(e.addAttribute("s",t.styleId),e.addAttribute("customFormat","1")),e.addAttribute("x14ac:dyDescent","0.25"),t.outlineLevel&&e.addAttribute("outlineLevel",t.outlineLevel),t.collapsed&&e.addAttribute("collapsed","1");const n=this.map.c;t.cells.forEach((t=>{n.render(e,t,r)})),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if("row"===e.name){this.numRowsSeen+=1;const t=e.attributes.spans?e.attributes.spans.split(":").map((e=>parseInt(e,10))):[void 0,void 0],r=this.model={number:parseInt(e.attributes.r,10),min:t[0],max:t[1],cells:[]};return e.attributes.s&&(r.styleId=parseInt(e.attributes.s,10)),i.parseBoolean(e.attributes.hidden)&&(r.hidden=!0),i.parseBoolean(e.attributes.bestFit)&&(r.bestFit=!0),e.attributes.ht&&(r.height=parseFloat(e.attributes.ht)),e.attributes.outlineLevel&&(r.outlineLevel=parseInt(e.attributes.outlineLevel,10)),i.parseBoolean(e.attributes.collapsed)&&(r.collapsed=!0),!0}return this.parser=this.map[e.name],!!this.parser&&(this.parser.parseOpen(e),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw new Error("Max column count (".concat(this.maxItems,") exceeded"));this.parser=void 0}return!0}return!1}reconcile(e,t){e.style=e.styleId?t.styles.getStyleModel(e.styleId):{},void 0!==e.styleId&&(e.styleId=void 0);const r=this.map.c;e.cells.forEach((e=>{r.reconcile(e,t)}))}}},{"../../../utils/utils":27,"../base-xform":32,"./cell-xform":73}],110:[function(e,t,r){"use strict";const n=e("../../../utils/under-dash"),i=e("../base-xform");t.exports=class extends i{get tag(){return"sheetFormatPr"}render(e,t){if(t){const r={defaultRowHeight:t.defaultRowHeight,outlineLevelRow:t.outlineLevelRow,outlineLevelCol:t.outlineLevelCol,"x14ac:dyDescent":t.dyDescent};t.defaultColWidth&&(r.defaultColWidth=t.defaultColWidth),t.defaultRowHeight&&15===t.defaultRowHeight||(r.customHeight="1"),n.some(r,(e=>void 0!==e))&&e.leafNode("sheetFormatPr",r)}}parseOpen(e){return"sheetFormatPr"===e.name&&(this.model={defaultRowHeight:parseFloat(e.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(e.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(e.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(e.attributes.outlineLevelCol||"0",10)},e.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(e.attributes.defaultColWidth)),!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],111:[function(e,t,r){"use strict";const n=e("../base-xform"),i=e("../style/color-xform"),s=e("./page-setup-properties-xform"),a=e("./outline-properties-xform");t.exports=class extends n{constructor(){super(),this.map={tabColor:new i("tabColor"),pageSetUpPr:new s,outlinePr:new a}}get tag(){return"sheetPr"}render(e,t){if(t){e.addRollback(),e.openNode("sheetPr");let r=!1;r=this.map.tabColor.render(e,t.tabColor)||r,r=this.map.pageSetUpPr.render(e,t.pageSetup)||r,r=this.map.outlinePr.render(e,t.outlineProperties)||r,r?(e.closeNode(),e.commit()):e.rollback()}}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):e.name===this.tag?(this.reset(),!0):!!this.map[e.name]&&(this.parser=this.map[e.name],this.parser.parseOpen(e),!0)}parseText(e){return!!this.parser&&(this.parser.parseText(e),!0)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}}},{"../base-xform":32,"../style/color-xform":128,"./outline-properties-xform":101,"./page-setup-properties-xform":104}],112:[function(e,t,r){"use strict";const n=e("../../../utils/under-dash"),i=e("../base-xform");function s(e,t){return e?t:void 0}function a(e,t){return e===t||void 0}t.exports=class extends i{get tag(){return"sheetProtection"}render(e,t){if(t){const r={sheet:s(t.sheet,"1"),selectLockedCells:!1===t.selectLockedCells?"1":void 0,selectUnlockedCells:!1===t.selectUnlockedCells?"1":void 0,formatCells:s(t.formatCells,"0"),formatColumns:s(t.formatColumns,"0"),formatRows:s(t.formatRows,"0"),insertColumns:s(t.insertColumns,"0"),insertRows:s(t.insertRows,"0"),insertHyperlinks:s(t.insertHyperlinks,"0"),deleteColumns:s(t.deleteColumns,"0"),deleteRows:s(t.deleteRows,"0"),sort:s(t.sort,"0"),autoFilter:s(t.autoFilter,"0"),pivotTables:s(t.pivotTables,"0")};t.sheet&&(r.algorithmName=t.algorithmName,r.hashValue=t.hashValue,r.saltValue=t.saltValue,r.spinCount=t.spinCount,r.objects=s(!1===t.objects,"1"),r.scenarios=s(!1===t.scenarios,"1")),n.some(r,(e=>void 0!==e))&&e.leafNode(this.tag,r)}}parseOpen(e){return e.name===this.tag&&(this.model={sheet:a(e.attributes.sheet,"1"),objects:"1"!==e.attributes.objects&&void 0,scenarios:"1"!==e.attributes.scenarios&&void 0,selectLockedCells:"1"!==e.attributes.selectLockedCells&&void 0,selectUnlockedCells:"1"!==e.attributes.selectUnlockedCells&&void 0,formatCells:a(e.attributes.formatCells,"0"),formatColumns:a(e.attributes.formatColumns,"0"),formatRows:a(e.attributes.formatRows,"0"),insertColumns:a(e.attributes.insertColumns,"0"),insertRows:a(e.attributes.insertRows,"0"),insertHyperlinks:a(e.attributes.insertHyperlinks,"0"),deleteColumns:a(e.attributes.deleteColumns,"0"),deleteRows:a(e.attributes.deleteRows,"0"),sort:a(e.attributes.sort,"0"),autoFilter:a(e.attributes.autoFilter,"0"),pivotTables:a(e.attributes.pivotTables,"0")},e.attributes.algorithmName&&(this.model.algorithmName=e.attributes.algorithmName,this.model.hashValue=e.attributes.hashValue,this.model.saltValue=e.attributes.saltValue,this.model.spinCount=parseInt(e.attributes.spinCount,10)),!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],113:[function(e,t,r){"use strict";const n=e("../../../utils/col-cache"),i=e("../base-xform"),s={frozen:"frozen",frozenSplit:"frozen",split:"split"};t.exports=class extends i{get tag(){return"sheetView"}prepare(e){switch(e.state){case"frozen":case"split":break;default:e.state="normal"}}render(e,t){e.openNode("sheetView",{workbookViewId:t.workbookViewId||0});const r=function(t,r,n){n&&e.addAttribute(t,r)};let i,s,a,o;switch(r("rightToLeft","1",!0===t.rightToLeft),r("tabSelected","1",t.tabSelected),r("showRuler","0",!1===t.showRuler),r("showRowColHeaders","0",!1===t.showRowColHeaders),r("showGridLines","0",!1===t.showGridLines),r("zoomScale",t.zoomScale,t.zoomScale),r("zoomScaleNormal",t.zoomScaleNormal,t.zoomScaleNormal),r("view",t.style,t.style),t.state){case"frozen":s=t.xSplit||0,a=t.ySplit||0,i=t.topLeftCell||n.getAddress(a+1,s+1).address,o=(t.xSplit&&t.ySplit?"bottomRight":t.xSplit&&"topRight")||"bottomLeft",e.leafNode("pane",{xSplit:t.xSplit||void 0,ySplit:t.ySplit||void 0,topLeftCell:i,activePane:o,state:"frozen"}),e.leafNode("selection",{pane:o,activeCell:t.activeCell,sqref:t.activeCell});break;case"split":"topLeft"===t.activePane&&(t.activePane=void 0),e.leafNode("pane",{xSplit:t.xSplit||void 0,ySplit:t.ySplit||void 0,topLeftCell:t.topLeftCell,activePane:t.activePane}),e.leafNode("selection",{pane:t.activePane,activeCell:t.activeCell,sqref:t.activeCell});break;case"normal":t.activeCell&&e.leafNode("selection",{activeCell:t.activeCell,sqref:t.activeCell})}e.closeNode()}parseOpen(e){switch(e.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(e.attributes.workbookViewId,10),rightToLeft:"1"===e.attributes.rightToLeft,tabSelected:"1"===e.attributes.tabSelected,showRuler:!("0"===e.attributes.showRuler),showRowColHeaders:!("0"===e.attributes.showRowColHeaders),showGridLines:!("0"===e.attributes.showGridLines),zoomScale:parseInt(e.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(e.attributes.zoomScaleNormal||"100",10),style:e.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(e.attributes.xSplit||"0",10),ySplit:parseInt(e.attributes.ySplit||"0",10),topLeftCell:e.attributes.topLeftCell,activePane:e.attributes.activePane||"topLeft",state:e.attributes.state},!0;case"selection":{const t=e.attributes.pane||"topLeft";return this.selections[t]={pane:t,activeCell:e.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(e){let t,r;return"sheetView"!==e||(this.sheetView&&this.pane?(t=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:s[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},"split"===this.model.state&&(t.activePane=this.pane.activePane),r=this.selections[this.pane.activePane],r&&r.activeCell&&(t.activeCell=r.activeCell),this.sheetView.style&&(t.style=this.sheetView.style)):(t=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},r=this.selections.topLeft,r&&r.activeCell&&(t.activeCell=r.activeCell),this.sheetView.style&&(t.style=this.sheetView.style)),!1)}reconcile(){}}},{"../../../utils/col-cache":19,"../base-xform":32}],114:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"tablePart"}render(e,t){t&&e.leafNode(this.tag,{"r:id":t.rId})}parseOpen(e){return e.name===this.tag&&(this.model={rId:e.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],115:[function(e,t,r){"use strict";const n=e("../../../utils/under-dash"),i=e("../../../utils/col-cache"),s=e("../../../utils/xml-stream"),a=e("../../rel-type"),o=e("./merges"),l=e("../base-xform"),c=e("../list-xform"),u=e("./row-xform"),h=e("./col-xform"),d=e("./dimension-xform"),f=e("./hyperlink-xform"),p=e("./merge-cell-xform"),m=e("./data-validations-xform"),g=e("./sheet-properties-xform"),v=e("./sheet-format-properties-xform"),y=e("./sheet-view-xform"),b=e("./sheet-protection-xform"),w=e("./page-margins-xform"),x=e("./page-setup-xform"),S=e("./print-options-xform"),_=e("./auto-filter-xform"),C=e("./picture-xform"),E=e("./drawing-xform"),A=e("./table-part-xform"),M=e("./row-breaks-xform"),T=e("./header-footer-xform"),P=e("./cf/conditional-formattings-xform"),k=e("./ext-lst-xform"),D=(e,t)=>{if(!t||!t.length)return e;if(!e||!e.length)return t;const r={},n={};return e.forEach((e=>{r[e.ref]=e,e.rules.forEach((e=>{const{x14Id:t}=e;t&&(n[t]=e)}))})),t.forEach((t=>{t.rules.forEach((i=>{const s=n[i.x14Id];s?((e,t)=>{Object.keys(t).forEach((r=>{const n=e[r],i=t[r];void 0===n&&void 0!==i&&(e[r]=i)}))})(s,i):r[t.ref]?r[t.ref].rules.push(i):e.push({ref:t.ref,rules:[i]})}))})),e};class I extends l{constructor(e){super();const{maxRows:t,maxCols:r,ignoreNodes:n}=e||{};this.ignoreNodes=n||[],this.map={sheetPr:new g,dimension:new d,sheetViews:new c({tag:"sheetViews",count:!1,childXform:new y}),sheetFormatPr:new v,cols:new c({tag:"cols",count:!1,childXform:new h}),sheetData:new c({tag:"sheetData",count:!1,empty:!0,childXform:new u({maxItems:r}),maxItems:t}),autoFilter:new _,mergeCells:new c({tag:"mergeCells",count:!0,childXform:new p}),rowBreaks:new M,hyperlinks:new c({tag:"hyperlinks",count:!1,childXform:new f}),pageMargins:new w,dataValidations:new m,pageSetup:new x,headerFooter:new T,printOptions:new S,picture:new C,drawing:new E,sheetProtection:new b,tableParts:new c({tag:"tableParts",count:!0,childXform:new A}),conditionalFormatting:new P,extLst:new k}}prepare(e,t){t.merges=new o,e.hyperlinks=t.hyperlinks=[],e.comments=t.comments=[],t.formulae={},t.siFormulae=0,this.map.cols.prepare(e.cols,t),this.map.sheetData.prepare(e.rows,t),this.map.conditionalFormatting.prepare(e.conditionalFormattings,t),e.mergeCells=t.merges.mergeCells;const r=e.rels=[];function n(e){return"rId"+(e.length+1)}if(e.hyperlinks.forEach((e=>{const t=n(r);e.rId=t,r.push({Id:t,Type:a.Hyperlink,Target:e.target,TargetMode:"External"})})),e.comments.length>0){const s={Id:n(r),Type:a.Comments,Target:"../comments".concat(e.id,".xml")};r.push(s);const o={Id:n(r),Type:a.VmlDrawing,Target:"../drawings/vmlDrawing".concat(e.id,".vml")};r.push(o),e.comments.forEach((e=>{e.refAddress=i.decodeAddress(e.ref)})),t.commentRefs.push({commentName:"comments"+e.id,vmlDrawing:"vmlDrawing"+e.id})}const s=[];let l;e.media.forEach((i=>{if("background"===i.type){const s=n(r);l=t.media[i.imageId],r.push({Id:s,Type:a.Image,Target:"../media/".concat(l.name,".").concat(l.extension)}),e.background={rId:s},e.image=t.media[i.imageId]}else if("image"===i.type){let{drawing:o}=e;l=t.media[i.imageId],o||(o=e.drawing={rId:n(r),name:"drawing"+ ++t.drawingsCount,anchors:[],rels:[]},t.drawings.push(o),r.push({Id:o.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:"../drawings/".concat(o.name,".xml")}));let c=this.preImageId===i.imageId?s[i.imageId]:s[o.rels.length];c||(c=n(o.rels),s[o.rels.length]=c,o.rels.push({Id:c,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:"../media/".concat(l.name,".").concat(l.extension)}));const u={picture:{rId:c},range:i.range};if(i.hyperlinks&&i.hyperlinks.hyperlink){const e=n(o.rels);s[o.rels.length]=e,u.picture.hyperlinks={tooltip:i.hyperlinks.tooltip,rId:e},o.rels.push({Id:e,Type:a.Hyperlink,Target:i.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=i.imageId,o.anchors.push(u)}})),e.tables.forEach((e=>{const i=n(r);e.rId=i,r.push({Id:i,Type:a.Table,Target:"../tables/"+e.target}),e.columns.forEach((e=>{const{style:r}=e;r&&(e.dxfId=t.styles.addDxfStyle(r))}))})),this.map.extLst.prepare(e,t)}render(e,t){e.openXml(s.StdDocAttributes),e.openNode("worksheet",I.WORKSHEET_ATTRIBUTES);const r=t.properties?{defaultRowHeight:t.properties.defaultRowHeight,dyDescent:t.properties.dyDescent,outlineLevelCol:t.properties.outlineLevelCol,outlineLevelRow:t.properties.outlineLevelRow}:void 0;t.properties&&t.properties.defaultColWidth&&(r.defaultColWidth=t.properties.defaultColWidth);const n={outlineProperties:t.properties&&t.properties.outlineProperties,tabColor:t.properties&&t.properties.tabColor,pageSetup:t.pageSetup&&t.pageSetup.fitToPage?{fitToPage:t.pageSetup.fitToPage}:void 0},i=t.pageSetup&&t.pageSetup.margins,o={showRowColHeaders:t.pageSetup&&t.pageSetup.showRowColHeaders,showGridLines:t.pageSetup&&t.pageSetup.showGridLines,horizontalCentered:t.pageSetup&&t.pageSetup.horizontalCentered,verticalCentered:t.pageSetup&&t.pageSetup.verticalCentered},l=t.sheetProtection;this.map.sheetPr.render(e,n),this.map.dimension.render(e,t.dimensions),this.map.sheetViews.render(e,t.views),this.map.sheetFormatPr.render(e,r),this.map.cols.render(e,t.cols),this.map.sheetData.render(e,t.rows),this.map.sheetProtection.render(e,l),this.map.autoFilter.render(e,t.autoFilter),this.map.mergeCells.render(e,t.mergeCells),this.map.conditionalFormatting.render(e,t.conditionalFormattings),this.map.dataValidations.render(e,t.dataValidations),this.map.hyperlinks.render(e,t.hyperlinks),this.map.printOptions.render(e,o),this.map.pageMargins.render(e,i),this.map.pageSetup.render(e,t.pageSetup),this.map.headerFooter.render(e,t.headerFooter),this.map.rowBreaks.render(e,t.rowBreaks),this.map.drawing.render(e,t.drawing),this.map.picture.render(e,t.background),this.map.tableParts.render(e,t.tables),this.map.extLst.render(e,t),t.rels&&t.rels.forEach((t=>{t.Type===a.VmlDrawing&&e.leafNode("legacyDrawing",{"r:id":t.Id})})),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):"worksheet"===e.name?(n.each(this.map,(e=>{e.reset()})),!0):(this.map[e.name]&&!this.ignoreNodes.includes(e.name)&&(this.parser=this.map[e.name],this.parser.parseOpen(e)),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if("worksheet"===e){const e=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(e.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(e.outlineProperties=this.map.sheetPr.model.outlineProperties);const t={fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},r=Object.assign(t,this.map.pageSetup.model,this.map.printOptions.model),n=D(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:e,views:this.map.sheetViews.model,pageSetup:r,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:n},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}return!0}reconcile(e,t){const r=(e.relationships||[]).reduce(((r,n)=>{if(r[n.Id]=n,n.Type===a.Comments&&(e.comments=t.comments[n.Target].comments),n.Type===a.VmlDrawing&&e.comments&&e.comments.length){const r=t.vmlDrawings[n.Target].comments;e.comments.forEach(((e,t)=>{e.note=Object.assign({},e.note,r[t])}))}return r}),{});if(t.commentsMap=(e.comments||[]).reduce(((e,t)=>(t.ref&&(e[t.ref]=t),e)),{}),t.hyperlinkMap=(e.hyperlinks||[]).reduce(((e,t)=>(t.rId&&(e[t.address]=r[t.rId].Target),e)),{}),t.formulae={},e.rows=e.rows&&e.rows.filter(Boolean)||[],e.rows.forEach((e=>{e.cells=e.cells&&e.cells.filter(Boolean)||[]})),this.map.cols.reconcile(e.cols,t),this.map.sheetData.reconcile(e.rows,t),this.map.conditionalFormatting.reconcile(e.conditionalFormattings,t),e.media=[],e.drawing){const n=r[e.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(n){const r=n[1];t.drawings[r].anchors.forEach((t=>{if(t.medium){const r={type:"image",imageId:t.medium.index,range:t.range,hyperlinks:t.picture.hyperlinks};e.media.push(r)}}))}}const n=e.background&&r[e.background.rId];if(n){const r=n.Target.split("/media/")[1],i=t.mediaIndex&&t.mediaIndex[r];void 0!==i&&e.media.push({type:"background",imageId:i})}e.tables=(e.tables||[]).map((e=>{const n=r[e.rId];return t.tables[n.Target]})),delete e.relationships,delete e.hyperlinks,delete e.comments}}I.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},t.exports=I},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../../rel-type":31,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":72,"./cf/conditional-formattings-xform":87,"./col-xform":92,"./data-validations-xform":93,"./dimension-xform":94,"./drawing-xform":95,"./ext-lst-xform":96,"./header-footer-xform":97,"./hyperlink-xform":98,"./merge-cell-xform":99,"./merges":100,"./page-margins-xform":103,"./page-setup-xform":105,"./picture-xform":106,"./print-options-xform":107,"./row-breaks-xform":108,"./row-xform":109,"./sheet-format-properties-xform":110,"./sheet-properties-xform":111,"./sheet-protection-xform":112,"./sheet-view-xform":113,"./table-part-xform":114}],116:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{constructor(e){super(),this.tag=e.tag,this.attr=e.attr}render(e,t){t&&(e.openNode(this.tag),e.closeNode())}parseOpen(e){e.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],117:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{constructor(e){super(),this.tag=e.tag,this.attr=e.attr,this.attrs=e.attrs,this._format=e.format||function(e){try{return Number.isNaN(e.getTime())?"":e.toISOString()}catch(e){return""}},this._parse=e.parse||function(e){return new Date(e)}}render(e,t){t&&(e.openNode(this.tag),this.attrs&&e.addAttributes(this.attrs),this.attr?e.addAttribute(this.attr,this._format(t)):e.writeText(this._format(t)),e.closeNode())}parseOpen(e){e.name===this.tag&&(this.attr?this.model=this._parse(e.attributes[this.attr]):this.text=[])}parseText(e){this.attr||this.text.push(e)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}}},{"../base-xform":32}],118:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{constructor(e){super(),this.tag=e.tag,this.attr=e.attr,this.attrs=e.attrs,this.zero=e.zero}render(e,t){(t||this.zero)&&(e.openNode(this.tag),this.attrs&&e.addAttributes(this.attrs),this.attr?e.addAttribute(this.attr,t):e.writeText(t),e.closeNode())}parseOpen(e){return e.name===this.tag&&(this.attr?this.model=parseInt(e.attributes[this.attr],10):this.text=[],!0)}parseText(e){this.attr||this.text.push(e)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}}},{"../base-xform":32}],119:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{constructor(e){super(),this.tag=e.tag,this.attr=e.attr,this.attrs=e.attrs}render(e,t){void 0!==t&&(e.openNode(this.tag),this.attrs&&e.addAttributes(this.attrs),this.attr?e.addAttribute(this.attr,t):e.writeText(t),e.closeNode())}parseOpen(e){e.name===this.tag&&(this.attr?this.model=e.attributes[this.attr]:this.text=[])}parseText(e){this.attr||this.text.push(e)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}}},{"../base-xform":32}],120:[function(e,t,r){"use strict";const n=e("./base-xform"),i=e("../../utils/xml-stream");t.exports=class extends n{constructor(e){super(),this._model=e}render(e){if(!this._xml){const e=new i;!function e(t,r){t.openNode(r.tag,r.$),r.c&&r.c.forEach((r=>{e(t,r)})),r.t&&t.writeText(r.t),t.closeNode()}(e,this._model),this._xml=e.xml}e.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(e){return e!==this._model.tag}}},{"../../utils/xml-stream":28,"./base-xform":32}],121:[function(e,t,r){"use strict";const n=e("./text-xform"),i=e("./rich-text-xform"),s=e("../base-xform");t.exports=class extends s{constructor(){super(),this.map={r:new i,t:new n}}get tag(){return"rPh"}render(e,t){if(e.openNode(this.tag,{sb:t.sb||0,eb:t.eb||0}),t&&t.hasOwnProperty("richText")&&t.richText){const{r:r}=this.map;t.richText.forEach((t=>{r.render(e,t)}))}else t&&this.map.t.render(e,t.text);e.closeNode()}parseOpen(e){const{name:t}=e;return this.parser?(this.parser.parseOpen(e),!0):t===this.tag?(this.model={sb:parseInt(e.attributes.sb,10),eb:parseInt(e.attributes.eb,10)},!0):(this.parser=this.map[t],!!this.parser&&(this.parser.parseOpen(e),!0))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)){switch(e){case"r":{let e=this.model.richText;e||(e=this.model.richText=[]),e.push(this.parser.model);break}case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}return e!==this.tag}}},{"../base-xform":32,"./rich-text-xform":122,"./text-xform":125}],122:[function(e,t,r){"use strict";const n=e("./text-xform"),i=e("../style/font-xform"),s=e("../base-xform");class a extends s{constructor(e){super(),this.model=e}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new n)}get fontXform(){return this._fontXform||(this._fontXform=new i(a.FONT_OPTIONS))}render(e,t){t=t||this.model,e.openNode("r"),t.font&&this.fontXform.render(e,t.font),this.textXform.render(e,t.text),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(e),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){switch(e){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(e),!0}}}a.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},t.exports=a},{"../base-xform":32,"../style/font-xform":131,"./text-xform":125}],123:[function(e,t,r){"use strict";const n=e("./text-xform"),i=e("./rich-text-xform"),s=e("./phonetic-text-xform"),a=e("../base-xform");t.exports=class extends a{constructor(e){super(),this.model=e,this.map={r:new i,t:new n,rPh:new s}}get tag(){return"si"}render(e,t){e.openNode(this.tag),t&&t.hasOwnProperty("richText")&&t.richText?t.richText.length?t.richText.forEach((t=>{this.map.r.render(e,t)})):this.map.t.render(e,""):null!=t&&this.map.t.render(e,t),e.closeNode()}parseOpen(e){const{name:t}=e;return this.parser?(this.parser.parseOpen(e),!0):t===this.tag?(this.model={},!0):(this.parser=this.map[t],!!this.parser&&(this.parser.parseOpen(e),!0))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)){switch(e){case"r":{let e=this.model.richText;e||(e=this.model.richText=[]),e.push(this.parser.model);break}case"t":this.model=this.parser.model}this.parser=void 0}return!0}return e!==this.tag}}},{"../base-xform":32,"./phonetic-text-xform":121,"./rich-text-xform":122,"./text-xform":125}],124:[function(e,t,r){"use strict";const n=e("../../../utils/xml-stream"),i=e("../base-xform"),s=e("./shared-string-xform");t.exports=class extends i{constructor(e){super(),this.model=e||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new s)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(e){return this.model.values[e]}add(e){return e.richText?this.addRichText(e):this.addText(e)}addText(e){let t=this.hash[e];return void 0===t&&(t=this.hash[e]=this.model.values.length,this.model.values.push(e)),this.model.count++,t}addRichText(e){const t=this.sharedStringXform.toXml(e);let r=this.rich[t];return void 0===r&&(r=this.rich[t]=this.model.values.length,this.model.values.push(e)),this.model.count++,r}render(e,t){t=t||this._values,e.openXml(n.StdDocAttributes),e.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:t.count,uniqueCount:t.values.length});const r=this.sharedStringXform;t.values.forEach((t=>{r.render(e,t)})),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(e),!0;default:throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(e))}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;if("sst"===e)return!1;throw new Error("Unexpected xml node in parseClose: "+e)}}},{"../../../utils/xml-stream":28,"../base-xform":32,"./shared-string-xform":123}],125:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"t"}render(e,t){e.openNode("t"),/^\s|\n|\s$/.test(t)&&e.addAttribute("xml:space","preserve"),e.writeText(t),e.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,((e,t)=>String.fromCharCode(parseInt(t,16))))}parseOpen(e){return"t"===e.name&&(this._text=[],!0)}parseText(e){this._text.push(e)}parseClose(){return!1}}},{"../base-xform":32}],126:[function(e,t,r){"use strict";const n=e("../../../doc/enums"),i=e("../../../utils/utils"),s=e("../base-xform"),a={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce(((e,t)=>(e[t]=!0,e)),{}),horizontal(e){return this.horizontalValues[e]?e:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce(((e,t)=>(e[t]=!0,e)),{}),vertical(e){return"middle"===e?"center":this.verticalValues[e]?e:void 0},wrapText:e=>!!e||void 0,shrinkToFit:e=>!!e||void 0,textRotation:e=>"vertical"===e||(e=i.validInt(e))>=-90&&e<=90?e:void 0,indent:e=>(e=i.validInt(e),Math.max(0,e)),readingOrder(e){switch(e){case"ltr":return n.ReadingOrder.LeftToRight;case"rtl":return n.ReadingOrder.RightToLeft;default:return}}},o={toXml(e){if(e=a.textRotation(e)){if("vertical"===e)return 255;const t=Math.round(e);if(t>=0&&t<=90)return t;if(t<0&&t>=-90)return 90-t}},toModel(e){const t=i.validInt(e);if(void 0!==t){if(255===t)return"vertical";if(t>=0&&t<=90)return t;if(t>90&&t<=180)return 90-t}}};t.exports=class extends s{get tag(){return"alignment"}render(e,t){e.addRollback(),e.openNode("alignment");let r=!1;function n(t,n){n&&(e.addAttribute(t,n),r=!0)}n("horizontal",a.horizontal(t.horizontal)),n("vertical",a.vertical(t.vertical)),n("wrapText",!!a.wrapText(t.wrapText)&&"1"),n("shrinkToFit",!!a.shrinkToFit(t.shrinkToFit)&&"1"),n("indent",a.indent(t.indent)),n("textRotation",o.toXml(t.textRotation)),n("readingOrder",a.readingOrder(t.readingOrder)),e.closeNode(),r?e.commit():e.rollback()}parseOpen(e){const t={};let r=!1;function n(e,n,i){e&&(t[n]=i,r=!0)}n(e.attributes.horizontal,"horizontal",e.attributes.horizontal),n(e.attributes.vertical,"vertical","center"===e.attributes.vertical?"middle":e.attributes.vertical),n(e.attributes.wrapText,"wrapText",i.parseBoolean(e.attributes.wrapText)),n(e.attributes.shrinkToFit,"shrinkToFit",i.parseBoolean(e.attributes.shrinkToFit)),n(e.attributes.indent,"indent",parseInt(e.attributes.indent,10)),n(e.attributes.textRotation,"textRotation",o.toModel(e.attributes.textRotation)),n(e.attributes.readingOrder,"readingOrder","2"===e.attributes.readingOrder?"rtl":"ltr"),this.model=r?t:null}parseText(){}parseClose(){return!1}}},{"../../../doc/enums":7,"../../../utils/utils":27,"../base-xform":32}],127:[function(e,t,r){"use strict";const i=e("../base-xform"),s=e("../../../utils/utils"),a=e("./color-xform");class o extends i{constructor(e){super(),this.name=e,this.map={color:new a}}get tag(){return this.name}render(e,t,r){const n=t&&t.color||r||this.defaultColor;e.openNode(this.name),t&&t.style&&(e.addAttribute("style",t.style),n&&this.map.color.render(e,n)),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.name:{const{style:t}=e.attributes;return this.model=t?{style:t}:void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):(e===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(e){return o.validStyleValues[e]}}o.validStyleValues=["thin","dashed","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce(((e,t)=>(e[t]=!0,e)),{}),t.exports=class extends i{constructor(){super(),this.map={top:new o("top"),left:new o("left"),bottom:new o("bottom"),right:new o("right"),diagonal:new o("diagonal")}}render(e,t){const{color:r}=t;function i(i,s){i&&!i.color&&t.color&&(i=n(n({},i),{},{color:t.color})),s.render(e,i,r)}e.openNode("border"),t.diagonal&&t.diagonal.style&&(t.diagonal.up&&e.addAttribute("diagonalUp","1"),t.diagonal.down&&e.addAttribute("diagonalDown","1")),i(t.left,this.map.left),i(t.right,this.map.right),i(t.top,this.map.top),i(t.bottom,this.map.bottom),i(t.diagonal,this.map.diagonal),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):"border"===e.name?(this.reset(),this.diagonalUp=s.parseBoolean(e.attributes.diagonalUp),this.diagonalDown=s.parseBoolean(e.attributes.diagonalDown),!0):(this.parser=this.map[e.name],!!this.parser&&(this.parser.parseOpen(e),!0))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if("border"===e){const e=this.model={},t=function(t,r,n){r&&(n&&Object.assign(r,n),e[t]=r)};t("left",this.map.left.model),t("right",this.map.right.model),t("top",this.map.top.model),t("bottom",this.map.bottom.model),t("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}}},{"../../../utils/utils":27,"../base-xform":32,"./color-xform":128}],128:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{constructor(e){super(),this.name=e||"color"}get tag(){return this.name}render(e,t){return!!t&&(e.openNode(this.name),t.argb?e.addAttribute("rgb",t.argb):void 0!==t.theme?(e.addAttribute("theme",t.theme),void 0!==t.tint&&e.addAttribute("tint",t.tint)):void 0!==t.indexed?e.addAttribute("indexed",t.indexed):e.addAttribute("auto","1"),e.closeNode(),!0)}parseOpen(e){return e.name===this.name&&(e.attributes.rgb?this.model={argb:e.attributes.rgb}:e.attributes.theme?(this.model={theme:parseInt(e.attributes.theme,10)},e.attributes.tint&&(this.model.tint=parseFloat(e.attributes.tint))):e.attributes.indexed?this.model={indexed:parseInt(e.attributes.indexed,10)}:this.model=void 0,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],129:[function(e,t,r){"use strict";const n=e("../base-xform"),i=e("./alignment-xform"),s=e("./border-xform"),a=e("./fill-xform"),o=e("./font-xform"),l=e("./numfmt-xform"),c=e("./protection-xform");t.exports=class extends n{constructor(){super(),this.map={alignment:new i,border:new s,fill:new a,font:new o,numFmt:new l,protection:new c}}get tag(){return"dxf"}render(e,t){if(e.openNode(this.tag),t.font&&this.map.font.render(e,t.font),t.numFmt&&t.numFmtId){const r={id:t.numFmtId,formatCode:t.numFmt};this.map.numFmt.render(e,r)}t.fill&&this.map.fill.render(e,t.fill),t.alignment&&this.map.alignment.render(e,t.alignment),t.border&&this.map.border.render(e,t.border),t.protection&&this.map.protection.render(e,t.protection),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):e.name===this.tag?(this.reset(),!0):(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1)}}},{"../base-xform":32,"./alignment-xform":126,"./border-xform":127,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./protection-xform":133}],130:[function(e,t,r){"use strict";const n=e("../base-xform"),i=e("./color-xform");class s extends n{constructor(){super(),this.map={color:new i}}get tag(){return"stop"}render(e,t){e.openNode("stop"),e.addAttribute("position",t.position),this.map.color.render(e,t.color),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"stop":return this.model={position:parseFloat(e.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(e),!0;default:return!1}}parseText(){}parseClose(e){return!!this.parser&&(this.parser.parseClose(e)||(this.model.color=this.parser.model,this.parser=void 0),!0)}}class a extends n{constructor(){super(),this.map={fgColor:new i("fgColor"),bgColor:new i("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(e,t){e.openNode("patternFill"),e.addAttribute("patternType",t.pattern),t.fgColor&&this.map.fgColor.render(e,t.fgColor),t.bgColor&&this.map.bgColor.render(e,t.bgColor),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):"patternFill"===e.name?(this.model={type:"pattern",pattern:e.attributes.patternType},!0):(this.parser=this.map[e.name],!!this.parser&&(this.parser.parseOpen(e),!0))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return!!this.parser&&(this.parser.parseClose(e)||(this.parser.model&&(this.model[e]=this.parser.model),this.parser=void 0),!0)}}class o extends n{constructor(){super(),this.map={stop:new s}}get name(){return"gradient"}get tag(){return"gradientFill"}render(e,t){switch(e.openNode("gradientFill"),t.gradient){case"angle":e.addAttribute("degree",t.degree);break;case"path":e.addAttribute("type","path"),t.center.left&&(e.addAttribute("left",t.center.left),void 0===t.center.right&&e.addAttribute("right",t.center.left)),t.center.right&&e.addAttribute("right",t.center.right),t.center.top&&(e.addAttribute("top",t.center.top),void 0===t.center.bottom&&e.addAttribute("bottom",t.center.top)),t.center.bottom&&e.addAttribute("bottom",t.center.bottom)}const r=this.map.stop;t.stops.forEach((t=>{r.render(e,t)})),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"gradientFill":{const t=this.model={stops:[]};return e.attributes.degree?(t.gradient="angle",t.degree=parseInt(e.attributes.degree,10)):"path"===e.attributes.type&&(t.gradient="path",t.center={left:e.attributes.left?parseFloat(e.attributes.left):0,top:e.attributes.top?parseFloat(e.attributes.top):0},e.attributes.right!==e.attributes.left&&(t.center.right=e.attributes.right?parseFloat(e.attributes.right):0),e.attributes.bottom!==e.attributes.top&&(t.center.bottom=e.attributes.bottom?parseFloat(e.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return!!this.parser&&(this.parser.parseClose(e)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0)}}class l extends n{constructor(){super(),this.map={patternFill:new a,gradientFill:new o}}get tag(){return"fill"}render(e,t){switch(e.addRollback(),e.openNode("fill"),t.type){case"pattern":this.map.patternFill.render(e,t);break;case"gradient":this.map.gradientFill.render(e,t);break;default:return void e.rollback()}e.closeNode(),e.commit()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):"fill"===e.name?(this.model={},!0):(this.parser=this.map[e.name],!!this.parser&&(this.parser.parseOpen(e),!0))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return!!this.parser&&(this.parser.parseClose(e)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0)}validStyle(e){return l.validPatternValues[e]}}l.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce(((e,t)=>(e[t]=!0,e)),{}),l.StopXform=s,l.PatternFillXform=a,l.GradientFillXform=o,t.exports=l},{"../base-xform":32,"./color-xform":128}],131:[function(e,t,r){"use strict";const n=e("./color-xform"),i=e("../simple/boolean-xform"),s=e("../simple/integer-xform"),a=e("../simple/string-xform"),o=e("./underline-xform"),l=e("../../../utils/under-dash"),c=e("../base-xform");class u extends c{constructor(e){super(),this.options=e||u.OPTIONS,this.map={b:{prop:"bold",xform:new i({tag:"b",attr:"val"})},i:{prop:"italic",xform:new i({tag:"i",attr:"val"})},u:{prop:"underline",xform:new o},charset:{prop:"charset",xform:new s({tag:"charset",attr:"val"})},color:{prop:"color",xform:new n},condense:{prop:"condense",xform:new i({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new i({tag:"extend",attr:"val"})},family:{prop:"family",xform:new s({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new i({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new a({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new a({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new i({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new i({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new s({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new a({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(e,t){const{map:r}=this;e.openNode(this.options.tagName),l.each(this.map,((n,i)=>{r[i].xform.render(e,t[n.prop])})),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):this.map[e.name]?(this.parser=this.map[e.name].xform,this.parser.parseOpen(e)):e.name===this.options.tagName&&(this.model={},!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser&&!this.parser.parseClose(e)){const t=this.map[e];return this.parser.model&&(this.model[t.prop]=this.parser.model),this.parser=void 0,!0}return e!==this.options.tagName}}u.OPTIONS={tagName:"font",fontNameTag:"name"},t.exports=u},{"../../../utils/under-dash":26,"../base-xform":32,"../simple/boolean-xform":116,"../simple/integer-xform":118,"../simple/string-xform":119,"./color-xform":128,"./underline-xform":136}],132:[function(e,t,r){"use strict";const n=e("../../../utils/under-dash"),i=e("../../defaultnumformats"),s=e("../base-xform"),a=function(){const e={};return n.each(i,((t,r)=>{t.f&&(e[t.f]=parseInt(r,10))})),e}();class o extends s{constructor(e,t){super(),this.id=e,this.formatCode=t}get tag(){return"numFmt"}render(e,t){e.leafNode("numFmt",{numFmtId:t.id,formatCode:t.formatCode})}parseOpen(e){return"numFmt"===e.name&&(this.model={id:parseInt(e.attributes.numFmtId,10),formatCode:e.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0)}parseText(){}parseClose(){return!1}}o.getDefaultFmtId=function(e){return a[e]},o.getDefaultFmtCode=function(e){return i[e]&&i[e].f},t.exports=o},{"../../../utils/under-dash":26,"../../defaultnumformats":30,"../base-xform":32}],133:[function(e,t,r){"use strict";const n=e("../base-xform"),i={boolean:(e,t)=>void 0===e?t:e};t.exports=class extends n{get tag(){return"protection"}render(e,t){e.addRollback(),e.openNode("protection");let r=!1;function n(t,n){void 0!==n&&(e.addAttribute(t,n),r=!0)}n("locked",i.boolean(t.locked,!0)?void 0:"0"),n("hidden",i.boolean(t.hidden,!1)?"1":void 0),e.closeNode(),r?e.commit():e.rollback()}parseOpen(e){const t={locked:!("0"===e.attributes.locked),hidden:"1"===e.attributes.hidden},r=!t.locked||t.hidden;this.model=r?t:null}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],134:[function(e,t,r){"use strict";const n=e("../base-xform"),i=e("./alignment-xform"),s=e("./protection-xform");t.exports=class extends n{constructor(e){super(),this.xfId=!(!e||!e.xfId),this.map={alignment:new i,protection:new s}}get tag(){return"xf"}render(e,t){e.openNode("xf",{numFmtId:t.numFmtId||0,fontId:t.fontId||0,fillId:t.fillId||0,borderId:t.borderId||0}),this.xfId&&e.addAttribute("xfId",t.xfId||0),t.numFmtId&&e.addAttribute("applyNumberFormat","1"),t.fontId&&e.addAttribute("applyFont","1"),t.fillId&&e.addAttribute("applyFill","1"),t.borderId&&e.addAttribute("applyBorder","1"),t.alignment&&e.addAttribute("applyAlignment","1"),t.protection&&e.addAttribute("applyProtection","1"),t.alignment&&this.map.alignment.render(e,t.alignment),t.protection&&this.map.protection.render(e,t.protection),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"xf":return this.model={numFmtId:parseInt(e.attributes.numFmtId,10),fontId:parseInt(e.attributes.fontId,10),fillId:parseInt(e.attributes.fillId,10),borderId:parseInt(e.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(e.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(e),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):"xf"!==e}}},{"../base-xform":32,"./alignment-xform":126,"./protection-xform":133}],135:[function(e,t,r){"use strict";const n=e("../../../doc/enums"),i=e("../../../utils/xml-stream"),s=e("../base-xform"),a=e("../static-xform"),o=e("../list-xform"),l=e("./font-xform"),c=e("./fill-xform"),u=e("./border-xform"),h=e("./numfmt-xform"),d=e("./style-xform"),f=e("./dxf-xform");class p extends s{constructor(e){super(),this.map={numFmts:new o({tag:"numFmts",count:!0,childXform:new h}),fonts:new o({tag:"fonts",count:!0,childXform:new l,$:{"x14ac:knownFonts":1}}),fills:new o({tag:"fills",count:!0,childXform:new c}),borders:new o({tag:"borders",count:!0,childXform:new u}),cellStyleXfs:new o({tag:"cellStyleXfs",count:!0,childXform:new d}),cellXfs:new o({tag:"cellXfs",count:!0,childXform:new d({xfId:!0})}),dxfs:new o({tag:"dxfs",always:!0,count:!0,childXform:new f}),numFmt:new h,font:new l,fill:new c,border:new u,style:new d({xfId:!0}),cellStyles:p.STATIC_XFORMS.cellStyles,tableStyles:p.STATIC_XFORMS.tableStyles,extLst:p.STATIC_XFORMS.extLst},e&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(e,t){t=t||this.model,e.openXml(i.StdDocAttributes),e.openNode("styleSheet",p.STYLESHEET_ATTRIBUTES),this.index?(t.numFmts&&t.numFmts.length&&(e.openNode("numFmts",{count:t.numFmts.length}),t.numFmts.forEach((t=>{e.writeXml(t)})),e.closeNode()),t.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),e.openNode("fonts",{count:t.fonts.length,"x14ac:knownFonts":1}),t.fonts.forEach((t=>{e.writeXml(t)})),e.closeNode(),e.openNode("fills",{count:t.fills.length}),t.fills.forEach((t=>{e.writeXml(t)})),e.closeNode(),e.openNode("borders",{count:t.borders.length}),t.borders.forEach((t=>{e.writeXml(t)})),e.closeNode(),this.map.cellStyleXfs.render(e,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),e.openNode("cellXfs",{count:t.styles.length}),t.styles.forEach((t=>{e.writeXml(t)})),e.closeNode()):(this.map.numFmts.render(e,t.numFmts),this.map.fonts.render(e,t.fonts),this.map.fills.render(e,t.fills),this.map.borders.render(e,t.borders),this.map.cellStyleXfs.render(e,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(e,t.styles)),p.STATIC_XFORMS.cellStyles.render(e),this.map.dxfs.render(e,t.dxfs),p.STATIC_XFORMS.tableStyles.render(e),p.STATIC_XFORMS.extLst.render(e),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):"styleSheet"===e.name?(this.initIndex(),!0):(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if("styleSheet"===e){this.model={};const e=(e,t)=>{t.model&&t.model.length&&(this.model[e]=t.model)};if(e("numFmts",this.map.numFmts),e("fonts",this.map.fonts),e("fills",this.map.fills),e("borders",this.map.borders),e("styles",this.map.cellXfs),e("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){const e=this.index.numFmt;this.model.numFmts.forEach((t=>{e[t.id]=t.formatCode}))}return!1}return!0}addStyleModel(e,t){if(!e)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(e))return this.weakMap.get(e);const r={};if(t=t||n.ValueType.Number,e.numFmt)r.numFmtId=this._addNumFmtStr(e.numFmt);else switch(t){case n.ValueType.Number:r.numFmtId=this._addNumFmtStr("General");break;case n.ValueType.Date:r.numFmtId=this._addNumFmtStr("mm-dd-yy")}e.font&&(r.fontId=this._addFont(e.font)),e.border&&(r.borderId=this._addBorder(e.border)),e.fill&&(r.fillId=this._addFill(e.fill)),e.alignment&&(r.alignment=e.alignment),e.protection&&(r.protection=e.protection);const i=this._addStyle(r);return this.weakMap&&this.weakMap.set(e,i),i}getStyleModel(e){const t=this.model.styles[e];if(!t)return null;let r=this.index.model[e];if(r)return r;if(r=this.index.model[e]={},t.numFmtId){const e=this.index.numFmt[t.numFmtId]||h.getDefaultFmtCode(t.numFmtId);e&&(r.numFmt=e)}function n(e,t,n){if(n||0===n){const i=t[n];i&&(r[e]=i)}}return n("font",this.model.fonts,t.fontId),n("border",this.model.borders,t.borderId),n("fill",this.model.fills,t.fillId),t.alignment&&(r.alignment=t.alignment),t.protection&&(r.protection=t.protection),r}addDxfStyle(e){return e.numFmt&&(e.numFmtId=this._addNumFmtStr(e.numFmt)),this.model.dxfs.push(e),this.model.dxfs.length-1}getDxfStyle(e){return this.model.dxfs[e]}_addStyle(e){const t=this.map.style.toXml(e);let r=this.index.style[t];return void 0===r&&(r=this.index.style[t]=this.model.styles.length,this.model.styles.push(t)),r}_addNumFmtStr(e){let t=h.getDefaultFmtId(e);if(void 0!==t)return t;if(t=this.index.numFmt[e],void 0!==t)return t;t=this.index.numFmt[e]=164+this.model.numFmts.length;const r=this.map.numFmt.toXml({id:t,formatCode:e});return this.model.numFmts.push(r),t}_addFont(e){const t=this.map.font.toXml(e);let r=this.index.font[t];return void 0===r&&(r=this.index.font[t]=this.model.fonts.length,this.model.fonts.push(t)),r}_addBorder(e){const t=this.map.border.toXml(e);let r=this.index.border[t];return void 0===r&&(r=this.index.border[t]=this.model.borders.length,this.model.borders.push(t)),r}_addFill(e){const t=this.map.fill.toXml(e);let r=this.index.fill[t];return void 0===r&&(r=this.index.fill[t]=this.model.fills.length,this.model.fills.push(t)),r}}p.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"},p.STATIC_XFORMS={cellStyles:new a({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new a({tag:"dxfs",$:{count:0}}),tableStyles:new a({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new a({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})},p.Mock=class extends p{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(e){return e.autodrain(),Promise.resolve()}addStyleModel(e,t){return t===n.ValueType.Date?this.dateStyleId:0}get dateStyleId(){if(!this._dateStyleId){const e={numFmtId:h.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(e)}return this._dateStyleId}getStyleModel(){return{}}},t.exports=p},{"../../../doc/enums":7,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./border-xform":127,"./dxf-xform":129,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./style-xform":134}],136:[function(e,t,r){"use strict";const n=e("../base-xform");class i extends n{constructor(e){super(),this.model=e}get tag(){return"u"}render(e,t){if(!0===(t=t||this.model))e.leafNode("u");else{const r=i.Attributes[t];r&&e.leafNode("u",r)}}parseOpen(e){"u"===e.name&&(this.model=e.attributes.val||!0)}parseText(){}parseClose(){return!1}}i.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},t.exports=i},{"../base-xform":32}],137:[function(e,t,r){"use strict";const n=e("../base-xform"),i=e("./filter-column-xform");t.exports=class extends n{constructor(){super(),this.map={filterColumn:new i}}get tag(){return"autoFilter"}prepare(e){e.columns.forEach(((e,t)=>{this.map.filterColumn.prepare(e,{index:t})}))}render(e,t){return e.openNode(this.tag,{ref:t.autoFilterRef}),t.columns.forEach((t=>{this.map.filterColumn.render(e,t)})),e.closeNode(),!0}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(e.name===this.tag)return this.model={autoFilterRef:e.attributes.ref,columns:[]},!0;if(this.parser=this.map[e.name],this.parser)return this.parseOpen(e),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(e))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;if(e===this.tag)return!1;throw new Error("Unexpected xml node in parseClose: "+e)}}},{"../base-xform":32,"./filter-column-xform":139}],138:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"customFilter"}render(e,t){e.leafNode(this.tag,{val:t.val,operator:t.operator})}parseOpen(e){return e.name===this.tag&&(this.model={val:e.attributes.val,operator:e.attributes.operator},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],139:[function(e,t,r){"use strict";const n=e("../base-xform"),i=e("../list-xform"),s=e("./custom-filter-xform"),a=e("./filter-xform");t.exports=class extends n{constructor(){super(),this.map={customFilters:new i({tag:"customFilters",count:!1,empty:!0,childXform:new s}),filters:new i({tag:"filters",count:!1,empty:!0,childXform:new a})}}get tag(){return"filterColumn"}prepare(e,t){e.colId=t.index.toString()}render(e,t){return t.customFilters?(e.openNode(this.tag,{colId:t.colId,hiddenButton:t.filterButton?"0":"1"}),this.map.customFilters.render(e,t.customFilters),e.closeNode(),!0):(e.leafNode(this.tag,{colId:t.colId,hiddenButton:t.filterButton?"0":"1"}),!0)}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;const{attributes:t}=e;if(e.name===this.tag)return this.model={filterButton:"0"===t.hiddenButton},!0;if(this.parser=this.map[e.name],this.parser)return this.parseOpen(e),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(e))}parseText(){}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model.customFilters=this.map.customFilters.model,!1)}}},{"../base-xform":32,"../list-xform":71,"./custom-filter-xform":138,"./filter-xform":140}],140:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"filter"}render(e,t){e.leafNode(this.tag,{val:t.val})}parseOpen(e){return e.name===this.tag&&(this.model={val:e.attributes.val},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],141:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"tableColumn"}prepare(e,t){e.id=t.index+1}render(e,t){return e.leafNode(this.tag,{id:t.id.toString(),name:t.name,totalsRowLabel:t.totalsRowLabel,totalsRowFunction:t.totalsRowFunction,dxfId:t.dxfId}),!0}parseOpen(e){if(e.name===this.tag){const{attributes:t}=e;return this.model={name:t.name,totalsRowLabel:t.totalsRowLabel,totalsRowFunction:t.totalsRowFunction,dxfId:t.dxfId},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],142:[function(e,t,r){"use strict";const n=e("../base-xform");t.exports=class extends n{get tag(){return"tableStyleInfo"}render(e,t){return e.leafNode(this.tag,{name:t.theme?t.theme:void 0,showFirstColumn:t.showFirstColumn?"1":"0",showLastColumn:t.showLastColumn?"1":"0",showRowStripes:t.showRowStripes?"1":"0",showColumnStripes:t.showColumnStripes?"1":"0"}),!0}parseOpen(e){if(e.name===this.tag){const{attributes:t}=e;return this.model={theme:t.name?t.name:null,showFirstColumn:"1"===t.showFirstColumn,showLastColumn:"1"===t.showLastColumn,showRowStripes:"1"===t.showRowStripes,showColumnStripes:"1"===t.showColumnStripes},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],143:[function(e,t,r){"use strict";const i=e("../../../utils/xml-stream"),s=e("../base-xform"),a=e("../list-xform"),o=e("./auto-filter-xform"),l=e("./table-column-xform"),c=e("./table-style-info-xform");class u extends s{constructor(){super(),this.map={autoFilter:new o,tableColumns:new a({tag:"tableColumns",count:!0,empty:!0,childXform:new l}),tableStyleInfo:new c}}prepare(e,t){this.map.autoFilter.prepare(e),this.map.tableColumns.prepare(e.columns,t)}get tag(){return"table"}render(e,t){e.openXml(i.StdDocAttributes),e.openNode(this.tag,n(n({},u.TABLE_ATTRIBUTES),{},{id:t.id,name:t.name,displayName:t.displayName||t.name,ref:t.tableRef,totalsRowCount:t.totalsRow?"1":void 0,totalsRowShown:t.totalsRow?void 0:"1",headerRowCount:t.headerRow?"1":"0"})),this.map.autoFilter.render(e,t),this.map.tableColumns.render(e,t.columns),this.map.tableStyleInfo.render(e,t.style),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;const{name:t,attributes:r}=e;return t===this.tag?(this.reset(),this.model={name:r.name,displayName:r.displayName||r.name,tableRef:r.ref,totalsRow:"1"===r.totalsRowCount,headerRow:"1"===r.headerRowCount}):(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach(((e,t)=>{this.model.columns[t].filterButton=e.filterButton}))),this.model.style=this.map.tableStyleInfo.model,!1)}reconcile(e,t){e.columns.forEach((e=>{void 0!==e.dxfId&&(e.style=t.styles.getDxfStyle(e.dxfId))}))}}u.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},t.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":137,"./table-column-xform":141,"./table-style-info-xform":142}],144:[function(e,t,r){(function(r,n){(function(){"use strict";const i=e("fs"),s=e("jszip"),{PassThrough:o}=e("readable-stream"),l=e("../utils/zip-stream"),c=e("../utils/stream-buf"),u=e("../utils/utils"),h=e("../utils/xml-stream"),{bufferToString:d}=e("../utils/browser-buffer-decode"),f=e("./xform/style/styles-xform"),p=e("./xform/core/core-xform"),m=e("./xform/strings/shared-strings-xform"),g=e("./xform/core/relationships-xform"),v=e("./xform/core/content-types-xform"),y=e("./xform/core/app-xform"),b=e("./xform/book/workbook-xform"),w=e("./xform/sheet/worksheet-xform"),x=e("./xform/drawing/drawing-xform"),S=e("./xform/table/table-xform"),_=e("./xform/comment/comments-xform"),C=e("./xform/comment/vml-notes-xform"),E=e("./xml/theme1");class A{constructor(e){this.workbook=e}async readFile(e,t){if(!await u.fs.exists(e))throw new Error("File not found: "+e);const r=i.createReadStream(e);try{const e=await this.read(r,t);return r.close(),e}catch(e){throw r.close(),e}}parseRels(e){return(new g).parseStream(e)}parseWorkbook(e){return(new b).parseStream(e)}parseSharedStrings(e){return(new m).parseStream(e)}reconcile(e,t){const r=new b,n=new w(t),i=new x,s=new S;r.reconcile(e);const a={media:e.media,mediaIndex:e.mediaIndex};Object.keys(e.drawings).forEach((t=>{const r=e.drawings[t],n=e.drawingRels[t];n&&(a.rels=n.reduce(((e,t)=>(e[t.Id]=t,e)),{}),(r.anchors||[]).forEach((e=>{const t=e.picture&&e.picture.hyperlinks;t&&a.rels[t.rId]&&(t.hyperlink=a.rels[t.rId].Target,delete t.rId)})),i.reconcile(r,a))}));const o={styles:e.styles};Object.values(e.tables).forEach((e=>{s.reconcile(e,o)}));const l={styles:e.styles,sharedStrings:e.sharedStrings,media:e.media,mediaIndex:e.mediaIndex,date1904:e.properties&&e.properties.date1904,drawings:e.drawings,comments:e.comments,tables:e.tables,vmlDrawings:e.vmlDrawings};e.worksheets.forEach((t=>{t.relationships=e.worksheetRels[t.sheetNo],n.reconcile(t,l)})),delete e.worksheetHash,delete e.worksheetRels,delete e.globalRels,delete e.sharedStrings,delete e.workbookRels,delete e.sheetDefs,delete e.styles,delete e.mediaIndex,delete e.drawings,delete e.drawingRels,delete e.vmlDrawings}async _processWorksheetEntry(e,t,r,n,i){const s=new w(n),a=await s.parseStream(e);a.sheetNo=r,t.worksheetHash[i]=a,t.worksheets.push(a)}async _processCommentEntry(e,t,r){const n=new _,i=await n.parseStream(e);t.comments["../".concat(r,".xml")]=i}async _processTableEntry(e,t,r){const n=new S,i=await n.parseStream(e);t.tables["../tables/".concat(r,".xml")]=i}async _processWorksheetRelsEntry(e,t,r){const n=new g,i=await n.parseStream(e);t.worksheetRels[r]=i}async _processMediaEntry(e,t,r){const n=r.lastIndexOf(".");if(n>=1){const i=r.substr(n+1),s=r.substr(0,n);await new Promise(((n,a)=>{const o=new c;o.on("finish",(()=>{t.mediaIndex[r]=t.media.length,t.mediaIndex[s]=t.media.length;const e={type:"image",name:s,extension:i,buffer:o.toBuffer()};t.media.push(e),n()})),e.on("error",(e=>{a(e)})),e.pipe(o)}))}}async _processDrawingEntry(e,t,r){const n=new x,i=await n.parseStream(e);t.drawings[r]=i}async _processDrawingRelsEntry(e,t,r){const n=new g,i=await n.parseStream(e);t.drawingRels[r]=i}async _processVmlDrawingEntry(e,t,r){const n=new C,i=await n.parseStream(e);t.vmlDrawings["../drawings/".concat(r,".vml")]=i}async _processThemeEntry(e,t,r){await new Promise(((n,i)=>{const s=new c;e.on("error",i),s.on("error",i),s.on("finish",(()=>{t.themes[r]=s.read().toString(),n()})),e.pipe(s)}))}createInputStream(){throw new Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}async read(e,t){!e[Symbol.asyncIterator]&&e.pipe&&(e=e.pipe(new o));const r=[];var i,s=!1,l=!1;try{for(var c,u=a(e);s=!(c=await u.next()).done;s=!1){const e=c.value;r.push(e)}}catch(h){l=!0,i=h}finally{try{s&&null!=u.return&&await u.return()}finally{if(l)throw i}}return this.load(n.concat(r),t)}async load(e,t){let i;i=t&&t.base64?n.from(e.toString(),"base64"):e;const a={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}},l=await s.loadAsync(i);for(const n of Object.values(l.files))if(!n.dir){let e,i=n.name;if("/"===i[0]&&(i=i.substr(1)),i.match(/xl\/media\//)||i.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))e=new o,e.write(await n.async("nodebuffer"));else{let t;e=new o({writableObjectMode:!0,readableObjectMode:!0}),t=r.browser?d(await n.async("nodebuffer")):await n.async("string");const i=16384;for(let r=0;r<t.length;r+=i)e.write(t.substring(r,r+i))}switch(e.end(),i){case"_rels/.rels":a.globalRels=await this.parseRels(e);break;case"xl/workbook.xml":{const t=await this.parseWorkbook(e);a.sheets=t.sheets,a.definedNames=t.definedNames,a.views=t.views,a.properties=t.properties,a.calcProperties=t.calcProperties;break}case"xl/_rels/workbook.xml.rels":a.workbookRels=await this.parseRels(e);break;case"xl/sharedStrings.xml":a.sharedStrings=new m,await a.sharedStrings.parseStream(e);break;case"xl/styles.xml":a.styles=new f,await a.styles.parseStream(e);break;case"docProps/app.xml":{const t=new y,r=await t.parseStream(e);a.company=r.company,a.manager=r.manager;break}case"docProps/core.xml":{const t=new p,r=await t.parseStream(e);Object.assign(a,r);break}default:{let r=i.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if(r){await this._processWorksheetEntry(e,a,r[1],t,i);break}if(r=i.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),r){await this._processWorksheetRelsEntry(e,a,r[1]);break}if(r=i.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/),r){await this._processThemeEntry(e,a,r[1]);break}if(r=i.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/),r){await this._processMediaEntry(e,a,r[1]);break}if(r=i.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/),r){await this._processDrawingEntry(e,a,r[1]);break}if(r=i.match(/xl\/(comments\d+)[.]xml/),r){await this._processCommentEntry(e,a,r[1]);break}if(r=i.match(/xl\/tables\/(table\d+)[.]xml/),r){await this._processTableEntry(e,a,r[1]);break}if(r=i.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/),r){await this._processDrawingRelsEntry(e,a,r[1]);break}if(r=i.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/),r){await this._processVmlDrawingEntry(e,a,r[1]);break}}}}return this.reconcile(a,t),this.workbook.model=a,this.workbook}async addMedia(e,t){await Promise.all(t.media.map((async t=>{if("image"===t.type){const r="xl/media/".concat(t.name,".").concat(t.extension);if(t.filename){const n=await function(e,t){return new Promise(((r,n)=>{i.readFile(e,t,((e,t)=>{e?n(e):r(t)}))}))}(t.filename);return e.append(n,{name:r})}if(t.buffer)return e.append(t.buffer,{name:r});if(t.base64){const n=t.base64,i=n.substring(n.indexOf(",")+1);return e.append(i,{name:r,base64:!0})}}throw new Error("Unsupported media")})))}addDrawings(e,t){const r=new x,n=new g;t.worksheets.forEach((t=>{const{drawing:i}=t;if(i){r.prepare(i,{});let t=r.toXml(i);e.append(t,{name:"xl/drawings/".concat(i.name,".xml")}),t=n.toXml(i.rels),e.append(t,{name:"xl/drawings/_rels/".concat(i.name,".xml.rels")})}}))}addTables(e,t){const r=new S;t.worksheets.forEach((t=>{const{tables:n}=t;n.forEach((t=>{r.prepare(t,{});const n=r.toXml(t);e.append(n,{name:"xl/tables/"+t.target})}))}))}async addContentTypes(e,t){const r=(new v).toXml(t);e.append(r,{name:"[Content_Types].xml"})}async addApp(e,t){const r=(new y).toXml(t);e.append(r,{name:"docProps/app.xml"})}async addCore(e,t){const r=new p;e.append(r.toXml(t),{name:"docProps/core.xml"})}async addThemes(e,t){const r=t.themes||{theme1:E};Object.keys(r).forEach((t=>{const n=r[t],i="xl/theme/".concat(t,".xml");e.append(n,{name:i})}))}async addOfficeRels(e){const t=(new g).toXml([{Id:"rId1",Type:A.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:A.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:A.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);e.append(t,{name:"_rels/.rels"})}async addWorkbookRels(e,t){let r=1;const n=[{Id:"rId"+r++,Type:A.RelType.Styles,Target:"styles.xml"},{Id:"rId"+r++,Type:A.RelType.Theme,Target:"theme/theme1.xml"}];t.sharedStrings.count&&n.push({Id:"rId"+r++,Type:A.RelType.SharedStrings,Target:"sharedStrings.xml"}),t.worksheets.forEach((e=>{e.rId="rId"+r++,n.push({Id:e.rId,Type:A.RelType.Worksheet,Target:"worksheets/sheet".concat(e.id,".xml")})}));const i=(new g).toXml(n);e.append(i,{name:"xl/_rels/workbook.xml.rels"})}async addSharedStrings(e,t){t.sharedStrings&&t.sharedStrings.count&&e.append(t.sharedStrings.xml,{name:"xl/sharedStrings.xml"})}async addStyles(e,t){const{xml:r}=t.styles;r&&e.append(r,{name:"xl/styles.xml"})}async addWorkbook(e,t){const r=new b;e.append(r.toXml(t),{name:"xl/workbook.xml"})}async addWorksheets(e,t){const r=new w,n=new g,i=new _,s=new C;t.worksheets.forEach((t=>{let a=new h;r.render(a,t),e.append(a.xml,{name:"xl/worksheets/sheet".concat(t.id,".xml")}),t.rels&&t.rels.length&&(a=new h,n.render(a,t.rels),e.append(a.xml,{name:"xl/worksheets/_rels/sheet".concat(t.id,".xml.rels")})),t.comments.length>0&&(a=new h,i.render(a,t),e.append(a.xml,{name:"xl/comments".concat(t.id,".xml")}),a=new h,s.render(a,t),e.append(a.xml,{name:"xl/drawings/vmlDrawing".concat(t.id,".vml")}))}))}_finalize(e){return new Promise(((t,r)=>{e.on("finish",(()=>{t(this)})),e.on("error",r),e.finalize()}))}prepareModel(e,t){e.creator=e.creator||"ExcelJS",e.lastModifiedBy=e.lastModifiedBy||"ExcelJS",e.created=e.created||new Date,e.modified=e.modified||new Date,e.useSharedStrings=void 0===t.useSharedStrings||t.useSharedStrings,e.useStyles=void 0===t.useStyles||t.useStyles,e.sharedStrings=new m,e.styles=e.useStyles?new f(!0):new f.Mock;const r=new b,n=new w;r.prepare(e);const i={sharedStrings:e.sharedStrings,styles:e.styles,date1904:e.properties.date1904,drawingsCount:0,media:e.media};i.drawings=e.drawings=[],i.commentRefs=e.commentRefs=[];let s=0;e.tables=[],e.worksheets.forEach((t=>{t.tables.forEach((t=>{s++,t.target="table".concat(s,".xml"),t.id=s,e.tables.push(t)})),n.prepare(t,i)}))}async write(e,t){t=t||{};const{model:r}=this.workbook,n=new l.ZipWriter(t.zip);return n.pipe(e),this.prepareModel(r,t),await this.addContentTypes(n,r),await this.addOfficeRels(n,r),await this.addWorkbookRels(n,r),await this.addWorksheets(n,r),await this.addSharedStrings(n,r),await this.addDrawings(n,r),await this.addTables(n,r),await Promise.all([this.addThemes(n,r),this.addStyles(n,r)]),await this.addMedia(n,r),await Promise.all([this.addApp(n,r),this.addCore(n,r)]),await this.addWorkbook(n,r),this._finalize(n)}writeFile(e,t){const r=i.createWriteStream(e);return new Promise(((e,n)=>{r.on("finish",(()=>{e()})),r.on("error",(e=>{n(e)})),this.write(r,t).then((()=>{r.end()})).catch((e=>{n(e)}))}))}async writeBuffer(e){const t=new c;return await this.write(t,e),t.read()}}A.RelType=e("./rel-type"),t.exports=A}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"../utils/browser-buffer-decode":16,"../utils/stream-buf":24,"../utils/utils":27,"../utils/xml-stream":28,"../utils/zip-stream":29,"./rel-type":31,"./xform/book/workbook-xform":38,"./xform/comment/comments-xform":40,"./xform/comment/vml-notes-xform":45,"./xform/core/app-xform":51,"./xform/core/content-types-xform":52,"./xform/core/core-xform":53,"./xform/core/relationships-xform":55,"./xform/drawing/drawing-xform":62,"./xform/sheet/worksheet-xform":115,"./xform/strings/shared-strings-xform":124,"./xform/style/styles-xform":135,"./xform/table/table-xform":143,"./xml/theme1":145,_process:467,buffer:220,fs:216,jszip:441,"readable-stream":491}],145:[function(e,t,r){"use strict";t.exports='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/> <a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/> <a:font script="Hans" typeface="\u5b8b\u4f53"/> <a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/> <a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/> <a:font script="Hans" typeface="\u5b8b\u4f53"/> <a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>'},{}],146:[function(e,t,r){(function(t){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CsvFormatterStream=void 0;const n=e("stream"),i=e("./formatter");class s extends n.Transform{constructor(e){super({writableObjectMode:e.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=e,this.rowFormatter=new i.RowFormatter(e),this.hasWrittenBOM=!e.writeBOM}transform(e){return this.rowFormatter.rowTransform=e,this}_transform(e,r,n){let i=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(e,((e,r)=>e?(i=!0,n(e)):(r&&r.forEach((e=>{this.push(t.from(e,"utf8"))})),i=!0,n())))}catch(e){if(i)throw e;n(e)}}_flush(e){this.rowFormatter.finish(((r,n)=>r?e(r):(n&&n.forEach((e=>{this.push(t.from(e,"utf8"))})),e())))}}r.CsvFormatterStream=s}).call(this)}).call(this,e("buffer").Buffer)},{"./formatter":150,buffer:220,stream:505}],147:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FormatterOptions=void 0,r.FormatterOptions=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;this.objectMode=!0,this.delimiter=",",this.rowDelimiter="\n",this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\ufeff",this.alwaysWriteHeaders=!1,Object.assign(this,e||{}),void 0===(null==e?void 0:e.quoteHeaders)&&(this.quoteHeaders=this.quoteColumns),!0===(null==e?void 0:e.quote)?this.quote='"':!1===(null==e?void 0:e.quote)&&(this.quote=""),"string"!=typeof(null==e?void 0:e.escape)&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&(null===(t=e.writeHeaders)||void 0===t||t),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote="".concat(this.escape).concat(this.quote)}}},{}],148:[function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.FieldFormatter=void 0;const i=n(e("lodash.isboolean")),s=n(e("lodash.isnil")),a=n(e("lodash.escaperegexp"));r.FieldFormatter=class{constructor(e){this._headers=null,this.formatterOptions=e,null!==e.headers&&(this.headers=e.headers),this.REPLACE_REGEXP=new RegExp(e.quote,"g");const t="[".concat(e.delimiter).concat(a.default(e.rowDelimiter),"|\r|\n]");this.ESCAPE_REGEXP=new RegExp(t)}set headers(e){this._headers=e}shouldQuote(e,t){const r=t?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return i.default(r)?r:Array.isArray(r)?r[e]:null!==this._headers&&r[this._headers[e]]}format(e,t,r){const n=(""+(s.default(e)?"":e)).replace(/\0/g,""),{formatterOptions:i}=this;return""!==i.quote&&-1!==n.indexOf(i.quote)?this.quoteField(n.replace(this.REPLACE_REGEXP,i.escapedQuote)):-1!==n.search(this.ESCAPE_REGEXP)||this.shouldQuote(t,r)?this.quoteField(n):n}quoteField(e){const{quote:t}=this.formatterOptions;return"".concat(t).concat(e).concat(t)}}},{"lodash.escaperegexp":442,"lodash.isboolean":444,"lodash.isnil":447}],149:[function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.RowFormatter=void 0;const i=n(e("lodash.isfunction")),s=n(e("lodash.isequal")),a=e("./FieldFormatter"),o=e("../types");class l{constructor(e){this.rowCount=0,this.formatterOptions=e,this.fieldFormatter=new a.FieldFormatter(e),this.headers=e.headers,this.shouldWriteHeaders=e.shouldWriteHeaders,this.hasWrittenHeaders=!1,null!==this.headers&&(this.fieldFormatter.headers=this.headers),e.transform&&(this.rowTransform=e.transform)}static isRowHashArray(e){return!!Array.isArray(e)&&Array.isArray(e[0])&&2===e[0].length}static isRowArray(e){return Array.isArray(e)&&!this.isRowHashArray(e)}static gatherHeaders(e){return l.isRowHashArray(e)?e.map((e=>e[0])):Array.isArray(e)?e:Object.keys(e)}static createTransform(e){return o.isSyncTransform(e)?(t,r)=>{let n=null;try{n=e(t)}catch(e){return r(e)}return r(null,n)}:(t,r)=>{e(t,r)}}set rowTransform(e){if(!i.default(e))throw new TypeError("The transform should be a function");this._rowTransform=l.createTransform(e)}format(e,t){this.callTransformer(e,((r,n)=>{if(r)return t(r);if(!e)return t(null);const i=[];if(n){const{shouldFormatColumns:e,headers:t}=this.checkHeaders(n);if(this.shouldWriteHeaders&&t&&!this.hasWrittenHeaders&&(i.push(this.formatColumns(t,!0)),this.hasWrittenHeaders=!0),e){const e=this.gatherColumns(n);i.push(this.formatColumns(e,!1))}}return t(null,i)}))}finish(e){const t=[];if(this.formatterOptions.alwaysWriteHeaders&&0===this.rowCount){if(!this.headers)return e(new Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));t.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&t.push(this.formatterOptions.rowDelimiter),e(null,t)}checkHeaders(e){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};const t=l.gatherHeaders(e);return this.headers=t,this.fieldFormatter.headers=t,this.shouldWriteHeaders?{shouldFormatColumns:!s.default(t,e),headers:t}:{shouldFormatColumns:!0,headers:null}}gatherColumns(e){if(null===this.headers)throw new Error("Headers is currently null");return Array.isArray(e)?l.isRowHashArray(e)?this.headers.map(((t,r)=>{const n=e[r];return n?n[1]:""})):l.isRowArray(e)&&!this.shouldWriteHeaders?e:this.headers.map(((t,r)=>e[r])):this.headers.map((t=>e[t]))}callTransformer(e,t){return this._rowTransform?this._rowTransform(e,t):t(null,e)}formatColumns(e,t){const r=e.map(((e,r)=>this.fieldFormatter.format(e,r,t))).join(this.formatterOptions.delimiter),{rowCount:n}=this;return this.rowCount+=1,n?[this.formatterOptions.rowDelimiter,r].join(""):r}}r.RowFormatter=l},{"../types":152,"./FieldFormatter":148,"lodash.isequal":445,"lodash.isfunction":446}],150:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FieldFormatter=r.RowFormatter=void 0;var n=e("./RowFormatter");Object.defineProperty(r,"RowFormatter",{enumerable:!0,get:function(){return n.RowFormatter}});var i=e("./FieldFormatter");Object.defineProperty(r,"FieldFormatter",{enumerable:!0,get:function(){return i.FieldFormatter}})},{"./FieldFormatter":148,"./RowFormatter":149}],151:[function(e,t,r){(function(t){(function(){"use strict";var n=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]},i=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},a=function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.writeToPath=r.writeToString=r.writeToBuffer=r.writeToStream=r.write=r.format=r.FormatterOptions=r.CsvFormatterStream=void 0;const o=e("util"),l=e("stream"),c=s(e("fs")),u=e("./FormatterOptions"),h=e("./CsvFormatterStream");a(e("./types"),r);var d=e("./CsvFormatterStream");Object.defineProperty(r,"CsvFormatterStream",{enumerable:!0,get:function(){return d.CsvFormatterStream}});var f=e("./FormatterOptions");Object.defineProperty(r,"FormatterOptions",{enumerable:!0,get:function(){return f.FormatterOptions}}),r.format=e=>new h.CsvFormatterStream(new u.FormatterOptions(e)),r.write=(e,t)=>{const n=r.format(t),i=o.promisify(((e,t)=>{n.write(e,void 0,t)}));return e.reduce(((e,t)=>e.then((()=>i(t)))),Promise.resolve()).then((()=>n.end())).catch((e=>{n.emit("error",e)})),n},r.writeToStream=(e,t,n)=>r.write(t,n).pipe(e),r.writeToBuffer=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=[],s=new l.Writable({write(e,t,r){i.push(e),r()}});return new Promise(((a,o)=>{s.on("error",o).on("finish",(()=>a(t.concat(i)))),r.write(e,n).pipe(s)}))},r.writeToString=(e,t)=>r.writeToBuffer(e,t).then((e=>e.toString())),r.writeToPath=(e,t,n)=>{const i=c.createWriteStream(e,{encoding:"utf8"});return r.write(t,n).pipe(i)}}).call(this)}).call(this,e("buffer").Buffer)},{"./CsvFormatterStream":146,"./FormatterOptions":147,"./types":152,buffer:220,fs:216,stream:505,util:527}],152:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isSyncTransform=void 0,r.isSyncTransform=e=>1===e.length},{}],153:[function(e,t,r){(function(t){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CsvParserStream=void 0;const n=e("string_decoder"),i=e("stream"),s=e("./transforms"),a=e("./parser");class o extends i.Transform{constructor(e){super({objectMode:e.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=e,this.parser=new a.Parser(e),this.headerTransformer=new s.HeaderTransformer(e),this.decoder=new n.StringDecoder(e.encoding),this.rowTransformerValidator=new s.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(e){return this.rowTransformerValidator.rowTransform=e,this}validate(e){return this.rowTransformerValidator.rowValidator=e,this}emit(e){if("end"===e)return this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1;for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return super.emit(e,...r)}_transform(e,t,r){if(this.hasHitRowLimit)return r();const n=o.wrapDoneCallback(r);try{const{lines:t}=this,r=t+this.decoder.write(e),i=this.parse(r,!0);return this.processRows(i,n)}catch(e){return n(e)}}_flush(e){const t=o.wrapDoneCallback(e);if(this.hasHitRowLimit)return t();try{const e=this.lines+this.decoder.end(),r=this.parse(e,!1);return this.processRows(r,t)}catch(e){return t(e)}}parse(e,t){if(!e)return[];const{line:r,rows:n}=this.parser.parse(e,t);return this.lines=r,n}processRows(e,r){const n=e.length,i=s=>{const a=e=>e?r(e):s%100!=0?i(s+1):void t((()=>i(s+1)));if(this.checkAndEmitHeaders(),s>=n||this.hasHitRowLimit)return r();if(this.parsedLineCount+=1,this.shouldSkipLine)return a();const o=e[s];this.rowCount+=1,this.parsedRowCount+=1;const l=this.rowCount;return this.transformRow(o,((e,t)=>{if(e)return this.rowCount-=1,a(e);if(!t)return a(new Error("expected transform result"));if(t.isValid){if(t.row)return this.pushRow(t.row,a)}else this.emit("data-invalid",t.row,l,t.reason);return a()}))};i(0)}transformRow(e,t){try{this.headerTransformer.transform(e,((r,n)=>r?t(r):n?n.isValid?n.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(n.row,t):this.skipRow(t):(this.rowCount-=1,this.parsedRowCount-=1,t(null,{row:null,isValid:!0})):this.shouldEmitRows?t(null,{isValid:!1,row:e}):this.skipRow(t):t(new Error("Expected result from header transform"))))}catch(e){t(e)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(e){return this.rowCount-=1,e(null,{row:null,isValid:!0})}pushRow(e,t){try{this.parserOptions.objectMode?this.push(e):this.push(JSON.stringify(e)),t()}catch(e){t(e)}}static wrapDoneCallback(e){let t=!1;return function(r){if(r){if(t)throw r;return t=!0,void e(r)}for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];e(...i)}}}r.CsvParserStream=o}).call(this)}).call(this,e("timers").setImmediate)},{"./parser":165,"./transforms":168,stream:505,string_decoder:218,timers:523}],154:[function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.ParserOptions=void 0;const i=n(e("lodash.escaperegexp")),s=n(e("lodash.isnil"));r.ParserOptions=class{constructor(e){var t;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,e||{}),this.delimiter.length>1)throw new Error("delimiter option must be one character long");this.escapedDelimiter=i.default(this.delimiter),this.escapeChar=null!==(t=this.escape)&&void 0!==t?t:this.quote,this.supportsComments=!s.default(this.comment),this.NEXT_TOKEN_REGEXP=new RegExp("([^\\s]|\\r\\n|\\n|\\r|".concat(this.escapedDelimiter,")")),this.maxRows>0&&(this.limitRows=!0)}}},{"lodash.escaperegexp":442,"lodash.isnil":447}],155:[function(e,t,r){"use strict";var n=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]},i=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},a=function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.parseString=r.parseFile=r.parseStream=r.parse=r.ParserOptions=r.CsvParserStream=void 0;const o=s(e("fs")),l=e("stream"),c=e("./ParserOptions"),u=e("./CsvParserStream");a(e("./types"),r);var h=e("./CsvParserStream");Object.defineProperty(r,"CsvParserStream",{enumerable:!0,get:function(){return h.CsvParserStream}});var d=e("./ParserOptions");Object.defineProperty(r,"ParserOptions",{enumerable:!0,get:function(){return d.ParserOptions}}),r.parse=e=>new u.CsvParserStream(new c.ParserOptions(e)),r.parseStream=(e,t)=>e.pipe(new u.CsvParserStream(new c.ParserOptions(t))),r.parseFile=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o.createReadStream(e).pipe(new u.CsvParserStream(new c.ParserOptions(t)))},r.parseString=(e,t)=>{const r=new l.Readable;return r.push(e),r.push(null),r.pipe(new u.CsvParserStream(new c.ParserOptions(t)))}},{"./CsvParserStream":153,"./ParserOptions":154,"./types":169,fs:216,stream:505}],156:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Parser=void 0;const n=e("./Scanner"),i=e("./RowParser"),s=e("./Token");class a{constructor(e){this.parserOptions=e,this.rowParser=new i.RowParser(this.parserOptions)}static removeBOM(e){return e&&65279===e.charCodeAt(0)?e.slice(1):e}parse(e,t){const r=new n.Scanner({line:a.removeBOM(e),parserOptions:this.parserOptions,hasMoreData:t});return this.parserOptions.supportsComments?this.parseWithComments(r):this.parseWithoutComments(r)}parseWithoutComments(e){const t=[];let r=!0;for(;r;)r=this.parseRow(e,t);return{line:e.line,rows:t}}parseWithComments(e){const{parserOptions:t}=this,r=[];for(let n=e.nextCharacterToken;null!==n;n=e.nextCharacterToken)if(s.Token.isTokenComment(n,t)){if(null===e.advancePastLine())return{line:e.lineFromCursor,rows:r};if(!e.hasMoreCharacters)return{line:e.lineFromCursor,rows:r};e.truncateToCursor()}else if(!this.parseRow(e,r))break;return{line:e.line,rows:r}}parseRow(e,t){if(!e.nextNonSpaceToken)return!1;const r=this.rowParser.parse(e);return null!==r&&(this.parserOptions.ignoreEmpty&&i.RowParser.isEmptyRow(r)||t.push(r),!0)}}r.Parser=a},{"./RowParser":157,"./Scanner":158,"./Token":159}],157:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RowParser=void 0;const n=e("./column"),i=e("./Token");r.RowParser=class{constructor(e){this.parserOptions=e,this.columnParser=new n.ColumnParser(e)}static isEmptyRow(e){return""===e.join("").replace(/\s+/g,"")}parse(e){const{parserOptions:t}=this,{hasMoreData:r}=e,n=e,s=[];let a=this.getStartToken(n,s);for(;a;){if(i.Token.isTokenRowDelimiter(a))return n.advancePastToken(a),!n.hasMoreCharacters&&i.Token.isTokenCarriageReturn(a,t)&&r?null:(n.truncateToCursor(),s);if(!this.shouldSkipColumnParse(n,a,s)){const e=this.columnParser.parse(n);if(null===e)return null;s.push(e)}a=n.nextNonSpaceToken}return r?null:(n.truncateToCursor(),s)}getStartToken(e,t){const r=e.nextNonSpaceToken;return null!==r&&i.Token.isTokenDelimiter(r,this.parserOptions)?(t.push(""),e.nextNonSpaceToken):r}shouldSkipColumnParse(e,t,r){const{parserOptions:n}=this;if(i.Token.isTokenDelimiter(t,n)){e.advancePastToken(t);const s=e.nextCharacterToken;if(!e.hasMoreCharacters||null!==s&&i.Token.isTokenRowDelimiter(s))return r.push(""),!0;if(null!==s&&i.Token.isTokenDelimiter(s,n))return r.push(""),!0}return!1}}},{"./Token":159,"./column":164}],158:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Scanner=void 0;const n=e("./Token"),i=/((?:\r\n)|\n|\r)/;r.Scanner=class{constructor(e){this.cursor=0,this.line=e.line,this.lineLength=this.line.length,this.parserOptions=e.parserOptions,this.hasMoreData=e.hasMoreData,this.cursor=e.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){const{lineFromCursor:e}=this,t=this.parserOptions.NEXT_TOKEN_REGEXP;if(-1===e.search(t))return null;const r=t.exec(e);if(null==r)return null;const i=r[1],s=this.cursor+(r.index||0);return new n.Token({token:i,startCursor:s,endCursor:s+i.length-1})}get nextCharacterToken(){const{cursor:e,lineLength:t}=this;return t<=e?null:new n.Token({token:this.line[e],startCursor:e,endCursor:e})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){const e=i.exec(this.lineFromCursor);return e?(this.cursor+=(e.index||0)+e[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(e){return this.cursor=e,this}advanceToToken(e){return this.cursor=e.startCursor,this}advancePastToken(e){return this.cursor=e.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}}},{"./Token":159}],159:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Token=void 0,r.Token=class{constructor(e){this.token=e.token,this.startCursor=e.startCursor,this.endCursor=e.endCursor}static isTokenRowDelimiter(e){const t=e.token;return"\r"===t||"\n"===t||"\r\n"===t}static isTokenCarriageReturn(e,t){return e.token===t.carriageReturn}static isTokenComment(e,t){return t.supportsComments&&!!e&&e.token===t.comment}static isTokenEscapeCharacter(e,t){return e.token===t.escapeChar}static isTokenQuote(e,t){return e.token===t.quote}static isTokenDelimiter(e,t){return e.token===t.delimiter}}},{}],160:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ColumnFormatter=void 0,r.ColumnFormatter=class{constructor(e){e.trim?this.format=e=>e.trim():e.ltrim?this.format=e=>e.trimLeft():e.rtrim?this.format=e=>e.trimRight():this.format=e=>e}}},{}],161:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ColumnParser=void 0;const n=e("./NonQuotedColumnParser"),i=e("./QuotedColumnParser"),s=e("../Token");r.ColumnParser=class{constructor(e){this.parserOptions=e,this.quotedColumnParser=new i.QuotedColumnParser(e),this.nonQuotedColumnParser=new n.NonQuotedColumnParser(e)}parse(e){const{nextNonSpaceToken:t}=e;return null!==t&&s.Token.isTokenQuote(t,this.parserOptions)?(e.advanceToToken(t),this.quotedColumnParser.parse(e)):this.nonQuotedColumnParser.parse(e)}}},{"../Token":159,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],162:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.NonQuotedColumnParser=void 0;const n=e("./ColumnFormatter"),i=e("../Token");r.NonQuotedColumnParser=class{constructor(e){this.parserOptions=e,this.columnFormatter=new n.ColumnFormatter(e)}parse(e){if(!e.hasMoreCharacters)return null;const{parserOptions:t}=this,r=[];let n=e.nextCharacterToken;for(;n&&!i.Token.isTokenDelimiter(n,t)&&!i.Token.isTokenRowDelimiter(n);n=e.nextCharacterToken)r.push(n.token),e.advancePastToken(n);return this.columnFormatter.format(r.join(""))}}},{"../Token":159,"./ColumnFormatter":160}],163:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.QuotedColumnParser=void 0;const n=e("./ColumnFormatter"),i=e("../Token");r.QuotedColumnParser=class{constructor(e){this.parserOptions=e,this.columnFormatter=new n.ColumnFormatter(e)}parse(e){if(!e.hasMoreCharacters)return null;const t=e.cursor,{foundClosingQuote:r,col:n}=this.gatherDataBetweenQuotes(e);if(!r){if(e.advanceTo(t),!e.hasMoreData)throw new Error("Parse Error: missing closing: '".concat(this.parserOptions.quote||"","' in line: at '").concat(e.lineFromCursor.replace(/[\r\n]/g,"\\n'"),"'"));return null}return this.checkForMalformedColumn(e),n}gatherDataBetweenQuotes(e){const{parserOptions:t}=this;let r=!1,n=!1;const s=[];let a=e.nextCharacterToken;for(;!n&&null!==a;a=e.nextCharacterToken){const o=i.Token.isTokenQuote(a,t);if(!r&&o)r=!0;else if(r)if(i.Token.isTokenEscapeCharacter(a,t)){e.advancePastToken(a);const r=e.nextCharacterToken;null!==r&&(i.Token.isTokenQuote(r,t)||i.Token.isTokenEscapeCharacter(r,t))?(s.push(r.token),a=r):o?n=!0:s.push(a.token)}else o?n=!0:s.push(a.token);e.advancePastToken(a)}return{col:this.columnFormatter.format(s.join("")),foundClosingQuote:n}}checkForMalformedColumn(e){const{parserOptions:t}=this,{nextNonSpaceToken:r}=e;if(r){const n=i.Token.isTokenDelimiter(r,t),s=i.Token.isTokenRowDelimiter(r);if(!n&&!s){const n=e.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw new Error("Parse Error: expected: '".concat(t.escapedDelimiter,"' OR new line got: '").concat(r.token,"'. at '").concat(n))}e.advanceToToken(r)}else e.hasMoreData||e.advancePastLine()}}},{"../Token":159,"./ColumnFormatter":160}],164:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ColumnFormatter=r.QuotedColumnParser=r.NonQuotedColumnParser=r.ColumnParser=void 0;var n=e("./ColumnParser");Object.defineProperty(r,"ColumnParser",{enumerable:!0,get:function(){return n.ColumnParser}});var i=e("./NonQuotedColumnParser");Object.defineProperty(r,"NonQuotedColumnParser",{enumerable:!0,get:function(){return i.NonQuotedColumnParser}});var s=e("./QuotedColumnParser");Object.defineProperty(r,"QuotedColumnParser",{enumerable:!0,get:function(){return s.QuotedColumnParser}});var a=e("./ColumnFormatter");Object.defineProperty(r,"ColumnFormatter",{enumerable:!0,get:function(){return a.ColumnFormatter}})},{"./ColumnFormatter":160,"./ColumnParser":161,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],165:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.QuotedColumnParser=r.NonQuotedColumnParser=r.ColumnParser=r.Token=r.Scanner=r.RowParser=r.Parser=void 0;var n=e("./Parser");Object.defineProperty(r,"Parser",{enumerable:!0,get:function(){return n.Parser}});var i=e("./RowParser");Object.defineProperty(r,"RowParser",{enumerable:!0,get:function(){return i.RowParser}});var s=e("./Scanner");Object.defineProperty(r,"Scanner",{enumerable:!0,get:function(){return s.Scanner}});var a=e("./Token");Object.defineProperty(r,"Token",{enumerable:!0,get:function(){return a.Token}});var o=e("./column");Object.defineProperty(r,"ColumnParser",{enumerable:!0,get:function(){return o.ColumnParser}}),Object.defineProperty(r,"NonQuotedColumnParser",{enumerable:!0,get:function(){return o.NonQuotedColumnParser}}),Object.defineProperty(r,"QuotedColumnParser",{enumerable:!0,get:function(){return o.QuotedColumnParser}})},{"./Parser":156,"./RowParser":157,"./Scanner":158,"./Token":159,"./column":164}],166:[function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.HeaderTransformer=void 0;const i=n(e("lodash.isundefined")),s=n(e("lodash.isfunction")),a=n(e("lodash.uniq")),o=n(e("lodash.groupby"));r.HeaderTransformer=class{constructor(e){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=e,!0===e.headers?this.shouldUseFirstRow=!0:Array.isArray(e.headers)?this.setHeaders(e.headers):s.default(e.headers)&&(this.headersTransform=e.headers)}transform(e,t){return this.shouldMapRow(e)?t(null,this.processRow(e)):t(null,{row:null,isValid:!0})}shouldMapRow(e){const{parserOptions:t}=this;if(!this.headersTransform&&t.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw new Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(e)){if(this.headersTransform)this.setHeaders(this.headersTransform(e));else{if(!this.shouldUseFirstRow)return!0;this.setHeaders(e)}return!1}return!0}processRow(e){if(!this.headers)return{row:e,isValid:!0};const{parserOptions:t}=this;if(!t.discardUnmappedColumns&&e.length>this.headersLength){if(!t.strictColumnHandling)throw new Error("Unexpected Error: column header mismatch expected: ".concat(this.headersLength," columns got: ").concat(e.length));return{row:e,isValid:!1,reason:"Column header mismatch expected: ".concat(this.headersLength," columns got: ").concat(e.length)}}return t.strictColumnHandling&&e.length<this.headersLength?{row:e,isValid:!1,reason:"Column header mismatch expected: ".concat(this.headersLength," columns got: ").concat(e.length)}:{row:this.mapHeaders(e),isValid:!0}}mapHeaders(e){const t={},{headers:r,headersLength:n}=this;for(let s=0;s<n;s+=1){const n=r[s];if(!i.default(n)){const r=e[s];i.default(r)?t[n]="":t[n]=r}}return t}setHeaders(e){var t;const r=e.filter((e=>!!e));if(a.default(r).length!==r.length){const e=o.default(r),t=Object.keys(e).filter((t=>e[t].length>1));throw new Error("Duplicate headers found "+JSON.stringify(t))}this.headers=e,this.receivedHeaders=!0,this.headersLength=(null===(t=this.headers)||void 0===t?void 0:t.length)||0}}},{"lodash.groupby":443,"lodash.isfunction":446,"lodash.isundefined":448,"lodash.uniq":449}],167:[function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.RowTransformerValidator=void 0;const i=n(e("lodash.isfunction")),s=e("../types");class a{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(e){return s.isSyncTransform(e)?(t,r)=>{let n=null;try{n=e(t)}catch(e){return r(e)}return r(null,n)}:e}static createValidator(e){return s.isSyncValidate(e)?(t,r)=>{r(null,{row:t,isValid:e(t)})}:(t,r)=>{e(t,((e,n,i)=>e?r(e):r(null,n?{row:t,isValid:n,reason:i}:{row:t,isValid:!1,reason:i})))}}set rowTransform(e){if(!i.default(e))throw new TypeError("The transform should be a function");this._rowTransform=a.createTransform(e)}set rowValidator(e){if(!i.default(e))throw new TypeError("The validate should be a function");this._rowValidator=a.createValidator(e)}transformAndValidate(e,t){return this.callTransformer(e,((e,r)=>e?t(e):r?this.callValidator(r,((e,n)=>e?t(e):n&&!n.isValid?t(null,{row:r,isValid:!1,reason:n.reason}):t(null,{row:r,isValid:!0}))):t(null,{row:null,isValid:!0})))}callTransformer(e,t){return this._rowTransform?this._rowTransform(e,t):t(null,e)}callValidator(e,t){return this._rowValidator?this._rowValidator(e,t):t(null,{row:e,isValid:!0})}}r.RowTransformerValidator=a},{"../types":169,"lodash.isfunction":446}],168:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.HeaderTransformer=r.RowTransformerValidator=void 0;var n=e("./RowTransformerValidator");Object.defineProperty(r,"RowTransformerValidator",{enumerable:!0,get:function(){return n.RowTransformerValidator}});var i=e("./HeaderTransformer");Object.defineProperty(r,"HeaderTransformer",{enumerable:!0,get:function(){return i.HeaderTransformer}})},{"./HeaderTransformer":166,"./RowTransformerValidator":167}],169:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isSyncValidate=r.isSyncTransform=void 0,r.isSyncTransform=e=>1===e.length,r.isSyncValidate=e=>1===e.length},{}],170:[function(e,t,r){"use strict";const n=r;n.bignum=e("bn.js"),n.define=e("./asn1/api").define,n.base=e("./asn1/base"),n.constants=e("./asn1/constants"),n.decoders=e("./asn1/decoders"),n.encoders=e("./asn1/encoders")},{"./asn1/api":171,"./asn1/base":173,"./asn1/constants":177,"./asn1/decoders":179,"./asn1/encoders":182,"bn.js":184}],171:[function(e,t,r){"use strict";const n=e("./encoders"),i=e("./decoders"),s=e("inherits");function a(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}r.define=function(e,t){return new a(e,t)},a.prototype._createNamed=function(e){const t=this.name;function r(e){this._initNamed(e,t)}return s(r,e),r.prototype._initNamed=function(t,r){e.call(this,t,r)},new r(this)},a.prototype._getDecoder=function(e){return e=e||"der",this.decoders.hasOwnProperty(e)||(this.decoders[e]=this._createNamed(i[e])),this.decoders[e]},a.prototype.decode=function(e,t,r){return this._getDecoder(t).decode(e,r)},a.prototype._getEncoder=function(e){return e=e||"der",this.encoders.hasOwnProperty(e)||(this.encoders[e]=this._createNamed(n[e])),this.encoders[e]},a.prototype.encode=function(e,t,r){return this._getEncoder(t).encode(e,r)}},{"./decoders":179,"./encoders":182,inherits:440}],172:[function(e,t,r){"use strict";const n=e("inherits"),i=e("../base/reporter").Reporter,s=e("safer-buffer").Buffer;function a(e,t){i.call(this,t),s.isBuffer(e)?(this.base=e,this.offset=0,this.length=e.length):this.error("Input not Buffer")}function o(e,t){if(Array.isArray(e))this.length=0,this.value=e.map((function(e){return o.isEncoderBuffer(e)||(e=new o(e,t)),this.length+=e.length,e}),this);else if("number"==typeof e){if(!(0<=e&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if("string"==typeof e)this.value=e,this.length=s.byteLength(e);else{if(!s.isBuffer(e))return t.error("Unsupported type: "+typeof e);this.value=e,this.length=e.length}}n(a,i),r.DecoderBuffer=a,a.isDecoderBuffer=function(e){return e instanceof a||"object"==typeof e&&s.isBuffer(e.base)&&"DecoderBuffer"===e.constructor.name&&"number"==typeof e.offset&&"number"==typeof e.length&&"function"==typeof e.save&&"function"==typeof e.restore&&"function"==typeof e.isEmpty&&"function"==typeof e.readUInt8&&"function"==typeof e.skip&&"function"==typeof e.raw},a.prototype.save=function(){return{offset:this.offset,reporter:i.prototype.save.call(this)}},a.prototype.restore=function(e){const t=new a(this.base);return t.offset=e.offset,t.length=this.offset,this.offset=e.offset,i.prototype.restore.call(this,e.reporter),t},a.prototype.isEmpty=function(){return this.offset===this.length},a.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")},a.prototype.skip=function(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");const r=new a(this.base);return r._reporterState=this._reporterState,r.offset=this.offset,r.length=this.offset+e,this.offset+=e,r},a.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)},r.EncoderBuffer=o,o.isEncoderBuffer=function(e){return e instanceof o||"object"==typeof e&&"EncoderBuffer"===e.constructor.name&&"number"==typeof e.length&&"function"==typeof e.join},o.prototype.join=function(e,t){return e||(e=s.alloc(this.length)),t||(t=0),0===this.length||(Array.isArray(this.value)?this.value.forEach((function(r){r.join(e,t),t+=r.length})):("number"==typeof this.value?e[t]=this.value:"string"==typeof this.value?e.write(this.value,t):s.isBuffer(this.value)&&this.value.copy(e,t),t+=this.length)),e}},{"../base/reporter":175,inherits:440,"safer-buffer":495}],173:[function(e,t,r){"use strict";const n=r;n.Reporter=e("./reporter").Reporter,n.DecoderBuffer=e("./buffer").DecoderBuffer,n.EncoderBuffer=e("./buffer").EncoderBuffer,n.Node=e("./node")},{"./buffer":172,"./node":174,"./reporter":175}],174:[function(e,t,r){"use strict";const n=e("../base/reporter").Reporter,i=e("../base/buffer").EncoderBuffer,s=e("../base/buffer").DecoderBuffer,a=e("minimalistic-assert"),o=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],l=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(o);function c(e,t,r){const n={};this._baseState=n,n.name=r,n.enc=e,n.parent=t||null,n.children=null,n.tag=null,n.args=null,n.reverseArgs=null,n.choice=null,n.optional=!1,n.any=!1,n.obj=!1,n.use=null,n.useDecoder=null,n.key=null,n.default=null,n.explicit=null,n.implicit=null,n.contains=null,n.parent||(n.children=[],this._wrap())}t.exports=c;const u=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];c.prototype.clone=function(){const e=this._baseState,t={};u.forEach((function(r){t[r]=e[r]}));const r=new this.constructor(t.parent);return r._baseState=t,r},c.prototype._wrap=function(){const e=this._baseState;l.forEach((function(t){this[t]=function(){const r=new this.constructor(this);return e.children.push(r),r[t].apply(r,arguments)}}),this)},c.prototype._init=function(e){const t=this._baseState;a(null===t.parent),e.call(this),t.children=t.children.filter((function(e){return e._baseState.parent===this}),this),a.equal(t.children.length,1,"Root node can have only one child")},c.prototype._useArgs=function(e){const t=this._baseState,r=e.filter((function(e){return e instanceof this.constructor}),this);e=e.filter((function(e){return!(e instanceof this.constructor)}),this),0!==r.length&&(a(null===t.children),t.children=r,r.forEach((function(e){e._baseState.parent=this}),this)),0!==e.length&&(a(null===t.args),t.args=e,t.reverseArgs=e.map((function(e){if("object"!=typeof e||e.constructor!==Object)return e;const t={};return Object.keys(e).forEach((function(r){r==(0|r)&&(r|=0);const n=e[r];t[n]=r})),t})))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach((function(e){c.prototype[e]=function(){const t=this._baseState;throw new Error(e+" not implemented for encoding: "+t.enc)}})),o.forEach((function(e){c.prototype[e]=function(){const t=this._baseState,r=Array.prototype.slice.call(arguments);return a(null===t.tag),t.tag=e,this._useArgs(r),this}})),c.prototype.use=function(e){a(e);const t=this._baseState;return a(null===t.use),t.use=e,this},c.prototype.optional=function(){return this._baseState.optional=!0,this},c.prototype.def=function(e){const t=this._baseState;return a(null===t.default),t.default=e,t.optional=!0,this},c.prototype.explicit=function(e){const t=this._baseState;return a(null===t.explicit&&null===t.implicit),t.explicit=e,this},c.prototype.implicit=function(e){const t=this._baseState;return a(null===t.explicit&&null===t.implicit),t.implicit=e,this},c.prototype.obj=function(){const e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},c.prototype.key=function(e){const t=this._baseState;return a(null===t.key),t.key=e,this},c.prototype.any=function(){return this._baseState.any=!0,this},c.prototype.choice=function(e){const t=this._baseState;return a(null===t.choice),t.choice=e,this._useArgs(Object.keys(e).map((function(t){return e[t]}))),this},c.prototype.contains=function(e){const t=this._baseState;return a(null===t.use),t.contains=e,this},c.prototype._decode=function(e,t){const r=this._baseState;if(null===r.parent)return e.wrapResult(r.children[0]._decode(e,t));let n,i=r.default,a=!0,o=null;if(null!==r.key&&(o=e.enterKey(r.key)),r.optional){let n=null;if(null!==r.explicit?n=r.explicit:null!==r.implicit?n=r.implicit:null!==r.tag&&(n=r.tag),null!==n||r.any){if(a=this._peekTag(e,n,r.any),e.isError(a))return a}else{const n=e.save();try{null===r.choice?this._decodeGeneric(r.tag,e,t):this._decodeChoice(e,t),a=!0}catch(e){a=!1}e.restore(n)}}if(r.obj&&a&&(n=e.enterObject()),a){if(null!==r.explicit){const t=this._decodeTag(e,r.explicit);if(e.isError(t))return t;e=t}const n=e.offset;if(null===r.use&&null===r.choice){let t;r.any&&(t=e.save());const n=this._decodeTag(e,null!==r.implicit?r.implicit:r.tag,r.any);if(e.isError(n))return n;r.any?i=e.raw(t):e=n}if(t&&t.track&&null!==r.tag&&t.track(e.path(),n,e.length,"tagged"),t&&t.track&&null!==r.tag&&t.track(e.path(),e.offset,e.length,"content"),r.any||(i=null===r.choice?this._decodeGeneric(r.tag,e,t):this._decodeChoice(e,t)),e.isError(i))return i;if(r.any||null!==r.choice||null===r.children||r.children.forEach((function(r){r._decode(e,t)})),r.contains&&("octstr"===r.tag||"bitstr"===r.tag)){const n=new s(i);i=this._getUse(r.contains,e._reporterState.obj)._decode(n,t)}}return r.obj&&a&&(i=e.leaveObject(n)),null===r.key||null===i&&!0!==a?null!==o&&e.exitKey(o):e.leaveKey(o,r.key,i),i},c.prototype._decodeGeneric=function(e,t,r){const n=this._baseState;return"seq"===e||"set"===e?null:"seqof"===e||"setof"===e?this._decodeList(t,e,n.args[0],r):/str$/.test(e)?this._decodeStr(t,e,r):"objid"===e&&n.args?this._decodeObjid(t,n.args[0],n.args[1],r):"objid"===e?this._decodeObjid(t,null,null,r):"gentime"===e||"utctime"===e?this._decodeTime(t,e,r):"null_"===e?this._decodeNull(t,r):"bool"===e?this._decodeBool(t,r):"objDesc"===e?this._decodeStr(t,e,r):"int"===e||"enum"===e?this._decodeInt(t,n.args&&n.args[0],r):null!==n.use?this._getUse(n.use,t._reporterState.obj)._decode(t,r):t.error("unknown tag: "+e)},c.prototype._getUse=function(e,t){const r=this._baseState;return r.useDecoder=this._use(e,t),a(null===r.useDecoder._baseState.parent),r.useDecoder=r.useDecoder._baseState.children[0],r.implicit!==r.useDecoder._baseState.implicit&&(r.useDecoder=r.useDecoder.clone(),r.useDecoder._baseState.implicit=r.implicit),r.useDecoder},c.prototype._decodeChoice=function(e,t){const r=this._baseState;let n=null,i=!1;return Object.keys(r.choice).some((function(s){const a=e.save(),o=r.choice[s];try{const r=o._decode(e,t);if(e.isError(r))return!1;n={type:s,value:r},i=!0}catch(t){return e.restore(a),!1}return!0}),this),i?n:e.error("Choice not matched")},c.prototype._createEncoderBuffer=function(e){return new i(e,this.reporter)},c.prototype._encode=function(e,t,r){const n=this._baseState;if(null!==n.default&&n.default===e)return;const i=this._encodeValue(e,t,r);return void 0===i||this._skipDefault(i,t,r)?void 0:i},c.prototype._encodeValue=function(e,t,r){const i=this._baseState;if(null===i.parent)return i.children[0]._encode(e,t||new n);let s=null;if(this.reporter=t,i.optional&&void 0===e){if(null===i.default)return;e=i.default}let a=null,o=!1;if(i.any)s=this._createEncoderBuffer(e);else if(i.choice)s=this._encodeChoice(e,t);else if(i.contains)a=this._getUse(i.contains,r)._encode(e,t),o=!0;else if(i.children)a=i.children.map((function(r){if("null_"===r._baseState.tag)return r._encode(null,t,e);if(null===r._baseState.key)return t.error("Child should have a key");const n=t.enterKey(r._baseState.key);if("object"!=typeof e)return t.error("Child expected, but input is not object");const i=r._encode(e[r._baseState.key],t,e);return t.leaveKey(n),i}),this).filter((function(e){return e})),a=this._createEncoderBuffer(a);else if("seqof"===i.tag||"setof"===i.tag){if(!i.args||1!==i.args.length)return t.error("Too many args for : "+i.tag);if(!Array.isArray(e))return t.error("seqof/setof, but data is not Array");const r=this.clone();r._baseState.implicit=null,a=this._createEncoderBuffer(e.map((function(r){const n=this._baseState;return this._getUse(n.args[0],e)._encode(r,t)}),r))}else null!==i.use?s=this._getUse(i.use,r)._encode(e,t):(a=this._encodePrimitive(i.tag,e),o=!0);if(!i.any&&null===i.choice){const e=null!==i.implicit?i.implicit:i.tag,r=null===i.implicit?"universal":"context";null===e?null===i.use&&t.error("Tag could be omitted only for .use()"):null===i.use&&(s=this._encodeComposite(e,o,r,a))}return null!==i.explicit&&(s=this._encodeComposite(i.explicit,!1,"context",s)),s},c.prototype._encodeChoice=function(e,t){const r=this._baseState,n=r.choice[e.type];return n||a(!1,e.type+" not found in "+JSON.stringify(Object.keys(r.choice))),n._encode(e.value,t)},c.prototype._encodePrimitive=function(e,t){const r=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&r.args)return this._encodeObjid(t,r.reverseArgs[0],r.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,r.args&&r.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);if("objDesc"===e)return this._encodeStr(t,e);throw new Error("Unsupported tag: "+e)},c.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},c.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(e)}},{"../base/buffer":172,"../base/reporter":175,"minimalistic-assert":453}],175:[function(e,t,r){"use strict";const n=e("inherits");function i(e){this._reporterState={obj:null,path:[],options:e||{},errors:[]}}function s(e,t){this.path=e,this.rethrow(t)}r.Reporter=i,i.prototype.isError=function(e){return e instanceof s},i.prototype.save=function(){const e=this._reporterState;return{obj:e.obj,pathLen:e.path.length}},i.prototype.restore=function(e){const t=this._reporterState;t.obj=e.obj,t.path=t.path.slice(0,e.pathLen)},i.prototype.enterKey=function(e){return this._reporterState.path.push(e)},i.prototype.exitKey=function(e){const t=this._reporterState;t.path=t.path.slice(0,e-1)},i.prototype.leaveKey=function(e,t,r){const n=this._reporterState;this.exitKey(e),null!==n.obj&&(n.obj[t]=r)},i.prototype.path=function(){return this._reporterState.path.join("/")},i.prototype.enterObject=function(){const e=this._reporterState,t=e.obj;return e.obj={},t},i.prototype.leaveObject=function(e){const t=this._reporterState,r=t.obj;return t.obj=e,r},i.prototype.error=function(e){let t;const r=this._reporterState,n=e instanceof s;if(t=n?e:new s(r.path.map((function(e){return"["+JSON.stringify(e)+"]"})).join(""),e.message||e,e.stack),!r.options.partial)throw t;return n||r.errors.push(t),t},i.prototype.wrapResult=function(e){const t=this._reporterState;return t.options.partial?{result:this.isError(e)?null:e,errors:t.errors}:e},n(s,Error),s.prototype.rethrow=function(e){if(this.message=e+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,s),!this.stack)try{throw new Error(this.message)}catch(e){this.stack=e.stack}return this}},{inherits:440}],176:[function(e,t,r){"use strict";function n(e){const t={};return Object.keys(e).forEach((function(r){(0|r)==r&&(r|=0);const n=e[r];t[n]=r})),t}r.tagClass={0:"universal",1:"application",2:"context",3:"private"},r.tagClassByName=n(r.tagClass),r.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},r.tagByName=n(r.tag)},{}],177:[function(e,t,r){"use strict";const n=r;n._reverse=function(e){const t={};return Object.keys(e).forEach((function(r){(0|r)==r&&(r|=0);const n=e[r];t[n]=r})),t},n.der=e("./der")},{"./der":176}],178:[function(e,t,r){"use strict";const n=e("inherits"),i=e("bn.js"),s=e("../base/buffer").DecoderBuffer,a=e("../base/node"),o=e("../constants/der");function l(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new c,this.tree._init(e.body)}function c(e){a.call(this,"der",e)}function u(e,t){let r=e.readUInt8(t);if(e.isError(r))return r;const n=o.tagClass[r>>6],i=0==(32&r);if(31==(31&r)){let n=r;for(r=0;128==(128&n);){if(n=e.readUInt8(t),e.isError(n))return n;r<<=7,r|=127&n}}else r&=31;return{cls:n,primitive:i,tag:r,tagStr:o.tag[r]}}function h(e,t,r){let n=e.readUInt8(r);if(e.isError(n))return n;if(!t&&128===n)return null;if(0==(128&n))return n;const i=127&n;if(i>4)return e.error("length octect is too long");n=0;for(let s=0;s<i;s++){n<<=8;const t=e.readUInt8(r);if(e.isError(t))return t;n|=t}return n}t.exports=l,l.prototype.decode=function(e,t){return s.isDecoderBuffer(e)||(e=new s(e,t)),this.tree._decode(e,t)},n(c,a),c.prototype._peekTag=function(e,t,r){if(e.isEmpty())return!1;const n=e.save(),i=u(e,'Failed to peek tag: "'+t+'"');return e.isError(i)?i:(e.restore(n),i.tag===t||i.tagStr===t||i.tagStr+"of"===t||r)},c.prototype._decodeTag=function(e,t,r){const n=u(e,'Failed to decode tag of "'+t+'"');if(e.isError(n))return n;let i=h(e,n.primitive,'Failed to get length of "'+t+'"');if(e.isError(i))return i;if(!r&&n.tag!==t&&n.tagStr!==t&&n.tagStr+"of"!==t)return e.error('Failed to match tag: "'+t+'"');if(n.primitive||null!==i)return e.skip(i,'Failed to match body of: "'+t+'"');const s=e.save(),a=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');return e.isError(a)?a:(i=e.offset-s.offset,e.restore(s),e.skip(i,'Failed to match body of: "'+t+'"'))},c.prototype._skipUntilEnd=function(e,t){for(;;){const r=u(e,t);if(e.isError(r))return r;const n=h(e,r.primitive,t);if(e.isError(n))return n;let i;if(i=r.primitive||null!==n?e.skip(n):this._skipUntilEnd(e,t),e.isError(i))return i;if("end"===r.tagStr)break}},c.prototype._decodeList=function(e,t,r,n){const i=[];for(;!e.isEmpty();){const t=this._peekTag(e,"end");if(e.isError(t))return t;const s=r.decode(e,"der",n);if(e.isError(s)&&t)break;i.push(s)}return i},c.prototype._decodeStr=function(e,t){if("bitstr"===t){const t=e.readUInt8();return e.isError(t)?t:{unused:t,data:e.raw()}}if("bmpstr"===t){const t=e.raw();if(t.length%2==1)return e.error("Decoding of string type: bmpstr length mismatch");let r="";for(let e=0;e<t.length/2;e++)r+=String.fromCharCode(t.readUInt16BE(2*e));return r}if("numstr"===t){const t=e.raw().toString("ascii");return this._isNumstr(t)?t:e.error("Decoding of string type: numstr unsupported characters")}if("octstr"===t)return e.raw();if("objDesc"===t)return e.raw();if("printstr"===t){const t=e.raw().toString("ascii");return this._isPrintstr(t)?t:e.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(t)?e.raw().toString():e.error("Decoding of string type: "+t+" unsupported")},c.prototype._decodeObjid=function(e,t,r){let n;const i=[];let s=0,a=0;for(;!e.isEmpty();)a=e.readUInt8(),s<<=7,s|=127&a,0==(128&a)&&(i.push(s),s=0);128&a&&i.push(s);const o=i[0]/40|0,l=i[0]%40;if(n=r?i:[o,l].concat(i.slice(1)),t){let e=t[n.join(" ")];void 0===e&&(e=t[n.join(".")]),void 0!==e&&(n=e)}return n},c.prototype._decodeTime=function(e,t){const r=e.raw().toString();let n,i,s,a,o,l;if("gentime"===t)n=0|r.slice(0,4),i=0|r.slice(4,6),s=0|r.slice(6,8),a=0|r.slice(8,10),o=0|r.slice(10,12),l=0|r.slice(12,14);else{if("utctime"!==t)return e.error("Decoding "+t+" time is not supported yet");n=0|r.slice(0,2),i=0|r.slice(2,4),s=0|r.slice(4,6),a=0|r.slice(6,8),o=0|r.slice(8,10),l=0|r.slice(10,12),n=n<70?2e3+n:1900+n}return Date.UTC(n,i-1,s,a,o,l,0)},c.prototype._decodeNull=function(){return null},c.prototype._decodeBool=function(e){const t=e.readUInt8();return e.isError(t)?t:0!==t},c.prototype._decodeInt=function(e,t){const r=e.raw();let n=new i(r);return t&&(n=t[n.toString(10)]||n),n},c.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getDecoder("der").tree}},{"../base/buffer":172,"../base/node":174,"../constants/der":176,"bn.js":184,inherits:440}],179:[function(e,t,r){"use strict";const n=r;n.der=e("./der"),n.pem=e("./pem")},{"./der":178,"./pem":180}],180:[function(e,t,r){"use strict";const n=e("inherits"),i=e("safer-buffer").Buffer,s=e("./der");function a(e){s.call(this,e),this.enc="pem"}n(a,s),t.exports=a,a.prototype.decode=function(e,t){const r=e.toString().split(/[\r\n]+/g),n=t.label.toUpperCase(),a=/^-----(BEGIN|END) ([^-]+)-----$/;let o=-1,l=-1;for(let i=0;i<r.length;i++){const e=r[i].match(a);if(null!==e&&e[2]===n){if(-1!==o){if("END"!==e[1])break;l=i;break}if("BEGIN"!==e[1])break;o=i}}if(-1===o||-1===l)throw new Error("PEM section not found for: "+n);const c=r.slice(o+1,l).join("");c.replace(/[^a-z0-9+/=]+/gi,"");const u=i.from(c,"base64");return s.prototype.decode.call(this,u,t)}},{"./der":178,inherits:440,"safer-buffer":495}],181:[function(e,t,r){"use strict";const n=e("inherits"),i=e("safer-buffer").Buffer,s=e("../base/node"),a=e("../constants/der");function o(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new l,this.tree._init(e.body)}function l(e){s.call(this,"der",e)}function c(e){return e<10?"0"+e:e}t.exports=o,o.prototype.encode=function(e,t){return this.tree._encode(e,t).join()},n(l,s),l.prototype._encodeComposite=function(e,t,r,n){const s=function(e,t,r,n){let i;if("seqof"===e?e="seq":"setof"===e&&(e="set"),a.tagByName.hasOwnProperty(e))i=a.tagByName[e];else{if("number"!=typeof e||(0|e)!==e)return n.error("Unknown tag: "+e);i=e}return i>=31?n.error("Multi-octet tag encoding unsupported"):(t||(i|=32),i|=a.tagClassByName[r||"universal"]<<6,i)}(e,t,r,this.reporter);if(n.length<128){const e=i.alloc(2);return e[0]=s,e[1]=n.length,this._createEncoderBuffer([e,n])}let o=1;for(let i=n.length;i>=256;i>>=8)o++;const l=i.alloc(2+o);l[0]=s,l[1]=128|o;for(let i=1+o,a=n.length;a>0;i--,a>>=8)l[i]=255&a;return this._createEncoderBuffer([l,n])},l.prototype._encodeStr=function(e,t){if("bitstr"===t)return this._createEncoderBuffer([0|e.unused,e.data]);if("bmpstr"===t){const t=i.alloc(2*e.length);for(let r=0;r<e.length;r++)t.writeUInt16BE(e.charCodeAt(r),2*r);return this._createEncoderBuffer(t)}return"numstr"===t?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===t?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(t)||"objDesc"===t?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+t+" unsupported")},l.prototype._encodeObjid=function(e,t,r){if("string"==typeof e){if(!t)return this.reporter.error("string objid given, but no values map found");if(!t.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=t[e].split(/[\s.]+/g);for(let t=0;t<e.length;t++)e[t]|=0}else if(Array.isArray(e)){e=e.slice();for(let t=0;t<e.length;t++)e[t]|=0}if(!Array.isArray(e))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(e));if(!r){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,40*e[0]+e[1])}let n=0;for(let i=0;i<e.length;i++){let t=e[i];for(n++;t>=128;t>>=7)n++}const s=i.alloc(n);let a=s.length-1;for(let i=e.length-1;i>=0;i--){let t=e[i];for(s[a--]=127&t;(t>>=7)>0;)s[a--]=128|127&t}return this._createEncoderBuffer(s)},l.prototype._encodeTime=function(e,t){let r;const n=new Date(e);return"gentime"===t?r=[c(n.getUTCFullYear()),c(n.getUTCMonth()+1),c(n.getUTCDate()),c(n.getUTCHours()),c(n.getUTCMinutes()),c(n.getUTCSeconds()),"Z"].join(""):"utctime"===t?r=[c(n.getUTCFullYear()%100),c(n.getUTCMonth()+1),c(n.getUTCDate()),c(n.getUTCHours()),c(n.getUTCMinutes()),c(n.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+t+" time is not supported yet"),this._encodeStr(r,"octstr")},l.prototype._encodeNull=function(){return this._createEncoderBuffer("")},l.prototype._encodeInt=function(e,t){if("string"==typeof e){if(!t)return this.reporter.error("String int or enum given, but no values map");if(!t.hasOwnProperty(e))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e));e=t[e]}if("number"!=typeof e&&!i.isBuffer(e)){const t=e.toArray();!e.sign&&128&t[0]&&t.unshift(0),e=i.from(t)}if(i.isBuffer(e)){let t=e.length;0===e.length&&t++;const r=i.alloc(t);return e.copy(r),0===e.length&&(r[0]=0),this._createEncoderBuffer(r)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);let r=1;for(let i=e;i>=256;i>>=8)r++;const n=new Array(r);for(let i=n.length-1;i>=0;i--)n[i]=255&e,e>>=8;return 128&n[0]&&n.unshift(0),this._createEncoderBuffer(i.from(n))},l.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},l.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getEncoder("der").tree},l.prototype._skipDefault=function(e,t,r){const n=this._baseState;let i;if(null===n.default)return!1;const s=e.join();if(void 0===n.defaultBuffer&&(n.defaultBuffer=this._encodeValue(n.default,t,r).join()),s.length!==n.defaultBuffer.length)return!1;for(i=0;i<s.length;i++)if(s[i]!==n.defaultBuffer[i])return!1;return!0}},{"../base/node":174,"../constants/der":176,inherits:440,"safer-buffer":495}],182:[function(e,t,r){"use strict";const n=r;n.der=e("./der"),n.pem=e("./pem")},{"./der":181,"./pem":183}],183:[function(e,t,r){"use strict";const n=e("inherits"),i=e("./der");function s(e){i.call(this,e),this.enc="pem"}n(s,i),t.exports=s,s.prototype.encode=function(e,t){const r=i.prototype.encode.call(this,e).toString("base64"),n=["-----BEGIN "+t.label+"-----"];for(let i=0;i<r.length;i+=64)n.push(r.slice(i,i+64));return n.push("-----END "+t.label+"-----"),n.join("\n")}},{"./der":181,inherits:440}],184:[function(e,t,r){"use strict";!function(t){function r(e,t){if(!e)throw new Error(t||"Assertion failed")}function n(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function i(e,t,r){if(i.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}var s;"object"==typeof t?t.exports=i:(void 0).BN=i,i.BN=i,i.wordSize=26;try{s="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:e("buffer").Buffer}catch(e){}function a(e,t){var r=e.charCodeAt(t);return r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:r-48&15}function o(e,t,r){var n=a(e,r);return r-1>=t&&(n|=a(e,r-1)<<4),n}function l(e,t,r,n){for(var i=0,s=Math.min(e.length,r),a=t;a<s;a++){var o=e.charCodeAt(a)-48;i*=n,i+=o>=49?o-49+10:o>=17?o-17+10:o}return i}i.isBN=function(e){return e instanceof i||null!==e&&"object"==typeof e&&e.constructor.wordSize===i.wordSize&&Array.isArray(e.words)},i.max=function(e,t){return e.cmp(t)>0?e:t},i.min=function(e,t){return e.cmp(t)<0?e:t},i.prototype._init=function(e,t,n){if("number"==typeof e)return this._initNumber(e,t,n);if("object"==typeof e)return this._initArray(e,t,n);"hex"===t&&(t=16),r(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,n):(this._parseBase(e,t,i),"le"===n&&this._initArray(this.toArray(),t,n)))},i.prototype._initNumber=function(e,t,n){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(r(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===n&&this._initArray(this.toArray(),t,n)},i.prototype._initArray=function(e,t,n){if(r("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var s,a,o=0;if("be"===n)for(i=e.length-1,s=0;i>=0;i-=3)a=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[s]|=a<<o&67108863,this.words[s+1]=a>>>26-o&67108863,(o+=24)>=26&&(o-=26,s++);else if("le"===n)for(i=0,s=0;i<e.length;i+=3)a=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[s]|=a<<o&67108863,this.words[s+1]=a>>>26-o&67108863,(o+=24)>=26&&(o-=26,s++);return this.strip()},i.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,s=0,a=0;if("be"===r)for(n=e.length-1;n>=t;n-=2)i=o(e,t,n)<<s,this.words[a]|=67108863&i,s>=18?(s-=18,a+=1,this.words[a]|=i>>>26):s+=8;else for(n=(e.length-t)%2==0?t+1:t;n<e.length;n+=2)i=o(e,t,n)<<s,this.words[a]|=67108863&i,s>=18?(s-=18,a+=1,this.words[a]|=i>>>26):s+=8;this.strip()},i.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=t)n++;n--,i=i/t|0;for(var s=e.length-r,a=s%n,o=Math.min(s,s-a)+r,c=0,u=r;u<o;u+=n)c=l(e,u,u+n,t),this.imuln(i),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==a){var h=1;for(c=l(e,u,e.length,t),u=0;u<a;u++)h*=t;this.imuln(h),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this.strip()},i.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},i.prototype.clone=function(){var e=new i(null);return this.copy(e),e},i.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},i.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var c=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],u=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function d(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n,n=n-1|0;var i=0|e.words[0],s=0|t.words[0],a=i*s,o=67108863&a,l=a/67108864|0;r.words[0]=o;for(var c=1;c<n;c++){for(var u=l>>>26,h=67108863&l,d=Math.min(c,t.length-1),f=Math.max(0,c-e.length+1);f<=d;f++){var p=c-f|0;u+=(a=(i=0|e.words[p])*(s=0|t.words[f])+h)/67108864|0,h=67108863&a}r.words[c]=0|h,l=0|u}return 0!==l?r.words[c]=0|l:r.length--,r.strip()}i.prototype.toString=function(e,t){var n;if(t=0|t||1,16===(e=e||10)||"hex"===e){n="";for(var i=0,s=0,a=0;a<this.length;a++){var o=this.words[a],l=(16777215&(o<<i|s)).toString(16);n=0!==(s=o>>>24-i&16777215)||a!==this.length-1?c[6-l.length]+l+n:l+n,(i+=2)>=26&&(i-=26,a--)}for(0!==s&&(n=s.toString(16)+n);n.length%t!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}if(e===(0|e)&&e>=2&&e<=36){var d=u[e],f=h[e];n="";var p=this.clone();for(p.negative=0;!p.isZero();){var m=p.modn(f).toString(e);n=(p=p.idivn(f)).isZero()?m+n:c[d-m.length]+m+n}for(this.isZero()&&(n="0"+n);n.length%t!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(e,t){return r(void 0!==s),this.toArrayLike(s,e,t)},i.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},i.prototype.toArrayLike=function(e,t,n){var i=this.byteLength(),s=n||Math.max(1,i);r(i<=s,"byte array longer than desired length"),r(s>0,"Requested array length <= 0"),this.strip();var a,o,l="le"===t,c=new e(s),u=this.clone();if(l){for(o=0;!u.isZero();o++)a=u.andln(255),u.iushrn(8),c[o]=a;for(;o<s;o++)c[o]=0}else{for(o=0;o<s-i;o++)c[o]=0;for(o=0;!u.isZero();o++)a=u.andln(255),u.iushrn(8),c[s-o-1]=a}return c},Math.clz32?i.prototype._countBits=function(e){return 32-Math.clz32(e)}:i.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},i.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 0==(8191&t)&&(r+=13,t>>>=13),0==(127&t)&&(r+=7,t>>>=7),0==(15&t)&&(r+=4,t>>>=4),0==(3&t)&&(r+=2,t>>>=2),0==(1&t)&&r++,r},i.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},i.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return 0!==this.negative},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},i.prototype.ior=function(e){return r(0==(this.negative|e.negative)),this.iuor(e)},i.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},i.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},i.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this.strip()},i.prototype.iand=function(e){return r(0==(this.negative|e.negative)),this.iuand(e)},i.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},i.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},i.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var n=0;n<r.length;n++)this.words[n]=t.words[n]^r.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this.strip()},i.prototype.ixor=function(e){return r(0==(this.negative|e.negative)),this.iuxor(e)},i.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},i.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},i.prototype.inotn=function(e){r("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),n=e%26;this._expand(t),n>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return n>0&&(this.words[i]=~this.words[i]&67108863>>26-n),this.strip()},i.prototype.notn=function(e){return this.clone().inotn(e)},i.prototype.setn=function(e,t){r("number"==typeof e&&e>=0);var n=e/26|0,i=e%26;return this._expand(n+1),this.words[n]=t?this.words[n]|1<<i:this.words[n]&~(1<<i),this.strip()},i.prototype.iadd=function(e){var t,r,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,n=e):(r=e,n=this);for(var i=0,s=0;s<n.length;s++)t=(0|r.words[s])+(0|n.words[s])+i,this.words[s]=67108863&t,i=t>>>26;for(;0!==i&&s<r.length;s++)t=(0|r.words[s])+i,this.words[s]=67108863&t,i=t>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this},i.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},i.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,n,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=e):(r=e,n=this);for(var s=0,a=0;a<n.length;a++)s=(t=(0|r.words[a])-(0|n.words[a])+s)>>26,this.words[a]=67108863&t;for(;0!==s&&a<r.length;a++)s=(t=(0|r.words[a])+s)>>26,this.words[a]=67108863&t;if(0===s&&a<r.length&&r!==this)for(;a<r.length;a++)this.words[a]=r.words[a];return this.length=Math.max(this.length,a),r!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(e){return this.clone().isub(e)};var f=function(e,t,r){var n,i,s,a=e.words,o=t.words,l=r.words,c=0,u=0|a[0],h=8191&u,d=u>>>13,f=0|a[1],p=8191&f,m=f>>>13,g=0|a[2],v=8191&g,y=g>>>13,b=0|a[3],w=8191&b,x=b>>>13,S=0|a[4],_=8191&S,C=S>>>13,E=0|a[5],A=8191&E,M=E>>>13,T=0|a[6],P=8191&T,k=T>>>13,D=0|a[7],I=8191&D,O=D>>>13,R=0|a[8],L=8191&R,N=R>>>13,B=0|a[9],z=8191&B,F=B>>>13,j=0|o[0],U=8191&j,V=j>>>13,H=0|o[1],W=8191&H,G=H>>>13,q=0|o[2],X=8191&q,Y=q>>>13,K=0|o[3],Q=8191&K,Z=K>>>13,J=0|o[4],$=8191&J,ee=J>>>13,te=0|o[5],re=8191&te,ne=te>>>13,ie=0|o[6],se=8191&ie,ae=ie>>>13,oe=0|o[7],le=8191&oe,ce=oe>>>13,ue=0|o[8],he=8191&ue,de=ue>>>13,fe=0|o[9],pe=8191&fe,me=fe>>>13;r.negative=e.negative^t.negative,r.length=19;var ge=(c+(n=Math.imul(h,U))|0)+((8191&(i=(i=Math.imul(h,V))+Math.imul(d,U)|0))<<13)|0;c=((s=Math.imul(d,V))+(i>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(p,U),i=(i=Math.imul(p,V))+Math.imul(m,U)|0,s=Math.imul(m,V);var ve=(c+(n=n+Math.imul(h,W)|0)|0)+((8191&(i=(i=i+Math.imul(h,G)|0)+Math.imul(d,W)|0))<<13)|0;c=((s=s+Math.imul(d,G)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(v,U),i=(i=Math.imul(v,V))+Math.imul(y,U)|0,s=Math.imul(y,V),n=n+Math.imul(p,W)|0,i=(i=i+Math.imul(p,G)|0)+Math.imul(m,W)|0,s=s+Math.imul(m,G)|0;var ye=(c+(n=n+Math.imul(h,X)|0)|0)+((8191&(i=(i=i+Math.imul(h,Y)|0)+Math.imul(d,X)|0))<<13)|0;c=((s=s+Math.imul(d,Y)|0)+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(w,U),i=(i=Math.imul(w,V))+Math.imul(x,U)|0,s=Math.imul(x,V),n=n+Math.imul(v,W)|0,i=(i=i+Math.imul(v,G)|0)+Math.imul(y,W)|0,s=s+Math.imul(y,G)|0,n=n+Math.imul(p,X)|0,i=(i=i+Math.imul(p,Y)|0)+Math.imul(m,X)|0,s=s+Math.imul(m,Y)|0;var be=(c+(n=n+Math.imul(h,Q)|0)|0)+((8191&(i=(i=i+Math.imul(h,Z)|0)+Math.imul(d,Q)|0))<<13)|0;c=((s=s+Math.imul(d,Z)|0)+(i>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(_,U),i=(i=Math.imul(_,V))+Math.imul(C,U)|0,s=Math.imul(C,V),n=n+Math.imul(w,W)|0,i=(i=i+Math.imul(w,G)|0)+Math.imul(x,W)|0,s=s+Math.imul(x,G)|0,n=n+Math.imul(v,X)|0,i=(i=i+Math.imul(v,Y)|0)+Math.imul(y,X)|0,s=s+Math.imul(y,Y)|0,n=n+Math.imul(p,Q)|0,i=(i=i+Math.imul(p,Z)|0)+Math.imul(m,Q)|0,s=s+Math.imul(m,Z)|0;var we=(c+(n=n+Math.imul(h,$)|0)|0)+((8191&(i=(i=i+Math.imul(h,ee)|0)+Math.imul(d,$)|0))<<13)|0;c=((s=s+Math.imul(d,ee)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(A,U),i=(i=Math.imul(A,V))+Math.imul(M,U)|0,s=Math.imul(M,V),n=n+Math.imul(_,W)|0,i=(i=i+Math.imul(_,G)|0)+Math.imul(C,W)|0,s=s+Math.imul(C,G)|0,n=n+Math.imul(w,X)|0,i=(i=i+Math.imul(w,Y)|0)+Math.imul(x,X)|0,s=s+Math.imul(x,Y)|0,n=n+Math.imul(v,Q)|0,i=(i=i+Math.imul(v,Z)|0)+Math.imul(y,Q)|0,s=s+Math.imul(y,Z)|0,n=n+Math.imul(p,$)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(m,$)|0,s=s+Math.imul(m,ee)|0;var xe=(c+(n=n+Math.imul(h,re)|0)|0)+((8191&(i=(i=i+Math.imul(h,ne)|0)+Math.imul(d,re)|0))<<13)|0;c=((s=s+Math.imul(d,ne)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,n=Math.imul(P,U),i=(i=Math.imul(P,V))+Math.imul(k,U)|0,s=Math.imul(k,V),n=n+Math.imul(A,W)|0,i=(i=i+Math.imul(A,G)|0)+Math.imul(M,W)|0,s=s+Math.imul(M,G)|0,n=n+Math.imul(_,X)|0,i=(i=i+Math.imul(_,Y)|0)+Math.imul(C,X)|0,s=s+Math.imul(C,Y)|0,n=n+Math.imul(w,Q)|0,i=(i=i+Math.imul(w,Z)|0)+Math.imul(x,Q)|0,s=s+Math.imul(x,Z)|0,n=n+Math.imul(v,$)|0,i=(i=i+Math.imul(v,ee)|0)+Math.imul(y,$)|0,s=s+Math.imul(y,ee)|0,n=n+Math.imul(p,re)|0,i=(i=i+Math.imul(p,ne)|0)+Math.imul(m,re)|0,s=s+Math.imul(m,ne)|0;var Se=(c+(n=n+Math.imul(h,se)|0)|0)+((8191&(i=(i=i+Math.imul(h,ae)|0)+Math.imul(d,se)|0))<<13)|0;c=((s=s+Math.imul(d,ae)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(I,U),i=(i=Math.imul(I,V))+Math.imul(O,U)|0,s=Math.imul(O,V),n=n+Math.imul(P,W)|0,i=(i=i+Math.imul(P,G)|0)+Math.imul(k,W)|0,s=s+Math.imul(k,G)|0,n=n+Math.imul(A,X)|0,i=(i=i+Math.imul(A,Y)|0)+Math.imul(M,X)|0,s=s+Math.imul(M,Y)|0,n=n+Math.imul(_,Q)|0,i=(i=i+Math.imul(_,Z)|0)+Math.imul(C,Q)|0,s=s+Math.imul(C,Z)|0,n=n+Math.imul(w,$)|0,i=(i=i+Math.imul(w,ee)|0)+Math.imul(x,$)|0,s=s+Math.imul(x,ee)|0,n=n+Math.imul(v,re)|0,i=(i=i+Math.imul(v,ne)|0)+Math.imul(y,re)|0,s=s+Math.imul(y,ne)|0,n=n+Math.imul(p,se)|0,i=(i=i+Math.imul(p,ae)|0)+Math.imul(m,se)|0,s=s+Math.imul(m,ae)|0;var _e=(c+(n=n+Math.imul(h,le)|0)|0)+((8191&(i=(i=i+Math.imul(h,ce)|0)+Math.imul(d,le)|0))<<13)|0;c=((s=s+Math.imul(d,ce)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(L,U),i=(i=Math.imul(L,V))+Math.imul(N,U)|0,s=Math.imul(N,V),n=n+Math.imul(I,W)|0,i=(i=i+Math.imul(I,G)|0)+Math.imul(O,W)|0,s=s+Math.imul(O,G)|0,n=n+Math.imul(P,X)|0,i=(i=i+Math.imul(P,Y)|0)+Math.imul(k,X)|0,s=s+Math.imul(k,Y)|0,n=n+Math.imul(A,Q)|0,i=(i=i+Math.imul(A,Z)|0)+Math.imul(M,Q)|0,s=s+Math.imul(M,Z)|0,n=n+Math.imul(_,$)|0,i=(i=i+Math.imul(_,ee)|0)+Math.imul(C,$)|0,s=s+Math.imul(C,ee)|0,n=n+Math.imul(w,re)|0,i=(i=i+Math.imul(w,ne)|0)+Math.imul(x,re)|0,s=s+Math.imul(x,ne)|0,n=n+Math.imul(v,se)|0,i=(i=i+Math.imul(v,ae)|0)+Math.imul(y,se)|0,s=s+Math.imul(y,ae)|0,n=n+Math.imul(p,le)|0,i=(i=i+Math.imul(p,ce)|0)+Math.imul(m,le)|0,s=s+Math.imul(m,ce)|0;var Ce=(c+(n=n+Math.imul(h,he)|0)|0)+((8191&(i=(i=i+Math.imul(h,de)|0)+Math.imul(d,he)|0))<<13)|0;c=((s=s+Math.imul(d,de)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,n=Math.imul(z,U),i=(i=Math.imul(z,V))+Math.imul(F,U)|0,s=Math.imul(F,V),n=n+Math.imul(L,W)|0,i=(i=i+Math.imul(L,G)|0)+Math.imul(N,W)|0,s=s+Math.imul(N,G)|0,n=n+Math.imul(I,X)|0,i=(i=i+Math.imul(I,Y)|0)+Math.imul(O,X)|0,s=s+Math.imul(O,Y)|0,n=n+Math.imul(P,Q)|0,i=(i=i+Math.imul(P,Z)|0)+Math.imul(k,Q)|0,s=s+Math.imul(k,Z)|0,n=n+Math.imul(A,$)|0,i=(i=i+Math.imul(A,ee)|0)+Math.imul(M,$)|0,s=s+Math.imul(M,ee)|0,n=n+Math.imul(_,re)|0,i=(i=i+Math.imul(_,ne)|0)+Math.imul(C,re)|0,s=s+Math.imul(C,ne)|0,n=n+Math.imul(w,se)|0,i=(i=i+Math.imul(w,ae)|0)+Math.imul(x,se)|0,s=s+Math.imul(x,ae)|0,n=n+Math.imul(v,le)|0,i=(i=i+Math.imul(v,ce)|0)+Math.imul(y,le)|0,s=s+Math.imul(y,ce)|0,n=n+Math.imul(p,he)|0,i=(i=i+Math.imul(p,de)|0)+Math.imul(m,he)|0,s=s+Math.imul(m,de)|0;var Ee=(c+(n=n+Math.imul(h,pe)|0)|0)+((8191&(i=(i=i+Math.imul(h,me)|0)+Math.imul(d,pe)|0))<<13)|0;c=((s=s+Math.imul(d,me)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(z,W),i=(i=Math.imul(z,G))+Math.imul(F,W)|0,s=Math.imul(F,G),n=n+Math.imul(L,X)|0,i=(i=i+Math.imul(L,Y)|0)+Math.imul(N,X)|0,s=s+Math.imul(N,Y)|0,n=n+Math.imul(I,Q)|0,i=(i=i+Math.imul(I,Z)|0)+Math.imul(O,Q)|0,s=s+Math.imul(O,Z)|0,n=n+Math.imul(P,$)|0,i=(i=i+Math.imul(P,ee)|0)+Math.imul(k,$)|0,s=s+Math.imul(k,ee)|0,n=n+Math.imul(A,re)|0,i=(i=i+Math.imul(A,ne)|0)+Math.imul(M,re)|0,s=s+Math.imul(M,ne)|0,n=n+Math.imul(_,se)|0,i=(i=i+Math.imul(_,ae)|0)+Math.imul(C,se)|0,s=s+Math.imul(C,ae)|0,n=n+Math.imul(w,le)|0,i=(i=i+Math.imul(w,ce)|0)+Math.imul(x,le)|0,s=s+Math.imul(x,ce)|0,n=n+Math.imul(v,he)|0,i=(i=i+Math.imul(v,de)|0)+Math.imul(y,he)|0,s=s+Math.imul(y,de)|0;var Ae=(c+(n=n+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;c=((s=s+Math.imul(m,me)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(z,X),i=(i=Math.imul(z,Y))+Math.imul(F,X)|0,s=Math.imul(F,Y),n=n+Math.imul(L,Q)|0,i=(i=i+Math.imul(L,Z)|0)+Math.imul(N,Q)|0,s=s+Math.imul(N,Z)|0,n=n+Math.imul(I,$)|0,i=(i=i+Math.imul(I,ee)|0)+Math.imul(O,$)|0,s=s+Math.imul(O,ee)|0,n=n+Math.imul(P,re)|0,i=(i=i+Math.imul(P,ne)|0)+Math.imul(k,re)|0,s=s+Math.imul(k,ne)|0,n=n+Math.imul(A,se)|0,i=(i=i+Math.imul(A,ae)|0)+Math.imul(M,se)|0,s=s+Math.imul(M,ae)|0,n=n+Math.imul(_,le)|0,i=(i=i+Math.imul(_,ce)|0)+Math.imul(C,le)|0,s=s+Math.imul(C,ce)|0,n=n+Math.imul(w,he)|0,i=(i=i+Math.imul(w,de)|0)+Math.imul(x,he)|0,s=s+Math.imul(x,de)|0;var Me=(c+(n=n+Math.imul(v,pe)|0)|0)+((8191&(i=(i=i+Math.imul(v,me)|0)+Math.imul(y,pe)|0))<<13)|0;c=((s=s+Math.imul(y,me)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(z,Q),i=(i=Math.imul(z,Z))+Math.imul(F,Q)|0,s=Math.imul(F,Z),n=n+Math.imul(L,$)|0,i=(i=i+Math.imul(L,ee)|0)+Math.imul(N,$)|0,s=s+Math.imul(N,ee)|0,n=n+Math.imul(I,re)|0,i=(i=i+Math.imul(I,ne)|0)+Math.imul(O,re)|0,s=s+Math.imul(O,ne)|0,n=n+Math.imul(P,se)|0,i=(i=i+Math.imul(P,ae)|0)+Math.imul(k,se)|0,s=s+Math.imul(k,ae)|0,n=n+Math.imul(A,le)|0,i=(i=i+Math.imul(A,ce)|0)+Math.imul(M,le)|0,s=s+Math.imul(M,ce)|0,n=n+Math.imul(_,he)|0,i=(i=i+Math.imul(_,de)|0)+Math.imul(C,he)|0,s=s+Math.imul(C,de)|0;var Te=(c+(n=n+Math.imul(w,pe)|0)|0)+((8191&(i=(i=i+Math.imul(w,me)|0)+Math.imul(x,pe)|0))<<13)|0;c=((s=s+Math.imul(x,me)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(z,$),i=(i=Math.imul(z,ee))+Math.imul(F,$)|0,s=Math.imul(F,ee),n=n+Math.imul(L,re)|0,i=(i=i+Math.imul(L,ne)|0)+Math.imul(N,re)|0,s=s+Math.imul(N,ne)|0,n=n+Math.imul(I,se)|0,i=(i=i+Math.imul(I,ae)|0)+Math.imul(O,se)|0,s=s+Math.imul(O,ae)|0,n=n+Math.imul(P,le)|0,i=(i=i+Math.imul(P,ce)|0)+Math.imul(k,le)|0,s=s+Math.imul(k,ce)|0,n=n+Math.imul(A,he)|0,i=(i=i+Math.imul(A,de)|0)+Math.imul(M,he)|0,s=s+Math.imul(M,de)|0;var Pe=(c+(n=n+Math.imul(_,pe)|0)|0)+((8191&(i=(i=i+Math.imul(_,me)|0)+Math.imul(C,pe)|0))<<13)|0;c=((s=s+Math.imul(C,me)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,n=Math.imul(z,re),i=(i=Math.imul(z,ne))+Math.imul(F,re)|0,s=Math.imul(F,ne),n=n+Math.imul(L,se)|0,i=(i=i+Math.imul(L,ae)|0)+Math.imul(N,se)|0,s=s+Math.imul(N,ae)|0,n=n+Math.imul(I,le)|0,i=(i=i+Math.imul(I,ce)|0)+Math.imul(O,le)|0,s=s+Math.imul(O,ce)|0,n=n+Math.imul(P,he)|0,i=(i=i+Math.imul(P,de)|0)+Math.imul(k,he)|0,s=s+Math.imul(k,de)|0;var ke=(c+(n=n+Math.imul(A,pe)|0)|0)+((8191&(i=(i=i+Math.imul(A,me)|0)+Math.imul(M,pe)|0))<<13)|0;c=((s=s+Math.imul(M,me)|0)+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(z,se),i=(i=Math.imul(z,ae))+Math.imul(F,se)|0,s=Math.imul(F,ae),n=n+Math.imul(L,le)|0,i=(i=i+Math.imul(L,ce)|0)+Math.imul(N,le)|0,s=s+Math.imul(N,ce)|0,n=n+Math.imul(I,he)|0,i=(i=i+Math.imul(I,de)|0)+Math.imul(O,he)|0,s=s+Math.imul(O,de)|0;var De=(c+(n=n+Math.imul(P,pe)|0)|0)+((8191&(i=(i=i+Math.imul(P,me)|0)+Math.imul(k,pe)|0))<<13)|0;c=((s=s+Math.imul(k,me)|0)+(i>>>13)|0)+(De>>>26)|0,De&=67108863,n=Math.imul(z,le),i=(i=Math.imul(z,ce))+Math.imul(F,le)|0,s=Math.imul(F,ce),n=n+Math.imul(L,he)|0,i=(i=i+Math.imul(L,de)|0)+Math.imul(N,he)|0,s=s+Math.imul(N,de)|0;var Ie=(c+(n=n+Math.imul(I,pe)|0)|0)+((8191&(i=(i=i+Math.imul(I,me)|0)+Math.imul(O,pe)|0))<<13)|0;c=((s=s+Math.imul(O,me)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(z,he),i=(i=Math.imul(z,de))+Math.imul(F,he)|0,s=Math.imul(F,de);var Oe=(c+(n=n+Math.imul(L,pe)|0)|0)+((8191&(i=(i=i+Math.imul(L,me)|0)+Math.imul(N,pe)|0))<<13)|0;c=((s=s+Math.imul(N,me)|0)+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863;var Re=(c+(n=Math.imul(z,pe))|0)+((8191&(i=(i=Math.imul(z,me))+Math.imul(F,pe)|0))<<13)|0;return c=((s=Math.imul(F,me))+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863,l[0]=ge,l[1]=ve,l[2]=ye,l[3]=be,l[4]=we,l[5]=xe,l[6]=Se,l[7]=_e,l[8]=Ce,l[9]=Ee,l[10]=Ae,l[11]=Me,l[12]=Te,l[13]=Pe,l[14]=ke,l[15]=De,l[16]=Ie,l[17]=Oe,l[18]=Re,0!==c&&(l[19]=c,r.length++),r};function p(e,t,r){return(new m).mulp(e,t,r)}function m(e,t){this.x=e,this.y=t}Math.imul||(f=d),i.prototype.mulTo=function(e,t){var r=this.length+e.length;return 10===this.length&&10===e.length?f(this,e,t):r<63?d(this,e,t):r<1024?function(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var n=0,i=0,s=0;s<r.length-1;s++){var a=i;i=0;for(var o=67108863&n,l=Math.min(s,t.length-1),c=Math.max(0,s-e.length+1);c<=l;c++){var u=s-c,h=(0|e.words[u])*(0|t.words[c]),d=67108863&h;o=67108863&(d=d+o|0),i+=(a=(a=a+(h/67108864|0)|0)+(d>>>26)|0)>>>26,a&=67108863}r.words[s]=o,n=a,a=i}return 0!==n?r.words[s]=n:r.length--,r.strip()}(this,e,t):p(this,e,t)},m.prototype.makeRBT=function(e){for(var t=new Array(e),r=i.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,r,e);return t},m.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var n=0,i=0;i<t;i++)n|=(1&e)<<t-i-1,e>>=1;return n},m.prototype.permute=function(e,t,r,n,i,s){for(var a=0;a<s;a++)n[a]=t[e[a]],i[a]=r[e[a]]},m.prototype.transform=function(e,t,r,n,i,s){this.permute(s,e,t,r,n,i);for(var a=1;a<i;a<<=1)for(var o=a<<1,l=Math.cos(2*Math.PI/o),c=Math.sin(2*Math.PI/o),u=0;u<i;u+=o)for(var h=l,d=c,f=0;f<a;f++){var p=r[u+f],m=n[u+f],g=r[u+f+a],v=n[u+f+a],y=h*g-d*v;v=h*v+d*g,g=y,r[u+f]=p+g,n[u+f]=m+v,r[u+f+a]=p-g,n[u+f+a]=m-v,f!==o&&(y=l*h-c*d,d=l*d+c*h,h=y)}},m.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},m.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=e[n];e[n]=e[r-n-1],e[r-n-1]=i,i=t[n],t[n]=-t[r-n-1],t[r-n-1]=-i}},m.prototype.normalize13b=function(e,t){for(var r=0,n=0;n<t/2;n++){var i=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+r;e[n]=67108863&i,r=i<67108864?0:i/67108864|0}return e},m.prototype.convert13b=function(e,t,n,i){for(var s=0,a=0;a<t;a++)s+=0|e[a],n[2*a]=8191&s,s>>>=13,n[2*a+1]=8191&s,s>>>=13;for(a=2*t;a<i;++a)n[a]=0;r(0===s),r(0==(-8192&s))},m.prototype.stub=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=0;return t},m.prototype.mulp=function(e,t,r){var n=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(n),s=this.stub(n),a=new Array(n),o=new Array(n),l=new Array(n),c=new Array(n),u=new Array(n),h=new Array(n),d=r.words;d.length=n,this.convert13b(e.words,e.length,a,n),this.convert13b(t.words,t.length,c,n),this.transform(a,s,o,l,n,i),this.transform(c,s,u,h,n,i);for(var f=0;f<n;f++){var p=o[f]*u[f]-l[f]*h[f];l[f]=o[f]*h[f]+l[f]*u[f],o[f]=p}return this.conjugate(o,l,n),this.transform(o,l,d,s,n,i),this.conjugate(d,s,n),this.normalize13b(d,n),r.negative=e.negative^t.negative,r.length=e.length+t.length,r.strip()},i.prototype.mul=function(e){var t=new i(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},i.prototype.mulf=function(e){var t=new i(null);return t.words=new Array(this.length+e.length),p(this,e,t)},i.prototype.imul=function(e){return this.clone().mulTo(e,this)},i.prototype.imuln=function(e){r("number"==typeof e),r(e<67108864);for(var t=0,n=0;n<this.length;n++){var i=(0|this.words[n])*e,s=(67108863&i)+(67108863&t);t>>=26,t+=i/67108864|0,t+=s>>>26,this.words[n]=67108863&s}return 0!==t&&(this.words[n]=t,this.length++),this},i.prototype.muln=function(e){return this.clone().imuln(e)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),r=0;r<t.length;r++){var n=r/26|0,i=r%26;t[r]=(e.words[n]&1<<i)>>>i}return t}(e);if(0===t.length)return new i(1);for(var r=this,n=0;n<t.length&&0===t[n];n++,r=r.sqr());if(++n<t.length)for(var s=r.sqr();n<t.length;n++,s=s.sqr())0!==t[n]&&(r=r.mul(s));return r},i.prototype.iushln=function(e){r("number"==typeof e&&e>=0);var t,n=e%26,i=(e-n)/26,s=67108863>>>26-n<<26-n;if(0!==n){var a=0;for(t=0;t<this.length;t++){var o=this.words[t]&s,l=(0|this.words[t])-o<<n;this.words[t]=l|a,a=o>>>26-n}a&&(this.words[t]=a,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this.strip()},i.prototype.ishln=function(e){return r(0===this.negative),this.iushln(e)},i.prototype.iushrn=function(e,t,n){var i;r("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var s=e%26,a=Math.min((e-s)/26,this.length),o=67108863^67108863>>>s<<s,l=n;if(i-=a,i=Math.max(0,i),l){for(var c=0;c<a;c++)l.words[c]=this.words[c];l.length=a}if(0===a);else if(this.length>a)for(this.length-=a,c=0;c<this.length;c++)this.words[c]=this.words[c+a];else this.words[0]=0,this.length=1;var u=0;for(c=this.length-1;c>=0&&(0!==u||c>=i);c--){var h=0|this.words[c];this.words[c]=u<<26-s|h>>>s,u=h&o}return l&&0!==u&&(l.words[l.length++]=u),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(e,t,n){return r(0===this.negative),this.iushrn(e,t,n)},i.prototype.shln=function(e){return this.clone().ishln(e)},i.prototype.ushln=function(e){return this.clone().iushln(e)},i.prototype.shrn=function(e){return this.clone().ishrn(e)},i.prototype.ushrn=function(e){return this.clone().iushrn(e)},i.prototype.testn=function(e){r("number"==typeof e&&e>=0);var t=e%26,n=(e-t)/26,i=1<<t;return!(this.length<=n)&&!!(this.words[n]&i)},i.prototype.imaskn=function(e){r("number"==typeof e&&e>=0);var t=e%26,n=(e-t)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=n)return this;if(0!==t&&n++,this.length=Math.min(n,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this.strip()},i.prototype.maskn=function(e){return this.clone().imaskn(e)},i.prototype.iaddn=function(e){return r("number"==typeof e),r(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},i.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},i.prototype.isubn=function(e){if(r("number"==typeof e),r(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},i.prototype.addn=function(e){return this.clone().iaddn(e)},i.prototype.subn=function(e){return this.clone().isubn(e)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(e,t,n){var i,s,a=e.length+n;this._expand(a);var o=0;for(i=0;i<e.length;i++){s=(0|this.words[i+n])+o;var l=(0|e.words[i])*t;o=((s-=67108863&l)>>26)-(l/67108864|0),this.words[i+n]=67108863&s}for(;i<this.length-n;i++)o=(s=(0|this.words[i+n])+o)>>26,this.words[i+n]=67108863&s;if(0===o)return this.strip();for(r(-1===o),o=0,i=0;i<this.length;i++)o=(s=-(0|this.words[i])+o)>>26,this.words[i]=67108863&s;return this.negative=1,this.strip()},i.prototype._wordDiv=function(e,t){var r=(this.length,e.length),n=this.clone(),s=e,a=0|s.words[s.length-1];0!==(r=26-this._countBits(a))&&(s=s.ushln(r),n.iushln(r),a=0|s.words[s.length-1]);var o,l=n.length-s.length;if("mod"!==t){(o=new i(null)).length=l+1,o.words=new Array(o.length);for(var c=0;c<o.length;c++)o.words[c]=0}var u=n.clone()._ishlnsubmul(s,1,l);0===u.negative&&(n=u,o&&(o.words[l]=1));for(var h=l-1;h>=0;h--){var d=67108864*(0|n.words[s.length+h])+(0|n.words[s.length+h-1]);for(d=Math.min(d/a|0,67108863),n._ishlnsubmul(s,d,h);0!==n.negative;)d--,n.negative=0,n._ishlnsubmul(s,1,h),n.isZero()||(n.negative^=1);o&&(o.words[h]=d)}return o&&o.strip(),n.strip(),"div"!==t&&0!==r&&n.iushrn(r),{div:o||null,mod:n}},i.prototype.divmod=function(e,t,n){return r(!e.isZero()),this.isZero()?{div:new i(0),mod:new i(0)}:0!==this.negative&&0===e.negative?(o=this.neg().divmod(e,t),"mod"!==t&&(s=o.div.neg()),"div"!==t&&(a=o.mod.neg(),n&&0!==a.negative&&a.iadd(e)),{div:s,mod:a}):0===this.negative&&0!==e.negative?(o=this.divmod(e.neg(),t),"mod"!==t&&(s=o.div.neg()),{div:s,mod:o.mod}):0!=(this.negative&e.negative)?(o=this.neg().divmod(e.neg(),t),"div"!==t&&(a=o.mod.neg(),n&&0!==a.negative&&a.isub(e)),{div:o.div,mod:a}):e.length>this.length||this.cmp(e)<0?{div:new i(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new i(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new i(this.modn(e.words[0]))}:this._wordDiv(e,t);var s,a,o},i.prototype.div=function(e){return this.divmod(e,"div",!1).div},i.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},i.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},i.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),i=e.andln(1),s=r.cmp(n);return s<0||1===i&&0===s?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},i.prototype.modn=function(e){r(e<=67108863);for(var t=(1<<26)%e,n=0,i=this.length-1;i>=0;i--)n=(t*n+(0|this.words[i]))%e;return n},i.prototype.idivn=function(e){r(e<=67108863);for(var t=0,n=this.length-1;n>=0;n--){var i=(0|this.words[n])+67108864*t;this.words[n]=i/e|0,t=i%e}return this.strip()},i.prototype.divn=function(e){return this.clone().idivn(e)},i.prototype.egcd=function(e){r(0===e.negative),r(!e.isZero());var t=this,n=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var s=new i(1),a=new i(0),o=new i(0),l=new i(1),c=0;t.isEven()&&n.isEven();)t.iushrn(1),n.iushrn(1),++c;for(var u=n.clone(),h=t.clone();!t.isZero();){for(var d=0,f=1;0==(t.words[0]&f)&&d<26;++d,f<<=1);if(d>0)for(t.iushrn(d);d-- >0;)(s.isOdd()||a.isOdd())&&(s.iadd(u),a.isub(h)),s.iushrn(1),a.iushrn(1);for(var p=0,m=1;0==(n.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(n.iushrn(p);p-- >0;)(o.isOdd()||l.isOdd())&&(o.iadd(u),l.isub(h)),o.iushrn(1),l.iushrn(1);t.cmp(n)>=0?(t.isub(n),s.isub(o),a.isub(l)):(n.isub(t),o.isub(s),l.isub(a))}return{a:o,b:l,gcd:n.iushln(c)}},i.prototype._invmp=function(e){r(0===e.negative),r(!e.isZero());var t=this,n=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var s,a=new i(1),o=new i(0),l=n.clone();t.cmpn(1)>0&&n.cmpn(1)>0;){for(var c=0,u=1;0==(t.words[0]&u)&&c<26;++c,u<<=1);if(c>0)for(t.iushrn(c);c-- >0;)a.isOdd()&&a.iadd(l),a.iushrn(1);for(var h=0,d=1;0==(n.words[0]&d)&&h<26;++h,d<<=1);if(h>0)for(n.iushrn(h);h-- >0;)o.isOdd()&&o.iadd(l),o.iushrn(1);t.cmp(n)>=0?(t.isub(n),a.isub(o)):(n.isub(t),o.isub(a))}return(s=0===t.cmpn(1)?a:o).cmpn(0)<0&&s.iadd(e),s},i.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var n=0;t.isEven()&&r.isEven();n++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=t.cmp(r);if(i<0){var s=t;t=r,r=s}else if(0===i||0===r.cmpn(1))break;t.isub(r)}return r.iushln(n)},i.prototype.invm=function(e){return this.egcd(e).a.umod(e)},i.prototype.isEven=function(){return 0==(1&this.words[0])},i.prototype.isOdd=function(){return 1==(1&this.words[0])},i.prototype.andln=function(e){return this.words[0]&e},i.prototype.bincn=function(e){r("number"==typeof e);var t=e%26,n=(e-t)/26,i=1<<t;if(this.length<=n)return this._expand(n+1),this.words[n]|=i,this;for(var s=i,a=n;0!==s&&a<this.length;a++){var o=0|this.words[a];s=(o+=s)>>>26,o&=67108863,this.words[a]=o}return 0!==s&&(this.words[a]=s,this.length++),this},i.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},i.prototype.cmpn=function(e){var t,n=e<0;if(0!==this.negative&&!n)return-1;if(0===this.negative&&n)return 1;if(this.strip(),this.length>1)t=1;else{n&&(e=-e),r(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},i.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},i.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|e.words[r];if(n!==i){n<i?t=-1:n>i&&(t=1);break}}return t},i.prototype.gtn=function(e){return 1===this.cmpn(e)},i.prototype.gt=function(e){return 1===this.cmp(e)},i.prototype.gten=function(e){return this.cmpn(e)>=0},i.prototype.gte=function(e){return this.cmp(e)>=0},i.prototype.ltn=function(e){return-1===this.cmpn(e)},i.prototype.lt=function(e){return-1===this.cmp(e)},i.prototype.lten=function(e){return this.cmpn(e)<=0},i.prototype.lte=function(e){return this.cmp(e)<=0},i.prototype.eqn=function(e){return 0===this.cmpn(e)},i.prototype.eq=function(e){return 0===this.cmp(e)},i.red=function(e){return new S(e)},i.prototype.toRed=function(e){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(e){return this.red=e,this},i.prototype.forceRed=function(e){return r(!this.red,"Already a number in reduction context"),this._forceRed(e)},i.prototype.redAdd=function(e){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},i.prototype.redIAdd=function(e){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},i.prototype.redSub=function(e){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},i.prototype.redISub=function(e){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},i.prototype.redShl=function(e){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},i.prototype.redMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},i.prototype.redIMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(e){return r(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function v(e,t){this.name=e,this.p=new i(t,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function y(){v.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function b(){v.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function w(){v.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function x(){v.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){if("string"==typeof e){var t=i._prime(e);this.m=t.p,this.prime=t}else r(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function _(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}v.prototype._tmp=function(){var e=new i(null);return e.words=new Array(Math.ceil(this.n/13)),e},v.prototype.ireduce=function(e){var t,r=e;do{this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},v.prototype.split=function(e,t){e.iushrn(this.n,0,t)},v.prototype.imulK=function(e){return e.imul(this.k)},n(y,v),y.prototype.split=function(e,t){for(var r=Math.min(e.length,9),n=0;n<r;n++)t.words[n]=e.words[n];if(t.length=r,e.length<=9)return e.words[0]=0,void(e.length=1);var i=e.words[9];for(t.words[t.length++]=4194303&i,n=10;n<e.length;n++){var s=0|e.words[n];e.words[n-10]=(4194303&s)<<4|i>>>22,i=s}i>>>=22,e.words[n-10]=i,0===i&&e.length>10?e.length-=10:e.length-=9},y.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var n=0|e.words[r];t+=977*n,e.words[r]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},n(b,v),n(w,v),n(x,v),x.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var n=19*(0|e.words[r])+t,i=67108863&n;n>>>=26,e.words[r]=i,t=n}return 0!==t&&(e.words[e.length++]=t),e},i._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new y;else if("p224"===e)t=new b;else if("p192"===e)t=new w;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new x}return g[e]=t,t},S.prototype._verify1=function(e){r(0===e.negative,"red works only with positives"),r(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,t){r(0==(e.negative|t.negative),"red works only with positives"),r(e.red&&e.red===t.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},S.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},S.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},S.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return r.cmpn(0)<0&&r.iadd(this.m),r},S.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},S.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},S.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(r(t%2==1),3===t){var n=this.m.add(new i(1)).iushrn(2);return this.pow(e,n)}for(var s=this.m.subn(1),a=0;!s.isZero()&&0===s.andln(1);)a++,s.iushrn(1);r(!s.isZero());var o=new i(1).toRed(this),l=o.redNeg(),c=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new i(2*u*u).toRed(this);0!==this.pow(u,c).cmp(l);)u.redIAdd(l);for(var h=this.pow(u,s),d=this.pow(e,s.addn(1).iushrn(1)),f=this.pow(e,s),p=a;0!==f.cmp(o);){for(var m=f,g=0;0!==m.cmp(o);g++)m=m.redSqr();r(g<p);var v=this.pow(h,new i(1).iushln(p-g-1));d=d.redMul(v),h=v.redSqr(),f=f.redMul(h),p=g}return d},S.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},S.prototype.pow=function(e,t){if(t.isZero())return new i(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=new Array(16);r[0]=new i(1).toRed(this),r[1]=e;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],e);var s=r[0],a=0,o=0,l=t.bitLength()%26;for(0===l&&(l=26),n=t.length-1;n>=0;n--){for(var c=t.words[n],u=l-1;u>=0;u--){var h=c>>u&1;s!==r[0]&&(s=this.sqr(s)),0!==h||0!==a?(a<<=1,a|=h,(4===++o||0===n&&0===u)&&(s=this.mul(s,r[a]),o=0,a=0)):o=0}l=26}return s},S.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},S.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},i.mont=function(e){return new _(e)},n(_,S),_.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},_.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},_.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},_.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new i(0)._forceRed(this);var r=e.mul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=r.isub(n).iushrn(this.shift),a=s;return s.cmp(this.m)>=0?a=s.isub(this.m):s.cmpn(0)<0&&(a=s.iadd(this.m)),a._forceRed(this)},_.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===t||t)},{buffer:188}],185:[function(e,t,r){"use strict";r.byteLength=function(e){var t=c(e),r=t[0],n=t[1];return 3*(r+n)/4-n},r.toByteArray=function(e){var t,r,n=c(e),a=n[0],o=n[1],l=new s(function(e,t,r){return 3*(t+r)/4-r}(0,a,o)),u=0,h=o>0?a-4:a;for(r=0;r<h;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;return 2===o&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,l[u++]=255&t),1===o&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t),l},r.fromByteArray=function(e){for(var t,r=e.length,i=r%3,s=[],a=0,o=r-i;a<o;a+=16383)s.push(u(e,a,a+16383>o?o:a+16383));return 1===i?(t=e[r-1],s.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],s.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),s.join("")};for(var n=[],i=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=a.length;o<l;++o)n[o]=a[o],i[a.charCodeAt(o)]=o;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function u(e,t,r){for(var i,s,a=[],o=t;o<r;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),a.push(n[(s=i)>>18&63]+n[s>>12&63]+n[s>>6&63]+n[63&s]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],186:[function(e,t,r){"use strict";!function(t){function r(e,t){if(!e)throw new Error(t||"Assertion failed")}function n(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function i(e,t,r){if(i.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}var s;"object"==typeof t?t.exports=i:(void 0).BN=i,i.BN=i,i.wordSize=26;try{s="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:e("buffer").Buffer}catch(e){}function a(e,t){var n=e.charCodeAt(t);return n>=48&&n<=57?n-48:n>=65&&n<=70?n-55:n>=97&&n<=102?n-87:void r(!1,"Invalid character in "+e)}function o(e,t,r){var n=a(e,r);return r-1>=t&&(n|=a(e,r-1)<<4),n}function l(e,t,n,i){for(var s=0,a=0,o=Math.min(e.length,n),l=t;l<o;l++){var c=e.charCodeAt(l)-48;s*=i,a=c>=49?c-49+10:c>=17?c-17+10:c,r(c>=0&&a<i,"Invalid character"),s+=a}return s}function c(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(i.isBN=function(e){return e instanceof i||null!==e&&"object"==typeof e&&e.constructor.wordSize===i.wordSize&&Array.isArray(e.words)},i.max=function(e,t){return e.cmp(t)>0?e:t},i.min=function(e,t){return e.cmp(t)<0?e:t},i.prototype._init=function(e,t,n){if("number"==typeof e)return this._initNumber(e,t,n);if("object"==typeof e)return this._initArray(e,t,n);"hex"===t&&(t=16),r(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,n):(this._parseBase(e,t,i),"le"===n&&this._initArray(this.toArray(),t,n)))},i.prototype._initNumber=function(e,t,n){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(r(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===n&&this._initArray(this.toArray(),t,n)},i.prototype._initArray=function(e,t,n){if(r("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var s,a,o=0;if("be"===n)for(i=e.length-1,s=0;i>=0;i-=3)a=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[s]|=a<<o&67108863,this.words[s+1]=a>>>26-o&67108863,(o+=24)>=26&&(o-=26,s++);else if("le"===n)for(i=0,s=0;i<e.length;i+=3)a=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[s]|=a<<o&67108863,this.words[s+1]=a>>>26-o&67108863,(o+=24)>=26&&(o-=26,s++);return this._strip()},i.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,s=0,a=0;if("be"===r)for(n=e.length-1;n>=t;n-=2)i=o(e,t,n)<<s,this.words[a]|=67108863&i,s>=18?(s-=18,a+=1,this.words[a]|=i>>>26):s+=8;else for(n=(e.length-t)%2==0?t+1:t;n<e.length;n+=2)i=o(e,t,n)<<s,this.words[a]|=67108863&i,s>=18?(s-=18,a+=1,this.words[a]|=i>>>26):s+=8;this._strip()},i.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=t)n++;n--,i=i/t|0;for(var s=e.length-r,a=s%n,o=Math.min(s,s-a)+r,c=0,u=r;u<o;u+=n)c=l(e,u,u+n,t),this.imuln(i),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==a){var h=1;for(c=l(e,u,e.length,t),u=0;u<a;u++)h*=t;this.imuln(h),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this._strip()},i.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},i.prototype._move=function(e){c(e,this)},i.prototype.clone=function(){var e=new i(null);return this.copy(e),e},i.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},i.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},i.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{i.prototype[Symbol.for("nodejs.util.inspect.custom")]=u}catch(e){i.prototype.inspect=u}else i.prototype.inspect=u;function u(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],f=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function p(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n,n=n-1|0;var i=0|e.words[0],s=0|t.words[0],a=i*s,o=67108863&a,l=a/67108864|0;r.words[0]=o;for(var c=1;c<n;c++){for(var u=l>>>26,h=67108863&l,d=Math.min(c,t.length-1),f=Math.max(0,c-e.length+1);f<=d;f++){var p=c-f|0;u+=(a=(i=0|e.words[p])*(s=0|t.words[f])+h)/67108864|0,h=67108863&a}r.words[c]=0|h,l=0|u}return 0!==l?r.words[c]=0|l:r.length--,r._strip()}i.prototype.toString=function(e,t){var n;if(t=0|t||1,16===(e=e||10)||"hex"===e){n="";for(var i=0,s=0,a=0;a<this.length;a++){var o=this.words[a],l=(16777215&(o<<i|s)).toString(16);s=o>>>24-i&16777215,(i+=2)>=26&&(i-=26,a--),n=0!==s||a!==this.length-1?h[6-l.length]+l+n:l+n}for(0!==s&&(n=s.toString(16)+n);n.length%t!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}if(e===(0|e)&&e>=2&&e<=36){var c=d[e],u=f[e];n="";var p=this.clone();for(p.negative=0;!p.isZero();){var m=p.modrn(u).toString(e);n=(p=p.idivn(u)).isZero()?m+n:h[c-m.length]+m+n}for(this.isZero()&&(n="0"+n);n.length%t!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},i.prototype.toJSON=function(){return this.toString(16,2)},s&&(i.prototype.toBuffer=function(e,t){return this.toArrayLike(s,e,t)}),i.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},i.prototype.toArrayLike=function(e,t,n){this._strip();var i=this.byteLength(),s=n||Math.max(1,i);r(i<=s,"byte array longer than desired length"),r(s>0,"Requested array length <= 0");var a=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)}(e,s);return this["_toArrayLike"+("le"===t?"LE":"BE")](a,i),a},i.prototype._toArrayLikeLE=function(e,t){for(var r=0,n=0,i=0,s=0;i<this.length;i++){var a=this.words[i]<<s|n;e[r++]=255&a,r<e.length&&(e[r++]=a>>8&255),r<e.length&&(e[r++]=a>>16&255),6===s?(r<e.length&&(e[r++]=a>>24&255),n=0,s=0):(n=a>>>24,s+=2)}if(r<e.length)for(e[r++]=n;r<e.length;)e[r++]=0},i.prototype._toArrayLikeBE=function(e,t){for(var r=e.length-1,n=0,i=0,s=0;i<this.length;i++){var a=this.words[i]<<s|n;e[r--]=255&a,r>=0&&(e[r--]=a>>8&255),r>=0&&(e[r--]=a>>16&255),6===s?(r>=0&&(e[r--]=a>>24&255),n=0,s=0):(n=a>>>24,s+=2)}if(r>=0)for(e[r--]=n;r>=0;)e[r--]=0},Math.clz32?i.prototype._countBits=function(e){return 32-Math.clz32(e)}:i.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},i.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 0==(8191&t)&&(r+=13,t>>>=13),0==(127&t)&&(r+=7,t>>>=7),0==(15&t)&&(r+=4,t>>>=4),0==(3&t)&&(r+=2,t>>>=2),0==(1&t)&&r++,r},i.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},i.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return 0!==this.negative},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},i.prototype.ior=function(e){return r(0==(this.negative|e.negative)),this.iuor(e)},i.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},i.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},i.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this._strip()},i.prototype.iand=function(e){return r(0==(this.negative|e.negative)),this.iuand(e)},i.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},i.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},i.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var n=0;n<r.length;n++)this.words[n]=t.words[n]^r.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this._strip()},i.prototype.ixor=function(e){return r(0==(this.negative|e.negative)),this.iuxor(e)},i.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},i.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},i.prototype.inotn=function(e){r("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),n=e%26;this._expand(t),n>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return n>0&&(this.words[i]=~this.words[i]&67108863>>26-n),this._strip()},i.prototype.notn=function(e){return this.clone().inotn(e)},i.prototype.setn=function(e,t){r("number"==typeof e&&e>=0);var n=e/26|0,i=e%26;return this._expand(n+1),this.words[n]=t?this.words[n]|1<<i:this.words[n]&~(1<<i),this._strip()},i.prototype.iadd=function(e){var t,r,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,n=e):(r=e,n=this);for(var i=0,s=0;s<n.length;s++)t=(0|r.words[s])+(0|n.words[s])+i,this.words[s]=67108863&t,i=t>>>26;for(;0!==i&&s<r.length;s++)t=(0|r.words[s])+i,this.words[s]=67108863&t,i=t>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this},i.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},i.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,n,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=e):(r=e,n=this);for(var s=0,a=0;a<n.length;a++)s=(t=(0|r.words[a])-(0|n.words[a])+s)>>26,this.words[a]=67108863&t;for(;0!==s&&a<r.length;a++)s=(t=(0|r.words[a])+s)>>26,this.words[a]=67108863&t;if(0===s&&a<r.length&&r!==this)for(;a<r.length;a++)this.words[a]=r.words[a];return this.length=Math.max(this.length,a),r!==this&&(this.negative=1),this._strip()},i.prototype.sub=function(e){return this.clone().isub(e)};var m=function(e,t,r){var n,i,s,a=e.words,o=t.words,l=r.words,c=0,u=0|a[0],h=8191&u,d=u>>>13,f=0|a[1],p=8191&f,m=f>>>13,g=0|a[2],v=8191&g,y=g>>>13,b=0|a[3],w=8191&b,x=b>>>13,S=0|a[4],_=8191&S,C=S>>>13,E=0|a[5],A=8191&E,M=E>>>13,T=0|a[6],P=8191&T,k=T>>>13,D=0|a[7],I=8191&D,O=D>>>13,R=0|a[8],L=8191&R,N=R>>>13,B=0|a[9],z=8191&B,F=B>>>13,j=0|o[0],U=8191&j,V=j>>>13,H=0|o[1],W=8191&H,G=H>>>13,q=0|o[2],X=8191&q,Y=q>>>13,K=0|o[3],Q=8191&K,Z=K>>>13,J=0|o[4],$=8191&J,ee=J>>>13,te=0|o[5],re=8191&te,ne=te>>>13,ie=0|o[6],se=8191&ie,ae=ie>>>13,oe=0|o[7],le=8191&oe,ce=oe>>>13,ue=0|o[8],he=8191&ue,de=ue>>>13,fe=0|o[9],pe=8191&fe,me=fe>>>13;r.negative=e.negative^t.negative,r.length=19;var ge=(c+(n=Math.imul(h,U))|0)+((8191&(i=(i=Math.imul(h,V))+Math.imul(d,U)|0))<<13)|0;c=((s=Math.imul(d,V))+(i>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(p,U),i=(i=Math.imul(p,V))+Math.imul(m,U)|0,s=Math.imul(m,V);var ve=(c+(n=n+Math.imul(h,W)|0)|0)+((8191&(i=(i=i+Math.imul(h,G)|0)+Math.imul(d,W)|0))<<13)|0;c=((s=s+Math.imul(d,G)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(v,U),i=(i=Math.imul(v,V))+Math.imul(y,U)|0,s=Math.imul(y,V),n=n+Math.imul(p,W)|0,i=(i=i+Math.imul(p,G)|0)+Math.imul(m,W)|0,s=s+Math.imul(m,G)|0;var ye=(c+(n=n+Math.imul(h,X)|0)|0)+((8191&(i=(i=i+Math.imul(h,Y)|0)+Math.imul(d,X)|0))<<13)|0;c=((s=s+Math.imul(d,Y)|0)+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(w,U),i=(i=Math.imul(w,V))+Math.imul(x,U)|0,s=Math.imul(x,V),n=n+Math.imul(v,W)|0,i=(i=i+Math.imul(v,G)|0)+Math.imul(y,W)|0,s=s+Math.imul(y,G)|0,n=n+Math.imul(p,X)|0,i=(i=i+Math.imul(p,Y)|0)+Math.imul(m,X)|0,s=s+Math.imul(m,Y)|0;var be=(c+(n=n+Math.imul(h,Q)|0)|0)+((8191&(i=(i=i+Math.imul(h,Z)|0)+Math.imul(d,Q)|0))<<13)|0;c=((s=s+Math.imul(d,Z)|0)+(i>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(_,U),i=(i=Math.imul(_,V))+Math.imul(C,U)|0,s=Math.imul(C,V),n=n+Math.imul(w,W)|0,i=(i=i+Math.imul(w,G)|0)+Math.imul(x,W)|0,s=s+Math.imul(x,G)|0,n=n+Math.imul(v,X)|0,i=(i=i+Math.imul(v,Y)|0)+Math.imul(y,X)|0,s=s+Math.imul(y,Y)|0,n=n+Math.imul(p,Q)|0,i=(i=i+Math.imul(p,Z)|0)+Math.imul(m,Q)|0,s=s+Math.imul(m,Z)|0;var we=(c+(n=n+Math.imul(h,$)|0)|0)+((8191&(i=(i=i+Math.imul(h,ee)|0)+Math.imul(d,$)|0))<<13)|0;c=((s=s+Math.imul(d,ee)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(A,U),i=(i=Math.imul(A,V))+Math.imul(M,U)|0,s=Math.imul(M,V),n=n+Math.imul(_,W)|0,i=(i=i+Math.imul(_,G)|0)+Math.imul(C,W)|0,s=s+Math.imul(C,G)|0,n=n+Math.imul(w,X)|0,i=(i=i+Math.imul(w,Y)|0)+Math.imul(x,X)|0,s=s+Math.imul(x,Y)|0,n=n+Math.imul(v,Q)|0,i=(i=i+Math.imul(v,Z)|0)+Math.imul(y,Q)|0,s=s+Math.imul(y,Z)|0,n=n+Math.imul(p,$)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(m,$)|0,s=s+Math.imul(m,ee)|0;var xe=(c+(n=n+Math.imul(h,re)|0)|0)+((8191&(i=(i=i+Math.imul(h,ne)|0)+Math.imul(d,re)|0))<<13)|0;c=((s=s+Math.imul(d,ne)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,n=Math.imul(P,U),i=(i=Math.imul(P,V))+Math.imul(k,U)|0,s=Math.imul(k,V),n=n+Math.imul(A,W)|0,i=(i=i+Math.imul(A,G)|0)+Math.imul(M,W)|0,s=s+Math.imul(M,G)|0,n=n+Math.imul(_,X)|0,i=(i=i+Math.imul(_,Y)|0)+Math.imul(C,X)|0,s=s+Math.imul(C,Y)|0,n=n+Math.imul(w,Q)|0,i=(i=i+Math.imul(w,Z)|0)+Math.imul(x,Q)|0,s=s+Math.imul(x,Z)|0,n=n+Math.imul(v,$)|0,i=(i=i+Math.imul(v,ee)|0)+Math.imul(y,$)|0,s=s+Math.imul(y,ee)|0,n=n+Math.imul(p,re)|0,i=(i=i+Math.imul(p,ne)|0)+Math.imul(m,re)|0,s=s+Math.imul(m,ne)|0;var Se=(c+(n=n+Math.imul(h,se)|0)|0)+((8191&(i=(i=i+Math.imul(h,ae)|0)+Math.imul(d,se)|0))<<13)|0;c=((s=s+Math.imul(d,ae)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(I,U),i=(i=Math.imul(I,V))+Math.imul(O,U)|0,s=Math.imul(O,V),n=n+Math.imul(P,W)|0,i=(i=i+Math.imul(P,G)|0)+Math.imul(k,W)|0,s=s+Math.imul(k,G)|0,n=n+Math.imul(A,X)|0,i=(i=i+Math.imul(A,Y)|0)+Math.imul(M,X)|0,s=s+Math.imul(M,Y)|0,n=n+Math.imul(_,Q)|0,i=(i=i+Math.imul(_,Z)|0)+Math.imul(C,Q)|0,s=s+Math.imul(C,Z)|0,n=n+Math.imul(w,$)|0,i=(i=i+Math.imul(w,ee)|0)+Math.imul(x,$)|0,s=s+Math.imul(x,ee)|0,n=n+Math.imul(v,re)|0,i=(i=i+Math.imul(v,ne)|0)+Math.imul(y,re)|0,s=s+Math.imul(y,ne)|0,n=n+Math.imul(p,se)|0,i=(i=i+Math.imul(p,ae)|0)+Math.imul(m,se)|0,s=s+Math.imul(m,ae)|0;var _e=(c+(n=n+Math.imul(h,le)|0)|0)+((8191&(i=(i=i+Math.imul(h,ce)|0)+Math.imul(d,le)|0))<<13)|0;c=((s=s+Math.imul(d,ce)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(L,U),i=(i=Math.imul(L,V))+Math.imul(N,U)|0,s=Math.imul(N,V),n=n+Math.imul(I,W)|0,i=(i=i+Math.imul(I,G)|0)+Math.imul(O,W)|0,s=s+Math.imul(O,G)|0,n=n+Math.imul(P,X)|0,i=(i=i+Math.imul(P,Y)|0)+Math.imul(k,X)|0,s=s+Math.imul(k,Y)|0,n=n+Math.imul(A,Q)|0,i=(i=i+Math.imul(A,Z)|0)+Math.imul(M,Q)|0,s=s+Math.imul(M,Z)|0,n=n+Math.imul(_,$)|0,i=(i=i+Math.imul(_,ee)|0)+Math.imul(C,$)|0,s=s+Math.imul(C,ee)|0,n=n+Math.imul(w,re)|0,i=(i=i+Math.imul(w,ne)|0)+Math.imul(x,re)|0,s=s+Math.imul(x,ne)|0,n=n+Math.imul(v,se)|0,i=(i=i+Math.imul(v,ae)|0)+Math.imul(y,se)|0,s=s+Math.imul(y,ae)|0,n=n+Math.imul(p,le)|0,i=(i=i+Math.imul(p,ce)|0)+Math.imul(m,le)|0,s=s+Math.imul(m,ce)|0;var Ce=(c+(n=n+Math.imul(h,he)|0)|0)+((8191&(i=(i=i+Math.imul(h,de)|0)+Math.imul(d,he)|0))<<13)|0;c=((s=s+Math.imul(d,de)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,n=Math.imul(z,U),i=(i=Math.imul(z,V))+Math.imul(F,U)|0,s=Math.imul(F,V),n=n+Math.imul(L,W)|0,i=(i=i+Math.imul(L,G)|0)+Math.imul(N,W)|0,s=s+Math.imul(N,G)|0,n=n+Math.imul(I,X)|0,i=(i=i+Math.imul(I,Y)|0)+Math.imul(O,X)|0,s=s+Math.imul(O,Y)|0,n=n+Math.imul(P,Q)|0,i=(i=i+Math.imul(P,Z)|0)+Math.imul(k,Q)|0,s=s+Math.imul(k,Z)|0,n=n+Math.imul(A,$)|0,i=(i=i+Math.imul(A,ee)|0)+Math.imul(M,$)|0,s=s+Math.imul(M,ee)|0,n=n+Math.imul(_,re)|0,i=(i=i+Math.imul(_,ne)|0)+Math.imul(C,re)|0,s=s+Math.imul(C,ne)|0,n=n+Math.imul(w,se)|0,i=(i=i+Math.imul(w,ae)|0)+Math.imul(x,se)|0,s=s+Math.imul(x,ae)|0,n=n+Math.imul(v,le)|0,i=(i=i+Math.imul(v,ce)|0)+Math.imul(y,le)|0,s=s+Math.imul(y,ce)|0,n=n+Math.imul(p,he)|0,i=(i=i+Math.imul(p,de)|0)+Math.imul(m,he)|0,s=s+Math.imul(m,de)|0;var Ee=(c+(n=n+Math.imul(h,pe)|0)|0)+((8191&(i=(i=i+Math.imul(h,me)|0)+Math.imul(d,pe)|0))<<13)|0;c=((s=s+Math.imul(d,me)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(z,W),i=(i=Math.imul(z,G))+Math.imul(F,W)|0,s=Math.imul(F,G),n=n+Math.imul(L,X)|0,i=(i=i+Math.imul(L,Y)|0)+Math.imul(N,X)|0,s=s+Math.imul(N,Y)|0,n=n+Math.imul(I,Q)|0,i=(i=i+Math.imul(I,Z)|0)+Math.imul(O,Q)|0,s=s+Math.imul(O,Z)|0,n=n+Math.imul(P,$)|0,i=(i=i+Math.imul(P,ee)|0)+Math.imul(k,$)|0,s=s+Math.imul(k,ee)|0,n=n+Math.imul(A,re)|0,i=(i=i+Math.imul(A,ne)|0)+Math.imul(M,re)|0,s=s+Math.imul(M,ne)|0,n=n+Math.imul(_,se)|0,i=(i=i+Math.imul(_,ae)|0)+Math.imul(C,se)|0,s=s+Math.imul(C,ae)|0,n=n+Math.imul(w,le)|0,i=(i=i+Math.imul(w,ce)|0)+Math.imul(x,le)|0,s=s+Math.imul(x,ce)|0,n=n+Math.imul(v,he)|0,i=(i=i+Math.imul(v,de)|0)+Math.imul(y,he)|0,s=s+Math.imul(y,de)|0;var Ae=(c+(n=n+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;c=((s=s+Math.imul(m,me)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(z,X),i=(i=Math.imul(z,Y))+Math.imul(F,X)|0,s=Math.imul(F,Y),n=n+Math.imul(L,Q)|0,i=(i=i+Math.imul(L,Z)|0)+Math.imul(N,Q)|0,s=s+Math.imul(N,Z)|0,n=n+Math.imul(I,$)|0,i=(i=i+Math.imul(I,ee)|0)+Math.imul(O,$)|0,s=s+Math.imul(O,ee)|0,n=n+Math.imul(P,re)|0,i=(i=i+Math.imul(P,ne)|0)+Math.imul(k,re)|0,s=s+Math.imul(k,ne)|0,n=n+Math.imul(A,se)|0,i=(i=i+Math.imul(A,ae)|0)+Math.imul(M,se)|0,s=s+Math.imul(M,ae)|0,n=n+Math.imul(_,le)|0,i=(i=i+Math.imul(_,ce)|0)+Math.imul(C,le)|0,s=s+Math.imul(C,ce)|0,n=n+Math.imul(w,he)|0,i=(i=i+Math.imul(w,de)|0)+Math.imul(x,he)|0,s=s+Math.imul(x,de)|0;var Me=(c+(n=n+Math.imul(v,pe)|0)|0)+((8191&(i=(i=i+Math.imul(v,me)|0)+Math.imul(y,pe)|0))<<13)|0;c=((s=s+Math.imul(y,me)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(z,Q),i=(i=Math.imul(z,Z))+Math.imul(F,Q)|0,s=Math.imul(F,Z),n=n+Math.imul(L,$)|0,i=(i=i+Math.imul(L,ee)|0)+Math.imul(N,$)|0,s=s+Math.imul(N,ee)|0,n=n+Math.imul(I,re)|0,i=(i=i+Math.imul(I,ne)|0)+Math.imul(O,re)|0,s=s+Math.imul(O,ne)|0,n=n+Math.imul(P,se)|0,i=(i=i+Math.imul(P,ae)|0)+Math.imul(k,se)|0,s=s+Math.imul(k,ae)|0,n=n+Math.imul(A,le)|0,i=(i=i+Math.imul(A,ce)|0)+Math.imul(M,le)|0,s=s+Math.imul(M,ce)|0,n=n+Math.imul(_,he)|0,i=(i=i+Math.imul(_,de)|0)+Math.imul(C,he)|0,s=s+Math.imul(C,de)|0;var Te=(c+(n=n+Math.imul(w,pe)|0)|0)+((8191&(i=(i=i+Math.imul(w,me)|0)+Math.imul(x,pe)|0))<<13)|0;c=((s=s+Math.imul(x,me)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(z,$),i=(i=Math.imul(z,ee))+Math.imul(F,$)|0,s=Math.imul(F,ee),n=n+Math.imul(L,re)|0,i=(i=i+Math.imul(L,ne)|0)+Math.imul(N,re)|0,s=s+Math.imul(N,ne)|0,n=n+Math.imul(I,se)|0,i=(i=i+Math.imul(I,ae)|0)+Math.imul(O,se)|0,s=s+Math.imul(O,ae)|0,n=n+Math.imul(P,le)|0,i=(i=i+Math.imul(P,ce)|0)+Math.imul(k,le)|0,s=s+Math.imul(k,ce)|0,n=n+Math.imul(A,he)|0,i=(i=i+Math.imul(A,de)|0)+Math.imul(M,he)|0,s=s+Math.imul(M,de)|0;var Pe=(c+(n=n+Math.imul(_,pe)|0)|0)+((8191&(i=(i=i+Math.imul(_,me)|0)+Math.imul(C,pe)|0))<<13)|0;c=((s=s+Math.imul(C,me)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,n=Math.imul(z,re),i=(i=Math.imul(z,ne))+Math.imul(F,re)|0,s=Math.imul(F,ne),n=n+Math.imul(L,se)|0,i=(i=i+Math.imul(L,ae)|0)+Math.imul(N,se)|0,s=s+Math.imul(N,ae)|0,n=n+Math.imul(I,le)|0,i=(i=i+Math.imul(I,ce)|0)+Math.imul(O,le)|0,s=s+Math.imul(O,ce)|0,n=n+Math.imul(P,he)|0,i=(i=i+Math.imul(P,de)|0)+Math.imul(k,he)|0,s=s+Math.imul(k,de)|0;var ke=(c+(n=n+Math.imul(A,pe)|0)|0)+((8191&(i=(i=i+Math.imul(A,me)|0)+Math.imul(M,pe)|0))<<13)|0;c=((s=s+Math.imul(M,me)|0)+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(z,se),i=(i=Math.imul(z,ae))+Math.imul(F,se)|0,s=Math.imul(F,ae),n=n+Math.imul(L,le)|0,i=(i=i+Math.imul(L,ce)|0)+Math.imul(N,le)|0,s=s+Math.imul(N,ce)|0,n=n+Math.imul(I,he)|0,i=(i=i+Math.imul(I,de)|0)+Math.imul(O,he)|0,s=s+Math.imul(O,de)|0;var De=(c+(n=n+Math.imul(P,pe)|0)|0)+((8191&(i=(i=i+Math.imul(P,me)|0)+Math.imul(k,pe)|0))<<13)|0;c=((s=s+Math.imul(k,me)|0)+(i>>>13)|0)+(De>>>26)|0,De&=67108863,n=Math.imul(z,le),i=(i=Math.imul(z,ce))+Math.imul(F,le)|0,s=Math.imul(F,ce),n=n+Math.imul(L,he)|0,i=(i=i+Math.imul(L,de)|0)+Math.imul(N,he)|0,s=s+Math.imul(N,de)|0;var Ie=(c+(n=n+Math.imul(I,pe)|0)|0)+((8191&(i=(i=i+Math.imul(I,me)|0)+Math.imul(O,pe)|0))<<13)|0;c=((s=s+Math.imul(O,me)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(z,he),i=(i=Math.imul(z,de))+Math.imul(F,he)|0,s=Math.imul(F,de);var Oe=(c+(n=n+Math.imul(L,pe)|0)|0)+((8191&(i=(i=i+Math.imul(L,me)|0)+Math.imul(N,pe)|0))<<13)|0;c=((s=s+Math.imul(N,me)|0)+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863;var Re=(c+(n=Math.imul(z,pe))|0)+((8191&(i=(i=Math.imul(z,me))+Math.imul(F,pe)|0))<<13)|0;return c=((s=Math.imul(F,me))+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863,l[0]=ge,l[1]=ve,l[2]=ye,l[3]=be,l[4]=we,l[5]=xe,l[6]=Se,l[7]=_e,l[8]=Ce,l[9]=Ee,l[10]=Ae,l[11]=Me,l[12]=Te,l[13]=Pe,l[14]=ke,l[15]=De,l[16]=Ie,l[17]=Oe,l[18]=Re,0!==c&&(l[19]=c,r.length++),r};function g(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var n=0,i=0,s=0;s<r.length-1;s++){var a=i;i=0;for(var o=67108863&n,l=Math.min(s,t.length-1),c=Math.max(0,s-e.length+1);c<=l;c++){var u=s-c,h=(0|e.words[u])*(0|t.words[c]),d=67108863&h;o=67108863&(d=d+o|0),i+=(a=(a=a+(h/67108864|0)|0)+(d>>>26)|0)>>>26,a&=67108863}r.words[s]=o,n=a,a=i}return 0!==n?r.words[s]=n:r.length--,r._strip()}function v(e,t,r){return g(e,t,r)}function y(e,t){this.x=e,this.y=t}Math.imul||(m=p),i.prototype.mulTo=function(e,t){var r=this.length+e.length;return 10===this.length&&10===e.length?m(this,e,t):r<63?p(this,e,t):r<1024?g(this,e,t):v(this,e,t)},y.prototype.makeRBT=function(e){for(var t=new Array(e),r=i.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,r,e);return t},y.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var n=0,i=0;i<t;i++)n|=(1&e)<<t-i-1,e>>=1;return n},y.prototype.permute=function(e,t,r,n,i,s){for(var a=0;a<s;a++)n[a]=t[e[a]],i[a]=r[e[a]]},y.prototype.transform=function(e,t,r,n,i,s){this.permute(s,e,t,r,n,i);for(var a=1;a<i;a<<=1)for(var o=a<<1,l=Math.cos(2*Math.PI/o),c=Math.sin(2*Math.PI/o),u=0;u<i;u+=o)for(var h=l,d=c,f=0;f<a;f++){var p=r[u+f],m=n[u+f],g=r[u+f+a],v=n[u+f+a],y=h*g-d*v;v=h*v+d*g,g=y,r[u+f]=p+g,n[u+f]=m+v,r[u+f+a]=p-g,n[u+f+a]=m-v,f!==o&&(y=l*h-c*d,d=l*d+c*h,h=y)}},y.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},y.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=e[n];e[n]=e[r-n-1],e[r-n-1]=i,i=t[n],t[n]=-t[r-n-1],t[r-n-1]=-i}},y.prototype.normalize13b=function(e,t){for(var r=0,n=0;n<t/2;n++){var i=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+r;e[n]=67108863&i,r=i<67108864?0:i/67108864|0}return e},y.prototype.convert13b=function(e,t,n,i){for(var s=0,a=0;a<t;a++)s+=0|e[a],n[2*a]=8191&s,s>>>=13,n[2*a+1]=8191&s,s>>>=13;for(a=2*t;a<i;++a)n[a]=0;r(0===s),r(0==(-8192&s))},y.prototype.stub=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=0;return t},y.prototype.mulp=function(e,t,r){var n=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(n),s=this.stub(n),a=new Array(n),o=new Array(n),l=new Array(n),c=new Array(n),u=new Array(n),h=new Array(n),d=r.words;d.length=n,this.convert13b(e.words,e.length,a,n),this.convert13b(t.words,t.length,c,n),this.transform(a,s,o,l,n,i),this.transform(c,s,u,h,n,i);for(var f=0;f<n;f++){var p=o[f]*u[f]-l[f]*h[f];l[f]=o[f]*h[f]+l[f]*u[f],o[f]=p}return this.conjugate(o,l,n),this.transform(o,l,d,s,n,i),this.conjugate(d,s,n),this.normalize13b(d,n),r.negative=e.negative^t.negative,r.length=e.length+t.length,r._strip()},i.prototype.mul=function(e){var t=new i(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},i.prototype.mulf=function(e){var t=new i(null);return t.words=new Array(this.length+e.length),v(this,e,t)},i.prototype.imul=function(e){return this.clone().mulTo(e,this)},i.prototype.imuln=function(e){var t=e<0;t&&(e=-e),r("number"==typeof e),r(e<67108864);for(var n=0,i=0;i<this.length;i++){var s=(0|this.words[i])*e,a=(67108863&s)+(67108863&n);n>>=26,n+=s/67108864|0,n+=a>>>26,this.words[i]=67108863&a}return 0!==n&&(this.words[i]=n,this.length++),t?this.ineg():this},i.prototype.muln=function(e){return this.clone().imuln(e)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),r=0;r<t.length;r++){var n=r/26|0,i=r%26;t[r]=e.words[n]>>>i&1}return t}(e);if(0===t.length)return new i(1);for(var r=this,n=0;n<t.length&&0===t[n];n++,r=r.sqr());if(++n<t.length)for(var s=r.sqr();n<t.length;n++,s=s.sqr())0!==t[n]&&(r=r.mul(s));return r},i.prototype.iushln=function(e){r("number"==typeof e&&e>=0);var t,n=e%26,i=(e-n)/26,s=67108863>>>26-n<<26-n;if(0!==n){var a=0;for(t=0;t<this.length;t++){var o=this.words[t]&s,l=(0|this.words[t])-o<<n;this.words[t]=l|a,a=o>>>26-n}a&&(this.words[t]=a,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this._strip()},i.prototype.ishln=function(e){return r(0===this.negative),this.iushln(e)},i.prototype.iushrn=function(e,t,n){var i;r("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var s=e%26,a=Math.min((e-s)/26,this.length),o=67108863^67108863>>>s<<s,l=n;if(i-=a,i=Math.max(0,i),l){for(var c=0;c<a;c++)l.words[c]=this.words[c];l.length=a}if(0===a);else if(this.length>a)for(this.length-=a,c=0;c<this.length;c++)this.words[c]=this.words[c+a];else this.words[0]=0,this.length=1;var u=0;for(c=this.length-1;c>=0&&(0!==u||c>=i);c--){var h=0|this.words[c];this.words[c]=u<<26-s|h>>>s,u=h&o}return l&&0!==u&&(l.words[l.length++]=u),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},i.prototype.ishrn=function(e,t,n){return r(0===this.negative),this.iushrn(e,t,n)},i.prototype.shln=function(e){return this.clone().ishln(e)},i.prototype.ushln=function(e){return this.clone().iushln(e)},i.prototype.shrn=function(e){return this.clone().ishrn(e)},i.prototype.ushrn=function(e){return this.clone().iushrn(e)},i.prototype.testn=function(e){r("number"==typeof e&&e>=0);var t=e%26,n=(e-t)/26,i=1<<t;return!(this.length<=n)&&!!(this.words[n]&i)},i.prototype.imaskn=function(e){r("number"==typeof e&&e>=0);var t=e%26,n=(e-t)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=n)return this;if(0!==t&&n++,this.length=Math.min(n,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this._strip()},i.prototype.maskn=function(e){return this.clone().imaskn(e)},i.prototype.iaddn=function(e){return r("number"==typeof e),r(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},i.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},i.prototype.isubn=function(e){if(r("number"==typeof e),r(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},i.prototype.addn=function(e){return this.clone().iaddn(e)},i.prototype.subn=function(e){return this.clone().isubn(e)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(e,t,n){var i,s,a=e.length+n;this._expand(a);var o=0;for(i=0;i<e.length;i++){s=(0|this.words[i+n])+o;var l=(0|e.words[i])*t;o=((s-=67108863&l)>>26)-(l/67108864|0),this.words[i+n]=67108863&s}for(;i<this.length-n;i++)o=(s=(0|this.words[i+n])+o)>>26,this.words[i+n]=67108863&s;if(0===o)return this._strip();for(r(-1===o),o=0,i=0;i<this.length;i++)o=(s=-(0|this.words[i])+o)>>26,this.words[i]=67108863&s;return this.negative=1,this._strip()},i.prototype._wordDiv=function(e,t){var r=(this.length,e.length),n=this.clone(),s=e,a=0|s.words[s.length-1];0!==(r=26-this._countBits(a))&&(s=s.ushln(r),n.iushln(r),a=0|s.words[s.length-1]);var o,l=n.length-s.length;if("mod"!==t){(o=new i(null)).length=l+1,o.words=new Array(o.length);for(var c=0;c<o.length;c++)o.words[c]=0}var u=n.clone()._ishlnsubmul(s,1,l);0===u.negative&&(n=u,o&&(o.words[l]=1));for(var h=l-1;h>=0;h--){var d=67108864*(0|n.words[s.length+h])+(0|n.words[s.length+h-1]);for(d=Math.min(d/a|0,67108863),n._ishlnsubmul(s,d,h);0!==n.negative;)d--,n.negative=0,n._ishlnsubmul(s,1,h),n.isZero()||(n.negative^=1);o&&(o.words[h]=d)}return o&&o._strip(),n._strip(),"div"!==t&&0!==r&&n.iushrn(r),{div:o||null,mod:n}},i.prototype.divmod=function(e,t,n){return r(!e.isZero()),this.isZero()?{div:new i(0),mod:new i(0)}:0!==this.negative&&0===e.negative?(o=this.neg().divmod(e,t),"mod"!==t&&(s=o.div.neg()),"div"!==t&&(a=o.mod.neg(),n&&0!==a.negative&&a.iadd(e)),{div:s,mod:a}):0===this.negative&&0!==e.negative?(o=this.divmod(e.neg(),t),"mod"!==t&&(s=o.div.neg()),{div:s,mod:o.mod}):0!=(this.negative&e.negative)?(o=this.neg().divmod(e.neg(),t),"div"!==t&&(a=o.mod.neg(),n&&0!==a.negative&&a.isub(e)),{div:o.div,mod:a}):e.length>this.length||this.cmp(e)<0?{div:new i(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new i(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new i(this.modrn(e.words[0]))}:this._wordDiv(e,t);var s,a,o},i.prototype.div=function(e){return this.divmod(e,"div",!1).div},i.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},i.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},i.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),i=e.andln(1),s=r.cmp(n);return s<0||1===i&&0===s?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},i.prototype.modrn=function(e){var t=e<0;t&&(e=-e),r(e<=67108863);for(var n=(1<<26)%e,i=0,s=this.length-1;s>=0;s--)i=(n*i+(0|this.words[s]))%e;return t?-i:i},i.prototype.modn=function(e){return this.modrn(e)},i.prototype.idivn=function(e){var t=e<0;t&&(e=-e),r(e<=67108863);for(var n=0,i=this.length-1;i>=0;i--){var s=(0|this.words[i])+67108864*n;this.words[i]=s/e|0,n=s%e}return this._strip(),t?this.ineg():this},i.prototype.divn=function(e){return this.clone().idivn(e)},i.prototype.egcd=function(e){r(0===e.negative),r(!e.isZero());var t=this,n=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var s=new i(1),a=new i(0),o=new i(0),l=new i(1),c=0;t.isEven()&&n.isEven();)t.iushrn(1),n.iushrn(1),++c;for(var u=n.clone(),h=t.clone();!t.isZero();){for(var d=0,f=1;0==(t.words[0]&f)&&d<26;++d,f<<=1);if(d>0)for(t.iushrn(d);d-- >0;)(s.isOdd()||a.isOdd())&&(s.iadd(u),a.isub(h)),s.iushrn(1),a.iushrn(1);for(var p=0,m=1;0==(n.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(n.iushrn(p);p-- >0;)(o.isOdd()||l.isOdd())&&(o.iadd(u),l.isub(h)),o.iushrn(1),l.iushrn(1);t.cmp(n)>=0?(t.isub(n),s.isub(o),a.isub(l)):(n.isub(t),o.isub(s),l.isub(a))}return{a:o,b:l,gcd:n.iushln(c)}},i.prototype._invmp=function(e){r(0===e.negative),r(!e.isZero());var t=this,n=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var s,a=new i(1),o=new i(0),l=n.clone();t.cmpn(1)>0&&n.cmpn(1)>0;){for(var c=0,u=1;0==(t.words[0]&u)&&c<26;++c,u<<=1);if(c>0)for(t.iushrn(c);c-- >0;)a.isOdd()&&a.iadd(l),a.iushrn(1);for(var h=0,d=1;0==(n.words[0]&d)&&h<26;++h,d<<=1);if(h>0)for(n.iushrn(h);h-- >0;)o.isOdd()&&o.iadd(l),o.iushrn(1);t.cmp(n)>=0?(t.isub(n),a.isub(o)):(n.isub(t),o.isub(a))}return(s=0===t.cmpn(1)?a:o).cmpn(0)<0&&s.iadd(e),s},i.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var n=0;t.isEven()&&r.isEven();n++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=t.cmp(r);if(i<0){var s=t;t=r,r=s}else if(0===i||0===r.cmpn(1))break;t.isub(r)}return r.iushln(n)},i.prototype.invm=function(e){return this.egcd(e).a.umod(e)},i.prototype.isEven=function(){return 0==(1&this.words[0])},i.prototype.isOdd=function(){return 1==(1&this.words[0])},i.prototype.andln=function(e){return this.words[0]&e},i.prototype.bincn=function(e){r("number"==typeof e);var t=e%26,n=(e-t)/26,i=1<<t;if(this.length<=n)return this._expand(n+1),this.words[n]|=i,this;for(var s=i,a=n;0!==s&&a<this.length;a++){var o=0|this.words[a];s=(o+=s)>>>26,o&=67108863,this.words[a]=o}return 0!==s&&(this.words[a]=s,this.length++),this},i.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},i.prototype.cmpn=function(e){var t,n=e<0;if(0!==this.negative&&!n)return-1;if(0===this.negative&&n)return 1;if(this._strip(),this.length>1)t=1;else{n&&(e=-e),r(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},i.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},i.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|e.words[r];if(n!==i){n<i?t=-1:n>i&&(t=1);break}}return t},i.prototype.gtn=function(e){return 1===this.cmpn(e)},i.prototype.gt=function(e){return 1===this.cmp(e)},i.prototype.gten=function(e){return this.cmpn(e)>=0},i.prototype.gte=function(e){return this.cmp(e)>=0},i.prototype.ltn=function(e){return-1===this.cmpn(e)},i.prototype.lt=function(e){return-1===this.cmp(e)},i.prototype.lten=function(e){return this.cmpn(e)<=0},i.prototype.lte=function(e){return this.cmp(e)<=0},i.prototype.eqn=function(e){return 0===this.cmpn(e)},i.prototype.eq=function(e){return 0===this.cmp(e)},i.red=function(e){return new E(e)},i.prototype.toRed=function(e){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(e){return this.red=e,this},i.prototype.forceRed=function(e){return r(!this.red,"Already a number in reduction context"),this._forceRed(e)},i.prototype.redAdd=function(e){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},i.prototype.redIAdd=function(e){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},i.prototype.redSub=function(e){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},i.prototype.redISub=function(e){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},i.prototype.redShl=function(e){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},i.prototype.redMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},i.prototype.redIMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(e){return r(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var b={k256:null,p224:null,p192:null,p25519:null};function w(e,t){this.name=e,this.p=new i(t,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function x(){w.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function S(){w.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function _(){w.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function C(){w.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function E(e){if("string"==typeof e){var t=i._prime(e);this.m=t.p,this.prime=t}else r(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function A(e){E.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}w.prototype._tmp=function(){var e=new i(null);return e.words=new Array(Math.ceil(this.n/13)),e},w.prototype.ireduce=function(e){var t,r=e;do{this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},w.prototype.split=function(e,t){e.iushrn(this.n,0,t)},w.prototype.imulK=function(e){return e.imul(this.k)},n(x,w),x.prototype.split=function(e,t){for(var r=Math.min(e.length,9),n=0;n<r;n++)t.words[n]=e.words[n];if(t.length=r,e.length<=9)return e.words[0]=0,void(e.length=1);var i=e.words[9];for(t.words[t.length++]=4194303&i,n=10;n<e.length;n++){var s=0|e.words[n];e.words[n-10]=(4194303&s)<<4|i>>>22,i=s}i>>>=22,e.words[n-10]=i,0===i&&e.length>10?e.length-=10:e.length-=9},x.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var n=0|e.words[r];t+=977*n,e.words[r]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},n(S,w),n(_,w),n(C,w),C.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var n=19*(0|e.words[r])+t,i=67108863&n;n>>>=26,e.words[r]=i,t=n}return 0!==t&&(e.words[e.length++]=t),e},i._prime=function(e){if(b[e])return b[e];var t;if("k256"===e)t=new x;else if("p224"===e)t=new S;else if("p192"===e)t=new _;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new C}return b[e]=t,t},E.prototype._verify1=function(e){r(0===e.negative,"red works only with positives"),r(e.red,"red works only with red numbers")},E.prototype._verify2=function(e,t){r(0==(e.negative|t.negative),"red works only with positives"),r(e.red&&e.red===t.red,"red works only with red numbers")},E.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(c(e,e.umod(this.m)._forceRed(this)),e)},E.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},E.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},E.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},E.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},E.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return r.cmpn(0)<0&&r.iadd(this.m),r},E.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},E.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},E.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},E.prototype.isqr=function(e){return this.imul(e,e.clone())},E.prototype.sqr=function(e){return this.mul(e,e)},E.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(r(t%2==1),3===t){var n=this.m.add(new i(1)).iushrn(2);return this.pow(e,n)}for(var s=this.m.subn(1),a=0;!s.isZero()&&0===s.andln(1);)a++,s.iushrn(1);r(!s.isZero());var o=new i(1).toRed(this),l=o.redNeg(),c=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new i(2*u*u).toRed(this);0!==this.pow(u,c).cmp(l);)u.redIAdd(l);for(var h=this.pow(u,s),d=this.pow(e,s.addn(1).iushrn(1)),f=this.pow(e,s),p=a;0!==f.cmp(o);){for(var m=f,g=0;0!==m.cmp(o);g++)m=m.redSqr();r(g<p);var v=this.pow(h,new i(1).iushln(p-g-1));d=d.redMul(v),h=v.redSqr(),f=f.redMul(h),p=g}return d},E.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},E.prototype.pow=function(e,t){if(t.isZero())return new i(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=new Array(16);r[0]=new i(1).toRed(this),r[1]=e;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],e);var s=r[0],a=0,o=0,l=t.bitLength()%26;for(0===l&&(l=26),n=t.length-1;n>=0;n--){for(var c=t.words[n],u=l-1;u>=0;u--){var h=c>>u&1;s!==r[0]&&(s=this.sqr(s)),0!==h||0!==a?(a<<=1,a|=h,(4===++o||0===n&&0===u)&&(s=this.mul(s,r[a]),o=0,a=0)):o=0}l=26}return s},E.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},E.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},i.mont=function(e){return new A(e)},n(A,E),A.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},A.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},A.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},A.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new i(0)._forceRed(this);var r=e.mul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=r.isub(n).iushrn(this.shift),a=s;return s.cmp(this.m)>=0?a=s.isub(this.m):s.cmpn(0)<0&&(a=s.iadd(this.m)),a._forceRed(this)},A.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===t||t)},{buffer:188}],187:[function(e,t,r){"use strict";var n;function i(e){this.rand=e}if(t.exports=function(e){return n||(n=new i(null)),n.generate(e)},t.exports.Rand=i,i.prototype.generate=function(e){return this._rand(e)},i.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),r=0;r<t.length;r++)t[r]=this.rand.getByte();return t},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?i.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?i.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:"object"==typeof window&&(i.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var s=e("crypto");if("function"!=typeof s.randomBytes)throw new Error("Not supported");i.prototype._rand=function(e){return s.randomBytes(e)}}catch(e){}},{crypto:188}],188:[function(e,t,r){},{}],189:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer;function i(e){n.isBuffer(e)||(e=n.from(e));for(var t=e.length/4|0,r=new Array(t),i=0;i<t;i++)r[i]=e.readUInt32BE(4*i);return r}function s(e){for(;0<e.length;e++)e[0]=0}function a(e,t,r,n,i){for(var s,a,o,l,c=r[0],u=r[1],h=r[2],d=r[3],f=e[0]^t[0],p=e[1]^t[1],m=e[2]^t[2],g=e[3]^t[3],v=4,y=1;y<i;y++)s=c[f>>>24]^u[p>>>16&255]^h[m>>>8&255]^d[255&g]^t[v++],a=c[p>>>24]^u[m>>>16&255]^h[g>>>8&255]^d[255&f]^t[v++],o=c[m>>>24]^u[g>>>16&255]^h[f>>>8&255]^d[255&p]^t[v++],l=c[g>>>24]^u[f>>>16&255]^h[p>>>8&255]^d[255&m]^t[v++],f=s,p=a,m=o,g=l;return s=(n[f>>>24]<<24|n[p>>>16&255]<<16|n[m>>>8&255]<<8|n[255&g])^t[v++],a=(n[p>>>24]<<24|n[m>>>16&255]<<16|n[g>>>8&255]<<8|n[255&f])^t[v++],o=(n[m>>>24]<<24|n[g>>>16&255]<<16|n[f>>>8&255]<<8|n[255&p])^t[v++],l=(n[g>>>24]<<24|n[f>>>16&255]<<16|n[p>>>8&255]<<8|n[255&m])^t[v++],[s>>>=0,a>>>=0,o>>>=0,l>>>=0]}var o=[0,1,2,4,8,16,32,64,128,27,54],l=function(){for(var e=new Array(256),t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;for(var r=[],n=[],i=[[],[],[],[]],s=[[],[],[],[]],a=0,o=0,l=0;l<256;++l){var c=o^o<<1^o<<2^o<<3^o<<4;c=c>>>8^255&c^99,r[a]=c,n[c]=a;var u=e[a],h=e[u],d=e[h],f=257*e[c]^16843008*c;i[0][a]=f<<24|f>>>8,i[1][a]=f<<16|f>>>16,i[2][a]=f<<8|f>>>24,i[3][a]=f,f=16843009*d^65537*h^257*u^16843008*a,s[0][c]=f<<24|f>>>8,s[1][c]=f<<16|f>>>16,s[2][c]=f<<8|f>>>24,s[3][c]=f,0===a?a=o=1:(a=u^e[e[e[d^u]]],o^=e[e[o]])}return{SBOX:r,INV_SBOX:n,SUB_MIX:i,INV_SUB_MIX:s}}();function c(e){this._key=i(e),this._reset()}c.blockSize=16,c.keySize=32,c.prototype.blockSize=c.blockSize,c.prototype.keySize=c.keySize,c.prototype._reset=function(){for(var e=this._key,t=e.length,r=t+6,n=4*(r+1),i=[],s=0;s<t;s++)i[s]=e[s];for(s=t;s<n;s++){var a=i[s-1];s%t==0?(a=a<<8|a>>>24,a=l.SBOX[a>>>24]<<24|l.SBOX[a>>>16&255]<<16|l.SBOX[a>>>8&255]<<8|l.SBOX[255&a],a^=o[s/t|0]<<24):t>6&&s%t==4&&(a=l.SBOX[a>>>24]<<24|l.SBOX[a>>>16&255]<<16|l.SBOX[a>>>8&255]<<8|l.SBOX[255&a]),i[s]=i[s-t]^a}for(var c=[],u=0;u<n;u++){var h=n-u,d=i[h-(u%4?0:4)];c[u]=u<4||h<=4?d:l.INV_SUB_MIX[0][l.SBOX[d>>>24]]^l.INV_SUB_MIX[1][l.SBOX[d>>>16&255]]^l.INV_SUB_MIX[2][l.SBOX[d>>>8&255]]^l.INV_SUB_MIX[3][l.SBOX[255&d]]}this._nRounds=r,this._keySchedule=i,this._invKeySchedule=c},c.prototype.encryptBlockRaw=function(e){return a(e=i(e),this._keySchedule,l.SUB_MIX,l.SBOX,this._nRounds)},c.prototype.encryptBlock=function(e){var t=this.encryptBlockRaw(e),r=n.allocUnsafe(16);return r.writeUInt32BE(t[0],0),r.writeUInt32BE(t[1],4),r.writeUInt32BE(t[2],8),r.writeUInt32BE(t[3],12),r},c.prototype.decryptBlock=function(e){var t=(e=i(e))[1];e[1]=e[3],e[3]=t;var r=a(e,this._invKeySchedule,l.INV_SUB_MIX,l.INV_SBOX,this._nRounds),s=n.allocUnsafe(16);return s.writeUInt32BE(r[0],0),s.writeUInt32BE(r[3],4),s.writeUInt32BE(r[2],8),s.writeUInt32BE(r[1],12),s},c.prototype.scrub=function(){s(this._keySchedule),s(this._invKeySchedule),s(this._key)},t.exports.AES=c},{"safe-buffer":494}],190:[function(e,t,r){"use strict";var n=e("./aes"),i=e("safe-buffer").Buffer,s=e("cipher-base"),a=e("inherits"),o=e("./ghash"),l=e("buffer-xor"),c=e("./incr32");function u(e,t,r,a){s.call(this);var l=i.alloc(4,0);this._cipher=new n.AES(t);var u=this._cipher.encryptBlock(l);this._ghash=new o(u),r=function(e,t,r){if(12===t.length)return e._finID=i.concat([t,i.from([0,0,0,1])]),i.concat([t,i.from([0,0,0,2])]);var n=new o(r),s=t.length,a=s%16;n.update(t),a&&(a=16-a,n.update(i.alloc(a,0))),n.update(i.alloc(8,0));var l=8*s,u=i.alloc(8);u.writeUIntBE(l,0,8),n.update(u),e._finID=n.state;var h=i.from(e._finID);return c(h),h}(this,r,u),this._prev=i.from(r),this._cache=i.allocUnsafe(0),this._secCache=i.allocUnsafe(0),this._decrypt=a,this._alen=0,this._len=0,this._mode=e,this._authTag=null,this._called=!1}a(u,s),u.prototype._update=function(e){if(!this._called&&this._alen){var t=16-this._alen%16;t<16&&(t=i.alloc(t,0),this._ghash.update(t))}this._called=!0;var r=this._mode.encrypt(this,e);return this._decrypt?this._ghash.update(e):this._ghash.update(r),this._len+=e.length,r},u.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var e=l(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(e,t){var r=0;e.length!==t.length&&r++;for(var n=Math.min(e.length,t.length),i=0;i<n;++i)r+=e[i]^t[i];return r}(e,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=e,this._cipher.scrub()},u.prototype.getAuthTag=function(){if(this._decrypt||!i.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},u.prototype.setAuthTag=function(e){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=e},u.prototype.setAAD=function(e){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(e),this._alen+=e.length},t.exports=u},{"./aes":189,"./ghash":194,"./incr32":195,"buffer-xor":219,"cipher-base":221,inherits:440,"safe-buffer":494}],191:[function(e,t,r){"use strict";var n=e("./encrypter"),i=e("./decrypter"),s=e("./modes/list.json");r.createCipher=r.Cipher=n.createCipher,r.createCipheriv=r.Cipheriv=n.createCipheriv,r.createDecipher=r.Decipher=i.createDecipher,r.createDecipheriv=r.Decipheriv=i.createDecipheriv,r.listCiphers=r.getCiphers=function(){return Object.keys(s)}},{"./decrypter":192,"./encrypter":193,"./modes/list.json":203}],192:[function(e,t,r){"use strict";var n=e("./authCipher"),i=e("safe-buffer").Buffer,s=e("./modes"),a=e("./streamCipher"),o=e("cipher-base"),l=e("./aes"),c=e("evp_bytestokey");function u(e,t,r){o.call(this),this._cache=new h,this._last=void 0,this._cipher=new l.AES(t),this._prev=i.from(r),this._mode=e,this._autopadding=!0}function h(){this.cache=i.allocUnsafe(0)}function d(e,t,r){var o=s[e.toLowerCase()];if(!o)throw new TypeError("invalid suite type");if("string"==typeof r&&(r=i.from(r)),"GCM"!==o.mode&&r.length!==o.iv)throw new TypeError("invalid iv length "+r.length);if("string"==typeof t&&(t=i.from(t)),t.length!==o.key/8)throw new TypeError("invalid key length "+t.length);return"stream"===o.type?new a(o.module,t,r,!0):"auth"===o.type?new n(o.module,t,r,!0):new u(o.module,t,r)}e("inherits")(u,o),u.prototype._update=function(e){var t,r;this._cache.add(e);for(var n=[];t=this._cache.get(this._autopadding);)r=this._mode.decrypt(this,t),n.push(r);return i.concat(n)},u.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return function(e){var t=e[15];if(t<1||t>16)throw new Error("unable to decrypt data");for(var r=-1;++r<t;)if(e[r+(16-t)]!==t)throw new Error("unable to decrypt data");if(16!==t)return e.slice(0,16-t)}(this._mode.decrypt(this,e));if(e)throw new Error("data not multiple of block length")},u.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},h.prototype.add=function(e){this.cache=i.concat([this.cache,e])},h.prototype.get=function(e){var t;if(e){if(this.cache.length>16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t}else if(this.cache.length>=16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t;return null},h.prototype.flush=function(){if(this.cache.length)return this.cache},r.createDecipher=function(e,t){var r=s[e.toLowerCase()];if(!r)throw new TypeError("invalid suite type");var n=c(t,!1,r.key,r.iv);return d(e,n.key,n.iv)},r.createDecipheriv=d},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],193:[function(e,t,r){"use strict";var n=e("./modes"),i=e("./authCipher"),s=e("safe-buffer").Buffer,a=e("./streamCipher"),o=e("cipher-base"),l=e("./aes"),c=e("evp_bytestokey");function u(e,t,r){o.call(this),this._cache=new d,this._cipher=new l.AES(t),this._prev=s.from(r),this._mode=e,this._autopadding=!0}e("inherits")(u,o),u.prototype._update=function(e){var t,r;this._cache.add(e);for(var n=[];t=this._cache.get();)r=this._mode.encrypt(this,t),n.push(r);return s.concat(n)};var h=s.alloc(16,16);function d(){this.cache=s.allocUnsafe(0)}function f(e,t,r){var o=n[e.toLowerCase()];if(!o)throw new TypeError("invalid suite type");if("string"==typeof t&&(t=s.from(t)),t.length!==o.key/8)throw new TypeError("invalid key length "+t.length);if("string"==typeof r&&(r=s.from(r)),"GCM"!==o.mode&&r.length!==o.iv)throw new TypeError("invalid iv length "+r.length);return"stream"===o.type?new a(o.module,t,r):"auth"===o.type?new i(o.module,t,r):new u(o.module,t,r)}u.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return e=this._mode.encrypt(this,e),this._cipher.scrub(),e;if(!e.equals(h))throw this._cipher.scrub(),new Error("data not multiple of block length")},u.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},d.prototype.add=function(e){this.cache=s.concat([this.cache,e])},d.prototype.get=function(){if(this.cache.length>15){var e=this.cache.slice(0,16);return this.cache=this.cache.slice(16),e}return null},d.prototype.flush=function(){for(var e=16-this.cache.length,t=s.allocUnsafe(e),r=-1;++r<e;)t.writeUInt8(e,r);return s.concat([this.cache,t])},r.createCipheriv=f,r.createCipher=function(e,t){var r=n[e.toLowerCase()];if(!r)throw new TypeError("invalid suite type");var i=c(t,!1,r.key,r.iv);return f(e,i.key,i.iv)}},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],194:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer,i=n.alloc(16,0);function s(e){var t=n.allocUnsafe(16);return t.writeUInt32BE(e[0]>>>0,0),t.writeUInt32BE(e[1]>>>0,4),t.writeUInt32BE(e[2]>>>0,8),t.writeUInt32BE(e[3]>>>0,12),t}function a(e){this.h=e,this.state=n.alloc(16,0),this.cache=n.allocUnsafe(0)}a.prototype.ghash=function(e){for(var t=-1;++t<e.length;)this.state[t]^=e[t];this._multiply()},a.prototype._multiply=function(){for(var e,t,r,n=[(e=this.h).readUInt32BE(0),e.readUInt32BE(4),e.readUInt32BE(8),e.readUInt32BE(12)],i=[0,0,0,0],a=-1;++a<128;){for(0!=(this.state[~~(a/8)]&1<<7-a%8)&&(i[0]^=n[0],i[1]^=n[1],i[2]^=n[2],i[3]^=n[3]),r=0!=(1&n[3]),t=3;t>0;t--)n[t]=n[t]>>>1|(1&n[t-1])<<31;n[0]=n[0]>>>1,r&&(n[0]=n[0]^225<<24)}this.state=s(i)},a.prototype.update=function(e){var t;for(this.cache=n.concat([this.cache,e]);this.cache.length>=16;)t=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(t)},a.prototype.final=function(e,t){return this.cache.length&&this.ghash(n.concat([this.cache,i],16)),this.ghash(s([0,e,0,t])),this.state},t.exports=a},{"safe-buffer":494}],195:[function(e,t,r){"use strict";t.exports=function(e){for(var t,r=e.length;r--;){if(255!==(t=e.readUInt8(r))){t++,e.writeUInt8(t,r);break}e.writeUInt8(0,r)}}},{}],196:[function(e,t,r){"use strict";var n=e("buffer-xor");r.encrypt=function(e,t){var r=n(t,e._prev);return e._prev=e._cipher.encryptBlock(r),e._prev},r.decrypt=function(e,t){var r=e._prev;e._prev=t;var i=e._cipher.decryptBlock(t);return n(i,r)}},{"buffer-xor":219}],197:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer,i=e("buffer-xor");function s(e,t,r){var s=t.length,a=i(t,e._cache);return e._cache=e._cache.slice(s),e._prev=n.concat([e._prev,r?t:a]),a}r.encrypt=function(e,t,r){for(var i,a=n.allocUnsafe(0);t.length;){if(0===e._cache.length&&(e._cache=e._cipher.encryptBlock(e._prev),e._prev=n.allocUnsafe(0)),!(e._cache.length<=t.length)){a=n.concat([a,s(e,t,r)]);break}i=e._cache.length,a=n.concat([a,s(e,t.slice(0,i),r)]),t=t.slice(i)}return a}},{"buffer-xor":219,"safe-buffer":494}],198:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer;function i(e,t,r){for(var n,i,a=-1,o=0;++a<8;)n=t&1<<7-a?128:0,o+=(128&(i=e._cipher.encryptBlock(e._prev)[0]^n))>>a%8,e._prev=s(e._prev,r?n:i);return o}function s(e,t){var r=e.length,i=-1,s=n.allocUnsafe(e.length);for(e=n.concat([e,n.from([t])]);++i<r;)s[i]=e[i]<<1|e[i+1]>>7;return s}r.encrypt=function(e,t,r){for(var s=t.length,a=n.allocUnsafe(s),o=-1;++o<s;)a[o]=i(e,t[o],r);return a}},{"safe-buffer":494}],199:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer;function i(e,t,r){var i=e._cipher.encryptBlock(e._prev)[0]^t;return e._prev=n.concat([e._prev.slice(1),n.from([r?t:i])]),i}r.encrypt=function(e,t,r){for(var s=t.length,a=n.allocUnsafe(s),o=-1;++o<s;)a[o]=i(e,t[o],r);return a}},{"safe-buffer":494}],200:[function(e,t,r){"use strict";var n=e("buffer-xor"),i=e("safe-buffer").Buffer,s=e("../incr32");function a(e){var t=e._cipher.encryptBlockRaw(e._prev);return s(e._prev),t}r.encrypt=function(e,t){var r=Math.ceil(t.length/16),s=e._cache.length;e._cache=i.concat([e._cache,i.allocUnsafe(16*r)]);for(var o=0;o<r;o++){var l=a(e),c=s+16*o;e._cache.writeUInt32BE(l[0],c+0),e._cache.writeUInt32BE(l[1],c+4),e._cache.writeUInt32BE(l[2],c+8),e._cache.writeUInt32BE(l[3],c+12)}var u=e._cache.slice(0,t.length);return e._cache=e._cache.slice(t.length),n(t,u)}},{"../incr32":195,"buffer-xor":219,"safe-buffer":494}],201:[function(e,t,r){"use strict";r.encrypt=function(e,t){return e._cipher.encryptBlock(t)},r.decrypt=function(e,t){return e._cipher.decryptBlock(t)}},{}],202:[function(e,t,r){"use strict";var n={ECB:e("./ecb"),CBC:e("./cbc"),CFB:e("./cfb"),CFB8:e("./cfb8"),CFB1:e("./cfb1"),OFB:e("./ofb"),CTR:e("./ctr"),GCM:e("./ctr")},i=e("./list.json");for(var s in i)i[s].module=n[i[s].mode];t.exports=i},{"./cbc":196,"./cfb":197,"./cfb1":198,"./cfb8":199,"./ctr":200,"./ecb":201,"./list.json":203,"./ofb":204}],203:[function(e,t,r){t.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],204:[function(e,t,r){(function(t){(function(){"use strict";var n=e("buffer-xor");function i(e){return e._prev=e._cipher.encryptBlock(e._prev),e._prev}r.encrypt=function(e,r){for(;e._cache.length<r.length;)e._cache=t.concat([e._cache,i(e)]);var s=e._cache.slice(0,r.length);return e._cache=e._cache.slice(r.length),n(r,s)}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220,"buffer-xor":219}],205:[function(e,t,r){"use strict";var n=e("./aes"),i=e("safe-buffer").Buffer,s=e("cipher-base");function a(e,t,r,a){s.call(this),this._cipher=new n.AES(t),this._prev=i.from(r),this._cache=i.allocUnsafe(0),this._secCache=i.allocUnsafe(0),this._decrypt=a,this._mode=e}e("inherits")(a,s),a.prototype._update=function(e){return this._mode.encrypt(this,e,this._decrypt)},a.prototype._final=function(){this._cipher.scrub()},t.exports=a},{"./aes":189,"cipher-base":221,inherits:440,"safe-buffer":494}],206:[function(e,t,r){"use strict";var n=e("browserify-des"),i=e("browserify-aes/browser"),s=e("browserify-aes/modes"),a=e("browserify-des/modes"),o=e("evp_bytestokey");function l(e,t,r){if(e=e.toLowerCase(),s[e])return i.createCipheriv(e,t,r);if(a[e])return new n({key:t,iv:r,mode:e});throw new TypeError("invalid suite type")}function c(e,t,r){if(e=e.toLowerCase(),s[e])return i.createDecipheriv(e,t,r);if(a[e])return new n({key:t,iv:r,mode:e,decrypt:!0});throw new TypeError("invalid suite type")}r.createCipher=r.Cipher=function(e,t){var r,n;if(e=e.toLowerCase(),s[e])r=s[e].key,n=s[e].iv;else{if(!a[e])throw new TypeError("invalid suite type");r=8*a[e].key,n=a[e].iv}var i=o(t,!1,r,n);return l(e,i.key,i.iv)},r.createCipheriv=r.Cipheriv=l,r.createDecipher=r.Decipher=function(e,t){var r,n;if(e=e.toLowerCase(),s[e])r=s[e].key,n=s[e].iv;else{if(!a[e])throw new TypeError("invalid suite type");r=8*a[e].key,n=a[e].iv}var i=o(t,!1,r,n);return c(e,i.key,i.iv)},r.createDecipheriv=r.Decipheriv=c,r.listCiphers=r.getCiphers=function(){return Object.keys(a).concat(i.getCiphers())}},{"browserify-aes/browser":191,"browserify-aes/modes":202,"browserify-des":207,"browserify-des/modes":208,evp_bytestokey:423}],207:[function(e,t,r){"use strict";var n=e("cipher-base"),i=e("des.js"),s=e("inherits"),a=e("safe-buffer").Buffer,o={"des-ede3-cbc":i.CBC.instantiate(i.EDE),"des-ede3":i.EDE,"des-ede-cbc":i.CBC.instantiate(i.EDE),"des-ede":i.EDE,"des-cbc":i.CBC.instantiate(i.DES),"des-ecb":i.DES};function l(e){n.call(this);var t,r=e.mode.toLowerCase(),i=o[r];t=e.decrypt?"decrypt":"encrypt";var s=e.key;a.isBuffer(s)||(s=a.from(s)),"des-ede"!==r&&"des-ede-cbc"!==r||(s=a.concat([s,s.slice(0,8)]));var l=e.iv;a.isBuffer(l)||(l=a.from(l)),this._des=i.create({key:s,iv:l,type:t})}o.des=o["des-cbc"],o.des3=o["des-ede3-cbc"],t.exports=l,s(l,n),l.prototype._update=function(e){return a.from(this._des.update(e))},l.prototype._final=function(){return a.from(this._des.final())}},{"cipher-base":221,"des.js":394,inherits:440,"safe-buffer":494}],208:[function(e,t,r){"use strict";r["des-ecb"]={key:8,iv:0},r["des-cbc"]=r.des={key:8,iv:8},r["des-ede3-cbc"]=r.des3={key:24,iv:8},r["des-ede3"]={key:24,iv:0},r["des-ede-cbc"]={key:16,iv:8},r["des-ede"]={key:16,iv:0}},{}],209:[function(e,t,r){(function(r){(function(){"use strict";var n=e("bn.js"),i=e("randombytes");function s(e){var t,r=e.modulus.byteLength();do{t=new n(i(r))}while(t.cmp(e.modulus)>=0||!t.umod(e.prime1)||!t.umod(e.prime2));return t}function a(e,t){var i=function(e){var t=s(e);return{blinder:t.toRed(n.mont(e.modulus)).redPow(new n(e.publicExponent)).fromRed(),unblinder:t.invm(e.modulus)}}(t),a=t.modulus.byteLength(),o=new n(e).mul(i.blinder).umod(t.modulus),l=o.toRed(n.mont(t.prime1)),c=o.toRed(n.mont(t.prime2)),u=t.coefficient,h=t.prime1,d=t.prime2,f=l.redPow(t.exponent1).fromRed(),p=c.redPow(t.exponent2).fromRed(),m=f.isub(p).imul(u).umod(h).imul(d);return p.iadd(m).imul(i.unblinder).umod(t.modulus).toArrayLike(r,"be",a)}a.getr=s,t.exports=a}).call(this)}).call(this,e("buffer").Buffer)},{"bn.js":186,buffer:220,randombytes:475}],210:[function(e,t,r){"use strict";t.exports=e("./browser/algorithms.json")},{"./browser/algorithms.json":211}],211:[function(e,t,r){t.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],212:[function(e,t,r){t.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],213:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer,i=e("create-hash"),s=e("readable-stream"),a=e("inherits"),o=e("./sign"),l=e("./verify"),c=e("./algorithms.json");function u(e){s.Writable.call(this);var t=c[e];if(!t)throw new Error("Unknown message digest");this._hashType=t.hash,this._hash=i(t.hash),this._tag=t.id,this._signType=t.sign}function h(e){s.Writable.call(this);var t=c[e];if(!t)throw new Error("Unknown message digest");this._hash=i(t.hash),this._tag=t.id,this._signType=t.sign}function d(e){return new u(e)}function f(e){return new h(e)}Object.keys(c).forEach((function(e){c[e].id=n.from(c[e].id,"hex"),c[e.toLowerCase()]=c[e]})),a(u,s.Writable),u.prototype._write=function(e,t,r){this._hash.update(e),r()},u.prototype.update=function(e,t){return"string"==typeof e&&(e=n.from(e,t)),this._hash.update(e),this},u.prototype.sign=function(e,t){this.end();var r=this._hash.digest(),n=o(r,e,this._hashType,this._signType,this._tag);return t?n.toString(t):n},a(h,s.Writable),h.prototype._write=function(e,t,r){this._hash.update(e),r()},h.prototype.update=function(e,t){return"string"==typeof e&&(e=n.from(e,t)),this._hash.update(e),this},h.prototype.verify=function(e,t,r){"string"==typeof t&&(t=n.from(t,r)),this.end();var i=this._hash.digest();return l(t,i,e,this._signType,this._tag)},t.exports={Sign:d,Verify:f,createSign:d,createVerify:f}},{"./algorithms.json":211,"./sign":214,"./verify":215,"create-hash":386,inherits:440,"readable-stream":491,"safe-buffer":494}],214:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer,i=e("create-hmac"),s=e("browserify-rsa"),a=e("elliptic").ec,o=e("bn.js"),l=e("parse-asn1"),c=e("./curves.json");function u(e,t,r,s){if((e=n.from(e.toArray())).length<t.byteLength()){var a=n.alloc(t.byteLength()-e.length);e=n.concat([a,e])}var o=r.length,l=function(e,t){e=(e=h(e,t)).mod(t);var r=n.from(e.toArray());if(r.length<t.byteLength()){var i=n.alloc(t.byteLength()-r.length);r=n.concat([i,r])}return r}(r,t),c=n.alloc(o);c.fill(1);var u=n.alloc(o);return u=i(s,u).update(c).update(n.from([0])).update(e).update(l).digest(),c=i(s,u).update(c).digest(),{k:u=i(s,u).update(c).update(n.from([1])).update(e).update(l).digest(),v:c=i(s,u).update(c).digest()}}function h(e,t){var r=new o(e),n=(e.length<<3)-t.bitLength();return n>0&&r.ishrn(n),r}function d(e,t,r){var s,a;do{for(s=n.alloc(0);8*s.length<e.bitLength();)t.v=i(r,t.k).update(t.v).digest(),s=n.concat([s,t.v]);a=h(s,e),t.k=i(r,t.k).update(t.v).update(n.from([0])).digest(),t.v=i(r,t.k).update(t.v).digest()}while(-1!==a.cmp(e));return a}function f(e,t,r,n){return e.toRed(o.mont(r)).redPow(t).fromRed().mod(n)}t.exports=function(e,t,r,i,p){var m=l(t);if(m.curve){if("ecdsa"!==i&&"ecdsa/rsa"!==i)throw new Error("wrong private key type");return function(e,t){var r=c[t.curve.join(".")];if(!r)throw new Error("unknown curve "+t.curve.join("."));var i=new a(r).keyFromPrivate(t.privateKey).sign(e);return n.from(i.toDER())}(e,m)}if("dsa"===m.type){if("dsa"!==i)throw new Error("wrong private key type");return function(e,t,r){for(var i,s=t.params.priv_key,a=t.params.p,l=t.params.q,c=t.params.g,p=new o(0),m=h(e,l).mod(l),g=!1,v=u(s,l,e,r);!1===g;)p=f(c,i=d(l,v,r),a,l),0===(g=i.invm(l).imul(m.add(s.mul(p))).mod(l)).cmpn(0)&&(g=!1,p=new o(0));return function(e,t){e=e.toArray(),t=t.toArray(),128&e[0]&&(e=[0].concat(e)),128&t[0]&&(t=[0].concat(t));var r=[48,e.length+t.length+4,2,e.length];return r=r.concat(e,[2,t.length],t),n.from(r)}(p,g)}(e,m,r)}if("rsa"!==i&&"ecdsa/rsa"!==i)throw new Error("wrong private key type");e=n.concat([p,e]);for(var g=m.modulus.byteLength(),v=[0,1];e.length+v.length+1<g;)v.push(255);v.push(0);for(var y=-1;++y<e.length;)v.push(e[y]);return s(v,m)},t.exports.getKey=u,t.exports.makeKey=d},{"./curves.json":212,"bn.js":186,"browserify-rsa":209,"create-hmac":388,elliptic:405,"parse-asn1":459,"safe-buffer":494}],215:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer,i=e("bn.js"),s=e("elliptic").ec,a=e("parse-asn1"),o=e("./curves.json");function l(e,t){if(e.cmpn(0)<=0)throw new Error("invalid sig");if(e.cmp(t)>=t)throw new Error("invalid sig")}t.exports=function(e,t,r,c,u){var h=a(r);if("ec"===h.type){if("ecdsa"!==c&&"ecdsa/rsa"!==c)throw new Error("wrong public key type");return function(e,t,r){var n=o[r.data.algorithm.curve.join(".")];if(!n)throw new Error("unknown curve "+r.data.algorithm.curve.join("."));var i=new s(n),a=r.data.subjectPrivateKey.data;return i.verify(t,e,a)}(e,t,h)}if("dsa"===h.type){if("dsa"!==c)throw new Error("wrong public key type");return function(e,t,r){var n=r.data.p,s=r.data.q,o=r.data.g,c=r.data.pub_key,u=a.signature.decode(e,"der"),h=u.s,d=u.r;l(h,s),l(d,s);var f=i.mont(n),p=h.invm(s);return 0===o.toRed(f).redPow(new i(t).mul(p).mod(s)).fromRed().mul(c.toRed(f).redPow(d.mul(p).mod(s)).fromRed()).mod(n).mod(s).cmp(d)}(e,t,h)}if("rsa"!==c&&"ecdsa/rsa"!==c)throw new Error("wrong public key type");t=n.concat([u,t]);for(var d=h.modulus.byteLength(),f=[1],p=0;t.length+f.length+2<d;)f.push(255),p++;f.push(0);for(var m=-1;++m<t.length;)f.push(t[m]);f=n.from(f);var g=i.mont(h.modulus);e=(e=new i(e).toRed(g)).redPow(new i(h.publicExponent)),e=n.from(e.fromRed().toArray());var v=p<8?1:0;for(d=Math.min(e.length,f.length),e.length!==f.length&&(v=1),m=-1;++m<d;)v|=e[m]^f[m];return 0===v}},{"./curves.json":212,"bn.js":186,elliptic:405,"parse-asn1":459,"safe-buffer":494}],216:[function(e,t,r){},{}],217:[function(e,t,r){"use strict";var n=e("buffer"),i=n.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=n:(s(n,r),r.Buffer=a),s(i,a),a.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},{buffer:220}],218:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=c,t=4;break;case"utf8":this.fillLast=o,t=4;break;case"base64":this.text=u,this.end=h,t=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function o(e){var t=this.lastTotal-this.lastNeed,r=function(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"\ufffd";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"\ufffd";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"\ufffd"}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function u(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}r.StringDecoder=s,s.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"\ufffd":t},s.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=a(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r||-2===i?0:(i=a(t[n]))>=0?(i>0&&(e.lastNeed=i-2),i):--n<r||-2===i?0:(i=a(t[n]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":217}],219:[function(e,t,r){(function(e){(function(){"use strict";t.exports=function(t,r){for(var n=Math.min(t.length,r.length),i=new e(n),s=0;s<n;++s)i[s]=t[s]^r[s];return i}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220}],220:[function(e,t,r){(function(t){(function(){"use strict";var t=e("base64-js"),n=e("ieee754");function i(e){if(e>2147483647)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=s.prototype,t}function s(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return l(e)}return a(e,t,r)}function a(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!s.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|h(e,t),n=i(r),a=n.write(e,t);return a!==r&&(n=n.slice(0,a)),n}(e,t);if(ArrayBuffer.isView(e))return c(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(z(e,ArrayBuffer)||e&&z(e.buffer,ArrayBuffer))return function(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r)).__proto__=s.prototype,n}(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return s.from(n,t,r);var a=function(e){if(s.isBuffer(e)){var t=0|u(e.length),r=i(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||F(e.length)?i(0):c(e):"Buffer"===e.type&&Array.isArray(e.data)?c(e.data):void 0}(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function o(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function l(e){return o(e),i(e<0?0:0|u(e))}function c(e){for(var t=e.length<0?0:0|u(e.length),r=i(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function u(e){if(e>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|e}function h(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||z(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return L(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return N(e).length;default:if(i)return n?-1:L(e).length;t=(""+t).toLowerCase(),i=!0}}function d(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return A(this,t,r);case"utf8":case"utf-8":return _(this,t,r);case"ascii":return C(this,t,r);case"latin1":case"binary":return E(this,t,r);case"base64":return S(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function f(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function p(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),F(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=s.from(t,n)),s.isBuffer(t))return 0===t.length?-1:m(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):m(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,r,n,i){var s,a=1,o=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,o/=2,l/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var u=-1;for(s=r;s<o;s++)if(c(e,s)===c(t,-1===u?0:s-u)){if(-1===u&&(u=s),s-u+1===l)return u*a}else-1!==u&&(s-=s-u),u=-1}else for(r+l>o&&(r=o-l),s=r;s>=0;s--){for(var h=!0,d=0;d<l;d++)if(c(e,s+d)!==c(t,d)){h=!1;break}if(h)return s}return-1}function g(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var s=t.length;n>s/2&&(n=s/2);for(var a=0;a<n;++a){var o=parseInt(t.substr(2*a,2),16);if(F(o))return a;e[r+a]=o}return a}function v(e,t,r,n){return B(L(t,e.length-r),e,r,n)}function y(e,t,r,n){return B(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function b(e,t,r,n){return y(e,t,r,n)}function w(e,t,r,n){return B(N(t),e,r,n)}function x(e,t,r,n){return B(function(e,t){for(var r,n,i,s=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,i=r%256,s.push(i),s.push(n);return s}(t,e.length-r),e,r,n)}function S(e,r,n){return 0===r&&n===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(r,n))}function _(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var s,a,o,l,c=e[i],u=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=r)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(s=e[i+1]))&&(l=(31&c)<<6|63&s)>127&&(u=l);break;case 3:s=e[i+1],a=e[i+2],128==(192&s)&&128==(192&a)&&(l=(15&c)<<12|(63&s)<<6|63&a)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:s=e[i+1],a=e[i+2],o=e[i+3],128==(192&s)&&128==(192&a)&&128==(192&o)&&(l=(15&c)<<18|(63&s)<<12|(63&a)<<6|63&o)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),i+=h}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=4096));return r}(n)}function C(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function E(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function A(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",s=t;s<r;++s)i+=R(e[s]);return i}function M(e,t,r){for(var n=e.slice(t,r),i="",s=0;s<n.length;s+=2)i+=String.fromCharCode(n[s]+256*n[s+1]);return i}function T(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,r,n,i,a){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function k(e,t,r,n,i,s){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function D(e,t,r,i,s){return t=+t,r>>>=0,s||k(e,0,r,4),n.write(e,t,r,i,23,4),r+4}function I(e,t,r,i,s){return t=+t,r>>>=0,s||k(e,0,r,8),n.write(e,t,r,i,52,8),r+8}r.Buffer=s,r.SlowBuffer=function(e){return+e!=e&&(e=0),s.alloc(+e)},r.INSPECT_MAX_BYTES=50,r.kMaxLength=2147483647,s.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),s.poolSize=8192,s.from=function(e,t,r){return a(e,t,r)},s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,s.alloc=function(e,t,r){return function(e,t,r){return o(e),e<=0?i(e):void 0!==t?"string"==typeof r?i(e).fill(t,r):i(e).fill(t):i(e)}(e,t,r)},s.allocUnsafe=function(e){return l(e)},s.allocUnsafeSlow=function(e){return l(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(z(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),z(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=s.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var a=e[r];if(z(a,Uint8Array)&&(a=s.from(a)),!s.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,i),i+=a.length}return n},s.byteLength=h,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)f(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)f(this,t,t+3),f(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)f(this,t,t+7),f(this,t+1,t+6),f(this,t+2,t+5),f(this,t+3,t+4);return this},s.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?_(this,0,e):d.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},s.prototype.compare=function(e,t,r,n,i){if(z(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0),l=Math.min(a,o),c=this.slice(n,i),u=e.slice(t,r),h=0;h<l;++h)if(c[h]!==u[h]){a=c[h],o=u[h];break}return a<o?-1:o<a?1:0},s.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},s.prototype.indexOf=function(e,t,r){return p(this,e,t,r,!0)},s.prototype.lastIndexOf=function(e,t,r){return p(this,e,t,r,!1)},s.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return g(this,e,t,r);case"utf8":case"utf-8":return v(this,e,t,r);case"ascii":return y(this,e,t,r);case"latin1":case"binary":return b(this,e,t,r);case"base64":return w(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return n.__proto__=s.prototype,n},s.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||T(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return n},s.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||T(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},s.prototype.readUInt8=function(e,t){return e>>>=0,t||T(e,1,this.length),this[e]},s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||T(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||T(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||T(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||T(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||T(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},s.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||T(e,t,this.length);for(var n=t,i=1,s=this[e+--n];n>0&&(i*=256);)s+=this[e+--n]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*t)),s},s.prototype.readInt8=function(e,t){return e>>>=0,t||T(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||T(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(e,t){e>>>=0,t||T(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||T(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||T(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return e>>>=0,t||T(e,4,this.length),n.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||T(e,4,this.length),n.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||T(e,8,this.length),n.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||T(e,8,this.length),n.read(this,e,!1,52,8)},s.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||P(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,s=0;for(this[t]=255&e;++s<r&&(i*=256);)this[t+s]=e/i&255;return t+r},s.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||P(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+r},s.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);P(this,e,t,r,i-1,-i)}var s=0,a=1,o=0;for(this[t]=255&e;++s<r&&(a*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/a|0)-o&255;return t+r},s.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);P(this,e,t,r,i-1,-i)}var s=r-1,a=1,o=0;for(this[t+s]=255&e;--s>=0&&(a*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/a|0)-o&255;return t+r},s.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeFloatLE=function(e,t,r){return D(this,e,t,!0,r)},s.prototype.writeFloatBE=function(e,t,r){return D(this,e,t,!1,r)},s.prototype.writeDoubleLE=function(e,t,r){return I(this,e,t,!0,r)},s.prototype.writeDoubleBE=function(e,t,r){return I(this,e,t,!1,r)},s.prototype.copy=function(e,t,r,n){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var a=i-1;a>=0;--a)e[a+t]=this[a+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return i},s.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!s.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var a;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(a=t;a<r;++a)this[a]=e;else{var o=s.isBuffer(e)?e:s.from(e,n),l=o.length;if(0===l)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<r-t;++a)this[a+t]=o[a%l]}return this};var O=/[^+/0-9A-Za-z-_]/g;function R(e){return e<16?"0"+e.toString(16):e.toString(16)}function L(e,t){var r;t=t||1/0;for(var n=e.length,i=null,s=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function N(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(O,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function B(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function z(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function F(e){return e!=e}}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":185,buffer:220,ieee754:439}],221:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer,i=e("stream").Transform,s=e("string_decoder").StringDecoder;function a(e){i.call(this),this.hashMode="string"==typeof e,this.hashMode?this[e]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}e("inherits")(a,i),a.prototype.update=function(e,t,r){"string"==typeof e&&(e=n.from(e,t));var i=this._update(e);return this.hashMode?this:(r&&(i=this._toString(i,r)),i)},a.prototype.setAutoPadding=function(){},a.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},a.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},a.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},a.prototype._transform=function(e,t,r){var n;try{this.hashMode?this._update(e):this.push(this._update(e))}catch(e){n=e}finally{r(n)}},a.prototype._flush=function(e){var t;try{this.push(this.__final())}catch(e){t=e}e(t)},a.prototype._finalOrDigest=function(e){var t=this.__final()||n.alloc(0);return e&&(t=this._toString(t,e,!0)),t},a.prototype._toString=function(e,t,r){if(this._decoder||(this._decoder=new s(t),this._encoding=t),this._encoding!==t)throw new Error("can't switch encodings");var n=this._decoder.write(e);return r&&(n+=this._decoder.end()),n},t.exports=a},{inherits:440,"safe-buffer":494,stream:505,string_decoder:218}],222:[function(e,t,r){"use strict";var n=e("../internals/is-callable"),i=e("../internals/try-to-string"),s=TypeError;t.exports=function(e){if(n(e))return e;throw new s(i(e)+" is not a function")}},{"../internals/is-callable":285,"../internals/try-to-string":349}],223:[function(e,t,r){"use strict";var n=e("../internals/is-constructor"),i=e("../internals/try-to-string"),s=TypeError;t.exports=function(e){if(n(e))return e;throw new s(i(e)+" is not a constructor")}},{"../internals/is-constructor":286,"../internals/try-to-string":349}],224:[function(e,t,r){"use strict";var n=e("../internals/is-callable"),i=String,s=TypeError;t.exports=function(e){if("object"==typeof e||n(e))return e;throw new s("Can't set "+i(e)+" as a prototype")}},{"../internals/is-callable":285}],225:[function(e,t,r){"use strict";var n=e("../internals/well-known-symbol"),i=e("../internals/object-create"),s=e("../internals/object-define-property").f,a=n("unscopables"),o=Array.prototype;void 0===o[a]&&s(o,a,{configurable:!0,value:i(null)}),t.exports=function(e){o[a][e]=!0}},{"../internals/object-create":306,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],226:[function(e,t,r){"use strict";var n=e("../internals/object-is-prototype-of"),i=TypeError;t.exports=function(e,t){if(n(t,e))return e;throw new i("Incorrect invocation")}},{"../internals/object-is-prototype-of":314}],227:[function(e,t,r){"use strict";var n=e("../internals/is-object"),i=String,s=TypeError;t.exports=function(e){if(n(e))return e;throw new s(i(e)+" is not an object")}},{"../internals/is-object":289}],228:[function(e,t,r){"use strict";var n=e("../internals/to-indexed-object"),i=e("../internals/to-absolute-index"),s=e("../internals/length-of-array-like"),a=function(e){return function(t,r,a){var o,l=n(t),c=s(l),u=i(a,c);if(e&&r!=r){for(;c>u;)if((o=l[u++])!=o)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===r)return e||u||0;return!e&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},{"../internals/length-of-array-like":299,"../internals/to-absolute-index":340,"../internals/to-indexed-object":341}],229:[function(e,t,r){"use strict";var n=e("../internals/function-bind-context"),i=e("../internals/function-uncurry-this"),s=e("../internals/indexed-object"),a=e("../internals/to-object"),o=e("../internals/length-of-array-like"),l=e("../internals/array-species-create"),c=i([].push),u=function(e){var t=1===e,r=2===e,i=3===e,u=4===e,h=6===e,d=7===e,f=5===e||h;return function(p,m,g,v){for(var y,b,w=a(p),x=s(w),S=n(m,g),_=o(x),C=0,E=v||l,A=t?E(p,_):r||d?E(p,0):void 0;_>C;C++)if((f||C in x)&&(b=S(y=x[C],C,w),e))if(t)A[C]=b;else if(b)switch(e){case 3:return!0;case 5:return y;case 6:return C;case 2:c(A,y)}else switch(e){case 4:return!1;case 7:c(A,y)}return h?-1:i||u?u:A}};t.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}},{"../internals/array-species-create":233,"../internals/function-bind-context":262,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/length-of-array-like":299,"../internals/to-object":344}],230:[function(e,t,r){"use strict";var n=e("../internals/to-absolute-index"),i=e("../internals/length-of-array-like"),s=e("../internals/create-property"),a=Array,o=Math.max;t.exports=function(e,t,r){for(var l=i(e),c=n(t,l),u=n(void 0===r?l:r,l),h=a(o(u-c,0)),d=0;c<u;c++,d++)s(h,d,e[c]);return h.length=d,h}},{"../internals/create-property":243,"../internals/length-of-array-like":299,"../internals/to-absolute-index":340}],231:[function(e,t,r){"use strict";var n=e("../internals/function-uncurry-this");t.exports=n([].slice)},{"../internals/function-uncurry-this":268}],232:[function(e,t,r){"use strict";var n=e("../internals/is-array"),i=e("../internals/is-constructor"),s=e("../internals/is-object"),a=e("../internals/well-known-symbol")("species"),o=Array;t.exports=function(e){var t;return n(e)&&(t=e.constructor,(i(t)&&(t===o||n(t.prototype))||s(t)&&null===(t=t[a]))&&(t=void 0)),void 0===t?o:t}},{"../internals/is-array":284,"../internals/is-constructor":286,"../internals/is-object":289,"../internals/well-known-symbol":357}],233:[function(e,t,r){"use strict";var n=e("../internals/array-species-constructor");t.exports=function(e,t){return new(n(e))(0===t?0:t)}},{"../internals/array-species-constructor":232}],234:[function(e,t,r){"use strict";var n=e("../internals/well-known-symbol")("iterator"),i=!1;try{var s=0,a={next:function(){return{done:!!s++}},return:function(){i=!0}};a[n]=function(){return this},Array.from(a,(function(){throw 2}))}catch(e){}t.exports=function(e,t){try{if(!t&&!i)return!1}catch(e){return!1}var r=!1;try{var s={};s[n]=function(){return{next:function(){return{done:r=!0}}}},e(s)}catch(e){}return r}},{"../internals/well-known-symbol":357}],235:[function(e,t,r){"use strict";var n=e("../internals/function-uncurry-this"),i=n({}.toString),s=n("".slice);t.exports=function(e){return s(i(e),8,-1)}},{"../internals/function-uncurry-this":268}],236:[function(e,t,r){"use strict";var n=e("../internals/to-string-tag-support"),i=e("../internals/is-callable"),s=e("../internals/classof-raw"),a=e("../internals/well-known-symbol")("toStringTag"),o=Object,l="Arguments"===s(function(){return arguments}());t.exports=n?s:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=o(e),a))?r:l?s(t):"Object"===(n=s(t))&&i(t.callee)?"Arguments":n}},{"../internals/classof-raw":235,"../internals/is-callable":285,"../internals/to-string-tag-support":347,"../internals/well-known-symbol":357}],237:[function(e,t,r){"use strict";var n=e("../internals/has-own-property"),i=e("../internals/own-keys"),s=e("../internals/object-get-own-property-descriptor"),a=e("../internals/object-define-property");t.exports=function(e,t,r){for(var o=i(t),l=a.f,c=s.f,u=0;u<o.length;u++){var h=o[u];n(e,h)||r&&n(r,h)||l(e,h,c(t,h))}}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/own-keys":321}],238:[function(e,t,r){"use strict";var n=e("../internals/well-known-symbol")("match");t.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[n]=!1,"/./"[e](t)}catch(e){}}return!1}},{"../internals/well-known-symbol":357}],239:[function(e,t,r){"use strict";var n=e("../internals/fails");t.exports=!n((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},{"../internals/fails":260}],240:[function(e,t,r){"use strict";t.exports=function(e,t){return{value:e,done:t}}},{}],241:[function(e,t,r){"use strict";var n=e("../internals/descriptors"),i=e("../internals/object-define-property"),s=e("../internals/create-property-descriptor");t.exports=n?function(e,t,r){return i.f(e,t,s(1,r))}:function(e,t,r){return e[t]=r,e}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/object-define-property":308}],242:[function(e,t,r){"use strict";t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],243:[function(e,t,r){"use strict";var n=e("../internals/to-property-key"),i=e("../internals/object-define-property"),s=e("../internals/create-property-descriptor");t.exports=function(e,t,r){var a=n(t);a in e?i.f(e,a,s(0,r)):e[a]=r}},{"../internals/create-property-descriptor":242,"../internals/object-define-property":308,"../internals/to-property-key":346}],244:[function(e,t,r){"use strict";var n=e("../internals/make-built-in"),i=e("../internals/object-define-property");t.exports=function(e,t,r){return r.get&&n(r.get,t,{getter:!0}),r.set&&n(r.set,t,{setter:!0}),i.f(e,t,r)}},{"../internals/make-built-in":300,"../internals/object-define-property":308}],245:[function(e,t,r){"use strict";var n=e("../internals/is-callable"),i=e("../internals/object-define-property"),s=e("../internals/make-built-in"),a=e("../internals/define-global-property");t.exports=function(e,t,r,o){o||(o={});var l=o.enumerable,c=void 0!==o.name?o.name:t;if(n(r)&&s(r,c,o),o.global)l?e[t]=r:a(t,r);else{try{o.unsafe?e[t]&&(l=!0):delete e[t]}catch(e){}l?e[t]=r:i.f(e,t,{value:r,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return e}},{"../internals/define-global-property":246,"../internals/is-callable":285,"../internals/make-built-in":300,"../internals/object-define-property":308}],246:[function(e,t,r){"use strict";var n=e("../internals/global"),i=Object.defineProperty;t.exports=function(e,t){try{i(n,e,{value:t,configurable:!0,writable:!0})}catch(r){n[e]=t}return t}},{"../internals/global":274}],247:[function(e,t,r){"use strict";var n=e("../internals/fails");t.exports=!n((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},{"../internals/fails":260}],248:[function(e,t,r){"use strict";var n="object"==typeof document&&document.all,i=void 0===n&&void 0!==n;t.exports={all:n,IS_HTMLDDA:i}},{}],249:[function(e,t,r){"use strict";var n=e("../internals/global"),i=e("../internals/is-object"),s=n.document,a=i(s)&&i(s.createElement);t.exports=function(e){return a?s.createElement(e):{}}},{"../internals/global":274,"../internals/is-object":289}],250:[function(e,t,r){"use strict";var n=e("../internals/engine-is-deno"),i=e("../internals/engine-is-node");t.exports=!n&&!i&&"object"==typeof window&&"object"==typeof document},{"../internals/engine-is-deno":251,"../internals/engine-is-node":254}],251:[function(e,t,r){"use strict";t.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},{}],252:[function(e,t,r){"use strict";var n=e("../internals/engine-user-agent");t.exports=/ipad|iphone|ipod/i.test(n)&&"undefined"!=typeof Pebble},{"../internals/engine-user-agent":256}],253:[function(e,t,r){"use strict";var n=e("../internals/engine-user-agent");t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(n)},{"../internals/engine-user-agent":256}],254:[function(e,t,r){"use strict";var n=e("../internals/global"),i=e("../internals/classof-raw");t.exports="process"===i(n.process)},{"../internals/classof-raw":235,"../internals/global":274}],255:[function(e,t,r){"use strict";var n=e("../internals/engine-user-agent");t.exports=/web0s(?!.*chrome)/i.test(n)},{"../internals/engine-user-agent":256}],256:[function(e,t,r){"use strict";t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},{}],257:[function(e,t,r){"use strict";var n,i,s=e("../internals/global"),a=e("../internals/engine-user-agent"),o=s.process,l=s.Deno,c=o&&o.versions||l&&l.version,u=c&&c.v8;u&&(i=(n=u.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!i&&a&&(!(n=a.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=a.match(/Chrome\/(\d+)/))&&(i=+n[1]),t.exports=i},{"../internals/engine-user-agent":256,"../internals/global":274}],258:[function(e,t,r){"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],259:[function(e,t,r){"use strict";var n=e("../internals/global"),i=e("../internals/object-get-own-property-descriptor").f,s=e("../internals/create-non-enumerable-property"),a=e("../internals/define-built-in"),o=e("../internals/define-global-property"),l=e("../internals/copy-constructor-properties"),c=e("../internals/is-forced");t.exports=function(e,t){var r,u,h,d,f,p=e.target,m=e.global,g=e.stat;if(r=m?n:g?n[p]||o(p,{}):(n[p]||{}).prototype)for(u in t){if(d=t[u],h=e.dontCallGetSet?(f=i(r,u))&&f.value:r[u],!c(m?u:p+(g?".":"#")+u,e.forced)&&void 0!==h){if(typeof d==typeof h)continue;l(d,h)}(e.sham||h&&h.sham)&&s(d,"sham",!0),a(r,u,d,e)}}},{"../internals/copy-constructor-properties":237,"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/define-global-property":246,"../internals/global":274,"../internals/is-forced":287,"../internals/object-get-own-property-descriptor":309}],260:[function(e,t,r){"use strict";t.exports=function(e){try{return!!e()}catch(e){return!0}}},{}],261:[function(e,t,r){"use strict";var n=e("../internals/function-bind-native"),i=Function.prototype,s=i.apply,a=i.call;t.exports="object"==typeof Reflect&&Reflect.apply||(n?a.bind(s):function(){return a.apply(s,arguments)})},{"../internals/function-bind-native":263}],262:[function(e,t,r){"use strict";var n=e("../internals/function-uncurry-this-clause"),i=e("../internals/a-callable"),s=e("../internals/function-bind-native"),a=n(n.bind);t.exports=function(e,t){return i(e),void 0===t?e:s?a(e,t):function(){return e.apply(t,arguments)}}},{"../internals/a-callable":222,"../internals/function-bind-native":263,"../internals/function-uncurry-this-clause":267}],263:[function(e,t,r){"use strict";var n=e("../internals/fails");t.exports=!n((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},{"../internals/fails":260}],264:[function(e,t,r){"use strict";var n=e("../internals/function-bind-native"),i=Function.prototype.call;t.exports=n?i.bind(i):function(){return i.apply(i,arguments)}},{"../internals/function-bind-native":263}],265:[function(e,t,r){"use strict";var n=e("../internals/descriptors"),i=e("../internals/has-own-property"),s=Function.prototype,a=n&&Object.getOwnPropertyDescriptor,o=i(s,"name"),l=o&&"something"===function(){}.name,c=o&&(!n||n&&a(s,"name").configurable);t.exports={EXISTS:o,PROPER:l,CONFIGURABLE:c}},{"../internals/descriptors":247,"../internals/has-own-property":275}],266:[function(e,t,r){"use strict";var n=e("../internals/function-uncurry-this"),i=e("../internals/a-callable");t.exports=function(e,t,r){try{return n(i(Object.getOwnPropertyDescriptor(e,t)[r]))}catch(e){}}},{"../internals/a-callable":222,"../internals/function-uncurry-this":268}],267:[function(e,t,r){"use strict";var n=e("../internals/classof-raw"),i=e("../internals/function-uncurry-this");t.exports=function(e){if("Function"===n(e))return i(e)}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268}],268:[function(e,t,r){"use strict";var n=e("../internals/function-bind-native"),i=Function.prototype,s=i.call,a=n&&i.bind.bind(s,s);t.exports=n?a:function(e){return function(){return s.apply(e,arguments)}}},{"../internals/function-bind-native":263}],269:[function(e,t,r){"use strict";var n=e("../internals/global"),i=e("../internals/is-callable"),s=function(e){return i(e)?e:void 0};t.exports=function(e,t){return arguments.length<2?s(n[e]):n[e]&&n[e][t]}},{"../internals/global":274,"../internals/is-callable":285}],270:[function(e,t,r){"use strict";var n=e("../internals/classof"),i=e("../internals/get-method"),s=e("../internals/is-null-or-undefined"),a=e("../internals/iterators"),o=e("../internals/well-known-symbol")("iterator");t.exports=function(e){if(!s(e))return i(e,o)||i(e,"@@iterator")||a[n(e)]}},{"../internals/classof":236,"../internals/get-method":273,"../internals/is-null-or-undefined":288,"../internals/iterators":298,"../internals/well-known-symbol":357}],271:[function(e,t,r){"use strict";var n=e("../internals/function-call"),i=e("../internals/a-callable"),s=e("../internals/an-object"),a=e("../internals/try-to-string"),o=e("../internals/get-iterator-method"),l=TypeError;t.exports=function(e,t){var r=arguments.length<2?o(e):t;if(i(r))return s(n(r,e));throw new l(a(e)+" is not iterable")}},{"../internals/a-callable":222,"../internals/an-object":227,"../internals/function-call":264,"../internals/get-iterator-method":270,"../internals/try-to-string":349}],272:[function(e,t,r){"use strict";var n=e("../internals/function-uncurry-this"),i=e("../internals/is-array"),s=e("../internals/is-callable"),a=e("../internals/classof-raw"),o=e("../internals/to-string"),l=n([].push);t.exports=function(e){if(s(e))return e;if(i(e)){for(var t=e.length,r=[],n=0;n<t;n++){var c=e[n];"string"==typeof c?l(r,c):"number"!=typeof c&&"Number"!==a(c)&&"String"!==a(c)||l(r,o(c))}var u=r.length,h=!0;return function(e,t){if(h)return h=!1,t;if(i(this))return t;for(var n=0;n<u;n++)if(r[n]===e)return t}}}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268,"../internals/is-array":284,"../internals/is-callable":285,"../internals/to-string":348}],273:[function(e,t,r){"use strict";var n=e("../internals/a-callable"),i=e("../internals/is-null-or-undefined");t.exports=function(e,t){var r=e[t];return i(r)?void 0:n(r)}},{"../internals/a-callable":222,"../internals/is-null-or-undefined":288}],274:[function(e,t,n){(function(e){(function(){"use strict";var r=function(e){return e&&e.Math===Math&&e};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof e&&e)||function(){return this}()||this||Function("return this")()}).call(this)}).call(this,"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],275:[function(e,t,r){"use strict";var n=e("../internals/function-uncurry-this"),i=e("../internals/to-object"),s=n({}.hasOwnProperty);t.exports=Object.hasOwn||function(e,t){return s(i(e),t)}},{"../internals/function-uncurry-this":268,"../internals/to-object":344}],276:[function(e,t,r){"use strict";t.exports={}},{}],277:[function(e,t,r){"use strict";t.exports=function(e,t){try{1===arguments.length?console.error(e):console.error(e,t)}catch(e){}}},{}],278:[function(e,t,r){"use strict";var n=e("../internals/get-built-in");t.exports=n("document","documentElement")},{"../internals/get-built-in":269}],279:[function(e,t,r){"use strict";var n=e("../internals/descriptors"),i=e("../internals/fails"),s=e("../internals/document-create-element");t.exports=!n&&!i((function(){return 7!==Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},{"../internals/descriptors":247,"../internals/document-create-element":249,"../internals/fails":260}],280:[function(e,t,r){"use strict";var n=e("../internals/function-uncurry-this"),i=e("../internals/fails"),s=e("../internals/classof-raw"),a=Object,o=n("".split);t.exports=i((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"===s(e)?o(e,""):a(e)}:a},{"../internals/classof-raw":235,"../internals/fails":260,"../internals/function-uncurry-this":268}],281:[function(e,t,r){"use strict";var n=e("../internals/function-uncurry-this"),i=e("../internals/is-callable"),s=e("../internals/shared-store"),a=n(Function.toString);i(s.inspectSource)||(s.inspectSource=function(e){return a(e)}),t.exports=s.inspectSource},{"../internals/function-uncurry-this":268,"../internals/is-callable":285,"../internals/shared-store":333}],282:[function(e,t,r){"use strict";var n,i,s,a=e("../internals/weak-map-basic-detection"),o=e("../internals/global"),l=e("../internals/is-object"),c=e("../internals/create-non-enumerable-property"),u=e("../internals/has-own-property"),h=e("../internals/shared-store"),d=e("../internals/shared-key"),f=e("../internals/hidden-keys"),p=o.TypeError,m=o.WeakMap;if(a||h.state){var g=h.state||(h.state=new m);g.get=g.get,g.has=g.has,g.set=g.set,n=function(e,t){if(g.has(e))throw new p("Object already initialized");return t.facade=e,g.set(e,t),t},i=function(e){return g.get(e)||{}},s=function(e){return g.has(e)}}else{var v=d("state");f[v]=!0,n=function(e,t){if(u(e,v))throw new p("Object already initialized");return t.facade=e,c(e,v,t),t},i=function(e){return u(e,v)?e[v]:{}},s=function(e){return u(e,v)}}t.exports={set:n,get:i,has:s,enforce:function(e){return s(e)?i(e):n(e,{})},getterFor:function(e){return function(t){var r;if(!l(t)||(r=i(t)).type!==e)throw new p("Incompatible receiver, "+e+" required");return r}}}},{"../internals/create-non-enumerable-property":241,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/is-object":289,"../internals/shared-key":332,"../internals/shared-store":333,"../internals/weak-map-basic-detection":354}],283:[function(e,t,r){"use strict";var n=e("../internals/well-known-symbol"),i=e("../internals/iterators"),s=n("iterator"),a=Array.prototype;t.exports=function(e){return void 0!==e&&(i.Array===e||a[s]===e)}},{"../internals/iterators":298,"../internals/well-known-symbol":357}],284:[function(e,t,r){"use strict";var n=e("../internals/classof-raw");t.exports=Array.isArray||function(e){return"Array"===n(e)}},{"../internals/classof-raw":235}],285:[function(e,t,r){"use strict";var n=e("../internals/document-all"),i=n.all;t.exports=n.IS_HTMLDDA?function(e){return"function"==typeof e||e===i}:function(e){return"function"==typeof e}},{"../internals/document-all":248}],286:[function(e,t,r){"use strict";var n=e("../internals/function-uncurry-this"),i=e("../internals/fails"),s=e("../internals/is-callable"),a=e("../internals/classof"),o=e("../internals/get-built-in"),l=e("../internals/inspect-source"),c=function(){},u=[],h=o("Reflect","construct"),d=/^\s*(?:class|function)\b/,f=n(d.exec),p=!d.test(c),m=function(e){if(!s(e))return!1;try{return h(c,u,e),!0}catch(e){return!1}},g=function(e){if(!s(e))return!1;switch(a(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return p||!!f(d,l(e))}catch(e){return!0}};g.sham=!0,t.exports=!h||i((function(){var e;return m(m.call)||!m(Object)||!m((function(){e=!0}))||e}))?g:m},{"../internals/classof":236,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/inspect-source":281,"../internals/is-callable":285}],287:[function(e,t,r){"use strict";var n=e("../internals/fails"),i=e("../internals/is-callable"),s=/#|\.prototype\./,a=function(e,t){var r=l[o(e)];return r===u||r!==c&&(i(t)?n(t):!!t)},o=a.normalize=function(e){return String(e).replace(s,".").toLowerCase()},l=a.data={},c=a.NATIVE="N",u=a.POLYFILL="P";t.exports=a},{"../internals/fails":260,"../internals/is-callable":285}],288:[function(e,t,r){"use strict";t.exports=function(e){return null==e}},{}],289:[function(e,t,r){"use strict";var n=e("../internals/is-callable"),i=e("../internals/document-all"),s=i.all;t.exports=i.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:n(e)||e===s}:function(e){return"object"==typeof e?null!==e:n(e)}},{"../internals/document-all":248,"../internals/is-callable":285}],290:[function(e,t,r){"use strict";t.exports=!1},{}],291:[function(e,t,r){"use strict";var n=e("../internals/is-object"),i=e("../internals/classof-raw"),s=e("../internals/well-known-symbol")("match");t.exports=function(e){var t;return n(e)&&(void 0!==(t=e[s])?!!t:"RegExp"===i(e))}},{"../internals/classof-raw":235,"../internals/is-object":289,"../internals/well-known-symbol":357}],292:[function(e,t,r){"use strict";var n=e("../internals/get-built-in"),i=e("../internals/is-callable"),s=e("../internals/object-is-prototype-of"),a=e("../internals/use-symbol-as-uid"),o=Object;t.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=n("Symbol");return i(t)&&s(t.prototype,o(e))}},{"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/object-is-prototype-of":314,"../internals/use-symbol-as-uid":351}],293:[function(e,t,r){"use strict";var n=e("../internals/function-bind-context"),i=e("../internals/function-call"),s=e("../internals/an-object"),a=e("../internals/try-to-string"),o=e("../internals/is-array-iterator-method"),l=e("../internals/length-of-array-like"),c=e("../internals/object-is-prototype-of"),u=e("../internals/get-iterator"),h=e("../internals/get-iterator-method"),d=e("../internals/iterator-close"),f=TypeError,p=function(e,t){this.stopped=e,this.result=t},m=p.prototype;t.exports=function(e,t,r){var g,v,y,b,w,x,S,_=r&&r.that,C=!(!r||!r.AS_ENTRIES),E=!(!r||!r.IS_RECORD),A=!(!r||!r.IS_ITERATOR),M=!(!r||!r.INTERRUPTED),T=n(t,_),P=function(e){return g&&d(g,"normal",e),new p(!0,e)},k=function(e){return C?(s(e),M?T(e[0],e[1],P):T(e[0],e[1])):M?T(e,P):T(e)};if(E)g=e.iterator;else if(A)g=e;else{if(!(v=h(e)))throw new f(a(e)+" is not iterable");if(o(v)){for(y=0,b=l(e);b>y;y++)if((w=k(e[y]))&&c(m,w))return w;return new p(!1)}g=u(e,v)}for(x=E?e.next:g.next;!(S=i(x,g)).done;){try{w=k(S.value)}catch(e){d(g,"throw",e)}if("object"==typeof w&&w&&c(m,w))return w}return new p(!1)}},{"../internals/an-object":227,"../internals/function-bind-context":262,"../internals/function-call":264,"../internals/get-iterator":271,"../internals/get-iterator-method":270,"../internals/is-array-iterator-method":283,"../internals/iterator-close":294,"../internals/length-of-array-like":299,"../internals/object-is-prototype-of":314,"../internals/try-to-string":349}],294:[function(e,t,r){"use strict";var n=e("../internals/function-call"),i=e("../internals/an-object"),s=e("../internals/get-method");t.exports=function(e,t,r){var a,o;i(e);try{if(!(a=s(e,"return"))){if("throw"===t)throw r;return r}a=n(a,e)}catch(e){o=!0,a=e}if("throw"===t)throw r;if(o)throw a;return i(a),r}},{"../internals/an-object":227,"../internals/function-call":264,"../internals/get-method":273}],295:[function(e,t,r){"use strict";var n=e("../internals/iterators-core").IteratorPrototype,i=e("../internals/object-create"),s=e("../internals/create-property-descriptor"),a=e("../internals/set-to-string-tag"),o=e("../internals/iterators"),l=function(){return this};t.exports=function(e,t,r,c){var u=t+" Iterator";return e.prototype=i(n,{next:s(+!c,r)}),a(e,u,!1,!0),o[u]=l,e}},{"../internals/create-property-descriptor":242,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-create":306,"../internals/set-to-string-tag":331}],296:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/function-call"),s=e("../internals/is-pure"),a=e("../internals/function-name"),o=e("../internals/is-callable"),l=e("../internals/iterator-create-constructor"),c=e("../internals/object-get-prototype-of"),u=e("../internals/object-set-prototype-of"),h=e("../internals/set-to-string-tag"),d=e("../internals/create-non-enumerable-property"),f=e("../internals/define-built-in"),p=e("../internals/well-known-symbol"),m=e("../internals/iterators"),g=e("../internals/iterators-core"),v=a.PROPER,y=a.CONFIGURABLE,b=g.IteratorPrototype,w=g.BUGGY_SAFARI_ITERATORS,x=p("iterator"),S=function(){return this};t.exports=function(e,t,r,a,p,g,_){l(r,t,a);var C,E,A,M=function(e){if(e===p&&I)return I;if(!w&&e&&e in k)return k[e];switch(e){case"keys":case"values":case"entries":return function(){return new r(this,e)}}return function(){return new r(this)}},T=t+" Iterator",P=!1,k=e.prototype,D=k[x]||k["@@iterator"]||p&&k[p],I=!w&&D||M(p),O="Array"===t&&k.entries||D;if(O&&(C=c(O.call(new e)))!==Object.prototype&&C.next&&(s||c(C)===b||(u?u(C,b):o(C[x])||f(C,x,S)),h(C,T,!0,!0),s&&(m[T]=S)),v&&"values"===p&&D&&"values"!==D.name&&(!s&&y?d(k,"name","values"):(P=!0,I=function(){return i(D,this)})),p)if(E={values:M("values"),keys:g?I:M("keys"),entries:M("entries")},_)for(A in E)(w||P||!(A in k))&&f(k,A,E[A]);else n({target:t,proto:!0,forced:w||P},E);return s&&!_||k[x]===I||f(k,x,I,{name:p}),m[t]=I,E}},{"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/export":259,"../internals/function-call":264,"../internals/function-name":265,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/iterator-create-constructor":295,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-get-prototype-of":313,"../internals/object-set-prototype-of":318,"../internals/set-to-string-tag":331,"../internals/well-known-symbol":357}],297:[function(e,t,r){"use strict";var n,i,s,a=e("../internals/fails"),o=e("../internals/is-callable"),l=e("../internals/is-object"),c=e("../internals/object-create"),u=e("../internals/object-get-prototype-of"),h=e("../internals/define-built-in"),d=e("../internals/well-known-symbol"),f=e("../internals/is-pure"),p=d("iterator"),m=!1;[].keys&&("next"in(s=[].keys())?(i=u(u(s)))!==Object.prototype&&(n=i):m=!0),!l(n)||a((function(){var e={};return n[p].call(e)!==e}))?n={}:f&&(n=c(n)),o(n[p])||h(n,p,(function(){return this})),t.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:m}},{"../internals/define-built-in":245,"../internals/fails":260,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-get-prototype-of":313,"../internals/well-known-symbol":357}],298:[function(e,t,r){arguments[4][276][0].apply(r,arguments)},{dup:276}],299:[function(e,t,r){"use strict";var n=e("../internals/to-length");t.exports=function(e){return n(e.length)}},{"../internals/to-length":343}],300:[function(e,t,r){"use strict";var n=e("../internals/function-uncurry-this"),i=e("../internals/fails"),s=e("../internals/is-callable"),a=e("../internals/has-own-property"),o=e("../internals/descriptors"),l=e("../internals/function-name").CONFIGURABLE,c=e("../internals/inspect-source"),u=e("../internals/internal-state"),h=u.enforce,d=u.get,f=String,p=Object.defineProperty,m=n("".slice),g=n("".replace),v=n([].join),y=o&&!i((function(){return 8!==p((function(){}),"length",{value:8}).length})),b=String(String).split("String"),w=t.exports=function(e,t,r){"Symbol("===m(f(t),0,7)&&(t="["+g(f(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!a(e,"name")||l&&e.name!==t)&&(o?p(e,"name",{value:t,configurable:!0}):e.name=t),y&&r&&a(r,"arity")&&e.length!==r.arity&&p(e,"length",{value:r.arity});try{r&&a(r,"constructor")&&r.constructor?o&&p(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var n=h(e);return a(n,"source")||(n.source=v(b,"string"==typeof t?t:"")),e};Function.prototype.toString=w((function(){return s(this)&&d(this).source||c(this)}),"toString")},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-name":265,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/inspect-source":281,"../internals/internal-state":282,"../internals/is-callable":285}],301:[function(e,t,r){"use strict";var n=Math.ceil,i=Math.floor;t.exports=Math.trunc||function(e){var t=+e;return(t>0?i:n)(t)}},{}],302:[function(e,t,r){"use strict";var n,i,s,a,o,l=e("../internals/global"),c=e("../internals/function-bind-context"),u=e("../internals/object-get-own-property-descriptor").f,h=e("../internals/task").set,d=e("../internals/queue"),f=e("../internals/engine-is-ios"),p=e("../internals/engine-is-ios-pebble"),m=e("../internals/engine-is-webos-webkit"),g=e("../internals/engine-is-node"),v=l.MutationObserver||l.WebKitMutationObserver,y=l.document,b=l.process,w=l.Promise,x=u(l,"queueMicrotask"),S=x&&x.value;if(!S){var _=new d,C=function(){var e,t;for(g&&(e=b.domain)&&e.exit();t=_.get();)try{t()}catch(e){throw _.head&&n(),e}e&&e.enter()};f||g||m||!v||!y?!p&&w&&w.resolve?((a=w.resolve(void 0)).constructor=w,o=c(a.then,a),n=function(){o(C)}):g?n=function(){b.nextTick(C)}:(h=c(h,l),n=function(){h(C)}):(i=!0,s=y.createTextNode(""),new v(C).observe(s,{characterData:!0}),n=function(){s.data=i=!i}),S=function(e){_.head||n(),_.add(e)}}t.exports=S},{"../internals/engine-is-ios":253,"../internals/engine-is-ios-pebble":252,"../internals/engine-is-node":254,"../internals/engine-is-webos-webkit":255,"../internals/function-bind-context":262,"../internals/global":274,"../internals/object-get-own-property-descriptor":309,"../internals/queue":328,"../internals/task":339}],303:[function(e,t,r){"use strict";var n=e("../internals/a-callable"),i=TypeError,s=function(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw new i("Bad Promise constructor");t=e,r=n})),this.resolve=n(t),this.reject=n(r)};t.exports.f=function(e){return new s(e)}},{"../internals/a-callable":222}],304:[function(e,t,r){"use strict";var n=e("../internals/is-regexp"),i=TypeError;t.exports=function(e){if(n(e))throw new i("The method doesn't accept regular expressions");return e}},{"../internals/is-regexp":291}],305:[function(e,t,r){"use strict";var n=e("../internals/descriptors"),i=e("../internals/function-uncurry-this"),s=e("../internals/function-call"),a=e("../internals/fails"),o=e("../internals/object-keys"),l=e("../internals/object-get-own-property-symbols"),c=e("../internals/object-property-is-enumerable"),u=e("../internals/to-object"),h=e("../internals/indexed-object"),d=Object.assign,f=Object.defineProperty,p=i([].concat);t.exports=!d||a((function(){if(n&&1!==d({b:1},d(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol("assign detection");return e[r]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!==d({},e)[r]||"abcdefghijklmnopqrst"!==o(d({},t)).join("")}))?function(e,t){for(var r=u(e),i=arguments.length,a=1,d=l.f,f=c.f;i>a;)for(var m,g=h(arguments[a++]),v=d?p(o(g),d(g)):o(g),y=v.length,b=0;y>b;)m=v[b++],n&&!s(f,g,m)||(r[m]=g[m]);return r}:d},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/object-get-own-property-symbols":312,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-object":344}],306:[function(e,t,r){"use strict";var n,i=e("../internals/an-object"),s=e("../internals/object-define-properties"),a=e("../internals/enum-bug-keys"),o=e("../internals/hidden-keys"),l=e("../internals/html"),c=e("../internals/document-create-element"),u=e("../internals/shared-key")("IE_PROTO"),h=function(){},d=function(e){return"<script>"+e+"<\/script>"},f=function(e){e.write(d("")),e.close();var t=e.parentWindow.Object;return e=null,t},p=function(){try{n=new ActiveXObject("htmlfile")}catch(e){}var e,t;p="undefined"!=typeof document?document.domain&&n?f(n):((t=c("iframe")).style.display="none",l.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(d("document.F=Object")),e.close(),e.F):f(n);for(var r=a.length;r--;)delete p.prototype[a[r]];return p()};o[u]=!0,t.exports=Object.create||function(e,t){var r;return null!==e?(h.prototype=i(e),r=new h,h.prototype=null,r[u]=e):r=p(),void 0===t?r:s.f(r,t)}},{"../internals/an-object":227,"../internals/document-create-element":249,"../internals/enum-bug-keys":258,"../internals/hidden-keys":276,"../internals/html":278,"../internals/object-define-properties":307,"../internals/shared-key":332}],307:[function(e,t,r){"use strict";var n=e("../internals/descriptors"),i=e("../internals/v8-prototype-define-bug"),s=e("../internals/object-define-property"),a=e("../internals/an-object"),o=e("../internals/to-indexed-object"),l=e("../internals/object-keys");r.f=n&&!i?Object.defineProperties:function(e,t){a(e);for(var r,n=o(t),i=l(t),c=i.length,u=0;c>u;)s.f(e,r=i[u++],n[r]);return e}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/object-define-property":308,"../internals/object-keys":316,"../internals/to-indexed-object":341,"../internals/v8-prototype-define-bug":352}],308:[function(e,t,r){"use strict";var n=e("../internals/descriptors"),i=e("../internals/ie8-dom-define"),s=e("../internals/v8-prototype-define-bug"),a=e("../internals/an-object"),o=e("../internals/to-property-key"),l=TypeError,c=Object.defineProperty,u=Object.getOwnPropertyDescriptor;r.f=n?s?function(e,t,r){if(a(e),t=o(t),a(r),"function"==typeof e&&"prototype"===t&&"value"in r&&"writable"in r&&!r.writable){var n=u(e,t);n&&n.writable&&(e[t]=r.value,r={configurable:"configurable"in r?r.configurable:n.configurable,enumerable:"enumerable"in r?r.enumerable:n.enumerable,writable:!1})}return c(e,t,r)}:c:function(e,t,r){if(a(e),t=o(t),a(r),i)try{return c(e,t,r)}catch(e){}if("get"in r||"set"in r)throw new l("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/ie8-dom-define":279,"../internals/to-property-key":346,"../internals/v8-prototype-define-bug":352}],309:[function(e,t,r){"use strict";var n=e("../internals/descriptors"),i=e("../internals/function-call"),s=e("../internals/object-property-is-enumerable"),a=e("../internals/create-property-descriptor"),o=e("../internals/to-indexed-object"),l=e("../internals/to-property-key"),c=e("../internals/has-own-property"),u=e("../internals/ie8-dom-define"),h=Object.getOwnPropertyDescriptor;r.f=n?h:function(e,t){if(e=o(e),t=l(t),u)try{return h(e,t)}catch(e){}if(c(e,t))return a(!i(s.f,e,t),e[t])}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/function-call":264,"../internals/has-own-property":275,"../internals/ie8-dom-define":279,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341,"../internals/to-property-key":346}],310:[function(e,t,r){"use strict";var n=e("../internals/classof-raw"),i=e("../internals/to-indexed-object"),s=e("../internals/object-get-own-property-names").f,a=e("../internals/array-slice-simple"),o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(e){return o&&"Window"===n(e)?function(e){try{return s(e)}catch(e){return a(o)}}(e):s(i(e))}},{"../internals/array-slice-simple":230,"../internals/classof-raw":235,"../internals/object-get-own-property-names":311,"../internals/to-indexed-object":341}],311:[function(e,t,r){"use strict";var n=e("../internals/object-keys-internal"),i=e("../internals/enum-bug-keys").concat("length","prototype");r.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],312:[function(e,t,r){"use strict";r.f=Object.getOwnPropertySymbols},{}],313:[function(e,t,r){"use strict";var n=e("../internals/has-own-property"),i=e("../internals/is-callable"),s=e("../internals/to-object"),a=e("../internals/shared-key"),o=e("../internals/correct-prototype-getter"),l=a("IE_PROTO"),c=Object,u=c.prototype;t.exports=o?c.getPrototypeOf:function(e){var t=s(e);if(n(t,l))return t[l];var r=t.constructor;return i(r)&&t instanceof r?r.prototype:t instanceof c?u:null}},{"../internals/correct-prototype-getter":239,"../internals/has-own-property":275,"../internals/is-callable":285,"../internals/shared-key":332,"../internals/to-object":344}],314:[function(e,t,r){"use strict";var n=e("../internals/function-uncurry-this");t.exports=n({}.isPrototypeOf)},{"../internals/function-uncurry-this":268}],315:[function(e,t,r){"use strict";var n=e("../internals/function-uncurry-this"),i=e("../internals/has-own-property"),s=e("../internals/to-indexed-object"),a=e("../internals/array-includes").indexOf,o=e("../internals/hidden-keys"),l=n([].push);t.exports=function(e,t){var r,n=s(e),c=0,u=[];for(r in n)!i(o,r)&&i(n,r)&&l(u,r);for(;t.length>c;)i(n,r=t[c++])&&(~a(u,r)||l(u,r));return u}},{"../internals/array-includes":228,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/to-indexed-object":341}],316:[function(e,t,r){"use strict";var n=e("../internals/object-keys-internal"),i=e("../internals/enum-bug-keys");t.exports=Object.keys||function(e){return n(e,i)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],317:[function(e,t,r){"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,s=i&&!n.call({1:2},1);r.f=s?function(e){var t=i(this,e);return!!t&&t.enumerable}:n},{}],318:[function(e,t,r){"use strict";var n=e("../internals/function-uncurry-this-accessor"),i=e("../internals/an-object"),s=e("../internals/a-possible-prototype");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=n(Object.prototype,"__proto__","set"))(r,[]),t=r instanceof Array}catch(e){}return function(r,n){return i(r),s(n),t?e(r,n):r.__proto__=n,r}}():void 0)},{"../internals/a-possible-prototype":224,"../internals/an-object":227,"../internals/function-uncurry-this-accessor":266}],319:[function(e,t,r){"use strict";var n=e("../internals/descriptors"),i=e("../internals/fails"),s=e("../internals/function-uncurry-this"),a=e("../internals/object-get-prototype-of"),o=e("../internals/object-keys"),l=e("../internals/to-indexed-object"),c=s(e("../internals/object-property-is-enumerable").f),u=s([].push),h=n&&i((function(){var e=Object.create(null);return e[2]=2,!c(e,2)})),d=function(e){return function(t){for(var r,i=l(t),s=o(i),d=h&&null===a(i),f=s.length,p=0,m=[];f>p;)r=s[p++],n&&!(d?r in i:c(i,r))||u(m,e?[r,i[r]]:i[r]);return m}};t.exports={entries:d(!0),values:d(!1)}},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/object-get-prototype-of":313,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341}],320:[function(e,t,r){"use strict";var n=e("../internals/function-call"),i=e("../internals/is-callable"),s=e("../internals/is-object"),a=TypeError;t.exports=function(e,t){var r,o;if("string"===t&&i(r=e.toString)&&!s(o=n(r,e)))return o;if(i(r=e.valueOf)&&!s(o=n(r,e)))return o;if("string"!==t&&i(r=e.toString)&&!s(o=n(r,e)))return o;throw new a("Can't convert object to primitive value")}},{"../internals/function-call":264,"../internals/is-callable":285,"../internals/is-object":289}],321:[function(e,t,r){"use strict";var n=e("../internals/get-built-in"),i=e("../internals/function-uncurry-this"),s=e("../internals/object-get-own-property-names"),a=e("../internals/object-get-own-property-symbols"),o=e("../internals/an-object"),l=i([].concat);t.exports=n("Reflect","ownKeys")||function(e){var t=s.f(o(e)),r=a.f;return r?l(t,r(e)):t}},{"../internals/an-object":227,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-symbols":312}],322:[function(e,t,r){"use strict";var n=e("../internals/global");t.exports=n},{"../internals/global":274}],323:[function(e,t,r){"use strict";t.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},{}],324:[function(e,t,r){"use strict";var n=e("../internals/global"),i=e("../internals/promise-native-constructor"),s=e("../internals/is-callable"),a=e("../internals/is-forced"),o=e("../internals/inspect-source"),l=e("../internals/well-known-symbol"),c=e("../internals/engine-is-browser"),u=e("../internals/engine-is-deno"),h=e("../internals/is-pure"),d=e("../internals/engine-v8-version"),f=i&&i.prototype,p=l("species"),m=!1,g=s(n.PromiseRejectionEvent),v=a("Promise",(function(){var e=o(i),t=e!==String(i);if(!t&&66===d)return!0;if(h&&(!f.catch||!f.finally))return!0;if(!d||d<51||!/native code/.test(e)){var r=new i((function(e){e(1)})),n=function(e){e((function(){}),(function(){}))};if((r.constructor={})[p]=n,!(m=r.then((function(){}))instanceof n))return!0}return!t&&(c||u)&&!g}));t.exports={CONSTRUCTOR:v,REJECTION_EVENT:g,SUBCLASSING:m}},{"../internals/engine-is-browser":250,"../internals/engine-is-deno":251,"../internals/engine-v8-version":257,"../internals/global":274,"../internals/inspect-source":281,"../internals/is-callable":285,"../internals/is-forced":287,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/well-known-symbol":357}],325:[function(e,t,r){"use strict";var n=e("../internals/global");t.exports=n.Promise},{"../internals/global":274}],326:[function(e,t,r){"use strict";var n=e("../internals/an-object"),i=e("../internals/is-object"),s=e("../internals/new-promise-capability");t.exports=function(e,t){if(n(e),i(t)&&t.constructor===e)return t;var r=s.f(e);return(0,r.resolve)(t),r.promise}},{"../internals/an-object":227,"../internals/is-object":289,"../internals/new-promise-capability":303}],327:[function(e,t,r){"use strict";var n=e("../internals/promise-native-constructor"),i=e("../internals/check-correctness-of-iteration"),s=e("../internals/promise-constructor-detection").CONSTRUCTOR;t.exports=s||!i((function(e){n.all(e).then(void 0,(function(){}))}))},{"../internals/check-correctness-of-iteration":234,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],328:[function(e,t,r){"use strict";var n=function(){this.head=null,this.tail=null};n.prototype={add:function(e){var t={item:e,next:null},r=this.tail;r?r.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}},t.exports=n},{}],329:[function(e,t,r){"use strict";var n=e("../internals/is-null-or-undefined"),i=TypeError;t.exports=function(e){if(n(e))throw new i("Can't call method on "+e);return e}},{"../internals/is-null-or-undefined":288}],330:[function(e,t,r){"use strict";var n=e("../internals/get-built-in"),i=e("../internals/define-built-in-accessor"),s=e("../internals/well-known-symbol"),a=e("../internals/descriptors"),o=s("species");t.exports=function(e){var t=n(e);a&&t&&!t[o]&&i(t,o,{configurable:!0,get:function(){return this}})}},{"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],331:[function(e,t,r){"use strict";var n=e("../internals/object-define-property").f,i=e("../internals/has-own-property"),s=e("../internals/well-known-symbol")("toStringTag");t.exports=function(e,t,r){e&&!r&&(e=e.prototype),e&&!i(e,s)&&n(e,s,{configurable:!0,value:t})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],332:[function(e,t,r){"use strict";var n=e("../internals/shared"),i=e("../internals/uid"),s=n("keys");t.exports=function(e){return s[e]||(s[e]=i(e))}},{"../internals/shared":334,"../internals/uid":350}],333:[function(e,t,r){"use strict";var n=e("../internals/global"),i=e("../internals/define-global-property"),s=n["__core-js_shared__"]||i("__core-js_shared__",{});t.exports=s},{"../internals/define-global-property":246,"../internals/global":274}],334:[function(e,t,r){"use strict";var n=e("../internals/is-pure"),i=e("../internals/shared-store");(t.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.33.0",mode:n?"pure":"global",copyright:"\xa9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})},{"../internals/is-pure":290,"../internals/shared-store":333}],335:[function(e,t,r){"use strict";var n=e("../internals/an-object"),i=e("../internals/a-constructor"),s=e("../internals/is-null-or-undefined"),a=e("../internals/well-known-symbol")("species");t.exports=function(e,t){var r,o=n(e).constructor;return void 0===o||s(r=n(o)[a])?t:i(r)}},{"../internals/a-constructor":223,"../internals/an-object":227,"../internals/is-null-or-undefined":288,"../internals/well-known-symbol":357}],336:[function(e,t,r){"use strict";var n=e("../internals/engine-v8-version"),i=e("../internals/fails"),s=e("../internals/global").String;t.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol("symbol detection");return!s(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},{"../internals/engine-v8-version":257,"../internals/fails":260,"../internals/global":274}],337:[function(e,t,r){"use strict";var n=e("../internals/function-call"),i=e("../internals/get-built-in"),s=e("../internals/well-known-symbol"),a=e("../internals/define-built-in");t.exports=function(){var e=i("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,o=s("toPrimitive");t&&!t[o]&&a(t,o,(function(e){return n(r,this)}),{arity:1})}},{"../internals/define-built-in":245,"../internals/function-call":264,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],338:[function(e,t,r){"use strict";var n=e("../internals/symbol-constructor-detection");t.exports=n&&!!Symbol.for&&!!Symbol.keyFor},{"../internals/symbol-constructor-detection":336}],339:[function(e,t,r){"use strict";var n,i,s,a,o=e("../internals/global"),l=e("../internals/function-apply"),c=e("../internals/function-bind-context"),u=e("../internals/is-callable"),h=e("../internals/has-own-property"),d=e("../internals/fails"),f=e("../internals/html"),p=e("../internals/array-slice"),m=e("../internals/document-create-element"),g=e("../internals/validate-arguments-length"),v=e("../internals/engine-is-ios"),y=e("../internals/engine-is-node"),b=o.setImmediate,w=o.clearImmediate,x=o.process,S=o.Dispatch,_=o.Function,C=o.MessageChannel,E=o.String,A=0,M={};d((function(){n=o.location}));var T=function(e){if(h(M,e)){var t=M[e];delete M[e],t()}},P=function(e){return function(){T(e)}},k=function(e){T(e.data)},D=function(e){o.postMessage(E(e),n.protocol+"//"+n.host)};b&&w||(b=function(e){g(arguments.length,1);var t=u(e)?e:_(e),r=p(arguments,1);return M[++A]=function(){l(t,void 0,r)},i(A),A},w=function(e){delete M[e]},y?i=function(e){x.nextTick(P(e))}:S&&S.now?i=function(e){S.now(P(e))}:C&&!v?(a=(s=new C).port2,s.port1.onmessage=k,i=c(a.postMessage,a)):o.addEventListener&&u(o.postMessage)&&!o.importScripts&&n&&"file:"!==n.protocol&&!d(D)?(i=D,o.addEventListener("message",k,!1)):i="onreadystatechange"in m("script")?function(e){f.appendChild(m("script")).onreadystatechange=function(){f.removeChild(this),T(e)}}:function(e){setTimeout(P(e),0)}),t.exports={set:b,clear:w}},{"../internals/array-slice":231,"../internals/document-create-element":249,"../internals/engine-is-ios":253,"../internals/engine-is-node":254,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-bind-context":262,"../internals/global":274,"../internals/has-own-property":275,"../internals/html":278,"../internals/is-callable":285,"../internals/validate-arguments-length":353}],340:[function(e,t,r){"use strict";var n=e("../internals/to-integer-or-infinity"),i=Math.max,s=Math.min;t.exports=function(e,t){var r=n(e);return r<0?i(r+t,0):s(r,t)}},{"../internals/to-integer-or-infinity":342}],341:[function(e,t,r){"use strict";var n=e("../internals/indexed-object"),i=e("../internals/require-object-coercible");t.exports=function(e){return n(i(e))}},{"../internals/indexed-object":280,"../internals/require-object-coercible":329}],342:[function(e,t,r){"use strict";var n=e("../internals/math-trunc");t.exports=function(e){var t=+e;return t!=t||0===t?0:n(t)}},{"../internals/math-trunc":301}],343:[function(e,t,r){"use strict";var n=e("../internals/to-integer-or-infinity"),i=Math.min;t.exports=function(e){return e>0?i(n(e),9007199254740991):0}},{"../internals/to-integer-or-infinity":342}],344:[function(e,t,r){"use strict";var n=e("../internals/require-object-coercible"),i=Object;t.exports=function(e){return i(n(e))}},{"../internals/require-object-coercible":329}],345:[function(e,t,r){"use strict";var n=e("../internals/function-call"),i=e("../internals/is-object"),s=e("../internals/is-symbol"),a=e("../internals/get-method"),o=e("../internals/ordinary-to-primitive"),l=e("../internals/well-known-symbol"),c=TypeError,u=l("toPrimitive");t.exports=function(e,t){if(!i(e)||s(e))return e;var r,l=a(e,u);if(l){if(void 0===t&&(t="default"),r=n(l,e,t),!i(r)||s(r))return r;throw new c("Can't convert object to primitive value")}return void 0===t&&(t="number"),o(e,t)}},{"../internals/function-call":264,"../internals/get-method":273,"../internals/is-object":289,"../internals/is-symbol":292,"../internals/ordinary-to-primitive":320,"../internals/well-known-symbol":357}],346:[function(e,t,r){"use strict";var n=e("../internals/to-primitive"),i=e("../internals/is-symbol");t.exports=function(e){var t=n(e,"string");return i(t)?t:t+""}},{"../internals/is-symbol":292,"../internals/to-primitive":345}],347:[function(e,t,r){"use strict";var n={};n[e("../internals/well-known-symbol")("toStringTag")]="z",t.exports="[object z]"===String(n)},{"../internals/well-known-symbol":357}],348:[function(e,t,r){"use strict";var n=e("../internals/classof"),i=String;t.exports=function(e){if("Symbol"===n(e))throw new TypeError("Cannot convert a Symbol value to a string");return i(e)}},{"../internals/classof":236}],349:[function(e,t,r){"use strict";var n=String;t.exports=function(e){try{return n(e)}catch(e){return"Object"}}},{}],350:[function(e,t,r){"use strict";var n=e("../internals/function-uncurry-this"),i=0,s=Math.random(),a=n(1..toString);t.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++i+s,36)}},{"../internals/function-uncurry-this":268}],351:[function(e,t,r){"use strict";var n=e("../internals/symbol-constructor-detection");t.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},{"../internals/symbol-constructor-detection":336}],352:[function(e,t,r){"use strict";var n=e("../internals/descriptors"),i=e("../internals/fails");t.exports=n&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},{"../internals/descriptors":247,"../internals/fails":260}],353:[function(e,t,r){"use strict";var n=TypeError;t.exports=function(e,t){if(e<t)throw new n("Not enough arguments");return e}},{}],354:[function(e,t,r){"use strict";var n=e("../internals/global"),i=e("../internals/is-callable"),s=n.WeakMap;t.exports=i(s)&&/native code/.test(String(s))},{"../internals/global":274,"../internals/is-callable":285}],355:[function(e,t,r){"use strict";var n=e("../internals/path"),i=e("../internals/has-own-property"),s=e("../internals/well-known-symbol-wrapped"),a=e("../internals/object-define-property").f;t.exports=function(e){var t=n.Symbol||(n.Symbol={});i(t,e)||a(t,e,{value:s.f(e)})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/path":322,"../internals/well-known-symbol-wrapped":356}],356:[function(e,t,r){"use strict";var n=e("../internals/well-known-symbol");r.f=n},{"../internals/well-known-symbol":357}],357:[function(e,t,r){"use strict";var n=e("../internals/global"),i=e("../internals/shared"),s=e("../internals/has-own-property"),a=e("../internals/uid"),o=e("../internals/symbol-constructor-detection"),l=e("../internals/use-symbol-as-uid"),c=n.Symbol,u=i("wks"),h=l?c.for||c:c&&c.withoutSetter||a;t.exports=function(e){return s(u,e)||(u[e]=o&&s(c,e)?c[e]:h("Symbol."+e)),u[e]}},{"../internals/global":274,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-constructor-detection":336,"../internals/uid":350,"../internals/use-symbol-as-uid":351}],358:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/array-iteration").findIndex,s=e("../internals/add-to-unscopables"),a=!0;"findIndex"in[]&&Array(1).findIndex((function(){a=!1})),n({target:"Array",proto:!0,forced:a},{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),s("findIndex")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],359:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/array-iteration").find,s=e("../internals/add-to-unscopables"),a=!0;"find"in[]&&Array(1).find((function(){a=!1})),n({target:"Array",proto:!0,forced:a},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),s("find")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],360:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/array-includes").includes,s=e("../internals/fails"),a=e("../internals/add-to-unscopables");n({target:"Array",proto:!0,forced:s((function(){return!Array(1).includes()}))},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a("includes")},{"../internals/add-to-unscopables":225,"../internals/array-includes":228,"../internals/export":259,"../internals/fails":260}],361:[function(e,t,r){"use strict";var n=e("../internals/to-indexed-object"),i=e("../internals/add-to-unscopables"),s=e("../internals/iterators"),a=e("../internals/internal-state"),o=e("../internals/object-define-property").f,l=e("../internals/iterator-define"),c=e("../internals/create-iter-result-object"),u=e("../internals/is-pure"),h=e("../internals/descriptors"),d=a.set,f=a.getterFor("Array Iterator");t.exports=l(Array,"Array",(function(e,t){d(this,{type:"Array Iterator",target:n(e),index:0,kind:t})}),(function(){var e=f(this),t=e.target,r=e.kind,n=e.index++;if(!t||n>=t.length)return e.target=void 0,c(void 0,!0);switch(r){case"keys":return c(n,!1);case"values":return c(t[n],!1)}return c([n,t[n]],!1)}),"values");var p=s.Arguments=s.Array;if(i("keys"),i("values"),i("entries"),!u&&h&&"values"!==p.name)try{o(p,"name",{value:"values"})}catch(e){}},{"../internals/add-to-unscopables":225,"../internals/create-iter-result-object":240,"../internals/descriptors":247,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/iterator-define":296,"../internals/iterators":298,"../internals/object-define-property":308,"../internals/to-indexed-object":341}],362:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/get-built-in"),s=e("../internals/function-apply"),a=e("../internals/function-call"),o=e("../internals/function-uncurry-this"),l=e("../internals/fails"),c=e("../internals/is-callable"),u=e("../internals/is-symbol"),h=e("../internals/array-slice"),d=e("../internals/get-json-replacer-function"),f=e("../internals/symbol-constructor-detection"),p=String,m=i("JSON","stringify"),g=o(/./.exec),v=o("".charAt),y=o("".charCodeAt),b=o("".replace),w=o(1..toString),x=/[\uD800-\uDFFF]/g,S=/^[\uD800-\uDBFF]$/,_=/^[\uDC00-\uDFFF]$/,C=!f||l((function(){var e=i("Symbol")("stringify detection");return"[null]"!==m([e])||"{}"!==m({a:e})||"{}"!==m(Object(e))})),E=l((function(){return'"\\udf06\\ud834"'!==m("\udf06\ud834")||'"\\udead"'!==m("\udead")})),A=function(e,t){var r=h(arguments),n=d(t);if(c(n)||void 0!==e&&!u(e))return r[1]=function(e,t){if(c(n)&&(t=a(n,this,p(e),t)),!u(t))return t},s(m,null,r)},M=function(e,t,r){var n=v(r,t-1),i=v(r,t+1);return g(S,e)&&!g(_,i)||g(_,e)&&!g(S,n)?"\\u"+w(y(e,0),16):e};m&&n({target:"JSON",stat:!0,arity:3,forced:C||E},{stringify:function(e,t,r){var n=h(arguments),i=s(C?A:m,null,n);return E&&"string"==typeof i?b(i,x,M):i}})},{"../internals/array-slice":231,"../internals/export":259,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/get-json-replacer-function":272,"../internals/is-callable":285,"../internals/is-symbol":292,"../internals/symbol-constructor-detection":336}],363:[function(e,t,r){"use strict";e("../internals/export")({target:"Number",stat:!0},{isNaN:function(e){return e!=e}})},{"../internals/export":259}],364:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/object-assign");n({target:"Object",stat:!0,arity:2,forced:Object.assign!==i},{assign:i})},{"../internals/export":259,"../internals/object-assign":305}],365:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/symbol-constructor-detection"),s=e("../internals/fails"),a=e("../internals/object-get-own-property-symbols"),o=e("../internals/to-object");n({target:"Object",stat:!0,forced:!i||s((function(){a.f(1)}))},{getOwnPropertySymbols:function(e){var t=a.f;return t?t(o(e)):[]}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-get-own-property-symbols":312,"../internals/symbol-constructor-detection":336,"../internals/to-object":344}],366:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/to-object"),s=e("../internals/object-keys");n({target:"Object",stat:!0,forced:e("../internals/fails")((function(){s(1)}))},{keys:function(e){return s(i(e))}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-keys":316,"../internals/to-object":344}],367:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/object-to-array").values;n({target:"Object",stat:!0},{values:function(e){return i(e)}})},{"../internals/export":259,"../internals/object-to-array":319}],368:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/function-call"),s=e("../internals/a-callable"),a=e("../internals/new-promise-capability"),o=e("../internals/perform"),l=e("../internals/iterate");n({target:"Promise",stat:!0,forced:e("../internals/promise-statics-incorrect-iteration")},{all:function(e){var t=this,r=a.f(t),n=r.resolve,c=r.reject,u=o((function(){var r=s(t.resolve),a=[],o=0,u=1;l(e,(function(e){var s=o++,l=!1;u++,i(r,t,e).then((function(e){l||(l=!0,a[s]=e,--u||n(a))}),c)})),--u||n(a)}));return u.error&&c(u.value),r.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],369:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/is-pure"),s=e("../internals/promise-constructor-detection").CONSTRUCTOR,a=e("../internals/promise-native-constructor"),o=e("../internals/get-built-in"),l=e("../internals/is-callable"),c=e("../internals/define-built-in"),u=a&&a.prototype;if(n({target:"Promise",proto:!0,forced:s,real:!0},{catch:function(e){return this.then(void 0,e)}}),!i&&l(a)){var h=o("Promise").prototype.catch;u.catch!==h&&c(u,"catch",h,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],370:[function(e,t,r){"use strict";var n,i,s,a=e("../internals/export"),o=e("../internals/is-pure"),l=e("../internals/engine-is-node"),c=e("../internals/global"),u=e("../internals/function-call"),h=e("../internals/define-built-in"),d=e("../internals/object-set-prototype-of"),f=e("../internals/set-to-string-tag"),p=e("../internals/set-species"),m=e("../internals/a-callable"),g=e("../internals/is-callable"),v=e("../internals/is-object"),y=e("../internals/an-instance"),b=e("../internals/species-constructor"),w=e("../internals/task").set,x=e("../internals/microtask"),S=e("../internals/host-report-errors"),_=e("../internals/perform"),C=e("../internals/queue"),E=e("../internals/internal-state"),A=e("../internals/promise-native-constructor"),M=e("../internals/promise-constructor-detection"),T=e("../internals/new-promise-capability"),P=M.CONSTRUCTOR,k=M.REJECTION_EVENT,D=M.SUBCLASSING,I=E.getterFor("Promise"),O=E.set,R=A&&A.prototype,L=A,N=R,B=c.TypeError,z=c.document,F=c.process,j=T.f,U=j,V=!!(z&&z.createEvent&&c.dispatchEvent),H=function(e){var t;return!(!v(e)||!g(t=e.then))&&t},W=function(e,t){var r,n,i,s=t.value,a=1===t.state,o=a?e.ok:e.fail,l=e.resolve,c=e.reject,h=e.domain;try{o?(a||(2===t.rejection&&K(t),t.rejection=1),!0===o?r=s:(h&&h.enter(),r=o(s),h&&(h.exit(),i=!0)),r===e.promise?c(new B("Promise-chain cycle")):(n=H(r))?u(n,r,l,c):l(r)):c(s)}catch(e){h&&!i&&h.exit(),c(e)}},G=function(e,t){e.notified||(e.notified=!0,x((function(){for(var r,n=e.reactions;r=n.get();)W(r,e);e.notified=!1,t&&!e.rejection&&X(e)})))},q=function(e,t,r){var n,i;V?((n=z.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),c.dispatchEvent(n)):n={promise:t,reason:r},!k&&(i=c["on"+e])?i(n):"unhandledrejection"===e&&S("Unhandled promise rejection",r)},X=function(e){u(w,c,(function(){var t,r=e.facade,n=e.value;if(Y(e)&&(t=_((function(){l?F.emit("unhandledRejection",n,r):q("unhandledrejection",r,n)})),e.rejection=l||Y(e)?2:1,t.error))throw t.value}))},Y=function(e){return 1!==e.rejection&&!e.parent},K=function(e){u(w,c,(function(){var t=e.facade;l?F.emit("rejectionHandled",t):q("rejectionhandled",t,e.value)}))},Q=function(e,t,r){return function(n){e(t,n,r)}},Z=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,G(e,!0))},J=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw new B("Promise can't be resolved itself");var n=H(t);n?x((function(){var r={done:!1};try{u(n,t,Q(J,r,e),Q(Z,r,e))}catch(t){Z(r,t,e)}})):(e.value=t,e.state=1,G(e,!1))}catch(t){Z({done:!1},t,e)}}};if(P&&(N=(L=function(e){y(this,N),m(e),u(n,this);var t=I(this);try{e(Q(J,t),Q(Z,t))}catch(e){Z(t,e)}}).prototype,(n=function(e){O(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new C,rejection:!1,state:0,value:void 0})}).prototype=h(N,"then",(function(e,t){var r=I(this),n=j(b(this,L));return r.parent=!0,n.ok=!g(e)||e,n.fail=g(t)&&t,n.domain=l?F.domain:void 0,0===r.state?r.reactions.add(n):x((function(){W(n,r)})),n.promise})),i=function(){var e=new n,t=I(e);this.promise=e,this.resolve=Q(J,t),this.reject=Q(Z,t)},T.f=j=function(e){return e===L||void 0===e?new i(e):U(e)},!o&&g(A)&&R!==Object.prototype)){s=R.then,D||h(R,"then",(function(e,t){var r=this;return new L((function(e,t){u(s,r,e,t)})).then(e,t)}),{unsafe:!0});try{delete R.constructor}catch(e){}d&&d(R,N)}a({global:!0,constructor:!0,wrap:!0,forced:P},{Promise:L}),f(L,"Promise",!1,!0),p("Promise")},{"../internals/a-callable":222,"../internals/an-instance":226,"../internals/define-built-in":245,"../internals/engine-is-node":254,"../internals/export":259,"../internals/function-call":264,"../internals/global":274,"../internals/host-report-errors":277,"../internals/internal-state":282,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/microtask":302,"../internals/new-promise-capability":303,"../internals/object-set-prototype-of":318,"../internals/perform":323,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/queue":328,"../internals/set-species":330,"../internals/set-to-string-tag":331,"../internals/species-constructor":335,"../internals/task":339}],371:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/is-pure"),s=e("../internals/promise-native-constructor"),a=e("../internals/fails"),o=e("../internals/get-built-in"),l=e("../internals/is-callable"),c=e("../internals/species-constructor"),u=e("../internals/promise-resolve"),h=e("../internals/define-built-in"),d=s&&s.prototype;if(n({target:"Promise",proto:!0,real:!0,forced:!!s&&a((function(){d.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=c(this,o("Promise")),r=l(e);return this.then(r?function(r){return u(t,e()).then((function(){return r}))}:e,r?function(r){return u(t,e()).then((function(){throw r}))}:e)}}),!i&&l(s)){var f=o("Promise").prototype.finally;d.finally!==f&&h(d,"finally",f,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/fails":260,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326,"../internals/species-constructor":335}],372:[function(e,t,r){"use strict";e("../modules/es.promise.constructor"),e("../modules/es.promise.all"),e("../modules/es.promise.catch"),e("../modules/es.promise.race"),e("../modules/es.promise.reject"),e("../modules/es.promise.resolve")},{"../modules/es.promise.all":368,"../modules/es.promise.catch":369,"../modules/es.promise.constructor":370,"../modules/es.promise.race":373,"../modules/es.promise.reject":374,"../modules/es.promise.resolve":375}],373:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/function-call"),s=e("../internals/a-callable"),a=e("../internals/new-promise-capability"),o=e("../internals/perform"),l=e("../internals/iterate");n({target:"Promise",stat:!0,forced:e("../internals/promise-statics-incorrect-iteration")},{race:function(e){var t=this,r=a.f(t),n=r.reject,c=o((function(){var a=s(t.resolve);l(e,(function(e){i(a,t,e).then(r.resolve,n)}))}));return c.error&&n(c.value),r.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],374:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/function-call"),s=e("../internals/new-promise-capability");n({target:"Promise",stat:!0,forced:e("../internals/promise-constructor-detection").CONSTRUCTOR},{reject:function(e){var t=s.f(this);return i(t.reject,void 0,e),t.promise}})},{"../internals/export":259,"../internals/function-call":264,"../internals/new-promise-capability":303,"../internals/promise-constructor-detection":324}],375:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/get-built-in"),s=e("../internals/is-pure"),a=e("../internals/promise-native-constructor"),o=e("../internals/promise-constructor-detection").CONSTRUCTOR,l=e("../internals/promise-resolve"),c=i("Promise"),u=s&&!o;n({target:"Promise",stat:!0,forced:s||o},{resolve:function(e){return l(u&&this===c?a:this,e)}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326}],376:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/function-uncurry-this"),s=e("../internals/to-absolute-index"),a=RangeError,o=String.fromCharCode,l=String.fromCodePoint,c=i([].join);n({target:"String",stat:!0,arity:1,forced:!!l&&1!==l.length},{fromCodePoint:function(e){for(var t,r=[],n=arguments.length,i=0;n>i;){if(t=+arguments[i++],s(t,1114111)!==t)throw new a(t+" is not a valid code point");r[i]=t<65536?o(t):o(55296+((t-=65536)>>10),t%1024+56320)}return c(r,"")}})},{"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/to-absolute-index":340}],377:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/function-uncurry-this"),s=e("../internals/not-a-regexp"),a=e("../internals/require-object-coercible"),o=e("../internals/to-string"),l=e("../internals/correct-is-regexp-logic"),c=i("".indexOf);n({target:"String",proto:!0,forced:!l("includes")},{includes:function(e){return!!~c(o(a(this)),o(s(e)),arguments.length>1?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":238,"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/not-a-regexp":304,"../internals/require-object-coercible":329,"../internals/to-string":348}],378:[function(e,t,r){"use strict";e("../internals/well-known-symbol-define")("asyncIterator")},{"../internals/well-known-symbol-define":355}],379:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/global"),s=e("../internals/function-call"),a=e("../internals/function-uncurry-this"),o=e("../internals/is-pure"),l=e("../internals/descriptors"),c=e("../internals/symbol-constructor-detection"),u=e("../internals/fails"),h=e("../internals/has-own-property"),d=e("../internals/object-is-prototype-of"),f=e("../internals/an-object"),p=e("../internals/to-indexed-object"),m=e("../internals/to-property-key"),g=e("../internals/to-string"),v=e("../internals/create-property-descriptor"),y=e("../internals/object-create"),b=e("../internals/object-keys"),w=e("../internals/object-get-own-property-names"),x=e("../internals/object-get-own-property-names-external"),S=e("../internals/object-get-own-property-symbols"),_=e("../internals/object-get-own-property-descriptor"),C=e("../internals/object-define-property"),E=e("../internals/object-define-properties"),A=e("../internals/object-property-is-enumerable"),M=e("../internals/define-built-in"),T=e("../internals/define-built-in-accessor"),P=e("../internals/shared"),k=e("../internals/shared-key"),D=e("../internals/hidden-keys"),I=e("../internals/uid"),O=e("../internals/well-known-symbol"),R=e("../internals/well-known-symbol-wrapped"),L=e("../internals/well-known-symbol-define"),N=e("../internals/symbol-define-to-primitive"),B=e("../internals/set-to-string-tag"),z=e("../internals/internal-state"),F=e("../internals/array-iteration").forEach,j=k("hidden"),U=z.set,V=z.getterFor("Symbol"),H=Object.prototype,W=i.Symbol,G=W&&W.prototype,q=i.RangeError,X=i.TypeError,Y=i.QObject,K=_.f,Q=C.f,Z=x.f,J=A.f,$=a([].push),ee=P("symbols"),te=P("op-symbols"),re=P("wks"),ne=!Y||!Y.prototype||!Y.prototype.findChild,ie=function(e,t,r){var n=K(H,t);n&&delete H[t],Q(e,t,r),n&&e!==H&&Q(H,t,n)},se=l&&u((function(){return 7!==y(Q({},"a",{get:function(){return Q(this,"a",{value:7}).a}})).a}))?ie:Q,ae=function(e,t){var r=ee[e]=y(G);return U(r,{type:"Symbol",tag:e,description:t}),l||(r.description=t),r},oe=function(e,t,r){e===H&&oe(te,t,r),f(e);var n=m(t);return f(r),h(ee,n)?(r.enumerable?(h(e,j)&&e[j][n]&&(e[j][n]=!1),r=y(r,{enumerable:v(0,!1)})):(h(e,j)||Q(e,j,v(1,{})),e[j][n]=!0),se(e,n,r)):Q(e,n,r)},le=function(e,t){f(e);var r=p(t),n=b(r).concat(de(r));return F(n,(function(t){l&&!s(ce,r,t)||oe(e,t,r[t])})),e},ce=function(e){var t=m(e),r=s(J,this,t);return!(this===H&&h(ee,t)&&!h(te,t))&&(!(r||!h(this,t)||!h(ee,t)||h(this,j)&&this[j][t])||r)},ue=function(e,t){var r=p(e),n=m(t);if(r!==H||!h(ee,n)||h(te,n)){var i=K(r,n);return!i||!h(ee,n)||h(r,j)&&r[j][n]||(i.enumerable=!0),i}},he=function(e){var t=Z(p(e)),r=[];return F(t,(function(e){h(ee,e)||h(D,e)||$(r,e)})),r},de=function(e){var t=e===H,r=Z(t?te:p(e)),n=[];return F(r,(function(e){!h(ee,e)||t&&!h(H,e)||$(n,ee[e])})),n};c||(M(G=(W=function(){if(d(G,this))throw new X("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?g(arguments[0]):void 0,t=I(e),r=function(e){this===H&&s(r,te,e),h(this,j)&&h(this[j],t)&&(this[j][t]=!1);var n=v(1,e);try{se(this,t,n)}catch(e){if(!(e instanceof q))throw e;ie(this,t,n)}};return l&&ne&&se(H,t,{configurable:!0,set:r}),ae(t,e)}).prototype,"toString",(function(){return V(this).tag})),M(W,"withoutSetter",(function(e){return ae(I(e),e)})),A.f=ce,C.f=oe,E.f=le,_.f=ue,w.f=x.f=he,S.f=de,R.f=function(e){return ae(O(e),e)},l&&(T(G,"description",{configurable:!0,get:function(){return V(this).description}}),o||M(H,"propertyIsEnumerable",ce,{unsafe:!0}))),n({global:!0,constructor:!0,wrap:!0,forced:!c,sham:!c},{Symbol:W}),F(b(re),(function(e){L(e)})),n({target:"Symbol",stat:!0,forced:!c},{useSetter:function(){ne=!0},useSimple:function(){ne=!1}}),n({target:"Object",stat:!0,forced:!c,sham:!l},{create:function(e,t){return void 0===t?y(e):le(y(e),t)},defineProperty:oe,defineProperties:le,getOwnPropertyDescriptor:ue}),n({target:"Object",stat:!0,forced:!c},{getOwnPropertyNames:he}),N(),B(W,"Symbol"),D[j]=!0},{"../internals/an-object":227,"../internals/array-iteration":229,"../internals/create-property-descriptor":242,"../internals/define-built-in":245,"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/export":259,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-define-properties":307,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-names-external":310,"../internals/object-get-own-property-symbols":312,"../internals/object-is-prototype-of":314,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/set-to-string-tag":331,"../internals/shared":334,"../internals/shared-key":332,"../internals/symbol-constructor-detection":336,"../internals/symbol-define-to-primitive":337,"../internals/to-indexed-object":341,"../internals/to-property-key":346,"../internals/to-string":348,"../internals/uid":350,"../internals/well-known-symbol":357,"../internals/well-known-symbol-define":355,"../internals/well-known-symbol-wrapped":356}],380:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/get-built-in"),s=e("../internals/has-own-property"),a=e("../internals/to-string"),o=e("../internals/shared"),l=e("../internals/symbol-registry-detection"),c=o("string-to-symbol-registry"),u=o("symbol-to-string-registry");n({target:"Symbol",stat:!0,forced:!l},{for:function(e){var t=a(e);if(s(c,t))return c[t];var r=i("Symbol")(t);return c[t]=r,u[r]=t,r}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/to-string":348}],381:[function(e,t,r){"use strict";e("../modules/es.symbol.constructor"),e("../modules/es.symbol.for"),e("../modules/es.symbol.key-for"),e("../modules/es.json.stringify"),e("../modules/es.object.get-own-property-symbols")},{"../modules/es.json.stringify":362,"../modules/es.object.get-own-property-symbols":365,"../modules/es.symbol.constructor":379,"../modules/es.symbol.for":380,"../modules/es.symbol.key-for":382}],382:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/has-own-property"),s=e("../internals/is-symbol"),a=e("../internals/try-to-string"),o=e("../internals/shared"),l=e("../internals/symbol-registry-detection"),c=o("symbol-to-string-registry");n({target:"Symbol",stat:!0,forced:!l},{keyFor:function(e){if(!s(e))throw new TypeError(a(e)+" is not a symbol");if(i(c,e))return c[e]}})},{"../internals/export":259,"../internals/has-own-property":275,"../internals/is-symbol":292,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/try-to-string":349}],383:[function(e,t,r){"use strict";function n(e){return Object.prototype.toString.call(e)}r.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===n(e)},r.isBoolean=function(e){return"boolean"==typeof e},r.isNull=function(e){return null===e},r.isNullOrUndefined=function(e){return null==e},r.isNumber=function(e){return"number"==typeof e},r.isString=function(e){return"string"==typeof e},r.isSymbol=function(e){return"symbol"==typeof e},r.isUndefined=function(e){return void 0===e},r.isRegExp=function(e){return"[object RegExp]"===n(e)},r.isObject=function(e){return"object"==typeof e&&null!==e},r.isDate=function(e){return"[object Date]"===n(e)},r.isError=function(e){return"[object Error]"===n(e)||e instanceof Error},r.isFunction=function(e){return"function"==typeof e},r.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},r.isBuffer=e("buffer").Buffer.isBuffer},{buffer:220}],384:[function(e,t,r){(function(r){(function(){"use strict";var n=e("elliptic"),i=e("bn.js");t.exports=function(e){return new a(e)};var s={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function a(e){this.curveType=s[e],this.curveType||(this.curveType={name:e}),this.curve=new n.ec(this.curveType.name),this.keys=void 0}function o(e,t,n){Array.isArray(e)||(e=e.toArray());var i=new r(e);if(n&&i.length<n){var s=new r(n-i.length);s.fill(0),i=r.concat([s,i])}return t?i.toString(t):i}s.p224=s.secp224r1,s.p256=s.secp256r1=s.prime256v1,s.p192=s.secp192r1=s.prime192v1,s.p384=s.secp384r1,s.p521=s.secp521r1,a.prototype.generateKeys=function(e,t){return this.keys=this.curve.genKeyPair(),this.getPublicKey(e,t)},a.prototype.computeSecret=function(e,t,n){return t=t||"utf8",r.isBuffer(e)||(e=new r(e,t)),o(this.curve.keyFromPublic(e).getPublic().mul(this.keys.getPrivate()).getX(),n,this.curveType.byteLength)},a.prototype.getPublicKey=function(e,t){var r=this.keys.getPublic("compressed"===t,!0);return"hybrid"===t&&(r[r.length-1]%2?r[0]=7:r[0]=6),o(r,e)},a.prototype.getPrivateKey=function(e){return o(this.keys.getPrivate(),e)},a.prototype.setPublicKey=function(e,t){return t=t||"utf8",r.isBuffer(e)||(e=new r(e,t)),this.keys._importPublic(e),this},a.prototype.setPrivateKey=function(e,t){t=t||"utf8",r.isBuffer(e)||(e=new r(e,t));var n=new i(e);return n=n.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(n),this}}).call(this)}).call(this,e("buffer").Buffer)},{"bn.js":385,buffer:220,elliptic:405}],385:[function(e,t,r){arguments[4][184][0].apply(r,arguments)},{buffer:188,dup:184}],386:[function(e,t,r){"use strict";var n=e("inherits"),i=e("md5.js"),s=e("ripemd160"),a=e("sha.js"),o=e("cipher-base");function l(e){o.call(this,"digest"),this._hash=e}n(l,o),l.prototype._update=function(e){this._hash.update(e)},l.prototype._final=function(){return this._hash.digest()},t.exports=function(e){return"md5"===(e=e.toLowerCase())?new i:"rmd160"===e||"ripemd160"===e?new s:new l(a(e))}},{"cipher-base":221,inherits:440,"md5.js":450,ripemd160:493,"sha.js":498}],387:[function(e,t,r){"use strict";var n=e("md5.js");t.exports=function(e){return(new n).update(e).digest()}},{"md5.js":450}],388:[function(e,t,r){"use strict";var n=e("inherits"),i=e("./legacy"),s=e("cipher-base"),a=e("safe-buffer").Buffer,o=e("create-hash/md5"),l=e("ripemd160"),c=e("sha.js"),u=a.alloc(128);function h(e,t){s.call(this,"digest"),"string"==typeof t&&(t=a.from(t));var r="sha512"===e||"sha384"===e?128:64;this._alg=e,this._key=t,t.length>r?t=("rmd160"===e?new l:c(e)).update(t).digest():t.length<r&&(t=a.concat([t,u],r));for(var n=this._ipad=a.allocUnsafe(r),i=this._opad=a.allocUnsafe(r),o=0;o<r;o++)n[o]=54^t[o],i[o]=92^t[o];this._hash="rmd160"===e?new l:c(e),this._hash.update(n)}n(h,s),h.prototype._update=function(e){this._hash.update(e)},h.prototype._final=function(){var e=this._hash.digest();return("rmd160"===this._alg?new l:c(this._alg)).update(this._opad).update(e).digest()},t.exports=function(e,t){return"rmd160"===(e=e.toLowerCase())||"ripemd160"===e?new h("rmd160",t):"md5"===e?new i(o,t):new h(e,t)}},{"./legacy":389,"cipher-base":221,"create-hash/md5":387,inherits:440,ripemd160:493,"safe-buffer":494,"sha.js":498}],389:[function(e,t,r){"use strict";var n=e("inherits"),i=e("safe-buffer").Buffer,s=e("cipher-base"),a=i.alloc(128);function o(e,t){s.call(this,"digest"),"string"==typeof t&&(t=i.from(t)),this._alg=e,this._key=t,t.length>64?t=e(t):t.length<64&&(t=i.concat([t,a],64));for(var r=this._ipad=i.allocUnsafe(64),n=this._opad=i.allocUnsafe(64),o=0;o<64;o++)r[o]=54^t[o],n[o]=92^t[o];this._hash=[r]}n(o,s),o.prototype._update=function(e){this._hash.push(e)},o.prototype._final=function(){var e=this._alg(i.concat(this._hash));return this._alg(i.concat([this._opad,e]))},t.exports=o},{"cipher-base":221,inherits:440,"safe-buffer":494}],390:[function(e,t,r){"use strict";r.randomBytes=r.rng=r.pseudoRandomBytes=r.prng=e("randombytes"),r.createHash=r.Hash=e("create-hash"),r.createHmac=r.Hmac=e("create-hmac");var n=e("browserify-sign/algos"),i=Object.keys(n),s=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(i);r.getHashes=function(){return s};var a=e("pbkdf2");r.pbkdf2=a.pbkdf2,r.pbkdf2Sync=a.pbkdf2Sync;var o=e("browserify-cipher");r.Cipher=o.Cipher,r.createCipher=o.createCipher,r.Cipheriv=o.Cipheriv,r.createCipheriv=o.createCipheriv,r.Decipher=o.Decipher,r.createDecipher=o.createDecipher,r.Decipheriv=o.Decipheriv,r.createDecipheriv=o.createDecipheriv,r.getCiphers=o.getCiphers,r.listCiphers=o.listCiphers;var l=e("diffie-hellman");r.DiffieHellmanGroup=l.DiffieHellmanGroup,r.createDiffieHellmanGroup=l.createDiffieHellmanGroup,r.getDiffieHellman=l.getDiffieHellman,r.createDiffieHellman=l.createDiffieHellman,r.DiffieHellman=l.DiffieHellman;var c=e("browserify-sign");r.createSign=c.createSign,r.Sign=c.Sign,r.createVerify=c.createVerify,r.Verify=c.Verify,r.createECDH=e("create-ecdh");var u=e("public-encrypt");r.publicEncrypt=u.publicEncrypt,r.privateEncrypt=u.privateEncrypt,r.publicDecrypt=u.publicDecrypt,r.privateDecrypt=u.privateDecrypt;var h=e("randomfill");r.randomFill=h.randomFill,r.randomFillSync=h.randomFillSync,r.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join("\n"))},r.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":206,"browserify-sign":213,"browserify-sign/algos":210,"create-ecdh":384,"create-hash":386,"create-hmac":388,"diffie-hellman":400,pbkdf2:460,"public-encrypt":468,randombytes:475,randomfill:476}],391:[function(e,t,r){"use strict";!function(e,n){"object"==typeof r&&void 0!==t?t.exports=n():(e="undefined"!=typeof globalThis?globalThis:e||self).dayjs=n()}(void 0,(function(){var e=6e4,t=36e5,r="millisecond",n="second",i="minute",s="hour",a="day",o="week",l="month",c="quarter",u="year",h="date",d="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||t[0])+"]"}},g=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},v={s:g,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),i=r%60;return(t<=0?"+":"-")+g(n,2,"0")+":"+g(i,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),i=t.clone().add(n,l),s=r-i<0,a=t.clone().add(n+(s?-1:1),l);return+(-(n+(r-i)/(s?i-a:a-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:l,y:u,w:o,d:a,D:h,h:s,m:i,s:n,ms:r,Q:c}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",b={};b[y]=m;var w="$isDayjsObject",x=function(e){return e instanceof E||!(!e||!e[w])},S=function e(t,r,n){var i;if(!t)return y;if("string"==typeof t){var s=t.toLowerCase();b[s]&&(i=s),r&&(b[s]=r,i=s);var a=t.split("-");if(!i&&a.length>1)return e(a[0])}else{var o=t.name;b[o]=t,i=o}return!n&&i&&(y=i),i||!n&&y},_=function(e,t){if(x(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new E(r)},C=v;C.l=S,C.i=x,C.w=function(e,t){return _(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var E=function(){function m(e){this.$L=S(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[w]=!0}var g=m.prototype;return g.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(C.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(f);if(n){var i=n[2]-1||0,s=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,s)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,s)}}return new Date(t)}(e),this.init()},g.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},g.$utils=function(){return C},g.isValid=function(){return!(this.$d.toString()===d)},g.isSame=function(e,t){var r=_(e);return this.startOf(t)<=r&&r<=this.endOf(t)},g.isAfter=function(e,t){return _(e)<this.startOf(t)},g.isBefore=function(e,t){return this.endOf(t)<_(e)},g.$g=function(e,t,r){return C.u(e)?this[t]:this.set(r,e)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(e,t){var r=this,c=!!C.u(t)||t,d=C.p(e),f=function(e,t){var n=C.w(r.$u?Date.UTC(r.$y,t,e):new Date(r.$y,t,e),r);return c?n:n.endOf(a)},p=function(e,t){return C.w(r.toDate()[e].apply(r.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(t)),r)},m=this.$W,g=this.$M,v=this.$D,y="set"+(this.$u?"UTC":"");switch(d){case u:return c?f(1,0):f(31,11);case l:return c?f(1,g):f(0,g+1);case o:var b=this.$locale().weekStart||0,w=(m<b?m+7:m)-b;return f(c?v-w:v+(6-w),g);case a:case h:return p(y+"Hours",0);case s:return p(y+"Minutes",1);case i:return p(y+"Seconds",2);case n:return p(y+"Milliseconds",3);default:return this.clone()}},g.endOf=function(e){return this.startOf(e,!1)},g.$set=function(e,t){var o,c=C.p(e),d="set"+(this.$u?"UTC":""),f=(o={},o[a]=d+"Date",o[h]=d+"Date",o[l]=d+"Month",o[u]=d+"FullYear",o[s]=d+"Hours",o[i]=d+"Minutes",o[n]=d+"Seconds",o[r]=d+"Milliseconds",o)[c],p=c===a?this.$D+(t-this.$W):t;if(c===l||c===u){var m=this.clone().set(h,1);m.$d[f](p),m.init(),this.$d=m.set(h,Math.min(this.$D,m.daysInMonth())).$d}else f&&this.$d[f](p);return this.init(),this},g.set=function(e,t){return this.clone().$set(e,t)},g.get=function(e){return this[C.p(e)]()},g.add=function(r,c){var h,d=this;r=Number(r);var f=C.p(c),p=function(e){var t=_(d);return C.w(t.date(t.date()+Math.round(e*r)),d)};if(f===l)return this.set(l,this.$M+r);if(f===u)return this.set(u,this.$y+r);if(f===a)return p(1);if(f===o)return p(7);var m=(h={},h[i]=e,h[s]=t,h[n]=1e3,h)[f]||1,g=this.$d.getTime()+r*m;return C.w(g,this)},g.subtract=function(e,t){return this.add(-1*e,t)},g.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||d;var n=e||"YYYY-MM-DDTHH:mm:ssZ",i=C.z(this),s=this.$H,a=this.$m,o=this.$M,l=r.weekdays,c=r.months,u=r.meridiem,h=function(e,r,i,s){return e&&(e[r]||e(t,n))||i[r].slice(0,s)},f=function(e){return C.s(s%12||12,e,"0")},m=u||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(p,(function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return C.s(t.$y,4,"0");case"M":return o+1;case"MM":return C.s(o+1,2,"0");case"MMM":return h(r.monthsShort,o,c,3);case"MMMM":return h(c,o);case"D":return t.$D;case"DD":return C.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return h(r.weekdaysMin,t.$W,l,2);case"ddd":return h(r.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(s);case"HH":return C.s(s,2,"0");case"h":return f(1);case"hh":return f(2);case"a":return m(s,a,!0);case"A":return m(s,a,!1);case"m":return String(a);case"mm":return C.s(a,2,"0");case"s":return String(t.$s);case"ss":return C.s(t.$s,2,"0");case"SSS":return C.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")}))},g.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},g.diff=function(r,h,d){var f,p=this,m=C.p(h),g=_(r),v=(g.utcOffset()-this.utcOffset())*e,y=this-g,b=function(){return C.m(p,g)};switch(m){case u:f=b()/12;break;case l:f=b();break;case c:f=b()/3;break;case o:f=(y-v)/6048e5;break;case a:f=(y-v)/864e5;break;case s:f=y/t;break;case i:f=y/e;break;case n:f=y/1e3;break;default:f=y}return d?f:C.a(f)},g.daysInMonth=function(){return this.endOf(l).$D},g.$locale=function(){return b[this.$L]},g.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=S(e,t,!0);return n&&(r.$L=n),r},g.clone=function(){return C.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},m}(),A=E.prototype;return _.prototype=A,[["$ms",r],["$s",n],["$m",i],["$H",s],["$W",a],["$M",l],["$y",u],["$D",h]].forEach((function(e){A[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),_.extend=function(e,t){return e.$i||(e(t,E,_),e.$i=!0),_},_.locale=S,_.isDayjs=x,_.unix=function(e){return _(1e3*e)},_.en=b[y],_.Ls=b,_.p={},_}))},{}],392:[function(e,t,r){"use strict";!function(e,n){"object"==typeof r&&void 0!==t?t.exports=n():(e="undefined"!=typeof globalThis?globalThis:e||self).dayjs_plugin_customParseFormat=n()}(void 0,(function(){var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d\d/,n=/\d\d?/,i=/\d*[^-_:/,()\s\d]+/,s={},a=function(e){return(e=+e)+(e>68?1900:2e3)},o=function(e){return function(t){this[e]=+t}},l=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e)return 0;if("Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),r=60*t[1]+(+t[2]||0);return 0===r?0:"+"===t[0]?-r:r}(e)}],c=function(e){var t=s[e];return t&&(t.indexOf?t:t.s.concat(t.f))},u=function(e,t){var r,n=s.meridiem;if(n){for(var i=1;i<=24;i+=1)if(e.indexOf(n(i,0,t))>-1){r=i>12;break}}else r=e===(t?"pm":"PM");return r},h={A:[i,function(e){this.afternoon=u(e,!1)}],a:[i,function(e){this.afternoon=u(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[r,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[n,o("seconds")],ss:[n,o("seconds")],m:[n,o("minutes")],mm:[n,o("minutes")],H:[n,o("hours")],h:[n,o("hours")],HH:[n,o("hours")],hh:[n,o("hours")],D:[n,o("day")],DD:[r,o("day")],Do:[i,function(e){var t=s.ordinal,r=e.match(/\d+/);if(this.day=r[0],t)for(var n=1;n<=31;n+=1)t(n).replace(/\[|\]/g,"")===e&&(this.day=n)}],M:[n,o("month")],MM:[r,o("month")],MMM:[i,function(e){var t=c("months"),r=(c("monthsShort")||t.map((function(e){return e.slice(0,3)}))).indexOf(e)+1;if(r<1)throw new Error;this.month=r%12||r}],MMMM:[i,function(e){var t=c("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,o("year")],YY:[r,function(e){this.year=a(e)}],YYYY:[/\d{4}/,o("year")],Z:l,ZZ:l};function d(r){var n,i;n=r,i=s&&s.formats;for(var a=(r=n.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,r,n){var s=n&&n.toUpperCase();return r||i[n]||e[n]||i[s].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,r){return t||r.slice(1)}))}))).match(t),o=a.length,l=0;l<o;l+=1){var c=a[l],u=h[c],d=u&&u[0],f=u&&u[1];a[l]=f?{regex:d,parser:f}:c.replace(/^\[|\]$/g,"")}return function(e){for(var t={},r=0,n=0;r<o;r+=1){var i=a[r];if("string"==typeof i)n+=i.length;else{var s=i.regex,l=i.parser,c=e.slice(n),u=s.exec(c)[0];l.call(t,u),e=e.replace(u,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var r=e.hours;t?r<12&&(e.hours+=12):12===r&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,r){r.p.customParseFormat=!0,e&&e.parseTwoDigitYear&&(a=e.parseTwoDigitYear);var n=t.prototype,i=n.parse;n.parse=function(e){var t=e.date,n=e.utc,a=e.args;this.$u=n;var o=a[1];if("string"==typeof o){var l=!0===a[2],c=!0===a[3],u=l||c,h=a[2];c&&(h=a[2]),s=this.$locale(),!l&&h&&(s=r.Ls[h]),this.$d=function(e,t,r){try{if(["x","X"].indexOf(t)>-1)return new Date(("X"===t?1e3:1)*e);var n=d(t)(e),i=n.year,s=n.month,a=n.day,o=n.hours,l=n.minutes,c=n.seconds,u=n.milliseconds,h=n.zone,f=new Date,p=a||(i||s?1:f.getDate()),m=i||f.getFullYear(),g=0;i&&!s||(g=s>0?s-1:f.getMonth());var v=o||0,y=l||0,b=c||0,w=u||0;return h?new Date(Date.UTC(m,g,p,v,y,b,w+60*h.offset*1e3)):r?new Date(Date.UTC(m,g,p,v,y,b,w)):new Date(m,g,p,v,y,b,w)}catch(e){return new Date("")}}(t,o,n),this.init(),h&&!0!==h&&(this.$L=this.locale(h).$L),u&&t!=this.format(o)&&(this.$d=new Date("")),s={}}else if(o instanceof Array)for(var f=o.length,p=1;p<=f;p+=1){a[1]=o[p-1];var m=r.apply(this,a);if(m.isValid()){this.$d=m.$d,this.$L=m.$L,this.init();break}p===f&&(this.$d=new Date(""))}else i.call(this,e)}}}))},{}],393:[function(e,t,r){"use strict";!function(e,n){"object"==typeof r&&void 0!==t?t.exports=n():(e="undefined"!=typeof globalThis?globalThis:e||self).dayjs_plugin_utc=n()}(void 0,(function(){var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(n,i,s){var a=i.prototype;s.utc=function(e){return new i({date:e,utc:!0,args:arguments})},a.utc=function(t){var r=s(this.toDate(),{locale:this.$L,utc:!0});return t?r.add(this.utcOffset(),e):r},a.local=function(){return s(this.toDate(),{locale:this.$L,utc:!1})};var o=a.parse;a.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),o.call(this,e)};var l=a.init;a.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else l.call(this)};var c=a.utcOffset;a.utcOffset=function(n,i){var s=this.$utils().u;if(s(n))return this.$u?0:s(this.$offset)?c.call(this):this.$offset;if("string"==typeof n&&null===(n=function(e){void 0===e&&(e="");var n=e.match(t);if(!n)return null;var i=(""+n[0]).match(r)||["-",0,0],s=i[0],a=60*+i[1]+ +i[2];return 0===a?0:"+"===s?a:-a}(n)))return this;var a=Math.abs(n)<=16?60*n:n,o=this;if(i)return o.$offset=a,o.$u=0===n,o;if(0!==n){var l=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(o=this.local().add(a+l,e)).$offset=a,o.$x.$localOffset=l}else o=this.utc();return o};var u=a.format;a.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,t)},a.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},a.isUTC=function(){return!!this.$u},a.toISOString=function(){return this.toDate().toISOString()},a.toString=function(){return this.toDate().toUTCString()};var h=a.toDate;a.toDate=function(e){return"s"===e&&this.$offset?s(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():h.call(this)};var d=a.diff;a.diff=function(e,t,r){if(e&&this.$u===e.$u)return d.call(this,e,t,r);var n=this.local(),i=s(e).local();return d.call(n,i,t,r)}}}))},{}],394:[function(e,t,r){"use strict";r.utils=e("./des/utils"),r.Cipher=e("./des/cipher"),r.DES=e("./des/des"),r.CBC=e("./des/cbc"),r.EDE=e("./des/ede")},{"./des/cbc":395,"./des/cipher":396,"./des/des":397,"./des/ede":398,"./des/utils":399}],395:[function(e,t,r){"use strict";var n=e("minimalistic-assert"),i=e("inherits"),s={};function a(e){n.equal(e.length,8,"Invalid IV length"),this.iv=new Array(8);for(var t=0;t<this.iv.length;t++)this.iv[t]=e[t]}r.instantiate=function(e){function t(t){e.call(this,t),this._cbcInit()}i(t,e);for(var r=Object.keys(s),n=0;n<r.length;n++){var a=r[n];t.prototype[a]=s[a]}return t.create=function(e){return new t(e)},t},s._cbcInit=function(){var e=new a(this.options.iv);this._cbcState=e},s._update=function(e,t,r,n){var i=this._cbcState,s=this.constructor.super_.prototype,a=i.iv;if("encrypt"===this.type){for(var o=0;o<this.blockSize;o++)a[o]^=e[t+o];for(s._update.call(this,a,0,r,n),o=0;o<this.blockSize;o++)a[o]=r[n+o]}else{for(s._update.call(this,e,t,r,n),o=0;o<this.blockSize;o++)r[n+o]^=a[o];for(o=0;o<this.blockSize;o++)a[o]=e[t+o]}}},{inherits:440,"minimalistic-assert":453}],396:[function(e,t,r){"use strict";var n=e("minimalistic-assert");function i(e){this.options=e,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=!1!==e.padding}t.exports=i,i.prototype._init=function(){},i.prototype.update=function(e){return 0===e.length?[]:"decrypt"===this.type?this._updateDecrypt(e):this._updateEncrypt(e)},i.prototype._buffer=function(e,t){for(var r=Math.min(this.buffer.length-this.bufferOff,e.length-t),n=0;n<r;n++)this.buffer[this.bufferOff+n]=e[t+n];return this.bufferOff+=r,r},i.prototype._flushBuffer=function(e,t){return this._update(this.buffer,0,e,t),this.bufferOff=0,this.blockSize},i.prototype._updateEncrypt=function(e){var t=0,r=0,n=(this.bufferOff+e.length)/this.blockSize|0,i=new Array(n*this.blockSize);0!==this.bufferOff&&(t+=this._buffer(e,t),this.bufferOff===this.buffer.length&&(r+=this._flushBuffer(i,r)));for(var s=e.length-(e.length-t)%this.blockSize;t<s;t+=this.blockSize)this._update(e,t,i,r),r+=this.blockSize;for(;t<e.length;t++,this.bufferOff++)this.buffer[this.bufferOff]=e[t];return i},i.prototype._updateDecrypt=function(e){for(var t=0,r=0,n=Math.ceil((this.bufferOff+e.length)/this.blockSize)-1,i=new Array(n*this.blockSize);n>0;n--)t+=this._buffer(e,t),r+=this._flushBuffer(i,r);return t+=this._buffer(e,t),i},i.prototype.final=function(e){var t,r;return e&&(t=this.update(e)),r="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),t?t.concat(r):r},i.prototype._pad=function(e,t){if(0===t)return!1;for(;t<e.length;)e[t++]=0;return!0},i.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var e=new Array(this.blockSize);return this._update(this.buffer,0,e,0),e},i.prototype._unpad=function(e){return e},i.prototype._finalDecrypt=function(){n.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var e=new Array(this.blockSize);return this._flushBuffer(e,0),this._unpad(e)}},{"minimalistic-assert":453}],397:[function(e,t,r){"use strict";var n=e("minimalistic-assert"),i=e("inherits"),s=e("./utils"),a=e("./cipher");function o(){this.tmp=new Array(2),this.keys=null}function l(e){a.call(this,e);var t=new o;this._desState=t,this.deriveKeys(t,e.key)}i(l,a),t.exports=l,l.create=function(e){return new l(e)};var c=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];l.prototype.deriveKeys=function(e,t){e.keys=new Array(32),n.equal(t.length,this.blockSize,"Invalid key length");var r=s.readUInt32BE(t,0),i=s.readUInt32BE(t,4);s.pc1(r,i,e.tmp,0),r=e.tmp[0],i=e.tmp[1];for(var a=0;a<e.keys.length;a+=2){var o=c[a>>>1];r=s.r28shl(r,o),i=s.r28shl(i,o),s.pc2(r,i,e.keys,a)}},l.prototype._update=function(e,t,r,n){var i=this._desState,a=s.readUInt32BE(e,t),o=s.readUInt32BE(e,t+4);s.ip(a,o,i.tmp,0),a=i.tmp[0],o=i.tmp[1],"encrypt"===this.type?this._encrypt(i,a,o,i.tmp,0):this._decrypt(i,a,o,i.tmp,0),a=i.tmp[0],o=i.tmp[1],s.writeUInt32BE(r,a,n),s.writeUInt32BE(r,o,n+4)},l.prototype._pad=function(e,t){if(!1===this.padding)return!1;for(var r=e.length-t,n=t;n<e.length;n++)e[n]=r;return!0},l.prototype._unpad=function(e){if(!1===this.padding)return e;for(var t=e[e.length-1],r=e.length-t;r<e.length;r++)n.equal(e[r],t);return e.slice(0,e.length-t)},l.prototype._encrypt=function(e,t,r,n,i){for(var a=t,o=r,l=0;l<e.keys.length;l+=2){var c=e.keys[l],u=e.keys[l+1];s.expand(o,e.tmp,0),c^=e.tmp[0],u^=e.tmp[1];var h=s.substitute(c,u),d=o;o=(a^s.permute(h))>>>0,a=d}s.rip(o,a,n,i)},l.prototype._decrypt=function(e,t,r,n,i){for(var a=r,o=t,l=e.keys.length-2;l>=0;l-=2){var c=e.keys[l],u=e.keys[l+1];s.expand(a,e.tmp,0),c^=e.tmp[0],u^=e.tmp[1];var h=s.substitute(c,u),d=a;a=(o^s.permute(h))>>>0,o=d}s.rip(a,o,n,i)}},{"./cipher":396,"./utils":399,inherits:440,"minimalistic-assert":453}],398:[function(e,t,r){"use strict";var n=e("minimalistic-assert"),i=e("inherits"),s=e("./cipher"),a=e("./des");function o(e,t){n.equal(t.length,24,"Invalid key length");var r=t.slice(0,8),i=t.slice(8,16),s=t.slice(16,24);this.ciphers="encrypt"===e?[a.create({type:"encrypt",key:r}),a.create({type:"decrypt",key:i}),a.create({type:"encrypt",key:s})]:[a.create({type:"decrypt",key:s}),a.create({type:"encrypt",key:i}),a.create({type:"decrypt",key:r})]}function l(e){s.call(this,e);var t=new o(this.type,this.options.key);this._edeState=t}i(l,s),t.exports=l,l.create=function(e){return new l(e)},l.prototype._update=function(e,t,r,n){var i=this._edeState;i.ciphers[0]._update(e,t,r,n),i.ciphers[1]._update(r,n,r,n),i.ciphers[2]._update(r,n,r,n)},l.prototype._pad=a.prototype._pad,l.prototype._unpad=a.prototype._unpad},{"./cipher":396,"./des":397,inherits:440,"minimalistic-assert":453}],399:[function(e,t,r){"use strict";r.readUInt32BE=function(e,t){return(e[0+t]<<24|e[1+t]<<16|e[2+t]<<8|e[3+t])>>>0},r.writeUInt32BE=function(e,t,r){e[0+r]=t>>>24,e[1+r]=t>>>16&255,e[2+r]=t>>>8&255,e[3+r]=255&t},r.ip=function(e,t,r,n){for(var i=0,s=0,a=6;a>=0;a-=2){for(var o=0;o<=24;o+=8)i<<=1,i|=t>>>o+a&1;for(o=0;o<=24;o+=8)i<<=1,i|=e>>>o+a&1}for(a=6;a>=0;a-=2){for(o=1;o<=25;o+=8)s<<=1,s|=t>>>o+a&1;for(o=1;o<=25;o+=8)s<<=1,s|=e>>>o+a&1}r[n+0]=i>>>0,r[n+1]=s>>>0},r.rip=function(e,t,r,n){for(var i=0,s=0,a=0;a<4;a++)for(var o=24;o>=0;o-=8)i<<=1,i|=t>>>o+a&1,i<<=1,i|=e>>>o+a&1;for(a=4;a<8;a++)for(o=24;o>=0;o-=8)s<<=1,s|=t>>>o+a&1,s<<=1,s|=e>>>o+a&1;r[n+0]=i>>>0,r[n+1]=s>>>0},r.pc1=function(e,t,r,n){for(var i=0,s=0,a=7;a>=5;a--){for(var o=0;o<=24;o+=8)i<<=1,i|=t>>o+a&1;for(o=0;o<=24;o+=8)i<<=1,i|=e>>o+a&1}for(o=0;o<=24;o+=8)i<<=1,i|=t>>o+a&1;for(a=1;a<=3;a++){for(o=0;o<=24;o+=8)s<<=1,s|=t>>o+a&1;for(o=0;o<=24;o+=8)s<<=1,s|=e>>o+a&1}for(o=0;o<=24;o+=8)s<<=1,s|=e>>o+a&1;r[n+0]=i>>>0,r[n+1]=s>>>0},r.r28shl=function(e,t){return e<<t&268435455|e>>>28-t};var n=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];r.pc2=function(e,t,r,i){for(var s=0,a=0,o=n.length>>>1,l=0;l<o;l++)s<<=1,s|=e>>>n[l]&1;for(l=o;l<n.length;l++)a<<=1,a|=t>>>n[l]&1;r[i+0]=s>>>0,r[i+1]=a>>>0},r.expand=function(e,t,r){var n=0,i=0;n=(1&e)<<5|e>>>27;for(var s=23;s>=15;s-=4)n<<=6,n|=e>>>s&63;for(s=11;s>=3;s-=4)i|=e>>>s&63,i<<=6;i|=(31&e)<<1|e>>>31,t[r+0]=n>>>0,t[r+1]=i>>>0};var i=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];r.substitute=function(e,t){for(var r=0,n=0;n<4;n++)r<<=4,r|=i[64*n+(e>>>18-6*n&63)];for(n=0;n<4;n++)r<<=4,r|=i[256+64*n+(t>>>18-6*n&63)];return r>>>0};var s=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];r.permute=function(e){for(var t=0,r=0;r<s.length;r++)t<<=1,t|=e>>>s[r]&1;return t>>>0},r.padSplit=function(e,t,r){for(var n=e.toString(2);n.length<t;)n="0"+n;for(var i=[],s=0;s<t;s+=r)i.push(n.slice(s,s+r));return i.join(" ")}},{}],400:[function(e,t,r){(function(t){(function(){"use strict";var n=e("./lib/generatePrime"),i=e("./lib/primes.json"),s=e("./lib/dh"),a={binary:!0,hex:!0,base64:!0};r.DiffieHellmanGroup=r.createDiffieHellmanGroup=r.getDiffieHellman=function(e){var r=new t(i[e].prime,"hex"),n=new t(i[e].gen,"hex");return new s(r,n)},r.createDiffieHellman=r.DiffieHellman=function e(r,i,o,l){return t.isBuffer(i)||void 0===a[i]?e(r,"binary",i,o):(i=i||"binary",l=l||"binary",o=o||new t([2]),t.isBuffer(o)||(o=new t(o,l)),"number"==typeof r?new s(n(r,o),o,!0):(t.isBuffer(r)||(r=new t(r,i)),new s(r,o,!0)))}}).call(this)}).call(this,e("buffer").Buffer)},{"./lib/dh":401,"./lib/generatePrime":402,"./lib/primes.json":403,buffer:220}],401:[function(e,t,r){(function(r){(function(){"use strict";var n=e("bn.js"),i=new(e("miller-rabin")),s=new n(24),a=new n(11),o=new n(10),l=new n(3),c=new n(7),u=e("./generatePrime"),h=e("randombytes");function d(e,t){return t=t||"utf8",r.isBuffer(e)||(e=new r(e,t)),this._pub=new n(e),this}function f(e,t){return t=t||"utf8",r.isBuffer(e)||(e=new r(e,t)),this._priv=new n(e),this}t.exports=m;var p={};function m(e,t,r){this.setGenerator(t),this.__prime=new n(e),this._prime=n.mont(this.__prime),this._primeLen=e.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,r?(this.setPublicKey=d,this.setPrivateKey=f):this._primeCode=8}function g(e,t){var n=new r(e.toArray());return t?n.toString(t):n}Object.defineProperty(m.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=function(e,t){var r=t.toString("hex"),n=[r,e.toString(16)].join("_");if(n in p)return p[n];var h,d=0;if(e.isEven()||!u.simpleSieve||!u.fermatTest(e)||!i.test(e))return d+=1,d+="02"===r||"05"===r?8:4,p[n]=d,d;switch(i.test(e.shrn(1))||(d+=2),r){case"02":e.mod(s).cmp(a)&&(d+=8);break;case"05":(h=e.mod(o)).cmp(l)&&h.cmp(c)&&(d+=8);break;default:d+=4}return p[n]=d,d}(this.__prime,this.__gen)),this._primeCode}}),m.prototype.generateKeys=function(){return this._priv||(this._priv=new n(h(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},m.prototype.computeSecret=function(e){var t=(e=(e=new n(e)).toRed(this._prime)).redPow(this._priv).fromRed(),i=new r(t.toArray()),s=this.getPrime();if(i.length<s.length){var a=new r(s.length-i.length);a.fill(0),i=r.concat([a,i])}return i},m.prototype.getPublicKey=function(e){return g(this._pub,e)},m.prototype.getPrivateKey=function(e){return g(this._priv,e)},m.prototype.getPrime=function(e){return g(this.__prime,e)},m.prototype.getGenerator=function(e){return g(this._gen,e)},m.prototype.setGenerator=function(e,t){return t=t||"utf8",r.isBuffer(e)||(e=new r(e,t)),this.__gen=e,this._gen=new n(e),this}}).call(this)}).call(this,e("buffer").Buffer)},{"./generatePrime":402,"bn.js":404,buffer:220,"miller-rabin":451,randombytes:475}],402:[function(e,t,r){"use strict";var n=e("randombytes");t.exports=y,y.simpleSieve=g,y.fermatTest=v;var i=e("bn.js"),s=new i(24),a=new(e("miller-rabin")),o=new i(1),l=new i(2),c=new i(5),u=(new i(16),new i(8),new i(10)),h=new i(3),d=(new i(7),new i(11)),f=new i(4),p=(new i(12),null);function m(){if(null!==p)return p;var e=[];e[0]=2;for(var t=1,r=3;r<1048576;r+=2){for(var n=Math.ceil(Math.sqrt(r)),i=0;i<t&&e[i]<=n&&r%e[i]!=0;i++);t!==i&&e[i]<=n||(e[t++]=r)}return p=e,e}function g(e){for(var t=m(),r=0;r<t.length;r++)if(0===e.modn(t[r]))return 0===e.cmpn(t[r]);return!0}function v(e){var t=i.mont(e);return 0===l.toRed(t).redPow(e.subn(1)).fromRed().cmpn(1)}function y(e,t){if(e<16)return new i(2===t||5===t?[140,123]:[140,39]);var r,p;for(t=new i(t);;){for(r=new i(n(Math.ceil(e/8)));r.bitLength()>e;)r.ishrn(1);if(r.isEven()&&r.iadd(o),r.testn(1)||r.iadd(l),t.cmp(l)){if(!t.cmp(c))for(;r.mod(u).cmp(h);)r.iadd(f)}else for(;r.mod(s).cmp(d);)r.iadd(f);if(g(p=r.shrn(1))&&g(r)&&v(p)&&v(r)&&a.test(p)&&a.test(r))return r}}},{"bn.js":404,"miller-rabin":451,randombytes:475}],403:[function(e,t,r){t.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],404:[function(e,t,r){arguments[4][184][0].apply(r,arguments)},{buffer:188,dup:184}],405:[function(e,t,r){"use strict";var n=r;n.version=e("../package.json").version,n.utils=e("./elliptic/utils"),n.rand=e("brorand"),n.curve=e("./elliptic/curve"),n.curves=e("./elliptic/curves"),n.ec=e("./elliptic/ec"),n.eddsa=e("./elliptic/eddsa")},{"../package.json":421,"./elliptic/curve":408,"./elliptic/curves":411,"./elliptic/ec":412,"./elliptic/eddsa":415,"./elliptic/utils":419,brorand:187}],406:[function(e,t,r){"use strict";var n=e("bn.js"),i=e("../utils"),s=i.getNAF,a=i.getJSF,o=i.assert;function l(e,t){this.type=e,this.p=new n(t.p,16),this.red=t.prime?n.red(t.prime):n.mont(this.p),this.zero=new n(0).toRed(this.red),this.one=new n(1).toRed(this.red),this.two=new n(2).toRed(this.red),this.n=t.n&&new n(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function c(e,t){this.curve=e,this.type=t,this.precomputed=null}t.exports=l,l.prototype.point=function(){throw new Error("Not implemented")},l.prototype.validate=function(){throw new Error("Not implemented")},l.prototype._fixedNafMul=function(e,t){o(e.precomputed);var r=e._getDoubles(),n=s(t,1,this._bitLength),i=(1<<r.step+1)-(r.step%2==0?2:1);i/=3;var a,l,c=[];for(a=0;a<n.length;a+=r.step){l=0;for(var u=a+r.step-1;u>=a;u--)l=(l<<1)+n[u];c.push(l)}for(var h=this.jpoint(null,null,null),d=this.jpoint(null,null,null),f=i;f>0;f--){for(a=0;a<c.length;a++)(l=c[a])===f?d=d.mixedAdd(r.points[a]):l===-f&&(d=d.mixedAdd(r.points[a].neg()));h=h.add(d)}return h.toP()},l.prototype._wnafMul=function(e,t){var r=4,n=e._getNAFPoints(r);r=n.wnd;for(var i=n.points,a=s(t,r,this._bitLength),l=this.jpoint(null,null,null),c=a.length-1;c>=0;c--){for(var u=0;c>=0&&0===a[c];c--)u++;if(c>=0&&u++,l=l.dblp(u),c<0)break;var h=a[c];o(0!==h),l="affine"===e.type?h>0?l.mixedAdd(i[h-1>>1]):l.mixedAdd(i[-h-1>>1].neg()):h>0?l.add(i[h-1>>1]):l.add(i[-h-1>>1].neg())}return"affine"===e.type?l.toP():l},l.prototype._wnafMulAdd=function(e,t,r,n,i){var o,l,c,u=this._wnafT1,h=this._wnafT2,d=this._wnafT3,f=0;for(o=0;o<n;o++){var p=(c=t[o])._getNAFPoints(e);u[o]=p.wnd,h[o]=p.points}for(o=n-1;o>=1;o-=2){var m=o-1,g=o;if(1===u[m]&&1===u[g]){var v=[t[m],null,null,t[g]];0===t[m].y.cmp(t[g].y)?(v[1]=t[m].add(t[g]),v[2]=t[m].toJ().mixedAdd(t[g].neg())):0===t[m].y.cmp(t[g].y.redNeg())?(v[1]=t[m].toJ().mixedAdd(t[g]),v[2]=t[m].add(t[g].neg())):(v[1]=t[m].toJ().mixedAdd(t[g]),v[2]=t[m].toJ().mixedAdd(t[g].neg()));var y=[-3,-1,-5,-7,0,7,5,1,3],b=a(r[m],r[g]);for(f=Math.max(b[0].length,f),d[m]=new Array(f),d[g]=new Array(f),l=0;l<f;l++){var w=0|b[0][l],x=0|b[1][l];d[m][l]=y[3*(w+1)+(x+1)],d[g][l]=0,h[m]=v}}else d[m]=s(r[m],u[m],this._bitLength),d[g]=s(r[g],u[g],this._bitLength),f=Math.max(d[m].length,f),f=Math.max(d[g].length,f)}var S=this.jpoint(null,null,null),_=this._wnafT4;for(o=f;o>=0;o--){for(var C=0;o>=0;){var E=!0;for(l=0;l<n;l++)_[l]=0|d[l][o],0!==_[l]&&(E=!1);if(!E)break;C++,o--}if(o>=0&&C++,S=S.dblp(C),o<0)break;for(l=0;l<n;l++){var A=_[l];0!==A&&(A>0?c=h[l][A-1>>1]:A<0&&(c=h[l][-A-1>>1].neg()),S="affine"===c.type?S.mixedAdd(c):S.add(c))}}for(o=0;o<n;o++)h[o]=null;return i?S:S.toP()},l.BasePoint=c,c.prototype.eq=function(){throw new Error("Not implemented")},c.prototype.validate=function(){return this.curve.validate(this)},l.prototype.decodePoint=function(e,t){e=i.toArray(e,t);var r=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*r)return 6===e[0]?o(e[e.length-1]%2==0):7===e[0]&&o(e[e.length-1]%2==1),this.point(e.slice(1,1+r),e.slice(1+r,1+2*r));if((2===e[0]||3===e[0])&&e.length-1===r)return this.pointFromX(e.slice(1,1+r),3===e[0]);throw new Error("Unknown point format")},c.prototype.encodeCompressed=function(e){return this.encode(e,!0)},c.prototype._encode=function(e){var t=this.curve.p.byteLength(),r=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(r):[4].concat(r,this.getY().toArray("be",t))},c.prototype.encode=function(e,t){return i.encode(this._encode(t),e)},c.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},c.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},c.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var r=[this],n=this,i=0;i<t;i+=e){for(var s=0;s<e;s++)n=n.dbl();r.push(n)}return{step:e,points:r}},c.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],r=(1<<e)-1,n=1===r?null:this.dbl(),i=1;i<r;i++)t[i]=t[i-1].add(n);return{wnd:e,points:t}},c.prototype._getBeta=function(){return null},c.prototype.dblp=function(e){for(var t=this,r=0;r<e;r++)t=t.dbl();return t}},{"../utils":419,"bn.js":420}],407:[function(e,t,r){"use strict";var n=e("../utils"),i=e("bn.js"),s=e("inherits"),a=e("./base"),o=n.assert;function l(e){this.twisted=1!=(0|e.a),this.mOneA=this.twisted&&-1==(0|e.a),this.extended=this.mOneA,a.call(this,"edwards",e),this.a=new i(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new i(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new i(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),o(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|e.c)}function c(e,t,r,n,s){a.BasePoint.call(this,e,"projective"),null===t&&null===r&&null===n?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new i(t,16),this.y=new i(r,16),this.z=n?new i(n,16):this.curve.one,this.t=s&&new i(s,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}s(l,a),t.exports=l,l.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},l.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},l.prototype.jpoint=function(e,t,r,n){return this.point(e,t,r,n)},l.prototype.pointFromX=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),n=this.c2.redSub(this.a.redMul(r)),s=this.one.redSub(this.c2.redMul(this.d).redMul(r)),a=n.redMul(s.redInvm()),o=a.redSqrt();if(0!==o.redSqr().redSub(a).cmp(this.zero))throw new Error("invalid point");var l=o.fromRed().isOdd();return(t&&!l||!t&&l)&&(o=o.redNeg()),this.point(e,o)},l.prototype.pointFromY=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),n=r.redSub(this.c2),s=r.redMul(this.d).redMul(this.c2).redSub(this.a),a=n.redMul(s.redInvm());if(0===a.cmp(this.zero)){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var o=a.redSqrt();if(0!==o.redSqr().redSub(a).cmp(this.zero))throw new Error("invalid point");return o.fromRed().isOdd()!==t&&(o=o.redNeg()),this.point(o,e)},l.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),r=e.y.redSqr(),n=t.redMul(this.a).redAdd(r),i=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(r)));return 0===n.cmp(i)},s(c,a.BasePoint),l.prototype.pointFromJSON=function(e){return c.fromJSON(this,e)},l.prototype.point=function(e,t,r,n){return new c(this,e,t,r,n)},c.fromJSON=function(e,t){return new c(e,t[0],t[1],t[2])},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},c.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr();r=r.redIAdd(r);var n=this.curve._mulA(e),i=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),s=n.redAdd(t),a=s.redSub(r),o=n.redSub(t),l=i.redMul(a),c=s.redMul(o),u=i.redMul(o),h=a.redMul(s);return this.curve.point(l,c,h,u)},c.prototype._projDbl=function(){var e,t,r,n,i,s,a=this.x.redAdd(this.y).redSqr(),o=this.x.redSqr(),l=this.y.redSqr();if(this.curve.twisted){var c=(n=this.curve._mulA(o)).redAdd(l);this.zOne?(e=a.redSub(o).redSub(l).redMul(c.redSub(this.curve.two)),t=c.redMul(n.redSub(l)),r=c.redSqr().redSub(c).redSub(c)):(i=this.z.redSqr(),s=c.redSub(i).redISub(i),e=a.redSub(o).redISub(l).redMul(s),t=c.redMul(n.redSub(l)),r=c.redMul(s))}else n=o.redAdd(l),i=this.curve._mulC(this.z).redSqr(),s=n.redSub(i).redSub(i),e=this.curve._mulC(a.redISub(n)).redMul(s),t=this.curve._mulC(n).redMul(o.redISub(l)),r=n.redMul(s);return this.curve.point(e,t,r)},c.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},c.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),r=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),i=this.z.redMul(e.z.redAdd(e.z)),s=r.redSub(t),a=i.redSub(n),o=i.redAdd(n),l=r.redAdd(t),c=s.redMul(a),u=o.redMul(l),h=s.redMul(l),d=a.redMul(o);return this.curve.point(c,u,d,h)},c.prototype._projAdd=function(e){var t,r,n=this.z.redMul(e.z),i=n.redSqr(),s=this.x.redMul(e.x),a=this.y.redMul(e.y),o=this.curve.d.redMul(s).redMul(a),l=i.redSub(o),c=i.redAdd(o),u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(s).redISub(a),h=n.redMul(l).redMul(u);return this.curve.twisted?(t=n.redMul(c).redMul(a.redSub(this.curve._mulA(s))),r=l.redMul(c)):(t=n.redMul(c).redMul(a.redSub(s)),r=this.curve._mulC(l).redMul(c)),this.curve.point(h,t,r)},c.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},c.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},c.prototype.mulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!1)},c.prototype.jmulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!0)},c.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},c.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()},c.prototype.getY=function(){return this.normalize(),this.y.fromRed()},c.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},c.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(t))return!0;for(var r=e.clone(),n=this.curve.redN.redMul(this.z);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(n),0===this.x.cmp(t))return!0}},c.prototype.toP=c.prototype.normalize,c.prototype.mixedAdd=c.prototype.add},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],408:[function(e,t,r){"use strict";var n=r;n.base=e("./base"),n.short=e("./short"),n.mont=e("./mont"),n.edwards=e("./edwards")},{"./base":406,"./edwards":407,"./mont":409,"./short":410}],409:[function(e,t,r){"use strict";var n=e("bn.js"),i=e("inherits"),s=e("./base"),a=e("../utils");function o(e){s.call(this,"mont",e),this.a=new n(e.a,16).toRed(this.red),this.b=new n(e.b,16).toRed(this.red),this.i4=new n(4).toRed(this.red).redInvm(),this.two=new n(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function l(e,t,r){s.BasePoint.call(this,e,"projective"),null===t&&null===r?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new n(t,16),this.z=new n(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}i(o,s),t.exports=o,o.prototype.validate=function(e){var t=e.normalize().x,r=t.redSqr(),n=r.redMul(t).redAdd(r.redMul(this.a)).redAdd(t);return 0===n.redSqrt().redSqr().cmp(n)},i(l,s.BasePoint),o.prototype.decodePoint=function(e,t){return this.point(a.toArray(e,t),1)},o.prototype.point=function(e,t){return new l(this,e,t)},o.prototype.pointFromJSON=function(e){return l.fromJSON(this,e)},l.prototype.precompute=function(){},l.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},l.fromJSON=function(e,t){return new l(e,t[0],t[1]||e.one)},l.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},l.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},l.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),r=e.redSub(t),n=e.redMul(t),i=r.redMul(t.redAdd(this.curve.a24.redMul(r)));return this.curve.point(n,i)},l.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},l.prototype.diffAdd=function(e,t){var r=this.x.redAdd(this.z),n=this.x.redSub(this.z),i=e.x.redAdd(e.z),s=e.x.redSub(e.z).redMul(r),a=i.redMul(n),o=t.z.redMul(s.redAdd(a).redSqr()),l=t.x.redMul(s.redISub(a).redSqr());return this.curve.point(o,l)},l.prototype.mul=function(e){for(var t=e.clone(),r=this,n=this.curve.point(null,null),i=[];0!==t.cmpn(0);t.iushrn(1))i.push(t.andln(1));for(var s=i.length-1;s>=0;s--)0===i[s]?(r=r.diffAdd(n,this),n=n.dbl()):(n=r.diffAdd(n,this),r=r.dbl());return n},l.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},l.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},l.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},l.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},l.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],410:[function(e,t,r){"use strict";var n=e("../utils"),i=e("bn.js"),s=e("inherits"),a=e("./base"),o=n.assert;function l(e){a.call(this,"short",e),this.a=new i(e.a,16).toRed(this.red),this.b=new i(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function c(e,t,r,n){a.BasePoint.call(this,e,"affine"),null===t&&null===r?(this.x=null,this.y=null,this.inf=!0):(this.x=new i(t,16),this.y=new i(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function u(e,t,r,n){a.BasePoint.call(this,e,"jacobian"),null===t&&null===r&&null===n?(this.x=this.curve.one,this.y=this.curve.one,this.z=new i(0)):(this.x=new i(t,16),this.y=new i(r,16),this.z=new i(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}s(l,a),t.exports=l,l.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var t,r;if(e.beta)t=new i(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);t=(t=n[0].cmp(n[1])<0?n[0]:n[1]).toRed(this.red)}if(e.lambda)r=new i(e.lambda,16);else{var s=this._getEndoRoots(this.n);0===this.g.mul(s[0]).x.cmp(this.g.x.redMul(t))?r=s[0]:(r=s[1],o(0===this.g.mul(r).x.cmp(this.g.x.redMul(t))))}return{beta:t,lambda:r,basis:e.basis?e.basis.map((function(e){return{a:new i(e.a,16),b:new i(e.b,16)}})):this._getEndoBasis(r)}}},l.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:i.mont(e),r=new i(2).toRed(t).redInvm(),n=r.redNeg(),s=new i(3).toRed(t).redNeg().redSqrt().redMul(r);return[n.redAdd(s).fromRed(),n.redSub(s).fromRed()]},l.prototype._getEndoBasis=function(e){for(var t,r,n,s,a,o,l,c,u,h=this.n.ushrn(Math.floor(this.n.bitLength()/2)),d=e,f=this.n.clone(),p=new i(1),m=new i(0),g=new i(0),v=new i(1),y=0;0!==d.cmpn(0);){var b=f.div(d);c=f.sub(b.mul(d)),u=g.sub(b.mul(p));var w=v.sub(b.mul(m));if(!n&&c.cmp(h)<0)t=l.neg(),r=p,n=c.neg(),s=u;else if(n&&2==++y)break;l=c,f=d,d=c,g=p,p=u,v=m,m=w}a=c.neg(),o=u;var x=n.sqr().add(s.sqr());return a.sqr().add(o.sqr()).cmp(x)>=0&&(a=t,o=r),n.negative&&(n=n.neg(),s=s.neg()),a.negative&&(a=a.neg(),o=o.neg()),[{a:n,b:s},{a:a,b:o}]},l.prototype._endoSplit=function(e){var t=this.endo.basis,r=t[0],n=t[1],i=n.b.mul(e).divRound(this.n),s=r.b.neg().mul(e).divRound(this.n),a=i.mul(r.a),o=s.mul(n.a),l=i.mul(r.b),c=s.mul(n.b);return{k1:e.sub(a).sub(o),k2:l.add(c).neg()}},l.prototype.pointFromX=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=r.redSqrt();if(0!==n.redSqr().redSub(r).cmp(this.zero))throw new Error("invalid point");var s=n.fromRed().isOdd();return(t&&!s||!t&&s)&&(n=n.redNeg()),this.point(e,n)},l.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,r=e.y,n=this.a.redMul(t),i=t.redSqr().redMul(t).redIAdd(n).redIAdd(this.b);return 0===r.redSqr().redISub(i).cmpn(0)},l.prototype._endoWnafMulAdd=function(e,t,r){for(var n=this._endoWnafT1,i=this._endoWnafT2,s=0;s<e.length;s++){var a=this._endoSplit(t[s]),o=e[s],l=o._getBeta();a.k1.negative&&(a.k1.ineg(),o=o.neg(!0)),a.k2.negative&&(a.k2.ineg(),l=l.neg(!0)),n[2*s]=o,n[2*s+1]=l,i[2*s]=a.k1,i[2*s+1]=a.k2}for(var c=this._wnafMulAdd(1,n,i,2*s,r),u=0;u<2*s;u++)n[u]=null,i[u]=null;return c},s(c,a.BasePoint),l.prototype.point=function(e,t,r){return new c(this,e,t,r)},l.prototype.pointFromJSON=function(e,t){return c.fromJSON(this,e,t)},c.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var r=this.curve,n=function(e){return r.point(e.x.redMul(r.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return t}},c.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},c.fromJSON=function(e,t,r){"string"==typeof t&&(t=JSON.parse(t));var n=e.point(t[0],t[1],r);if(!t[2])return n;function i(t){return e.point(t[0],t[1],r)}var s=t[2];return n.precomputed={beta:null,doubles:s.doubles&&{step:s.doubles.step,points:[n].concat(s.doubles.points.map(i))},naf:s.naf&&{wnd:s.naf.wnd,points:[n].concat(s.naf.points.map(i))}},n},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return this.inf},c.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var r=t.redSqr().redISub(this.x).redISub(e.x),n=t.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,n)},c.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,r=this.x.redSqr(),n=e.redInvm(),i=r.redAdd(r).redIAdd(r).redIAdd(t).redMul(n),s=i.redSqr().redISub(this.x.redAdd(this.x)),a=i.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,a)},c.prototype.getX=function(){return this.x.fromRed()},c.prototype.getY=function(){return this.y.fromRed()},c.prototype.mul=function(e){return e=new i(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},c.prototype.mulAdd=function(e,t,r){var n=[this,t],i=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(n,i):this.curve._wnafMulAdd(1,n,i,2)},c.prototype.jmulAdd=function(e,t,r){var n=[this,t],i=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(n,i,!0):this.curve._wnafMulAdd(1,n,i,2,!0)},c.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},c.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var r=this.precomputed,n=function(e){return e.neg()};t.precomputed={naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(n)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(n)}}}return t},c.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},s(u,a.BasePoint),l.prototype.jpoint=function(e,t,r){return new u(this,e,t,r)},u.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),r=this.x.redMul(t),n=this.y.redMul(t).redMul(e);return this.curve.point(r,n)},u.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},u.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),r=this.z.redSqr(),n=this.x.redMul(t),i=e.x.redMul(r),s=this.y.redMul(t.redMul(e.z)),a=e.y.redMul(r.redMul(this.z)),o=n.redSub(i),l=s.redSub(a);if(0===o.cmpn(0))return 0!==l.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=o.redSqr(),u=c.redMul(o),h=n.redMul(c),d=l.redSqr().redIAdd(u).redISub(h).redISub(h),f=l.redMul(h.redISub(d)).redISub(s.redMul(u)),p=this.z.redMul(e.z).redMul(o);return this.curve.jpoint(d,f,p)},u.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),r=this.x,n=e.x.redMul(t),i=this.y,s=e.y.redMul(t).redMul(this.z),a=r.redSub(n),o=i.redSub(s);if(0===a.cmpn(0))return 0!==o.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var l=a.redSqr(),c=l.redMul(a),u=r.redMul(l),h=o.redSqr().redIAdd(c).redISub(u).redISub(u),d=o.redMul(u.redISub(h)).redISub(i.redMul(c)),f=this.z.redMul(a);return this.curve.jpoint(h,d,f)},u.prototype.dblp=function(e){if(0===e)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var r=this;for(t=0;t<e;t++)r=r.dbl();return r}var n=this.curve.a,i=this.curve.tinv,s=this.x,a=this.y,o=this.z,l=o.redSqr().redSqr(),c=a.redAdd(a);for(t=0;t<e;t++){var u=s.redSqr(),h=c.redSqr(),d=h.redSqr(),f=u.redAdd(u).redIAdd(u).redIAdd(n.redMul(l)),p=s.redMul(h),m=f.redSqr().redISub(p.redAdd(p)),g=p.redISub(m),v=f.redMul(g);v=v.redIAdd(v).redISub(d);var y=c.redMul(o);t+1<e&&(l=l.redMul(d)),s=m,o=y,c=v}return this.curve.jpoint(s,c.redMul(i),o)},u.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},u.prototype._zeroDbl=function(){var e,t,r;if(this.zOne){var n=this.x.redSqr(),i=this.y.redSqr(),s=i.redSqr(),a=this.x.redAdd(i).redSqr().redISub(n).redISub(s);a=a.redIAdd(a);var o=n.redAdd(n).redIAdd(n),l=o.redSqr().redISub(a).redISub(a),c=s.redIAdd(s);c=(c=c.redIAdd(c)).redIAdd(c),e=l,t=o.redMul(a.redISub(l)).redISub(c),r=this.y.redAdd(this.y)}else{var u=this.x.redSqr(),h=this.y.redSqr(),d=h.redSqr(),f=this.x.redAdd(h).redSqr().redISub(u).redISub(d);f=f.redIAdd(f);var p=u.redAdd(u).redIAdd(u),m=p.redSqr(),g=d.redIAdd(d);g=(g=g.redIAdd(g)).redIAdd(g),e=m.redISub(f).redISub(f),t=p.redMul(f.redISub(e)).redISub(g),r=(r=this.y.redMul(this.z)).redIAdd(r)}return this.curve.jpoint(e,t,r)},u.prototype._threeDbl=function(){var e,t,r;if(this.zOne){var n=this.x.redSqr(),i=this.y.redSqr(),s=i.redSqr(),a=this.x.redAdd(i).redSqr().redISub(n).redISub(s);a=a.redIAdd(a);var o=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),l=o.redSqr().redISub(a).redISub(a);e=l;var c=s.redIAdd(s);c=(c=c.redIAdd(c)).redIAdd(c),t=o.redMul(a.redISub(l)).redISub(c),r=this.y.redAdd(this.y)}else{var u=this.z.redSqr(),h=this.y.redSqr(),d=this.x.redMul(h),f=this.x.redSub(u).redMul(this.x.redAdd(u));f=f.redAdd(f).redIAdd(f);var p=d.redIAdd(d),m=(p=p.redIAdd(p)).redAdd(p);e=f.redSqr().redISub(m),r=this.y.redAdd(this.z).redSqr().redISub(h).redISub(u);var g=h.redSqr();g=(g=(g=g.redIAdd(g)).redIAdd(g)).redIAdd(g),t=f.redMul(p.redISub(e)).redISub(g)}return this.curve.jpoint(e,t,r)},u.prototype._dbl=function(){var e=this.curve.a,t=this.x,r=this.y,n=this.z,i=n.redSqr().redSqr(),s=t.redSqr(),a=r.redSqr(),o=s.redAdd(s).redIAdd(s).redIAdd(e.redMul(i)),l=t.redAdd(t),c=(l=l.redIAdd(l)).redMul(a),u=o.redSqr().redISub(c.redAdd(c)),h=c.redISub(u),d=a.redSqr();d=(d=(d=d.redIAdd(d)).redIAdd(d)).redIAdd(d);var f=o.redMul(h).redISub(d),p=r.redAdd(r).redMul(n);return this.curve.jpoint(u,f,p)},u.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr(),n=t.redSqr(),i=e.redAdd(e).redIAdd(e),s=i.redSqr(),a=this.x.redAdd(t).redSqr().redISub(e).redISub(n),o=(a=(a=(a=a.redIAdd(a)).redAdd(a).redIAdd(a)).redISub(s)).redSqr(),l=n.redIAdd(n);l=(l=(l=l.redIAdd(l)).redIAdd(l)).redIAdd(l);var c=i.redIAdd(a).redSqr().redISub(s).redISub(o).redISub(l),u=t.redMul(c);u=(u=u.redIAdd(u)).redIAdd(u);var h=this.x.redMul(o).redISub(u);h=(h=h.redIAdd(h)).redIAdd(h);var d=this.y.redMul(c.redMul(l.redISub(c)).redISub(a.redMul(o)));d=(d=(d=d.redIAdd(d)).redIAdd(d)).redIAdd(d);var f=this.z.redAdd(a).redSqr().redISub(r).redISub(o);return this.curve.jpoint(h,d,f)},u.prototype.mul=function(e,t){return e=new i(e,t),this.curve._wnafMul(this,e)},u.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),r=e.z.redSqr();if(0!==this.x.redMul(r).redISub(e.x.redMul(t)).cmpn(0))return!1;var n=t.redMul(this.z),i=r.redMul(e.z);return 0===this.y.redMul(i).redISub(e.y.redMul(n)).cmpn(0)},u.prototype.eqXToP=function(e){var t=this.z.redSqr(),r=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(r))return!0;for(var n=e.clone(),i=this.curve.redN.redMul(t);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),0===this.x.cmp(r))return!0}},u.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},u.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],411:[function(e,t,r){"use strict";var n,i=r,s=e("hash.js"),a=e("./curve"),o=e("./utils").assert;function l(e){"short"===e.type?this.curve=new a.short(e):"edwards"===e.type?this.curve=new a.edwards(e):this.curve=new a.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,o(this.g.validate(),"Invalid curve"),o(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function c(e,t){Object.defineProperty(i,e,{configurable:!0,enumerable:!0,get:function(){var r=new l(t);return Object.defineProperty(i,e,{configurable:!0,enumerable:!0,value:r}),r}})}i.PresetCurve=l,c("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:s.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),c("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:s.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),c("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:s.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),c("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:s.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),c("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:s.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),c("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["9"]}),c("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{n=e("./precomputed/secp256k1")}catch(e){n=void 0}c("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:s.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",n]})},{"./curve":408,"./precomputed/secp256k1":418,"./utils":419,"hash.js":426}],412:[function(e,t,r){"use strict";var n=e("bn.js"),i=e("hmac-drbg"),s=e("../utils"),a=e("../curves"),o=e("brorand"),l=s.assert,c=e("./key"),u=e("./signature");function h(e){if(!(this instanceof h))return new h(e);"string"==typeof e&&(l(Object.prototype.hasOwnProperty.call(a,e),"Unknown curve "+e),e=a[e]),e instanceof a.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}t.exports=h,h.prototype.keyPair=function(e){return new c(this,e)},h.prototype.keyFromPrivate=function(e,t){return c.fromPrivate(this,e,t)},h.prototype.keyFromPublic=function(e,t){return c.fromPublic(this,e,t)},h.prototype.genKeyPair=function(e){e||(e={});for(var t=new i({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||o(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),r=this.n.byteLength(),s=this.n.sub(new n(2));;){var a=new n(t.generate(r));if(!(a.cmp(s)>0))return a.iaddn(1),this.keyFromPrivate(a)}},h.prototype._truncateToN=function(e,t){var r=8*e.byteLength()-this.n.bitLength();return r>0&&(e=e.ushrn(r)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},h.prototype.sign=function(e,t,r,s){"object"==typeof r&&(s=r,r=null),s||(s={}),t=this.keyFromPrivate(t,r),e=this._truncateToN(new n(e,16));for(var a=this.n.byteLength(),o=t.getPrivate().toArray("be",a),l=e.toArray("be",a),c=new i({hash:this.hash,entropy:o,nonce:l,pers:s.pers,persEnc:s.persEnc||"utf8"}),h=this.n.sub(new n(1)),d=0;;d++){var f=s.k?s.k(d):new n(c.generate(this.n.byteLength()));if(!((f=this._truncateToN(f,!0)).cmpn(1)<=0||f.cmp(h)>=0)){var p=this.g.mul(f);if(!p.isInfinity()){var m=p.getX(),g=m.umod(this.n);if(0!==g.cmpn(0)){var v=f.invm(this.n).mul(g.mul(t.getPrivate()).iadd(e));if(0!==(v=v.umod(this.n)).cmpn(0)){var y=(p.getY().isOdd()?1:0)|(0!==m.cmp(g)?2:0);return s.canonical&&v.cmp(this.nh)>0&&(v=this.n.sub(v),y^=1),new u({r:g,s:v,recoveryParam:y})}}}}}},h.prototype.verify=function(e,t,r,i){e=this._truncateToN(new n(e,16)),r=this.keyFromPublic(r,i);var s=(t=new u(t,"hex")).r,a=t.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;if(a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;var o,l=a.invm(this.n),c=l.mul(e).umod(this.n),h=l.mul(s).umod(this.n);return this.curve._maxwellTrick?!(o=this.g.jmulAdd(c,r.getPublic(),h)).isInfinity()&&o.eqXToP(s):!(o=this.g.mulAdd(c,r.getPublic(),h)).isInfinity()&&0===o.getX().umod(this.n).cmp(s)},h.prototype.recoverPubKey=function(e,t,r,i){l((3&r)===r,"The recovery param is more than two bits"),t=new u(t,i);var s=this.n,a=new n(e),o=t.r,c=t.s,h=1&r,d=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&d)throw new Error("Unable to find sencond key candinate");o=d?this.curve.pointFromX(o.add(this.curve.n),h):this.curve.pointFromX(o,h);var f=t.r.invm(s),p=s.sub(a).mul(f).umod(s),m=c.mul(f).umod(s);return this.g.mulAdd(p,o,m)},h.prototype.getKeyRecoveryParam=function(e,t,r,n){if(null!==(t=new u(t,n)).recoveryParam)return t.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(e,t,i)}catch(e){continue}if(s.eq(r))return i}throw new Error("Unable to find valid recovery factor")}},{"../curves":411,"../utils":419,"./key":413,"./signature":414,"bn.js":420,brorand:187,"hmac-drbg":438}],413:[function(e,t,r){"use strict";var n=e("bn.js"),i=e("../utils").assert;function s(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}t.exports=s,s.fromPublic=function(e,t,r){return t instanceof s?t:new s(e,{pub:t,pubEnc:r})},s.fromPrivate=function(e,t,r){return t instanceof s?t:new s(e,{priv:t,privEnc:r})},s.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},s.prototype.getPublic=function(e,t){return"string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub},s.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},s.prototype._importPrivate=function(e,t){this.priv=new n(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},s.prototype._importPublic=function(e,t){if(e.x||e.y)return"mont"===this.ec.curve.type?i(e.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||i(e.x&&e.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,t)},s.prototype.derive=function(e){return e.validate()||i(e.validate(),"public point not validated"),e.mul(this.priv).getX()},s.prototype.sign=function(e,t,r){return this.ec.sign(e,this,t,r)},s.prototype.verify=function(e,t){return this.ec.verify(e,t,this)},s.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":419,"bn.js":420}],414:[function(e,t,r){"use strict";var n=e("bn.js"),i=e("../utils"),s=i.assert;function a(e,t){if(e instanceof a)return e;this._importDER(e,t)||(s(e.r&&e.s,"Signature without r or s"),this.r=new n(e.r,16),this.s=new n(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}function o(){this.place=0}function l(e,t){var r=e[t.place++];if(!(128&r))return r;var n=15&r;if(0===n||n>4)return!1;for(var i=0,s=0,a=t.place;s<n;s++,a++)i<<=8,i|=e[a],i>>>=0;return!(i<=127)&&(t.place=a,i)}function c(e){for(var t=0,r=e.length-1;!e[t]&&!(128&e[t+1])&&t<r;)t++;return 0===t?e:e.slice(t)}function u(e,t){if(t<128)e.push(t);else{var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|r);--r;)e.push(t>>>(r<<3)&255);e.push(t)}}t.exports=a,a.prototype._importDER=function(e,t){e=i.toArray(e,t);var r=new o;if(48!==e[r.place++])return!1;var s=l(e,r);if(!1===s)return!1;if(s+r.place!==e.length)return!1;if(2!==e[r.place++])return!1;var a=l(e,r);if(!1===a)return!1;var c=e.slice(r.place,a+r.place);if(r.place+=a,2!==e[r.place++])return!1;var u=l(e,r);if(!1===u)return!1;if(e.length!==u+r.place)return!1;var h=e.slice(r.place,u+r.place);if(0===c[0]){if(!(128&c[1]))return!1;c=c.slice(1)}if(0===h[0]){if(!(128&h[1]))return!1;h=h.slice(1)}return this.r=new n(c),this.s=new n(h),this.recoveryParam=null,!0},a.prototype.toDER=function(e){var t=this.r.toArray(),r=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&r[0]&&(r=[0].concat(r)),t=c(t),r=c(r);!(r[0]||128&r[1]);)r=r.slice(1);var n=[2];u(n,t.length),(n=n.concat(t)).push(2),u(n,r.length);var s=n.concat(r),a=[48];return u(a,s.length),a=a.concat(s),i.encode(a,e)}},{"../utils":419,"bn.js":420}],415:[function(e,t,r){"use strict";var n=e("hash.js"),i=e("../curves"),s=e("../utils"),a=s.assert,o=s.parseBytes,l=e("./key"),c=e("./signature");function u(e){if(a("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof u))return new u(e);e=i[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=n.sha512}t.exports=u,u.prototype.sign=function(e,t){e=o(e);var r=this.keyFromSecret(t),n=this.hashInt(r.messagePrefix(),e),i=this.g.mul(n),s=this.encodePoint(i),a=this.hashInt(s,r.pubBytes(),e).mul(r.priv()),l=n.add(a).umod(this.curve.n);return this.makeSignature({R:i,S:l,Rencoded:s})},u.prototype.verify=function(e,t,r){e=o(e),t=this.makeSignature(t);var n=this.keyFromPublic(r),i=this.hashInt(t.Rencoded(),n.pubBytes(),e),s=this.g.mul(t.S());return t.R().add(n.pub().mul(i)).eq(s)},u.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return s.intFromLE(e.digest()).umod(this.curve.n)},u.prototype.keyFromPublic=function(e){return l.fromPublic(this,e)},u.prototype.keyFromSecret=function(e){return l.fromSecret(this,e)},u.prototype.makeSignature=function(e){return e instanceof c?e:new c(this,e)},u.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},u.prototype.decodePoint=function(e){var t=(e=s.parseBytes(e)).length-1,r=e.slice(0,t).concat(-129&e[t]),n=0!=(128&e[t]),i=s.intFromLE(r);return this.curve.pointFromY(i,n)},u.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},u.prototype.decodeInt=function(e){return s.intFromLE(e)},u.prototype.isPoint=function(e){return e instanceof this.pointClass}},{"../curves":411,"../utils":419,"./key":416,"./signature":417,"hash.js":426}],416:[function(e,t,r){"use strict";var n=e("../utils"),i=n.assert,s=n.parseBytes,a=n.cachedProperty;function o(e,t){this.eddsa=e,this._secret=s(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=s(t.pub)}o.fromPublic=function(e,t){return t instanceof o?t:new o(e,{pub:t})},o.fromSecret=function(e,t){return t instanceof o?t:new o(e,{secret:t})},o.prototype.secret=function(){return this._secret},a(o,"pubBytes",(function(){return this.eddsa.encodePoint(this.pub())})),a(o,"pub",(function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())})),a(o,"privBytes",(function(){var e=this.eddsa,t=this.hash(),r=e.encodingLength-1,n=t.slice(0,e.encodingLength);return n[0]&=248,n[r]&=127,n[r]|=64,n})),a(o,"priv",(function(){return this.eddsa.decodeInt(this.privBytes())})),a(o,"hash",(function(){return this.eddsa.hash().update(this.secret()).digest()})),a(o,"messagePrefix",(function(){return this.hash().slice(this.eddsa.encodingLength)})),o.prototype.sign=function(e){return i(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},o.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},o.prototype.getSecret=function(e){return i(this._secret,"KeyPair is public only"),n.encode(this.secret(),e)},o.prototype.getPublic=function(e){return n.encode(this.pubBytes(),e)},t.exports=o},{"../utils":419}],417:[function(e,t,r){"use strict";var n=e("bn.js"),i=e("../utils"),s=i.assert,a=i.cachedProperty,o=i.parseBytes;function l(e,t){this.eddsa=e,"object"!=typeof t&&(t=o(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),s(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof n&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}a(l,"S",(function(){return this.eddsa.decodeInt(this.Sencoded())})),a(l,"R",(function(){return this.eddsa.decodePoint(this.Rencoded())})),a(l,"Rencoded",(function(){return this.eddsa.encodePoint(this.R())})),a(l,"Sencoded",(function(){return this.eddsa.encodeInt(this.S())})),l.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},l.prototype.toHex=function(){return i.encode(this.toBytes(),"hex").toUpperCase()},t.exports=l},{"../utils":419,"bn.js":420}],418:[function(e,t,r){"use strict";t.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],419:[function(e,t,r){"use strict";var n=r,i=e("bn.js"),s=e("minimalistic-assert"),a=e("minimalistic-crypto-utils");n.assert=s,n.toArray=a.toArray,n.zero2=a.zero2,n.toHex=a.toHex,n.encode=a.encode,n.getNAF=function(e,t,r){var n=new Array(Math.max(e.bitLength(),r)+1);n.fill(0);for(var i=1<<t+1,s=e.clone(),a=0;a<n.length;a++){var o,l=s.andln(i-1);s.isOdd()?(o=l>(i>>1)-1?(i>>1)-l:l,s.isubn(o)):o=0,n[a]=o,s.iushrn(1)}return n},n.getJSF=function(e,t){var r=[[],[]];e=e.clone(),t=t.clone();for(var n,i=0,s=0;e.cmpn(-i)>0||t.cmpn(-s)>0;){var a,o,l=e.andln(3)+i&3,c=t.andln(3)+s&3;3===l&&(l=-1),3===c&&(c=-1),a=0==(1&l)?0:3!==(n=e.andln(7)+i&7)&&5!==n||2!==c?l:-l,r[0].push(a),o=0==(1&c)?0:3!==(n=t.andln(7)+s&7)&&5!==n||2!==l?c:-c,r[1].push(o),2*i===a+1&&(i=1-i),2*s===o+1&&(s=1-s),e.iushrn(1),t.iushrn(1)}return r},n.cachedProperty=function(e,t,r){var n="_"+t;e.prototype[t]=function(){return void 0!==this[n]?this[n]:this[n]=r.call(this)}},n.parseBytes=function(e){return"string"==typeof e?n.toArray(e,"hex"):e},n.intFromLE=function(e){return new i(e,"hex","le")}},{"bn.js":420,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],420:[function(e,t,r){arguments[4][184][0].apply(r,arguments)},{buffer:188,dup:184}],421:[function(e,t,r){t.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}],422:[function(e,t,r){"use strict";var n=Object.create||function(e){var t=function(){};return t.prototype=e,new t},i=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return r},s=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function a(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=n(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}t.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._maxListeners=void 0;var o,l=10;try{var c={};Object.defineProperty&&Object.defineProperty(c,"x",{value:0}),o=0===c.x}catch(e){o=!1}function u(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function h(e,t,r){if(t)e.call(r);else for(var n=e.length,i=x(e,n),s=0;s<n;++s)i[s].call(r)}function d(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,s=x(e,i),a=0;a<i;++a)s[a].call(r,n)}function f(e,t,r,n,i){if(t)e.call(r,n,i);else for(var s=e.length,a=x(e,s),o=0;o<s;++o)a[o].call(r,n,i)}function p(e,t,r,n,i,s){if(t)e.call(r,n,i,s);else for(var a=e.length,o=x(e,a),l=0;l<a;++l)o[l].call(r,n,i,s)}function m(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,s=x(e,i),a=0;a<i;++a)s[a].apply(r,n)}function g(e,t,r,i){var s,a,o;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((a=e._events)?(a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),o=a[t]):(a=e._events=n(null),e._eventsCount=0),o){if("function"==typeof o?o=a[t]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),!o.warned&&(s=u(e))&&s>0&&o.length>s){o.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+o.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=o.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",l.name,l.message)}}else o=a[t]=r,++e._eventsCount;return e}function v(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function y(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=s.call(v,n);return i.listener=r,n.wrapFn=i,i}function b(e,t,r){var n=e._events;if(!n)return[];var i=n[t];return i?"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):x(i,i.length):[]}function w(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function x(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}o?Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');l=e}}):a.defaultMaxListeners=l,a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(e){var t,r,n,i,s,a,o="error"===e;if(a=this._events)o=o&&null==a.error;else if(!o)return!1;if(o){if(arguments.length>1&&(t=arguments[1]),t instanceof Error)throw t;var l=new Error('Unhandled "error" event. ('+t+")");throw l.context=t,l}if(!(r=a[e]))return!1;var c="function"==typeof r;switch(n=arguments.length){case 1:h(r,c,this);break;case 2:d(r,c,this,arguments[1]);break;case 3:f(r,c,this,arguments[1],arguments[2]);break;case 4:p(r,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(n-1),s=1;s<n;s++)i[s-1]=arguments[s];m(r,c,this,i)}return!0},a.prototype.addListener=function(e,t){return g(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return g(this,e,t,!0)},a.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,y(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,y(this,e,t)),this},a.prototype.removeListener=function(e,t){var r,i,s,a,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(r=i[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=n(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(s=-1,a=r.length-1;a>=0;a--)if(r[a]===t||r[a].listener===t){o=r[a].listener,s=a;break}if(s<0)return this;0===s?r.shift():function(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}(r,s),1===r.length&&(i[e]=r[0]),i.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.removeAllListeners=function(e){var t,r,s;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=n(null),this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=n(null):delete r[e]),this;if(0===arguments.length){var a,o=i(r);for(s=0;s<o.length;++s)"removeListener"!==(a=o[s])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=n(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this},a.prototype.listeners=function(e){return b(this,e,!0)},a.prototype.rawListeners=function(e){return b(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):w.call(e,t)},a.prototype.listenerCount=w,a.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],423:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer,i=e("md5.js");t.exports=function(e,t,r,s){if(n.isBuffer(e)||(e=n.from(e,"binary")),t&&(n.isBuffer(t)||(t=n.from(t,"binary")),8!==t.length))throw new RangeError("salt should be Buffer with 8 byte length");for(var a=r/8,o=n.alloc(a),l=n.alloc(s||0),c=n.alloc(0);a>0||s>0;){var u=new i;u.update(c),u.update(e),t&&u.update(t),c=u.digest();var h=0;if(a>0){var d=o.length-a;h=Math.min(a,c.length),c.copy(o,d,0,h),a-=h}if(h<c.length&&s>0){var f=l.length-s,p=Math.min(s,c.length-h);c.copy(l,f,h,h+p),s-=p}}return c.fill(0),{key:o,iv:l}}},{"md5.js":450,"safe-buffer":494}],424:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CsvParserStream=r.ParserOptions=r.parseFile=r.parseStream=r.parseString=r.parse=r.FormatterOptions=r.CsvFormatterStream=r.writeToPath=r.writeToString=r.writeToBuffer=r.writeToStream=r.write=r.format=void 0;var n=e("@fast-csv/format");Object.defineProperty(r,"format",{enumerable:!0,get:function(){return n.format}}),Object.defineProperty(r,"write",{enumerable:!0,get:function(){return n.write}}),Object.defineProperty(r,"writeToStream",{enumerable:!0,get:function(){return n.writeToStream}}),Object.defineProperty(r,"writeToBuffer",{enumerable:!0,get:function(){return n.writeToBuffer}}),Object.defineProperty(r,"writeToString",{enumerable:!0,get:function(){return n.writeToString}}),Object.defineProperty(r,"writeToPath",{enumerable:!0,get:function(){return n.writeToPath}}),Object.defineProperty(r,"CsvFormatterStream",{enumerable:!0,get:function(){return n.CsvFormatterStream}}),Object.defineProperty(r,"FormatterOptions",{enumerable:!0,get:function(){return n.FormatterOptions}});var i=e("@fast-csv/parse");Object.defineProperty(r,"parse",{enumerable:!0,get:function(){return i.parse}}),Object.defineProperty(r,"parseString",{enumerable:!0,get:function(){return i.parseString}}),Object.defineProperty(r,"parseStream",{enumerable:!0,get:function(){return i.parseStream}}),Object.defineProperty(r,"parseFile",{enumerable:!0,get:function(){return i.parseFile}}),Object.defineProperty(r,"ParserOptions",{enumerable:!0,get:function(){return i.ParserOptions}}),Object.defineProperty(r,"CsvParserStream",{enumerable:!0,get:function(){return i.CsvParserStream}})},{"@fast-csv/format":151,"@fast-csv/parse":155}],425:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer,i=e("readable-stream").Transform;function s(e){i.call(this),this._block=n.allocUnsafe(e),this._blockSize=e,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}e("inherits")(s,i),s.prototype._transform=function(e,t,r){var n=null;try{this.update(e,t)}catch(e){n=e}r(n)},s.prototype._flush=function(e){var t=null;try{this.push(this.digest())}catch(e){t=e}e(t)},s.prototype.update=function(e,t){if(function(e,t){if(!n.isBuffer(e)&&"string"!=typeof e)throw new TypeError(t+" must be a string or a buffer")}(e,"Data"),this._finalized)throw new Error("Digest already called");n.isBuffer(e)||(e=n.from(e,t));for(var r=this._block,i=0;this._blockOffset+e.length-i>=this._blockSize;){for(var s=this._blockOffset;s<this._blockSize;)r[s++]=e[i++];this._update(),this._blockOffset=0}for(;i<e.length;)r[this._blockOffset++]=e[i++];for(var a=0,o=8*e.length;o>0;++a)this._length[a]+=o,(o=this._length[a]/4294967296|0)>0&&(this._length[a]-=4294967296*o);return this},s.prototype._update=function(){throw new Error("_update is not implemented")},s.prototype.digest=function(e){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var t=this._digest();void 0!==e&&(t=t.toString(e)),this._block.fill(0),this._blockOffset=0;for(var r=0;r<4;++r)this._length[r]=0;return t},s.prototype._digest=function(){throw new Error("_digest is not implemented")},t.exports=s},{inherits:440,"readable-stream":491,"safe-buffer":494}],426:[function(e,t,r){"use strict";var n=r;n.utils=e("./hash/utils"),n.common=e("./hash/common"),n.sha=e("./hash/sha"),n.ripemd=e("./hash/ripemd"),n.hmac=e("./hash/hmac"),n.sha1=n.sha.sha1,n.sha256=n.sha.sha256,n.sha224=n.sha.sha224,n.sha384=n.sha.sha384,n.sha512=n.sha.sha512,n.ripemd160=n.ripemd.ripemd160},{"./hash/common":427,"./hash/hmac":428,"./hash/ripemd":429,"./hash/sha":430,"./hash/utils":437}],427:[function(e,t,r){"use strict";var n=e("./utils"),i=e("minimalistic-assert");function s(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}r.BlockHash=s,s.prototype.update=function(e,t){if(e=n.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var r=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-r,e.length),0===this.pending.length&&(this.pending=null),e=n.join32(e,0,e.length-r,this.endian);for(var i=0;i<e.length;i+=this._delta32)this._update(e,i,i+this._delta32)}return this},s.prototype.digest=function(e){return this.update(this._pad()),i(null===this.pending),this._digest(e)},s.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,r=t-(e+this.padLength)%t,n=new Array(r+this.padLength);n[0]=128;for(var i=1;i<r;i++)n[i]=0;if(e<<=3,"big"===this.endian){for(var s=8;s<this.padLength;s++)n[i++]=0;n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=e>>>24&255,n[i++]=e>>>16&255,n[i++]=e>>>8&255,n[i++]=255&e}else for(n[i++]=255&e,n[i++]=e>>>8&255,n[i++]=e>>>16&255,n[i++]=e>>>24&255,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0,s=8;s<this.padLength;s++)n[i++]=0;return n}},{"./utils":437,"minimalistic-assert":453}],428:[function(e,t,r){"use strict";var n=e("./utils"),i=e("minimalistic-assert");function s(e,t,r){if(!(this instanceof s))return new s(e,t,r);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(n.toArray(t,r))}t.exports=s,s.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),i(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},s.prototype.update=function(e,t){return this.inner.update(e,t),this},s.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},{"./utils":437,"minimalistic-assert":453}],429:[function(e,t,r){"use strict";var n=e("./utils"),i=e("./common"),s=n.rotl32,a=n.sum32,o=n.sum32_3,l=n.sum32_4,c=i.BlockHash;function u(){if(!(this instanceof u))return new u;c.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function h(e,t,r,n){return e<=15?t^r^n:e<=31?t&r|~t&n:e<=47?(t|~r)^n:e<=63?t&n|r&~n:t^(r|~n)}function d(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function f(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}n.inherits(u,c),r.ripemd160=u,u.blockSize=512,u.outSize=160,u.hmacStrength=192,u.padLength=64,u.prototype._update=function(e,t){for(var r=this.h[0],n=this.h[1],i=this.h[2],c=this.h[3],u=this.h[4],y=r,b=n,w=i,x=c,S=u,_=0;_<80;_++){var C=a(s(l(r,h(_,n,i,c),e[p[_]+t],d(_)),g[_]),u);r=u,u=c,c=s(i,10),i=n,n=C,C=a(s(l(y,h(79-_,b,w,x),e[m[_]+t],f(_)),v[_]),S),y=S,S=x,x=s(w,10),w=b,b=C}C=o(this.h[1],i,x),this.h[1]=o(this.h[2],c,S),this.h[2]=o(this.h[3],u,y),this.h[3]=o(this.h[4],r,b),this.h[4]=o(this.h[0],n,w),this.h[0]=C},u.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"little"):n.split32(this.h,"little")};var p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],m=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],g=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],v=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":427,"./utils":437}],430:[function(e,t,r){"use strict";r.sha1=e("./sha/1"),r.sha224=e("./sha/224"),r.sha256=e("./sha/256"),r.sha384=e("./sha/384"),r.sha512=e("./sha/512")},{"./sha/1":431,"./sha/224":432,"./sha/256":433,"./sha/384":434,"./sha/512":435}],431:[function(e,t,r){"use strict";var n=e("../utils"),i=e("../common"),s=e("./common"),a=n.rotl32,o=n.sum32,l=n.sum32_5,c=s.ft_1,u=i.BlockHash,h=[1518500249,1859775393,2400959708,3395469782];function d(){if(!(this instanceof d))return new d;u.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}n.inherits(d,u),t.exports=d,d.blockSize=512,d.outSize=160,d.hmacStrength=80,d.padLength=64,d.prototype._update=function(e,t){for(var r=this.W,n=0;n<16;n++)r[n]=e[t+n];for(;n<r.length;n++)r[n]=a(r[n-3]^r[n-8]^r[n-14]^r[n-16],1);var i=this.h[0],s=this.h[1],u=this.h[2],d=this.h[3],f=this.h[4];for(n=0;n<r.length;n++){var p=~~(n/20),m=l(a(i,5),c(p,s,u,d),f,r[n],h[p]);f=d,d=u,u=a(s,30),s=i,i=m}this.h[0]=o(this.h[0],i),this.h[1]=o(this.h[1],s),this.h[2]=o(this.h[2],u),this.h[3]=o(this.h[3],d),this.h[4]=o(this.h[4],f)},d.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436}],432:[function(e,t,r){"use strict";var n=e("../utils"),i=e("./256");function s(){if(!(this instanceof s))return new s;i.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}n.inherits(s,i),t.exports=s,s.blockSize=512,s.outSize=224,s.hmacStrength=192,s.padLength=64,s.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,7),"big"):n.split32(this.h.slice(0,7),"big")}},{"../utils":437,"./256":433}],433:[function(e,t,r){"use strict";var n=e("../utils"),i=e("../common"),s=e("./common"),a=e("minimalistic-assert"),o=n.sum32,l=n.sum32_4,c=n.sum32_5,u=s.ch32,h=s.maj32,d=s.s0_256,f=s.s1_256,p=s.g0_256,m=s.g1_256,g=i.BlockHash,v=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function y(){if(!(this instanceof y))return new y;g.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=v,this.W=new Array(64)}n.inherits(y,g),t.exports=y,y.blockSize=512,y.outSize=256,y.hmacStrength=192,y.padLength=64,y.prototype._update=function(e,t){for(var r=this.W,n=0;n<16;n++)r[n]=e[t+n];for(;n<r.length;n++)r[n]=l(m(r[n-2]),r[n-7],p(r[n-15]),r[n-16]);var i=this.h[0],s=this.h[1],g=this.h[2],v=this.h[3],y=this.h[4],b=this.h[5],w=this.h[6],x=this.h[7];for(a(this.k.length===r.length),n=0;n<r.length;n++){var S=c(x,f(y),u(y,b,w),this.k[n],r[n]),_=o(d(i),h(i,s,g));x=w,w=b,b=y,y=o(v,S),v=g,g=s,s=i,i=o(S,_)}this.h[0]=o(this.h[0],i),this.h[1]=o(this.h[1],s),this.h[2]=o(this.h[2],g),this.h[3]=o(this.h[3],v),this.h[4]=o(this.h[4],y),this.h[5]=o(this.h[5],b),this.h[6]=o(this.h[6],w),this.h[7]=o(this.h[7],x)},y.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436,"minimalistic-assert":453}],434:[function(e,t,r){"use strict";var n=e("../utils"),i=e("./512");function s(){if(!(this instanceof s))return new s;i.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}n.inherits(s,i),t.exports=s,s.blockSize=1024,s.outSize=384,s.hmacStrength=192,s.padLength=128,s.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,12),"big"):n.split32(this.h.slice(0,12),"big")}},{"../utils":437,"./512":435}],435:[function(e,t,r){"use strict";var n=e("../utils"),i=e("../common"),s=e("minimalistic-assert"),a=n.rotr64_hi,o=n.rotr64_lo,l=n.shr64_hi,c=n.shr64_lo,u=n.sum64,h=n.sum64_hi,d=n.sum64_lo,f=n.sum64_4_hi,p=n.sum64_4_lo,m=n.sum64_5_hi,g=n.sum64_5_lo,v=i.BlockHash,y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function b(){if(!(this instanceof b))return new b;v.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=y,this.W=new Array(160)}function w(e,t,r,n,i){var s=e&r^~e&i;return s<0&&(s+=4294967296),s}function x(e,t,r,n,i,s){var a=t&n^~t&s;return a<0&&(a+=4294967296),a}function S(e,t,r,n,i){var s=e&r^e&i^r&i;return s<0&&(s+=4294967296),s}function _(e,t,r,n,i,s){var a=t&n^t&s^n&s;return a<0&&(a+=4294967296),a}function C(e,t){var r=a(e,t,28)^a(t,e,2)^a(t,e,7);return r<0&&(r+=4294967296),r}function E(e,t){var r=o(e,t,28)^o(t,e,2)^o(t,e,7);return r<0&&(r+=4294967296),r}function A(e,t){var r=a(e,t,14)^a(e,t,18)^a(t,e,9);return r<0&&(r+=4294967296),r}function M(e,t){var r=o(e,t,14)^o(e,t,18)^o(t,e,9);return r<0&&(r+=4294967296),r}function T(e,t){var r=a(e,t,1)^a(e,t,8)^l(e,t,7);return r<0&&(r+=4294967296),r}function P(e,t){var r=o(e,t,1)^o(e,t,8)^c(e,t,7);return r<0&&(r+=4294967296),r}function k(e,t){var r=a(e,t,19)^a(t,e,29)^l(e,t,6);return r<0&&(r+=4294967296),r}function D(e,t){var r=o(e,t,19)^o(t,e,29)^c(e,t,6);return r<0&&(r+=4294967296),r}n.inherits(b,v),t.exports=b,b.blockSize=1024,b.outSize=512,b.hmacStrength=192,b.padLength=128,b.prototype._prepareBlock=function(e,t){for(var r=this.W,n=0;n<32;n++)r[n]=e[t+n];for(;n<r.length;n+=2){var i=k(r[n-4],r[n-3]),s=D(r[n-4],r[n-3]),a=r[n-14],o=r[n-13],l=T(r[n-30],r[n-29]),c=P(r[n-30],r[n-29]),u=r[n-32],h=r[n-31];r[n]=f(i,s,a,o,l,c,u,h),r[n+1]=p(i,s,a,o,l,c,u,h)}},b.prototype._update=function(e,t){this._prepareBlock(e,t);var r=this.W,n=this.h[0],i=this.h[1],a=this.h[2],o=this.h[3],l=this.h[4],c=this.h[5],f=this.h[6],p=this.h[7],v=this.h[8],y=this.h[9],b=this.h[10],T=this.h[11],P=this.h[12],k=this.h[13],D=this.h[14],I=this.h[15];s(this.k.length===r.length);for(var O=0;O<r.length;O+=2){var R=D,L=I,N=A(v,y),B=M(v,y),z=w(v,y,b,T,P),F=x(v,y,b,T,P,k),j=this.k[O],U=this.k[O+1],V=r[O],H=r[O+1],W=m(R,L,N,B,z,F,j,U,V,H),G=g(R,L,N,B,z,F,j,U,V,H);R=C(n,i),L=E(n,i),N=S(n,i,a,o,l),B=_(n,i,a,o,l,c);var q=h(R,L,N,B),X=d(R,L,N,B);D=P,I=k,P=b,k=T,b=v,T=y,v=h(f,p,W,G),y=d(p,p,W,G),f=l,p=c,l=a,c=o,a=n,o=i,n=h(W,G,q,X),i=d(W,G,q,X)}u(this.h,0,n,i),u(this.h,2,a,o),u(this.h,4,l,c),u(this.h,6,f,p),u(this.h,8,v,y),u(this.h,10,b,T),u(this.h,12,P,k),u(this.h,14,D,I)},b.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},{"../common":427,"../utils":437,"minimalistic-assert":453}],436:[function(e,t,r){"use strict";var n=e("../utils").rotr32;function i(e,t,r){return e&t^~e&r}function s(e,t,r){return e&t^e&r^t&r}function a(e,t,r){return e^t^r}r.ft_1=function(e,t,r,n){return 0===e?i(t,r,n):1===e||3===e?a(t,r,n):2===e?s(t,r,n):void 0},r.ch32=i,r.maj32=s,r.p32=a,r.s0_256=function(e){return n(e,2)^n(e,13)^n(e,22)},r.s1_256=function(e){return n(e,6)^n(e,11)^n(e,25)},r.g0_256=function(e){return n(e,7)^n(e,18)^e>>>3},r.g1_256=function(e){return n(e,17)^n(e,19)^e>>>10}},{"../utils":437}],437:[function(e,t,r){"use strict";var n=e("minimalistic-assert"),i=e("inherits");function s(e,t){return 55296==(64512&e.charCodeAt(t))&&!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1))}function a(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function o(e){return 1===e.length?"0"+e:e}function l(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}r.inherits=i,r.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),i=0;i<e.length;i+=2)r.push(parseInt(e[i]+e[i+1],16))}else for(var n=0,i=0;i<e.length;i++){var a=e.charCodeAt(i);a<128?r[n++]=a:a<2048?(r[n++]=a>>6|192,r[n++]=63&a|128):s(e,i)?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++i)),r[n++]=a>>18|240,r[n++]=a>>12&63|128,r[n++]=a>>6&63|128,r[n++]=63&a|128):(r[n++]=a>>12|224,r[n++]=a>>6&63|128,r[n++]=63&a|128)}else for(i=0;i<e.length;i++)r[i]=0|e[i];return r},r.toHex=function(e){for(var t="",r=0;r<e.length;r++)t+=o(e[r].toString(16));return t},r.htonl=a,r.toHex32=function(e,t){for(var r="",n=0;n<e.length;n++){var i=e[n];"little"===t&&(i=a(i)),r+=l(i.toString(16))}return r},r.zero2=o,r.zero8=l,r.join32=function(e,t,r,i){var s=r-t;n(s%4==0);for(var a=new Array(s/4),o=0,l=t;o<a.length;o++,l+=4){var c;c="big"===i?e[l]<<24|e[l+1]<<16|e[l+2]<<8|e[l+3]:e[l+3]<<24|e[l+2]<<16|e[l+1]<<8|e[l],a[o]=c>>>0}return a},r.split32=function(e,t){for(var r=new Array(4*e.length),n=0,i=0;n<e.length;n++,i+=4){var s=e[n];"big"===t?(r[i]=s>>>24,r[i+1]=s>>>16&255,r[i+2]=s>>>8&255,r[i+3]=255&s):(r[i+3]=s>>>24,r[i+2]=s>>>16&255,r[i+1]=s>>>8&255,r[i]=255&s)}return r},r.rotr32=function(e,t){return e>>>t|e<<32-t},r.rotl32=function(e,t){return e<<t|e>>>32-t},r.sum32=function(e,t){return e+t>>>0},r.sum32_3=function(e,t,r){return e+t+r>>>0},r.sum32_4=function(e,t,r,n){return e+t+r+n>>>0},r.sum32_5=function(e,t,r,n,i){return e+t+r+n+i>>>0},r.sum64=function(e,t,r,n){var i=e[t],s=n+e[t+1]>>>0,a=(s<n?1:0)+r+i;e[t]=a>>>0,e[t+1]=s},r.sum64_hi=function(e,t,r,n){return(t+n>>>0<t?1:0)+e+r>>>0},r.sum64_lo=function(e,t,r,n){return t+n>>>0},r.sum64_4_hi=function(e,t,r,n,i,s,a,o){var l=0,c=t;return l+=(c=c+n>>>0)<t?1:0,l+=(c=c+s>>>0)<s?1:0,e+r+i+a+(l+=(c=c+o>>>0)<o?1:0)>>>0},r.sum64_4_lo=function(e,t,r,n,i,s,a,o){return t+n+s+o>>>0},r.sum64_5_hi=function(e,t,r,n,i,s,a,o,l,c){var u=0,h=t;return u+=(h=h+n>>>0)<t?1:0,u+=(h=h+s>>>0)<s?1:0,u+=(h=h+o>>>0)<o?1:0,e+r+i+a+l+(u+=(h=h+c>>>0)<c?1:0)>>>0},r.sum64_5_lo=function(e,t,r,n,i,s,a,o,l,c){return t+n+s+o+c>>>0},r.rotr64_hi=function(e,t,r){return(t<<32-r|e>>>r)>>>0},r.rotr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0},r.shr64_hi=function(e,t,r){return e>>>r},r.shr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0}},{inherits:440,"minimalistic-assert":453}],438:[function(e,t,r){"use strict";var n=e("hash.js"),i=e("minimalistic-crypto-utils"),s=e("minimalistic-assert");function a(e){if(!(this instanceof a))return new a(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=i.toArray(e.entropy,e.entropyEnc||"hex"),r=i.toArray(e.nonce,e.nonceEnc||"hex"),n=i.toArray(e.pers,e.persEnc||"hex");s(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,r,n)}t.exports=a,a.prototype._init=function(e,t,r){var n=e.concat(t).concat(r);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++)this.K[i]=0,this.V[i]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656},a.prototype._hmac=function(){return new n.hmac(this.hash,this.K)},a.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},a.prototype.reseed=function(e,t,r,n){"string"!=typeof t&&(n=r,r=t,t=null),e=i.toArray(e,t),r=i.toArray(r,n),s(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(r||[])),this._reseed=1},a.prototype.generate=function(e,t,r,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof t&&(n=r,r=t,t=null),r&&(r=i.toArray(r,n||"hex"),this._update(r));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var a=s.slice(0,e);return this._update(r),this._reseed++,i.encode(a,t)}},{"hash.js":426,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],439:[function(e,t,r){"use strict";r.read=function(e,t,r,n,i){var s,a,o=8*i-n-1,l=(1<<o)-1,c=l>>1,u=-7,h=r?i-1:0,d=r?-1:1,f=e[t+h];for(h+=d,s=f&(1<<-u)-1,f>>=-u,u+=o;u>0;s=256*s+e[t+h],h+=d,u-=8);for(a=s&(1<<-u)-1,s>>=-u,u+=n;u>0;a=256*a+e[t+h],h+=d,u-=8);if(0===s)s=1-c;else{if(s===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,n),s-=c}return(f?-1:1)*a*Math.pow(2,s-n)},r.write=function(e,t,r,n,i,s){var a,o,l,c=8*s-i-1,u=(1<<c)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:s-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=u?(o=0,a=u):a+h>=1?(o=(t*l-1)*Math.pow(2,i),a+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+f]=255&o,f+=p,o/=256,i-=8);for(a=a<<i|o,c+=i;c>0;e[r+f]=255&a,f+=p,a/=256,c-=8);e[r+f-p]|=128*m}},{}],440:[function(e,t,r){"use strict";"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},{}],441:[function(e,t,n){(function(r,i,s,a,o,l,c,u){(function(){"use strict";!function(e){"object"==typeof n&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(r,n,i){function s(o,l){if(!n[o]){if(!r[o]){var c="function"==typeof e&&e;if(!l&&c)return c(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[o]={exports:{}};r[o][0].call(h.exports,(function(e){return s(r[o][1][e]||e)}),h,h.exports,t,r,n,i)}return n[o].exports}for(var a="function"==typeof e&&e,o=0;o<i.length;o++)s(i[o]);return s}({1:[function(e,t,r){var n=e("./utils"),i=e("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(e){for(var t,r,i,a,o,l,c,u=[],h=0,d=e.length,f=d,p="string"!==n.getTypeOf(e);h<e.length;)f=d-h,i=p?(t=e[h++],r=h<d?e[h++]:0,h<d?e[h++]:0):(t=e.charCodeAt(h++),r=h<d?e.charCodeAt(h++):0,h<d?e.charCodeAt(h++):0),a=t>>2,o=(3&t)<<4|r>>4,l=1<f?(15&r)<<2|i>>6:64,c=2<f?63&i:64,u.push(s.charAt(a)+s.charAt(o)+s.charAt(l)+s.charAt(c));return u.join("")},r.decode=function(e){var t,r,n,a,o,l,c=0,u=0,h="data:";if(e.substr(0,h.length)===h)throw new Error("Invalid base64 input, it looks like a data url.");var d,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===s.charAt(64)&&f--,e.charAt(e.length-2)===s.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(d=i.uint8array?new Uint8Array(0|f):new Array(0|f);c<e.length;)t=s.indexOf(e.charAt(c++))<<2|(a=s.indexOf(e.charAt(c++)))>>4,r=(15&a)<<4|(o=s.indexOf(e.charAt(c++)))>>2,n=(3&o)<<6|(l=s.indexOf(e.charAt(c++))),d[u++]=t,64!==o&&(d[u++]=r),64!==l&&(d[u++]=n);return d}},{"./support":30,"./utils":32}],2:[function(e,t,r){var n=e("./external"),i=e("./stream/DataWorker"),s=e("./stream/Crc32Probe"),a=e("./stream/DataLengthProbe");function o(e,t,r,n,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=n,this.compressedContent=i}o.prototype={getContentWorker:function(){var e=new i(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new i(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},o.createWorkerFrom=function(e,t,r){return e.pipe(new s).pipe(new a("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new a("compressedSize")).withStreamInfo("compression",t)},t.exports=o},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,r){var n=e("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},r.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,r){var n=e("./utils"),i=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==n.getTypeOf(e)?function(e,t,r){var n=i,s=0+r;e^=-1;for(var a=0;a<s;a++)e=e>>>8^n[255&(e^t[a])];return~e}(0|t,e,e.length):function(e,t,r){var n=i,s=0+r;e^=-1;for(var a=0;a<s;a++)e=e>>>8^n[255&(e^t.charCodeAt(a))];return~e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,t,r){var n;n="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:n}},{lie:37}],7:[function(e,t,r){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako"),s=e("./utils"),a=e("./stream/GenericWorker"),o=n?"uint8array":"array";function l(e,t){a.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}r.magic="\b\0",s.inherits(l,a),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(s.transformTo(o,e.data),!1)},l.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},r.compressWorker=function(e){return new l("Deflate",e)},r.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,r){function n(e,t){var r,n="";for(r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n}function i(e,t,r,i,a,u){var h,d,f=e.file,p=e.compression,m=u!==o.utf8encode,g=s.transformTo("string",u(f.name)),v=s.transformTo("string",o.utf8encode(f.name)),y=f.comment,b=s.transformTo("string",u(y)),w=s.transformTo("string",o.utf8encode(y)),x=v.length!==f.name.length,S=w.length!==y.length,_="",C="",E="",A=f.dir,M=f.date,T={crc32:0,compressedSize:0,uncompressedSize:0};t&&!r||(T.crc32=e.crc32,T.compressedSize=e.compressedSize,T.uncompressedSize=e.uncompressedSize);var P=0;t&&(P|=8),m||!x&&!S||(P|=2048);var k=0,D=0;A&&(k|=16),"UNIX"===a?(D=798,k|=function(e,t){var r=e;return e||(r=t?16893:33204),(65535&r)<<16}(f.unixPermissions,A)):(D=20,k|=function(e){return 63&(e||0)}(f.dosPermissions)),h=M.getUTCHours(),h<<=6,h|=M.getUTCMinutes(),h<<=5,h|=M.getUTCSeconds()/2,d=M.getUTCFullYear()-1980,d<<=4,d|=M.getUTCMonth()+1,d<<=5,d|=M.getUTCDate(),x&&(C=n(1,1)+n(l(g),4)+v,_+="up"+n(C.length,2)+C),S&&(E=n(1,1)+n(l(b),4)+w,_+="uc"+n(E.length,2)+E);var I="";return I+="\n\0",I+=n(P,2),I+=p.magic,I+=n(h,2),I+=n(d,2),I+=n(T.crc32,4),I+=n(T.compressedSize,4),I+=n(T.uncompressedSize,4),I+=n(g.length,2),I+=n(_.length,2),{fileRecord:c.LOCAL_FILE_HEADER+I+g+_,dirRecord:c.CENTRAL_FILE_HEADER+n(D,2)+I+n(b.length,2)+"\0\0\0\0"+n(k,4)+n(i,4)+g+_+b}}var s=e("../utils"),a=e("../stream/GenericWorker"),o=e("../utf8"),l=e("../crc32"),c=e("../signature");function u(e,t,r,n){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=n,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(u,a),u.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,a.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-n-1))/r:100}}))},u.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var r=i(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,r=i(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),t)this.push({data:function(e){return c.DATA_DESCRIPTOR+n(e.crc32,4)+n(e.compressedSize,4)+n(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var r=this.bytesWritten-e,i=function(e,t,r,i,a){var o=s.transformTo("string",a(i));return c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(e,2)+n(e,2)+n(t,4)+n(r,4)+n(o.length,2)+o}(this.dirRecords.length,r,e,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},u.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(e){var t=this._sources;if(!a.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch(e){}return!0},u.prototype.lock=function(){a.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,r){var n=e("../compressions"),i=e("./ZipFileWorker");r.generateWorker=function(e,t,r){var s=new i(t.streamFiles,r,t.platform,t.encodeFileName),a=0;try{e.forEach((function(e,r){a++;var i=function(e,t){var r=e||t,i=n[r];if(!i)throw new Error(r+" is not a valid compression method !");return i}(r.options.compression,t.compression),o=r.options.compressionOptions||t.compressionOptions||{},l=r.dir,c=r.date;r._compressWorker(i,o).withStreamInfo("file",{name:e,dir:l,date:c,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(s)})),s.entriesCount=a}catch(e){s.error(e)}return s}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,r){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new n;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(n.prototype=e("./object")).loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.10.1",n.loadAsync=function(e,t){return(new n).loadAsync(e,t)},n.external=e("./external"),t.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,r){var n=e("./utils"),i=e("./external"),s=e("./utf8"),a=e("./zipEntries"),o=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function c(e){return new i.Promise((function(t,r){var n=e.decompressed.getContentWorker().pipe(new o);n.on("error",(function(e){r(e)})).on("end",(function(){n.streamInfo.crc32!==e.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}t.exports=function(e,t){var r=this;return t=n.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),l.isNode&&l.isStream(e)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var r=new a(t);return r.load(e),r})).then((function(e){var r=[i.Promise.resolve(e)],n=e.files;if(t.checkCRC32)for(var s=0;s<n.length;s++)r.push(c(n[s]));return i.Promise.all(r)})).then((function(e){for(var i=e.shift(),s=i.files,a=0;a<s.length;a++){var o=s[a],l=o.fileNameStr,c=n.resolve(o.fileNameStr);r.file(c,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileCommentStr.length?o.fileCommentStr:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:t.createFolders}),o.dir||(r.file(c).unsafeOriginalName=l)}return i.zipComment.length&&(r.comment=i.zipComment),r}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,r){var n=e("../utils"),i=e("../stream/GenericWorker");function s(e,t){i.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}n.inherits(s,i),s.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},s.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,r){var n=e("readable-stream").Readable;function i(e,t,r){n.call(this,t),this._helper=e;var i=this;e.on("data",(function(e,t){i.push(e)||i._helper.pause(),r&&r(t)})).on("error",(function(e){i.emit("error",e)})).on("end",(function(){i.push(null)}))}e("../utils").inherits(i,n),i.prototype._read=function(){this._helper.resume()},t.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,t,r){t.exports={isNode:void 0!==s,newBufferFrom:function(e,t){if(s.from&&s.from!==Uint8Array.from)return s.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new s(e,t)},allocBuffer:function(e){if(s.alloc)return s.alloc(e);var t=new s(e);return t.fill(0),t},isBuffer:function(e){return s.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,r){function n(e,t,r){var n,i=s.getTypeOf(t),o=s.extend(r||{},l);o.date=o.date||new Date,null!==o.compression&&(o.compression=o.compression.toUpperCase()),"string"==typeof o.unixPermissions&&(o.unixPermissions=parseInt(o.unixPermissions,8)),o.unixPermissions&&16384&o.unixPermissions&&(o.dir=!0),o.dosPermissions&&16&o.dosPermissions&&(o.dir=!0),o.dir&&(e=m(e)),o.createFolders&&(n=p(e))&&g.call(this,n,!0);var h,v="string"===i&&!1===o.binary&&!1===o.base64;r&&void 0!==r.binary||(o.binary=!v),(t instanceof c&&0===t.uncompressedSize||o.dir||!t||0===t.length)&&(o.base64=!1,o.binary=!0,t="",o.compression="STORE",i="string"),h=t instanceof c||t instanceof a?t:d.isNode&&d.isStream(t)?new f(e,t):s.prepareContent(e,t,o.binary,o.optimizedBinaryString,o.base64);var y=new u(e,h,o);this.files[e]=y}var i=e("./utf8"),s=e("./utils"),a=e("./stream/GenericWorker"),o=e("./stream/StreamHelper"),l=e("./defaults"),c=e("./compressedObject"),u=e("./zipObject"),h=e("./generate"),d=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:l.createFolders,e=m(e),this.files[e]||n.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function v(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,n;for(t in this.files)n=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,n)},filter:function(e){var t=[];return this.forEach((function(r,n){e(r,n)&&t.push(n)})),t},file:function(e,t,r){if(1!==arguments.length)return e=this.root+e,n.call(this,e,t,r),this;if(v(e)){var i=e;return this.filter((function(e,t){return!t.dir&&i.test(e)}))}var s=this.files[this.root+e];return s&&!s.dir?s:null},folder:function(e){if(!e)return this;if(v(e))return this.filter((function(t,r){return r.dir&&e.test(t)}));var t=this.root+e,r=g.call(this,t),n=this.clone();return n.root=r.name,n},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter((function(t,r){return r.name.slice(0,e.length)===e})),n=0;n<r.length;n++)delete this.files[r[n].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,r={};try{if((r=s.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");s.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var n=r.comment||this.comment||"";t=h.generateWorker(this,r,n)}catch(e){(t=new a("error")).error(e)}return new o(t,r.type||"string",r.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,r){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,r){var n=e("./DataReader");function i(e){n.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(i,n),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),s=this.length-4;0<=s;--s)if(this.data[s]===t&&this.data[s+1]===r&&this.data[s+2]===n&&this.data[s+3]===i)return s-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),s=this.readData(4);return t===s[0]&&r===s[1]&&n===s[2]&&i===s[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,r){var n=e("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return n.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,r){var n=e("./Uint8ArrayReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,r){var n=e("./DataReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,r){var n=e("./ArrayReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,r){var n=e("../utils"),i=e("../support"),s=e("./ArrayReader"),a=e("./StringReader"),o=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=n.getTypeOf(e);return n.checkSupport(t),"string"!==t||i.uint8array?"nodebuffer"===t?new o(e):i.uint8array?new l(n.transformTo("uint8array",e)):new s(n.transformTo("array",e)):new a(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,r){r.LOCAL_FILE_HEADER="PK\x03\x04",r.CENTRAL_FILE_HEADER="PK\x01\x02",r.CENTRAL_DIRECTORY_END="PK\x05\x06",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,t,r){var n=e("./GenericWorker"),i=e("../utils");function s(e){n.call(this,"ConvertWorker to "+e),this.destType=e}i.inherits(s,n),s.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},t.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,r){var n=e("./GenericWorker"),i=e("../crc32");function s(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(s,n),s.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,r){var n=e("../utils"),i=e("./GenericWorker");function s(e){i.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}n.inherits(s,i),s.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},t.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,r){var n=e("../utils"),i=e("./GenericWorker");function s(e){i.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=n.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}n.inherits(s,i),s.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,r){function n(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=n},{}],29:[function(e,t,r){var n=e("../utils"),i=e("./ConvertWorker"),a=e("./GenericWorker"),o=e("../base64"),l=e("../support"),c=e("../external"),u=null;if(l.nodestream)try{u=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function h(e,t,r){var s=t;switch(t){case"blob":case"arraybuffer":s="uint8array";break;case"base64":s="string"}try{this._internalType=s,this._outputType=t,this._mimeType=r,n.checkSupport(s),this._worker=e.pipe(new i(s)),e.lock()}catch(e){this._worker=new a("error"),this._worker.error(e)}}h.prototype={accumulate:function(e){return function(e,t){return new c.Promise((function(r,i){var a=[],l=e._internalType,c=e._outputType,u=e._mimeType;e.on("data",(function(e,r){a.push(e),t&&t(r)})).on("error",(function(e){a=[],i(e)})).on("end",(function(){try{var e=function(e,t,r){switch(e){case"blob":return n.newBlob(n.transformTo("arraybuffer",t),r);case"base64":return o.encode(t);default:return n.transformTo(e,t)}}(c,function(e,t){var r,n=0,i=null,a=0;for(r=0;r<t.length;r++)a+=t[r].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(i=new Uint8Array(a),r=0;r<t.length;r++)i.set(t[r],n),n+=t[r].length;return i;case"nodebuffer":return s.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(l,a),u);r(e)}catch(e){i(e)}a=[]})).resume()}))}(this,e)},on:function(e,t){var r=this;return"data"===e?this._worker.on(e,(function(e){t.call(r,e.data,e.meta)})):this._worker.on(e,(function(){n.delay(t,arguments,r)})),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(n.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer=void 0!==s,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var n=new ArrayBuffer(0);try{r.blob=0===new Blob([n],{type:"application/zip"}).size}catch(e){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(n),r.blob=0===i.getBlob("application/zip").size}catch(e){r.blob=!1}}}try{r.nodestream=!!e("readable-stream").Readable}catch(e){r.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,r){for(var n=e("./utils"),i=e("./support"),s=e("./nodejsUtils"),a=e("./stream/GenericWorker"),o=new Array(256),l=0;l<256;l++)o[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){a.call(this,"utf-8 decode"),this.leftOver=null}function u(){a.call(this,"utf-8 encode")}o[254]=o[254]=1,r.utf8encode=function(e){return i.nodebuffer?s.newBufferFrom(e,"utf-8"):function(e){var t,r,n,s,a,o=e.length,l=0;for(s=0;s<o;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(n=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(n-56320),s++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=i.uint8array?new Uint8Array(l):new Array(l),s=a=0;a<l;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(n=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(n-56320),s++),r<128?t[a++]=r:(r<2048?t[a++]=192|r>>>6:(r<65536?t[a++]=224|r>>>12:(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63),t[a++]=128|r>>>6&63),t[a++]=128|63&r);return t}(e)},r.utf8decode=function(e){return i.nodebuffer?n.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,r,i,s,a=e.length,l=new Array(2*a);for(t=r=0;t<a;)if((i=e[t++])<128)l[r++]=i;else if(4<(s=o[i]))l[r++]=65533,t+=s-1;else{for(i&=2===s?31:3===s?15:7;1<s&&t<a;)i=i<<6|63&e[t++],s--;1<s?l[r++]=65533:i<65536?l[r++]=i:(i-=65536,l[r++]=55296|i>>10&1023,l[r++]=56320|1023&i)}return l.length!==r&&(l.subarray?l=l.subarray(0,r):l.length=r),n.applyFromCharCode(l)}(e=n.transformTo(i.uint8array?"uint8array":"array",e))},n.inherits(c,a),c.prototype.processChunk=function(e){var t=n.transformTo(i.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var s=t;(t=new Uint8Array(s.length+this.leftOver.length)).set(this.leftOver,0),t.set(s,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var a=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+o[e[r]]>t?r:t}(t),l=t;a!==t.length&&(i.uint8array?(l=t.subarray(0,a),this.leftOver=t.subarray(a,t.length)):(l=t.slice(0,a),this.leftOver=t.slice(a,t.length))),this.push({data:r.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=c,n.inherits(u,a),u.prototype.processChunk=function(e){this.push({data:r.utf8encode(e.data),meta:e.meta})},r.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,r){var n=e("./support"),i=e("./base64"),s=e("./nodejsUtils"),a=e("./external");function o(e){return e}function l(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}e("setimmediate"),r.newBlob=function(e,t){r.checkSupport("blob");try{return new Blob([e],{type:t})}catch(r){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(e),n.getBlob(t)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(e,t,r){var n=[],i=0,s=e.length;if(s<=r)return String.fromCharCode.apply(null,e);for(;i<s;)"array"===t||"nodebuffer"===t?n.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+r,s)))):n.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+r,s)))),i+=r;return n.join("")},stringifyByChar:function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&1===String.fromCharCode.apply(null,s.allocBuffer(1)).length}catch(e){return!1}}()}};function h(e){var t=65536,n=r.getTypeOf(e),i=!0;if("uint8array"===n?i=c.applyCanBeUsed.uint8array:"nodebuffer"===n&&(i=c.applyCanBeUsed.nodebuffer),i)for(;1<t;)try{return c.stringifyByChunk(e,n,t)}catch(e){t=Math.floor(t/2)}return c.stringifyByChar(e)}function d(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}r.applyFromCharCode=h;var f={};f.string={string:o,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return f.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,s.allocBuffer(e.length))}},f.array={string:h,array:o,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s.newBufferFrom(e)}},f.arraybuffer={string:function(e){return h(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:o,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s.newBufferFrom(new Uint8Array(e))}},f.uint8array={string:h,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:o,nodebuffer:function(e){return s.newBufferFrom(e)}},f.nodebuffer={string:h,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return f.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:o},r.transformTo=function(e,t){if(t=t||"",!e)return t;r.checkSupport(e);var n=r.getTypeOf(t);return f[n][e](t)},r.resolve=function(e){for(var t=e.split("/"),r=[],n=0;n<t.length;n++){var i=t[n];"."===i||""===i&&0!==n&&n!==t.length-1||(".."===i?r.pop():r.push(i))}return r.join("/")},r.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":n.nodebuffer&&s.isBuffer(e)?"nodebuffer":n.uint8array&&e instanceof Uint8Array?"uint8array":n.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(e){if(!n[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(e){var t,r,n="";for(r=0;r<(e||"").length;r++)n+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return n},r.delay=function(e,t,r){u((function(){e.apply(r||null,t||[])}))},r.inherits=function(e,t){function r(){}r.prototype=t.prototype,e.prototype=new r},r.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},r.prepareContent=function(e,t,s,o,c){return a.Promise.resolve(t).then((function(e){return n.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new a.Promise((function(t,r){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.onerror=function(e){r(e.target.error)},n.readAsArrayBuffer(e)})):e})).then((function(t){var u=r.getTypeOf(t);return u?("arraybuffer"===u?t=r.transformTo("uint8array",t):"string"===u&&(c?t=i.decode(t):s&&!0!==o&&(t=function(e){return l(e,n.uint8array?new Uint8Array(e.length):new Array(e.length))}(t))),t):a.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,r){var n=e("./reader/readerFor"),i=e("./utils"),s=e("./signature"),a=e("./zipEntry"),o=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(t)+", expected "+i.pretty(e)+")")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4)===t;return this.reader.setIndex(r),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=o.uint8array?"uint8array":"array",r=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=t-r;if(0<n)this.isSignature(t,s.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(e){this.reader=n(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,r){var n=e("./reader/readerFor"),i=e("./utils"),s=e("./compressedObject"),a=e("./crc32"),o=e("./utf8"),l=e("./compressions"),c=e("./support");function u(e,t){this.options=e,this.loadOptions=t}u.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=n(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,r,n,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),r=e.readInt(2),n=e.readData(r),this.extraFields[t]={id:t,length:r,value:n};e.setIndex(i)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=o.utf8decode(this.fileName),this.fileCommentStr=o.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=i.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var s=i.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(s)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=n(e.value);return 1!==t.readInt(1)||a(this.fileName)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=n(e.value);return 1!==t.readInt(1)||a(this.fileComment)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null}},t.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,r){function n(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}}var i=e("./stream/StreamHelper"),s=e("./stream/DataWorker"),a=e("./utf8"),o=e("./compressedObject"),l=e("./stream/GenericWorker");n.prototype={internalStream:function(e){var t=null,r="string";try{if(!e)throw new Error("No output type specified.");var n="string"===(r=e.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),t=this._decompressWorker();var s=!this._dataBinary;s&&!n&&(t=t.pipe(new a.Utf8EncodeWorker)),!s&&n&&(t=t.pipe(new a.Utf8DecodeWorker))}catch(e){(t=new l("error")).error(e)}return new i(t,r,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof o&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new a.Utf8EncodeWorker)),o.createWorkerFrom(r,e,t)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof l?this._data:new s(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<c.length;h++)n.prototype[c[h]]=u;t.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){(function(e){var r,n,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var s=0,a=new i(u),o=e.document.createTextNode("");a.observe(o,{characterData:!0}),r=function(){o.data=s=++s%2}}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,r=function(){l.port2.postMessage(0)}}var c=[];function u(){var e,t;n=!0;for(var r=c.length;r;){for(t=c,c=[],e=-1;++e<r;)t[e]();r=c.length}n=!1}t.exports=function(e){1!==c.push(e)||n||r()}}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,r){var n=e("immediate");function i(){}var s={},a=["REJECTED"],o=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==i&&f(this,e)}function u(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function h(e,t,r){n((function(){var n;try{n=t(r)}catch(n){return s.reject(e,n)}n===e?s.reject(e,new TypeError("Cannot resolve promise with itself")):s.resolve(e,n)}))}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var r=!1;function n(t){r||(r=!0,s.reject(e,t))}function i(t){r||(r=!0,s.resolve(e,t))}var a=p((function(){t(i,n)}));"error"===a.status&&n(a.value)}function p(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}(t.exports=c).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){throw r}))}))},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===o||"function"!=typeof t&&this.state===a)return this;var r=new this.constructor(i);return this.state!==l?h(r,this.state===o?e:t,this.outcome):this.queue.push(new u(r,e,t)),r},u.prototype.callFulfilled=function(e){s.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){h(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){s.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){h(this.promise,this.onRejected,e)},s.resolve=function(e,t){var r=p(d,t);if("error"===r.status)return s.reject(e,r.value);var n=r.value;if(n)f(e,n);else{e.state=o,e.outcome=t;for(var i=-1,a=e.queue.length;++i<a;)e.queue[i].callFulfilled(t)}return e},s.reject=function(e,t){e.state=a,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:s.resolve(new this(i),e)},c.reject=function(e){var t=new this(i);return s.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var a=new Array(r),o=0,l=-1,c=new this(i);++l<r;)u(e[l],l);return c;function u(e,i){t.resolve(e).then((function(e){a[i]=e,++o!==r||n||(n=!0,s.resolve(c,a))}),(function(e){n||(n=!0,s.reject(c,e))}))}},c.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,r=!1;if(!t)return this.resolve([]);for(var n,a=-1,o=new this(i);++a<t;)n=e[a],this.resolve(n).then((function(e){r||(r=!0,s.resolve(o,e))}),(function(e){r||(r=!0,s.reject(o,e))}));return o}},{immediate:36}],38:[function(e,t,r){var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,r){var n=e("./zlib/deflate"),i=e("./utils/common"),s=e("./utils/strings"),a=e("./zlib/messages"),o=e("./zlib/zstream"),l=Object.prototype.toString;function c(e){if(!(this instanceof c))return new c(e);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var r=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==r)throw new Error(a[r]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){var u;if(u="string"==typeof t.dictionary?s.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(r=n.deflateSetDictionary(this.strm,u)))throw new Error(a[r]);this._dict_set=!0}}function u(e,t){var r=new c(t);if(r.push(e,!0),r.err)throw r.msg||a[r.err];return r.result}c.prototype.push=function(e,t){var r,a,o=this.strm,c=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?o.input=s.string2buf(e):"[object ArrayBuffer]"===l.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new i.Buf8(c),o.next_out=0,o.avail_out=c),1!==(r=n.deflate(o,a))&&0!==r)return this.onEnd(r),!(this.ended=!0);0!==o.avail_out&&(0!==o.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(s.buf2binstring(i.shrinkBuf(o.output,o.next_out))):this.onData(i.shrinkBuf(o.output,o.next_out)))}while((0<o.avail_in||0===o.avail_out)&&1!==r);return 4===a?(r=n.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,0===r):2!==a||(this.onEnd(0),!(o.avail_out=0))},c.prototype.onData=function(e){this.chunks.push(e)},c.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Deflate=c,r.deflate=u,r.deflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},r.gzip=function(e,t){return(t=t||{}).gzip=!0,u(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,r){var n=e("./zlib/inflate"),i=e("./utils/common"),s=e("./utils/strings"),a=e("./zlib/constants"),o=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),u=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var r=n.inflateInit2(this.strm,t.windowBits);if(r!==a.Z_OK)throw new Error(o[r]);this.header=new c,n.inflateGetHeader(this.strm,this.header)}function d(e,t){var r=new h(t);if(r.push(e,!0),r.err)throw r.msg||o[r.err];return r.result}h.prototype.push=function(e,t){var r,o,l,c,h,d,f=this.strm,p=this.options.chunkSize,m=this.options.dictionary,g=!1;if(this.ended)return!1;o=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?f.input=s.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new i.Buf8(p),f.next_out=0,f.avail_out=p),(r=n.inflate(f,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&m&&(d="string"==typeof m?s.string2buf(m):"[object ArrayBuffer]"===u.call(m)?new Uint8Array(m):m,r=n.inflateSetDictionary(this.strm,d)),r===a.Z_BUF_ERROR&&!0===g&&(r=a.Z_OK,g=!1),r!==a.Z_STREAM_END&&r!==a.Z_OK)return this.onEnd(r),!(this.ended=!0);f.next_out&&(0!==f.avail_out&&r!==a.Z_STREAM_END&&(0!==f.avail_in||o!==a.Z_FINISH&&o!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=s.utf8border(f.output,f.next_out),c=f.next_out-l,h=s.buf2string(f.output,l),f.next_out=c,f.avail_out=p-c,c&&i.arraySet(f.output,f.output,l,c,0),this.onData(h)):this.onData(i.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(g=!0)}while((0<f.avail_in||0===f.avail_out)&&r!==a.Z_STREAM_END);return r===a.Z_STREAM_END&&(o=a.Z_FINISH),o===a.Z_FINISH?(r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===a.Z_OK):o!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),!(f.avail_out=0))},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=h,r.inflate=d,r.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},r.ungzip=d},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,r){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var s=0;s<n;s++)e[i+s]=t[r+s]},flattenChunks:function(e){var t,r,n,i,s,a;for(t=n=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),t=i=0,r=e.length;t<r;t++)s=e[t],a.set(s,i),i+=s.length;return a}},s={arraySet:function(e,t,r,n,i){for(var s=0;s<n;s++)e[i+s]=t[r+s]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,i)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,s))},r.setTyped(n)},{}],42:[function(e,t,r){var n=e("./common"),i=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){s=!1}for(var a=new n.Buf8(256),o=0;o<256;o++)a[o]=252<=o?6:248<=o?5:240<=o?4:224<=o?3:192<=o?2:1;function l(e,t){if(t<65537&&(e.subarray&&s||!e.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(e,t));for(var r="",a=0;a<t;a++)r+=String.fromCharCode(e[a]);return r}a[254]=a[254]=1,r.string2buf=function(e){var t,r,i,s,a,o=e.length,l=0;for(s=0;s<o;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(i=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(i-56320),s++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new n.Buf8(l),s=a=0;a<l;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(i=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(i-56320),s++),r<128?t[a++]=r:(r<2048?t[a++]=192|r>>>6:(r<65536?t[a++]=224|r>>>12:(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63),t[a++]=128|r>>>6&63),t[a++]=128|63&r);return t},r.buf2binstring=function(e){return l(e,e.length)},r.binstring2buf=function(e){for(var t=new n.Buf8(e.length),r=0,i=t.length;r<i;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,n,i,s,o=t||e.length,c=new Array(2*o);for(r=n=0;r<o;)if((i=e[r++])<128)c[n++]=i;else if(4<(s=a[i]))c[n++]=65533,r+=s-1;else{for(i&=2===s?31:3===s?15:7;1<s&&r<o;)i=i<<6|63&e[r++],s--;1<s?c[n++]=65533:i<65536?c[n++]=i:(i-=65536,c[n++]=55296|i>>10&1023,c[n++]=56320|1023&i)}return l(c,n)},r.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+a[e[r]]>t?r:t}},{"./common":41}],43:[function(e,t,r){t.exports=function(e,t,r,n){for(var i=65535&e,s=e>>>16&65535,a=0;0!==r;){for(r-=a=2e3<r?2e3:r;s=s+(i=i+t[n++]|0)|0,--a;);i%=65521,s%=65521}return i|s<<16}},{}],44:[function(e,t,r){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,r){var n=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,r,i){var s=n,a=i+r;e^=-1;for(var o=i;o<a;o++)e=e>>>8^s[255&(e^t[o])];return~e}},{}],46:[function(e,t,r){var n,i=e("../utils/common"),s=e("./trees"),a=e("./adler32"),o=e("./crc32"),l=e("./messages"),c=-2,u=258,h=262,d=113;function f(e,t){return e.msg=l[t],t}function p(e){return(e<<1)-(4<e?9:0)}function m(e){for(var t=e.length;0<=--t;)e[t]=0}function g(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(i.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function v(e,t){s._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,g(e.strm)}function y(e,t){e.pending_buf[e.pending++]=t}function b(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function w(e,t){var r,n,i=e.max_chain_length,s=e.strstart,a=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-h?e.strstart-(e.w_size-h):0,c=e.window,d=e.w_mask,f=e.prev,p=e.strstart+u,m=c[s+a-1],g=c[s+a];e.prev_length>=e.good_match&&(i>>=2),o>e.lookahead&&(o=e.lookahead);do{if(c[(r=t)+a]===g&&c[r+a-1]===m&&c[r]===c[s]&&c[++r]===c[s+1]){s+=2,r++;do{}while(c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&s<p);if(n=u-(p-s),s=p-u,a<n){if(e.match_start=t,o<=(a=n))break;m=c[s+a-1],g=c[s+a]}}}while((t=f[t&d])>l&&0!=--i);return a<=e.lookahead?a:e.lookahead}function x(e){var t,r,n,s,l,c,u,d,f,p,m=e.w_size;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-h)){for(i.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,t=r=e.hash_size;n=e.head[--t],e.head[t]=m<=n?n-m:0,--r;);for(t=r=m;n=e.prev[--t],e.prev[t]=m<=n?n-m:0,--r;);s+=m}if(0===e.strm.avail_in)break;if(c=e.strm,u=e.window,d=e.strstart+e.lookahead,p=void 0,(f=s)<(p=c.avail_in)&&(p=f),r=0===p?0:(c.avail_in-=p,i.arraySet(u,c.input,c.next_in,p,d),1===c.state.wrap?c.adler=a(c.adler,u,p,d):2===c.state.wrap&&(c.adler=o(c.adler,u,p,d)),c.next_in+=p,c.total_in+=p,p),e.lookahead+=r,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<h&&0!==e.strm.avail_in)}function S(e,t){for(var r,n;;){if(e.lookahead<h){if(x(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-h&&(e.match_length=w(e,r)),e.match_length>=3)if(n=s._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(v(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(v(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(v(e,!1),0===e.strm.avail_out)?1:2}function _(e,t){for(var r,n,i;;){if(e.lookahead<h){if(x(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-h&&(e.match_length=w(e,r),e.match_length<=5&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){for(i=e.strstart+e.lookahead-3,n=s._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(v(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((n=s._tr_tally(e,0,e.window[e.strstart-1]))&&v(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=s._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(v(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(v(e,!1),0===e.strm.avail_out)?1:2}function C(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function E(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),m(this.dyn_ltree),m(this.dyn_dtree),m(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),m(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),m(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function A(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:d,e.adler=2===t.wrap?0:1,t.last_flush=0,s._tr_init(t),0):f(e,c)}function M(e){var t=A(e);return 0===t&&function(e){e.window_size=2*e.w_size,m(e.head),e.max_lazy_match=n[e.level].max_lazy,e.good_match=n[e.level].good_length,e.nice_match=n[e.level].nice_length,e.max_chain_length=n[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0}(e.state),t}function T(e,t,r,n,s,a){if(!e)return c;var o=1;if(-1===t&&(t=6),n<0?(o=0,n=-n):15<n&&(o=2,n-=16),s<1||9<s||8!==r||n<8||15<n||t<0||9<t||a<0||4<a)return f(e,c);8===n&&(n=9);var l=new E;return(e.state=l).strm=e,l.wrap=o,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=s+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<s+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=r,M(e)}n=[new C(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(x(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,v(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-h&&(v(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(v(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(v(e,!1),e.strm.avail_out),1)})),new C(4,4,8,4,S),new C(4,5,16,8,S),new C(4,6,32,32,S),new C(4,4,16,16,_),new C(8,16,32,32,_),new C(8,16,128,128,_),new C(8,32,128,256,_),new C(32,128,258,1024,_),new C(32,258,258,4096,_)],r.deflateInit=function(e,t){return T(e,t,8,15,8,0)},r.deflateInit2=T,r.deflateReset=M,r.deflateResetKeep=A,r.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?c:(e.state.gzhead=t,0):c},r.deflate=function(e,t){var r,i,a,l;if(!e||!e.state||5<t||t<0)return e?f(e,c):c;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&4!==t)return f(e,0===e.avail_out?-5:c);if(i.strm=e,r=i.last_flush,i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,y(i,31),y(i,139),y(i,8),i.gzhead?(y(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),y(i,255&i.gzhead.time),y(i,i.gzhead.time>>8&255),y(i,i.gzhead.time>>16&255),y(i,i.gzhead.time>>24&255),y(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),y(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(y(i,255&i.gzhead.extra.length),y(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=o(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(y(i,0),y(i,0),y(i,0),y(i,0),y(i,0),y(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),y(i,3),i.status=d);else{var h=8+(i.w_bits-8<<4)<<8;h|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(h|=32),h+=31-h%31,i.status=d,b(i,h),0!==i.strstart&&(b(i,e.adler>>>16),b(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(a=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),g(e),a=i.pending,i.pending!==i.pending_buf_size));)y(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),g(e),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,y(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),g(e),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,y(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&g(e),i.pending+2<=i.pending_buf_size&&(y(i,255&e.adler),y(i,e.adler>>8&255),e.adler=0,i.status=d)):i.status=d),0!==i.pending){if(g(e),0===e.avail_out)return i.last_flush=-1,0}else if(0===e.avail_in&&p(t)<=p(r)&&4!==t)return f(e,-5);if(666===i.status&&0!==e.avail_in)return f(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&666!==i.status){var w=2===i.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(x(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,r=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(v(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(v(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(v(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var r,n,i,a,o=e.window;;){if(e.lookahead<=u){if(x(e),e.lookahead<=u&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&0<e.strstart&&(n=o[i=e.strstart-1])===o[++i]&&n===o[++i]&&n===o[++i]){a=e.strstart+u;do{}while(n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&i<a);e.match_length=u-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=s._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(v(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(v(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(v(e,!1),0===e.strm.avail_out)?1:2}(i,t):n[i.level].func(i,t);if(3!==w&&4!==w||(i.status=666),1===w||3===w)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===w&&(1===t?s._tr_align(i):5!==t&&(s._tr_stored_block(i,0,0,!1),3===t&&(m(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),g(e),0===e.avail_out))return i.last_flush=-1,0}return 4!==t?0:i.wrap<=0?1:(2===i.wrap?(y(i,255&e.adler),y(i,e.adler>>8&255),y(i,e.adler>>16&255),y(i,e.adler>>24&255),y(i,255&e.total_in),y(i,e.total_in>>8&255),y(i,e.total_in>>16&255),y(i,e.total_in>>24&255)):(b(i,e.adler>>>16),b(i,65535&e.adler)),g(e),0<i.wrap&&(i.wrap=-i.wrap),0!==i.pending?0:1)},r.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&t!==d&&666!==t?f(e,c):(e.state=null,t===d?f(e,-3):0):c},r.deflateSetDictionary=function(e,t){var r,n,s,o,l,u,h,d,f=t.length;if(!e||!e.state)return c;if(2===(o=(r=e.state).wrap)||1===o&&42!==r.status||r.lookahead)return c;for(1===o&&(e.adler=a(e.adler,t,f,0)),r.wrap=0,f>=r.w_size&&(0===o&&(m(r.head),r.strstart=0,r.block_start=0,r.insert=0),d=new i.Buf8(r.w_size),i.arraySet(d,t,f-r.w_size,r.w_size,0),t=d,f=r.w_size),l=e.avail_in,u=e.next_in,h=e.input,e.avail_in=f,e.next_in=0,e.input=t,x(r);r.lookahead>=3;){for(n=r.strstart,s=r.lookahead-2;r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+3-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++,--s;);r.strstart=n,r.lookahead=2,x(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=u,e.input=h,e.avail_in=l,r.wrap=o,0},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,r){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,r){t.exports=function(e,t){var r,n,i,s,a,o,l,c,u,h,d,f,p,m,g,v,y,b,w,x,S,_,C,E,A;r=e.state,n=e.next_in,E=e.input,i=n+(e.avail_in-5),s=e.next_out,A=e.output,a=s-(t-e.avail_out),o=s+(e.avail_out-257),l=r.dmax,c=r.wsize,u=r.whave,h=r.wnext,d=r.window,f=r.hold,p=r.bits,m=r.lencode,g=r.distcode,v=(1<<r.lenbits)-1,y=(1<<r.distbits)-1;e:do{p<15&&(f+=E[n++]<<p,p+=8,f+=E[n++]<<p,p+=8),b=m[f&v];t:for(;;){if(f>>>=w=b>>>24,p-=w,0==(w=b>>>16&255))A[s++]=65535&b;else{if(!(16&w)){if(0==(64&w)){b=m[(65535&b)+(f&(1<<w)-1)];continue t}if(32&w){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}x=65535&b,(w&=15)&&(p<w&&(f+=E[n++]<<p,p+=8),x+=f&(1<<w)-1,f>>>=w,p-=w),p<15&&(f+=E[n++]<<p,p+=8,f+=E[n++]<<p,p+=8),b=g[f&y];r:for(;;){if(f>>>=w=b>>>24,p-=w,!(16&(w=b>>>16&255))){if(0==(64&w)){b=g[(65535&b)+(f&(1<<w)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(S=65535&b,p<(w&=15)&&(f+=E[n++]<<p,(p+=8)<w&&(f+=E[n++]<<p,p+=8)),l<(S+=f&(1<<w)-1)){e.msg="invalid distance too far back",r.mode=30;break e}if(f>>>=w,p-=w,(w=s-a)<S){if(u<(w=S-w)&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(C=d,(_=0)===h){if(_+=c-w,w<x){for(x-=w;A[s++]=d[_++],--w;);_=s-S,C=A}}else if(h<w){if(_+=c+h-w,(w-=h)<x){for(x-=w;A[s++]=d[_++],--w;);if(_=0,h<x){for(x-=w=h;A[s++]=d[_++],--w;);_=s-S,C=A}}}else if(_+=h-w,w<x){for(x-=w;A[s++]=d[_++],--w;);_=s-S,C=A}for(;2<x;)A[s++]=C[_++],A[s++]=C[_++],A[s++]=C[_++],x-=3;x&&(A[s++]=C[_++],1<x&&(A[s++]=C[_++]))}else{for(_=s-S;A[s++]=A[_++],A[s++]=A[_++],A[s++]=A[_++],2<(x-=3););x&&(A[s++]=A[_++],1<x&&(A[s++]=A[_++]))}break}}break}}while(n<i&&s<o);n-=x=p>>3,f&=(1<<(p-=x<<3))-1,e.next_in=n,e.next_out=s,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=s<o?o-s+257:257-(s-o),r.hold=f,r.bits=p}},{}],49:[function(e,t,r){var n=e("../utils/common"),i=e("./adler32"),s=e("./crc32"),a=e("./inffast"),o=e("./inftrees"),l=-2;function c(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function u(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function h(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(852),t.distcode=t.distdyn=new n.Buf32(592),t.sane=1,t.back=-1,0):l}function d(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,h(e)):l}function f(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?l:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,d(e))):l}function p(e,t){var r,n;return e?(n=new u,(e.state=n).window=null,0!==(r=f(e,t))&&(e.state=null),r):l}var m,g,v=!0;function y(e){if(v){var t;for(m=new n.Buf32(512),g=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(1,e.lens,0,288,m,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(2,e.lens,0,32,g,0,e.work,{bits:5}),v=!1}e.lencode=m,e.lenbits=9,e.distcode=g,e.distbits=5}function b(e,t,r,i){var s,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new n.Buf8(a.wsize)),i>=a.wsize?(n.arraySet(a.window,t,r-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(i<(s=a.wsize-a.wnext)&&(s=i),n.arraySet(a.window,t,r-i,s,a.wnext),(i-=s)?(n.arraySet(a.window,t,r-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0}r.inflateReset=d,r.inflateReset2=f,r.inflateResetKeep=h,r.inflateInit=function(e){return p(e,15)},r.inflateInit2=p,r.inflate=function(e,t){var r,u,h,d,f,p,m,g,v,w,x,S,_,C,E,A,M,T,P,k,D,I,O,R,L=0,N=new n.Buf8(4),B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return l;12===(r=e.state).mode&&(r.mode=13),f=e.next_out,h=e.output,m=e.avail_out,d=e.next_in,u=e.input,p=e.avail_in,g=r.hold,v=r.bits,w=p,x=m,I=0;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;v<16;){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}if(2&r.wrap&&35615===g){N[r.check=0]=255&g,N[1]=g>>>8&255,r.check=s(r.check,N,2,0),v=g=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&g)<<8)+(g>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&g)){e.msg="unknown compression method",r.mode=30;break}if(v-=4,D=8+(15&(g>>>=4)),0===r.wbits)r.wbits=D;else if(D>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<D,e.adler=r.check=1,r.mode=512&g?10:12,v=g=0;break;case 2:for(;v<16;){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}if(r.flags=g,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=g>>8&1),512&r.flags&&(N[0]=255&g,N[1]=g>>>8&255,r.check=s(r.check,N,2,0)),v=g=0,r.mode=3;case 3:for(;v<32;){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}r.head&&(r.head.time=g),512&r.flags&&(N[0]=255&g,N[1]=g>>>8&255,N[2]=g>>>16&255,N[3]=g>>>24&255,r.check=s(r.check,N,4,0)),v=g=0,r.mode=4;case 4:for(;v<16;){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}r.head&&(r.head.xflags=255&g,r.head.os=g>>8),512&r.flags&&(N[0]=255&g,N[1]=g>>>8&255,r.check=s(r.check,N,2,0)),v=g=0,r.mode=5;case 5:if(1024&r.flags){for(;v<16;){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}r.length=g,r.head&&(r.head.extra_len=g),512&r.flags&&(N[0]=255&g,N[1]=g>>>8&255,r.check=s(r.check,N,2,0)),v=g=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(p<(S=r.length)&&(S=p),S&&(r.head&&(D=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),n.arraySet(r.head.extra,u,d,S,D)),512&r.flags&&(r.check=s(r.check,u,S,d)),p-=S,d+=S,r.length-=S),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===p)break e;for(S=0;D=u[d+S++],r.head&&D&&r.length<65536&&(r.head.name+=String.fromCharCode(D)),D&&S<p;);if(512&r.flags&&(r.check=s(r.check,u,S,d)),p-=S,d+=S,D)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===p)break e;for(S=0;D=u[d+S++],r.head&&D&&r.length<65536&&(r.head.comment+=String.fromCharCode(D)),D&&S<p;);if(512&r.flags&&(r.check=s(r.check,u,S,d)),p-=S,d+=S,D)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;v<16;){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}if(g!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}v=g=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;v<32;){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}e.adler=r.check=c(g),v=g=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=f,e.avail_out=m,e.next_in=d,e.avail_in=p,r.hold=g,r.bits=v,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){g>>>=7&v,v-=7&v,r.mode=27;break}for(;v<3;){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}switch(r.last=1&g,v-=1,3&(g>>>=1)){case 0:r.mode=14;break;case 1:if(y(r),r.mode=20,6!==t)break;g>>>=2,v-=2;break e;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}g>>>=2,v-=2;break;case 14:for(g>>>=7&v,v-=7&v;v<32;){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}if((65535&g)!=(g>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&g,v=g=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(S=r.length){if(p<S&&(S=p),m<S&&(S=m),0===S)break e;n.arraySet(h,u,d,S,f),p-=S,d+=S,m-=S,f+=S,r.length-=S;break}r.mode=12;break;case 17:for(;v<14;){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}if(r.nlen=257+(31&g),g>>>=5,v-=5,r.ndist=1+(31&g),g>>>=5,v-=5,r.ncode=4+(15&g),g>>>=4,v-=4,286<r.nlen||30<r.ndist){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;v<3;){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}r.lens[B[r.have++]]=7&g,g>>>=3,v-=3}for(;r.have<19;)r.lens[B[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,O={bits:r.lenbits},I=o(0,r.lens,0,19,r.lencode,0,r.work,O),r.lenbits=O.bits,I){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;A=(L=r.lencode[g&(1<<r.lenbits)-1])>>>16&255,M=65535&L,!((E=L>>>24)<=v);){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}if(M<16)g>>>=E,v-=E,r.lens[r.have++]=M;else{if(16===M){for(R=E+2;v<R;){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}if(g>>>=E,v-=E,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}D=r.lens[r.have-1],S=3+(3&g),g>>>=2,v-=2}else if(17===M){for(R=E+3;v<R;){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}v-=E,D=0,S=3+(7&(g>>>=E)),g>>>=3,v-=3}else{for(R=E+7;v<R;){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}v-=E,D=0,S=11+(127&(g>>>=E)),g>>>=7,v-=7}if(r.have+S>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;S--;)r.lens[r.have++]=D}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,O={bits:r.lenbits},I=o(1,r.lens,0,r.nlen,r.lencode,0,r.work,O),r.lenbits=O.bits,I){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,O={bits:r.distbits},I=o(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,O),r.distbits=O.bits,I){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(6<=p&&258<=m){e.next_out=f,e.avail_out=m,e.next_in=d,e.avail_in=p,r.hold=g,r.bits=v,a(e,x),f=e.next_out,h=e.output,m=e.avail_out,d=e.next_in,u=e.input,p=e.avail_in,g=r.hold,v=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;A=(L=r.lencode[g&(1<<r.lenbits)-1])>>>16&255,M=65535&L,!((E=L>>>24)<=v);){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}if(A&&0==(240&A)){for(T=E,P=A,k=M;A=(L=r.lencode[k+((g&(1<<T+P)-1)>>T)])>>>16&255,M=65535&L,!(T+(E=L>>>24)<=v);){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}g>>>=T,v-=T,r.back+=T}if(g>>>=E,v-=E,r.back+=E,r.length=M,0===A){r.mode=26;break}if(32&A){r.back=-1,r.mode=12;break}if(64&A){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&A,r.mode=22;case 22:if(r.extra){for(R=r.extra;v<R;){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}r.length+=g&(1<<r.extra)-1,g>>>=r.extra,v-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;A=(L=r.distcode[g&(1<<r.distbits)-1])>>>16&255,M=65535&L,!((E=L>>>24)<=v);){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}if(0==(240&A)){for(T=E,P=A,k=M;A=(L=r.distcode[k+((g&(1<<T+P)-1)>>T)])>>>16&255,M=65535&L,!(T+(E=L>>>24)<=v);){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}g>>>=T,v-=T,r.back+=T}if(g>>>=E,v-=E,r.back+=E,64&A){e.msg="invalid distance code",r.mode=30;break}r.offset=M,r.extra=15&A,r.mode=24;case 24:if(r.extra){for(R=r.extra;v<R;){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}r.offset+=g&(1<<r.extra)-1,g>>>=r.extra,v-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===m)break e;if(S=x-m,r.offset>S){if((S=r.offset-S)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}_=S>r.wnext?(S-=r.wnext,r.wsize-S):r.wnext-S,S>r.length&&(S=r.length),C=r.window}else C=h,_=f-r.offset,S=r.length;for(m<S&&(S=m),m-=S,r.length-=S;h[f++]=C[_++],--S;);0===r.length&&(r.mode=21);break;case 26:if(0===m)break e;h[f++]=r.length,m--,r.mode=21;break;case 27:if(r.wrap){for(;v<32;){if(0===p)break e;p--,g|=u[d++]<<v,v+=8}if(x-=m,e.total_out+=x,r.total+=x,x&&(e.adler=r.check=r.flags?s(r.check,h,x,f-x):i(r.check,h,x,f-x)),x=m,(r.flags?g:c(g))!==r.check){e.msg="incorrect data check",r.mode=30;break}v=g=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;v<32;){if(0===p)break e;p--,g+=u[d++]<<v,v+=8}if(g!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}v=g=0}r.mode=29;case 29:I=1;break e;case 30:I=-3;break e;case 31:return-4;default:return l}return e.next_out=f,e.avail_out=m,e.next_in=d,e.avail_in=p,r.hold=g,r.bits=v,(r.wsize||x!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&b(e,e.output,e.next_out,x-e.avail_out)?(r.mode=31,-4):(w-=e.avail_in,x-=e.avail_out,e.total_in+=w,e.total_out+=x,r.total+=x,r.wrap&&x&&(e.adler=r.check=r.flags?s(r.check,h,x,e.next_out-x):i(r.check,h,x,e.next_out-x)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0==w&&0===x||4===t)&&0===I&&(I=-5),I)},r.inflateEnd=function(e){if(!e||!e.state)return l;var t=e.state;return t.window&&(t.window=null),e.state=null,0},r.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?l:((r.head=t).done=!1,0):l},r.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?l:11===r.mode&&i(1,t,n,0)!==r.check?-3:b(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,0):l},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,r){var n=e("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,l,c,u,h,d){var f,p,m,g,v,y,b,w,x,S=d.bits,_=0,C=0,E=0,A=0,M=0,T=0,P=0,k=0,D=0,I=0,O=null,R=0,L=new n.Buf16(16),N=new n.Buf16(16),B=null,z=0;for(_=0;_<=15;_++)L[_]=0;for(C=0;C<l;C++)L[t[r+C]]++;for(M=S,A=15;1<=A&&0===L[A];A--);if(A<M&&(M=A),0===A)return c[u++]=20971520,c[u++]=20971520,d.bits=1,0;for(E=1;E<A&&0===L[E];E++);for(M<E&&(M=E),_=k=1;_<=15;_++)if(k<<=1,(k-=L[_])<0)return-1;if(0<k&&(0===e||1!==A))return-1;for(N[1]=0,_=1;_<15;_++)N[_+1]=N[_]+L[_];for(C=0;C<l;C++)0!==t[r+C]&&(h[N[t[r+C]]++]=C);if(y=0===e?(O=B=h,19):1===e?(O=i,R-=257,B=s,z-=257,256):(O=a,B=o,-1),_=E,v=u,P=C=I=0,m=-1,g=(D=1<<(T=M))-1,1===e&&852<D||2===e&&592<D)return 1;for(;;){for(b=_-P,x=h[C]<y?(w=0,h[C]):h[C]>y?(w=B[z+h[C]],O[R+h[C]]):(w=96,0),f=1<<_-P,E=p=1<<T;c[v+(I>>P)+(p-=f)]=b<<24|w<<16|x,0!==p;);for(f=1<<_-1;I&f;)f>>=1;if(0!==f?(I&=f-1,I+=f):I=0,C++,0==--L[_]){if(_===A)break;_=t[r+h[C]]}if(M<_&&(I&g)!==m){for(0===P&&(P=M),v+=E,k=1<<(T=_-P);T+P<A&&!((k-=L[T+P])<=0);)T++,k<<=1;if(D+=1<<T,1===e&&852<D||2===e&&592<D)return 1;c[m=I&g]=M<<24|T<<16|v-u}}return 0!==I&&(c[v+I]=_-P<<24|64<<16),d.bits=M,0}},{"../utils/common":41}],51:[function(e,t,r){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,r){var n=e("../utils/common");function i(e){for(var t=e.length;0<=--t;)e[t]=0}var s=256,a=286,o=30,l=15,c=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],u=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],d=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],f=new Array(576);i(f);var p=new Array(60);i(p);var m=new Array(512);i(m);var g=new Array(256);i(g);var v=new Array(29);i(v);var y,b,w,x=new Array(o);function S(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function _(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function C(e){return e<256?m[e]:m[256+(e>>>7)]}function E(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function A(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,E(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function M(e,t,r){A(e,r[2*t],r[2*t+1])}function T(e,t){for(var r=0;r|=1&e,e>>>=1,r<<=1,0<--t;);return r>>>1}function P(e,t,r){var n,i,s=new Array(16),a=0;for(n=1;n<=l;n++)s[n]=a=a+r[n-1]<<1;for(i=0;i<=t;i++){var o=e[2*i+1];0!==o&&(e[2*i]=T(s[o]++,o))}}function k(e){var t;for(t=0;t<a;t++)e.dyn_ltree[2*t]=0;for(t=0;t<o;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function D(e){8<e.bi_valid?E(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function I(e,t,r,n){var i=2*t,s=2*r;return e[i]<e[s]||e[i]===e[s]&&n[t]<=n[r]}function O(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&I(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!I(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function R(e,t,r){var n,i,a,o,l=0;if(0!==e.last_lit)for(;n=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],i=e.pending_buf[e.l_buf+l],l++,0===n?M(e,i,t):(M(e,(a=g[i])+s+1,t),0!==(o=c[a])&&A(e,i-=v[a],o),M(e,a=C(--n),r),0!==(o=u[a])&&A(e,n-=x[a],o)),l<e.last_lit;);M(e,256,t)}function L(e,t){var r,n,i,s=t.dyn_tree,a=t.stat_desc.static_tree,o=t.stat_desc.has_stree,c=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<c;r++)0!==s[2*r]?(e.heap[++e.heap_len]=u=r,e.depth[r]=0):s[2*r+1]=0;for(;e.heap_len<2;)s[2*(i=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[i]=0,e.opt_len--,o&&(e.static_len-=a[2*i+1]);for(t.max_code=u,r=e.heap_len>>1;1<=r;r--)O(e,s,r);for(i=c;r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],O(e,s,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,s[2*i]=s[2*r]+s[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,s[2*r+1]=s[2*n+1]=i,e.heap[1]=i++,O(e,s,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,s,a,o,c=t.dyn_tree,u=t.max_code,h=t.stat_desc.static_tree,d=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,m=t.stat_desc.max_length,g=0;for(s=0;s<=l;s++)e.bl_count[s]=0;for(c[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)m<(s=c[2*c[2*(n=e.heap[r])+1]+1]+1)&&(s=m,g++),c[2*n+1]=s,u<n||(e.bl_count[s]++,a=0,p<=n&&(a=f[n-p]),o=c[2*n],e.opt_len+=o*(s+a),d&&(e.static_len+=o*(h[2*n+1]+a)));if(0!==g){do{for(s=m-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[m]--,g-=2}while(0<g);for(s=m;0!==s;s--)for(n=e.bl_count[s];0!==n;)u<(i=e.heap[--r])||(c[2*i+1]!==s&&(e.opt_len+=(s-c[2*i+1])*c[2*i],c[2*i+1]=s),n--)}}(e,t),P(s,u,e.bl_count)}function N(e,t,r){var n,i,s=-1,a=t[1],o=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++o<l&&i===a||(o<c?e.bl_tree[2*i]+=o:0!==i?(i!==s&&e.bl_tree[2*i]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=i,c=(o=0)===a?(l=138,3):i===a?(l=6,3):(l=7,4))}function B(e,t,r){var n,i,s=-1,a=t[1],o=0,l=7,c=4;for(0===a&&(l=138,c=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++o<l&&i===a)){if(o<c)for(;M(e,i,e.bl_tree),0!=--o;);else 0!==i?(i!==s&&(M(e,i,e.bl_tree),o--),M(e,16,e.bl_tree),A(e,o-3,2)):o<=10?(M(e,17,e.bl_tree),A(e,o-3,3)):(M(e,18,e.bl_tree),A(e,o-11,7));s=i,c=(o=0)===a?(l=138,3):i===a?(l=6,3):(l=7,4)}}i(x);var z=!1;function F(e,t,r,i){A(e,0+(i?1:0),3),function(e,t,r){D(e),E(e,r),E(e,~r),n.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r)}r._tr_init=function(e){z||(function(){var e,t,r,n,i,s=new Array(16);for(n=r=0;n<28;n++)for(v[n]=r,e=0;e<1<<c[n];e++)g[r++]=n;for(g[r-1]=n,n=i=0;n<16;n++)for(x[n]=i,e=0;e<1<<u[n];e++)m[i++]=n;for(i>>=7;n<o;n++)for(x[n]=i<<7,e=0;e<1<<u[n]-7;e++)m[256+i++]=n;for(t=0;t<=l;t++)s[t]=0;for(e=0;e<=143;)f[2*e+1]=8,e++,s[8]++;for(;e<=255;)f[2*e+1]=9,e++,s[9]++;for(;e<=279;)f[2*e+1]=7,e++,s[7]++;for(;e<=287;)f[2*e+1]=8,e++,s[8]++;for(P(f,287,s),e=0;e<o;e++)p[2*e+1]=5,p[2*e]=T(e,5);y=new S(f,c,257,a,l),b=new S(p,u,0,o,l),w=new S(new Array(0),h,0,19,7)}(),z=!0),e.l_desc=new _(e.dyn_ltree,y),e.d_desc=new _(e.dyn_dtree,b),e.bl_desc=new _(e.bl_tree,w),e.bi_buf=0,e.bi_valid=0,k(e)},r._tr_stored_block=F,r._tr_flush_block=function(e,t,r,n){var i,a,o=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<s;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),L(e,e.l_desc),L(e,e.d_desc),o=function(e){var t;for(N(e,e.dyn_ltree,e.l_desc.max_code),N(e,e.dyn_dtree,e.d_desc.max_code),L(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*d[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=i&&(i=a)):i=a=r+5,r+4<=i&&-1!==t?F(e,t,r,n):4===e.strategy||a===i?(A(e,2+(n?1:0),3),R(e,f,p)):(A(e,4+(n?1:0),3),function(e,t,r,n){var i;for(A(e,t-257,5),A(e,r-1,5),A(e,n-4,4),i=0;i<n;i++)A(e,e.bl_tree[2*d[i]+1],3);B(e,e.dyn_ltree,t-1),B(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),R(e,e.dyn_ltree,e.dyn_dtree)),k(e),n&&D(e)},r._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(g[r]+s+1)]++,e.dyn_dtree[2*C(t)]++),e.last_lit===e.lit_bufsize-1},r._tr_align=function(e){A(e,2,3),M(e,256,f),function(e){16===e.bi_valid?(E(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,r){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,n){(function(e){!function(e){if(!e.setImmediate){var t,n,i,s,a=1,o={},l=!1,c=e.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(e);u=u&&u.setTimeout?u:e,t="[object process]"==={}.toString.call(e.process)?function(e){r.nextTick((function(){d(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?(s="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",f,!1):e.attachEvent("onmessage",f),function(t){e.postMessage(s+t,"*")}):e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){d(e.data)},function(e){i.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(n=c.documentElement,function(e){var t=c.createElement("script");t.onreadystatechange=function(){d(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):function(e){setTimeout(d,0,e)},u.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var r=new Array(arguments.length-1),n=0;n<r.length;n++)r[n]=arguments[n+1];var i={callback:e,args:r};return o[a]=i,t(a),a++},u.clearImmediate=h}function h(e){delete o[e]}function d(e){if(l)setTimeout(d,0,e);else{var t=o[e];if(t){l=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{h(e),l=!1}}}}function f(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(s)&&d(+t.data.slice(s.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)}))}).call(this)}).call(this,e("_process"),"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],e("timers").setImmediate)},{_process:467,buffer:220,timers:523}],442:[function(e,t,n){(function(e){(function(){"use strict";var r=/[\\^$.*+?()[\]{}|]/g,n=RegExp(r.source),i="object"==typeof e&&e&&e.Object===Object&&e,s="object"==typeof self&&self&&self.Object===Object&&self,a=i||s||Function("return this")(),o=Object.prototype.toString,l=a.Symbol,c=l?l.prototype:void 0,u=c?c.toString:void 0;function h(e){if("string"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==o.call(e)}(e))return u?u.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}t.exports=function(e){var t;return(e=null==(t=e)?"":h(t))&&n.test(e)?e.replace(r,"\\$&"):e}}).call(this)}).call(this,"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],443:[function(e,t,n){(function(e){(function(){"use strict";var r="[object Arguments]",i="[object Map]",s="[object Object]",a="[object Set]",o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,l=/^\w*$/,c=/^\./,u=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,h=/\\(\\)?/g,d=/^\[object .+?Constructor\]$/,f=/^(?:0|[1-9]\d*)$/,p={};p["[object Float32Array]"]=p["[object Float64Array]"]=p["[object Int8Array]"]=p["[object Int16Array]"]=p["[object Int32Array]"]=p["[object Uint8Array]"]=p["[object Uint8ClampedArray]"]=p["[object Uint16Array]"]=p["[object Uint32Array]"]=!0,p[r]=p["[object Array]"]=p["[object ArrayBuffer]"]=p["[object Boolean]"]=p["[object DataView]"]=p["[object Date]"]=p["[object Error]"]=p["[object Function]"]=p[i]=p["[object Number]"]=p[s]=p["[object RegExp]"]=p[a]=p["[object String]"]=p["[object WeakMap]"]=!1;var m="object"==typeof e&&e&&e.Object===Object&&e,g="object"==typeof self&&self&&self.Object===Object&&self,v=m||g||Function("return this")(),y="object"==typeof n&&n&&!n.nodeType&&n,b=y&&"object"==typeof t&&t&&!t.nodeType&&t,w=b&&b.exports===y&&m.process,x=function(){try{return w&&w.binding("util")}catch(e){}}(),S=x&&x.isTypedArray;function _(e,t,r,n){for(var i=-1,s=e?e.length:0;++i<s;){var a=e[i];t(n,a,r(a),e)}return n}function C(e,t){for(var r=-1,n=e?e.length:0;++r<n;)if(t(e[r],r,e))return!0;return!1}function E(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function A(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function M(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var T,P,k,D=Array.prototype,I=Function.prototype,O=Object.prototype,R=v["__core-js_shared__"],L=(T=/[^.]+$/.exec(R&&R.keys&&R.keys.IE_PROTO||""))?"Symbol(src)_1."+T:"",N=I.toString,B=O.hasOwnProperty,z=O.toString,F=RegExp("^"+N.call(B).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),j=v.Symbol,U=v.Uint8Array,V=O.propertyIsEnumerable,H=D.splice,W=(P=Object.keys,k=Object,function(e){return P(k(e))}),G=Ae(v,"DataView"),q=Ae(v,"Map"),X=Ae(v,"Promise"),Y=Ae(v,"Set"),K=Ae(v,"WeakMap"),Q=Ae(Object,"create"),Z=Re(G),J=Re(q),$=Re(X),ee=Re(Y),te=Re(K),re=j?j.prototype:void 0,ne=re?re.valueOf:void 0,ie=re?re.toString:void 0;function se(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ae(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function oe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function le(e){var t=-1,r=e?e.length:0;for(this.__data__=new oe;++t<r;)this.add(e[t])}function ce(e){this.__data__=new ae(e)}function ue(e,t){var r=Ue(e)||je(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,i=!!n;for(var s in e)!t&&!B.call(e,s)||i&&("length"==s||Te(s,n))||r.push(s);return r}function he(e,t){for(var r=e.length;r--;)if(Fe(e[r][0],t))return r;return-1}function de(e,t,r,n){return me(e,(function(e,i,s){t(n,e,r(e),s)})),n}se.prototype.clear=function(){this.__data__=Q?Q(null):{}},se.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},se.prototype.get=function(e){var t=this.__data__;if(Q){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return B.call(t,e)?t[e]:void 0},se.prototype.has=function(e){var t=this.__data__;return Q?void 0!==t[e]:B.call(t,e)},se.prototype.set=function(e,t){return this.__data__[e]=Q&&void 0===t?"__lodash_hash_undefined__":t,this},ae.prototype.clear=function(){this.__data__=[]},ae.prototype.delete=function(e){var t=this.__data__,r=he(t,e);return!(r<0)&&(r==t.length-1?t.pop():H.call(t,r,1),!0)},ae.prototype.get=function(e){var t=this.__data__,r=he(t,e);return r<0?void 0:t[r][1]},ae.prototype.has=function(e){return he(this.__data__,e)>-1},ae.prototype.set=function(e,t){var r=this.__data__,n=he(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},oe.prototype.clear=function(){this.__data__={hash:new se,map:new(q||ae),string:new se}},oe.prototype.delete=function(e){return Ee(this,e).delete(e)},oe.prototype.get=function(e){return Ee(this,e).get(e)},oe.prototype.has=function(e){return Ee(this,e).has(e)},oe.prototype.set=function(e,t){return Ee(this,e).set(e,t),this},le.prototype.add=le.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},le.prototype.has=function(e){return this.__data__.has(e)},ce.prototype.clear=function(){this.__data__=new ae},ce.prototype.delete=function(e){return this.__data__.delete(e)},ce.prototype.get=function(e){return this.__data__.get(e)},ce.prototype.has=function(e){return this.__data__.has(e)},ce.prototype.set=function(e,t){var r=this.__data__;if(r instanceof ae){var n=r.__data__;if(!q||n.length<199)return n.push([e,t]),this;r=this.__data__=new oe(n)}return r.set(e,t),this};var fe,pe,me=(fe=function(e,t){return e&&ge(e,t,Ke)},function(e,t){if(null==e)return e;if(!Ve(e))return fe(e,t);for(var r=e.length,n=pe?r:-1,i=Object(e);(pe?n--:++n<r)&&!1!==t(i[n],n,i););return e}),ge=function(e){return function(t,r,n){for(var i=-1,s=Object(t),a=n(t),o=a.length;o--;){var l=a[e?o:++i];if(!1===r(s[l],l,s))break}return t}}();function ve(e,t){for(var r=0,n=(t=Pe(t,e)?[t]:_e(t)).length;null!=e&&r<n;)e=e[Oe(t[r++])];return r&&r==n?e:void 0}function ye(e,t){return null!=e&&t in Object(e)}function be(e,t,n,o,l){return e===t||(null==e||null==t||!Ge(e)&&!qe(t)?e!=e&&t!=t:function(e,t,n,o,l,c){var u=Ue(e),h=Ue(t),d="[object Array]",f="[object Array]";u||(d=(d=Me(e))==r?s:d),h||(f=(f=Me(t))==r?s:f);var p=d==s&&!E(e),m=f==s&&!E(t),g=d==f;if(g&&!p)return c||(c=new ce),u||Ye(e)?Ce(e,t,n,o,l,c):function(e,t,r,n,s,o,l){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!n(new U(e),new U(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Fe(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case i:var c=A;case a:var u=2&o;if(c||(c=M),e.size!=t.size&&!u)return!1;var h=l.get(e);if(h)return h==t;o|=1,l.set(e,t);var d=Ce(c(e),c(t),n,s,o,l);return l.delete(e),d;case"[object Symbol]":if(ne)return ne.call(e)==ne.call(t)}return!1}(e,t,d,n,o,l,c);if(!(2&l)){var v=p&&B.call(e,"__wrapped__"),y=m&&B.call(t,"__wrapped__");if(v||y){var b=v?e.value():e,w=y?t.value():t;return c||(c=new ce),n(b,w,o,l,c)}}return!!g&&(c||(c=new ce),function(e,t,r,n,i,s){var a=2&i,o=Ke(e),l=o.length;if(l!=Ke(t).length&&!a)return!1;for(var c=l;c--;){var u=o[c];if(!(a?u in t:B.call(t,u)))return!1}var h=s.get(e);if(h&&s.get(t))return h==t;var d=!0;s.set(e,t),s.set(t,e);for(var f=a;++c<l;){var p=e[u=o[c]],m=t[u];if(n)var g=a?n(m,p,u,t,e,s):n(p,m,u,e,t,s);if(!(void 0===g?p===m||r(p,m,n,i,s):g)){d=!1;break}f||(f="constructor"==u)}if(d&&!f){var v=e.constructor,y=t.constructor;v==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y||(d=!1)}return s.delete(e),s.delete(t),d}(e,t,n,o,l,c))}(e,t,be,n,o,l))}function we(e){return!(!Ge(e)||function(e){return!!L&&L in e}(e))&&(He(e)||E(e)?F:d).test(Re(e))}function xe(e){return"function"==typeof e?e:null==e?Qe:"object"==typeof e?Ue(e)?function(e,t){return Pe(e)&&ke(t)?De(Oe(e),t):function(r){var n=function(e,t,r){var n=null==e?void 0:ve(e,t);return void 0===n?r:n}(r,e);return void 0===n&&n===t?function(e,t){return null!=e&&function(e,t,r){for(var n,i=-1,s=(t=Pe(t,e)?[t]:_e(t)).length;++i<s;){var a=Oe(t[i]);if(!(n=null!=e&&r(e,a)))break;e=e[a]}return n||!!(s=e?e.length:0)&&We(s)&&Te(a,s)&&(Ue(e)||je(e))}(e,t,ye)}(r,e):be(t,n,void 0,3)}}(e[0],e[1]):function(e){var t=function(e){for(var t=Ke(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,ke(i)]}return t}(e);return 1==t.length&&t[0][2]?De(t[0][0],t[0][1]):function(r){return r===e||function(e,t,r,n){var i=r.length,s=i,a=!n;if(null==e)return!s;for(e=Object(e);i--;){var o=r[i];if(a&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++i<s;){var l=(o=r[i])[0],c=e[l],u=o[1];if(a&&o[2]){if(void 0===c&&!(l in e))return!1}else{var h=new ce;if(n)var d=n(c,u,l,e,t,h);if(!(void 0===d?be(u,c,n,3,h):d))return!1}}return!0}(r,e,t)}}(e):Pe(t=e)?(r=Oe(t),function(e){return null==e?void 0:e[r]}):function(e){return function(t){return ve(t,e)}}(t);var t,r}function Se(e){if(r=(t=e)&&t.constructor,t!==("function"==typeof r&&r.prototype||O))return W(e);var t,r,n=[];for(var i in Object(e))B.call(e,i)&&"constructor"!=i&&n.push(i);return n}function _e(e){return Ue(e)?e:Ie(e)}function Ce(e,t,r,n,i,s){var a=2&i,o=e.length,l=t.length;if(o!=l&&!(a&&l>o))return!1;var c=s.get(e);if(c&&s.get(t))return c==t;var u=-1,h=!0,d=1&i?new le:void 0;for(s.set(e,t),s.set(t,e);++u<o;){var f=e[u],p=t[u];if(n)var m=a?n(p,f,u,t,e,s):n(f,p,u,e,t,s);if(void 0!==m){if(m)continue;h=!1;break}if(d){if(!C(t,(function(e,t){if(!d.has(t)&&(f===e||r(f,e,n,i,s)))return d.add(t)}))){h=!1;break}}else if(f!==p&&!r(f,p,n,i,s)){h=!1;break}}return s.delete(e),s.delete(t),h}function Ee(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function Ae(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return we(r)?r:void 0}var Me=function(e){return z.call(e)};function Te(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||f.test(e))&&e>-1&&e%1==0&&e<t}function Pe(e,t){if(Ue(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Xe(e))||l.test(e)||!o.test(e)||null!=t&&e in Object(t)}function ke(e){return e==e&&!Ge(e)}function De(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}}(G&&"[object DataView]"!=Me(new G(new ArrayBuffer(1)))||q&&Me(new q)!=i||X&&"[object Promise]"!=Me(X.resolve())||Y&&Me(new Y)!=a||K&&"[object WeakMap]"!=Me(new K))&&(Me=function(e){var t=z.call(e),r=t==s?e.constructor:void 0,n=r?Re(r):void 0;if(n)switch(n){case Z:return"[object DataView]";case J:return i;case $:return"[object Promise]";case ee:return a;case te:return"[object WeakMap]"}return t});var Ie=ze((function(e){var t;e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(Xe(e))return ie?ie.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(t);var r=[];return c.test(e)&&r.push(""),e.replace(u,(function(e,t,n,i){r.push(n?i.replace(h,"$1"):t||e)})),r}));function Oe(e){if("string"==typeof e||Xe(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Re(e){if(null!=e){try{return N.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var Le,Ne,Be=(Le=function(e,t,r){B.call(e,r)?e[r].push(t):e[r]=[t]},function(e,t){var r=Ue(e)?_:de,n=Ne?Ne():{};return r(e,Le,xe(t),n)});function ze(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var a=e.apply(this,n);return r.cache=s.set(i,a),a};return r.cache=new(ze.Cache||oe),r}function Fe(e,t){return e===t||e!=e&&t!=t}function je(e){return function(e){return qe(e)&&Ve(e)}(e)&&B.call(e,"callee")&&(!V.call(e,"callee")||z.call(e)==r)}ze.Cache=oe;var Ue=Array.isArray;function Ve(e){return null!=e&&We(e.length)&&!He(e)}function He(e){var t=Ge(e)?z.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}function We(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Ge(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function qe(e){return!!e&&"object"==typeof e}function Xe(e){return"symbol"==typeof e||qe(e)&&"[object Symbol]"==z.call(e)}var Ye=S?function(e){return function(t){return e(t)}}(S):function(e){return qe(e)&&We(e.length)&&!!p[z.call(e)]};function Ke(e){return Ve(e)?ue(e):Se(e)}function Qe(e){return e}t.exports=Be}).call(this)}).call(this,"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],444:[function(e,t,r){"use strict";var n=Object.prototype.toString;t.exports=function(e){return!0===e||!1===e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Boolean]"==n.call(e)}},{}],445:[function(e,t,n){(function(e){(function(){"use strict";var r="[object Arguments]",i="[object Map]",s="[object Object]",a="[object Set]",o=/^\[object .+?Constructor\]$/,l=/^(?:0|[1-9]\d*)$/,c={};c["[object Float32Array]"]=c["[object Float64Array]"]=c["[object Int8Array]"]=c["[object Int16Array]"]=c["[object Int32Array]"]=c["[object Uint8Array]"]=c["[object Uint8ClampedArray]"]=c["[object Uint16Array]"]=c["[object Uint32Array]"]=!0,c[r]=c["[object Array]"]=c["[object ArrayBuffer]"]=c["[object Boolean]"]=c["[object DataView]"]=c["[object Date]"]=c["[object Error]"]=c["[object Function]"]=c[i]=c["[object Number]"]=c[s]=c["[object RegExp]"]=c[a]=c["[object String]"]=c["[object WeakMap]"]=!1;var u="object"==typeof e&&e&&e.Object===Object&&e,h="object"==typeof self&&self&&self.Object===Object&&self,d=u||h||Function("return this")(),f="object"==typeof n&&n&&!n.nodeType&&n,p=f&&"object"==typeof t&&t&&!t.nodeType&&t,m=p&&p.exports===f,g=m&&u.process,v=function(){try{return g&&g.binding&&g.binding("util")}catch(e){}}(),y=v&&v.isTypedArray;function b(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function w(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function x(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var S,_,C,E=Array.prototype,A=Function.prototype,M=Object.prototype,T=d["__core-js_shared__"],P=A.toString,k=M.hasOwnProperty,D=(S=/[^.]+$/.exec(T&&T.keys&&T.keys.IE_PROTO||""))?"Symbol(src)_1."+S:"",I=M.toString,O=RegExp("^"+P.call(k).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),R=m?d.Buffer:void 0,L=d.Symbol,N=d.Uint8Array,B=M.propertyIsEnumerable,z=E.splice,F=L?L.toStringTag:void 0,j=Object.getOwnPropertySymbols,U=R?R.isBuffer:void 0,V=(_=Object.keys,C=Object,function(e){return _(C(e))}),H=ve(d,"DataView"),W=ve(d,"Map"),G=ve(d,"Promise"),q=ve(d,"Set"),X=ve(d,"WeakMap"),Y=ve(Object,"create"),K=xe(H),Q=xe(W),Z=xe(G),J=xe(q),$=xe(X),ee=L?L.prototype:void 0,te=ee?ee.valueOf:void 0;function re(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ne(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ie(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function se(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new ie;++t<r;)this.add(e[t])}function ae(e){var t=this.__data__=new ne(e);this.size=t.size}function oe(e,t){var r=Ce(e),n=!r&&_e(e),i=!r&&!n&&Ee(e),s=!r&&!n&&!i&&ke(e),a=r||n||i||s,o=a?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],l=o.length;for(var c in e)!t&&!k.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||we(c,l))||o.push(c);return o}function le(e,t){for(var r=e.length;r--;)if(Se(e[r][0],t))return r;return-1}function ce(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":F&&F in Object(e)?function(e){var t=k.call(e,F),r=e[F];try{e[F]=void 0;var n=!0}catch(e){}var i=I.call(e);return n&&(t?e[F]=r:delete e[F]),i}(e):function(e){return I.call(e)}(e)}function ue(e){return Pe(e)&&ce(e)==r}function he(e,t,n,o,l){return e===t||(null==e||null==t||!Pe(e)&&!Pe(t)?e!=e&&t!=t:function(e,t,n,o,l,c){var u=Ce(e),h=Ce(t),d=u?"[object Array]":be(e),f=h?"[object Array]":be(t),p=(d=d==r?s:d)==s,m=(f=f==r?s:f)==s,g=d==f;if(g&&Ee(e)){if(!Ee(t))return!1;u=!0,p=!1}if(g&&!p)return c||(c=new ae),u||ke(e)?pe(e,t,n,o,l,c):function(e,t,r,n,s,o,l){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new N(e),new N(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Se(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case i:var c=w;case a:var u=1&n;if(c||(c=x),e.size!=t.size&&!u)return!1;var h=l.get(e);if(h)return h==t;n|=2,l.set(e,t);var d=pe(c(e),c(t),n,s,o,l);return l.delete(e),d;case"[object Symbol]":if(te)return te.call(e)==te.call(t)}return!1}(e,t,d,n,o,l,c);if(!(1&n)){var v=p&&k.call(e,"__wrapped__"),y=m&&k.call(t,"__wrapped__");if(v||y){var b=v?e.value():e,S=y?t.value():t;return c||(c=new ae),l(b,S,n,o,c)}}return!!g&&(c||(c=new ae),function(e,t,r,n,i,s){var a=1&r,o=me(e),l=o.length;if(l!=me(t).length&&!a)return!1;for(var c=l;c--;){var u=o[c];if(!(a?u in t:k.call(t,u)))return!1}var h=s.get(e);if(h&&s.get(t))return h==t;var d=!0;s.set(e,t),s.set(t,e);for(var f=a;++c<l;){var p=e[u=o[c]],m=t[u];if(n)var g=a?n(m,p,u,t,e,s):n(p,m,u,e,t,s);if(!(void 0===g?p===m||i(p,m,r,n,s):g)){d=!1;break}f||(f="constructor"==u)}if(d&&!f){var v=e.constructor,y=t.constructor;v==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y||(d=!1)}return s.delete(e),s.delete(t),d}(e,t,n,o,l,c))}(e,t,n,o,he,l))}function de(e){return!(!Te(e)||function(e){return!!D&&D in e}(e))&&(Ae(e)?O:o).test(xe(e))}function fe(e){if(r=(t=e)&&t.constructor,t!==("function"==typeof r&&r.prototype||M))return V(e);var t,r,n=[];for(var i in Object(e))k.call(e,i)&&"constructor"!=i&&n.push(i);return n}function pe(e,t,r,n,i,s){var a=1&r,o=e.length,l=t.length;if(o!=l&&!(a&&l>o))return!1;var c=s.get(e);if(c&&s.get(t))return c==t;var u=-1,h=!0,d=2&r?new se:void 0;for(s.set(e,t),s.set(t,e);++u<o;){var f=e[u],p=t[u];if(n)var m=a?n(p,f,u,t,e,s):n(f,p,u,e,t,s);if(void 0!==m){if(m)continue;h=!1;break}if(d){if(!b(t,(function(e,t){if(a=t,!d.has(a)&&(f===e||i(f,e,r,n,s)))return d.push(t);var a}))){h=!1;break}}else if(f!==p&&!i(f,p,r,n,s)){h=!1;break}}return s.delete(e),s.delete(t),h}function me(e){return function(e,t,r){var n=t(e);return Ce(e)?n:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(n,r(e))}(e,De,ye)}function ge(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function ve(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return de(r)?r:void 0}re.prototype.clear=function(){this.__data__=Y?Y(null):{},this.size=0},re.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},re.prototype.get=function(e){var t=this.__data__;if(Y){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return k.call(t,e)?t[e]:void 0},re.prototype.has=function(e){var t=this.__data__;return Y?void 0!==t[e]:k.call(t,e)},re.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Y&&void 0===t?"__lodash_hash_undefined__":t,this},ne.prototype.clear=function(){this.__data__=[],this.size=0},ne.prototype.delete=function(e){var t=this.__data__,r=le(t,e);return!(r<0)&&(r==t.length-1?t.pop():z.call(t,r,1),--this.size,!0)},ne.prototype.get=function(e){var t=this.__data__,r=le(t,e);return r<0?void 0:t[r][1]},ne.prototype.has=function(e){return le(this.__data__,e)>-1},ne.prototype.set=function(e,t){var r=this.__data__,n=le(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},ie.prototype.clear=function(){this.size=0,this.__data__={hash:new re,map:new(W||ne),string:new re}},ie.prototype.delete=function(e){var t=ge(this,e).delete(e);return this.size-=t?1:0,t},ie.prototype.get=function(e){return ge(this,e).get(e)},ie.prototype.has=function(e){return ge(this,e).has(e)},ie.prototype.set=function(e,t){var r=ge(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},se.prototype.add=se.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},se.prototype.has=function(e){return this.__data__.has(e)},ae.prototype.clear=function(){this.__data__=new ne,this.size=0},ae.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},ae.prototype.get=function(e){return this.__data__.get(e)},ae.prototype.has=function(e){return this.__data__.has(e)},ae.prototype.set=function(e,t){var r=this.__data__;if(r instanceof ne){var n=r.__data__;if(!W||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new ie(n)}return r.set(e,t),this.size=r.size,this};var ye=j?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,s=[];++r<n;){var a=e[r];t(a,r,e)&&(s[i++]=a)}return s}(j(e),(function(t){return B.call(e,t)})))}:function(){return[]},be=ce;function we(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||l.test(e))&&e>-1&&e%1==0&&e<t}function xe(e){if(null!=e){try{return P.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Se(e,t){return e===t||e!=e&&t!=t}(H&&"[object DataView]"!=be(new H(new ArrayBuffer(1)))||W&&be(new W)!=i||G&&"[object Promise]"!=be(G.resolve())||q&&be(new q)!=a||X&&"[object WeakMap]"!=be(new X))&&(be=function(e){var t=ce(e),r=t==s?e.constructor:void 0,n=r?xe(r):"";if(n)switch(n){case K:return"[object DataView]";case Q:return i;case Z:return"[object Promise]";case J:return a;case $:return"[object WeakMap]"}return t});var _e=ue(function(){return arguments}())?ue:function(e){return Pe(e)&&k.call(e,"callee")&&!B.call(e,"callee")},Ce=Array.isArray,Ee=U||function(){return!1};function Ae(e){if(!Te(e))return!1;var t=ce(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Me(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Te(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Pe(e){return null!=e&&"object"==typeof e}var ke=y?function(e){return function(t){return e(t)}}(y):function(e){return Pe(e)&&Me(e.length)&&!!c[ce(e)]};function De(e){return null!=(t=e)&&Me(t.length)&&!Ae(t)?oe(e):fe(e);var t}t.exports=function(e,t){return he(e,t)}}).call(this)}).call(this,"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],446:[function(e,t,n){(function(e){(function(){"use strict";var r="object"==typeof e&&e&&e.Object===Object&&e,n="object"==typeof self&&self&&self.Object===Object&&self,i=r||n||Function("return this")(),s=Object.prototype,a=s.hasOwnProperty,o=s.toString,l=i.Symbol,c=l?l.toStringTag:void 0;function u(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":c&&c in Object(e)?function(e){var t=a.call(e,c),r=e[c];try{e[c]=void 0;var n=!0}catch(e){}var i=o.call(e);return n&&(t?e[c]=r:delete e[c]),i}(e):function(e){return o.call(e)}(e)}t.exports=function(e){if(!function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}(e))return!1;var t=u(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}}).call(this)}).call(this,"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],447:[function(e,t,r){"use strict";t.exports=function(e){return null==e}},{}],448:[function(e,t,r){"use strict";t.exports=function(e){return void 0===e}},{}],449:[function(e,t,n){(function(e){(function(){"use strict";var r=/^\[object .+?Constructor\]$/,n="object"==typeof e&&e&&e.Object===Object&&e,i="object"==typeof self&&self&&self.Object===Object&&self,s=n||i||Function("return this")();function a(e,t){return!(!e||!e.length)&&function(e,t,r){if(t!=t)return function(e,t,r,n){for(var i=e.length,s=r+(n?1:-1);n?s--:++s<i;)if(t(e[s],s,e))return s;return-1}(e,l,r);for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(e,t,0)>-1}function o(e,t,r){for(var n=-1,i=e?e.length:0;++n<i;)if(r(t,e[n]))return!0;return!1}function l(e){return e!=e}function c(e,t){return e.has(t)}function u(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var h,d=Array.prototype,f=Function.prototype,p=Object.prototype,m=s["__core-js_shared__"],g=(h=/[^.]+$/.exec(m&&m.keys&&m.keys.IE_PROTO||""))?"Symbol(src)_1."+h:"",v=f.toString,y=p.hasOwnProperty,b=p.toString,w=RegExp("^"+v.call(y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),x=d.splice,S=O(s,"Map"),_=O(s,"Set"),C=O(Object,"create");function E(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function A(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function M(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function T(e){var t=-1,r=e?e.length:0;for(this.__data__=new M;++t<r;)this.add(e[t])}function P(e,t){for(var r,n,i=e.length;i--;)if((r=e[i][0])===(n=t)||r!=r&&n!=n)return i;return-1}function k(e){return!(!R(e)||(t=e,g&&g in t))&&(function(e){var t=R(e)?b.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?w:r).test(function(e){if(null!=e){try{return v.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}E.prototype.clear=function(){this.__data__=C?C(null):{}},E.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},E.prototype.get=function(e){var t=this.__data__;if(C){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return y.call(t,e)?t[e]:void 0},E.prototype.has=function(e){var t=this.__data__;return C?void 0!==t[e]:y.call(t,e)},E.prototype.set=function(e,t){return this.__data__[e]=C&&void 0===t?"__lodash_hash_undefined__":t,this},A.prototype.clear=function(){this.__data__=[]},A.prototype.delete=function(e){var t=this.__data__,r=P(t,e);return!(r<0)&&(r==t.length-1?t.pop():x.call(t,r,1),!0)},A.prototype.get=function(e){var t=this.__data__,r=P(t,e);return r<0?void 0:t[r][1]},A.prototype.has=function(e){return P(this.__data__,e)>-1},A.prototype.set=function(e,t){var r=this.__data__,n=P(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},M.prototype.clear=function(){this.__data__={hash:new E,map:new(S||A),string:new E}},M.prototype.delete=function(e){return I(this,e).delete(e)},M.prototype.get=function(e){return I(this,e).get(e)},M.prototype.has=function(e){return I(this,e).has(e)},M.prototype.set=function(e,t){return I(this,e).set(e,t),this},T.prototype.add=T.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},T.prototype.has=function(e){return this.__data__.has(e)};var D=_&&1/u(new _([,-0]))[1]==1/0?function(e){return new _(e)}:function(){};function I(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function O(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return k(r)?r:void 0}function R(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}t.exports=function(e){return e&&e.length?function(e,t,r){var n=-1,i=a,s=e.length,l=!0,h=[],d=h;if(r)l=!1,i=o;else if(s>=200){var f=t?null:D(e);if(f)return u(f);l=!1,i=c,d=new T}else d=t?[]:h;e:for(;++n<s;){var p=e[n],m=t?t(p):p;if(p=r||0!==p?p:0,l&&m==m){for(var g=d.length;g--;)if(d[g]===m)continue e;t&&d.push(m),h.push(p)}else i(d,m,r)||(d!==h&&d.push(m),h.push(p))}return h}(e):[]}}).call(this)}).call(this,"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],450:[function(e,t,r){"use strict";var n=e("inherits"),i=e("hash-base"),s=e("safe-buffer").Buffer,a=new Array(16);function o(){i.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function l(e,t){return e<<t|e>>>32-t}function c(e,t,r,n,i,s,a){return l(e+(t&r|~t&n)+i+s|0,a)+t|0}function u(e,t,r,n,i,s,a){return l(e+(t&n|r&~n)+i+s|0,a)+t|0}function h(e,t,r,n,i,s,a){return l(e+(t^r^n)+i+s|0,a)+t|0}function d(e,t,r,n,i,s,a){return l(e+(r^(t|~n))+i+s|0,a)+t|0}n(o,i),o.prototype._update=function(){for(var e=a,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);var r=this._a,n=this._b,i=this._c,s=this._d;r=c(r,n,i,s,e[0],3614090360,7),s=c(s,r,n,i,e[1],3905402710,12),i=c(i,s,r,n,e[2],606105819,17),n=c(n,i,s,r,e[3],3250441966,22),r=c(r,n,i,s,e[4],4118548399,7),s=c(s,r,n,i,e[5],1200080426,12),i=c(i,s,r,n,e[6],2821735955,17),n=c(n,i,s,r,e[7],4249261313,22),r=c(r,n,i,s,e[8],1770035416,7),s=c(s,r,n,i,e[9],2336552879,12),i=c(i,s,r,n,e[10],4294925233,17),n=c(n,i,s,r,e[11],2304563134,22),r=c(r,n,i,s,e[12],1804603682,7),s=c(s,r,n,i,e[13],4254626195,12),i=c(i,s,r,n,e[14],2792965006,17),r=u(r,n=c(n,i,s,r,e[15],1236535329,22),i,s,e[1],4129170786,5),s=u(s,r,n,i,e[6],3225465664,9),i=u(i,s,r,n,e[11],643717713,14),n=u(n,i,s,r,e[0],3921069994,20),r=u(r,n,i,s,e[5],3593408605,5),s=u(s,r,n,i,e[10],38016083,9),i=u(i,s,r,n,e[15],3634488961,14),n=u(n,i,s,r,e[4],3889429448,20),r=u(r,n,i,s,e[9],568446438,5),s=u(s,r,n,i,e[14],3275163606,9),i=u(i,s,r,n,e[3],4107603335,14),n=u(n,i,s,r,e[8],1163531501,20),r=u(r,n,i,s,e[13],2850285829,5),s=u(s,r,n,i,e[2],4243563512,9),i=u(i,s,r,n,e[7],1735328473,14),r=h(r,n=u(n,i,s,r,e[12],2368359562,20),i,s,e[5],4294588738,4),s=h(s,r,n,i,e[8],2272392833,11),i=h(i,s,r,n,e[11],1839030562,16),n=h(n,i,s,r,e[14],4259657740,23),r=h(r,n,i,s,e[1],2763975236,4),s=h(s,r,n,i,e[4],1272893353,11),i=h(i,s,r,n,e[7],4139469664,16),n=h(n,i,s,r,e[10],3200236656,23),r=h(r,n,i,s,e[13],681279174,4),s=h(s,r,n,i,e[0],3936430074,11),i=h(i,s,r,n,e[3],3572445317,16),n=h(n,i,s,r,e[6],76029189,23),r=h(r,n,i,s,e[9],3654602809,4),s=h(s,r,n,i,e[12],3873151461,11),i=h(i,s,r,n,e[15],530742520,16),r=d(r,n=h(n,i,s,r,e[2],3299628645,23),i,s,e[0],4096336452,6),s=d(s,r,n,i,e[7],1126891415,10),i=d(i,s,r,n,e[14],2878612391,15),n=d(n,i,s,r,e[5],4237533241,21),r=d(r,n,i,s,e[12],1700485571,6),s=d(s,r,n,i,e[3],2399980690,10),i=d(i,s,r,n,e[10],4293915773,15),n=d(n,i,s,r,e[1],2240044497,21),r=d(r,n,i,s,e[8],1873313359,6),s=d(s,r,n,i,e[15],4264355552,10),i=d(i,s,r,n,e[6],2734768916,15),n=d(n,i,s,r,e[13],1309151649,21),r=d(r,n,i,s,e[4],4149444226,6),s=d(s,r,n,i,e[11],3174756917,10),i=d(i,s,r,n,e[2],718787259,15),n=d(n,i,s,r,e[9],3951481745,21),this._a=this._a+r|0,this._b=this._b+n|0,this._c=this._c+i|0,this._d=this._d+s|0},o.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=s.allocUnsafe(16);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e},t.exports=o},{"hash-base":425,inherits:440,"safe-buffer":494}],451:[function(e,t,r){"use strict";var n=e("bn.js"),i=e("brorand");function s(e){this.rand=e||new i.Rand}t.exports=s,s.create=function(e){return new s(e)},s.prototype._randbelow=function(e){var t=e.bitLength(),r=Math.ceil(t/8);do{var i=new n(this.rand.generate(r))}while(i.cmp(e)>=0);return i},s.prototype._randrange=function(e,t){var r=t.sub(e);return e.add(this._randbelow(r))},s.prototype.test=function(e,t,r){var i=e.bitLength(),s=n.mont(e),a=new n(1).toRed(s);t||(t=Math.max(1,i/48|0));for(var o=e.subn(1),l=0;!o.testn(l);l++);for(var c=e.shrn(l),u=o.toRed(s);t>0;t--){var h=this._randrange(new n(2),o);r&&r(h);var d=h.toRed(s).redPow(c);if(0!==d.cmp(a)&&0!==d.cmp(u)){for(var f=1;f<l;f++){if(0===(d=d.redSqr()).cmp(a))return!1;if(0===d.cmp(u))break}if(f===l)return!1}}return!0},s.prototype.getDivisor=function(e,t){var r=e.bitLength(),i=n.mont(e),s=new n(1).toRed(i);t||(t=Math.max(1,r/48|0));for(var a=e.subn(1),o=0;!a.testn(o);o++);for(var l=e.shrn(o),c=a.toRed(i);t>0;t--){var u=this._randrange(new n(2),a),h=e.gcd(u);if(0!==h.cmpn(1))return h;var d=u.toRed(i).redPow(l);if(0!==d.cmp(s)&&0!==d.cmp(c)){for(var f=1;f<o;f++){if(0===(d=d.redSqr()).cmp(s))return d.fromRed().subn(1).gcd(e);if(0===d.cmp(c))break}if(f===o)return(d=d.redSqr()).fromRed().subn(1).gcd(e)}}return!1}},{"bn.js":452,brorand:187}],452:[function(e,t,r){arguments[4][184][0].apply(r,arguments)},{buffer:188,dup:184}],453:[function(e,t,r){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}t.exports=n,n.equal=function(e,t,r){if(e!=t)throw new Error(r||"Assertion failed: "+e+" != "+t)}},{}],454:[function(e,t,r){"use strict";var n=r;function i(e){return 1===e.length?"0"+e:e}function s(e){for(var t="",r=0;r<e.length;r++)t+=i(e[r].toString(16));return t}n.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"!=typeof e){for(var n=0;n<e.length;n++)r[n]=0|e[n];return r}if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),n=0;n<e.length;n+=2)r.push(parseInt(e[n]+e[n+1],16));else for(n=0;n<e.length;n++){var i=e.charCodeAt(n),s=i>>8,a=255&i;s?r.push(s,a):r.push(a)}return r},n.zero2=i,n.toHex=s,n.encode=function(e,t){return"hex"===t?s(e):e}},{}],455:[function(e,t,r){t.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],456:[function(e,t,r){"use strict";var n=e("asn1.js");r.certificate=e("./certificate");var i=n.define("RSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())}));r.RSAPrivateKey=i;var s=n.define("RSAPublicKey",(function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}));r.RSAPublicKey=s;var a=n.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(o),this.key("subjectPublicKey").bitstr())}));r.PublicKey=a;var o=n.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())})),l=n.define("PrivateKeyInfo",(function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(o),this.key("subjectPrivateKey").octstr())}));r.PrivateKey=l;var c=n.define("EncryptedPrivateKeyInfo",(function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())}));r.EncryptedPrivateKey=c;var u=n.define("DSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())}));r.DSAPrivateKey=u,r.DSAparam=n.define("DSAparam",(function(){this.int()}));var h=n.define("ECPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(d),this.key("publicKey").optional().explicit(1).bitstr())}));r.ECPrivateKey=h;var d=n.define("ECParameters",(function(){this.choice({namedCurve:this.objid()})}));r.signature=n.define("signature",(function(){this.seq().obj(this.key("r").int(),this.key("s").int())}))},{"./certificate":457,"asn1.js":170}],457:[function(e,t,r){"use strict";var n=e("asn1.js"),i=n.define("Time",(function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})})),s=n.define("AttributeTypeValue",(function(){this.seq().obj(this.key("type").objid(),this.key("value").any())})),a=n.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())})),o=n.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(a),this.key("subjectPublicKey").bitstr())})),l=n.define("RelativeDistinguishedName",(function(){this.setof(s)})),c=n.define("RDNSequence",(function(){this.seqof(l)})),u=n.define("Name",(function(){this.choice({rdnSequence:this.use(c)})})),h=n.define("Validity",(function(){this.seq().obj(this.key("notBefore").use(i),this.key("notAfter").use(i))})),d=n.define("Extension",(function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())})),f=n.define("TBSCertificate",(function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(a),this.key("issuer").use(u),this.key("validity").use(h),this.key("subject").use(u),this.key("subjectPublicKeyInfo").use(o),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(d).optional())})),p=n.define("X509Certificate",(function(){this.seq().obj(this.key("tbsCertificate").use(f),this.key("signatureAlgorithm").use(a),this.key("signatureValue").bitstr())}));t.exports=p},{"asn1.js":170}],458:[function(e,t,r){"use strict";var n=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,i=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,s=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,a=e("evp_bytestokey"),o=e("browserify-aes"),l=e("safe-buffer").Buffer;t.exports=function(e,t){var r,c=e.toString(),u=c.match(n);if(u){var h="aes"+u[1],d=l.from(u[2],"hex"),f=l.from(u[3].replace(/[\r\n]/g,""),"base64"),p=a(t,d.slice(0,8),parseInt(u[1],10)).key,m=[],g=o.createDecipheriv(h,p,d);m.push(g.update(f)),m.push(g.final()),r=l.concat(m)}else{var v=c.match(s);r=l.from(v[2].replace(/[\r\n]/g,""),"base64")}return{tag:c.match(i)[1],data:r}}},{"browserify-aes":191,evp_bytestokey:423,"safe-buffer":494}],459:[function(e,t,r){"use strict";var n=e("./asn1"),i=e("./aesid.json"),s=e("./fixProc"),a=e("browserify-aes"),o=e("pbkdf2"),l=e("safe-buffer").Buffer;function c(e){var t;"object"!=typeof e||l.isBuffer(e)||(t=e.passphrase,e=e.key),"string"==typeof e&&(e=l.from(e));var r,c,u=s(e,t),h=u.tag,d=u.data;switch(h){case"CERTIFICATE":c=n.certificate.decode(d,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(c||(c=n.PublicKey.decode(d,"der")),r=c.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return n.RSAPublicKey.decode(c.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return c.subjectPrivateKey=c.subjectPublicKey,{type:"ec",data:c};case"1.2.840.10040.4.1":return c.algorithm.params.pub_key=n.DSAparam.decode(c.subjectPublicKey.data,"der"),{type:"dsa",data:c.algorithm.params};default:throw new Error("unknown key id "+r)}case"ENCRYPTED PRIVATE KEY":d=function(e,t){var r=e.algorithm.decrypt.kde.kdeparams.salt,n=parseInt(e.algorithm.decrypt.kde.kdeparams.iters.toString(),10),s=i[e.algorithm.decrypt.cipher.algo.join(".")],c=e.algorithm.decrypt.cipher.iv,u=e.subjectPrivateKey,h=parseInt(s.split("-")[1],10)/8,d=o.pbkdf2Sync(t,r,n,h,"sha1"),f=a.createDecipheriv(s,d,c),p=[];return p.push(f.update(u)),p.push(f.final()),l.concat(p)}(d=n.EncryptedPrivateKey.decode(d,"der"),t);case"PRIVATE KEY":switch(r=(c=n.PrivateKey.decode(d,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return n.RSAPrivateKey.decode(c.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:c.algorithm.curve,privateKey:n.ECPrivateKey.decode(c.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return c.algorithm.params.priv_key=n.DSAparam.decode(c.subjectPrivateKey,"der"),{type:"dsa",params:c.algorithm.params};default:throw new Error("unknown key id "+r)}case"RSA PUBLIC KEY":return n.RSAPublicKey.decode(d,"der");case"RSA PRIVATE KEY":return n.RSAPrivateKey.decode(d,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:n.DSAPrivateKey.decode(d,"der")};case"EC PRIVATE KEY":return{curve:(d=n.ECPrivateKey.decode(d,"der")).parameters.value,privateKey:d.privateKey};default:throw new Error("unknown key type "+h)}}t.exports=c,c.signature=n.signature},{"./aesid.json":455,"./asn1":456,"./fixProc":458,"browserify-aes":191,pbkdf2:460,"safe-buffer":494}],460:[function(e,t,r){"use strict";r.pbkdf2=e("./lib/async"),r.pbkdf2Sync=e("./lib/sync")},{"./lib/async":461,"./lib/sync":464}],461:[function(e,t,n){(function(r){(function(){"use strict";var n,i,s=e("safe-buffer").Buffer,a=e("./precondition"),o=e("./default-encoding"),l=e("./sync"),c=e("./to-buffer"),u=r.crypto&&r.crypto.subtle,h={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},d=[];function f(){return i||(i=r.process&&r.process.nextTick?r.process.nextTick:r.queueMicrotask?r.queueMicrotask:r.setImmediate?r.setImmediate:r.setTimeout)}function p(e,t,r,n,i){return u.importKey("raw",e,{name:"PBKDF2"},!1,["deriveBits"]).then((function(e){return u.deriveBits({name:"PBKDF2",salt:t,iterations:r,hash:{name:i}},e,n<<3)})).then((function(e){return s.from(e)}))}t.exports=function(e,t,i,m,g,v){"function"==typeof g&&(v=g,g=void 0);var y=h[(g=g||"sha1").toLowerCase()];if(y&&"function"==typeof r.Promise){if(a(i,m),e=c(e,o,"Password"),t=c(t,o,"Salt"),"function"!=typeof v)throw new Error("No callback provided to pbkdf2");!function(e,t){e.then((function(e){f()((function(){t(null,e)}))}),(function(e){f()((function(){t(e)}))}))}(function(e){if(r.process&&!r.process.browser)return Promise.resolve(!1);if(!u||!u.importKey||!u.deriveBits)return Promise.resolve(!1);if(void 0!==d[e])return d[e];var t=p(n=n||s.alloc(8),n,10,128,e).then((function(){return!0})).catch((function(){return!1}));return d[e]=t,t}(y).then((function(r){return r?p(e,t,i,m,y):l(e,t,i,m,g)})),v)}else f()((function(){var r;try{r=l(e,t,i,m,g)}catch(e){return v(e)}v(null,r)}))}}).call(this)}).call(this,"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./default-encoding":462,"./precondition":463,"./sync":464,"./to-buffer":465,"safe-buffer":494}],462:[function(e,t,n){(function(e,r){(function(){"use strict";var n;n=r.process&&r.process.browser?"utf-8":r.process&&r.process.version?parseInt(e.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":"utf-8",t.exports=n}).call(this)}).call(this,e("_process"),"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:467}],463:[function(e,t,r){"use strict";var n=Math.pow(2,30)-1;t.exports=function(e,t){if("number"!=typeof e)throw new TypeError("Iterations not a number");if(e<0)throw new TypeError("Bad iterations");if("number"!=typeof t)throw new TypeError("Key length not a number");if(t<0||t>n||t!=t)throw new TypeError("Bad key length")}},{}],464:[function(e,t,r){"use strict";var n=e("create-hash/md5"),i=e("ripemd160"),s=e("sha.js"),a=e("safe-buffer").Buffer,o=e("./precondition"),l=e("./default-encoding"),c=e("./to-buffer"),u=a.alloc(128),h={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function d(e,t,r){var o=function(e){function t(t){return s(e).update(t).digest()}return"rmd160"===e||"ripemd160"===e?function(e){return(new i).update(e).digest()}:"md5"===e?n:t}(e),l="sha512"===e||"sha384"===e?128:64;t.length>l?t=o(t):t.length<l&&(t=a.concat([t,u],l));for(var c=a.allocUnsafe(l+h[e]),d=a.allocUnsafe(l+h[e]),f=0;f<l;f++)c[f]=54^t[f],d[f]=92^t[f];var p=a.allocUnsafe(l+r+4);c.copy(p,0,0,l),this.ipad1=p,this.ipad2=c,this.opad=d,this.alg=e,this.blocksize=l,this.hash=o,this.size=h[e]}d.prototype.run=function(e,t){return e.copy(t,this.blocksize),this.hash(t).copy(this.opad,this.blocksize),this.hash(this.opad)},t.exports=function(e,t,r,n,i){o(r,n);var s=new d(i=i||"sha1",e=c(e,l,"Password"),(t=c(t,l,"Salt")).length),u=a.allocUnsafe(n),f=a.allocUnsafe(t.length+4);t.copy(f,0,0,t.length);for(var p=0,m=h[i],g=Math.ceil(n/m),v=1;v<=g;v++){f.writeUInt32BE(v,t.length);for(var y=s.run(f,s.ipad1),b=y,w=1;w<r;w++){b=s.run(b,s.ipad2);for(var x=0;x<m;x++)y[x]^=b[x]}y.copy(u,p),p+=m}return u}},{"./default-encoding":462,"./precondition":463,"./to-buffer":465,"create-hash/md5":387,ripemd160:493,"safe-buffer":494,"sha.js":498}],465:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer;t.exports=function(e,t,r){if(n.isBuffer(e))return e;if("string"==typeof e)return n.from(e,t);if(ArrayBuffer.isView(e))return n.from(e.buffer);throw new TypeError(r+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":494}],466:[function(e,t,r){(function(e){(function(){"use strict";void 0===e||!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,r,n,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var s,a,o=arguments.length;switch(o){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick((function(){t.call(null,r)}));case 3:return e.nextTick((function(){t.call(null,r,n)}));case 4:return e.nextTick((function(){t.call(null,r,n,i)}));default:for(s=new Array(o-1),a=0;a<s.length;)s[a++]=arguments[a];return e.nextTick((function(){t.apply(null,s)}))}}}:t.exports=e}).call(this)}).call(this,e("_process"))},{_process:467}],467:[function(e,t,r){"use strict";var n,i,s=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function l(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var c,u=[],h=!1,d=-1;function f(){h&&c&&(h=!1,c.length?u=c.concat(u):d=-1,u.length&&p())}function p(){if(!h){var e=l(f);h=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,h=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function g(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new m(e,t)),1!==u.length||h||l(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=g,s.addListener=g,s.once=g,s.off=g,s.removeListener=g,s.removeAllListeners=g,s.emit=g,s.prependListener=g,s.prependOnceListener=g,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],468:[function(e,t,r){"use strict";r.publicEncrypt=e("./publicEncrypt"),r.privateDecrypt=e("./privateDecrypt"),r.privateEncrypt=function(e,t){return r.publicEncrypt(e,t,!0)},r.publicDecrypt=function(e,t){return r.privateDecrypt(e,t,!0)}},{"./privateDecrypt":471,"./publicEncrypt":472}],469:[function(e,t,r){"use strict";var n=e("create-hash"),i=e("safe-buffer").Buffer;function s(e){var t=i.allocUnsafe(4);return t.writeUInt32BE(e,0),t}t.exports=function(e,t){for(var r,a=i.alloc(0),o=0;a.length<t;)r=s(o++),a=i.concat([a,n("sha1").update(e).update(r).digest()]);return a.slice(0,t)}},{"create-hash":386,"safe-buffer":494}],470:[function(e,t,r){arguments[4][184][0].apply(r,arguments)},{buffer:188,dup:184}],471:[function(e,t,r){"use strict";var n=e("parse-asn1"),i=e("./mgf"),s=e("./xor"),a=e("bn.js"),o=e("browserify-rsa"),l=e("create-hash"),c=e("./withPublic"),u=e("safe-buffer").Buffer;t.exports=function(e,t,r){var h;h=e.padding?e.padding:r?1:4;var d,f=n(e),p=f.modulus.byteLength();if(t.length>p||new a(t).cmp(f.modulus)>=0)throw new Error("decryption error");d=r?c(new a(t),f):o(t,f);var m=u.alloc(p-d.length);if(d=u.concat([m,d],p),4===h)return function(e,t){var r=e.modulus.byteLength(),n=l("sha1").update(u.alloc(0)).digest(),a=n.length;if(0!==t[0])throw new Error("decryption error");var o=t.slice(1,a+1),c=t.slice(a+1),h=s(o,i(c,a)),d=s(c,i(h,r-a-1));if(function(e,t){e=u.from(e),t=u.from(t);var r=0,n=e.length;e.length!==t.length&&(r++,n=Math.min(e.length,t.length));for(var i=-1;++i<n;)r+=e[i]^t[i];return r}(n,d.slice(0,a)))throw new Error("decryption error");for(var f=a;0===d[f];)f++;if(1!==d[f++])throw new Error("decryption error");return d.slice(f)}(f,d);if(1===h)return function(e,t,r){for(var n=t.slice(0,2),i=2,s=0;0!==t[i++];)if(i>=t.length){s++;break}var a=t.slice(2,i-1);if(("0002"!==n.toString("hex")&&!r||"0001"!==n.toString("hex")&&r)&&s++,a.length<8&&s++,s)throw new Error("decryption error");return t.slice(i)}(0,d,r);if(3===h)return d;throw new Error("unknown padding")}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,"safe-buffer":494}],472:[function(e,t,r){"use strict";var n=e("parse-asn1"),i=e("randombytes"),s=e("create-hash"),a=e("./mgf"),o=e("./xor"),l=e("bn.js"),c=e("./withPublic"),u=e("browserify-rsa"),h=e("safe-buffer").Buffer;t.exports=function(e,t,r){var d;d=e.padding?e.padding:r?1:4;var f,p=n(e);if(4===d)f=function(e,t){var r=e.modulus.byteLength(),n=t.length,c=s("sha1").update(h.alloc(0)).digest(),u=c.length,d=2*u;if(n>r-d-2)throw new Error("message too long");var f=h.alloc(r-n-d-2),p=r-u-1,m=i(u),g=o(h.concat([c,f,h.alloc(1,1),t],p),a(m,p)),v=o(m,a(g,u));return new l(h.concat([h.alloc(1),v,g],r))}(p,t);else if(1===d)f=function(e,t,r){var n,s=t.length,a=e.modulus.byteLength();if(s>a-11)throw new Error("message too long");return n=r?h.alloc(a-s-3,255):function(e){for(var t,r=h.allocUnsafe(e),n=0,s=i(2*e),a=0;n<e;)a===s.length&&(s=i(2*e),a=0),(t=s[a++])&&(r[n++]=t);return r}(a-s-3),new l(h.concat([h.from([0,r?1:2]),n,h.alloc(1),t],a))}(p,t,r);else{if(3!==d)throw new Error("unknown padding");if((f=new l(t)).cmp(p.modulus)>=0)throw new Error("data too long for modulus")}return r?u(f,p):c(f,p)}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,randombytes:475,"safe-buffer":494}],473:[function(e,t,r){"use strict";var n=e("bn.js"),i=e("safe-buffer").Buffer;t.exports=function(e,t){return i.from(e.toRed(n.mont(t.modulus)).redPow(new n(t.publicExponent)).fromRed().toArray())}},{"bn.js":470,"safe-buffer":494}],474:[function(e,t,r){"use strict";t.exports=function(e,t){for(var r=e.length,n=-1;++n<r;)e[n]^=t[n];return e}},{}],475:[function(e,t,n){(function(r,n){(function(){"use strict";var i=e("safe-buffer").Buffer,s=n.crypto||n.msCrypto;s&&s.getRandomValues?t.exports=function(e,t){if(e>4294967295)throw new RangeError("requested too many random bytes");var n=i.allocUnsafe(e);if(e>0)if(e>65536)for(var a=0;a<e;a+=65536)s.getRandomValues(n.slice(a,a+65536));else s.getRandomValues(n);return"function"==typeof t?r.nextTick((function(){t(null,n)})):n}:t.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this)}).call(this,e("_process"),"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:467,"safe-buffer":494}],476:[function(e,t,n){(function(t,r){(function(){"use strict";function i(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}var s=e("safe-buffer"),a=e("randombytes"),o=s.Buffer,l=s.kMaxLength,c=r.crypto||r.msCrypto,u=Math.pow(2,32)-1;function h(e,t){if("number"!=typeof e||e!=e)throw new TypeError("offset must be a number");if(e>u||e<0)throw new TypeError("offset must be a uint32");if(e>l||e>t)throw new RangeError("offset out of range")}function d(e,t,r){if("number"!=typeof e||e!=e)throw new TypeError("size must be a number");if(e>u||e<0)throw new TypeError("size must be a uint32");if(e+t>r||e>l)throw new RangeError("buffer too small")}function f(e,r,n,i){if(t.browser){var s=e.buffer,o=new Uint8Array(s,r,n);return c.getRandomValues(o),i?void t.nextTick((function(){i(null,e)})):e}if(!i)return a(n).copy(e,r),e;a(n,(function(t,n){if(t)return i(t);n.copy(e,r),i(null,e)}))}c&&c.getRandomValues||!t.browser?(n.randomFill=function(e,t,n,i){if(!(o.isBuffer(e)||e instanceof r.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if("function"==typeof t)i=t,t=0,n=e.length;else if("function"==typeof n)i=n,n=e.length-t;else if("function"!=typeof i)throw new TypeError('"cb" argument must be a function');return h(t,e.length),d(n,t,e.length),f(e,t,n,i)},n.randomFillSync=function(e,t,n){if(void 0===t&&(t=0),!(o.isBuffer(e)||e instanceof r.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return h(t,e.length),void 0===n&&(n=e.length-t),d(n,t,e.length),f(e,t,n)}):(n.randomFill=i,n.randomFillSync=i)}).call(this)}).call(this,e("_process"),"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:467,randombytes:475,"safe-buffer":494}],477:[function(e,t,r){"use strict";var n={};function i(e,t,r){r||(r=Error);var i=function(e){var r,n;function i(r,n,i){return e.call(this,function(e,r,n){return"string"==typeof t?t:t(e,r,n)}(r,n,i))||this}return n=e,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n,i}(r);i.prototype.name=r.name,i.prototype.code=e,n[e]=i}function s(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,i,a,o;if("string"==typeof t&&(i="not ",t.substr(!a||a<0?0:+a,i.length)===i)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))o="The ".concat(e," ").concat(n," ").concat(s(t,"type"));else{var l=function(e,t,r){return"number"!=typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";o='The "'.concat(e,'" ').concat(l," ").concat(n," ").concat(s(t,"type"))}return o+". Received type ".concat(typeof r)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=n},{}],478:[function(e,t,r){(function(r){(function(){"use strict";var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=c;var i=e("./_stream_readable"),s=e("./_stream_writable");e("inherits")(c,i);for(var a=n(s.prototype),o=0;o<a.length;o++){var l=a[o];c.prototype[l]||(c.prototype[l]=s.prototype[l])}function c(e){if(!(this instanceof c))return new c(e);i.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",u)))}function u(){this._writableState.ended||r.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this)}).call(this,e("_process"))},{"./_stream_readable":480,"./_stream_writable":482,_process:467,inherits:440}],479:[function(e,t,r){"use strict";t.exports=i;var n=e("./_stream_transform");function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}e("inherits")(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},{"./_stream_transform":481,inherits:440}],480:[function(e,t,n){(function(r,n){(function(){"use strict";var i;t.exports=E,E.ReadableState=C,e("events").EventEmitter;var s,a=function(e,t){return e.listeners(t).length},o=e("./internal/streams/stream"),l=e("buffer").Buffer,c=(void 0!==n?n:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},u=e("util");s=u&&u.debuglog?u.debuglog("stream"):function(){};var h,d,f,p=e("./internal/streams/buffer_list"),m=e("./internal/streams/destroy"),g=e("./internal/streams/state").getHighWaterMark,v=e("../errors").codes,y=v.ERR_INVALID_ARG_TYPE,b=v.ERR_STREAM_PUSH_AFTER_EOF,w=v.ERR_METHOD_NOT_IMPLEMENTED,x=v.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(E,o);var S=m.errorOrDestroy,_=["error","close","destroy","pause","resume"];function C(t,r,n){i=i||e("./_stream_duplex"),t=t||{},"boolean"!=typeof n&&(n=r instanceof i),this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=g(this,t,"readableHighWaterMark",n),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(h||(h=e("string_decoder/").StringDecoder),this.decoder=new h(t.encoding),this.encoding=t.encoding)}function E(t){if(i=i||e("./_stream_duplex"),!(this instanceof E))return new E(t);var r=this instanceof i;this._readableState=new C(t,this,r),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),o.call(this)}function A(e,t,r,n,i){s("readableAddChunk",t);var a,o=e._readableState;if(null===t)o.reading=!1,function(e,t){if(s("onEofChunk"),!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?P(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,k(e)))}}(e,o);else if(i||(a=function(e,t){var r,n;return n=t,l.isBuffer(n)||n instanceof c||"string"==typeof t||void 0===t||e.objectMode||(r=new y("chunk",["string","Buffer","Uint8Array"],t)),r}(o,t)),a)S(e,a);else if(o.objectMode||t&&t.length>0)if("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=function(e){return l.from(e)}(t)),n)o.endEmitted?S(e,new x):M(e,o,t,!0);else if(o.ended)S(e,new b);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?M(e,o,t,!1):D(e,o)):M(e,o,t,!1)}else n||(o.reading=!1,D(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function M(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&P(e)),D(e,t)}function T(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=1073741824?e=1073741824:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function P(e){var t=e._readableState;s("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(s("emitReadable",t.flowing),t.emittedReadable=!0,r.nextTick(k,e))}function k(e){var t=e._readableState;s("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,N(e)}function D(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(I,e,t))}function I(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(s("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function O(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function R(e){s("readable nexttick read 0"),e.read(0)}function L(e,t){s("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),N(e),t.flowing&&!t.reading&&e.read(0)}function N(e){var t=e._readableState;for(s("flow",t.flowing);t.flowing&&null!==e.read(););}function B(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function z(e){var t=e._readableState;s("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,r.nextTick(F,t,e))}function F(e,t){if(s("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function j(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),E.prototype.destroy=m.destroy,E.prototype._undestroy=m.undestroy,E.prototype._destroy=function(e,t){t(e)},E.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=l.from(e,t),t=""),r=!0),A(this,e,t,!1,r)},E.prototype.unshift=function(e){return A(this,e,null,!0,!1)},E.prototype.isPaused=function(){return!1===this._readableState.flowing},E.prototype.setEncoding=function(t){h||(h=e("string_decoder/").StringDecoder);var r=new h(t);this._readableState.decoder=r,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=r.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this},E.prototype.read=function(e){s("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return s("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?z(this):P(this),null;if(0===(e=T(e,t))&&t.ended)return 0===t.length&&z(this),null;var n,i=t.needReadable;return s("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&s("length less than watermark",i=!0),t.ended||t.reading?s("reading or ended",i=!1):i&&(s("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=T(r,t))),null===(n=e>0?B(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&z(this)),null!==n&&this.emit("data",n),n},E.prototype._read=function(e){S(this,new w("_read()"))},E.prototype.pipe=function(e,t){var n=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,s("pipe count=%d opts=%j",i.pipesCount,t);var o=t&&!1===t.end||e===r.stdout||e===r.stderr?g:c;function l(t,r){s("onunpipe"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,s("cleanup"),e.removeListener("close",p),e.removeListener("finish",m),e.removeListener("drain",u),e.removeListener("error",f),e.removeListener("unpipe",l),n.removeListener("end",c),n.removeListener("end",g),n.removeListener("data",d),h=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||u())}function c(){s("onend"),e.end()}i.endEmitted?r.nextTick(o):n.once("end",o),e.on("unpipe",l);var u=function(e){return function(){var t=e._readableState;s("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,N(e))}}(n);e.on("drain",u);var h=!1;function d(t){s("ondata");var r=e.write(t);s("dest.write",r),!1===r&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==j(i.pipes,e))&&!h&&(s("false write response, pause",i.awaitDrain),i.awaitDrain++),n.pause())}function f(t){s("onerror",t),g(),e.removeListener("error",f),0===a(e,"error")&&S(e,t)}function p(){e.removeListener("finish",m),g()}function m(){s("onfinish"),e.removeListener("close",p),g()}function g(){s("unpipe"),n.unpipe(e)}return n.on("data",d),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",f),e.once("close",p),e.once("finish",m),e.emit("pipe",n),i.flowing||(s("pipe resume"),n.resume()),e},E.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)n[s].emit("unpipe",this,{hasUnpiped:!1});return this}var a=j(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},E.prototype.on=function(e,t){var n=o.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,s("on readable",i.length,i.reading),i.length?P(this):i.reading||r.nextTick(R,this))),n},E.prototype.addListener=E.prototype.on,E.prototype.removeListener=function(e,t){var n=o.prototype.removeListener.call(this,e,t);return"readable"===e&&r.nextTick(O,this),n},E.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||r.nextTick(O,this),t},E.prototype.resume=function(){var e=this._readableState;return e.flowing||(s("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(L,e,t))}(this,e)),e.paused=!1,this},E.prototype.pause=function(){return s("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(s("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},E.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(s("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){s("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var a=0;a<_.length;a++)e.on(_[a],this.emit.bind(this,_[a]));return this._read=function(t){s("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"==typeof Symbol&&(E.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=e("./internal/streams/async_iterator")),d(this)}),Object.defineProperty(E.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(E.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(E.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),E._fromList=B,Object.defineProperty(E.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(E.from=function(t,r){return void 0===f&&(f=e("./internal/streams/from")),f(E,t,r)})}).call(this)}).call(this,e("_process"),"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/async_iterator":483,"./internal/streams/buffer_list":484,"./internal/streams/destroy":485,"./internal/streams/from":487,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,events:422,inherits:440,"string_decoder/":522,util:188}],481:[function(e,t,r){"use strict";t.exports=u;var n=e("../errors").codes,i=n.ERR_METHOD_NOT_IMPLEMENTED,s=n.ERR_MULTIPLE_CALLBACK,a=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=n.ERR_TRANSFORM_WITH_LENGTH_0,l=e("./_stream_duplex");function c(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new s);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function u(e){if(!(this instanceof u))return new u(e);l.call(this,e),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush((function(t,r){d(e,t,r)}))}function d(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new o;if(e._transformState.transforming)throw new a;return e.push(null)}e("inherits")(u,l),u.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},u.prototype._transform=function(e,t,r){r(new i("_transform()"))},u.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},u.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},u.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))}},{"../errors":477,"./_stream_duplex":478,inherits:440}],482:[function(e,t,n){(function(r,n){(function(){"use strict";function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;for(e.entry=null;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var s;t.exports=E,E.WritableState=C;var a,o={deprecate:e("util-deprecate")},l=e("./internal/streams/stream"),c=e("buffer").Buffer,u=(void 0!==n?n:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},h=e("./internal/streams/destroy"),d=e("./internal/streams/state").getHighWaterMark,f=e("../errors").codes,p=f.ERR_INVALID_ARG_TYPE,m=f.ERR_METHOD_NOT_IMPLEMENTED,g=f.ERR_MULTIPLE_CALLBACK,v=f.ERR_STREAM_CANNOT_PIPE,y=f.ERR_STREAM_DESTROYED,b=f.ERR_STREAM_NULL_VALUES,w=f.ERR_STREAM_WRITE_AFTER_END,x=f.ERR_UNKNOWN_ENCODING,S=h.errorOrDestroy;function _(){}function C(t,n,a){s=s||e("./_stream_duplex"),t=t||{},"boolean"!=typeof a&&(a=n instanceof s),this.objectMode=!!t.objectMode,a&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=d(this,t,"writableHighWaterMark",a),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===t.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,i=n.sync,s=n.writecb;if("function"!=typeof s)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,i,s){--t.pendingcb,n?(r.nextTick(s,i),r.nextTick(D,e,t),e._writableState.errorEmitted=!0,S(e,i)):(s(i),e._writableState.errorEmitted=!0,S(e,i),D(e,t))}(e,n,i,t,s);else{var a=P(n)||e.destroyed;a||n.corked||n.bufferProcessing||!n.bufferedRequest||T(e,n),i?r.nextTick(M,e,n,a,s):M(e,n,a,s)}}(n,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function E(t){var r=this instanceof(s=s||e("./_stream_duplex"));if(!r&&!a.call(E,this))return new E(t);this._writableState=new C(t,this,r),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),l.call(this)}function A(e,t,r,n,i,s,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new y("write")):r?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function M(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),D(e,t)}function T(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,s=new Array(n),a=t.corkedRequestsFree;a.entry=r;for(var o=0,l=!0;r;)s[o]=r,r.isBuf||(l=!1),r=r.next,o+=1;s.allBuffers=l,A(e,t,!0,t.length,s,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,u=r.encoding,h=r.callback;if(A(e,t,!1,t.objectMode?1:c.length,c,u,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function P(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function k(e,t){e._final((function(r){t.pendingcb--,r&&S(e,r),t.prefinished=!0,e.emit("prefinish"),D(e,t)}))}function D(e,t){var n=P(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,r.nextTick(k,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return n}e("inherits")(E,l),C.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(C.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(a=Function.prototype[Symbol.hasInstance],Object.defineProperty(E,Symbol.hasInstance,{value:function(e){return!!a.call(this,e)||this===E&&e&&e._writableState instanceof C}})):a=function(e){return e instanceof this},E.prototype.pipe=function(){S(this,new v)},E.prototype.write=function(e,t,n){var i,s=this._writableState,a=!1,o=!s.objectMode&&(i=e,c.isBuffer(i)||i instanceof u);return o&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"==typeof t&&(n=t,t=null),o?t="buffer":t||(t=s.defaultEncoding),"function"!=typeof n&&(n=_),s.ending?function(e,t){var n=new w;S(e,n),r.nextTick(t,n)}(this,n):(o||function(e,t,n,i){var s;return null===n?s=new b:"string"==typeof n||t.objectMode||(s=new p("chunk",["string","Buffer"],n)),!s||(S(e,s),r.nextTick(i,s),!1)}(this,s,e,n))&&(s.pendingcb++,a=function(e,t,r,n,i,s){if(!r){var a=function(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,r)),t}(t,n,i);n!==a&&(r=!0,i="buffer",n=a)}var o=t.objectMode?1:n.length;t.length+=o;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:s,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else A(e,t,!1,o,n,i,s);return l}(this,s,o,e,t,n)),a},E.prototype.cork=function(){this._writableState.corked++},E.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||T(this,e))},E.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new x(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(E.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(E.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),E.prototype._write=function(e,t,r){r(new m("_write()"))},E.prototype._writev=null,E.prototype.end=function(e,t,n){var i=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,n){t.ending=!0,D(e,t),n&&(t.finished?r.nextTick(n):e.once("finish",n)),t.ended=!0,e.writable=!1}(this,i,n),this},Object.defineProperty(E.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),E.prototype.destroy=h.destroy,E.prototype._undestroy=h.undestroy,E.prototype._destroy=function(e,t){t(e)}}).call(this)}).call(this,e("_process"),"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/destroy":485,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,inherits:440,"util-deprecate":524}],483:[function(e,t,r){(function(r){(function(){"use strict";var n;function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=e("./end-of-stream"),a=Symbol("lastResolve"),o=Symbol("lastReject"),l=Symbol("error"),c=Symbol("ended"),u=Symbol("lastPromise"),h=Symbol("handlePromise"),d=Symbol("stream");function f(e,t){return{value:e,done:t}}function p(e){var t=e[a];if(null!==t){var r=e[d].read();null!==r&&(e[u]=null,e[a]=null,e[o]=null,t(f(r,!1)))}}function m(e){r.nextTick(p,e)}var g=Object.getPrototypeOf((function(){})),v=Object.setPrototypeOf((i(n={get stream(){return this[d]},next:function(){var e=this,t=this[l];if(null!==t)return Promise.reject(t);if(this[c])return Promise.resolve(f(void 0,!0));if(this[d].destroyed)return new Promise((function(t,n){r.nextTick((function(){e[l]?n(e[l]):t(f(void 0,!0))}))}));var n,i=this[u];if(i)n=new Promise(function(e,t){return function(r,n){e.then((function(){t[c]?r(f(void 0,!0)):t[h](r,n)}),n)}}(i,this));else{var s=this[d].read();if(null!==s)return Promise.resolve(f(s,!1));n=new Promise(this[h])}return this[u]=n,n}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,r){e[d].destroy(null,(function(e){e?r(e):t(f(void 0,!0))}))}))})),n),g);t.exports=function(e){var t,r=Object.create(v,(i(t={},d,{value:e,writable:!0}),i(t,a,{value:null,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,l,{value:null,writable:!0}),i(t,c,{value:e._readableState.endEmitted,writable:!0}),i(t,h,{value:function(e,t){var n=r[d].read();n?(r[u]=null,r[a]=null,r[o]=null,e(f(n,!1))):(r[a]=e,r[o]=t)},writable:!0}),t));return r[u]=null,s(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[o];return null!==t&&(r[u]=null,r[a]=null,r[o]=null,t(e)),void(r[l]=e)}var n=r[a];null!==n&&(r[u]=null,r[a]=null,r[o]=null,n(f(void 0,!0))),r[c]=!0})),e.on("readable",m.bind(null,r)),r}}).call(this)}).call(this,e("_process"))},{"./end-of-stream":486,_process:467}],484:[function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return(t=o(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=e("buffer").Buffer,c=e("util").inspect,u=c&&c.custom||"inspect";t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r,n;return t=e,(r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return l.alloc(0);for(var t,r,n,i=l.allocUnsafe(e>>>0),s=this.head,a=0;s;)t=s.data,r=i,n=a,l.prototype.copy.call(t,r,n),a+=s.data.length,s=s.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,s=e>i.length?i.length:e;if(s===i.length?n+=i:n+=i.slice(0,e),0==(e-=s)){s===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(s));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=l.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,s=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,s),0==(e-=s)){s===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(s));break}++n}return this.length-=n,t}},{key:u,value:function(e,t){return c(this,i(i({},t),{},{depth:0,customInspect:!1}))}}])&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},{buffer:220,util:188}],485:[function(e,t,r){(function(e){(function(){"use strict";function r(e,t){i(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}t.exports={destroy:function(t,s){var a=this,o=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return o||l?(s?s(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(i,this,t)):e.nextTick(i,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!s&&t?a._writableState?a._writableState.errorEmitted?e.nextTick(n,a):(a._writableState.errorEmitted=!0,e.nextTick(r,a,t)):e.nextTick(r,a,t):s?(e.nextTick(n,a),s(t)):e.nextTick(n,a)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,e("_process"))},{_process:467}],486:[function(e,t,r){"use strict";var n=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}t.exports=function e(t,r,s){if("function"==typeof r)return e(t,null,r);r||(r={}),s=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(s||i);var a=r.readable||!1!==r.readable&&t.readable,o=r.writable||!1!==r.writable&&t.writable,l=function(){t.writable||u()},c=t._writableState&&t._writableState.finished,u=function(){o=!1,c=!0,a||s.call(t)},h=t._readableState&&t._readableState.endEmitted,d=function(){a=!1,h=!0,o||s.call(t)},f=function(e){s.call(t,e)},p=function(){var e;return a&&!h?(t._readableState&&t._readableState.ended||(e=new n),s.call(t,e)):o&&!c?(t._writableState&&t._writableState.ended||(e=new n),s.call(t,e)):void 0},m=function(){t.req.on("finish",u)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",u),t.on("abort",p),t.req?m():t.on("request",m)):o&&!t._writableState&&(t.on("end",l),t.on("close",l)),t.on("end",d),t.on("finish",u),!1!==r.error&&t.on("error",f),t.on("close",p),function(){t.removeListener("complete",u),t.removeListener("abort",p),t.removeListener("request",m),t.req&&t.req.removeListener("finish",u),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",u),t.removeListener("end",d),t.removeListener("error",f),t.removeListener("close",p)}}},{"../../../errors":477}],487:[function(e,t,r){"use strict";t.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],488:[function(e,t,r){"use strict";var n,i=e("../../../errors").codes,s=i.ERR_MISSING_ARGS,a=i.ERR_STREAM_DESTROYED;function o(e){if(e)throw e}function l(t,r,i,s){s=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(s);var o=!1;t.on("close",(function(){o=!0})),void 0===n&&(n=e("./end-of-stream")),n(t,{readable:r,writable:i},(function(e){if(e)return s(e);o=!0,s()}));var l=!1;return function(e){if(!o&&!l)return l=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void s(e||new a("pipe"))}}function c(e){e()}function u(e,t){return e.pipe(t)}function h(e){return e.length?"function"!=typeof e[e.length-1]?o:e.pop():o}t.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=h(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new s("streams");var a=t.map((function(e,r){var s=r<t.length-1;return l(e,s,r>0,(function(e){n||(n=e),e&&a.forEach(c),s||(a.forEach(c),i(n))}))}));return t.reduce(u)}},{"../../../errors":477,"./end-of-stream":486}],489:[function(e,t,r){"use strict";var n=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,r,i){var s=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new n(i?r:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}}},{"../../../errors":477}],490:[function(e,t,r){"use strict";t.exports=e("events").EventEmitter},{events:422}],491:[function(e,t,r){"use strict";(r=t.exports=e("./lib/_stream_readable.js")).Stream=r,r.Readable=r,r.Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js"),r.finished=e("./lib/internal/streams/end-of-stream.js"),r.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":478,"./lib/_stream_passthrough.js":479,"./lib/_stream_readable.js":480,"./lib/_stream_transform.js":481,"./lib/_stream_writable.js":482,"./lib/internal/streams/end-of-stream.js":486,"./lib/internal/streams/pipeline.js":488}],492:[function(e,t,r){"use strict";var n=function(e){var t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",o=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var s=t&&t.prototype instanceof d?t:d,a=Object.create(s.prototype),o=new E(i||[]);return n(a,"_invoke",{value:x(e,r,o)}),a}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var h={};function d(){}function f(){}function p(){}var m={};l(m,s,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(A([])));v&&v!==t&&r.call(v,s)&&(m=v);var y=p.prototype=d.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){var i;n(this,"_invoke",{value:function(n,s){function a(){return new t((function(i,a){!function n(i,s,a,o){var l=u(e[i],e,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==typeof h&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,a,o)}),(function(e){n("throw",e,a,o)})):t.resolve(h).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,o)}))}o(l.arg)}(n,s,i,a)}))}return i=i?i.then(a,a):a()}})}function x(e,t,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return M()}for(r.method=i,r.arg=s;;){var a=r.delegate;if(a){var o=S(a,r);if(o){if(o===h)continue;return o}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function S(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,h;var s=i.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function A(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:M}}function M(){return{value:void 0,done:!0}}return f.prototype=p,n(y,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,o,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},b(w.prototype),l(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,i,s){void 0===s&&(s=Promise);var a=new w(c(t,r,n,i),s);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),l(y,o,"Generator"),l(y,s,(function(){return this})),l(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=A,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],a=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var o=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(o&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=e,a.arg=t,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;C(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:A(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},e}("object"==typeof t?t.exports:{});try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},{}],493:[function(e,t,r){"use strict";var n=e("buffer").Buffer,i=e("inherits"),s=e("hash-base"),a=new Array(16),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],l=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],c=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],u=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],h=[0,1518500249,1859775393,2400959708,2840853838],d=[1352829926,1548603684,1836072691,2053994217,0];function f(){s.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function p(e,t){return e<<t|e>>>32-t}function m(e,t,r,n,i,s,a,o){return p(e+(t^r^n)+s+a|0,o)+i|0}function g(e,t,r,n,i,s,a,o){return p(e+(t&r|~t&n)+s+a|0,o)+i|0}function v(e,t,r,n,i,s,a,o){return p(e+((t|~r)^n)+s+a|0,o)+i|0}function y(e,t,r,n,i,s,a,o){return p(e+(t&n|r&~n)+s+a|0,o)+i|0}function b(e,t,r,n,i,s,a,o){return p(e+(t^(r|~n))+s+a|0,o)+i|0}i(f,s),f.prototype._update=function(){for(var e=a,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);for(var r=0|this._a,n=0|this._b,i=0|this._c,s=0|this._d,f=0|this._e,w=0|this._a,x=0|this._b,S=0|this._c,_=0|this._d,C=0|this._e,E=0;E<80;E+=1){var A,M;E<16?(A=m(r,n,i,s,f,e[o[E]],h[0],c[E]),M=b(w,x,S,_,C,e[l[E]],d[0],u[E])):E<32?(A=g(r,n,i,s,f,e[o[E]],h[1],c[E]),M=y(w,x,S,_,C,e[l[E]],d[1],u[E])):E<48?(A=v(r,n,i,s,f,e[o[E]],h[2],c[E]),M=v(w,x,S,_,C,e[l[E]],d[2],u[E])):E<64?(A=y(r,n,i,s,f,e[o[E]],h[3],c[E]),M=g(w,x,S,_,C,e[l[E]],d[3],u[E])):(A=b(r,n,i,s,f,e[o[E]],h[4],c[E]),M=m(w,x,S,_,C,e[l[E]],d[4],u[E])),r=f,f=s,s=p(i,10),i=n,n=A,w=C,C=_,_=p(S,10),S=x,x=M}var T=this._b+i+_|0;this._b=this._c+s+C|0,this._c=this._d+f+w|0,this._d=this._e+r+x|0,this._e=this._a+n+S|0,this._a=T},f.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=n.alloc?n.alloc(20):new n(20);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e.writeInt32LE(this._e,16),e},t.exports=f},{buffer:220,"hash-base":425,inherits:440}],494:[function(e,t,r){"use strict";var n=e("buffer"),i=n.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=n:(s(n,r),r.Buffer=a),a.prototype=Object.create(i.prototype),s(i,a),a.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},{buffer:220}],495:[function(e,t,r){(function(r){(function(){"use strict";var n,i=e("buffer"),s=i.Buffer,a={};for(n in i)i.hasOwnProperty(n)&&"SlowBuffer"!==n&&"Buffer"!==n&&(a[n]=i[n]);var o=a.Buffer={};for(n in s)s.hasOwnProperty(n)&&"allocUnsafe"!==n&&"allocUnsafeSlow"!==n&&(o[n]=s[n]);if(a.Buffer.prototype=s.prototype,o.from&&o.from!==Uint8Array.from||(o.from=function(e,t,r){if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type '+typeof e);if(e&&void 0===e.length)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);return s(e,t,r)}),o.alloc||(o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError('The "size" argument must be of type number. Received type '+typeof e);if(e<0||e>=2*(1<<30))throw new RangeError('The value "'+e+'" is invalid for option "size"');var n=s(e);return t&&0!==t.length?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n}),!a.kStringMaxLength)try{a.kStringMaxLength=r.binding("buffer").kStringMaxLength}catch(e){}a.constants||(a.constants={MAX_LENGTH:a.kMaxLength},a.kStringMaxLength&&(a.constants.MAX_STRING_LENGTH=a.kStringMaxLength)),t.exports=a}).call(this)}).call(this,e("_process"))},{_process:467,buffer:220}],496:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=e("xmlchars/xml/1.0/ed5"),i=e("xmlchars/xml/1.1/ed2"),s=e("xmlchars/xmlns/1.0/ed3");var a=n.isS,o=n.isChar,l=n.isNameStartChar,c=n.isNameChar,u=n.S_LIST,h=n.NAME_RE,d=i.isChar,f=s.isNCNameStartChar,p=s.isNCNameChar,m=s.NC_NAME_RE;const g="http://www.w3.org/XML/1998/namespace",v="http://www.w3.org/2000/xmlns/",y={__proto__:null,xml:g,xmlns:v},b={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},w=e=>34===e||39===e,x=[34,39],S=[...x,91,62],_=[...x,60,93],C=[61,63,...u],E=[...u,62,38,60];function A(e,t,r){switch(t){case"xml":r!==g&&e.fail("xml prefix must be bound to ".concat(g,"."));break;case"xmlns":r!==v&&e.fail("xmlns prefix must be bound to ".concat(v,"."))}switch(r){case v:e.fail(""===t?"the default namespace may not be set to ".concat(r,"."):'may not assign a prefix (even "xmlns") to the URI '.concat(v,"."));break;case g:switch(t){case"xml":break;case"":e.fail("the default namespace may not be set to ".concat(r,"."));break;default:e.fail("may not assign the xml namespace to another prefix.")}}}const M=e=>m.test(e),T=e=>h.test(e);r.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const P={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};r.SaxesParser=class{constructor(e){this.opt=null!=e?e:{},this.fragmentOpt=!!this.opt.fragment;const t=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=!1!==this.opt.position,this.fileName=this.opt.fileName,t){this.nameStartCheck=f,this.nameCheck=p,this.isName=M,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},y);const e=this.opt.additionalNamespaces;null!=e&&(function(e,t){for(const r of Object.keys(t))A(e,r,t[r])}(this,e),Object.assign(this.ns,e))}else this.nameStartCheck=l,this.nameCheck=c,this.isName=T,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var e;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:t}=this;this.state=t?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=t,this.xmlDeclPossible=!t,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:r}=this.opt;if(void 0===r){if(!0===this.opt.forceXMLVersion)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");r="1.0"}this.setXMLVersion(r),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(b),null===(e=this.readyHandler)||void 0===e||e.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(e,t){this[P[e]]=t}off(e){this[P[e]]=void 0}makeError(e){var t;let r=null!==(t=this.fileName)&&void 0!==t?t:"";return this.trackPosition&&(r.length>0&&(r+=":"),r+="".concat(this.line,":").concat(this.column)),r.length>0&&(r+=": "),new Error(r+e)}fail(e){const t=this.makeError(e),r=this.errorHandler;if(void 0===r)throw t;return r(t),this}write(e){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let t=!1;null===e?(t=!0,e=""):"object"==typeof e&&(e=e.toString()),void 0!==this.carriedFromPrevious&&(e="".concat(this.carriedFromPrevious).concat(e),this.carriedFromPrevious=void 0);let r=e.length;const n=e.charCodeAt(r-1);!t&&(13===n||n>=55296&&n<=56319)&&(this.carriedFromPrevious=e[r-1],r--,e=e.slice(0,r));const{stateTable:i}=this;for(this.chunk=e,this.i=0;this.i<r;)i[this.state].call(this);return this.chunkPosition+=r,t?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:e,i:t}=this;if(this.prevI=t,this.i=t+1,t>=e.length)return-1;const r=e.charCodeAt(t);if(this.column++,r<55296){if(r>=32||9===r)return r;switch(r){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return 10===e.charCodeAt(t+1)&&(this.i=t+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),r}}if(r>56319)return r>=57344&&r<=65533||this.fail("disallowed character."),r;const n=65536+1024*(r-55296)+(e.charCodeAt(t+1)-56320);return this.i=t+2,n>1114111&&this.fail("disallowed character."),n}getCode11(){const{chunk:e,i:t}=this;if(this.prevI=t,this.i=t+1,t>=e.length)return-1;const r=e.charCodeAt(t);if(this.column++,r<55296){if(r>31&&r<127||r>159&&8232!==r||9===r)return r;switch(r){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{const r=e.charCodeAt(t+1);10!==r&&133!==r||(this.i=t+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),r}}if(r>56319)return r>=57344&&r<=65533||this.fail("disallowed character."),r;const n=65536+1024*(r-55296)+(e.charCodeAt(t+1)-56320);return this.i=t+2,n>1114111&&this.fail("disallowed character."),n}getCodeNorm(){const e=this.getCode();return-2===e?10:e}unget(){this.i=this.prevI,this.column--}captureTo(e){let{i:t}=this;const{chunk:r}=this;for(;;){const n=this.getCode(),i=-2===n,s=i?10:n;if(-1===s||e.includes(s))return this.text+=r.slice(t,this.prevI),s;i&&(this.text+=r.slice(t,this.prevI)+"\n",t=this.i)}}captureToChar(e){let{i:t}=this;const{chunk:r}=this;for(;;){let n=this.getCode();switch(n){case-2:this.text+=r.slice(t,this.prevI)+"\n",t=this.i,n=10;break;case-1:return this.text+=r.slice(t),!1}if(n===e)return this.text+=r.slice(t,this.prevI),!0}}captureNameChars(){const{chunk:e,i:t}=this;for(;;){const r=this.getCode();if(-1===r)return this.name+=e.slice(t),-1;if(!c(r))return this.name+=e.slice(t,this.prevI),-2===r?10:r}}skipSpaces(){for(;;){const e=this.getCodeNorm();if(-1===e||!a(e))return e}}setXMLVersion(e){this.currentXMLVersion=e,"1.0"===e?(this.isChar=o,this.getCode=this.getCode10):(this.isChar=d,this.getCode=this.getCode11)}sBegin(){65279===this.chunk.charCodeAt(0)&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const e=this.i,t=this.skipSpaces();switch(this.prevI!==e&&(this.xmlDeclPossible=!1),t){case 60:if(this.state=15,0!==this.text.length)throw new Error("no-empty text at start");break;case-1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var e;const t=this.captureTo(S);switch(t){case 62:null===(e=this.doctypeHandler)||void 0===e||e.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case-1:break;default:this.text+=String.fromCodePoint(t),91===t?this.state=4:w(t)&&(this.state=3,this.q=t)}}sDoctypeQuote(){const e=this.q;this.captureToChar(e)&&(this.text+=String.fromCodePoint(e),this.q=null,this.state=2)}sDTD(){const e=this.captureTo(_);-1!==e&&(this.text+=String.fromCodePoint(e),93===e?this.state=2:60===e?this.state=6:w(e)&&(this.state=5,this.q=e))}sDTDQuoted(){const e=this.q;this.captureToChar(e)&&(this.text+=String.fromCodePoint(e),this.state=4,this.q=null)}sDTDOpenWaka(){const e=this.getCodeNorm();switch(this.text+=String.fromCodePoint(e),e){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const e=String.fromCodePoint(this.getCodeNorm()),t=this.openWakaBang+=e;this.text+=e,"-"!==t&&(this.state="--"===t?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const e=this.getCodeNorm();this.text+=String.fromCodePoint(e),this.state=45===e?10:8}sDTDCommentEnded(){const e=this.getCodeNorm();this.text+=String.fromCodePoint(e),62===e?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const e=this.getCodeNorm();this.text+=String.fromCodePoint(e),62===e&&(this.state=4)}sText(){0!==this.tags.length?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:e}=this;const{chunk:t}=this;e:for(;;)switch(this.getCode()){case-2:this.entity+=t.slice(e,this.prevI)+"\n",e=this.i;break;case 59:{const{entityReturnState:r}=this,n=this.entity+t.slice(e,this.prevI);let i;this.state=r,""===n?(this.fail("empty entity name."),i="&;"):(i=this.parseEntity(n),this.entity=""),13===r&&void 0===this.textHandler||(this.text+=i);break e}case-1:this.entity+=t.slice(e);break e}}sOpenWaka(){const e=this.getCode();if(l(e))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(e){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var e;const t=this.getCodeNorm();45===t?(this.state=19,null===(e=this.commentHandler)||void 0===e||e.call(this,this.text),this.text=""):(this.text+="-"+String.fromCodePoint(t),this.state=17)}sCommentEnded(){const e=this.getCodeNorm();62!==e?(this.fail("malformed comment."),this.text+="--"+String.fromCodePoint(e),this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){const e=this.getCodeNorm();93===e?this.state=22:(this.text+="]"+String.fromCodePoint(e),this.state=20)}sCDataEnding2(){var e;const t=this.getCodeNorm();switch(t){case 62:null===(e=this.cdataHandler)||void 0===e||e.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+="]]"+String.fromCodePoint(t),this.state=20}}sPIFirstChar(){const e=this.getCodeNorm();this.nameStartCheck(e)?(this.piTarget+=String.fromCodePoint(e),this.state=24):63===e||a(e)?(this.fail("processing instruction without a target."),this.state=63===e?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(e),this.state=24)}sPIRest(){const{chunk:e,i:t}=this;for(;;){const r=this.getCodeNorm();if(-1===r)return void(this.piTarget+=e.slice(t));if(!this.nameCheck(r)){this.piTarget+=e.slice(t,this.prevI);const n=63===r;n||a(r)?"xml"===this.piTarget?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=n?33:27):this.state=n?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(r));break}}}sPIBody(){if(0===this.text.length){const e=this.getCodeNorm();63===e?this.state=26:a(e)||(this.text=String.fromCodePoint(e))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var e;const t=this.getCodeNorm();if(62===t){const{piTarget:t}=this;"xml"===t.toLowerCase()&&this.fail("the XML declaration must appear at the start of the document."),null===(e=this.piHandler)||void 0===e||e.call(this,{target:t,body:this.text}),this.piTarget=this.text="",this.state=13}else 63===t?this.text+="?":(this.text+="?"+String.fromCodePoint(t),this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const e=this.skipSpaces();63!==e?-1!==e&&(this.state=28,this.name=String.fromCodePoint(e)):this.state=33}sXMLDeclName(){const e=this.captureTo(C);if(63===e)return this.state=33,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(a(e)||61===e){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail("expected the name ".concat(this.xmlDeclExpects[0],"."));break;default:this.fail("expected one of "+this.xmlDeclExpects.join(", "))}this.state=61===e?30:29}}sXMLDeclEq(){const e=this.getCodeNorm();if(63===e)return this.state=33,void this.fail("XML declaration is incomplete.");a(e)||(61!==e&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const e=this.getCodeNorm();if(63===e)return this.state=33,void this.fail("XML declaration is incomplete.");a(e)||(w(e)?this.q=e:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const e=this.captureTo([this.q,63]);if(63===e)return this.state=33,this.text="",void this.fail("XML declaration is incomplete.");if(-1===e)return;const t=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const e=t;this.xmlDecl.version=e,/^1\.[0-9]+$/.test(e)?this.opt.forceXMLVersion||this.setXMLVersion(e):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(t)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=t;break;case"standalone":"yes"!==t&&"no"!==t&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=t}this.name="",this.state=32}sXMLDeclSeparator(){const e=this.getCodeNorm();63!==e?(a(e)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=33}sXMLDeclEnding(){var e;62===this.getCodeNorm()?("xml"!==this.piTarget?this.fail("processing instructions are not allowed before root."):"version"!==this.name&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),null===(e=this.xmldeclHandler)||void 0===e||e.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var e;const t=this.captureNameChars();if(-1===t)return;const r=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=r.ns=Object.create(null)),null===(e=this.openTagStartHandler)||void 0===e||e.call(this,r),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),t){case 62:this.openTag();break;case 47:this.state=35;break;default:a(t)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){62===this.getCode()?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const e=this.skipSpaces();-1!==e&&(l(e)?(this.unget(),this.state=37):62===e?this.openTag():47===e?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const e=this.captureNameChars();61===e?this.state=39:a(e)?this.state=38:62===e?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):-1!==e&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const e=this.skipSpaces();switch(e){case-1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",62===e?this.openTag():l(e)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const e=this.getCodeNorm();w(e)?(this.q=e,this.state=40):a(e)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){const{q:e,chunk:t}=this;let{i:r}=this;for(;;)switch(this.getCode()){case e:return this.pushAttrib(this.name,this.text+t.slice(r,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=t.slice(r,this.prevI),this.state=14,void(this.entityReturnState=40);case 10:case-2:case 9:this.text+=t.slice(r,this.prevI)+" ",r=this.i;break;case 60:return this.text+=t.slice(r,this.prevI),void this.fail("disallowed character.");case-1:return void(this.text+=t.slice(r))}}sAttribValueClosed(){const e=this.getCodeNorm();a(e)?this.state=36:62===e?this.openTag():47===e?this.state=35:l(e)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const e=this.captureTo(E);switch(e){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case-1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",62===e?this.openTag():this.state=36}}sCloseTag(){const e=this.captureNameChars();62===e?this.closeTag():a(e)?this.state=44:-1!==e&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case-1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:e,forbiddenState:t}=this;const{chunk:r,textHandler:n}=this;e:for(;;)switch(this.getCode()){case 60:if(this.state=15,void 0!==n){const{text:t}=this,i=r.slice(e,this.prevI);0!==t.length?(n(t+i),this.text=""):0!==i.length&&n(i)}t=0;break e;case 38:this.state=14,this.entityReturnState=13,void 0!==n&&(this.text+=r.slice(e,this.prevI)),t=0;break e;case 93:switch(t){case 0:t=1;break;case 1:t=2;break;case 2:break;default:throw new Error("impossible state")}break;case 62:2===t&&this.fail('the string "]]>" is disallowed in char data.'),t=0;break;case-2:void 0!==n&&(this.text+=r.slice(e,this.prevI)+"\n"),e=this.i,t=0;break;case-1:void 0!==n&&(this.text+=r.slice(e));break e;default:t=0}this.forbiddenState=t}handleTextOutsideRoot(){let{i:e}=this;const{chunk:t,textHandler:r}=this;let n=!1;e:for(;;){const i=this.getCode();switch(i){case 60:if(this.state=15,void 0!==r){const{text:n}=this,i=t.slice(e,this.prevI);0!==n.length?(r(n+i),this.text=""):0!==i.length&&r(i)}break e;case 38:this.state=14,this.entityReturnState=13,void 0!==r&&(this.text+=t.slice(e,this.prevI)),n=!0;break e;case-2:void 0!==r&&(this.text+=t.slice(e,this.prevI)+"\n"),e=this.i;break;case-1:void 0!==r&&(this.text+=t.slice(e));break e;default:a(i)||(n=!0)}}n&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(e,t){var r;const{prefix:n,local:i}=this.qname(e),s={name:e,prefix:n,local:i,value:t};if(this.attribList.push(s),null===(r=this.attributeHandler)||void 0===r||r.call(this,s),"xmlns"===n){const e=t.trim();"1.0"===this.currentXMLVersion&&""===e&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[i]=e,A(this,i,e)}else if("xmlns"===e){const e=t.trim();this.topNS[""]=e,A(this,"",e)}}pushAttribPlain(e,t){var r;const n={name:e,value:t};this.attribList.push(n),null===(r=this.attributeHandler)||void 0===r||r.call(this,n)}end(){var e,t;this.sawRoot||this.fail("document must contain a root element.");const{tags:r}=this;for(;r.length>0;){const e=r.pop();this.fail("unclosed tag: "+e.name)}0!==this.state&&13!==this.state&&this.fail("unexpected end.");const{text:n}=this;return 0!==n.length&&(null===(e=this.textHandler)||void 0===e||e.call(this,n),this.text=""),this._closed=!0,null===(t=this.endHandler)||void 0===t||t.call(this),this._init(),this}resolve(e){var t,r;let n=this.topNS[e];if(void 0!==n)return n;const{tags:i}=this;for(let s=i.length-1;s>=0;s--)if(n=i[s].ns[e],void 0!==n)return n;return n=this.ns[e],void 0!==n?n:null===(r=(t=this.opt).resolvePrefix)||void 0===r?void 0:r.call(t,e)}qname(e){const t=e.indexOf(":");if(-1===t)return{prefix:"",local:e};const r=e.slice(t+1),n=e.slice(0,t);return(""===n||""===r||r.includes(":"))&&this.fail("malformed name: ".concat(e,".")),{prefix:n,local:r}}processAttribsNS(){var e;const{attribList:t}=this,r=this.tag;{const{prefix:t,local:n}=this.qname(r.name);r.prefix=t,r.local=n;const i=r.uri=null!==(e=this.resolve(t))&&void 0!==e?e:"";""!==t&&("xmlns"===t&&this.fail('tags may not have "xmlns" as prefix.'),""===i&&(this.fail("unbound namespace prefix: ".concat(JSON.stringify(t),".")),r.uri=t))}if(0===t.length)return;const{attributes:n}=r,i=new Set;for(const s of t){const{name:e,prefix:t,local:r}=s;let a,o;""===t?(a="xmlns"===e?v:"",o=e):(a=this.resolve(t),void 0===a&&(this.fail("unbound namespace prefix: ".concat(JSON.stringify(t),".")),a=t),o="{".concat(a,"}").concat(r)),i.has(o)&&this.fail("duplicate attribute: ".concat(o,".")),i.add(o),s.uri=a,n[e]=s}this.attribList=[]}processAttribsPlain(){const{attribList:e}=this,t=this.tag.attributes;for(const{name:r,value:n}of e)void 0!==t[r]&&this.fail("duplicate attribute: ".concat(r,".")),t[r]=n;this.attribList=[]}openTag(){var e;this.processAttribs();const{tags:t}=this,r=this.tag;r.isSelfClosing=!1,null===(e=this.openTagHandler)||void 0===e||e.call(this,r),t.push(r),this.state=13,this.name=""}openSelfClosingTag(){var e,t,r;this.processAttribs();const{tags:n}=this,i=this.tag;i.isSelfClosing=!0,null===(e=this.openTagHandler)||void 0===e||e.call(this,i),null===(t=this.closeTagHandler)||void 0===t||t.call(this,i),null===(this.tag=null!==(r=n[n.length-1])&&void 0!==r?r:null)&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){const{tags:e,name:t}=this;if(this.state=13,this.name="",""===t)return this.fail("weird empty close tag."),void(this.text+="</>");const r=this.closeTagHandler;let n=e.length;for(;n-- >0;){const n=this.tag=e.pop();if(this.topNS=n.ns,null==r||r(n),n.name===t)break;this.fail("unexpected close tag.")}0===n?this.closedRoot=!0:n<0&&(this.fail("unmatched closing tag: ".concat(t,".")),this.text+="</".concat(t,">"))}parseEntity(e){if("#"!==e[0]){const t=this.ENTITIES[e];return void 0!==t?t:(this.fail(this.isName(e)?"undefined entity.":"disallowed character in entity name."),"&".concat(e,";"))}let t=NaN;return"x"===e[1]&&/^#x[0-9a-f]+$/i.test(e)?t=parseInt(e.slice(2),16):/^#[0-9]+$/.test(e)&&(t=parseInt(e.slice(1),10)),this.isChar(t)?String.fromCodePoint(t):(this.fail("malformed character entity."),"&".concat(e,";"))}}},{"xmlchars/xml/1.0/ed5":543,"xmlchars/xml/1.1/ed2":544,"xmlchars/xmlns/1.0/ed3":545}],497:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer;function i(e,t){this._block=n.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}i.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=n.from(e,t));for(var r=this._block,i=this._blockSize,s=e.length,a=this._len,o=0;o<s;){for(var l=a%i,c=Math.min(s-o,i-l),u=0;u<c;u++)r[l+u]=e[o+u];o+=c,(a+=c)%i==0&&this._update(r)}return this._len+=s,this},i.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var r=8*this._len;if(r<=4294967295)this._block.writeUInt32BE(r,this._blockSize-4);else{var n=(4294967295&r)>>>0,i=(r-n)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(n,this._blockSize-4)}this._update(this._block);var s=this._hash();return e?s.toString(e):s},i.prototype._update=function(){throw new Error("_update must be implemented by subclass")},t.exports=i},{"safe-buffer":494}],498:[function(e,t,r){"use strict";var n=t.exports=function(e){e=e.toLowerCase();var t=n[e];if(!t)throw new Error(e+" is not supported (we accept pull requests)");return new t};n.sha=e("./sha"),n.sha1=e("./sha1"),n.sha224=e("./sha224"),n.sha256=e("./sha256"),n.sha384=e("./sha384"),n.sha512=e("./sha512")},{"./sha":499,"./sha1":500,"./sha224":501,"./sha256":502,"./sha384":503,"./sha512":504}],499:[function(e,t,r){"use strict";var n=e("inherits"),i=e("./hash"),s=e("safe-buffer").Buffer,a=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function l(){this.init(),this._w=o,i.call(this,64,56)}function c(e){return e<<30|e>>>2}function u(e,t,r,n){return 0===e?t&r|~t&n:2===e?t&r|t&n|r&n:t^r^n}n(l,i),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,r=this._w,n=0|this._a,i=0|this._b,s=0|this._c,o=0|this._d,l=0|this._e,h=0;h<16;++h)r[h]=e.readInt32BE(4*h);for(;h<80;++h)r[h]=r[h-3]^r[h-8]^r[h-14]^r[h-16];for(var d=0;d<80;++d){var f=~~(d/20),p=0|((t=n)<<5|t>>>27)+u(f,i,s,o)+l+r[d]+a[f];l=o,o=s,s=c(i),i=n,n=p}this._a=n+this._a|0,this._b=i+this._b|0,this._c=s+this._c|0,this._d=o+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=s.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},t.exports=l},{"./hash":497,inherits:440,"safe-buffer":494}],500:[function(e,t,r){"use strict";var n=e("inherits"),i=e("./hash"),s=e("safe-buffer").Buffer,a=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function l(){this.init(),this._w=o,i.call(this,64,56)}function c(e){return e<<5|e>>>27}function u(e){return e<<30|e>>>2}function h(e,t,r,n){return 0===e?t&r|~t&n:2===e?t&r|t&n|r&n:t^r^n}n(l,i),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,r=this._w,n=0|this._a,i=0|this._b,s=0|this._c,o=0|this._d,l=0|this._e,d=0;d<16;++d)r[d]=e.readInt32BE(4*d);for(;d<80;++d)r[d]=(t=r[d-3]^r[d-8]^r[d-14]^r[d-16])<<1|t>>>31;for(var f=0;f<80;++f){var p=~~(f/20),m=c(n)+h(p,i,s,o)+l+r[f]+a[p]|0;l=o,o=s,s=u(i),i=n,n=m}this._a=n+this._a|0,this._b=i+this._b|0,this._c=s+this._c|0,this._d=o+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=s.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},t.exports=l},{"./hash":497,inherits:440,"safe-buffer":494}],501:[function(e,t,r){"use strict";var n=e("inherits"),i=e("./sha256"),s=e("./hash"),a=e("safe-buffer").Buffer,o=new Array(64);function l(){this.init(),this._w=o,s.call(this,64,56)}n(l,i),l.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},l.prototype._hash=function(){var e=a.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},t.exports=l},{"./hash":497,"./sha256":502,inherits:440,"safe-buffer":494}],502:[function(e,t,r){"use strict";var n=e("inherits"),i=e("./hash"),s=e("safe-buffer").Buffer,a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=new Array(64);function l(){this.init(),this._w=o,i.call(this,64,56)}function c(e,t,r){return r^e&(t^r)}function u(e,t,r){return e&t|r&(e|t)}function h(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function d(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function f(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}n(l,i),l.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},l.prototype._update=function(e){for(var t,r=this._w,n=0|this._a,i=0|this._b,s=0|this._c,o=0|this._d,l=0|this._e,p=0|this._f,m=0|this._g,g=0|this._h,v=0;v<16;++v)r[v]=e.readInt32BE(4*v);for(;v<64;++v)r[v]=0|(((t=r[v-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+r[v-7]+f(r[v-15])+r[v-16];for(var y=0;y<64;++y){var b=g+d(l)+c(l,p,m)+a[y]+r[y]|0,w=h(n)+u(n,i,s)|0;g=m,m=p,p=l,l=o+b|0,o=s,s=i,i=n,n=b+w|0}this._a=n+this._a|0,this._b=i+this._b|0,this._c=s+this._c|0,this._d=o+this._d|0,this._e=l+this._e|0,this._f=p+this._f|0,this._g=m+this._g|0,this._h=g+this._h|0},l.prototype._hash=function(){var e=s.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},t.exports=l},{"./hash":497,inherits:440,"safe-buffer":494}],503:[function(e,t,r){"use strict";var n=e("inherits"),i=e("./sha512"),s=e("./hash"),a=e("safe-buffer").Buffer,o=new Array(160);function l(){this.init(),this._w=o,s.call(this,128,112)}n(l,i),l.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},l.prototype._hash=function(){var e=a.allocUnsafe(48);function t(t,r,n){e.writeInt32BE(t,n),e.writeInt32BE(r,n+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},t.exports=l},{"./hash":497,"./sha512":504,inherits:440,"safe-buffer":494}],504:[function(e,t,r){"use strict";var n=e("inherits"),i=e("./hash"),s=e("safe-buffer").Buffer,a=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],o=new Array(160);function l(){this.init(),this._w=o,i.call(this,128,112)}function c(e,t,r){return r^e&(t^r)}function u(e,t,r){return e&t|r&(e|t)}function h(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function d(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function f(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function p(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function m(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function g(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function v(e,t){return e>>>0<t>>>0?1:0}n(l,i),l.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},l.prototype._update=function(e){for(var t=this._w,r=0|this._ah,n=0|this._bh,i=0|this._ch,s=0|this._dh,o=0|this._eh,l=0|this._fh,y=0|this._gh,b=0|this._hh,w=0|this._al,x=0|this._bl,S=0|this._cl,_=0|this._dl,C=0|this._el,E=0|this._fl,A=0|this._gl,M=0|this._hl,T=0;T<32;T+=2)t[T]=e.readInt32BE(4*T),t[T+1]=e.readInt32BE(4*T+4);for(;T<160;T+=2){var P=t[T-30],k=t[T-30+1],D=f(P,k),I=p(k,P),O=m(P=t[T-4],k=t[T-4+1]),R=g(k,P),L=t[T-14],N=t[T-14+1],B=t[T-32],z=t[T-32+1],F=I+N|0,j=D+L+v(F,I)|0;j=(j=j+O+v(F=F+R|0,R)|0)+B+v(F=F+z|0,z)|0,t[T]=j,t[T+1]=F}for(var U=0;U<160;U+=2){j=t[U],F=t[U+1];var V=u(r,n,i),H=u(w,x,S),W=h(r,w),G=h(w,r),q=d(o,C),X=d(C,o),Y=a[U],K=a[U+1],Q=c(o,l,y),Z=c(C,E,A),J=M+X|0,$=b+q+v(J,M)|0;$=($=($=$+Q+v(J=J+Z|0,Z)|0)+Y+v(J=J+K|0,K)|0)+j+v(J=J+F|0,F)|0;var ee=G+H|0,te=W+V+v(ee,G)|0;b=y,M=A,y=l,A=E,l=o,E=C,o=s+$+v(C=_+J|0,_)|0,s=i,_=S,i=n,S=x,n=r,x=w,r=$+te+v(w=J+ee|0,J)|0}this._al=this._al+w|0,this._bl=this._bl+x|0,this._cl=this._cl+S|0,this._dl=this._dl+_|0,this._el=this._el+C|0,this._fl=this._fl+E|0,this._gl=this._gl+A|0,this._hl=this._hl+M|0,this._ah=this._ah+r+v(this._al,w)|0,this._bh=this._bh+n+v(this._bl,x)|0,this._ch=this._ch+i+v(this._cl,S)|0,this._dh=this._dh+s+v(this._dl,_)|0,this._eh=this._eh+o+v(this._el,C)|0,this._fh=this._fh+l+v(this._fl,E)|0,this._gh=this._gh+y+v(this._gl,A)|0,this._hh=this._hh+b+v(this._hl,M)|0},l.prototype._hash=function(){var e=s.allocUnsafe(64);function t(t,r,n){e.writeInt32BE(t,n),e.writeInt32BE(r,n+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},t.exports=l},{"./hash":497,inherits:440,"safe-buffer":494}],505:[function(e,t,r){"use strict";t.exports=i;var n=e("events").EventEmitter;function i(){n.call(this)}e("inherits")(i,n),i.Readable=e("readable-stream/readable.js"),i.Writable=e("readable-stream/writable.js"),i.Duplex=e("readable-stream/duplex.js"),i.Transform=e("readable-stream/transform.js"),i.PassThrough=e("readable-stream/passthrough.js"),i.Stream=i,i.prototype.pipe=function(e,t){var r=this;function i(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function s(){r.readable&&r.resume&&r.resume()}r.on("data",i),e.on("drain",s),e._isStdio||t&&!1===t.end||(r.on("end",o),r.on("close",l));var a=!1;function o(){a||(a=!0,e.end())}function l(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function c(e){if(u(),0===n.listenerCount(this,"error"))throw e}function u(){r.removeListener("data",i),e.removeListener("drain",s),r.removeListener("end",o),r.removeListener("close",l),r.removeListener("error",c),e.removeListener("error",c),r.removeListener("end",u),r.removeListener("close",u),e.removeListener("close",u)}return r.on("error",c),e.on("error",c),r.on("end",u),r.on("close",u),e.on("close",u),e.emit("pipe",r),e}},{events:422,inherits:440,"readable-stream/duplex.js":507,"readable-stream/passthrough.js":516,"readable-stream/readable.js":517,"readable-stream/transform.js":518,"readable-stream/writable.js":519}],506:[function(e,t,r){"use strict";var n={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},{}],507:[function(e,t,r){"use strict";t.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":508}],508:[function(e,t,r){"use strict";var n=e("process-nextick-args"),i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=h;var s=Object.create(e("core-util-is"));s.inherits=e("inherits");var a=e("./_stream_readable"),o=e("./_stream_writable");s.inherits(h,a);for(var l=i(o.prototype),c=0;c<l.length;c++){var u=l[c];h.prototype[u]||(h.prototype[u]=o.prototype[u])}function h(e){if(!(this instanceof h))return new h(e);a.call(this,e),o.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",d)}function d(){this.allowHalfOpen||this._writableState.ended||n.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),h.prototype._destroy=function(e,t){this.push(null),this.end(),n.nextTick(t,e)}},{"./_stream_readable":510,"./_stream_writable":512,"core-util-is":383,inherits:440,"process-nextick-args":466}],509:[function(e,t,r){"use strict";t.exports=s;var n=e("./_stream_transform"),i=Object.create(e("core-util-is"));function s(e){if(!(this instanceof s))return new s(e);n.call(this,e)}i.inherits=e("inherits"),i.inherits(s,n),s.prototype._transform=function(e,t,r){r(null,e)}},{"./_stream_transform":511,"core-util-is":383,inherits:440}],510:[function(e,t,n){(function(r,n){(function(){"use strict";var i=e("process-nextick-args");t.exports=b;var s,a=e("isarray");b.ReadableState=y,e("events").EventEmitter;var o=function(e,t){return e.listeners(t).length},l=e("./internal/streams/stream"),c=e("safe-buffer").Buffer,u=(void 0!==n?n:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},h=Object.create(e("core-util-is"));h.inherits=e("inherits");var d=e("util"),f=void 0;f=d&&d.debuglog?d.debuglog("stream"):function(){};var p,m=e("./internal/streams/BufferList"),g=e("./internal/streams/destroy");h.inherits(b,l);var v=["error","close","destroy","pause","resume"];function y(t,r){t=t||{};var n=r instanceof(s=s||e("./_stream_duplex"));this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,a=t.readableHighWaterMark,o=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(a||0===a)?a:o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(p||(p=e("string_decoder/").StringDecoder),this.decoder=new p(t.encoding),this.encoding=t.encoding)}function b(t){if(s=s||e("./_stream_duplex"),!(this instanceof b))return new b(t);this._readableState=new y(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),l.call(this)}function w(e,t,r,n,i){var s,a=e._readableState;return null===t?(a.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,_(e)}}(e,a)):(i||(s=function(e,t){var r,n;return n=t,c.isBuffer(n)||n instanceof u||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}(a,t)),s?e.emit("error",s):a.objectMode||t&&t.length>0?("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===c.prototype||(t=function(e){return c.from(e)}(t)),n?a.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):x(e,a,t,!0):a.ended?e.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!r?(t=a.decoder.write(t),a.objectMode||0!==t.length?x(e,a,t,!1):E(e,a)):x(e,a,t,!1))):n||(a.reading=!1)),function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(a)}function x(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&_(e)),E(e,t)}function S(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=8388608?e=8388608:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function _(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(f("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?i.nextTick(C,e):C(e))}function C(e){f("emit readable"),e.emit("readable"),P(e)}function E(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(A,e,t))}function A(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(f("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function M(e){f("readable nexttick read 0"),e.read(0)}function T(e,t){t.reading||(f("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),P(e),t.flowing&&!t.reading&&e.read(0)}function P(e){var t=e._readableState;for(f("flow",t.flowing);t.flowing&&null!==e.read(););}function k(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;return e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;for(e-=i.length;r=r.next;){var s=r.data,a=e>s.length?s.length:e;if(a===s.length?i+=s:i+=s.slice(0,e),0===(e-=a)){a===s.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=s.slice(a));break}++n}return t.length-=n,i}(e,t):function(e,t){var r=c.allocUnsafe(e),n=t.head,i=1;for(n.data.copy(r),e-=n.data.length;n=n.next;){var s=n.data,a=e>s.length?s.length:e;if(s.copy(r,r.length-e,0,a),0===(e-=a)){a===s.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=s.slice(a));break}++i}return t.length-=i,r}(e,t),n}(e,t.buffer,t.decoder),r);var r}function D(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,i.nextTick(I,t,e))}function I(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function O(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),b.prototype.destroy=g.destroy,b.prototype._undestroy=g.undestroy,b.prototype._destroy=function(e,t){this.push(null),t(e)},b.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=c.from(e,t),t=""),r=!0),w(this,e,t,!1,r)},b.prototype.unshift=function(e){return w(this,e,null,!0,!1)},b.prototype.isPaused=function(){return!1===this._readableState.flowing},b.prototype.setEncoding=function(t){return p||(p=e("string_decoder/").StringDecoder),this._readableState.decoder=new p(t),this._readableState.encoding=t,this},b.prototype.read=function(e){f("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return f("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?D(this):_(this),null;if(0===(e=S(e,t))&&t.ended)return 0===t.length&&D(this),null;var n,i=t.needReadable;return f("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&f("length less than watermark",i=!0),t.ended||t.reading?f("reading or ended",i=!1):i&&(f("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=S(r,t))),null===(n=e>0?k(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&D(this)),null!==n&&this.emit("data",n),n},b.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},b.prototype.pipe=function(e,t){var n=this,s=this._readableState;switch(s.pipesCount){case 0:s.pipes=e;break;case 1:s.pipes=[s.pipes,e];break;default:s.pipes.push(e)}s.pipesCount+=1,f("pipe count=%d opts=%j",s.pipesCount,t);var l=t&&!1===t.end||e===r.stdout||e===r.stderr?b:u;function c(t,r){f("onunpipe"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,f("cleanup"),e.removeListener("close",v),e.removeListener("finish",y),e.removeListener("drain",h),e.removeListener("error",g),e.removeListener("unpipe",c),n.removeListener("end",u),n.removeListener("end",b),n.removeListener("data",m),d=!0,!s.awaitDrain||e._writableState&&!e._writableState.needDrain||h())}function u(){f("onend"),e.end()}s.endEmitted?i.nextTick(l):n.once("end",l),e.on("unpipe",c);var h=function(e){return function(){var t=e._readableState;f("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,P(e))}}(n);e.on("drain",h);var d=!1,p=!1;function m(t){f("ondata"),p=!1,!1!==e.write(t)||p||((1===s.pipesCount&&s.pipes===e||s.pipesCount>1&&-1!==O(s.pipes,e))&&!d&&(f("false write response, pause",s.awaitDrain),s.awaitDrain++,p=!0),n.pause())}function g(t){f("onerror",t),b(),e.removeListener("error",g),0===o(e,"error")&&e.emit("error",t)}function v(){e.removeListener("finish",y),b()}function y(){f("onfinish"),e.removeListener("close",v),b()}function b(){f("unpipe"),n.unpipe(e)}return n.on("data",m),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?a(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",g),e.once("close",v),e.once("finish",y),e.emit("pipe",n),s.flowing||(f("pipe resume"),n.resume()),e},b.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)n[s].emit("unpipe",this,{hasUnpiped:!1});return this}var a=O(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},b.prototype.on=function(e,t){var r=l.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&_(this):i.nextTick(M,this))}return r},b.prototype.addListener=b.prototype.on,b.prototype.resume=function(){var e=this._readableState;return e.flowing||(f("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(T,e,t))}(this,e)),this},b.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},b.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(f("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){f("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<v.length;s++)e.on(v[s],this.emit.bind(this,v[s]));return this._read=function(t){f("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),b._fromList=k}).call(this)}).call(this,e("_process"),"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":508,"./internal/streams/BufferList":513,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,events:422,inherits:440,isarray:506,"process-nextick-args":466,"safe-buffer":520,"string_decoder/":521,util:188}],511:[function(e,t,r){"use strict";t.exports=a;var n=e("./_stream_duplex"),i=Object.create(e("core-util-is"));function s(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function a(e){if(!(this instanceof a))return new a(e);n.call(this,e),this._transformState={afterTransform:s.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",o)}function o(){var e=this;"function"==typeof this._flush?this._flush((function(t,r){l(e,t,r)})):l(this,null,null)}function l(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=e("inherits"),i.inherits(a,n),a.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},a.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},a.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},a.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},a.prototype._destroy=function(e,t){var r=this;n.prototype._destroy.call(this,e,(function(e){t(e),r.emit("close")}))}},{"./_stream_duplex":508,"core-util-is":383,inherits:440}],512:[function(e,t,n){(function(r,n,i){(function(){"use strict";var s=e("process-nextick-args");function a(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;for(e.entry=null;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}t.exports=y;var o,l=!r.browser&&["v0.10","v0.9."].indexOf(r.version.slice(0,5))>-1?i:s.nextTick;y.WritableState=v;var c=Object.create(e("core-util-is"));c.inherits=e("inherits");var u,h={deprecate:e("util-deprecate")},d=e("./internal/streams/stream"),f=e("safe-buffer").Buffer,p=(void 0!==n?n:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},m=e("./internal/streams/destroy");function g(){}function v(t,r){o=o||e("./_stream_duplex"),t=t||{};var n=r instanceof o;this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,c=t.writableHighWaterMark,u=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(c||0===c)?c:u,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var h=!1===t.decodeStrings;this.decodeStrings=!h,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,i){--t.pendingcb,r?(s.nextTick(i,n),s.nextTick(C,e,t),e._writableState.errorEmitted=!0,e.emit("error",n)):(i(n),e._writableState.errorEmitted=!0,e.emit("error",n),C(e,t))}(e,r,n,t,i);else{var a=S(r);a||r.corked||r.bufferProcessing||!r.bufferedRequest||x(e,r),n?l(w,e,r,a,i):w(e,r,a,i)}}(r,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function y(t){if(o=o||e("./_stream_duplex"),!(u.call(y,this)||this instanceof o))return new y(t);this._writableState=new v(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),d.call(this)}function b(e,t,r,n,i,s,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function w(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),C(e,t)}function x(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),s=t.corkedRequestsFree;s.entry=r;for(var o=0,l=!0;r;)i[o]=r,r.isBuf||(l=!1),r=r.next,o+=1;i.allBuffers=l,b(e,t,!0,t.length,i,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new a(t),t.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,u=r.encoding,h=r.callback;if(b(e,t,!1,t.objectMode?1:c.length,c,u,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function S(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function _(e,t){e._final((function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),C(e,t)}))}function C(e,t){var r=S(t);return r&&(function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,s.nextTick(_,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}c.inherits(y,d),v.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(v.prototype,"buffer",{get:h.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(y,Symbol.hasInstance,{value:function(e){return!!u.call(this,e)||this===y&&e&&e._writableState instanceof v}})):u=function(e){return e instanceof this},y.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},y.prototype.write=function(e,t,r){var n,i=this._writableState,a=!1,o=!i.objectMode&&(n=e,f.isBuffer(n)||n instanceof p);return o&&!f.isBuffer(e)&&(e=function(e){return f.from(e)}(e)),"function"==typeof t&&(r=t,t=null),o?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=g),i.ended?function(e,t){var r=new Error("write after end");e.emit("error",r),s.nextTick(t,r)}(this,r):(o||function(e,t,r,n){var i=!0,a=!1;return null===r?a=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),s.nextTick(n,a),i=!1),i}(this,i,e,r))&&(i.pendingcb++,a=function(e,t,r,n,i,s){if(!r){var a=function(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=f.from(t,r)),t}(t,n,i);n!==a&&(r=!0,i="buffer",n=a)}var o=t.objectMode?1:n.length;t.length+=o;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:s,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else b(e,t,!1,o,n,i,s);return l}(this,i,o,e,t,r)),a},y.prototype.cork=function(){this._writableState.corked++},y.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||x(this,e))},y.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(y.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),y.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},y.prototype._writev=null,y.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||function(e,t,r){t.ending=!0,C(e,t),r&&(t.finished?s.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}(this,n,r)},Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),y.prototype.destroy=m.destroy,y.prototype._undestroy=m.undestroy,y.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this)}).call(this,e("_process"),"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{"./_stream_duplex":508,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,inherits:440,"process-nextick-args":466,"safe-buffer":520,timers:523,"util-deprecate":524}],513:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer,i=e("util");t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return n.alloc(0);for(var t,r,i=n.allocUnsafe(e>>>0),s=this.head,a=0;s;)t=i,r=a,s.data.copy(t,r),a+=s.data.length,s=s.next;return i},e}(),i&&i.inspect&&i.inspect.custom&&(t.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e})},{"safe-buffer":520,util:188}],514:[function(e,t,r){"use strict";var n=e("process-nextick-args");function i(e,t){e.emit("error",t)}t.exports={destroy:function(e,t){var r=this,s=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return s||a?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,n.nextTick(i,this,e)):n.nextTick(i,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?r._writableState?r._writableState.errorEmitted||(r._writableState.errorEmitted=!0,n.nextTick(i,r,e)):n.nextTick(i,r,e):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":466}],515:[function(e,t,r){arguments[4][490][0].apply(r,arguments)},{dup:490,events:422}],516:[function(e,t,r){"use strict";t.exports=e("./readable").PassThrough},{"./readable":517}],517:[function(e,t,r){"use strict";(r=t.exports=e("./lib/_stream_readable.js")).Stream=r,r.Readable=r,r.Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":508,"./lib/_stream_passthrough.js":509,"./lib/_stream_readable.js":510,"./lib/_stream_transform.js":511,"./lib/_stream_writable.js":512}],518:[function(e,t,r){"use strict";t.exports=e("./readable").Transform},{"./readable":517}],519:[function(e,t,r){"use strict";t.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":512}],520:[function(e,t,r){arguments[4][217][0].apply(r,arguments)},{buffer:220,dup:217}],521:[function(e,t,r){arguments[4][218][0].apply(r,arguments)},{dup:218,"safe-buffer":520}],522:[function(e,t,r){arguments[4][218][0].apply(r,arguments)},{dup:218,"safe-buffer":494}],523:[function(e,t,r){(function(t,n){(function(){"use strict";var i=e("process/browser.js").nextTick,s=Function.prototype.apply,a=Array.prototype.slice,o={},l=0;function c(e,t){this._id=e,this._clearFn=t}r.setTimeout=function(){return new c(s.call(setTimeout,window,arguments),clearTimeout)},r.setInterval=function(){return new c(s.call(setInterval,window,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(e){e.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},r.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},r.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},r._unrefActive=r.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},r.setImmediate="function"==typeof t?t:function(e){var t=l++,n=!(arguments.length<2)&&a.call(arguments,1);return o[t]=!0,i((function(){o[t]&&(n?e.apply(null,n):e.call(null),r.clearImmediate(t))})),t},r.clearImmediate="function"==typeof n?n:function(e){delete o[e]}}).call(this)}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":467,timers:523}],524:[function(e,t,n){(function(e){(function(){"use strict";function r(t){try{if(!e.localStorage)return!1}catch(e){return!1}var r=e.localStorage[t];return null!=r&&"true"===String(r).toLowerCase()}t.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}}).call(this)}).call(this,"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],525:[function(e,t,r){"use strict";"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],526:[function(e,t,r){"use strict";t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],527:[function(e,t,n){(function(t,r){(function(){"use strict";var i=/%[sdj%]/g;n.format=function(e){if(!v(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(o(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,s=n.length,a=String(e).replace(i,(function(e){if("%%"===e)return"%";if(r>=s)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),l=n[r];r<s;l=n[++r])m(l)||!w(l)?a+=" "+l:a+=" "+o(l);return a},n.deprecate=function(e,i){if(y(r.process))return function(){return n.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var s=!1;return function(){if(!s){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),s=!0}return e.apply(this,arguments)}};var s,a={};function o(e,t){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(t)?r.showHidden=t:t&&n._extend(r,t),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=l),u(r,e,r.depth)}function l(e,t){var r=o.styles[t];return r?"\x1b["+o.colors[r][0]+"m"+e+"\x1b["+o.colors[r][1]+"m":e}function c(e,t){return e}function u(e,t,r){if(e.customInspect&&t&&_(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(r,e);return v(i)||(i=u(e,i,r)),i}var s=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(v(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return g(t)?e.stylize(""+t,"number"):p(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}(e,t);if(s)return s;var a=Object.keys(t),o=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(t)),S(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(t);if(0===a.length){if(_(t)){var l=t.name?": "+t.name:"";return e.stylize("[Function"+l+"]","special")}if(b(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(x(t))return e.stylize(Date.prototype.toString.call(t),"date");if(S(t))return h(t)}var c,w="",C=!1,E=["{","}"];return f(t)&&(C=!0,E=["[","]"]),_(t)&&(w=" [Function"+(t.name?": "+t.name:"")+"]"),b(t)&&(w=" "+RegExp.prototype.toString.call(t)),x(t)&&(w=" "+Date.prototype.toUTCString.call(t)),S(t)&&(w=" "+h(t)),0!==a.length||C&&0!=t.length?r<0?b(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),c=C?function(e,t,r,n,i){for(var s=[],a=0,o=t.length;a<o;++a)T(t,String(a))?s.push(d(e,t,r,n,String(a),!0)):s.push("");return i.forEach((function(i){i.match(/^\d+$/)||s.push(d(e,t,r,n,i,!0))})),s}(e,t,r,o,a):a.map((function(n){return d(e,t,r,o,n,C)})),e.seen.pop(),function(e,t,r){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}(c,w,E)):E[0]+w+E[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,r,n,i,s){var a,o,l;if((l=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?o=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(o=e.stylize("[Setter]","special")),T(n,i)||(a="["+i+"]"),o||(e.seen.indexOf(l.value)<0?(o=m(r)?u(e,l.value,null):u(e,l.value,r-1)).indexOf("\n")>-1&&(o=s?o.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+o.split("\n").map((function(e){return"   "+e})).join("\n")):o=e.stylize("[Circular]","special")),y(a)){if(s&&i.match(/^\d+$/))return o;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+o}function f(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function m(e){return null===e}function g(e){return"number"==typeof e}function v(e){return"string"==typeof e}function y(e){return void 0===e}function b(e){return w(e)&&"[object RegExp]"===C(e)}function w(e){return"object"==typeof e&&null!==e}function x(e){return w(e)&&"[object Date]"===C(e)}function S(e){return w(e)&&("[object Error]"===C(e)||e instanceof Error)}function _(e){return"function"==typeof e}function C(e){return Object.prototype.toString.call(e)}function E(e){return e<10?"0"+e.toString(10):e.toString(10)}n.debuglog=function(e){if(y(s)&&(s=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!a[e])if(new RegExp("\\b"+e+"\\b","i").test(s)){var r=t.pid;a[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,r,t)}}else a[e]=function(){};return a[e]},n.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=f,n.isBoolean=p,n.isNull=m,n.isNullOrUndefined=function(e){return null==e},n.isNumber=g,n.isString=v,n.isSymbol=function(e){return"symbol"==typeof e},n.isUndefined=y,n.isRegExp=b,n.isObject=w,n.isDate=x,n.isError=S,n.isFunction=_,n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},n.isBuffer=e("./support/isBuffer");var A=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function M(){var e=new Date,t=[E(e.getHours()),E(e.getMinutes()),E(e.getSeconds())].join(":");return[e.getDate(),A[e.getMonth()],t].join(" ")}function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)}n.log=function(){console.log("%s - %s",M(),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(e,t){if(!t||!w(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}).call(this)}).call(this,e("_process"),"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":526,_process:467,inherits:525}],528:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"v1",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"v3",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"v4",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"v5",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"NIL",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"version",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"validate",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(r,"stringify",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"parse",{enumerable:!0,get:function(){return h.default}});var n=d(e("./v1.js")),i=d(e("./v3.js")),s=d(e("./v4.js")),a=d(e("./v5.js")),o=d(e("./nil.js")),l=d(e("./version.js")),c=d(e("./validate.js")),u=d(e("./stringify.js")),h=d(e("./parse.js"));function d(e){return e&&e.__esModule?e:{default:e}}},{"./nil.js":530,"./parse.js":531,"./stringify.js":535,"./v1.js":536,"./v3.js":537,"./v4.js":539,"./v5.js":540,"./validate.js":541,"./version.js":542}],529:[function(e,t,r){"use strict";function n(e){return 14+(e+64>>>9<<4)+1}function i(e,t){const r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function s(e,t,r,n,s,a){return i((o=i(i(t,e),i(n,a)))<<(l=s)|o>>>32-l,r);var o,l}function a(e,t,r,n,i,a,o){return s(t&r|~t&n,e,t,i,a,o)}function o(e,t,r,n,i,a,o){return s(t&n|r&~n,e,t,i,a,o)}function l(e,t,r,n,i,a,o){return s(t^r^n,e,t,i,a,o)}function c(e,t,r,n,i,a,o){return s(r^(t|~n),e,t,i,a,o)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){const t=[],r=32*e.length;for(let n=0;n<r;n+=8){const r=e[n>>5]>>>n%32&255,i=parseInt("0123456789abcdef".charAt(r>>>4&15)+"0123456789abcdef".charAt(15&r),16);t.push(i)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[n(t)-1]=t;let r=1732584193,s=-271733879,u=-1732584194,h=271733878;for(let n=0;n<e.length;n+=16){const t=r,d=s,f=u,p=h;r=a(r,s,u,h,e[n],7,-680876936),h=a(h,r,s,u,e[n+1],12,-389564586),u=a(u,h,r,s,e[n+2],17,606105819),s=a(s,u,h,r,e[n+3],22,-1044525330),r=a(r,s,u,h,e[n+4],7,-176418897),h=a(h,r,s,u,e[n+5],12,1200080426),u=a(u,h,r,s,e[n+6],17,-1473231341),s=a(s,u,h,r,e[n+7],22,-45705983),r=a(r,s,u,h,e[n+8],7,1770035416),h=a(h,r,s,u,e[n+9],12,-1958414417),u=a(u,h,r,s,e[n+10],17,-42063),s=a(s,u,h,r,e[n+11],22,-1990404162),r=a(r,s,u,h,e[n+12],7,1804603682),h=a(h,r,s,u,e[n+13],12,-40341101),u=a(u,h,r,s,e[n+14],17,-1502002290),s=a(s,u,h,r,e[n+15],22,1236535329),r=o(r,s,u,h,e[n+1],5,-165796510),h=o(h,r,s,u,e[n+6],9,-1069501632),u=o(u,h,r,s,e[n+11],14,643717713),s=o(s,u,h,r,e[n],20,-373897302),r=o(r,s,u,h,e[n+5],5,-701558691),h=o(h,r,s,u,e[n+10],9,38016083),u=o(u,h,r,s,e[n+15],14,-660478335),s=o(s,u,h,r,e[n+4],20,-405537848),r=o(r,s,u,h,e[n+9],5,568446438),h=o(h,r,s,u,e[n+14],9,-1019803690),u=o(u,h,r,s,e[n+3],14,-187363961),s=o(s,u,h,r,e[n+8],20,1163531501),r=o(r,s,u,h,e[n+13],5,-1444681467),h=o(h,r,s,u,e[n+2],9,-51403784),u=o(u,h,r,s,e[n+7],14,1735328473),s=o(s,u,h,r,e[n+12],20,-1926607734),r=l(r,s,u,h,e[n+5],4,-378558),h=l(h,r,s,u,e[n+8],11,-2022574463),u=l(u,h,r,s,e[n+11],16,1839030562),s=l(s,u,h,r,e[n+14],23,-35309556),r=l(r,s,u,h,e[n+1],4,-1530992060),h=l(h,r,s,u,e[n+4],11,1272893353),u=l(u,h,r,s,e[n+7],16,-155497632),s=l(s,u,h,r,e[n+10],23,-1094730640),r=l(r,s,u,h,e[n+13],4,681279174),h=l(h,r,s,u,e[n],11,-358537222),u=l(u,h,r,s,e[n+3],16,-722521979),s=l(s,u,h,r,e[n+6],23,76029189),r=l(r,s,u,h,e[n+9],4,-640364487),h=l(h,r,s,u,e[n+12],11,-421815835),u=l(u,h,r,s,e[n+15],16,530742520),s=l(s,u,h,r,e[n+2],23,-995338651),r=c(r,s,u,h,e[n],6,-198630844),h=c(h,r,s,u,e[n+7],10,1126891415),u=c(u,h,r,s,e[n+14],15,-1416354905),s=c(s,u,h,r,e[n+5],21,-57434055),r=c(r,s,u,h,e[n+12],6,1700485571),h=c(h,r,s,u,e[n+3],10,-1894986606),u=c(u,h,r,s,e[n+10],15,-1051523),s=c(s,u,h,r,e[n+1],21,-2054922799),r=c(r,s,u,h,e[n+8],6,1873313359),h=c(h,r,s,u,e[n+15],10,-30611744),u=c(u,h,r,s,e[n+6],15,-1560198380),s=c(s,u,h,r,e[n+13],21,1309151649),r=c(r,s,u,h,e[n+4],6,-145523070),h=c(h,r,s,u,e[n+11],10,-1120210379),u=c(u,h,r,s,e[n+2],15,718787259),s=c(s,u,h,r,e[n+9],21,-343485551),r=i(r,t),s=i(s,d),u=i(u,f),h=i(h,p)}return[r,s,u,h]}(function(e){if(0===e.length)return[];const t=8*e.length,r=new Uint32Array(n(t));for(let n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))};r.default=u},{}],530:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.default="00000000-0000-0000-0000-000000000000"},{}],531:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,i=(n=e("./validate.js"))&&n.__esModule?n:{default:n},s=function(e){if(!(0,i.default)(e))throw TypeError("Invalid UUID");let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};r.default=s},{"./validate.js":541}],532:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],533:[function(e,t,r){"use strict";let n;Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(i)};const i=new Uint8Array(16)},{}],534:[function(e,t,r){"use strict";function n(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:case 3:return t^r^n;case 2:return t&r^t&n^r&n}}function i(e,t){return e<<t|e>>>32-t}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=function(e){const t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const s=e.length/4+2,a=Math.ceil(s/16),o=new Array(a);for(let n=0;n<a;++n){const t=new Uint32Array(16);for(let r=0;r<16;++r)t[r]=e[64*n+4*r]<<24|e[64*n+4*r+1]<<16|e[64*n+4*r+2]<<8|e[64*n+4*r+3];o[n]=t}o[a-1][14]=8*(e.length-1)/Math.pow(2,32),o[a-1][14]=Math.floor(o[a-1][14]),o[a-1][15]=8*(e.length-1)&4294967295;for(let l=0;l<a;++l){const e=new Uint32Array(80);for(let t=0;t<16;++t)e[t]=o[l][t];for(let t=16;t<80;++t)e[t]=i(e[t-3]^e[t-8]^e[t-14]^e[t-16],1);let s=r[0],a=r[1],c=r[2],u=r[3],h=r[4];for(let r=0;r<80;++r){const o=Math.floor(r/20),l=i(s,5)+n(o,a,c,u)+h+t[o]+e[r]>>>0;h=u,u=c,c=i(a,30)>>>0,a=s,s=l}r[0]=r[0]+s>>>0,r[1]=r[1]+a>>>0,r[2]=r[2]+c>>>0,r[3]=r[3]+u>>>0,r[4]=r[4]+h>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]};r.default=s},{}],535:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,i=(n=e("./validate.js"))&&n.__esModule?n:{default:n};const s=[];for(let o=0;o<256;++o)s.push((o+256).toString(16).substr(1));var a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase();if(!(0,i.default)(r))throw TypeError("Stringified UUID is invalid");return r};r.default=a},{"./validate.js":541}],536:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("./rng.js")),i=s(e("./stringify.js"));function s(e){return e&&e.__esModule?e:{default:e}}let a,o,l=0,c=0;var u=function(e,t,r){let s=t&&r||0;const u=t||new Array(16);let h=(e=e||{}).node||a,d=void 0!==e.clockseq?e.clockseq:o;if(null==h||null==d){const t=e.random||(e.rng||n.default)();null==h&&(h=a=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==d&&(d=o=16383&(t[6]<<8|t[7]))}let f=void 0!==e.msecs?e.msecs:Date.now(),p=void 0!==e.nsecs?e.nsecs:c+1;const m=f-l+(p-c)/1e4;if(m<0&&void 0===e.clockseq&&(d=d+1&16383),(m<0||f>l)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=f,c=p,o=d,f+=122192928e5;const g=(1e4*(268435455&f)+p)%4294967296;u[s++]=g>>>24&255,u[s++]=g>>>16&255,u[s++]=g>>>8&255,u[s++]=255&g;const v=f/4294967296*1e4&268435455;u[s++]=v>>>8&255,u[s++]=255&v,u[s++]=v>>>24&15|16,u[s++]=v>>>16&255,u[s++]=d>>>8|128,u[s++]=255&d;for(let n=0;n<6;++n)u[s+n]=h[n];return t||(0,i.default)(u)};r.default=u},{"./rng.js":533,"./stringify.js":535}],537:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("./v35.js")),i=s(e("./md5.js"));function s(e){return e&&e.__esModule?e:{default:e}}var a=(0,n.default)("v3",48,i.default);r.default=a},{"./md5.js":529,"./v35.js":538}],538:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t,r){function s(e,s,a,o){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof s&&(s=(0,i.default)(s)),16!==s.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let l=new Uint8Array(16+e.length);if(l.set(s),l.set(e,s.length),l=r(l),l[6]=15&l[6]|t,l[8]=63&l[8]|128,a){o=o||0;for(let e=0;e<16;++e)a[o+e]=l[e];return a}return(0,n.default)(l)}try{s.name=e}catch(e){}return s.DNS=a,s.URL=o,s},r.URL=r.DNS=void 0;var n=s(e("./stringify.js")),i=s(e("./parse.js"));function s(e){return e&&e.__esModule?e:{default:e}}const a="6ba7b810-9dad-11d1-80b4-00c04fd430c8";r.DNS=a;const o="6ba7b811-9dad-11d1-80b4-00c04fd430c8";r.URL=o},{"./parse.js":531,"./stringify.js":535}],539:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("./rng.js")),i=s(e("./stringify.js"));function s(e){return e&&e.__esModule?e:{default:e}}var a=function(e,t,r){const s=(e=e||{}).random||(e.rng||n.default)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=s[e];return t}return(0,i.default)(s)};r.default=a},{"./rng.js":533,"./stringify.js":535}],540:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("./v35.js")),i=s(e("./sha1.js"));function s(e){return e&&e.__esModule?e:{default:e}}var a=(0,n.default)("v5",80,i.default);r.default=a},{"./sha1.js":534,"./v35.js":538}],541:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,i=(n=e("./regex.js"))&&n.__esModule?n:{default:n},s=function(e){return"string"==typeof e&&i.default.test(e)};r.default=s},{"./regex.js":532}],542:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,i=(n=e("./validate.js"))&&n.__esModule?n:{default:n},s=function(e){if(!(0,i.default)(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)};r.default=s},{"./validate.js":541}],543:[function(e,t,r){"use strict";function n(e){return e>=65&&e<=90||e>=97&&e<=122||58===e||95===e||8204===e||8205===e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}Object.defineProperty(r,"__esModule",{value:!0}),r.CHAR="\t\n\r -\ud7ff\ue000-\ufffd\ud800\udc00-\udbff\udfff",r.S=" \t\r\n",r.NAME_START_CHAR=":A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd\ud800\udc00-\udb7f\udfff",r.NAME_CHAR="-"+r.NAME_START_CHAR+".0-9\xb7\u0300-\u036f\u203f-\u2040",r.CHAR_RE=new RegExp("^["+r.CHAR+"]$","u"),r.S_RE=new RegExp("^["+r.S+"]+$","u"),r.NAME_START_CHAR_RE=new RegExp("^["+r.NAME_START_CHAR+"]$","u"),r.NAME_CHAR_RE=new RegExp("^["+r.NAME_CHAR+"]$","u"),r.NAME_RE=new RegExp("^["+r.NAME_START_CHAR+"]["+r.NAME_CHAR+"]*$","u"),r.NMTOKEN_RE=new RegExp("^["+r.NAME_CHAR+"]+$","u"),r.S_LIST=[32,10,13,9],r.isChar=function(e){return e>=32&&e<=55295||10===e||13===e||9===e||e>=57344&&e<=65533||e>=65536&&e<=1114111},r.isS=function(e){return 32===e||10===e||13===e||9===e},r.isNameStartChar=n,r.isNameChar=function(e){return n(e)||e>=48&&e<=57||45===e||46===e||183===e||e>=768&&e<=879||e>=8255&&e<=8256}},{}],544:[function(e,t,r){"use strict";function n(e){return e>=65&&e<=90||e>=97&&e<=122||58===e||95===e||8204===e||8205===e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}Object.defineProperty(r,"__esModule",{value:!0}),r.CHAR="\x01-\ud7ff\ue000-\ufffd\ud800\udc00-\udbff\udfff",r.RESTRICTED_CHAR="\x01-\b\v\f\x0e-\x1f\x7f-\x84\x86-\x9f",r.S=" \t\r\n",r.NAME_START_CHAR=":A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd\ud800\udc00-\udb7f\udfff",r.NAME_CHAR="-"+r.NAME_START_CHAR+".0-9\xb7\u0300-\u036f\u203f-\u2040",r.CHAR_RE=new RegExp("^["+r.CHAR+"]$","u"),r.RESTRICTED_CHAR_RE=new RegExp("^["+r.RESTRICTED_CHAR+"]$","u"),r.S_RE=new RegExp("^["+r.S+"]+$","u"),r.NAME_START_CHAR_RE=new RegExp("^["+r.NAME_START_CHAR+"]$","u"),r.NAME_CHAR_RE=new RegExp("^["+r.NAME_CHAR+"]$","u"),r.NAME_RE=new RegExp("^["+r.NAME_START_CHAR+"]["+r.NAME_CHAR+"]*$","u"),r.NMTOKEN_RE=new RegExp("^["+r.NAME_CHAR+"]+$","u"),r.S_LIST=[32,10,13,9],r.isChar=function(e){return e>=1&&e<=55295||e>=57344&&e<=65533||e>=65536&&e<=1114111},r.isRestrictedChar=function(e){return e>=1&&e<=8||11===e||12===e||e>=14&&e<=31||e>=127&&e<=132||e>=134&&e<=159},r.isCharAndNotRestricted=function(e){return 9===e||10===e||13===e||e>31&&e<127||133===e||e>159&&e<=55295||e>=57344&&e<=65533||e>=65536&&e<=1114111},r.isS=function(e){return 32===e||10===e||13===e||9===e},r.isNameStartChar=n,r.isNameChar=function(e){return n(e)||e>=48&&e<=57||45===e||46===e||183===e||e>=768&&e<=879||e>=8255&&e<=8256}},{}],545:[function(e,t,r){"use strict";function n(e){return e>=65&&e<=90||95===e||e>=97&&e<=122||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}Object.defineProperty(r,"__esModule",{value:!0}),r.NC_NAME_START_CHAR="A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd\ud800\udc00-\udb7f\udfff",r.NC_NAME_CHAR="-"+r.NC_NAME_START_CHAR+".0-9\xb7\u0300-\u036f\u203f-\u2040",r.NC_NAME_START_CHAR_RE=new RegExp("^["+r.NC_NAME_START_CHAR+"]$","u"),r.NC_NAME_CHAR_RE=new RegExp("^["+r.NC_NAME_CHAR+"]$","u"),r.NC_NAME_RE=new RegExp("^["+r.NC_NAME_START_CHAR+"]["+r.NC_NAME_CHAR+"]*$","u"),r.isNCNameStartChar=n,r.isNCNameChar=function(e){return n(e)||45===e||46===e||e>=48&&e<=57||183===e||e>=768&&e<=879||e>=8255&&e<=8256}},{}]},{},[15])(15)},450:function(e,t,r){var n,i,s;i=[],void 0===(s="function"===typeof(n=function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function n(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){l(n.response,t,r)},n.onerror=function(){console.error("could not download file")},n.send()}function i(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function s(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof r.g&&r.g.global===r.g?r.g:void 0,o=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(e,t,r){var o=a.URL||a.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?s(l):i(l.href)?n(e,t,r):s(l,l.target="_blank")):(l.href=o.createObjectURL(e),setTimeout((function(){o.revokeObjectURL(l.href)}),4e4),setTimeout((function(){s(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,r,a){if(r=r||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,a),r);else if(i(e))n(e,r,a);else{var o=document.createElement("a");o.href=e,o.target="_blank",setTimeout((function(){s(o)}))}}:function(e,t,r,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof e)return n(e,t,r);var s="application/octet-stream"===e.type,l=/constructor/i.test(a.HTMLElement)||a.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&l||o)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},u.readAsDataURL(e)}else{var h=a.URL||a.webkitURL,d=h.createObjectURL(e);i?i.location=d:location.href=d,i=null,setTimeout((function(){h.revokeObjectURL(d)}),4e4)}});a.saveAs=l.saveAs=l,e.exports=l})?n.apply(t,i):n)||(e.exports=s)},219:(e,t,r)=>{"use strict";var n=r(763),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},s={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};function l(e){return n.isMemo(e)?a:o[e.$$typeof]||i}o[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o[n.Memo]=a;var c=Object.defineProperty,u=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,r,n){if("string"!==typeof r){if(p){var i=f(r);i&&i!==p&&e(t,i,n)}var a=u(r);h&&(a=a.concat(h(r)));for(var o=l(t),m=l(r),g=0;g<a.length;++g){var v=a[g];if(!s[v]&&(!n||!n[v])&&(!m||!m[v])&&(!o||!o[v])){var y=d(r,v);try{c(t,v,y)}catch(b){}}}}return t}},983:(e,t)=>{"use strict";var r="function"===typeof Symbol&&Symbol.for,n=r?Symbol.for("react.element"):60103,i=r?Symbol.for("react.portal"):60106,s=r?Symbol.for("react.fragment"):60107,a=r?Symbol.for("react.strict_mode"):60108,o=r?Symbol.for("react.profiler"):60114,l=r?Symbol.for("react.provider"):60109,c=r?Symbol.for("react.context"):60110,u=r?Symbol.for("react.async_mode"):60111,h=r?Symbol.for("react.concurrent_mode"):60111,d=r?Symbol.for("react.forward_ref"):60112,f=r?Symbol.for("react.suspense"):60113,p=r?Symbol.for("react.suspense_list"):60120,m=r?Symbol.for("react.memo"):60115,g=r?Symbol.for("react.lazy"):60116,v=r?Symbol.for("react.block"):60121,y=r?Symbol.for("react.fundamental"):60117,b=r?Symbol.for("react.responder"):60118,w=r?Symbol.for("react.scope"):60119;function x(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case u:case h:case s:case o:case a:case f:return e;default:switch(e=e&&e.$$typeof){case c:case d:case g:case m:case l:return e;default:return t}}case i:return t}}}function S(e){return x(e)===h}t.AsyncMode=u,t.ConcurrentMode=h,t.ContextConsumer=c,t.ContextProvider=l,t.Element=n,t.ForwardRef=d,t.Fragment=s,t.Lazy=g,t.Memo=m,t.Portal=i,t.Profiler=o,t.StrictMode=a,t.Suspense=f,t.isAsyncMode=function(e){return S(e)||x(e)===u},t.isConcurrentMode=S,t.isContextConsumer=function(e){return x(e)===c},t.isContextProvider=function(e){return x(e)===l},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return x(e)===d},t.isFragment=function(e){return x(e)===s},t.isLazy=function(e){return x(e)===g},t.isMemo=function(e){return x(e)===m},t.isPortal=function(e){return x(e)===i},t.isProfiler=function(e){return x(e)===o},t.isStrictMode=function(e){return x(e)===a},t.isSuspense=function(e){return x(e)===f},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===s||e===h||e===o||e===a||e===f||e===p||"object"===typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===l||e.$$typeof===c||e.$$typeof===d||e.$$typeof===y||e.$$typeof===b||e.$$typeof===w||e.$$typeof===v)},t.typeOf=x},763:(e,t,r)=>{"use strict";e.exports=r(983)},65:(e,t,r)=>{var n=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,o=parseInt,l="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,c="object"==typeof self&&self&&self.Object===Object&&self,u=l||c||Function("return this")(),h=Object.prototype.toString,d=Math.max,f=Math.min,p=function(){return u.Date.now()};function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function g(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==h.call(e)}(e))return NaN;if(m(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=m(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var r=s.test(e);return r||a.test(e)?o(e.slice(2),r?2:8):i.test(e)?NaN:+e}e.exports=function(e,t,r){var n,i,s,a,o,l,c=0,u=!1,h=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var r=n,s=i;return n=i=void 0,c=t,a=e.apply(s,r)}function b(e){var r=e-l;return void 0===l||r>=t||r<0||h&&e-c>=s}function w(){var e=p();if(b(e))return x(e);o=setTimeout(w,function(e){var r=t-(e-l);return h?f(r,s-(e-c)):r}(e))}function x(e){return o=void 0,v&&n?y(e):(n=i=void 0,a)}function S(){var e=p(),r=b(e);if(n=arguments,i=this,l=e,r){if(void 0===o)return function(e){return c=e,o=setTimeout(w,t),u?y(e):a}(l);if(h)return o=setTimeout(w,t),y(l)}return void 0===o&&(o=setTimeout(w,t)),a}return t=g(t)||0,m(r)&&(u=!!r.leading,s=(h="maxWait"in r)?d(g(r.maxWait)||0,t):s,v="trailing"in r?!!r.trailing:v),S.cancel=function(){void 0!==o&&clearTimeout(o),c=0,n=l=i=o=void 0},S.flush=function(){return void 0===o?a:x(p())},S}},497:(e,t,r)=>{"use strict";var n=r(218);function i(){}function s(){}s.resetWarningCache=i,e.exports=function(){function e(e,t,r,i,s,a){if(a!==n){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:i};return r.PropTypes=r,r}},173:(e,t,r)=>{e.exports=r(497)()},218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},917:(e,t,r)=>{"use strict";var n,i,s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();t.ZX=function(e){document.body.classList.add("react-confirm-alert-body-element"),function(){if(document.getElementById("react-confirm-alert-firm-svg"))return;var e="http://www.w3.org/2000/svg",t=document.createElementNS(e,"feGaussianBlur");t.setAttribute("stdDeviation","0.3");var r=document.createElementNS(e,"filter");r.setAttribute("id","gaussian-blur"),r.appendChild(t);var n=document.createElementNS(e,"svg");n.setAttribute("id","react-confirm-alert-firm-svg"),n.setAttribute("class","react-confirm-alert-svg"),n.appendChild(r),document.body.appendChild(n)}(),function(e){var t=document.getElementById(e.targetId||m);e.targetId&&!t&&console.error("React Confirm Alert:","Can not get element id (#"+e.targetId+")");t||(document.body.children[0].classList.add("react-confirm-alert-blur"),(t=document.createElement("div")).id=m,document.body.appendChild(t)),(p=(0,u.createRoot)(t)).render(l.default.createElement(f,e))}(e)};var o=r(43),l=h(o),c=h(r(173)),u=r(391);function h(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var f=(i=n=function(e){function t(){var e,r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=Array(i),a=0;a<i;a++)s[a]=arguments[a];return r=n=d(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),n.handleClickButton=function(e){e.onClick&&e.onClick(),n.close()},n.handleClickOverlay=function(e){var t=n.props,r=t.closeOnClickOutside,i=t.onClickOutside,s=e.target===n.overlay;r&&s&&(i(),n.close()),e.stopPropagation()},n.close=function(){var e=n.props.afterClose;document.body.classList.remove("react-confirm-alert-body-element"),function(e){var t=document.getElementById(e.targetId||m);t&&p.unmount(t)}(n.props),function(e){var t=document.getElementById("react-confirm-alert-firm-svg");t&&t.parentNode.removeChild(t);document.body.children[0].classList.remove("react-confirm-alert-blur"),e()}(e)},n.keyboard=function(e){var t=n.props,r=t.closeOnEscape,i=t.onKeypressEscape,s=t.onkeyPress,a=t.keyCodeForClose,o=e.keyCode,l=27===o;a.includes(o)&&n.close(),r&&l&&(i(e),n.close()),s&&s()},n.componentDidMount=function(){document.addEventListener("keydown",n.keyboard,!1)},n.componentWillUnmount=function(){document.removeEventListener("keydown",n.keyboard,!1),n.props.willUnmount()},n.renderCustomUI=function(){var e=n.props,t=e.title,r=e.message,i=e.buttons;return(0,e.customUI)({title:t,message:r,buttons:i,onClose:n.close})},d(n,r)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,r=t.title,n=t.message,i=t.buttons,a=t.childrenElement,o=t.customUI,c=t.overlayClassName;return l.default.createElement("div",{className:"react-confirm-alert-overlay "+c,ref:function(t){return e.overlay=t},onClick:this.handleClickOverlay},l.default.createElement("div",{className:"react-confirm-alert"},o?this.renderCustomUI():l.default.createElement("div",{className:"react-confirm-alert-body"},r&&l.default.createElement("h1",null,r),n,a(),l.default.createElement("div",{className:"react-confirm-alert-button-group"},i.map((function(t,r){return l.default.createElement("button",s({key:r,className:t.className},t,{onClick:function(r){return e.handleClickButton(t)}}),t.label)}))))))}}]),t}(o.Component),n.propTypes={title:c.default.string,message:c.default.string,buttons:c.default.array.isRequired,childrenElement:c.default.func,customUI:c.default.func,closeOnClickOutside:c.default.bool,closeOnEscape:c.default.bool,keyCodeForClose:c.default.arrayOf(c.default.number),willUnmount:c.default.func,afterClose:c.default.func,onClickOutside:c.default.func,onKeypressEscape:c.default.func,onkeyPress:c.default.func,overlayClassName:c.default.string},n.defaultProps={buttons:[{label:"Cancel",onClick:function(){return null},className:null},{label:"Confirm",onClick:function(){return null},className:null}],childrenElement:function(){return null},closeOnClickOutside:!0,closeOnEscape:!0,keyCodeForClose:[],willUnmount:function(){return null},afterClose:function(){return null},onClickOutside:function(){return null},onKeypressEscape:function(){return null}},i);var p=null,m="react-confirm-alert"},4:(e,t,r)=>{"use strict";var n=r(853),i=r(43),s=r(950);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}var l=Symbol.for("react.element"),c=Symbol.for("react.transitional.element"),u=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),m=Symbol.for("react.consumer"),g=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),b=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),x=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var S=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var _=Symbol.for("react.memo_cache_sentinel"),C=Symbol.iterator;function E(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=C&&e[C]||e["@@iterator"])?e:null}var A=Symbol.for("react.client.reference");function M(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===A?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case h:return"Fragment";case u:return"Portal";case f:return"Profiler";case d:return"StrictMode";case y:return"Suspense";case b:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case g:return(e.displayName||"Context")+".Provider";case m:return(e._context.displayName||"Context")+".Consumer";case v:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case w:return null!==(t=e.displayName||null)?t:M(e.type)||"Memo";case x:t=e._payload,e=e._init;try{return M(e(t))}catch(r){}}return null}var T,P,k=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D=Object.assign;function I(e){if(void 0===T)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);T=t&&t[1]||"",P=-1<r.stack.indexOf("\n    at")?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+T+e+P}var O=!1;function R(e,t){if(!e||O)return"";O=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var n={DetermineComponentFrameRoot:function(){try{if(t){var r=function(){throw Error()};if(Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(r,[])}catch(i){var n=i}Reflect.construct(e,[],r)}else{try{r.call()}catch(s){n=s}e.call(r.prototype)}}else{try{throw Error()}catch(a){n=a}(r=e())&&"function"===typeof r.catch&&r.catch((function(){}))}}catch(o){if(o&&n&&"string"===typeof o.stack)return[o.stack,n.stack]}return[null,null]}};n.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(n.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(n.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=n.DetermineComponentFrameRoot(),a=s[0],o=s[1];if(a&&o){var l=a.split("\n"),c=o.split("\n");for(i=n=0;n<l.length&&!l[n].includes("DetermineComponentFrameRoot");)n++;for(;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;if(n===l.length||i===c.length)for(n=l.length-1,i=c.length-1;1<=n&&0<=i&&l[n]!==c[i];)i--;for(;1<=n&&0<=i;n--,i--)if(l[n]!==c[i]){if(1!==n||1!==i)do{if(n--,0>--i||l[n]!==c[i]){var u="\n"+l[n].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=n&&0<=i);break}}}finally{O=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?I(r):""}function L(e){switch(e.tag){case 26:case 27:case 5:return I(e.type);case 16:return I("Lazy");case 13:return I("Suspense");case 19:return I("SuspenseList");case 0:case 15:return e=R(e.type,!1);case 11:return e=R(e.type.render,!1);case 1:return e=R(e.type,!0);default:return""}}function N(e){try{var t="";do{t+=L(e),e=e.return}while(e);return t}catch(r){return"\nError generating stack: "+r.message+"\n"+r.stack}}function B(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function z(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function F(e){if(B(e)!==e)throw Error(a(188))}function j(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=j(e)))return t;e=e.sibling}return null}var U=Array.isArray,V=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H={pending:!1,data:null,method:null,action:null},W=[],G=-1;function q(e){return{current:e}}function X(e){0>G||(e.current=W[G],W[G]=null,G--)}function Y(e,t){G++,W[G]=e.current,e.current=t}var K=q(null),Q=q(null),Z=q(null),J=q(null);function $(e,t){switch(Y(Z,t),Y(Q,e),Y(K,null),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)&&(t=t.namespaceURI)?Qu(t):0;break;default:if(t=(e=8===e?t.parentNode:t).tagName,e=e.namespaceURI)t=Zu(e=Qu(e),t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}X(K),Y(K,t)}function ee(){X(K),X(Q),X(Z)}function te(e){null!==e.memoizedState&&Y(J,e);var t=K.current,r=Zu(t,e.type);t!==r&&(Y(Q,e),Y(K,r))}function re(e){Q.current===e&&(X(K),X(Q)),J.current===e&&(X(J),Nh._currentValue=H)}var ne=Object.prototype.hasOwnProperty,ie=n.unstable_scheduleCallback,se=n.unstable_cancelCallback,ae=n.unstable_shouldYield,oe=n.unstable_requestPaint,le=n.unstable_now,ce=n.unstable_getCurrentPriorityLevel,ue=n.unstable_ImmediatePriority,he=n.unstable_UserBlockingPriority,de=n.unstable_NormalPriority,fe=n.unstable_LowPriority,pe=n.unstable_IdlePriority,me=n.log,ge=n.unstable_setDisableYieldValue,ve=null,ye=null;function be(e){if("function"===typeof me&&ge(e),ye&&"function"===typeof ye.setStrictMode)try{ye.setStrictMode(ve,e)}catch(t){}}var we=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(xe(e)/Se|0)|0},xe=Math.log,Se=Math.LN2;var _e=128,Ce=4194304;function Ee(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194176&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ae(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=e.warmLanes;e=0!==e.finishedLanes;var o=134217727&r;return 0!==o?0!==(r=o&~i)?n=Ee(r):0!==(s&=o)?n=Ee(s):e||0!==(a=o&~a)&&(n=Ee(a)):0!==(o=r&~i)?n=Ee(o):0!==s?n=Ee(s):e||0!==(a=r&~a)&&(n=Ee(a)),0===n?0:0!==t&&t!==n&&0===(t&i)&&((i=n&-n)>=(a=t&-t)||32===i&&0!==(4194176&a))?t:n}function Me(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Te(e,t){switch(e){case 1:case 2:case 4:case 8:return t+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Pe(){var e=_e;return 0===(4194176&(_e<<=1))&&(_e=128),e}function ke(){var e=Ce;return 0===(62914560&(Ce<<=1))&&(Ce=4194304),e}function De(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ie(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Oe(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var n=31-we(t);e.entangledLanes|=t,e.entanglements[n]=1073741824|e.entanglements[n]|4194218&r}function Re(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-we(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}function Le(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Ne(){var e=V.p;return 0!==e?e:void 0===(e=window.event)?32:Zh(e.type)}var Be=Math.random().toString(36).slice(2),ze="__reactFiber$"+Be,Fe="__reactProps$"+Be,je="__reactContainer$"+Be,Ue="__reactEvents$"+Be,Ve="__reactListeners$"+Be,He="__reactHandles$"+Be,We="__reactResources$"+Be,Ge="__reactMarker$"+Be;function qe(e){delete e[ze],delete e[Fe],delete e[Ue],delete e[Ve],delete e[He]}function Xe(e){var t=e[ze];if(t)return t;for(var r=e.parentNode;r;){if(t=r[je]||r[ze]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=lh(e);null!==e;){if(r=e[ze])return r;e=lh(e)}return t}r=(e=r).parentNode}return null}function Ye(e){if(e=e[ze]||e[je]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function Ke(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(a(33))}function Qe(e){var t=e[We];return t||(t=e[We]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ze(e){e[Ge]=!0}var Je=new Set,$e={};function et(e,t){tt(e,t),tt(e+"Capture",t)}function tt(e,t){for($e[e]=t,e=0;e<t.length;e++)Je.add(t[e])}var rt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),nt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),it={},st={};function at(e,t,r){if(i=t,ne.call(st,i)||!ne.call(it,i)&&(nt.test(i)?st[i]=!0:(it[i]=!0,0)))if(null===r)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var n=t.toLowerCase().slice(0,5);if("data-"!==n&&"aria-"!==n)return void e.removeAttribute(t)}e.setAttribute(t,""+r)}var i}function ot(e,t,r){if(null===r)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+r)}}function lt(e,t,r,n){if(null===n)e.removeAttribute(r);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(r)}e.setAttributeNS(t,r,""+n)}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ut(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ht(e){e._valueTracker||(e._valueTracker=function(e){var t=ut(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function dt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=ut(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function ft(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var pt=/[\n"\\]/g;function mt(e){return e.replace(pt,(function(e){return"\\"+e.charCodeAt(0).toString(16)+" "}))}function gt(e,t,r,n,i,s,a,o){e.name="",null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.type=a:e.removeAttribute("type"),null!=t?"number"===a?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==a&&"reset"!==a||e.removeAttribute("value"),null!=t?yt(e,a,ct(t)):null!=r?yt(e,a,ct(r)):null!=n&&e.removeAttribute("value"),null==i&&null!=s&&(e.defaultChecked=!!s),null!=i&&(e.checked=i&&"function"!==typeof i&&"symbol"!==typeof i),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+ct(o):e.removeAttribute("name")}function vt(e,t,r,n,i,s,a,o){if(null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.type=s),null!=t||null!=r){if(!("submit"!==s&&"reset"!==s||void 0!==t&&null!==t))return;r=null!=r?""+ct(r):"",t=null!=t?""+ct(t):r,o||t===e.value||(e.value=t),e.defaultValue=t}n="function"!==typeof(n=null!=n?n:i)&&"symbol"!==typeof n&&!!n,e.checked=o?e.checked:!!n,e.defaultChecked=!!n,null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a&&(e.name=a)}function yt(e,t,r){"number"===t&&ft(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function bt(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ct(r),t=null,i=0;i<e.length;i++){if(e[i].value===r)return e[i].selected=!0,void(n&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function wt(e,t,r){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=r)?e.defaultValue=null!=r?""+ct(r):"":e.defaultValue!==t&&(e.defaultValue=t)}function xt(e,t,r,n){if(null==t){if(null!=n){if(null!=r)throw Error(a(92));if(U(n)){if(1<n.length)throw Error(a(93));n=n[0]}r=n}null==r&&(r=""),t=r}r=ct(t),e.defaultValue=r,(n=e.textContent)===r&&""!==n&&null!==n&&(e.value=n)}function St(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var _t=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ct(e,t,r){var n=0===t.indexOf("--");null==r||"boolean"===typeof r||""===r?n?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":n?e.setProperty(t,r):"number"!==typeof r||0===r||_t.has(t)?"float"===t?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function Et(e,t,r){if(null!=t&&"object"!==typeof t)throw Error(a(62));if(e=e.style,null!=r){for(var n in r)!r.hasOwnProperty(n)||null!=t&&t.hasOwnProperty(n)||(0===n.indexOf("--")?e.setProperty(n,""):"float"===n?e.cssFloat="":e[n]="");for(var i in t)n=t[i],t.hasOwnProperty(i)&&r[i]!==n&&Ct(e,i,n)}else for(var s in t)t.hasOwnProperty(s)&&Ct(e,s,t[s])}function At(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Tt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pt(e){return Tt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var kt=null;function Dt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var It=null,Ot=null;function Rt(e){var t=Ye(e);if(t&&(e=t.stateNode)){var r=e[Fe]||null;e:switch(e=t.stateNode,t.type){case"input":if(gt(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+mt(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=n[Fe]||null;if(!i)throw Error(a(90));gt(n,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<r.length;t++)(n=r[t]).form===e.form&&dt(n)}break e;case"textarea":wt(e,r.value,r.defaultValue);break e;case"select":null!=(t=r.value)&&bt(e,!!r.multiple,t,!1)}}}var Lt=!1;function Nt(e,t,r){if(Lt)return e(t,r);Lt=!0;try{return e(t)}finally{if(Lt=!1,(null!==It||null!==Ot)&&(zc(),It&&(t=It,e=Ot,Ot=It=null,Rt(t),e)))for(t=0;t<e.length;t++)Rt(e[t])}}function Bt(e,t){var r=e.stateNode;if(null===r)return null;var n=r[Fe]||null;if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(a(231,t,typeof r));return r}var zt=!1;if(rt)try{var Ft={};Object.defineProperty(Ft,"passive",{get:function(){zt=!0}}),window.addEventListener("test",Ft,Ft),window.removeEventListener("test",Ft,Ft)}catch(xd){zt=!1}var jt=null,Ut=null,Vt=null;function Ht(){if(Vt)return Vt;var e,t,r=Ut,n=r.length,i="value"in jt?jt.value:jt.textContent,s=i.length;for(e=0;e<n&&r[e]===i[e];e++);var a=n-e;for(t=1;t<=a&&r[n-t]===i[s-t];t++);return Vt=i.slice(e,1<t?1-t:void 0)}function Wt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Gt(){return!0}function qt(){return!1}function Xt(e){function t(t,r,n,i,s){for(var a in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?Gt:qt,this.isPropagationStopped=qt,this}return D(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Gt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Gt)},persist:function(){},isPersistent:Gt}),t}var Yt,Kt,Qt,Zt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jt=Xt(Zt),$t=D({},Zt,{view:0,detail:0}),er=Xt($t),tr=D({},$t,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:dr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Qt&&(Qt&&"mousemove"===e.type?(Yt=e.screenX-Qt.screenX,Kt=e.screenY-Qt.screenY):Kt=Yt=0,Qt=e),Yt)},movementY:function(e){return"movementY"in e?e.movementY:Kt}}),rr=Xt(tr),nr=Xt(D({},tr,{dataTransfer:0})),ir=Xt(D({},$t,{relatedTarget:0})),sr=Xt(D({},Zt,{animationName:0,elapsedTime:0,pseudoElement:0})),ar=Xt(D({},Zt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),or=Xt(D({},Zt,{data:0})),lr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ur={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=ur[e])&&!!t[e]}function dr(){return hr}var fr=Xt(D({},$t,{key:function(e){if(e.key){var t=lr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Wt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?cr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:dr,charCode:function(e){return"keypress"===e.type?Wt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Wt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),pr=Xt(D({},tr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),mr=Xt(D({},$t,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:dr})),gr=Xt(D({},Zt,{propertyName:0,elapsedTime:0,pseudoElement:0})),vr=Xt(D({},tr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),yr=Xt(D({},Zt,{newState:0,oldState:0})),br=[9,13,27,32],wr=rt&&"CompositionEvent"in window,xr=null;rt&&"documentMode"in document&&(xr=document.documentMode);var Sr=rt&&"TextEvent"in window&&!xr,_r=rt&&(!wr||xr&&8<xr&&11>=xr),Cr=String.fromCharCode(32),Er=!1;function Ar(e,t){switch(e){case"keyup":return-1!==br.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mr(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Tr=!1;var Pr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function kr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Pr[e.type]:"textarea"===t}function Dr(e,t,r,n){It?Ot?Ot.push(n):Ot=[n]:It=n,0<(t=Nu(t,"onChange")).length&&(r=new Jt("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Ir=null,Or=null;function Rr(e){Tu(e,0)}function Lr(e){if(dt(Ke(e)))return e}function Nr(e,t){if("change"===e)return t}var Br=!1;if(rt){var zr;if(rt){var Fr="oninput"in document;if(!Fr){var jr=document.createElement("div");jr.setAttribute("oninput","return;"),Fr="function"===typeof jr.oninput}zr=Fr}else zr=!1;Br=zr&&(!document.documentMode||9<document.documentMode)}function Ur(){Ir&&(Ir.detachEvent("onpropertychange",Vr),Or=Ir=null)}function Vr(e){if("value"===e.propertyName&&Lr(Or)){var t=[];Dr(t,Or,e,Dt(e)),Nt(Rr,t)}}function Hr(e,t,r){"focusin"===e?(Ur(),Or=r,(Ir=t).attachEvent("onpropertychange",Vr)):"focusout"===e&&Ur()}function Wr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Lr(Or)}function Gr(e,t){if("click"===e)return Lr(t)}function qr(e,t){if("input"===e||"change"===e)return Lr(t)}var Xr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Yr(e,t){if(Xr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!ne.call(t,i)||!Xr(e[i],t[i]))return!1}return!0}function Kr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Qr(e,t){var r,n=Kr(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Kr(n)}}function Zr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Zr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function Jr(e){for(var t=ft((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=ft((e=t.contentWindow).document)}return t}function $r(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function en(e,t){var r=Jr(t);t=e.focusedElem;var n=e.selectionRange;if(r!==t&&t&&t.ownerDocument&&Zr(t.ownerDocument.documentElement,t)){if(null!==n&&$r(t))if(e=n.start,void 0===(r=n.end)&&(r=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(r,t.value.length);else if((r=(e=t.ownerDocument||document)&&e.defaultView||window).getSelection){r=r.getSelection();var i=t.textContent.length,s=Math.min(n.start,i);n=void 0===n.end?s:Math.min(n.end,i),!r.extend&&s>n&&(i=n,n=s,s=i),i=Qr(t,s);var a=Qr(t,n);i&&a&&(1!==r.rangeCount||r.anchorNode!==i.node||r.anchorOffset!==i.offset||r.focusNode!==a.node||r.focusOffset!==a.offset)&&((e=e.createRange()).setStart(i.node,i.offset),r.removeAllRanges(),s>n?(r.addRange(e),r.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),r.addRange(e)))}for(e=[],r=t;r=r.parentNode;)1===r.nodeType&&e.push({element:r,left:r.scrollLeft,top:r.scrollTop});for("function"===typeof t.focus&&t.focus(),t=0;t<e.length;t++)(r=e[t]).element.scrollLeft=r.left,r.element.scrollTop=r.top}}var tn=rt&&"documentMode"in document&&11>=document.documentMode,rn=null,nn=null,sn=null,an=!1;function on(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;an||null==rn||rn!==ft(n)||("selectionStart"in(n=rn)&&$r(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},sn&&Yr(sn,n)||(sn=n,0<(n=Nu(nn,"onSelect")).length&&(t=new Jt("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=rn)))}function ln(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var cn={animationend:ln("Animation","AnimationEnd"),animationiteration:ln("Animation","AnimationIteration"),animationstart:ln("Animation","AnimationStart"),transitionrun:ln("Transition","TransitionRun"),transitionstart:ln("Transition","TransitionStart"),transitioncancel:ln("Transition","TransitionCancel"),transitionend:ln("Transition","TransitionEnd")},un={},hn={};function dn(e){if(un[e])return un[e];if(!cn[e])return e;var t,r=cn[e];for(t in r)if(r.hasOwnProperty(t)&&t in hn)return un[e]=r[t];return e}rt&&(hn=document.createElement("div").style,"AnimationEvent"in window||(delete cn.animationend.animation,delete cn.animationiteration.animation,delete cn.animationstart.animation),"TransitionEvent"in window||delete cn.transitionend.transition);var fn=dn("animationend"),pn=dn("animationiteration"),mn=dn("animationstart"),gn=dn("transitionrun"),vn=dn("transitionstart"),yn=dn("transitioncancel"),bn=dn("transitionend"),wn=new Map,xn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Sn(e,t){wn.set(e,t),et(t,[e])}var _n=[],Cn=0,En=0;function An(){for(var e=Cn,t=En=Cn=0;t<e;){var r=_n[t];_n[t++]=null;var n=_n[t];_n[t++]=null;var i=_n[t];_n[t++]=null;var s=_n[t];if(_n[t++]=null,null!==n&&null!==i){var a=n.pending;null===a?i.next=i:(i.next=a.next,a.next=i),n.pending=i}0!==s&&kn(r,i,s)}}function Mn(e,t,r,n){_n[Cn++]=e,_n[Cn++]=t,_n[Cn++]=r,_n[Cn++]=n,En|=n,e.lanes|=n,null!==(e=e.alternate)&&(e.lanes|=n)}function Tn(e,t,r,n){return Mn(e,t,r,n),Dn(e)}function Pn(e,t){return Mn(e,null,null,t),Dn(e)}function kn(e,t,r){e.lanes|=r;var n=e.alternate;null!==n&&(n.lanes|=r);for(var i=!1,s=e.return;null!==s;)s.childLanes|=r,null!==(n=s.alternate)&&(n.childLanes|=r),22===s.tag&&(null===(e=s.stateNode)||1&e._visibility||(i=!0)),e=s,s=s.return;i&&null!==t&&3===e.tag&&(s=e.stateNode,i=31-we(r),null===(e=(s=s.hiddenUpdates)[i])?s[i]=[t]:e.push(t),t.lane=536870912|r)}function Dn(e){if(50<Tc)throw Tc=0,Pc=null,Error(a(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var In={},On=new WeakMap;function Rn(e,t){if("object"===typeof e&&null!==e){var r=On.get(e);return void 0!==r?r:(t={value:e,source:t,stack:N(t)},On.set(e,t),t)}return{value:e,source:t,stack:N(t)}}var Ln=[],Nn=0,Bn=null,zn=0,Fn=[],jn=0,Un=null,Vn=1,Hn="";function Wn(e,t){Ln[Nn++]=zn,Ln[Nn++]=Bn,Bn=e,zn=t}function Gn(e,t,r){Fn[jn++]=Vn,Fn[jn++]=Hn,Fn[jn++]=Un,Un=e;var n=Vn;e=Hn;var i=32-we(n)-1;n&=~(1<<i),r+=1;var s=32-we(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Vn=1<<32-we(t)+i|r<<i|n,Hn=s+e}else Vn=1<<s|r<<i|n,Hn=e}function qn(e){null!==e.return&&(Wn(e,1),Gn(e,1,0))}function Xn(e){for(;e===Bn;)Bn=Ln[--Nn],Ln[Nn]=null,zn=Ln[--Nn],Ln[Nn]=null;for(;e===Un;)Un=Fn[--jn],Fn[jn]=null,Hn=Fn[--jn],Fn[jn]=null,Vn=Fn[--jn],Fn[jn]=null}var Yn=null,Kn=null,Qn=!1,Zn=null,Jn=!1,$n=Error(a(519));function ei(e){throw si(Rn(Error(a(418,"")),e)),$n}function ti(e){var t=e.stateNode,r=e.type,n=e.memoizedProps;switch(t[ze]=e,t[Fe]=n,r){case"dialog":Pu("cancel",t),Pu("close",t);break;case"iframe":case"object":case"embed":Pu("load",t);break;case"video":case"audio":for(r=0;r<Au.length;r++)Pu(Au[r],t);break;case"source":Pu("error",t);break;case"img":case"image":case"link":Pu("error",t),Pu("load",t);break;case"details":Pu("toggle",t);break;case"input":Pu("invalid",t),vt(t,n.value,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name,!0),ht(t);break;case"select":Pu("invalid",t);break;case"textarea":Pu("invalid",t),xt(t,n.value,n.defaultValue,n.children),ht(t)}"string"!==typeof(r=n.children)&&"number"!==typeof r&&"bigint"!==typeof r||t.textContent===""+r||!0===n.suppressHydrationWarning||Vu(t.textContent,r)?(null!=n.popover&&(Pu("beforetoggle",t),Pu("toggle",t)),null!=n.onScroll&&Pu("scroll",t),null!=n.onScrollEnd&&Pu("scrollend",t),null!=n.onClick&&(t.onclick=Hu),t=!0):t=!1,t||ei(e)}function ri(e){for(Yn=e.return;Yn;)switch(Yn.tag){case 3:case 27:return void(Jn=!0);case 5:case 13:return void(Jn=!1);default:Yn=Yn.return}}function ni(e){if(e!==Yn)return!1;if(!Qn)return ri(e),Qn=!0,!1;var t,r=!1;if((t=3!==e.tag&&27!==e.tag)&&((t=5===e.tag)&&(t=!("form"!==(t=e.type)&&"button"!==t)||Ju(e.type,e.memoizedProps)),t=!t),t&&(r=!0),r&&Kn&&ei(e),ri(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,r=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===r){Kn=oh(e.nextSibling);break e}r--}else"$"!==t&&"$!"!==t&&"$?"!==t||r++;e=e.nextSibling}Kn=null}}else Kn=Yn?oh(e.stateNode.nextSibling):null;return!0}function ii(){Kn=Yn=null,Qn=!1}function si(e){null===Zn?Zn=[e]:Zn.push(e)}var ai=Error(a(460)),oi=Error(a(474)),li={then:function(){}};function ci(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ui(){}function hi(e,t,r){switch(void 0===(r=e[r])?e.push(t):r!==t&&(t.then(ui,ui),t=r),t.status){case"fulfilled":return t.value;case"rejected":if((e=t.reason)===ai)throw Error(a(483));throw e;default:if("string"===typeof t.status)t.then(ui,ui);else{if(null!==(e=tc)&&100<e.shellSuspendCounter)throw Error(a(482));(e=t).status="pending",e.then((function(e){if("pending"===t.status){var r=t;r.status="fulfilled",r.value=e}}),(function(e){if("pending"===t.status){var r=t;r.status="rejected",r.reason=e}}))}switch(t.status){case"fulfilled":return t.value;case"rejected":if((e=t.reason)===ai)throw Error(a(483));throw e}throw di=t,ai}}var di=null;function fi(){if(null===di)throw Error(a(459));var e=di;return di=null,e}var pi=null,mi=0;function gi(e){var t=mi;return mi+=1,null===pi&&(pi=[]),hi(pi,e,t)}function vi(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function yi(e,t){if(t.$$typeof===l)throw Error(a(525));throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bi(e){return(0,e._init)(e._payload)}function wi(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Bl(e,t)).index=0,e.sibling=null,e}function s(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=33554434,r):n:(t.flags|=33554434,r):(t.flags|=1048576,r)}function o(t){return e&&null===t.alternate&&(t.flags|=33554434),t}function l(e,t,r,n){return null===t||6!==t.tag?((t=Vl(r,e.mode,n)).return=e,t):((t=i(t,r)).return=e,t)}function d(e,t,r,n){var s=r.type;return s===h?p(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===x&&bi(s)===t.type)?(vi(t=i(t,r.props),r),t.return=e,t):(vi(t=Fl(r.type,r.key,r.props,null,e.mode,n),r),t.return=e,t)}function f(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Hl(r,e.mode,n)).return=e,t):((t=i(t,r.children||[])).return=e,t)}function p(e,t,r,n,s){return null===t||7!==t.tag?((t=jl(r,e.mode,n,s)).return=e,t):((t=i(t,r)).return=e,t)}function m(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Vl(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case c:return vi(r=Fl(t.type,t.key,t.props,null,e.mode,r),t),r.return=e,r;case u:return(t=Hl(t,e.mode,r)).return=e,t;case x:return m(e,t=(0,t._init)(t._payload),r)}if(U(t)||E(t))return(t=jl(t,e.mode,r,null)).return=e,t;if("function"===typeof t.then)return m(e,gi(t),r);if(t.$$typeof===g)return m(e,Ao(e,t),r);yi(e,t)}return null}function v(e,t,r,n){var i=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return null!==i?null:l(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case c:return r.key===i?d(e,t,r,n):null;case u:return r.key===i?f(e,t,r,n):null;case x:return v(e,t,r=(i=r._init)(r._payload),n)}if(U(r)||E(r))return null!==i?null:p(e,t,r,n,null);if("function"===typeof r.then)return v(e,t,gi(r),n);if(r.$$typeof===g)return v(e,t,Ao(e,r),n);yi(e,r)}return null}function y(e,t,r,n,i){if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return l(t,e=e.get(r)||null,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case c:return d(t,e=e.get(null===n.key?r:n.key)||null,n,i);case u:return f(t,e=e.get(null===n.key?r:n.key)||null,n,i);case x:return y(e,t,r,n=(0,n._init)(n._payload),i)}if(U(n)||E(n))return p(t,e=e.get(r)||null,n,i,null);if("function"===typeof n.then)return y(e,t,r,gi(n),i);if(n.$$typeof===g)return y(e,t,r,Ao(t,n),i);yi(t,n)}return null}function b(l,d,f,p){if("object"===typeof f&&null!==f&&f.type===h&&null===f.key&&(f=f.props.children),"object"===typeof f&&null!==f){switch(f.$$typeof){case c:e:{for(var w=f.key;null!==d;){if(d.key===w){if((w=f.type)===h){if(7===d.tag){r(l,d.sibling),(p=i(d,f.props.children)).return=l,l=p;break e}}else if(d.elementType===w||"object"===typeof w&&null!==w&&w.$$typeof===x&&bi(w)===d.type){r(l,d.sibling),vi(p=i(d,f.props),f),p.return=l,l=p;break e}r(l,d);break}t(l,d),d=d.sibling}f.type===h?((p=jl(f.props.children,l.mode,p,f.key)).return=l,l=p):(vi(p=Fl(f.type,f.key,f.props,null,l.mode,p),f),p.return=l,l=p)}return o(l);case u:e:{for(w=f.key;null!==d;){if(d.key===w){if(4===d.tag&&d.stateNode.containerInfo===f.containerInfo&&d.stateNode.implementation===f.implementation){r(l,d.sibling),(p=i(d,f.children||[])).return=l,l=p;break e}r(l,d);break}t(l,d),d=d.sibling}(p=Hl(f,l.mode,p)).return=l,l=p}return o(l);case x:return b(l,d,f=(w=f._init)(f._payload),p)}if(U(f))return function(i,a,o,l){for(var c=null,u=null,h=a,d=a=0,f=null;null!==h&&d<o.length;d++){h.index>d?(f=h,h=null):f=h.sibling;var p=v(i,h,o[d],l);if(null===p){null===h&&(h=f);break}e&&h&&null===p.alternate&&t(i,h),a=s(p,a,d),null===u?c=p:u.sibling=p,u=p,h=f}if(d===o.length)return r(i,h),Qn&&Wn(i,d),c;if(null===h){for(;d<o.length;d++)null!==(h=m(i,o[d],l))&&(a=s(h,a,d),null===u?c=h:u.sibling=h,u=h);return Qn&&Wn(i,d),c}for(h=n(h);d<o.length;d++)null!==(f=y(h,i,d,o[d],l))&&(e&&null!==f.alternate&&h.delete(null===f.key?d:f.key),a=s(f,a,d),null===u?c=f:u.sibling=f,u=f);return e&&h.forEach((function(e){return t(i,e)})),Qn&&Wn(i,d),c}(l,d,f,p);if(E(f)){if("function"!==typeof(w=E(f)))throw Error(a(150));return function(i,o,l,c){if(null==l)throw Error(a(151));for(var u=null,h=null,d=o,f=o=0,p=null,g=l.next();null!==d&&!g.done;f++,g=l.next()){d.index>f?(p=d,d=null):p=d.sibling;var b=v(i,d,g.value,c);if(null===b){null===d&&(d=p);break}e&&d&&null===b.alternate&&t(i,d),o=s(b,o,f),null===h?u=b:h.sibling=b,h=b,d=p}if(g.done)return r(i,d),Qn&&Wn(i,f),u;if(null===d){for(;!g.done;f++,g=l.next())null!==(g=m(i,g.value,c))&&(o=s(g,o,f),null===h?u=g:h.sibling=g,h=g);return Qn&&Wn(i,f),u}for(d=n(d);!g.done;f++,g=l.next())null!==(g=y(d,i,f,g.value,c))&&(e&&null!==g.alternate&&d.delete(null===g.key?f:g.key),o=s(g,o,f),null===h?u=g:h.sibling=g,h=g);return e&&d.forEach((function(e){return t(i,e)})),Qn&&Wn(i,f),u}(l,d,f=w.call(f),p)}if("function"===typeof f.then)return b(l,d,gi(f),p);if(f.$$typeof===g)return b(l,d,Ao(l,f),p);yi(l,f)}return"string"===typeof f&&""!==f||"number"===typeof f||"bigint"===typeof f?(f=""+f,null!==d&&6===d.tag?(r(l,d.sibling),(p=i(d,f)).return=l,l=p):(r(l,d),(p=Vl(f,l.mode,p)).return=l,l=p),o(l)):r(l,d)}return function(e,t,r,n){try{mi=0;var i=b(e,t,r,n);return pi=null,i}catch(a){if(a===ai)throw a;var s=Ll(29,a,null,e.mode);return s.lanes=n,s.return=e,s}}}var xi=wi(!0),Si=wi(!1),_i=q(null),Ci=q(0);function Ei(e,t){Y(Ci,e=cc),Y(_i,t),cc=e|t.baseLanes}function Ai(){Y(Ci,cc),Y(_i,_i.current)}function Mi(){cc=Ci.current,X(_i),X(Ci)}var Ti=q(null),Pi=null;function ki(e){var t=e.alternate;Y(Ri,1&Ri.current),Y(Ti,e),null===Pi&&(null===t||null!==_i.current||null!==t.memoizedState)&&(Pi=e)}function Di(e){if(22===e.tag){if(Y(Ri,Ri.current),Y(Ti,e),null===Pi){var t=e.alternate;null!==t&&null!==t.memoizedState&&(Pi=e)}}else Ii()}function Ii(){Y(Ri,Ri.current),Y(Ti,Ti.current)}function Oi(e){X(Ti),Pi===e&&(Pi=null),X(Ri)}var Ri=q(0);function Li(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ni="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,r){e.push(r)}};this.abort=function(){t.aborted=!0,e.forEach((function(e){return e()}))}},Bi=n.unstable_scheduleCallback,zi=n.unstable_NormalPriority,Fi={$$typeof:g,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ji(){return{controller:new Ni,data:new Map,refCount:0}}function Ui(e){e.refCount--,0===e.refCount&&Bi(zi,(function(){e.controller.abort()}))}var Vi=null,Hi=0,Wi=0,Gi=null;function qi(){if(0===--Hi&&null!==Vi){null!==Gi&&(Gi.status="fulfilled");var e=Vi;Vi=null,Wi=0,Gi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Xi=k.S;k.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Vi){var r=Vi=[];Hi=0,Wi=xu(),Gi={status:"pending",value:void 0,then:function(e){r.push(e)}}}Hi++,t.then(qi,qi)}(0,t),null!==Xi&&Xi(e,t)};var Yi=q(null);function Ki(){var e=Yi.current;return null!==e?e:tc.pooledCache}function Qi(e,t){Y(Yi,null===t?Yi.current:t.pool)}function Zi(){var e=Ki();return null===e?null:{parent:Fi._currentValue,pool:e}}var Ji=0,$i=null,es=null,ts=null,rs=!1,ns=!1,is=!1,ss=0,as=0,os=null,ls=0;function cs(){throw Error(a(321))}function us(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Xr(e[r],t[r]))return!1;return!0}function hs(e,t,r,n,i,s){return Ji=s,$i=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,k.H=null===e||null===e.memoizedState?Ea:Aa,is=!1,s=r(n,i),is=!1,ns&&(s=fs(t,r,n,i)),ds(e),s}function ds(e){k.H=Ca;var t=null!==es&&null!==es.next;if(Ji=0,ts=es=$i=null,rs=!1,as=0,os=null,t)throw Error(a(300));null===e||Ha||null!==(e=e.dependencies)&&_o(e)&&(Ha=!0)}function fs(e,t,r,n){$i=e;var i=0;do{if(ns&&(os=null),as=0,ns=!1,25<=i)throw Error(a(301));if(i+=1,ts=es=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}k.H=Ma,s=t(r,n)}while(ns);return s}function ps(){var e=k.H,t=e.useState()[0];return t="function"===typeof t.then?ws(t):t,e=e.useState()[0],(null!==es?es.memoizedState:null)!==e&&($i.flags|=1024),t}function ms(){var e=0!==ss;return ss=0,e}function gs(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function vs(e){if(rs){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}rs=!1}Ji=0,ts=es=$i=null,ns=!1,as=ss=0,os=null}function ys(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ts?$i.memoizedState=ts=e:ts=ts.next=e,ts}function bs(){if(null===es){var e=$i.alternate;e=null!==e?e.memoizedState:null}else e=es.next;var t=null===ts?$i.memoizedState:ts.next;if(null!==t)ts=t,es=e;else{if(null===e){if(null===$i.alternate)throw Error(a(467));throw Error(a(310))}e={memoizedState:(es=e).memoizedState,baseState:es.baseState,baseQueue:es.baseQueue,queue:es.queue,next:null},null===ts?$i.memoizedState=ts=e:ts=ts.next=e}return ts}function ws(e){var t=as;return as+=1,null===os&&(os=[]),e=hi(os,e,t),t=$i,null===(null===ts?t.memoizedState:ts.next)&&(t=t.alternate,k.H=null===t||null===t.memoizedState?Ea:Aa),e}function xs(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return ws(e);if(e.$$typeof===g)return Eo(e)}throw Error(a(438,String(e)))}function Ss(e){var t=null,r=$i.updateQueue;if(null!==r&&(t=r.memoCache),null==t){var n=$i.alternate;null!==n&&(null!==(n=n.updateQueue)&&(null!=(n=n.memoCache)&&(t={data:n.data.map((function(e){return e.slice()})),index:0})))}if(null==t&&(t={data:[],index:0}),null===r&&(r={lastEffect:null,events:null,stores:null,memoCache:null},$i.updateQueue=r),r.memoCache=t,void 0===(r=t.data[t.index]))for(r=t.data[t.index]=Array(e),n=0;n<e;n++)r[n]=_;return t.index++,r}function _s(e,t){return"function"===typeof t?t(e):t}function Cs(e){return Es(bs(),es,e)}function Es(e,t,r){var n=e.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=r;var i=e.baseQueue,s=n.pending;if(null!==s){if(null!==i){var o=i.next;i.next=s.next,s.next=o}t.baseQueue=i=s,n.pending=null}if(s=e.baseState,null===i)e.memoizedState=s;else{var l=o=null,c=null,u=t=i.next,h=!1;do{var d=-536870913&u.lane;if(d!==u.lane?(nc&d)===d:(Ji&d)===d){var f=u.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),d===Wi&&(h=!0);else{if((Ji&f)===f){u=u.next,f===Wi&&(h=!0);continue}d={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=d,o=s):c=c.next=d,$i.lanes|=f,hc|=f}d=u.action,is&&r(s,d),s=u.hasEagerState?u.eagerState:r(s,d)}else f={lane:d,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,o=s):c=c.next=f,$i.lanes|=d,hc|=d;u=u.next}while(null!==u&&u!==t);if(null===c?o=s:c.next=l,!Xr(s,e.memoizedState)&&(Ha=!0,h&&null!==(r=Gi)))throw r;e.memoizedState=s,e.baseState=o,e.baseQueue=c,n.lastRenderedState=s}return null===i&&(n.lanes=0),[e.memoizedState,n.dispatch]}function As(e){var t=bs(),r=t.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(null!==i){r.pending=null;var o=i=i.next;do{s=e(s,o.action),o=o.next}while(o!==i);Xr(s,t.memoizedState)||(Ha=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Ms(e,t,r){var n=$i,i=bs(),s=Qn;if(s){if(void 0===r)throw Error(a(407));r=r()}else r=t();var o=!Xr((es||i).memoizedState,r);if(o&&(i.memoizedState=r,Ha=!0),i=i.queue,Js(ks.bind(null,n,i,e),[e]),i.getSnapshot!==t||o||null!==ts&&1&ts.memoizedState.tag){if(n.flags|=2048,Xs(9,Ps.bind(null,n,i,r,t),{destroy:void 0},null),null===tc)throw Error(a(349));s||0!==(60&Ji)||Ts(n,t,r)}return r}function Ts(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=$i.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},$i.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Ps(e,t,r,n){t.value=r,t.getSnapshot=n,Ds(t)&&Is(e)}function ks(e,t,r){return r((function(){Ds(t)&&Is(e)}))}function Ds(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Xr(e,r)}catch(n){return!0}}function Is(e){var t=Pn(e,2);null!==t&&Ic(t,e,2)}function Os(e){var t=ys();if("function"===typeof e){var r=e;if(e=r(),is){be(!0);try{r()}finally{be(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_s,lastRenderedState:e},t}function Rs(e,t,r,n){return e.baseState=r,Es(e,es,"function"===typeof n?n:_s)}function Ls(e,t,r,n,i){if(xa(e))throw Error(a(485));if(null!==(e=t.action)){var s={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==k.T?r(!0):s.isTransition=!1,n(s),null===(r=t.pending)?(s.next=t.pending=s,Ns(t,s)):(s.next=r.next,t.pending=r.next=s)}}function Ns(e,t){var r=t.action,n=t.payload,i=e.state;if(t.isTransition){var s=k.T,a={};k.T=a;try{var o=r(i,n),l=k.S;null!==l&&l(a,o),Bs(e,t,o)}catch(c){Fs(e,t,c)}finally{k.T=s}}else try{Bs(e,t,s=r(i,n))}catch(u){Fs(e,t,u)}}function Bs(e,t,r){null!==r&&"object"===typeof r&&"function"===typeof r.then?r.then((function(r){zs(e,t,r)}),(function(r){return Fs(e,t,r)})):zs(e,t,r)}function zs(e,t,r){t.status="fulfilled",t.value=r,js(t),e.state=r,null!==(t=e.pending)&&((r=t.next)===t?e.pending=null:(r=r.next,t.next=r,Ns(e,r)))}function Fs(e,t,r){var n=e.pending;if(e.pending=null,null!==n){n=n.next;do{t.status="rejected",t.reason=r,js(t),t=t.next}while(t!==n)}e.action=null}function js(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Us(e,t){return t}function Vs(e,t){if(Qn){var r=tc.formState;if(null!==r){e:{var n=$i;if(Qn){if(Kn){t:{for(var i=Kn,s=Jn;8!==i.nodeType;){if(!s){i=null;break t}if(null===(i=oh(i.nextSibling))){i=null;break t}}i="F!"===(s=i.data)||"F"===s?i:null}if(i){Kn=oh(i.nextSibling),n="F!"===i.data;break e}}ei(n)}n=!1}n&&(t=r[0])}}return(r=ys()).memoizedState=r.baseState=t,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Us,lastRenderedState:t},r.queue=n,r=ya.bind(null,$i,n),n.dispatch=r,n=Os(!1),s=wa.bind(null,$i,!1,n.queue),i={state:t,dispatch:null,action:e,pending:null},(n=ys()).queue=i,r=Ls.bind(null,$i,i,s,r),i.dispatch=r,n.memoizedState=e,[t,r,!1]}function Hs(e){return Ws(bs(),es,e)}function Ws(e,t,r){t=Es(e,t,Us)[0],e=Cs(_s)[0],t="object"===typeof t&&null!==t&&"function"===typeof t.then?ws(t):t;var n=bs(),i=n.queue,s=i.dispatch;return r!==n.memoizedState&&($i.flags|=2048,Xs(9,Gs.bind(null,i,r),{destroy:void 0},null)),[t,s,e]}function Gs(e,t){e.action=t}function qs(e){var t=bs(),r=es;if(null!==r)return Ws(t,r,e);bs(),t=t.memoizedState;var n=(r=bs()).queue.dispatch;return r.memoizedState=e,[t,n,!1]}function Xs(e,t,r,n){return e={tag:e,create:t,inst:r,deps:n,next:null},null===(t=$i.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},$i.updateQueue=t),null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Ys(){return bs().memoizedState}function Ks(e,t,r,n){var i=ys();$i.flags|=e,i.memoizedState=Xs(1|t,r,{destroy:void 0},void 0===n?null:n)}function Qs(e,t,r,n){var i=bs();n=void 0===n?null:n;var s=i.memoizedState.inst;null!==es&&null!==n&&us(n,es.memoizedState.deps)?i.memoizedState=Xs(t,r,s,n):($i.flags|=e,i.memoizedState=Xs(1|t,r,s,n))}function Zs(e,t){Ks(8390656,8,e,t)}function Js(e,t){Qs(2048,8,e,t)}function $s(e,t){return Qs(4,2,e,t)}function ea(e,t){return Qs(4,4,e,t)}function ta(e,t){if("function"===typeof t){e=e();var r=t(e);return function(){"function"===typeof r?r():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function ra(e,t,r){r=null!==r&&void 0!==r?r.concat([e]):null,Qs(4,4,ta.bind(null,t,e),r)}function na(){}function ia(e,t){var r=bs();t=void 0===t?null:t;var n=r.memoizedState;return null!==t&&us(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function sa(e,t){var r=bs();t=void 0===t?null:t;var n=r.memoizedState;if(null!==t&&us(t,n[1]))return n[0];if(n=e(),is){be(!0);try{e()}finally{be(!1)}}return r.memoizedState=[n,t],n}function aa(e,t,r){return void 0===r||0!==(1073741824&Ji)?e.memoizedState=t:(e.memoizedState=r,e=Dc(),$i.lanes|=e,hc|=e,r)}function oa(e,t,r,n){return Xr(r,t)?r:null!==_i.current?(e=aa(e,r,n),Xr(e,t)||(Ha=!0),e):0===(42&Ji)?(Ha=!0,e.memoizedState=r):(e=Dc(),$i.lanes|=e,hc|=e,t)}function la(e,t,r,n,i){var s=V.p;V.p=0!==s&&8>s?s:8;var a=k.T,o={};k.T=o,wa(e,!1,t,r);try{var l=i(),c=k.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)ba(e,t,function(e,t){var r=[],n={status:"pending",value:null,reason:null,then:function(e){r.push(e)}};return e.then((function(){n.status="fulfilled",n.value=t;for(var e=0;e<r.length;e++)(0,r[e])(t)}),(function(e){for(n.status="rejected",n.reason=e,e=0;e<r.length;e++)(0,r[e])(void 0)})),n}(l,n),kc());else ba(e,t,n,kc())}catch(u){ba(e,t,{then:function(){},status:"rejected",reason:u},kc())}finally{V.p=s,k.T=a}}function ca(){}function ua(e,t,r,n){if(5!==e.tag)throw Error(a(476));var i=ha(e).queue;la(e,i,t,H,null===r?ca:function(){return da(e),r(n)})}function ha(e){var t=e.memoizedState;if(null!==t)return t;var r={};return(t={memoizedState:H,baseState:H,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_s,lastRenderedState:H},next:null}).next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_s,lastRenderedState:r},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function da(e){ba(e,ha(e).next.queue,{},kc())}function fa(){return Eo(Nh)}function pa(){return bs().memoizedState}function ma(){return bs().memoizedState}function ga(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var r=kc(),n=Io(t,e=Do(r),r);return null!==n&&(Ic(n,t,r),Oo(n,t,r)),t={cache:ji()},void(e.payload=t)}t=t.return}}function va(e,t,r){var n=kc();r={lane:n,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null},xa(e)?Sa(t,r):null!==(r=Tn(e,t,r,n))&&(Ic(r,e,n),_a(r,t,n))}function ya(e,t,r){ba(e,t,r,kc())}function ba(e,t,r,n){var i={lane:n,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null};if(xa(e))Sa(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Xr(o,a))return Mn(e,t,i,0),null===tc&&An(),!1}catch(l){}if(null!==(r=Tn(e,t,i,n)))return Ic(r,e,n),_a(r,t,n),!0}return!1}function wa(e,t,r,n){if(n={lane:2,revertLane:xu(),action:n,hasEagerState:!1,eagerState:null,next:null},xa(e)){if(t)throw Error(a(479))}else null!==(t=Tn(e,r,n,2))&&Ic(t,e,2)}function xa(e){var t=e.alternate;return e===$i||null!==t&&t===$i}function Sa(e,t){ns=rs=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function _a(e,t,r){if(0!==(4194176&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,Re(e,r)}}var Ca={readContext:Eo,use:xs,useCallback:cs,useContext:cs,useEffect:cs,useImperativeHandle:cs,useLayoutEffect:cs,useInsertionEffect:cs,useMemo:cs,useReducer:cs,useRef:cs,useState:cs,useDebugValue:cs,useDeferredValue:cs,useTransition:cs,useSyncExternalStore:cs,useId:cs};Ca.useCacheRefresh=cs,Ca.useMemoCache=cs,Ca.useHostTransitionStatus=cs,Ca.useFormState=cs,Ca.useActionState=cs,Ca.useOptimistic=cs;var Ea={readContext:Eo,use:xs,useCallback:function(e,t){return ys().memoizedState=[e,void 0===t?null:t],e},useContext:Eo,useEffect:Zs,useImperativeHandle:function(e,t,r){r=null!==r&&void 0!==r?r.concat([e]):null,Ks(4194308,4,ta.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ks(4194308,4,e,t)},useInsertionEffect:function(e,t){Ks(4,2,e,t)},useMemo:function(e,t){var r=ys();t=void 0===t?null:t;var n=e();if(is){be(!0);try{e()}finally{be(!1)}}return r.memoizedState=[n,t],n},useReducer:function(e,t,r){var n=ys();if(void 0!==r){var i=r(t);if(is){be(!0);try{r(t)}finally{be(!1)}}}else i=t;return n.memoizedState=n.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},n.queue=e,e=e.dispatch=va.bind(null,$i,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},ys().memoizedState=e},useState:function(e){var t=(e=Os(e)).queue,r=ya.bind(null,$i,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:na,useDeferredValue:function(e,t){return aa(ys(),e,t)},useTransition:function(){var e=Os(!1);return e=la.bind(null,$i,e.queue,!0,!1),ys().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var n=$i,i=ys();if(Qn){if(void 0===r)throw Error(a(407));r=r()}else{if(r=t(),null===tc)throw Error(a(349));0!==(60&nc)||Ts(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Zs(ks.bind(null,n,s,e),[e]),n.flags|=2048,Xs(9,Ps.bind(null,n,s,r,t),{destroy:void 0},null),r},useId:function(){var e=ys(),t=tc.identifierPrefix;if(Qn){var r=Hn;t=":"+t+"R"+(r=(Vn&~(1<<32-we(Vn)-1)).toString(32)+r),0<(r=ss++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=ls++).toString(32)+":";return e.memoizedState=t},useCacheRefresh:function(){return ys().memoizedState=ga.bind(null,$i)}};Ea.useMemoCache=Ss,Ea.useHostTransitionStatus=fa,Ea.useFormState=Vs,Ea.useActionState=Vs,Ea.useOptimistic=function(e){var t=ys();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=wa.bind(null,$i,!0,r),r.dispatch=t,[e,t]};var Aa={readContext:Eo,use:xs,useCallback:ia,useContext:Eo,useEffect:Js,useImperativeHandle:ra,useInsertionEffect:$s,useLayoutEffect:ea,useMemo:sa,useReducer:Cs,useRef:Ys,useState:function(){return Cs(_s)},useDebugValue:na,useDeferredValue:function(e,t){return oa(bs(),es.memoizedState,e,t)},useTransition:function(){var e=Cs(_s)[0],t=bs().memoizedState;return["boolean"===typeof e?e:ws(e),t]},useSyncExternalStore:Ms,useId:pa};Aa.useCacheRefresh=ma,Aa.useMemoCache=Ss,Aa.useHostTransitionStatus=fa,Aa.useFormState=Hs,Aa.useActionState=Hs,Aa.useOptimistic=function(e,t){return Rs(bs(),0,e,t)};var Ma={readContext:Eo,use:xs,useCallback:ia,useContext:Eo,useEffect:Js,useImperativeHandle:ra,useInsertionEffect:$s,useLayoutEffect:ea,useMemo:sa,useReducer:As,useRef:Ys,useState:function(){return As(_s)},useDebugValue:na,useDeferredValue:function(e,t){var r=bs();return null===es?aa(r,e,t):oa(r,es.memoizedState,e,t)},useTransition:function(){var e=As(_s)[0],t=bs().memoizedState;return["boolean"===typeof e?e:ws(e),t]},useSyncExternalStore:Ms,useId:pa};function Ta(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:D({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}Ma.useCacheRefresh=ma,Ma.useMemoCache=Ss,Ma.useHostTransitionStatus=fa,Ma.useFormState=qs,Ma.useActionState=qs,Ma.useOptimistic=function(e,t){var r=bs();return null!==es?Rs(r,0,e,t):(r.baseState=e,[e,r.queue.dispatch])};var Pa={isMounted:function(e){return!!(e=e._reactInternals)&&B(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=kc(),i=Do(n);i.payload=t,void 0!==r&&null!==r&&(i.callback=r),null!==(t=Io(e,i,n))&&(Ic(t,e,n),Oo(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=kc(),i=Do(n);i.tag=1,i.payload=t,void 0!==r&&null!==r&&(i.callback=r),null!==(t=Io(e,i,n))&&(Ic(t,e,n),Oo(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=kc(),n=Do(r);n.tag=2,void 0!==t&&null!==t&&(n.callback=t),null!==(t=Io(e,n,r))&&(Ic(t,e,r),Oo(t,e,r))}};function ka(e,t,r,n,i,s,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,s,a):!t.prototype||!t.prototype.isPureReactComponent||(!Yr(r,n)||!Yr(i,s))}function Da(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Pa.enqueueReplaceState(t,t.state,null)}function Ia(e,t){var r=t;if("ref"in t)for(var n in r={},t)"ref"!==n&&(r[n]=t[n]);if(e=e.defaultProps)for(var i in r===t&&(r=D({},r)),e)void 0===r[i]&&(r[i]=e[i]);return r}var Oa="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function Ra(e){Oa(e)}function La(e){console.error(e)}function Na(e){Oa(e)}function Ba(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(r){setTimeout((function(){throw r}))}}function za(e,t,r){try{(0,e.onCaughtError)(r.value,{componentStack:r.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(n){setTimeout((function(){throw n}))}}function Fa(e,t,r){return(r=Do(r)).tag=3,r.payload={element:null},r.callback=function(){Ba(e,t)},r}function ja(e){return(e=Do(e)).tag=3,e}function Ua(e,t,r,n){var i=r.type.getDerivedStateFromError;if("function"===typeof i){var s=n.value;e.payload=function(){return i(s)},e.callback=function(){za(t,r,n)}}var a=r.stateNode;null!==a&&"function"===typeof a.componentDidCatch&&(e.callback=function(){za(t,r,n),"function"!==typeof i&&(null===Sc?Sc=new Set([this]):Sc.add(this));var e=n.stack;this.componentDidCatch(n.value,{componentStack:null!==e?e:""})})}var Va=Error(a(461)),Ha=!1;function Wa(e,t,r,n){t.child=null===e?Si(t,null,r,n):xi(t,e.child,r,n)}function Ga(e,t,r,n,i){r=r.render;var s=t.ref;if("ref"in n){var a={};for(var o in n)"ref"!==o&&(a[o]=n[o])}else a=n;return Co(t),n=hs(e,t,r,a,s,i),o=ms(),null===e||Ha?(Qn&&o&&qn(t),t.flags|=1,Wa(e,t,n,i),t.child):(gs(e,t,i),ho(e,t,i))}function qa(e,t,r,n,i){if(null===e){var s=r.type;return"function"!==typeof s||Nl(s)||void 0!==s.defaultProps||null!==r.compare?((e=Fl(r.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Xa(e,t,s,n,i))}if(s=e.child,!fo(e,i)){var a=s.memoizedProps;if((r=null!==(r=r.compare)?r:Yr)(a,n)&&e.ref===t.ref)return ho(e,t,i)}return t.flags|=1,(e=Bl(s,n)).ref=t.ref,e.return=t,t.child=e}function Xa(e,t,r,n,i){if(null!==e){var s=e.memoizedProps;if(Yr(s,n)&&e.ref===t.ref){if(Ha=!1,t.pendingProps=n=s,!fo(e,i))return t.lanes=e.lanes,ho(e,t,i);0!==(131072&e.flags)&&(Ha=!0)}}return Za(e,t,r,n,i)}function Ya(e,t,r){var n=t.pendingProps,i=n.children,s=0!==(2&t.stateNode._pendingVisibility),a=null!==e?e.memoizedState:null;if(Qa(e,t),"hidden"===n.mode||s){if(0!==(128&t.flags)){if(n=null!==a?a.baseLanes|r:r,null!==e){for(i=t.child=e.child,s=0;null!==i;)s=s|i.lanes|i.childLanes,i=i.sibling;t.childLanes=s&~n}else t.childLanes=0,t.child=null;return Ka(e,t,n,r)}if(0===(536870912&r))return t.lanes=t.childLanes=536870912,Ka(e,t,null!==a?a.baseLanes|r:r,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Qi(0,null!==a?a.cachePool:null),null!==a?Ei(t,a):Ai(),Di(t)}else null!==a?(Qi(0,a.cachePool),Ei(t,a),Ii(),t.memoizedState=null):(null!==e&&Qi(0,null),Ai(),Ii());return Wa(e,t,i,r),t.child}function Ka(e,t,r,n){var i=Ki();return i=null===i?null:{parent:Fi._currentValue,pool:i},t.memoizedState={baseLanes:r,cachePool:i},null!==e&&Qi(0,null),Ai(),Di(t),null!==e&&So(e,t,n,!0),null}function Qa(e,t){var r=t.ref;if(null===r)null!==e&&null!==e.ref&&(t.flags|=2097664);else{if("function"!==typeof r&&"object"!==typeof r)throw Error(a(284));null!==e&&e.ref===r||(t.flags|=2097664)}}function Za(e,t,r,n,i){return Co(t),r=hs(e,t,r,n,void 0,i),n=ms(),null===e||Ha?(Qn&&n&&qn(t),t.flags|=1,Wa(e,t,r,i),t.child):(gs(e,t,i),ho(e,t,i))}function Ja(e,t,r,n,i,s){return Co(t),t.updateQueue=null,r=fs(t,n,r,i),ds(e),n=ms(),null===e||Ha?(Qn&&n&&qn(t),t.flags|=1,Wa(e,t,r,s),t.child):(gs(e,t,s),ho(e,t,s))}function $a(e,t,r,n,i){if(Co(t),null===t.stateNode){var s=In,a=r.contextType;"object"===typeof a&&null!==a&&(s=Eo(a)),s=new r(n,s),t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,s.updater=Pa,t.stateNode=s,s._reactInternals=t,(s=t.stateNode).props=n,s.state=t.memoizedState,s.refs={},Po(t),a=r.contextType,s.context="object"===typeof a&&null!==a?Eo(a):In,s.state=t.memoizedState,"function"===typeof(a=r.getDerivedStateFromProps)&&(Ta(t,r,a,n),s.state=t.memoizedState),"function"===typeof r.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(a=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),a!==s.state&&Pa.enqueueReplaceState(s,s.state,null),Bo(t,n,s,i),No(),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308),n=!0}else if(null===e){s=t.stateNode;var o=t.memoizedProps,l=Ia(r,o);s.props=l;var c=s.context,u=r.contextType;a=In,"object"===typeof u&&null!==u&&(a=Eo(u));var h=r.getDerivedStateFromProps;u="function"===typeof h||"function"===typeof s.getSnapshotBeforeUpdate,o=t.pendingProps!==o,u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o||c!==a)&&Da(t,s,n,a),To=!1;var d=t.memoizedState;s.state=d,Bo(t,n,s,i),No(),c=t.memoizedState,o||d!==c||To?("function"===typeof h&&(Ta(t,r,h,n),c=t.memoizedState),(l=To||ka(t,r,l,n,d,c,a))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=a,n=l):("function"===typeof s.componentDidMount&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,ko(e,t),u=Ia(r,a=t.memoizedProps),s.props=u,h=t.pendingProps,d=s.context,c=r.contextType,l=In,"object"===typeof c&&null!==c&&(l=Eo(c)),(c="function"===typeof(o=r.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==h||d!==l)&&Da(t,s,n,l),To=!1,d=t.memoizedState,s.state=d,Bo(t,n,s,i),No();var f=t.memoizedState;a!==h||d!==f||To||null!==e&&null!==e.dependencies&&_o(e.dependencies)?("function"===typeof o&&(Ta(t,r,o,n),f=t.memoizedState),(u=To||ka(t,r,u,n,d,f,l)||null!==e&&null!==e.dependencies&&_o(e.dependencies))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(n,f,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,f,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),s.props=n,s.state=f,s.context=l,n=u):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return s=n,Qa(e,t),n=0!==(128&t.flags),s||n?(s=t.stateNode,r=n&&"function"!==typeof r.getDerivedStateFromError?null:s.render(),t.flags|=1,null!==e&&n?(t.child=xi(t,e.child,null,i),t.child=xi(t,null,r,i)):Wa(e,t,r,i),t.memoizedState=s.state,e=t.child):e=ho(e,t,i),e}function eo(e,t,r,n){return ii(),t.flags|=256,Wa(e,t,r,n),t.child}var to={dehydrated:null,treeContext:null,retryLane:0};function ro(e){return{baseLanes:e,cachePool:Zi()}}function no(e,t,r){return e=null!==e?e.childLanes&~r:0,t&&(e|=pc),e}function io(e,t,r){var n,i=t.pendingProps,s=!1,o=0!==(128&t.flags);if((n=o)||(n=(null===e||null!==e.memoizedState)&&0!==(2&Ri.current)),n&&(s=!0,t.flags&=-129),n=0!==(32&t.flags),t.flags&=-33,null===e){if(Qn){if(s?ki(t):Ii(),Qn){var l,c=Kn;if(l=c){e:{for(l=c,c=Jn;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=oh(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Un?{id:Vn,overflow:Hn}:null,retryLane:536870912},(l=Ll(18,null,null,0)).stateNode=c,l.return=t,t.child=l,Yn=t,Kn=null,l=!0):l=!1}l||ei(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return"$!"===c.data?t.lanes=16:t.lanes=536870912,null;Oi(t)}return c=i.children,i=i.fallback,s?(Ii(),c=ao({mode:"hidden",children:c},s=t.mode),i=jl(i,s,r,null),c.return=t,i.return=t,c.sibling=i,t.child=c,(s=t.child).memoizedState=ro(r),s.childLanes=no(e,n,r),t.memoizedState=to,i):(ki(t),so(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(o)256&t.flags?(ki(t),t.flags&=-257,t=oo(e,t,r)):null!==t.memoizedState?(Ii(),t.child=e.child,t.flags|=128,t=null):(Ii(),s=i.fallback,c=t.mode,i=ao({mode:"visible",children:i.children},c),(s=jl(s,c,r,null)).flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,xi(t,e.child,null,r),(i=t.child).memoizedState=ro(r),i.childLanes=no(e,n,r),t.memoizedState=to,t=s);else if(ki(t),"$!"===c.data){if(n=c.nextSibling&&c.nextSibling.dataset)var u=n.dgst;n=u,(i=Error(a(419))).stack="",i.digest=n,si({value:i,source:null,stack:null}),t=oo(e,t,r)}else if(Ha||So(e,t,r,!1),n=0!==(r&e.childLanes),Ha||n){if(null!==(n=tc)){if(0!==(42&(i=r&-r)))i=1;else switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=64;break;case 268435456:i=134217728;break;default:i=0}if(0!==(i=0!==(i&(n.suspendedLanes|r))?0:i)&&i!==l.retryLane)throw l.retryLane=i,Pn(e,i),Ic(n,e,i),Va}"$?"===c.data||Wc(),t=oo(e,t,r)}else"$?"===c.data?(t.flags|=128,t.child=e.child,t=ou.bind(null,e),c._reactRetry=t,t=null):(e=l.treeContext,Kn=oh(c.nextSibling),Yn=t,Qn=!0,Zn=null,Jn=!1,null!==e&&(Fn[jn++]=Vn,Fn[jn++]=Hn,Fn[jn++]=Un,Vn=e.id,Hn=e.overflow,Un=t),(t=so(t,i.children)).flags|=4096);return t}return s?(Ii(),s=i.fallback,c=t.mode,u=(l=e.child).sibling,(i=Bl(l,{mode:"hidden",children:i.children})).subtreeFlags=31457280&l.subtreeFlags,null!==u?s=Bl(u,s):(s=jl(s,c,r,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,null===(c=e.child.memoizedState)?c=ro(r):(null!==(l=c.cachePool)?(u=Fi._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=Zi(),c={baseLanes:c.baseLanes|r,cachePool:l}),s.memoizedState=c,s.childLanes=no(e,n,r),t.memoizedState=to,i):(ki(t),e=(r=e.child).sibling,(r=Bl(r,{mode:"visible",children:i.children})).return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r)}function so(e,t){return(t=ao({mode:"visible",children:t},e.mode)).return=e,e.child=t}function ao(e,t){return Ul(e,t,0,null)}function oo(e,t,r){return xi(t,e.child,null,r),(e=so(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function lo(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),wo(e.return,t,r)}function co(e,t,r,n,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function uo(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Wa(e,t,n.children,r),0!==(2&(n=Ri.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&lo(e,r,t);else if(19===e.tag)lo(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}switch(Y(Ri,n),i){case"forwards":for(r=t.child,i=null;null!==r;)null!==(e=r.alternate)&&null===Li(e)&&(i=r),r=r.sibling;null===(r=i)?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),co(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Li(e)){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}co(t,!0,r,null,s);break;case"together":co(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ho(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),hc|=t.lanes,0===(r&t.childLanes)){if(null===e)return null;if(So(e,t,r,!1),0===(r&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(r=Bl(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Bl(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function fo(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!_o(e))}function po(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ha=!0;else{if(!fo(e,r)&&0===(128&t.flags))return Ha=!1,function(e,t,r){switch(t.tag){case 3:$(t,t.stateNode.containerInfo),yo(t,Fi,e.memoizedState.cache),ii();break;case 27:case 5:te(t);break;case 4:$(t,t.stateNode.containerInfo);break;case 10:yo(t,t.type,t.memoizedProps.value);break;case 13:var n=t.memoizedState;if(null!==n)return null!==n.dehydrated?(ki(t),t.flags|=128,null):0!==(r&t.child.childLanes)?io(e,t,r):(ki(t),null!==(e=ho(e,t,r))?e.sibling:null);ki(t);break;case 19:var i=0!==(128&e.flags);if((n=0!==(r&t.childLanes))||(So(e,t,r,!1),n=0!==(r&t.childLanes)),i){if(n)return uo(e,t,r);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Y(Ri,Ri.current),n)break;return null;case 22:case 23:return t.lanes=0,Ya(e,t,r);case 24:yo(t,Fi,e.memoizedState.cache)}return ho(e,t,r)}(e,t,r);Ha=0!==(131072&e.flags)}else Ha=!1,Qn&&0!==(1048576&t.flags)&&Gn(t,zn,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var n=t.elementType,i=n._init;if(n=i(n._payload),t.type=n,"function"!==typeof n){if(void 0!==n&&null!==n){if((i=n.$$typeof)===v){t.tag=11,t=Ga(null,t,n,e,r);break e}if(i===w){t.tag=14,t=qa(null,t,n,e,r);break e}}throw t=M(n)||n,Error(a(306,t,""))}Nl(n)?(e=Ia(n,e),t.tag=1,t=$a(null,t,n,e,r)):(t.tag=0,t=Za(null,t,n,e,r))}return t;case 0:return Za(e,t,t.type,t.pendingProps,r);case 1:return $a(e,t,n=t.type,i=Ia(n,t.pendingProps),r);case 3:e:{if($(t,t.stateNode.containerInfo),null===e)throw Error(a(387));var s=t.pendingProps;n=(i=t.memoizedState).element,ko(e,t),Bo(t,s,null,r);var o=t.memoizedState;if(s=o.cache,yo(t,Fi,s),s!==i.cache&&xo(t,[Fi],r,!0),No(),s=o.element,i.isDehydrated){if(i={element:s,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=eo(e,t,s,r);break e}if(s!==n){si(n=Rn(Error(a(424)),t)),t=eo(e,t,s,r);break e}for(Kn=oh(t.stateNode.containerInfo.firstChild),Yn=t,Qn=!0,Zn=null,Jn=!0,r=Si(t,null,s,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(ii(),s===n){t=ho(e,t,r);break e}Wa(e,t,s,r)}t=t.child}return t;case 26:return Qa(e,t),null===e?(r=gh(t.type,null,t.pendingProps,null))?t.memoizedState=r:Qn||(r=t.type,e=t.pendingProps,(n=Ku(Z.current).createElement(r))[ze]=t,n[Fe]=e,qu(n,r,e),Ze(n),t.stateNode=n):t.memoizedState=gh(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return te(t),null===e&&Qn&&(n=t.stateNode=ch(t.type,t.pendingProps,Z.current),Yn=t,Jn=!0,Kn=oh(n.firstChild)),n=t.pendingProps.children,null!==e||Qn?Wa(e,t,n,r):t.child=xi(t,null,n,r),Qa(e,t),t.child;case 5:return null===e&&Qn&&((i=n=Kn)&&(null!==(n=function(e,t,r,n){for(;1===e.nodeType;){var i=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!n&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(n){if(!e[Ge])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(s=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(s!==i.rel||e.getAttribute("href")!==(null==i.href?null:i.href)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin)||e.getAttribute("title")!==(null==i.title?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((s=e.getAttribute("src"))!==(null==i.src?null:i.src)||e.getAttribute("type")!==(null==i.type?null:i.type)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var s=null==i.name?null:""+i.name;if("hidden"===i.type&&e.getAttribute("name")===s)return e}if(null===(e=oh(e.nextSibling)))break}return null}(n,t.type,t.pendingProps,Jn))?(t.stateNode=n,Yn=t,Kn=oh(n.firstChild),Jn=!1,i=!0):i=!1),i||ei(t)),te(t),i=t.type,s=t.pendingProps,o=null!==e?e.memoizedProps:null,n=s.children,Ju(i,s)?n=null:null!==o&&Ju(i,o)&&(t.flags|=32),null!==t.memoizedState&&(i=hs(e,t,ps,null,null,r),Nh._currentValue=i),Qa(e,t),Wa(e,t,n,r),t.child;case 6:return null===e&&Qn&&((e=r=Kn)&&(null!==(r=function(e,t,r){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!r)return null;if(null===(e=oh(e.nextSibling)))return null}return e}(r,t.pendingProps,Jn))?(t.stateNode=r,Yn=t,Kn=null,e=!0):e=!1),e||ei(t)),null;case 13:return io(e,t,r);case 4:return $(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=xi(t,null,n,r):Wa(e,t,n,r),t.child;case 11:return Ga(e,t,t.type,t.pendingProps,r);case 7:return Wa(e,t,t.pendingProps,r),t.child;case 8:case 12:return Wa(e,t,t.pendingProps.children,r),t.child;case 10:return n=t.pendingProps,yo(t,t.type,n.value),Wa(e,t,n.children,r),t.child;case 9:return i=t.type._context,n=t.pendingProps.children,Co(t),n=n(i=Eo(i)),t.flags|=1,Wa(e,t,n,r),t.child;case 14:return qa(e,t,t.type,t.pendingProps,r);case 15:return Xa(e,t,t.type,t.pendingProps,r);case 19:return uo(e,t,r);case 22:return Ya(e,t,r);case 24:return Co(t),n=Eo(Fi),null===e?(null===(i=Ki())&&(i=tc,s=ji(),i.pooledCache=s,s.refCount++,null!==s&&(i.pooledCacheLanes|=r),i=s),t.memoizedState={parent:n,cache:i},Po(t),yo(t,Fi,i)):(0!==(e.lanes&r)&&(ko(e,t),Bo(t,null,null,r),No()),i=e.memoizedState,s=t.memoizedState,i.parent!==n?(i={parent:n,cache:n},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),yo(t,Fi,n)):(n=s.cache,yo(t,Fi,n),n!==i.cache&&xo(t,[Fi],r,!0))),Wa(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(a(156,t.tag))}var mo=q(null),go=null,vo=null;function yo(e,t,r){Y(mo,t._currentValue),t._currentValue=r}function bo(e){e._currentValue=mo.current,X(mo)}function wo(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function xo(e,t,r,n){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var s=i.dependencies;if(null!==s){var o=i.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=r,null!==(l=s.alternate)&&(l.lanes|=r),wo(s.return,r,e),n||(o=null);break e}s=l.next}}else if(18===i.tag){if(null===(o=i.return))throw Error(a(341));o.lanes|=r,null!==(s=o.alternate)&&(s.lanes|=r),wo(o,r,e),o=null}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===e){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}}function So(e,t,r,n){e=null;for(var i=t,s=!1;null!==i;){if(!s)if(0!==(524288&i.flags))s=!0;else if(0!==(262144&i.flags))break;if(10===i.tag){var o=i.alternate;if(null===o)throw Error(a(387));if(null!==(o=o.memoizedProps)){var l=i.type;Xr(i.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(i===J.current){if(null===(o=i.alternate))throw Error(a(387));o.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(Nh):e=[Nh])}i=i.return}null!==e&&xo(t,e,r,n),t.flags|=262144}function _o(e){for(e=e.firstContext;null!==e;){if(!Xr(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Co(e){go=e,vo=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Eo(e){return Mo(go,e)}function Ao(e,t){return null===go&&Co(e),Mo(e,t)}function Mo(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},null===vo){if(null===e)throw Error(a(308));vo=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else vo=vo.next=t;return r}var To=!1;function Po(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ko(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Do(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Io(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&ec)){var i=n.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),n.pending=t,t=Dn(e),kn(e,null,r),t}return Mn(e,n,t,r),Dn(e)}function Oo(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194176&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,Re(e,r)}}function Ro(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var i=null,s=null;if(null!==(r=r.firstBaseUpdate)){do{var a={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};null===s?i=s=a:s=s.next=a,r=r.next}while(null!==r);null===s?i=s=t:s=s.next=t}else i=s=t;return r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,callbacks:n.callbacks},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var Lo=!1;function No(){if(Lo){if(null!==Gi)throw Gi}}function Bo(e,t,r,n){Lo=!1;var i=e.updateQueue;To=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?s=c:a.next=c,a=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=i.baseState;for(a=0,u=c=l=null,o=s;;){var d=-536870913&o.lane,f=d!==o.lane;if(f?(nc&d)===d:(n&d)===d){0!==d&&d===Wi&&(Lo=!0),null!==u&&(u=u.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var p=e,m=o;d=t;var g=r;switch(m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(g,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(g,h,d):p)||void 0===d)break e;h=D({},h,d);break e;case 2:To=!0}}null!==(d=o.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=i.callbacks)?i.callbacks=[d]:f.push(d))}else f={lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,a|=d;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(f=o).next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null===s&&(i.shared.lanes=0),hc|=a,e.lanes=a,e.memoizedState=h}}function zo(e,t){if("function"!==typeof e)throw Error(a(191,e));e.call(t)}function Fo(e,t){var r=e.callbacks;if(null!==r)for(e.callbacks=null,e=0;e<r.length;e++)zo(r[e],t)}function jo(e,t){try{var r=t.updateQueue,n=null!==r?r.lastEffect:null;if(null!==n){var i=n.next;r=i;do{if((r.tag&e)===e){n=void 0;var s=r.create,a=r.inst;n=s(),a.destroy=n}r=r.next}while(r!==i)}}catch(o){nu(t,t.return,o)}}function Uo(e,t,r){try{var n=t.updateQueue,i=null!==n?n.lastEffect:null;if(null!==i){var s=i.next;n=s;do{if((n.tag&e)===e){var a=n.inst,o=a.destroy;if(void 0!==o){a.destroy=void 0,i=t;var l=r;try{o()}catch(c){nu(i,l,c)}}}n=n.next}while(n!==s)}}catch(c){nu(t,t.return,c)}}function Vo(e){var t=e.updateQueue;if(null!==t){var r=e.stateNode;try{Fo(t,r)}catch(n){nu(e,e.return,n)}}}function Ho(e,t,r){r.props=Ia(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(n){nu(e,t,n)}}function Wo(e,t){try{var r=e.ref;if(null!==r){var n=e.stateNode;switch(e.tag){case 26:case 27:case 5:var i=n;break;default:i=n}"function"===typeof r?e.refCleanup=r(i):r.current=i}}catch(s){nu(e,t,s)}}function Go(e,t){var r=e.ref,n=e.refCleanup;if(null!==r)if("function"===typeof n)try{n()}catch(i){nu(e,t,i)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof r)try{r(null)}catch(s){nu(e,t,s)}else r.current=null}function qo(e){var t=e.type,r=e.memoizedProps,n=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&n.focus();break e;case"img":r.src?n.src=r.src:r.srcSet&&(n.srcset=r.srcSet)}}catch(i){nu(e,e.return,i)}}function Xo(e,t,r){try{var n=e.stateNode;!function(e,t,r,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,s=null,o=null,l=null,c=null,u=null,h=null;for(p in r){var d=r[p];if(r.hasOwnProperty(p)&&null!=d)switch(p){case"checked":case"value":break;case"defaultValue":c=d;default:n.hasOwnProperty(p)||Wu(e,t,p,null,n,d)}}for(var f in n){var p=n[f];if(d=r[f],n.hasOwnProperty(f)&&(null!=p||null!=d))switch(f){case"type":s=p;break;case"name":i=p;break;case"checked":u=p;break;case"defaultChecked":h=p;break;case"value":o=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(a(137,t));break;default:p!==d&&Wu(e,t,f,p,n,d)}}return void gt(e,o,l,c,u,h,s,i);case"select":for(s in p=o=l=f=null,r)if(c=r[s],r.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":p=c;default:n.hasOwnProperty(s)||Wu(e,t,s,null,n,c)}for(i in n)if(s=n[i],c=r[i],n.hasOwnProperty(i)&&(null!=s||null!=c))switch(i){case"value":f=s;break;case"defaultValue":l=s;break;case"multiple":o=s;default:s!==c&&Wu(e,t,i,s,n,c)}return t=l,r=o,n=p,void(null!=f?bt(e,!!r,f,!1):!!n!==!!r&&(null!=t?bt(e,!!r,t,!0):bt(e,!!r,r?[]:"",!1)));case"textarea":for(l in p=f=null,r)if(i=r[l],r.hasOwnProperty(l)&&null!=i&&!n.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Wu(e,t,l,null,n,i)}for(o in n)if(i=n[o],s=r[o],n.hasOwnProperty(o)&&(null!=i||null!=s))switch(o){case"value":f=i;break;case"defaultValue":p=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(a(91));break;default:i!==s&&Wu(e,t,o,i,n,s)}return void wt(e,f,p);case"option":for(var m in r)if(f=r[m],r.hasOwnProperty(m)&&null!=f&&!n.hasOwnProperty(m))if("selected"===m)e.selected=!1;else Wu(e,t,m,null,n,f);for(c in n)if(f=n[c],p=r[c],n.hasOwnProperty(c)&&f!==p&&(null!=f||null!=p))if("selected"===c)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else Wu(e,t,c,f,n,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in r)f=r[g],r.hasOwnProperty(g)&&null!=f&&!n.hasOwnProperty(g)&&Wu(e,t,g,null,n,f);for(u in n)if(f=n[u],p=r[u],n.hasOwnProperty(u)&&f!==p&&(null!=f||null!=p))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(a(137,t));break;default:Wu(e,t,u,f,n,p)}return;default:if(At(t)){for(var v in r)f=r[v],r.hasOwnProperty(v)&&void 0!==f&&!n.hasOwnProperty(v)&&Gu(e,t,v,void 0,n,f);for(h in n)f=n[h],p=r[h],!n.hasOwnProperty(h)||f===p||void 0===f&&void 0===p||Gu(e,t,h,f,n,p);return}}for(var y in r)f=r[y],r.hasOwnProperty(y)&&null!=f&&!n.hasOwnProperty(y)&&Wu(e,t,y,null,n,f);for(d in n)f=n[d],p=r[d],!n.hasOwnProperty(d)||f===p||null==f&&null==p||Wu(e,t,d,f,n,p)}(n,e.type,r,t),n[Fe]=t}catch(i){nu(e,e.return,i)}}function Yo(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag||4===e.tag}function Ko(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Yo(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&27!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Qo(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Hu));else if(4!==n&&27!==n&&null!==(e=e.child))for(Qo(e,t,r),e=e.sibling;null!==e;)Qo(e,t,r),e=e.sibling}function Zo(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&27!==n&&null!==(e=e.child))for(Zo(e,t,r),e=e.sibling;null!==e;)Zo(e,t,r),e=e.sibling}var Jo=!1,$o=!1,el=!1,tl="function"===typeof WeakSet?WeakSet:Set,rl=null,nl=!1;function il(e,t,r){var n=r.flags;switch(r.tag){case 0:case 11:case 15:vl(e,r),4&n&&jo(5,r);break;case 1:if(vl(e,r),4&n)if(e=r.stateNode,null===t)try{e.componentDidMount()}catch(o){nu(r,r.return,o)}else{var i=Ia(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(l){nu(r,r.return,l)}}64&n&&Vo(r),512&n&&Wo(r,r.return);break;case 3:if(vl(e,r),64&n&&null!==(n=r.updateQueue)){if(e=null,null!==r.child)switch(r.child.tag){case 27:case 5:case 1:e=r.child.stateNode}try{Fo(n,e)}catch(o){nu(r,r.return,o)}}break;case 26:vl(e,r),512&n&&Wo(r,r.return);break;case 27:case 5:vl(e,r),null===t&&4&n&&qo(r),512&n&&Wo(r,r.return);break;case 12:default:vl(e,r);break;case 13:vl(e,r),4&n&&ul(e,r);break;case 22:if(!(i=null!==r.memoizedState||Jo)){t=null!==t&&null!==t.memoizedState||$o;var s=Jo,a=$o;Jo=i,($o=t)&&!a?bl(e,r,0!==(8772&r.subtreeFlags)):vl(e,r),Jo=s,$o=a}512&n&&("manual"===r.memoizedProps.mode?Wo(r,r.return):Go(r,r.return))}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&qe(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var al=null,ol=!1;function ll(e,t,r){for(r=r.child;null!==r;)cl(e,t,r),r=r.sibling}function cl(e,t,r){if(ye&&"function"===typeof ye.onCommitFiberUnmount)try{ye.onCommitFiberUnmount(ve,r)}catch(a){}switch(r.tag){case 26:$o||Go(r,t),ll(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode).parentNode.removeChild(r);break;case 27:$o||Go(r,t);var n=al,i=ol;for(al=r.stateNode,ll(e,t,r),t=(r=r.stateNode).attributes;t.length;)r.removeAttributeNode(t[0]);qe(r),al=n,ol=i;break;case 5:$o||Go(r,t);case 6:i=al;var s=ol;if(al=null,ll(e,t,r),ol=s,null!==(al=i))if(ol)try{e=al,n=r.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)}catch(o){nu(r,t,o)}else try{al.removeChild(r.stateNode)}catch(o){nu(r,t,o)}break;case 18:null!==al&&(ol?(t=al,r=r.stateNode,8===t.nodeType?sh(t.parentNode,r):1===t.nodeType&&sh(t,r),md(t)):sh(al,r.stateNode));break;case 4:n=al,i=ol,al=r.stateNode.containerInfo,ol=!0,ll(e,t,r),al=n,ol=i;break;case 0:case 11:case 14:case 15:$o||Uo(2,r,t),$o||Uo(4,r,t),ll(e,t,r);break;case 1:$o||(Go(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount&&Ho(r,t,n)),ll(e,t,r);break;case 21:ll(e,t,r);break;case 22:$o||Go(r,t),$o=(n=$o)||null!==r.memoizedState,ll(e,t,r),$o=n;break;default:ll(e,t,r)}}function ul(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{md(e)}catch(r){nu(t,t.return,r)}}function hl(e,t){var r=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new tl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new tl),t;default:throw Error(a(435,e.tag))}}(e);t.forEach((function(t){var n=lu.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))}))}function dl(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var i=r[n],s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:case 5:al=l.stateNode,ol=!1;break e;case 3:case 4:al=l.stateNode.containerInfo,ol=!0;break e}l=l.return}if(null===al)throw Error(a(160));cl(s,o,i),al=null,ol=!1,null!==(s=i.alternate)&&(s.return=null),i.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)pl(t,e),t=t.sibling}var fl=null;function pl(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:dl(t,e),ml(e),4&n&&(Uo(3,e,e.return),jo(3,e),Uo(5,e,e.return));break;case 1:dl(t,e),ml(e),512&n&&($o||null===r||Go(r,r.return)),64&n&&Jo&&(null!==(e=e.updateQueue)&&(null!==(n=e.callbacks)&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===r?n:r.concat(n))));break;case 26:var i=fl;if(dl(t,e),ml(e),512&n&&($o||null===r||Go(r,r.return)),4&n){var s=null!==r?r.memoizedState:null;if(n=e.memoizedState,null===r)if(null===n)if(null===e.stateNode){e:{n=e.type,r=e.memoizedProps,i=i.ownerDocument||i;t:switch(n){case"title":(!(s=i.getElementsByTagName("title")[0])||s[Ge]||s[ze]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=i.createElement(n),i.head.insertBefore(s,i.querySelector("head > title"))),qu(s,n,r),s[ze]=e,Ze(s),n=s;break e;case"link":var o=Mh("link","href",i).get(n+(r.href||""));if(o)for(var l=0;l<o.length;l++)if((s=o[l]).getAttribute("href")===(null==r.href?null:r.href)&&s.getAttribute("rel")===(null==r.rel?null:r.rel)&&s.getAttribute("title")===(null==r.title?null:r.title)&&s.getAttribute("crossorigin")===(null==r.crossOrigin?null:r.crossOrigin)){o.splice(l,1);break t}qu(s=i.createElement(n),n,r),i.head.appendChild(s);break;case"meta":if(o=Mh("meta","content",i).get(n+(r.content||"")))for(l=0;l<o.length;l++)if((s=o[l]).getAttribute("content")===(null==r.content?null:""+r.content)&&s.getAttribute("name")===(null==r.name?null:r.name)&&s.getAttribute("property")===(null==r.property?null:r.property)&&s.getAttribute("http-equiv")===(null==r.httpEquiv?null:r.httpEquiv)&&s.getAttribute("charset")===(null==r.charSet?null:r.charSet)){o.splice(l,1);break t}qu(s=i.createElement(n),n,r),i.head.appendChild(s);break;default:throw Error(a(468,n))}s[ze]=e,Ze(s),n=s}e.stateNode=n}else Th(i,e.type,e.stateNode);else e.stateNode=Sh(i,n,e.memoizedProps);else s!==n?(null===s?null!==r.stateNode&&(r=r.stateNode).parentNode.removeChild(r):s.count--,null===n?Th(i,e.type,e.stateNode):Sh(i,n,e.memoizedProps)):null===n&&null!==e.stateNode&&Xo(e,e.memoizedProps,r.memoizedProps)}break;case 27:if(4&n&&null===e.alternate){i=e.stateNode,s=e.memoizedProps;try{for(var c=i.firstChild;c;){var u=c.nextSibling,h=c.nodeName;c[Ge]||"HEAD"===h||"BODY"===h||"SCRIPT"===h||"STYLE"===h||"LINK"===h&&"stylesheet"===c.rel.toLowerCase()||i.removeChild(c),c=u}for(var d=e.type,f=i.attributes;f.length;)i.removeAttributeNode(f[0]);qu(i,d,s),i[ze]=e,i[Fe]=s}catch(m){nu(e,e.return,m)}}case 5:if(dl(t,e),ml(e),512&n&&($o||null===r||Go(r,r.return)),32&e.flags){i=e.stateNode;try{St(i,"")}catch(m){nu(e,e.return,m)}}4&n&&null!=e.stateNode&&Xo(e,i=e.memoizedProps,null!==r?r.memoizedProps:i),1024&n&&(el=!0);break;case 6:if(dl(t,e),ml(e),4&n){if(null===e.stateNode)throw Error(a(162));n=e.memoizedProps,r=e.stateNode;try{r.nodeValue=n}catch(m){nu(e,e.return,m)}}break;case 3:if(Ah=null,i=fl,fl=dh(t.containerInfo),dl(t,e),fl=i,ml(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{md(t.containerInfo)}catch(m){nu(e,e.return,m)}el&&(el=!1,gl(e));break;case 4:n=fl,fl=dh(e.stateNode.containerInfo),dl(t,e),ml(e),fl=n;break;case 12:dl(t,e),ml(e);break;case 13:dl(t,e),ml(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==r&&null!==r.memoizedState)&&(bc=le()),4&n&&(null!==(n=e.updateQueue)&&(e.updateQueue=null,hl(e,n)));break;case 22:if(512&n&&($o||null===r||Go(r,r.return)),c=null!==e.memoizedState,u=null!==r&&null!==r.memoizedState,Jo=(h=Jo)||c,$o=(d=$o)||u,dl(t,e),$o=d,Jo=h,ml(e),(t=e.stateNode)._current=e,t._visibility&=-3,t._visibility|=2&t._pendingVisibility,8192&n&&(t._visibility=c?-2&t._visibility:1|t._visibility,c&&(t=Jo||$o,null===r||u||t||yl(e)),null===e.memoizedProps||"manual"!==e.memoizedProps.mode))e:for(r=null,t=e;;){if(5===t.tag||26===t.tag||27===t.tag){if(null===r){u=r=t;try{if(i=u.stateNode,c)"function"===typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{o=u.stateNode;var p=void 0!==(l=u.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null;o.style.display=null==p||"boolean"===typeof p?"":(""+p).trim()}}catch(m){nu(u,u.return,m)}}}else if(6===t.tag){if(null===r){u=t;try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(m){nu(u,u.return,m)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}4&n&&(null!==(n=e.updateQueue)&&(null!==(r=n.retryQueue)&&(n.retryQueue=null,hl(e,r))));break;case 19:dl(t,e),ml(e),4&n&&(null!==(n=e.updateQueue)&&(e.updateQueue=null,hl(e,n)));break;case 21:break;default:dl(t,e),ml(e)}}function ml(e){var t=e.flags;if(2&t){try{if(27!==e.tag){e:{for(var r=e.return;null!==r;){if(Yo(r)){var n=r;break e}r=r.return}throw Error(a(160))}switch(n.tag){case 27:var i=n.stateNode;Zo(e,Ko(e),i);break;case 5:var s=n.stateNode;32&n.flags&&(St(s,""),n.flags&=-33),Zo(e,Ko(e),s);break;case 3:case 4:var o=n.stateNode.containerInfo;Qo(e,Ko(e),o);break;default:throw Error(a(161))}}}catch(l){nu(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function gl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;gl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function vl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)il(e,t.alternate,t),t=t.sibling}function yl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Uo(4,t,t.return),yl(t);break;case 1:Go(t,t.return);var r=t.stateNode;"function"===typeof r.componentWillUnmount&&Ho(t,t.return,r),yl(t);break;case 26:case 27:case 5:Go(t,t.return),yl(t);break;case 22:Go(t,t.return),null===t.memoizedState&&yl(t);break;default:yl(t)}e=e.sibling}}function bl(e,t,r){for(r=r&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var n=t.alternate,i=e,s=t,a=s.flags;switch(s.tag){case 0:case 11:case 15:bl(i,s,r),jo(4,s);break;case 1:if(bl(i,s,r),"function"===typeof(i=(n=s).stateNode).componentDidMount)try{i.componentDidMount()}catch(c){nu(n,n.return,c)}if(null!==(i=(n=s).updateQueue)){var o=n.stateNode;try{var l=i.shared.hiddenCallbacks;if(null!==l)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)zo(l[i],o)}catch(c){nu(n,n.return,c)}}r&&64&a&&Vo(s),Wo(s,s.return);break;case 26:case 27:case 5:bl(i,s,r),r&&null===n&&4&a&&qo(s),Wo(s,s.return);break;case 12:default:bl(i,s,r);break;case 13:bl(i,s,r),r&&4&a&&ul(i,s);break;case 22:null===s.memoizedState&&bl(i,s,r),Wo(s,s.return)}t=t.sibling}}function wl(e,t){var r=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==r&&(null!=e&&e.refCount++,null!=r&&Ui(r))}function xl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ui(e))}function Sl(e,t,r,n){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)_l(e,t,r,n),t=t.sibling}function _l(e,t,r,n){var i=t.flags;switch(t.tag){case 0:case 11:case 15:Sl(e,t,r,n),2048&i&&jo(9,t);break;case 3:Sl(e,t,r,n),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ui(e)));break;case 12:if(2048&i){Sl(e,t,r,n),e=t.stateNode;try{var s=t.memoizedProps,a=s.id,o=s.onPostCommit;"function"===typeof o&&o(a,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){nu(t,t.return,l)}}else Sl(e,t,r,n);break;case 23:break;case 22:s=t.stateNode,null!==t.memoizedState?4&s._visibility?Sl(e,t,r,n):El(e,t):4&s._visibility?Sl(e,t,r,n):(s._visibility|=4,Cl(e,t,r,n,0!==(10256&t.subtreeFlags))),2048&i&&wl(t.alternate,t);break;case 24:Sl(e,t,r,n),2048&i&&xl(t.alternate,t);break;default:Sl(e,t,r,n)}}function Cl(e,t,r,n,i){for(i=i&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var s=e,a=t,o=r,l=n,c=a.flags;switch(a.tag){case 0:case 11:case 15:Cl(s,a,o,l,i),jo(8,a);break;case 23:break;case 22:var u=a.stateNode;null!==a.memoizedState?4&u._visibility?Cl(s,a,o,l,i):El(s,a):(u._visibility|=4,Cl(s,a,o,l,i)),i&&2048&c&&wl(a.alternate,a);break;case 24:Cl(s,a,o,l,i),i&&2048&c&&xl(a.alternate,a);break;default:Cl(s,a,o,l,i)}t=t.sibling}}function El(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var r=e,n=t,i=n.flags;switch(n.tag){case 22:El(r,n),2048&i&&wl(n.alternate,n);break;case 24:El(r,n),2048&i&&xl(n.alternate,n);break;default:El(r,n)}t=t.sibling}}var Al=8192;function Ml(e){if(e.subtreeFlags&Al)for(e=e.child;null!==e;)Tl(e),e=e.sibling}function Tl(e){switch(e.tag){case 26:Ml(e),e.flags&Al&&null!==e.memoizedState&&function(e,t,r){if(null===kh)throw Error(a(475));var n=kh;if("stylesheet"===t.type&&("string"!==typeof r.media||!1!==matchMedia(r.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var i=vh(r.href),s=e.querySelector(yh(i));if(s)return null!==(e=s._p)&&"object"===typeof e&&"function"===typeof e.then&&(n.count++,n=Ih.bind(n),e.then(n,n)),t.state.loading|=4,t.instance=s,void Ze(s);s=e.ownerDocument||e,r=bh(r),(i=uh.get(i))&&Ch(r,i),Ze(s=s.createElement("link"));var o=s;o._p=new Promise((function(e,t){o.onload=e,o.onerror=t})),qu(s,"link",r),t.instance=s}null===n.stylesheets&&(n.stylesheets=new Map),n.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(n.count++,t=Ih.bind(n),e.addEventListener("load",t),e.addEventListener("error",t))}}(fl,e.memoizedState,e.memoizedProps);break;case 5:default:Ml(e);break;case 3:case 4:var t=fl;fl=dh(e.stateNode.containerInfo),Ml(e),fl=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Al,Al=16777216,Ml(e),Al=t):Ml(e))}}function Pl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function kl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var r=0;r<t.length;r++){var n=t[r];rl=n,Ol(n,e)}Pl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Dl(e),e=e.sibling}function Dl(e){switch(e.tag){case 0:case 11:case 15:kl(e),2048&e.flags&&Uo(9,e,e.return);break;case 3:case 12:default:kl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&4&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-5,Il(e)):kl(e)}}function Il(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var r=0;r<t.length;r++){var n=t[r];rl=n,Ol(n,e)}Pl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:Uo(8,t,t.return),Il(t);break;case 22:4&(r=t.stateNode)._visibility&&(r._visibility&=-5,Il(t));break;default:Il(t)}e=e.sibling}}function Ol(e,t){for(;null!==rl;){var r=rl;switch(r.tag){case 0:case 11:case 15:Uo(8,r,t);break;case 23:case 22:if(null!==r.memoizedState&&null!==r.memoizedState.cachePool){var n=r.memoizedState.cachePool.pool;null!=n&&n.refCount++}break;case 24:Ui(r.memoizedState.cache)}if(null!==(n=r.child))n.return=r,rl=n;else e:for(r=e;null!==rl;){var i=(n=rl).sibling,s=n.return;if(sl(n),n===r){rl=null;break e}if(null!==i){i.return=s,rl=i;break e}rl=s}}}function Rl(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ll(e,t,r,n){return new Rl(e,t,r,n)}function Nl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Bl(e,t){var r=e.alternate;return null===r?((r=Ll(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=31457280&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function zl(e,t){e.flags&=31457282;var r=e.alternate;return null===r?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Fl(e,t,r,n,i,s){var o=0;if(n=e,"function"===typeof e)Nl(e)&&(o=1);else if("string"===typeof e)o=function(e,t,r){if(1===r||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,r,K.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case h:return jl(r.children,i,s,t);case d:o=8,i|=24;break;case f:return(e=Ll(12,r,t,2|i)).elementType=f,e.lanes=s,e;case y:return(e=Ll(13,r,t,i)).elementType=y,e.lanes=s,e;case b:return(e=Ll(19,r,t,i)).elementType=b,e.lanes=s,e;case S:return Ul(r,i,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case p:case g:o=10;break e;case m:o=9;break e;case v:o=11;break e;case w:o=14;break e;case x:o=16,n=null;break e}o=29,r=Error(a(130,null===e?"null":typeof e,"")),n=null}return(t=Ll(o,r,t,i)).elementType=e,t.type=n,t.lanes=s,t}function jl(e,t,r,n){return(e=Ll(7,e,n,t)).lanes=r,e}function Ul(e,t,r,n){(e=Ll(22,e,n,t)).elementType=S,e.lanes=r;var i={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var e=i._current;if(null===e)throw Error(a(456));if(0===(2&i._pendingVisibility)){var t=Pn(e,2);null!==t&&(i._pendingVisibility|=2,Ic(t,e,2))}},attach:function(){var e=i._current;if(null===e)throw Error(a(456));if(0!==(2&i._pendingVisibility)){var t=Pn(e,2);null!==t&&(i._pendingVisibility&=-3,Ic(t,e,2))}}};return e.stateNode=i,e}function Vl(e,t,r){return(e=Ll(6,e,null,t)).lanes=r,e}function Hl(e,t,r){return(t=Ll(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Wl(e){e.flags|=4}function Gl(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!Ph(t)){if(null!==(t=Ti.current)&&((4194176&nc)===nc?null!==Pi:(62914560&nc)!==nc&&0===(536870912&nc)||t!==Pi))throw di=li,oi;e.flags|=8192}}function ql(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?ke():536870912,e.lanes|=t,mc|=t)}function Xl(e,t){if(!Qn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Yl(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=31457280&i.subtreeFlags,n|=31457280&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Kl(e,t,r){var n=t.pendingProps;switch(Xn(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return Yl(t),null;case 3:return r=t.stateNode,n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),bo(Fi),ee(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ni(t)?Wl(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==Zn&&(Rc(Zn),Zn=null))),Yl(t),null;case 26:return r=t.memoizedState,null===e?(Wl(t),null!==r?(Yl(t),Gl(t,r)):(Yl(t),t.flags&=-16777217)):r?r!==e.memoizedState?(Wl(t),Yl(t),Gl(t,r)):(Yl(t),t.flags&=-16777217):(e.memoizedProps!==n&&Wl(t),Yl(t),t.flags&=-16777217),null;case 27:re(t),r=Z.current;var i=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==n&&Wl(t);else{if(!n){if(null===t.stateNode)throw Error(a(166));return Yl(t),null}e=K.current,ni(t)?ti(t):(e=ch(i,n,r),t.stateNode=e,Wl(t))}return Yl(t),null;case 5:if(re(t),r=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==n&&Wl(t);else{if(!n){if(null===t.stateNode)throw Error(a(166));return Yl(t),null}if(e=K.current,ni(t))ti(t);else{switch(i=Ku(Z.current),e){case 1:e=i.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:e=i.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":e=i.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":e=i.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":(e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof n.is?i.createElement("select",{is:n.is}):i.createElement("select"),n.multiple?e.multiple=!0:n.size&&(e.size=n.size);break;default:e="string"===typeof n.is?i.createElement(r,{is:n.is}):i.createElement(r)}}e[ze]=t,e[Fe]=n;e:for(i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&27!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;null===i.sibling;){if(null===i.return||i.return===t)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}t.stateNode=e;e:switch(qu(e,r,n),r){case"button":case"input":case"select":case"textarea":e=!!n.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Wl(t)}}return Yl(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==n&&Wl(t);else{if("string"!==typeof n&&null===t.stateNode)throw Error(a(166));if(e=Z.current,ni(t)){if(e=t.stateNode,r=t.memoizedProps,n=null,null!==(i=Yn))switch(i.tag){case 27:case 5:n=i.memoizedProps}e[ze]=t,(e=!!(e.nodeValue===r||null!==n&&!0===n.suppressHydrationWarning||Vu(e.nodeValue,r)))||ei(t)}else(e=Ku(e).createTextNode(n))[ze]=t,t.stateNode=e}return Yl(t),null;case 13:if(n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=ni(t),null!==n&&null!==n.dehydrated){if(null===e){if(!i)throw Error(a(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(a(317));i[ze]=t}else ii(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Yl(t),i=!1}else null!==Zn&&(Rc(Zn),Zn=null),i=!0;if(!i)return 256&t.flags?(Oi(t),t):(Oi(t),null)}if(Oi(t),0!==(128&t.flags))return t.lanes=r,t;if(r=null!==n,e=null!==e&&null!==e.memoizedState,r){i=null,null!==(n=t.child).alternate&&null!==n.alternate.memoizedState&&null!==n.alternate.memoizedState.cachePool&&(i=n.alternate.memoizedState.cachePool.pool);var s=null;null!==n.memoizedState&&null!==n.memoizedState.cachePool&&(s=n.memoizedState.cachePool.pool),s!==i&&(n.flags|=2048)}return r!==e&&r&&(t.child.flags|=8192),ql(t,t.updateQueue),Yl(t),null;case 4:return ee(),null===e&&Iu(t.stateNode.containerInfo),Yl(t),null;case 10:return bo(t.type),Yl(t),null;case 19:if(X(Ri),null===(i=t.memoizedState))return Yl(t),null;if(n=0!==(128&t.flags),null===(s=i.rendering))if(n)Xl(i,!1);else{if(0!==uc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=Li(e))){for(t.flags|=128,Xl(i,!1),e=s.updateQueue,t.updateQueue=e,ql(t,e),t.subtreeFlags=0,e=r,r=t.child;null!==r;)zl(r,e),r=r.sibling;return Y(Ri,1&Ri.current|2),t.child}e=e.sibling}null!==i.tail&&le()>wc&&(t.flags|=128,n=!0,Xl(i,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=Li(s))){if(t.flags|=128,n=!0,e=e.updateQueue,t.updateQueue=e,ql(t,e),Xl(i,!0),null===i.tail&&"hidden"===i.tailMode&&!s.alternate&&!Qn)return Yl(t),null}else 2*le()-i.renderingStartTime>wc&&536870912!==r&&(t.flags|=128,n=!0,Xl(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=i.last)?e.sibling=s:t.child=s,i.last=s)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=le(),t.sibling=null,e=Ri.current,Y(Ri,n?1&e|2:1&e),t):(Yl(t),null);case 22:case 23:return Oi(t),Mi(),n=null!==t.memoizedState,null!==e?null!==e.memoizedState!==n&&(t.flags|=8192):n&&(t.flags|=8192),n?0!==(536870912&r)&&0===(128&t.flags)&&(Yl(t),6&t.subtreeFlags&&(t.flags|=8192)):Yl(t),null!==(r=t.updateQueue)&&ql(t,r.retryQueue),r=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),n=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(n=t.memoizedState.cachePool.pool),n!==r&&(t.flags|=2048),null!==e&&X(Yi),null;case 24:return r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),bo(Fi),Yl(t),null;case 25:return null}throw Error(a(156,t.tag))}function Ql(e,t){switch(Xn(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return bo(Fi),ee(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return re(t),null;case 13:if(Oi(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));ii()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return X(Ri),null;case 4:return ee(),null;case 10:return bo(t.type),null;case 22:case 23:return Oi(t),Mi(),null!==e&&X(Yi),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return bo(Fi),null;default:return null}}function Zl(e,t){switch(Xn(t),t.tag){case 3:bo(Fi),ee();break;case 26:case 27:case 5:re(t);break;case 4:ee();break;case 13:Oi(t);break;case 19:X(Ri);break;case 10:bo(t.type);break;case 22:case 23:Oi(t),Mi(),null!==e&&X(Yi);break;case 24:bo(Fi)}}var Jl={getCacheForType:function(e){var t=Eo(Fi),r=t.data.get(e);return void 0===r&&(r=e(),t.data.set(e,r)),r}},$l="function"===typeof WeakMap?WeakMap:Map,ec=0,tc=null,rc=null,nc=0,ic=0,sc=null,ac=!1,oc=!1,lc=!1,cc=0,uc=0,hc=0,dc=0,fc=0,pc=0,mc=0,gc=null,vc=null,yc=!1,bc=0,wc=1/0,xc=null,Sc=null,_c=!1,Cc=null,Ec=0,Ac=0,Mc=null,Tc=0,Pc=null;function kc(){if(0!==(2&ec)&&0!==nc)return nc&-nc;if(null!==k.T){return 0!==Wi?Wi:xu()}return Ne()}function Dc(){0===pc&&(pc=0===(536870912&nc)||Qn?Pe():536870912);var e=Ti.current;return null!==e&&(e.flags|=32),pc}function Ic(e,t,r){(e===tc&&2===ic||null!==e.cancelPendingCommit)&&(jc(e,0),Bc(e,nc,pc,!1)),Ie(e,r),0!==(2&ec)&&e===tc||(e===tc&&(0===(2&ec)&&(dc|=r),4===uc&&Bc(e,nc,pc,!1)),mu(e))}function Oc(e,t,r){if(0!==(6&ec))throw Error(a(327));for(var n=!r&&0===(60&t)&&0===(t&e.expiredLanes)||Me(e,t),i=n?function(e,t){var r=ec;ec|=2;var n=Vc(),i=Hc();tc!==e||nc!==t?(xc=null,wc=le()+500,jc(e,t)):oc=Me(e,t);e:for(;;)try{if(0!==ic&&null!==rc){t=rc;var s=sc;t:switch(ic){case 1:ic=0,sc=null,Qc(e,t,s,1);break;case 2:if(ci(s)){ic=0,sc=null,Kc(t);break}t=function(){2===ic&&tc===e&&(ic=7),mu(e)},s.then(t,t);break e;case 3:ic=7;break e;case 4:ic=5;break e;case 7:ci(s)?(ic=0,sc=null,Kc(t)):(ic=0,sc=null,Qc(e,t,s,7));break;case 5:var o=null;switch(rc.tag){case 26:o=rc.memoizedState;case 5:case 27:var l=rc;if(!o||Ph(o)){ic=0,sc=null;var c=l.sibling;if(null!==c)rc=c;else{var u=l.return;null!==u?(rc=u,Zc(u)):rc=null}break t}}ic=0,sc=null,Qc(e,t,s,5);break;case 6:ic=0,sc=null,Qc(e,t,s,6);break;case 8:Fc(),uc=6;break e;default:throw Error(a(462))}}Xc();break}catch(h){Uc(e,h)}return vo=go=null,k.H=n,k.A=i,ec=r,null!==rc?0:(tc=null,nc=0,An(),uc)}(e,t):Gc(e,t,!0),s=n;;){if(0===i){oc&&!n&&Bc(e,t,0,!1);break}if(6===i)Bc(e,t,0,!ac);else{if(r=e.current.alternate,s&&!Nc(r)){i=Gc(e,t,!1),s=!1;continue}if(2===i){if(s=t,e.errorRecoveryDisabledLanes&s)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;i=gc;var c=l.current.memoizedState.isDehydrated;if(c&&(jc(l,o).flags|=256),2!==(o=Gc(l,o,!1))){if(lc&&!c){l.errorRecoveryDisabledLanes|=s,dc|=s,i=4;break e}s=vc,vc=i,null!==s&&Rc(s)}i=o}if(s=!1,2!==i)continue}}if(1===i){jc(e,0),Bc(e,t,0,!0);break}e:{switch(n=e,i){case 0:case 1:throw Error(a(345));case 4:if((4194176&t)===t){Bc(n,t,pc,!ac);break e}break;case 2:vc=null;break;case 3:case 5:break;default:throw Error(a(329))}if(n.finishedWork=r,n.finishedLanes=t,(62914560&t)===t&&10<(s=bc+300-le())){if(Bc(n,t,pc,!ac),0!==Ae(n,0))break e;n.timeoutHandle=eh(Lc.bind(null,n,r,vc,xc,yc,t,pc,dc,mc,ac,2,-0,0),s)}else Lc(n,r,vc,xc,yc,t,pc,dc,mc,ac,0,-0,0)}}break}mu(e)}function Rc(e){null===vc?vc=e:vc.push.apply(vc,e)}function Lc(e,t,r,n,i,s,o,l,c,u,h,d,f){var p=t.subtreeFlags;if((8192&p||16785408===(16785408&p))&&(kh={stylesheets:null,count:0,unsuspend:Dh},Tl(t),null!==(t=function(){if(null===kh)throw Error(a(475));var e=kh;return e.stylesheets&&0===e.count&&Rh(e,e.stylesheets),0<e.count?function(t){var r=setTimeout((function(){if(e.stylesheets&&Rh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}}),6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(r)}}:null}())))return e.cancelPendingCommit=t($c.bind(null,e,r,n,i,o,l,c,1,d,f)),void Bc(e,s,o,!u);$c(e,r,n,i,o,l,c,h,d,f)}function Nc(e){for(var t=e;;){var r=t.tag;if((0===r||11===r||15===r)&&16384&t.flags&&(null!==(r=t.updateQueue)&&null!==(r=r.stores)))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Xr(s(),i))return!1}catch(a){return!1}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Bc(e,t,r,n){t&=~fc,t&=~dc,e.suspendedLanes|=t,e.pingedLanes&=~t,n&&(e.warmLanes|=t),n=e.expirationTimes;for(var i=t;0<i;){var s=31-we(i),a=1<<s;n[s]=-1,i&=~a}0!==r&&Oe(e,r,t)}function zc(){return 0!==(6&ec)||(gu(0,!1),!1)}function Fc(){if(null!==rc){if(0===ic)var e=rc.return;else vo=go=null,vs(e=rc),pi=null,mi=0,e=rc;for(;null!==e;)Zl(e.alternate,e),e=e.return;rc=null}}function jc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;-1!==r&&(e.timeoutHandle=-1,th(r)),null!==(r=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,r()),Fc(),tc=e,rc=r=Bl(e.current,null),nc=t,ic=0,sc=null,ac=!1,oc=Me(e,t),lc=!1,mc=pc=fc=dc=hc=uc=0,vc=gc=null,yc=!1,0!==(8&t)&&(t|=32&t);var n=e.entangledLanes;if(0!==n)for(e=e.entanglements,n&=t;0<n;){var i=31-we(n),s=1<<i;t|=e[i],n&=~s}return cc=t,An(),r}function Uc(e,t){$i=null,k.H=Ca,t===ai?(t=fi(),ic=3):t===oi?(t=fi(),ic=4):ic=t===Va?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,sc=t,null===rc&&(uc=1,Ba(e,Rn(t,e.current)))}function Vc(){var e=k.H;return k.H=Ca,null===e?Ca:e}function Hc(){var e=k.A;return k.A=Jl,e}function Wc(){uc=4,ac||(4194176&nc)!==nc&&null!==Ti.current||(oc=!0),0===(134217727&hc)&&0===(134217727&dc)||null===tc||Bc(tc,nc,pc,!1)}function Gc(e,t,r){var n=ec;ec|=2;var i=Vc(),s=Hc();tc===e&&nc===t||(xc=null,jc(e,t)),t=!1;var a=uc;e:for(;;)try{if(0!==ic&&null!==rc){var o=rc,l=sc;switch(ic){case 8:Fc(),a=6;break e;case 3:case 2:case 6:null===Ti.current&&(t=!0);var c=ic;if(ic=0,sc=null,Qc(e,o,l,c),r&&oc){a=0;break e}break;default:c=ic,ic=0,sc=null,Qc(e,o,l,c)}}qc(),a=uc;break}catch(u){Uc(e,u)}return t&&e.shellSuspendCounter++,vo=go=null,ec=n,k.H=i,k.A=s,null===rc&&(tc=null,nc=0,An()),a}function qc(){for(;null!==rc;)Yc(rc)}function Xc(){for(;null!==rc&&!ae();)Yc(rc)}function Yc(e){var t=po(e.alternate,e,cc);e.memoizedProps=e.pendingProps,null===t?Zc(e):rc=t}function Kc(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=Ja(r,t,t.pendingProps,t.type,void 0,nc);break;case 11:t=Ja(r,t,t.pendingProps,t.type.render,t.ref,nc);break;case 5:vs(t);default:Zl(r,t),t=po(r,t=rc=zl(t,cc),cc)}e.memoizedProps=e.pendingProps,null===t?Zc(e):rc=t}function Qc(e,t,r,n){vo=go=null,vs(t),pi=null,mi=0;var i=t.return;try{if(function(e,t,r,n,i){if(r.flags|=32768,null!==n&&"object"===typeof n&&"function"===typeof n.then){if(null!==(t=r.alternate)&&So(t,r,i,!0),null!==(r=Ti.current)){switch(r.tag){case 13:return null===Pi?Wc():null===r.alternate&&0===uc&&(uc=3),r.flags&=-257,r.flags|=65536,r.lanes=i,n===li?r.flags|=16384:(null===(t=r.updateQueue)?r.updateQueue=new Set([n]):t.add(n),iu(e,n,i)),!1;case 22:return r.flags|=65536,n===li?r.flags|=16384:(null===(t=r.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([n])},r.updateQueue=t):null===(r=t.retryQueue)?t.retryQueue=new Set([n]):r.add(n),iu(e,n,i)),!1}throw Error(a(435,r.tag))}return iu(e,n,i),Wc(),!1}if(Qn)return null!==(t=Ti.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,n!==$n&&si(Rn(e=Error(a(422),{cause:n}),r))):(n!==$n&&si(Rn(t=Error(a(423),{cause:n}),r)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,n=Rn(n,r),Ro(e,i=Fa(e.stateNode,n,i)),4!==uc&&(uc=2)),!1;var s=Error(a(520),{cause:n});if(s=Rn(s,r),null===gc?gc=[s]:gc.push(s),4!==uc&&(uc=2),null===t)return!0;n=Rn(n,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=i&-i,r.lanes|=e,Ro(r,e=Fa(r.stateNode,n,e)),!1;case 1:if(t=r.type,s=r.stateNode,0===(128&r.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===Sc||!Sc.has(s))))return r.flags|=65536,i&=-i,r.lanes|=i,Ua(i=ja(i),e,r,n),Ro(r,i),!1}r=r.return}while(null!==r);return!1}(e,i,t,r,nc))return uc=1,Ba(e,Rn(r,e.current)),void(rc=null)}catch(s){if(null!==i)throw rc=i,s;return uc=1,Ba(e,Rn(r,e.current)),void(rc=null)}32768&t.flags?(Qn||1===n?e=!0:oc||0!==(536870912&nc)?e=!1:(ac=e=!0,(2===n||3===n||6===n)&&(null!==(n=Ti.current)&&13===n.tag&&(n.flags|=16384))),Jc(t,e)):Zc(t)}function Zc(e){var t=e;do{if(0!==(32768&t.flags))return void Jc(t,ac);e=t.return;var r=Kl(t.alternate,t,cc);if(null!==r)return void(rc=r);if(null!==(t=t.sibling))return void(rc=t);rc=t=e}while(null!==t);0===uc&&(uc=5)}function Jc(e,t){do{var r=Ql(e.alternate,e);if(null!==r)return r.flags&=32767,void(rc=r);if(null!==(r=e.return)&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&null!==(e=e.sibling))return void(rc=e);rc=e=r}while(null!==e);uc=6,rc=null}function $c(e,t,r,n,i,s,o,l,c,u){var h=k.T,d=V.p;try{V.p=2,k.T=null,function(e,t,r,n,i,s,o,l){do{tu()}while(null!==Cc);if(0!==(6&ec))throw Error(a(327));var c=e.finishedWork;if(n=e.finishedLanes,null===c)return null;if(e.finishedWork=null,e.finishedLanes=0,c===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0,e.cancelPendingCommit=null;var u=c.lanes|c.childLanes;if(function(e,t,r,n,i,s){var a=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(r=a&~r;0<r;){var u=31-we(r),h=1<<u;o[u]=0,l[u]=-1;var d=c[u];if(null!==d)for(c[u]=null,u=0;u<d.length;u++){var f=d[u];null!==f&&(f.lane&=-536870913)}r&=~h}0!==n&&Oe(e,n,0),0!==s&&0===i&&0!==e.tag&&(e.suspendedLanes|=s&~(a&~t))}(e,n,u|=En,s,o,l),e===tc&&(rc=tc=null,nc=0),0===(10256&c.subtreeFlags)&&0===(10256&c.flags)||_c||(_c=!0,Ac=u,Mc=r,function(e,t){ie(e,t)}(de,(function(){return tu(),null}))),r=0!==(15990&c.flags),0!==(15990&c.subtreeFlags)||r?(r=k.T,k.T=null,s=V.p,V.p=2,o=ec,ec|=4,function(e,t){if(e=e.containerInfo,Xu=Wh,$r(e=Jr(e))){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch(g){r=null;break e}var o=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==r||0!==i&&3!==d.nodeType||(l=o+i),d!==s||0!==n&&3!==d.nodeType||(c=o+n),3===d.nodeType&&(o+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===r&&++u===i&&(l=o),f===s&&++h===n&&(c=o),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Yu={focusedElem:e,selectionRange:r},Wh=!1,rl=t;null!==rl;)if(e=(t=rl).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,rl=e;else for(;null!==rl;){switch(s=(t=rl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==s){e=void 0,r=t,i=s.memoizedProps,s=s.memoizedState,n=r.stateNode;try{var m=Ia(r.type,i,(r.elementType,r.type));e=n.getSnapshotBeforeUpdate(m,s),n.__reactInternalSnapshotBeforeUpdate=e}catch(v){nu(r,r.return,v)}}break;case 3:if(0!==(1024&e))if(9===(r=(e=t.stateNode.containerInfo).nodeType))ah(e);else if(1===r)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":ah(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(a(163))}if(null!==(e=t.sibling)){e.return=t.return,rl=e;break}rl=t.return}m=nl,nl=!1}(e,c),pl(c,e),en(Yu,e.containerInfo),Wh=!!Xu,Yu=Xu=null,e.current=c,il(e,c.alternate,c),oe(),ec=o,V.p=s,k.T=r):e.current=c,_c?(_c=!1,Cc=e,Ec=n):eu(e,u),u=e.pendingLanes,0===u&&(Sc=null),function(e){if(ye&&"function"===typeof ye.onCommitFiberRoot)try{ye.onCommitFiberRoot(ve,e,void 0,128===(128&e.current.flags))}catch(t){}}(c.stateNode),mu(e),null!==t)for(i=e.onRecoverableError,c=0;c<t.length;c++)u=t[c],i(u.value,{componentStack:u.stack});0!==(3&Ec)&&tu(),u=e.pendingLanes,0!==(4194218&n)&&0!==(42&u)?e===Pc?Tc++:(Tc=0,Pc=e):Tc=0,gu(0,!1)}(e,t,r,n,d,i,s,o)}finally{k.T=h,V.p=d}}function eu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Ui(t)))}function tu(){if(null!==Cc){var e=Cc,t=Ac;Ac=0;var r=Le(Ec),n=k.T,i=V.p;try{if(V.p=32>r?32:r,k.T=null,null===Cc)var s=!1;else{r=Mc,Mc=null;var o=Cc,l=Ec;if(Cc=null,Ec=0,0!==(6&ec))throw Error(a(331));var c=ec;if(ec|=4,Dl(o.current),_l(o,o.current,l,r),ec=c,gu(0,!1),ye&&"function"===typeof ye.onPostCommitFiberRoot)try{ye.onPostCommitFiberRoot(ve,o)}catch(u){}s=!0}return s}finally{V.p=i,k.T=n,eu(e,t)}}return!1}function ru(e,t,r){t=Rn(r,t),null!==(e=Io(e,t=Fa(e.stateNode,t,2),2))&&(Ie(e,2),mu(e))}function nu(e,t,r){if(3===e.tag)ru(e,e,r);else for(;null!==t;){if(3===t.tag){ru(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Sc||!Sc.has(n))){e=Rn(r,e),null!==(n=Io(t,r=ja(2),2))&&(Ua(r,n,t,e),Ie(n,2),mu(n));break}}t=t.return}}function iu(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new $l;var i=new Set;n.set(t,i)}else void 0===(i=n.get(t))&&(i=new Set,n.set(t,i));i.has(r)||(lc=!0,i.add(r),e=su.bind(null,e,t,r),t.then(e,e))}function su(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,tc===e&&(nc&r)===r&&(4===uc||3===uc&&(62914560&nc)===nc&&300>le()-bc?0===(2&ec)&&jc(e,0):fc|=r,mc===nc&&(mc=0)),mu(e)}function au(e,t){0===t&&(t=ke()),null!==(e=Pn(e,t))&&(Ie(e,t),mu(e))}function ou(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),au(e,r)}function lu(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(r=i.retryLane);break;case 19:n=e.stateNode;break;case 22:n=e.stateNode._retryCache;break;default:throw Error(a(314))}null!==n&&n.delete(t),au(e,r)}var cu=null,uu=null,hu=!1,du=!1,fu=!1,pu=0;function mu(e){var t;e!==uu&&null===e.next&&(null===uu?cu=uu=e:uu=uu.next=e),du=!0,hu||(hu=!0,t=vu,nh((function(){0!==(6&ec)?ie(ue,t):t()})))}function gu(e,t){if(!fu&&du){fu=!0;do{for(var r=!1,n=cu;null!==n;){if(!t)if(0!==e){var i=n.pendingLanes;if(0===i)var s=0;else{var a=n.suspendedLanes,o=n.pingedLanes;s=(1<<31-we(42|e)+1)-1,s=201326677&(s&=i&~(a&~o))?201326677&s|1:s?2|s:0}0!==s&&(r=!0,wu(n,s))}else s=nc,0===(3&(s=Ae(n,n===tc?s:0)))||Me(n,s)||(r=!0,wu(n,s));n=n.next}}while(r);fu=!1}}function vu(){du=hu=!1;var e=0;0!==pu&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==$u&&($u=e,!0);return $u=null,!1}()&&(e=pu),pu=0);for(var t=le(),r=null,n=cu;null!==n;){var i=n.next,s=yu(n,t);0===s?(n.next=null,null===r?cu=i:r.next=i,null===i&&(uu=r)):(r=n,(0!==e||0!==(3&s))&&(du=!0)),n=i}gu(e,!1)}function yu(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=-62914561&e.pendingLanes;0<s;){var a=31-we(s),o=1<<a,l=i[a];-1===l?0!==(o&r)&&0===(o&n)||(i[a]=Te(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}if(r=nc,r=Ae(e,e===(t=tc)?r:0),n=e.callbackNode,0===r||e===t&&2===ic||null!==e.cancelPendingCommit)return null!==n&&null!==n&&se(n),e.callbackNode=null,e.callbackPriority=0;if(0===(3&r)||Me(e,r)){if((t=r&-r)===e.callbackPriority)return t;switch(null!==n&&se(n),Le(r)){case 2:case 8:r=he;break;case 32:default:r=de;break;case 268435456:r=pe}return n=bu.bind(null,e),r=ie(r,n),e.callbackPriority=t,e.callbackNode=r,t}return null!==n&&null!==n&&se(n),e.callbackPriority=2,e.callbackNode=null,2}function bu(e,t){var r=e.callbackNode;if(tu()&&e.callbackNode!==r)return null;var n=nc;return 0===(n=Ae(e,e===tc?n:0))?null:(Oc(e,n,t),yu(e,le()),null!=e.callbackNode&&e.callbackNode===r?bu.bind(null,e):null)}function wu(e,t){if(tu())return null;Oc(e,t,!0)}function xu(){return 0===pu&&(pu=Pe()),pu}function Su(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Pt(""+e)}function _u(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}for(var Cu=0;Cu<xn.length;Cu++){var Eu=xn[Cu];Sn(Eu.toLowerCase(),"on"+(Eu[0].toUpperCase()+Eu.slice(1)))}Sn(fn,"onAnimationEnd"),Sn(pn,"onAnimationIteration"),Sn(mn,"onAnimationStart"),Sn("dblclick","onDoubleClick"),Sn("focusin","onFocus"),Sn("focusout","onBlur"),Sn(gn,"onTransitionRun"),Sn(vn,"onTransitionStart"),Sn(yn,"onTransitionCancel"),Sn(bn,"onTransitionEnd"),tt("onMouseEnter",["mouseout","mouseover"]),tt("onMouseLeave",["mouseout","mouseover"]),tt("onPointerEnter",["pointerout","pointerover"]),tt("onPointerLeave",["pointerout","pointerover"]),et("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),et("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),et("onBeforeInput",["compositionend","keypress","textInput","paste"]),et("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),et("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),et("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Au="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Au));function Tu(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;s=o,i.currentTarget=c;try{s(i)}catch(u){Oa(u)}i.currentTarget=null,s=l}else for(a=0;a<n.length;a++){if(l=(o=n[a]).instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;s=o,i.currentTarget=c;try{s(i)}catch(u){Oa(u)}i.currentTarget=null,s=l}}}}function Pu(e,t){var r=t[Ue];void 0===r&&(r=t[Ue]=new Set);var n=e+"__bubble";r.has(n)||(Ou(t,e,2,!1),r.add(n))}function ku(e,t,r){var n=0;t&&(n|=4),Ou(r,e,n,t)}var Du="_reactListening"+Math.random().toString(36).slice(2);function Iu(e){if(!e[Du]){e[Du]=!0,Je.forEach((function(t){"selectionchange"!==t&&(Mu.has(t)||ku(t,!1,e),ku(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Du]||(t[Du]=!0,ku("selectionchange",!1,t))}}function Ou(e,t,r,n){switch(Zh(t)){case 2:var i=Gh;break;case 8:i=qh;break;default:i=Xh}r=i.bind(null,t,r,e),i=void 0,!zt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),n?void 0!==i?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):void 0!==i?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Ru(e,t,r,n,i){var s=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var a=n.tag;if(3===a||4===a){var o=n.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===a)for(a=n.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==o;){if(null===(a=Xe(o)))return;if(5===(l=a.tag)||6===l||26===l||27===l){n=s=a;continue e}o=o.parentNode}}n=n.return}Nt((function(){var n=s,i=Dt(r),a=[];e:{var o=wn.get(e);if(void 0!==o){var l=Jt,c=e;switch(e){case"keypress":if(0===Wt(r))break e;case"keydown":case"keyup":l=fr;break;case"focusin":c="focus",l=ir;break;case"focusout":c="blur",l=ir;break;case"beforeblur":case"afterblur":l=ir;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=rr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=nr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=mr;break;case fn:case pn:case mn:l=sr;break;case bn:l=gr;break;case"scroll":case"scrollend":l=er;break;case"wheel":l=vr;break;case"copy":case"cut":case"paste":l=ar;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=pr;break;case"toggle":case"beforetoggle":l=yr}var u=0!==(4&t),h=!u&&("scroll"===e||"scrollend"===e),d=u?null!==o?o+"Capture":null:o;u=[];for(var f,p=n;null!==p;){var m=p;if(f=m.stateNode,5!==(m=m.tag)&&26!==m&&27!==m||null===f||null===d||null!=(m=Bt(p,d))&&u.push(Lu(p,m,f)),h)break;p=p.return}0<u.length&&(o=new l(o,c,null,r,i),a.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||r===kt||!(c=r.relatedTarget||r.fromElement)||!Xe(c)&&!c[je])&&(l||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=n,null!==(c=(c=r.relatedTarget||r.toElement)?Xe(c):null)&&(h=B(c),u=c.tag,c!==h||5!==u&&27!==u&&6!==u)&&(c=null)):(l=null,c=n),l!==c)){if(u=rr,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=pr,m="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?o:Ke(l),f=null==c?o:Ke(c),(o=new u(m,p+"leave",l,r,i)).target=h,o.relatedTarget=f,m=null,Xe(i)===n&&((u=new u(d,p+"enter",c,r,i)).target=f,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,p=0,f=u=l;f;f=Bu(f))p++;for(f=0,m=d;m;m=Bu(m))f++;for(;0<p-f;)u=Bu(u),p--;for(;0<f-p;)d=Bu(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Bu(u),d=Bu(d)}u=null}else u=null;null!==l&&zu(a,o,l,u,!1),null!==c&&null!==h&&zu(a,h,c,u,!0)}if("select"===(l=(o=n?Ke(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Nr;else if(kr(o))if(Br)g=qr;else{g=Wr;var v=Hr}else!(l=o.nodeName)||"input"!==l.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?n&&At(n.elementType)&&(g=Nr):g=Gr;switch(g&&(g=g(e,n))?Dr(a,g,r,i):(v&&v(e,o,n),"focusout"===e&&n&&"number"===o.type&&null!=n.memoizedProps.value&&yt(o,"number",o.value)),v=n?Ke(n):window,e){case"focusin":(kr(v)||"true"===v.contentEditable)&&(rn=v,nn=n,sn=null);break;case"focusout":sn=nn=rn=null;break;case"mousedown":an=!0;break;case"contextmenu":case"mouseup":case"dragend":an=!1,on(a,r,i);break;case"selectionchange":if(tn)break;case"keydown":case"keyup":on(a,r,i)}var y;if(wr)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Tr?Ar(e,r)&&(b="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(b="onCompositionStart");b&&(_r&&"ko"!==r.locale&&(Tr||"onCompositionStart"!==b?"onCompositionEnd"===b&&Tr&&(y=Ht()):(Ut="value"in(jt=i)?jt.value:jt.textContent,Tr=!0)),0<(v=Nu(n,b)).length&&(b=new or(b,e,null,r,i),a.push({event:b,listeners:v}),y?b.data=y:null!==(y=Mr(r))&&(b.data=y))),(y=Sr?function(e,t){switch(e){case"compositionend":return Mr(t);case"keypress":return 32!==t.which?null:(Er=!0,Cr);case"textInput":return(e=t.data)===Cr&&Er?null:e;default:return null}}(e,r):function(e,t){if(Tr)return"compositionend"===e||!wr&&Ar(e,t)?(e=Ht(),Vt=Ut=jt=null,Tr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return _r&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(b=Nu(n,"onBeforeInput")).length&&(v=new or("onBeforeInput","beforeinput",null,r,i),a.push({event:v,listeners:b}),v.data=y)),function(e,t,r,n,i){if("submit"===t&&r&&r.stateNode===i){var s=Su((i[Fe]||null).action),a=n.submitter;a&&null!==(t=(t=a[Fe]||null)?Su(t.formAction):a.getAttribute("formAction"))&&(s=t,a=null);var o=new Jt("action","action",null,n,i);e.push({event:o,listeners:[{instance:null,listener:function(){if(n.defaultPrevented){if(0!==pu){var e=a?_u(i,a):new FormData(i);ua(r,{pending:!0,data:e,method:i.method,action:s},null,e)}}else"function"===typeof s&&(o.preventDefault(),e=a?_u(i,a):new FormData(i),ua(r,{pending:!0,data:e,method:i.method,action:s},s,e))},currentTarget:i}]})}}(a,e,n,r,i)}Tu(a,t)}))}function Lu(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Nu(e,t){for(var r=t+"Capture",n=[];null!==e;){var i=e,s=i.stateNode;5!==(i=i.tag)&&26!==i&&27!==i||null===s||(null!=(i=Bt(e,r))&&n.unshift(Lu(e,i,s)),null!=(i=Bt(e,t))&&n.push(Lu(e,i,s))),e=e.return}return n}function Bu(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function zu(e,t,r,n,i){for(var s=t._reactName,a=[];null!==r&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===n)break;5!==o&&26!==o&&27!==o||null===c||(l=c,i?null!=(c=Bt(r,s))&&a.unshift(Lu(r,c,l)):i||null!=(c=Bt(r,s))&&a.push(Lu(r,c,l))),r=r.return}0!==a.length&&e.push({event:t,listeners:a})}var Fu=/\r\n?/g,ju=/\u0000|\uFFFD/g;function Uu(e){return("string"===typeof e?e:""+e).replace(Fu,"\n").replace(ju,"")}function Vu(e,t){return t=Uu(t),Uu(e)===t}function Hu(){}function Wu(e,t,r,n,i,s){switch(r){case"children":"string"===typeof n?"body"===t||"textarea"===t&&""===n||St(e,n):("number"===typeof n||"bigint"===typeof n)&&"body"!==t&&St(e,""+n);break;case"className":ot(e,"class",n);break;case"tabIndex":ot(e,"tabindex",n);break;case"dir":case"role":case"viewBox":case"width":case"height":ot(e,r,n);break;case"style":Et(e,n,s);break;case"data":if("object"!==t){ot(e,"data",n);break}case"src":case"href":if(""===n&&("a"!==t||"href"!==r)){e.removeAttribute(r);break}if(null==n||"function"===typeof n||"symbol"===typeof n||"boolean"===typeof n){e.removeAttribute(r);break}n=Pt(""+n),e.setAttribute(r,n);break;case"action":case"formAction":if("function"===typeof n){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof s&&("formAction"===r?("input"!==t&&Wu(e,t,"name",i.name,i,null),Wu(e,t,"formEncType",i.formEncType,i,null),Wu(e,t,"formMethod",i.formMethod,i,null),Wu(e,t,"formTarget",i.formTarget,i,null)):(Wu(e,t,"encType",i.encType,i,null),Wu(e,t,"method",i.method,i,null),Wu(e,t,"target",i.target,i,null))),null==n||"symbol"===typeof n||"boolean"===typeof n){e.removeAttribute(r);break}n=Pt(""+n),e.setAttribute(r,n);break;case"onClick":null!=n&&(e.onclick=Hu);break;case"onScroll":null!=n&&Pu("scroll",e);break;case"onScrollEnd":null!=n&&Pu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!==typeof n||!("__html"in n))throw Error(a(61));if(null!=(r=n.__html)){if(null!=i.children)throw Error(a(60));e.innerHTML=r}}break;case"multiple":e.multiple=n&&"function"!==typeof n&&"symbol"!==typeof n;break;case"muted":e.muted=n&&"function"!==typeof n&&"symbol"!==typeof n;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==n||"function"===typeof n||"boolean"===typeof n||"symbol"===typeof n){e.removeAttribute("xlink:href");break}r=Pt(""+n),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(r,""+n):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":!0===n?e.setAttribute(r,""):!1!==n&&null!=n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(r,n):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":null!=n&&"function"!==typeof n&&"symbol"!==typeof n&&!isNaN(n)&&1<=n?e.setAttribute(r,n):e.removeAttribute(r);break;case"rowSpan":case"start":null==n||"function"===typeof n||"symbol"===typeof n||isNaN(n)?e.removeAttribute(r):e.setAttribute(r,n);break;case"popover":Pu("beforetoggle",e),Pu("toggle",e),at(e,"popover",n);break;case"xlinkActuate":lt(e,"http://www.w3.org/1999/xlink","xlink:actuate",n);break;case"xlinkArcrole":lt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",n);break;case"xlinkRole":lt(e,"http://www.w3.org/1999/xlink","xlink:role",n);break;case"xlinkShow":lt(e,"http://www.w3.org/1999/xlink","xlink:show",n);break;case"xlinkTitle":lt(e,"http://www.w3.org/1999/xlink","xlink:title",n);break;case"xlinkType":lt(e,"http://www.w3.org/1999/xlink","xlink:type",n);break;case"xmlBase":lt(e,"http://www.w3.org/XML/1998/namespace","xml:base",n);break;case"xmlLang":lt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",n);break;case"xmlSpace":lt(e,"http://www.w3.org/XML/1998/namespace","xml:space",n);break;case"is":at(e,"is",n);break;case"innerText":case"textContent":break;default:(!(2<r.length)||"o"!==r[0]&&"O"!==r[0]||"n"!==r[1]&&"N"!==r[1])&&at(e,r=Mt.get(r)||r,n)}}function Gu(e,t,r,n,i,s){switch(r){case"style":Et(e,n,s);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!==typeof n||!("__html"in n))throw Error(a(61));if(null!=(r=n.__html)){if(null!=i.children)throw Error(a(60));e.innerHTML=r}}break;case"children":"string"===typeof n?St(e,n):("number"===typeof n||"bigint"===typeof n)&&St(e,""+n);break;case"onScroll":null!=n&&Pu("scroll",e);break;case"onScrollEnd":null!=n&&Pu("scrollend",e);break;case"onClick":null!=n&&(e.onclick=Hu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:$e.hasOwnProperty(r)||("o"!==r[0]||"n"!==r[1]||(i=r.endsWith("Capture"),t=r.slice(2,i?r.length-7:void 0),"function"===typeof(s=null!=(s=e[Fe]||null)?s[r]:null)&&e.removeEventListener(t,s,i),"function"!==typeof n)?r in e?e[r]=n:!0===n?e.setAttribute(r,""):at(e,r,n):("function"!==typeof s&&null!==s&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,n,i)))}}function qu(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Pu("error",e),Pu("load",e);var n,i=!1,s=!1;for(n in r)if(r.hasOwnProperty(n)){var o=r[n];if(null!=o)switch(n){case"src":i=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:Wu(e,t,n,o,r,null)}}return s&&Wu(e,t,"srcSet",r.srcSet,r,null),void(i&&Wu(e,t,"src",r.src,r,null));case"input":Pu("invalid",e);var l=n=o=s=null,c=null,u=null;for(i in r)if(r.hasOwnProperty(i)){var h=r[i];if(null!=h)switch(i){case"name":s=h;break;case"type":o=h;break;case"checked":c=h;break;case"defaultChecked":u=h;break;case"value":n=h;break;case"defaultValue":l=h;break;case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(a(137,t));break;default:Wu(e,t,i,h,r,null)}}return vt(e,n,l,c,u,o,s,!1),void ht(e);case"select":for(s in Pu("invalid",e),i=o=n=null,r)if(r.hasOwnProperty(s)&&null!=(l=r[s]))switch(s){case"value":n=l;break;case"defaultValue":o=l;break;case"multiple":i=l;default:Wu(e,t,s,l,r,null)}return t=n,r=o,e.multiple=!!i,void(null!=t?bt(e,!!i,t,!1):null!=r&&bt(e,!!i,r,!0));case"textarea":for(o in Pu("invalid",e),n=s=i=null,r)if(r.hasOwnProperty(o)&&null!=(l=r[o]))switch(o){case"value":i=l;break;case"defaultValue":s=l;break;case"children":n=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(a(91));break;default:Wu(e,t,o,l,r,null)}return xt(e,i,s,n),void ht(e);case"option":for(c in r)if(r.hasOwnProperty(c)&&null!=(i=r[c]))if("selected"===c)e.selected=i&&"function"!==typeof i&&"symbol"!==typeof i;else Wu(e,t,c,i,r,null);return;case"dialog":Pu("cancel",e),Pu("close",e);break;case"iframe":case"object":Pu("load",e);break;case"video":case"audio":for(i=0;i<Au.length;i++)Pu(Au[i],e);break;case"image":Pu("error",e),Pu("load",e);break;case"details":Pu("toggle",e);break;case"embed":case"source":case"link":Pu("error",e),Pu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in r)if(r.hasOwnProperty(u)&&null!=(i=r[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:Wu(e,t,u,i,r,null)}return;default:if(At(t)){for(h in r)r.hasOwnProperty(h)&&(void 0!==(i=r[h])&&Gu(e,t,h,i,r,void 0));return}}for(l in r)r.hasOwnProperty(l)&&(null!=(i=r[l])&&Wu(e,t,l,i,r,null))}var Xu=null,Yu=null;function Ku(e){return 9===e.nodeType?e:e.ownerDocument}function Qu(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Zu(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function Ju(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var $u=null;var eh="function"===typeof setTimeout?setTimeout:void 0,th="function"===typeof clearTimeout?clearTimeout:void 0,rh="function"===typeof Promise?Promise:void 0,nh="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof rh?function(e){return rh.resolve(null).then(e).catch(ih)}:eh;function ih(e){setTimeout((function(){throw e}))}function sh(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&8===i.nodeType)if("/$"===(r=i.data)){if(0===n)return e.removeChild(i),void md(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=i}while(r);md(t)}function ah(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":ah(r),qe(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===r.rel.toLowerCase())continue}e.removeChild(r)}}function oh(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}function lh(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}function ch(e,t,r){switch(t=Ku(r),e){case"html":if(!(e=t.documentElement))throw Error(a(452));return e;case"head":if(!(e=t.head))throw Error(a(453));return e;case"body":if(!(e=t.body))throw Error(a(454));return e;default:throw Error(a(451))}}var uh=new Map,hh=new Set;function dh(e){return"function"===typeof e.getRootNode?e.getRootNode():e.ownerDocument}var fh=V.d;V.d={f:function(){var e=fh.f(),t=zc();return e||t},r:function(e){var t=Ye(e);null!==t&&5===t.tag&&"form"===t.type?da(t):fh.r(e)},D:function(e){fh.D(e),mh("dns-prefetch",e,null)},C:function(e,t){fh.C(e,t),mh("preconnect",e,t)},L:function(e,t,r){fh.L(e,t,r);var n=ph;if(n&&e&&t){var i='link[rel="preload"][as="'+mt(t)+'"]';"image"===t&&r&&r.imageSrcSet?(i+='[imagesrcset="'+mt(r.imageSrcSet)+'"]',"string"===typeof r.imageSizes&&(i+='[imagesizes="'+mt(r.imageSizes)+'"]')):i+='[href="'+mt(e)+'"]';var s=i;switch(t){case"style":s=vh(e);break;case"script":s=wh(e)}uh.has(s)||(e=D({rel:"preload",href:"image"===t&&r&&r.imageSrcSet?void 0:e,as:t},r),uh.set(s,e),null!==n.querySelector(i)||"style"===t&&n.querySelector(yh(s))||"script"===t&&n.querySelector(xh(s))||(qu(t=n.createElement("link"),"link",e),Ze(t),n.head.appendChild(t)))}},m:function(e,t){fh.m(e,t);var r=ph;if(r&&e){var n=t&&"string"===typeof t.as?t.as:"script",i='link[rel="modulepreload"][as="'+mt(n)+'"][href="'+mt(e)+'"]',s=i;switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=wh(e)}if(!uh.has(s)&&(e=D({rel:"modulepreload",href:e},t),uh.set(s,e),null===r.querySelector(i))){switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(xh(s)))return}qu(n=r.createElement("link"),"link",e),Ze(n),r.head.appendChild(n)}}},X:function(e,t){fh.X(e,t);var r=ph;if(r&&e){var n=Qe(r).hoistableScripts,i=wh(e),s=n.get(i);s||((s=r.querySelector(xh(i)))||(e=D({src:e,async:!0},t),(t=uh.get(i))&&Eh(e,t),Ze(s=r.createElement("script")),qu(s,"link",e),r.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},n.set(i,s))}},S:function(e,t,r){fh.S(e,t,r);var n=ph;if(n&&e){var i=Qe(n).hoistableStyles,s=vh(e);t=t||"default";var a=i.get(s);if(!a){var o={loading:0,preload:null};if(a=n.querySelector(yh(s)))o.loading=5;else{e=D({rel:"stylesheet",href:e,"data-precedence":t},r),(r=uh.get(s))&&Ch(e,r);var l=a=n.createElement("link");Ze(l),qu(l,"link",e),l._p=new Promise((function(e,t){l.onload=e,l.onerror=t})),l.addEventListener("load",(function(){o.loading|=1})),l.addEventListener("error",(function(){o.loading|=2})),o.loading|=4,_h(a,t,n)}a={type:"stylesheet",instance:a,count:1,state:o},i.set(s,a)}}},M:function(e,t){fh.M(e,t);var r=ph;if(r&&e){var n=Qe(r).hoistableScripts,i=wh(e),s=n.get(i);s||((s=r.querySelector(xh(i)))||(e=D({src:e,async:!0,type:"module"},t),(t=uh.get(i))&&Eh(e,t),Ze(s=r.createElement("script")),qu(s,"link",e),r.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},n.set(i,s))}}};var ph="undefined"===typeof document?null:document;function mh(e,t,r){var n=ph;if(n&&"string"===typeof t&&t){var i=mt(t);i='link[rel="'+e+'"][href="'+i+'"]',"string"===typeof r&&(i+='[crossorigin="'+r+'"]'),hh.has(i)||(hh.add(i),e={rel:e,crossOrigin:r,href:t},null===n.querySelector(i)&&(qu(t=n.createElement("link"),"link",e),Ze(t),n.head.appendChild(t)))}}function gh(e,t,r,n){var i,s,o,l,c=(c=Z.current)?dh(c):null;if(!c)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof r.precedence&&"string"===typeof r.href?(t=vh(r.href),(n=(r=Qe(c).hoistableStyles).get(t))||(n={type:"style",instance:null,count:0,state:null},r.set(t,n)),n):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===r.rel&&"string"===typeof r.href&&"string"===typeof r.precedence){e=vh(r.href);var u=Qe(c).hoistableStyles,h=u.get(e);if(h||(c=c.ownerDocument||c,h={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,h),(u=c.querySelector(yh(e)))&&!u._p&&(h.instance=u,h.state.loading=5),uh.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},uh.set(e,r),u||(i=c,s=e,o=r,l=h.state,i.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=i.createElement("link"),l.preload=s,s.addEventListener("load",(function(){return l.loading|=1})),s.addEventListener("error",(function(){return l.loading|=2})),qu(s,"link",o),Ze(s),i.head.appendChild(s))))),t&&null===n)throw Error(a(528,""));return h}if(t&&null!==n)throw Error(a(529,""));return null;case"script":return t=r.async,"string"===typeof(r=r.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=wh(r),(n=(r=Qe(c).hoistableScripts).get(t))||(n={type:"script",instance:null,count:0,state:null},r.set(t,n)),n):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function vh(e){return'href="'+mt(e)+'"'}function yh(e){return'link[rel="stylesheet"]['+e+"]"}function bh(e){return D({},e,{"data-precedence":e.precedence,precedence:null})}function wh(e){return'[src="'+mt(e)+'"]'}function xh(e){return"script[async]"+e}function Sh(e,t,r){if(t.count++,null===t.instance)switch(t.type){case"style":var n=e.querySelector('style[data-href~="'+mt(r.href)+'"]');if(n)return t.instance=n,Ze(n),n;var i=D({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return Ze(n=(e.ownerDocument||e).createElement("style")),qu(n,"style",i),_h(n,r.precedence,e),t.instance=n;case"stylesheet":i=vh(r.href);var s=e.querySelector(yh(i));if(s)return t.state.loading|=4,t.instance=s,Ze(s),s;n=bh(r),(i=uh.get(i))&&Ch(n,i),Ze(s=(e.ownerDocument||e).createElement("link"));var o=s;return o._p=new Promise((function(e,t){o.onload=e,o.onerror=t})),qu(s,"link",n),t.state.loading|=4,_h(s,r.precedence,e),t.instance=s;case"script":return s=wh(r.src),(i=e.querySelector(xh(s)))?(t.instance=i,Ze(i),i):(n=r,(i=uh.get(s))&&Eh(n=D({},r),i),Ze(i=(e=e.ownerDocument||e).createElement("script")),qu(i,"link",n),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(a(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(n=t.instance,t.state.loading|=4,_h(n,r.precedence,e));return t.instance}function _h(e,t,r){for(var n=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=n.length?n[n.length-1]:null,s=i,a=0;a<n.length;a++){var o=n[a];if(o.dataset.precedence===t)s=o;else if(s!==i)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=9===r.nodeType?r.head:r).insertBefore(e,t.firstChild)}function Ch(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Eh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Ah=null;function Mh(e,t,r){if(null===Ah){var n=new Map,i=Ah=new Map;i.set(r,n)}else(n=(i=Ah).get(r))||(n=new Map,i.set(r,n));if(n.has(e))return n;for(n.set(e,null),r=r.getElementsByTagName(e),i=0;i<r.length;i++){var s=r[i];if(!(s[Ge]||s[ze]||"link"===e&&"stylesheet"===s.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==s.namespaceURI){var a=s.getAttribute(t)||"";a=e+a;var o=n.get(a);o?o.push(s):n.set(a,[s])}}return n}function Th(e,t,r){(e=e.ownerDocument||e).head.insertBefore(r,"title"===t?e.querySelector("head > title"):null)}function Ph(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var kh=null;function Dh(){}function Ih(){if(this.count--,0===this.count)if(this.stylesheets)Rh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Oh=null;function Rh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Oh=new Map,t.forEach(Lh,e),Oh=null,Ih.call(e))}function Lh(e,t){if(!(4&t.state.loading)){var r=Oh.get(e);if(r)var n=r.get(null);else{r=new Map,Oh.set(e,r);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<i.length;s++){var a=i[s];"LINK"!==a.nodeName&&"not all"===a.getAttribute("media")||(r.set(a.dataset.precedence,a),n=a)}n&&r.set(null,n)}a=(i=t.instance).getAttribute("data-precedence"),(s=r.get(a)||n)===n&&r.set(null,i),r.set(a,i),this.count++,n=Ih.bind(this),i.addEventListener("load",n),i.addEventListener("error",n),s?s.parentNode.insertBefore(i,s.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(i,e.firstChild),t.state.loading|=4}}var Nh={$$typeof:g,Provider:null,Consumer:null,_currentValue:H,_currentValue2:H,_threadCount:0};function Bh(e,t,r,n,i,s,a,o){this.tag=1,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=De(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=De(0),this.hiddenUpdates=De(null),this.identifierPrefix=n,this.onUncaughtError=i,this.onCaughtError=s,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function zh(e,t,r,n,i,s,a,o,l,c,u,h){return e=new Bh(e,t,r,a,o,l,c,h),t=1,!0===s&&(t|=24),s=Ll(3,null,null,t),e.current=s,s.stateNode=e,(t=ji()).refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:n,isDehydrated:r,cache:t},Po(s),e}function Fh(e){return e?e=In:In}function jh(e,t,r,n,i,s){i=Fh(i),null===n.context?n.context=i:n.pendingContext=i,(n=Do(t)).payload={element:r},null!==(s=void 0===s?null:s)&&(n.callback=s),null!==(r=Io(e,n,t))&&(Ic(r,0,t),Oo(r,e,t))}function Uh(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Vh(e,t){Uh(e,t),(e=e.alternate)&&Uh(e,t)}function Hh(e){if(13===e.tag){var t=Pn(e,67108864);null!==t&&Ic(t,0,67108864),Vh(e,67108864)}}var Wh=!0;function Gh(e,t,r,n){var i=k.T;k.T=null;var s=V.p;try{V.p=2,Xh(e,t,r,n)}finally{V.p=s,k.T=i}}function qh(e,t,r,n){var i=k.T;k.T=null;var s=V.p;try{V.p=8,Xh(e,t,r,n)}finally{V.p=s,k.T=i}}function Xh(e,t,r,n){if(Wh){var i=Yh(n);if(null===i)Ru(e,t,n,Kh,r),ad(e,n);else if(function(e,t,r,n,i){switch(t){case"focusin":return $h=od($h,e,t,r,n,i),!0;case"dragenter":return ed=od(ed,e,t,r,n,i),!0;case"mouseover":return td=od(td,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return rd.set(s,od(rd.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,nd.set(s,od(nd.get(s)||null,e,t,r,n,i)),!0}return!1}(i,e,t,r,n))n.stopPropagation();else if(ad(e,n),4&t&&-1<sd.indexOf(e)){for(;null!==i;){var s=Ye(i);if(null!==s)switch(s.tag){case 3:if((s=s.stateNode).current.memoizedState.isDehydrated){var a=Ee(s.pendingLanes);if(0!==a){var o=s;for(o.pendingLanes|=2,o.entangledLanes|=2;a;){var l=1<<31-we(a);o.entanglements[1]|=l,a&=~l}mu(s),0===(6&ec)&&(wc=le()+500,gu(0,!1))}}break;case 13:null!==(o=Pn(s,2))&&Ic(o,0,2),zc(),Vh(s,2)}if(null===(s=Yh(n))&&Ru(e,t,n,Kh,r),s===i)break;i=s}null!==i&&n.stopPropagation()}else Ru(e,t,n,null,r)}}function Yh(e){return Qh(e=Dt(e))}var Kh=null;function Qh(e){if(Kh=null,null!==(e=Xe(e))){var t=B(e);if(null===t)e=null;else{var r=t.tag;if(13===r){if(null!==(e=z(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Kh=e,null}function Zh(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case ue:return 2;case he:return 8;case de:case fe:return 32;case pe:return 268435456;default:return 32}default:return 32}}var Jh=!1,$h=null,ed=null,td=null,rd=new Map,nd=new Map,id=[],sd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ad(e,t){switch(e){case"focusin":case"focusout":$h=null;break;case"dragenter":case"dragleave":ed=null;break;case"mouseover":case"mouseout":td=null;break;case"pointerover":case"pointerout":rd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":nd.delete(t.pointerId)}}function od(e,t,r,n,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=Ye(t))&&Hh(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function ld(e){var t=Xe(e.target);if(null!==t){var r=B(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=z(r)))return e.blockedOn=t,void function(e,t){var r=V.p;try{return V.p=e,t()}finally{V.p=r}}(e.priority,(function(){if(13===r.tag){var e=kc(),t=Pn(r,e);null!==t&&Ic(t,0,e),Vh(r,e)}}))}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function cd(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Yh(e.nativeEvent);if(null!==r)return null!==(t=Ye(r))&&Hh(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);kt=n,r.target.dispatchEvent(n),kt=null,t.shift()}return!0}function ud(e,t,r){cd(e)&&r.delete(t)}function hd(){Jh=!1,null!==$h&&cd($h)&&($h=null),null!==ed&&cd(ed)&&(ed=null),null!==td&&cd(td)&&(td=null),rd.forEach(ud),nd.forEach(ud)}function dd(e,t){e.blockedOn===t&&(e.blockedOn=null,Jh||(Jh=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,hd)))}var fd=null;function pd(e){fd!==e&&(fd=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,(function(){fd===e&&(fd=null);for(var t=0;t<e.length;t+=3){var r=e[t],n=e[t+1],i=e[t+2];if("function"!==typeof n){if(null===Qh(n||r))continue;break}var s=Ye(r);null!==s&&(e.splice(t,3),t-=3,ua(s,{pending:!0,data:i,method:r.method,action:n},n,i))}})))}function md(e){function t(t){return dd(t,e)}null!==$h&&dd($h,e),null!==ed&&dd(ed,e),null!==td&&dd(td,e),rd.forEach(t),nd.forEach(t);for(var r=0;r<id.length;r++){var n=id[r];n.blockedOn===e&&(n.blockedOn=null)}for(;0<id.length&&null===(r=id[0]).blockedOn;)ld(r),null===r.blockedOn&&id.shift();if(null!=(r=(e.ownerDocument||e).$$reactFormReplay))for(n=0;n<r.length;n+=3){var i=r[n],s=r[n+1],a=i[Fe]||null;if("function"===typeof s)a||pd(r);else if(a){var o=null;if(s&&s.hasAttribute("formAction")){if(i=s,a=s[Fe]||null)o=a.formAction;else if(null!==Qh(i))continue}else o=a.action;"function"===typeof o?r[n+1]=o:(r.splice(n,3),n-=3),pd(r)}}}function gd(e){this._internalRoot=e}function vd(e){this._internalRoot=e}vd.prototype.render=gd.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));jh(t.current,kc(),e,t,null,null)},vd.prototype.unmount=gd.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;0===e.tag&&tu(),jh(e.current,2,null,e,null,null),zc(),t[je]=null}},vd.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ne();e={blockedOn:null,target:e,priority:t};for(var r=0;r<id.length&&0!==t&&t<id[r].priority;r++);id.splice(r,0,e),0===r&&ld(e)}};var yd=i.version;if("19.0.0"!==yd)throw Error(a(527,yd,"19.0.0"));V.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=B(e)))throw Error(a(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(n=i.return)){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return F(i),e;if(s===n)return F(i),t;s=s.sibling}throw Error(a(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(a(189))}}if(r.alternate!==n)throw Error(a(190))}if(3!==r.tag)throw Error(a(188));return r.stateNode.current===r?e:t}(t),e=null===(e=null!==e?j(e):null)?null:e.stateNode};var bd={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:k,findFiberByHostInstance:Xe,reconcilerVersion:"19.0.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var wd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wd.isDisabled&&wd.supportsFiber)try{ve=wd.inject(bd),ye=wd}catch(Sd){}}t.createRoot=function(e,t){if(!o(e))throw Error(a(299));var r=!1,n="",i=Ra,s=La,l=Na;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=zh(e,1,!1,null,0,r,n,i,s,l,0,null),e[je]=t.current,Iu(8===e.nodeType?e.parentNode:e),new gd(t)},t.hydrateRoot=function(e,t,r){if(!o(e))throw Error(a(299));var n=!1,i="",s=Ra,l=La,c=Na,u=null;return null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(n=!0),void 0!==r.identifierPrefix&&(i=r.identifierPrefix),void 0!==r.onUncaughtError&&(s=r.onUncaughtError),void 0!==r.onCaughtError&&(l=r.onCaughtError),void 0!==r.onRecoverableError&&(c=r.onRecoverableError),void 0!==r.unstable_transitionCallbacks&&r.unstable_transitionCallbacks,void 0!==r.formState&&(u=r.formState)),(t=zh(e,1,!0,t,0,n,i,s,l,c,0,u)).context=Fh(null),r=t.current,(i=Do(n=kc())).callback=null,Io(r,i,n),t.current.lanes=n,Ie(t,n),mu(t),e[je]=t.current,Iu(e),new vd(t)},t.version="19.0.0"},672:(e,t,r)=>{"use strict";var n=r(43);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var a={d:{f:s,r:function(){throw Error(i(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(i(299));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.flushSync=function(e){var t=l.T,r=a.p;try{if(l.T=null,a.p=2,e)return e()}finally{l.T=t,a.p=r,a.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,a.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&a.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var r=t.as,n=c(r,t.crossOrigin),i="string"===typeof t.integrity?t.integrity:void 0,s="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===r?a.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:n,integrity:i,fetchPriority:s}):"script"===r&&a.d.X(e,{crossOrigin:n,integrity:i,fetchPriority:s,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var r=c(t.as,t.crossOrigin);a.d.M(e,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&a.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var r=t.as,n=c(r,t.crossOrigin);a.d.L(e,r,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var r=c(t.as,t.crossOrigin);a.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else a.d.m(e)},t.requestFormReset=function(e){a.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,r){return l.H.useFormState(e,t,r)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.0.0"},391:(e,t,r)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(4)},950:(e,t,r)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(672)},358:(e,t)=>{"use strict";const r=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,n=/^[\u0021-\u003A\u003C-\u007E]*$/,i=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function l(e,t,r){do{const r=e.charCodeAt(t);if(32!==r&&9!==r)return t}while(++t<r);return r}function c(e,t,r){for(;t>r;){const r=e.charCodeAt(--t);if(32!==r&&9!==r)return t+1}return r}function u(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}},799:(e,t)=>{"use strict";var r=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function i(e,t,n){var i=null;if(void 0!==n&&(i=""+n),void 0!==t.key&&(i=""+t.key),"key"in t)for(var s in n={},t)"key"!==s&&(n[s]=t[s]);else n=t;return t=n.ref,{$$typeof:r,type:e,key:i,ref:void 0!==t?t:null,props:n}}t.Fragment=n,t.jsx=i,t.jsxs=i},288:(e,t)=>{"use strict";var r=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||p}function y(){}function b(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var x=Array.isArray,S={H:null,A:null,T:null,S:null},_=Object.prototype.hasOwnProperty;function C(e,t,n,i,s,a){return n=a.ref,{$$typeof:r,type:e,key:t,ref:void 0!==n?n:null,props:a}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var A=/\/+/g;function M(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function T(){}function P(e,t,i,s,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(o){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case r:case n:u=!0;break;case d:return P((u=e._init)(e._payload),t,i,s,a)}}if(u)return a=a(e),u=""===s?"."+M(e,0):s,x(a)?(i="",null!=u&&(i=u.replace(A,"$&/")+"/"),P(a,t,i,"",(function(e){return e}))):null!=a&&(E(a)&&(l=a,c=i+(null==a.key||e&&e.key===a.key?"":(""+a.key).replace(A,"$&/")+"/")+u,a=C(l.type,c,void 0,0,0,l.props)),t.push(a)),1;u=0;var h,p=""===s?".":s+":";if(x(e))for(var m=0;m<e.length;m++)u+=P(s=e[m],t,i,o=p+M(s,m),a);else if("function"===typeof(m=null===(h=e)||"object"!==typeof h?null:"function"===typeof(h=f&&h[f]||h["@@iterator"])?h:null))for(e=m.call(e),m=0;!(s=e.next()).done;)u+=P(s=s.value,t,i,o=p+M(s,m++),a);else if("object"===o){if("function"===typeof e.then)return P(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(T,T):(e.status="pending",e.then((function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)}),(function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)}))),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,s,a);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function k(e,t,r){if(null==e)return e;var n=[],i=0;return P(e,n,"","",(function(e){return t.call(r,e,i++)})),n}function D(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function O(){}t.Children={map:k,forEach:function(e,t,r){k(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return k(e,(function(){t++})),t},toArray:function(e){return k(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=a,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,t.act=function(){throw Error("act(...) is not supported in production builds of React.")},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var n=m({},e.props),i=e.key;if(null!=t)for(s in void 0!==t.ref&&void 0,void 0!==t.key&&(i=""+t.key),t)!_.call(t,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===t.ref||(n[s]=t[s]);var s=arguments.length-2;if(1===s)n.children=r;else if(1<s){for(var a=Array(s),o=0;o<s;o++)a[o]=arguments[o+2];n.children=a}return C(e.type,i,void 0,0,0,n)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,r){var n,i={},s=null;if(null!=t)for(n in void 0!==t.key&&(s=""+t.key),t)_.call(t,n)&&"key"!==n&&"__self"!==n&&"__source"!==n&&(i[n]=t[n]);var a=arguments.length-2;if(1===a)i.children=r;else if(1<a){for(var o=Array(a),l=0;l<a;l++)o[l]=arguments[l+2];i.children=o}if(e&&e.defaultProps)for(n in a=e.defaultProps)void 0===i[n]&&(i[n]=a[n]);return C(e,s,void 0,0,0,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=S.T,r={};S.T=r;try{var n=e(),i=S.S;null!==i&&i(r,n),"object"===typeof n&&null!==n&&"function"===typeof n.then&&n.then(O,I)}catch(s){I(s)}finally{S.T=t}},t.unstable_useCacheRefresh=function(){return S.H.useCacheRefresh()},t.use=function(e){return S.H.use(e)},t.useActionState=function(e,t,r){return S.H.useActionState(e,t,r)},t.useCallback=function(e,t){return S.H.useCallback(e,t)},t.useContext=function(e){return S.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return S.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return S.H.useEffect(e,t)},t.useId=function(){return S.H.useId()},t.useImperativeHandle=function(e,t,r){return S.H.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return S.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return S.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return S.H.useMemo(e,t)},t.useOptimistic=function(e,t){return S.H.useOptimistic(e,t)},t.useReducer=function(e,t,r){return S.H.useReducer(e,t,r)},t.useRef=function(e){return S.H.useRef(e)},t.useState=function(e){return S.H.useState(e)},t.useSyncExternalStore=function(e,t,r){return S.H.useSyncExternalStore(e,t,r)},t.useTransition=function(){return S.H.useTransition()},t.version="19.0.0"},43:(e,t,r)=>{"use strict";e.exports=r(288)},579:(e,t,r)=>{"use strict";e.exports=r(799)},896:(e,t)=>{"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,i=e[n];if(!(0<s(i,t)))break e;e[n]=t,e[r]=i,r=n}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length,a=i>>>1;n<a;){var o=2*(n+1)-1,l=e[o],c=o+1,u=e[c];if(0>s(l,r))c<i&&0>s(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[o]=r,n=o);else{if(!(c<i&&0>s(u,r)))break e;e[n]=u,e[c]=r,n=c}}}return t}function s(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=n(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,r(c,t)}t=n(u)}}function x(e){if(g=!1,w(e),!m)if(null!==n(c))m=!0,D();else{var t=n(u);null!==t&&I(x,t.startTime-e)}}var S,_=!1,C=-1,E=5,A=-1;function M(){return!(t.unstable_now()-A<E)}function T(){if(_){var e=t.unstable_now();A=e;var r=!0;try{e:{m=!1,g&&(g=!1,y(C),C=-1),p=!0;var s=f;try{t:{for(w(e),d=n(c);null!==d&&!(d.expirationTime>e&&M());){var a=d.callback;if("function"===typeof a){d.callback=null,f=d.priorityLevel;var o=a(d.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){d.callback=o,w(e),r=!0;break t}d===n(c)&&i(c),w(e)}else i(c);d=n(c)}if(null!==d)r=!0;else{var l=n(u);null!==l&&I(x,l.startTime-e),r=!1}}break e}finally{d=null,f=s,p=!1}r=void 0}}finally{r?S():_=!1}}}if("function"===typeof b)S=function(){b(T)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,k=P.port2;P.port1.onmessage=T,S=function(){k.postMessage(null)}}else S=function(){v(T,0)};function D(){_||(_=!0,S())}function I(e,r){C=v((function(){e(t.unstable_now())}),r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,D())},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,i,s){var a=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,r(u,e),null===n(c)&&e===n(u)&&(g?(y(C),C=-1):g=!0,I(x,s-a))):(e.sortIndex=o,r(c,e),m||p||(m=!0,D())),e},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},853:(e,t,r)=>{"use strict";e.exports=r(896)},172:e=>{e.exports=function(e,t){this.v=e,this.k=t},e.exports.__esModule=!0,e.exports.default=e.exports},881:e=>{function t(e){function r(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return t=function(e){this.s=e,this.n=e.next},t.prototype={s:null,n:null,next:function(){return r(this.n.apply(this.s,arguments))},return:function(e){var t=this.s.return;return void 0===t?Promise.resolve({value:e,done:!0}):r(t.apply(this.s,arguments))},throw:function(e){var t=this.s.return;return void 0===t?Promise.reject(e):r(t.apply(this.s,arguments))}},new t(e)}e.exports=function(e){var r,n,i,s=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,i=Symbol.iterator);s--;){if(n&&null!=(r=e[n]))return r.call(e);if(i&&null!=(r=e[i]))return new t(r.call(e));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")},e.exports.__esModule=!0,e.exports.default=e.exports},344:(e,t,r)=>{var n=r(172);e.exports=function(e){return new n(e,0)},e.exports.__esModule=!0,e.exports.default=e.exports},693:(e,t,r)=>{var n=r(736);e.exports=function(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},897:(e,t,r)=>{var n=r(693);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}e.exports=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e},e.exports.__esModule=!0,e.exports.default=e.exports},45:(e,t,r)=>{var n=r(738).default;e.exports=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},736:(e,t,r)=>{var n=r(738).default,i=r(45);e.exports=function(e){var t=i(e,"string");return"symbol"==n(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},738:e=>{function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},958:(e,t,r)=>{var n=r(172);function i(e){var t,r;function i(t,r){try{var a=e[t](r),o=a.value,l=o instanceof n;Promise.resolve(l?o.v:o).then((function(r){if(l){var n="return"===t?"return":"next";if(!o.k||r.done)return i(n,r);r=e[n](r).value}s(a.done?"return":"normal",r)}),(function(e){i("throw",e)}))}catch(e){s("throw",e)}}function s(e,n){switch(e){case"return":t.resolve({value:n,done:!0});break;case"throw":t.reject(n);break;default:t.resolve({value:n,done:!1})}(t=t.next)?i(t.key,t.arg):r=null}this._invoke=function(e,n){return new Promise((function(s,a){var o={key:e,arg:n,resolve:s,reject:a,next:null};r?r=r.next=o:(t=r=o,i(e,n))}))},"function"!=typeof e.return&&(this.return=void 0)}i.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},i.prototype.next=function(e){return this._invoke("next",e)},i.prototype.throw=function(e){return this._invoke("throw",e)},i.prototype.return=function(e){return this._invoke("return",e)},e.exports=function(e){return function(){return new i(e.apply(this,arguments))}},e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}r.m=e,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"===typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"===typeof n.then)return n}var s=Object.create(null);r.r(s);var a={};e=e||[null,t({}),t([]),t(t)];for(var o=2&i&&n;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>a[e]=()=>n[e]));return a.default=()=>n,r.d(s,a),s}})(),r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,n)=>(r.f[n](e,t),t)),[])),r.u=e=>"static/js/"+e+"."+{23:"e56de92a",160:"06353a74",208:"f7b9fe66",293:"14d556f8",516:"e8fd21e3",519:"c34c974b",917:"940713f2",946:"7049bdf8"}[e]+".chunk.js",r.miniCssF=e=>{},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="kabinari-project:";r.l=(n,i,s,a)=>{if(e[n])e[n].push(i);else{var o,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==n||h.getAttribute("data-webpack")==t+s){o=h;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,r.nc&&o.setAttribute("nonce",r.nc),o.setAttribute("data-webpack",t+s),o.src=n),e[n]=[i];var d=(t,r)=>{o.onerror=o.onload=null,clearTimeout(f);var i=e[n];if(delete e[n],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((e=>e(r))),t)return t(r)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/Kabinari-Project/",(()=>{var e={792:0};r.f.j=(t,n)=>{var i=r.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var s=new Promise(((r,n)=>i=e[t]=[r,n]));n.push(i[2]=s);var a=r.p+r.u(t),o=new Error;r.l(a,(n=>{if(r.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var s=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+a+")",o.name="ChunkLoadError",o.type=s,o.request=a,i[1](o)}}),"chunk-"+t,t)}};var t=(t,n)=>{var i,s,a=n[0],o=n[1],l=n[2],c=0;if(a.some((t=>0!==e[t]))){for(i in o)r.o(o,i)&&(r.m[i]=o[i]);if(l)l(r)}for(t&&t(n);c<a.length;c++)s=a[c],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0},n=self.webpackChunkkabinari_project=self.webpackChunkkabinari_project||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";var e=r(43),t=r.t(e,2),n=r(391);function i(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}function s(e,t){if(null==e)return{};var r,n,s=i(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function o(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}function l(e,t,r){return(t=o(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}r(358);const h=["page"],d=["page","matches"],f=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],p=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],m=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var g="popstate";function v(){return C((function(e,t){let{pathname:r,search:n,hash:i}=e.location;return x("",{pathname:r,search:n,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:S(t)}),null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function y(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function b(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n0){}}}function w(e,t){return{usr:e.state,key:e.key,idx:t}}function x(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;return u(u({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?_(t):t),{},{state:r,key:t&&t.key||n||Math.random().toString(36).substring(2,10)})}function S(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&"?"!==r&&(t+="?"===r.charAt(0)?r:"?"+r),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function _(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function C(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:i=document.defaultView,v5Compat:s=!1}=n,a=i.history,o="POP",l=null,c=h();function h(){return(a.state||{idx:null}).idx}function d(){o="POP";let e=h(),t=null==e?null:e-c;c=e,l&&l({action:o,location:p.location,delta:t})}function f(e){let t="null"!==i.location.origin?i.location.origin:i.location.href,r="string"===typeof e?e:S(e);return r=r.replace(/ $/,"%20"),y(t,"No window.location.(origin|href) available to create URL for href: ".concat(r)),new URL(r,t)}null==c&&(c=0,a.replaceState(u(u({},a.state),{},{idx:c}),""));let p={get action(){return o},get location(){return e(i,a)},listen(e){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(g,d),l=e,()=>{i.removeEventListener(g,d),l=null}},createHref:e=>t(i,e),createURL:f,encodeLocation(e){let t=f(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o="PUSH";let n=x(p.location,e,t);r&&r(n,e),c=h()+1;let u=w(n,c),d=p.createHref(n);try{a.pushState(u,"",d)}catch(f){if(f instanceof DOMException&&"DataCloneError"===f.name)throw f;i.location.assign(d)}s&&l&&l({action:o,location:p.location,delta:1})},replace:function(e,t){o="REPLACE";let n=x(p.location,e,t);r&&r(n,e),c=h();let i=w(n,c),u=p.createHref(n);a.replaceState(i,"",u),s&&l&&l({action:o,location:p.location,delta:0})},go:e=>a.go(e)};return p}function E(e,t){return A(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function A(e,t,r,n){let i=j(("string"===typeof t?_(t):t).pathname||"/",r);if(null==i)return null;let s=M(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let r=e.length===t.length&&e.slice(0,-1).every(((e,r)=>e===t[r]));return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(s);let a=null;for(let o=0;null==a&&o<s.length;++o){let e=F(i);a=B(s[o],e,n)}return a}function M(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=(e,i,s)=>{let a={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};a.relativePath.startsWith("/")&&(y(a.relativePath.startsWith(n),'Absolute route path "'.concat(a.relativePath,'" nested under path "').concat(n,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),a.relativePath=a.relativePath.slice(n.length));let o=G([n,a.relativePath]),l=r.concat(a);e.children&&e.children.length>0&&(y(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(o,'".')),M(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:N(o,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var r;if(""!==e.path&&null!==(r=e.path)&&void 0!==r&&r.includes("?"))for(let n of T(e.path))i(e,t,n);else i(e,t)})),t}function T(e){let t=e.split("/");if(0===t.length)return[];let[r,...n]=t,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(0===n.length)return i?[s,""]:[s];let a=T(n.join("/")),o=[];return o.push(...a.map((e=>""===e?s:[s,e].join("/")))),i&&o.push(...a),o.map((t=>e.startsWith("/")&&""===t?"/":t))}var P=/^:[\w-]+$/,k=3,D=2,I=1,O=10,R=-2,L=e=>"*"===e;function N(e,t){let r=e.split("/"),n=r.length;return r.some(L)&&(n+=R),t&&(n+=D),r.filter((e=>!L(e))).reduce(((e,t)=>e+(P.test(t)?k:""===t?I:O)),n)}function B(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:n}=e,i={},s="/",a=[];for(let o=0;o<n.length;++o){let e=n[o],l=o===n.length-1,c="/"===s?t:t.slice(s.length)||"/",u=z({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),h=e.route;if(!u&&l&&r&&!n[n.length-1].route.index&&(u=z({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(i,u.params),a.push({params:i,pathname:G([s,u.pathname]),pathnameBase:q(G([s,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(s=G([s,u.pathnameBase]))}return a}function z(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];b("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,r)=>(n.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(n.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let s=new RegExp(i,t?void 0:"i");return[s,n]}(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce(((e,t,r)=>{let{paramName:n,isOptional:i}=t;if("*"===n){let e=o[r]||"";a=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[r];return e[n]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{}),pathname:s,pathnameBase:a,pattern:e}}function F(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return b(!1,'The URL path "'.concat(e,'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function j(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&"/"!==n?null:e.slice(r)||"/"}function U(e,t,r,n){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(n),"].  Please separate it out to the `to.").concat(r,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function V(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function H(e){let t=V(e);return t.map(((e,r)=>r===t.length-1?e.pathname:e.pathnameBase))}function W(e,t,r){let n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?n=_(e):(n=u({},e),y(!n.pathname||!n.pathname.includes("?"),U("?","pathname","search",n)),y(!n.pathname||!n.pathname.includes("#"),U("#","pathname","hash",n)),y(!n.search||!n.search.includes("#"),U("#","search","hash",n)));let s,a=""===e||""===n.pathname,o=a?"/":n.pathname;if(null==o)s=r;else{let e=t.length-1;if(!i&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;n.pathname=t.join("/")}s=e>=0?t[e]:"/"}let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:r,search:n="",hash:i=""}="string"===typeof e?_(e):e,s=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)})),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:s,search:X(n),hash:Y(i)}}(n,s),c=o&&"/"!==o&&o.endsWith("/"),h=(a||"."===o)&&r.endsWith("/");return l.pathname.endsWith("/")||!c&&!h||(l.pathname+="/"),l}var G=e=>e.join("/").replace(/\/\/+/g,"/"),q=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),X=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Y=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function K(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var Q=["POST","PUT","PATCH","DELETE"],Z=(new Set(Q),["GET",...Q]);new Set(Z),Symbol("ResetLoaderData");var J=e.createContext(null);J.displayName="DataRouter";var $=e.createContext(null);$.displayName="DataRouterState";var ee=e.createContext({isTransitioning:!1});ee.displayName="ViewTransition";var te=e.createContext(new Map);te.displayName="Fetchers";var re=e.createContext(null);re.displayName="Await";var ne=e.createContext(null);ne.displayName="Navigation";var ie=e.createContext(null);ie.displayName="Location";var se=e.createContext({outlet:null,matches:[],isDataRoute:!1});se.displayName="Route";var ae=e.createContext(null);ae.displayName="RouteError";function oe(){return null!=e.useContext(ie)}function le(){return y(oe(),"useLocation() may be used only in the context of a <Router> component."),e.useContext(ie).location}var ce="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ue(t){e.useContext(ne).static||e.useLayoutEffect(t)}function he(){let{isDataRoute:t}=e.useContext(se);return t?function(){let{router:t}=we("useNavigate"),r=Se("useNavigate"),n=e.useRef(!1);ue((()=>{n.current=!0}));let i=e.useCallback((async function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};b(n.current,ce),n.current&&("number"===typeof e?t.navigate(e):await t.navigate(e,u({fromRouteId:r},i)))}),[t,r]);return i}():function(){y(oe(),"useNavigate() may be used only in the context of a <Router> component.");let t=e.useContext(J),{basename:r,navigator:n}=e.useContext(ne),{matches:i}=e.useContext(se),{pathname:s}=le(),a=JSON.stringify(H(i)),o=e.useRef(!1);ue((()=>{o.current=!0}));let l=e.useCallback((function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(b(o.current,ce),!o.current)return;if("number"===typeof e)return void n.go(e);let l=W(e,JSON.parse(a),s,"path"===i.relative);null==t&&"/"!==r&&(l.pathname="/"===l.pathname?r:G([r,l.pathname])),(i.replace?n.replace:n.push)(l,i.state,i)}),[r,n,a,s,t]);return l}()}e.createContext(null);function de(t){let{relative:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=e.useContext(se),{pathname:i}=le(),s=JSON.stringify(H(n));return e.useMemo((()=>W(t,JSON.parse(s),i,"path"===r)),[t,s,i,r])}function fe(t,r,n,i){y(oe(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=e.useContext(ne),{matches:a}=e.useContext(se),o=a[a.length-1],l=o?o.params:{},c=o?o.pathname:"/",h=o?o.pathnameBase:"/",d=o&&o.route;{let e=d&&d.path||"";Ee(c,!d||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(c,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let f,p=le();if(r){var m;let e="string"===typeof r?_(r):r;y("/"===h||(null===(m=e.pathname)||void 0===m?void 0:m.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),f=e}else f=p;let g=f.pathname||"/",v=g;if("/"!==h){let e=h.replace(/^\//,"").split("/");v="/"+g.replace(/^\//,"").split("/").slice(e.length).join("/")}let w=E(t,{pathname:v});b(d||null!=w,'No routes matched location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" ')),b(null==w||void 0!==w[w.length-1].route.element||void 0!==w[w.length-1].route.Component||void 0!==w[w.length-1].route.lazy,'Matched leaf route at location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let x=ye(w&&w.map((e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:G([h,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:G([h,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),a,n,i);return r&&x?e.createElement(ie.Provider,{value:{location:u({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:"POP"}},x):x}function pe(){let t=_e(),r=K(t)?"".concat(t.status," ").concat(t.statusText):t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:i},a={padding:"2px 4px",backgroundColor:i},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=e.createElement(e.Fragment,null,e.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),e.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",e.createElement("code",{style:a},"ErrorBoundary")," or"," ",e.createElement("code",{style:a},"errorElement")," prop on your route.")),e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},r),n?e.createElement("pre",{style:s},n):null,o)}var me=e.createElement(pe,null),ge=class extends e.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?e.createElement(se.Provider,{value:this.props.routeContext},e.createElement(ae.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ve(t){let{routeContext:r,match:n,children:i}=t,s=e.useContext(J);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),e.createElement(se.Provider,{value:r},i)}function ye(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null==t){if(!n)return null;if(n.errors)t=n.matches;else{if(0!==r.length||n.initialized||!(n.matches.length>0))return null;t=n.matches}}let i=t,s=null===n||void 0===n?void 0:n.errors;if(null!=s){let e=i.findIndex((e=>e.route.id&&void 0!==(null===s||void 0===s?void 0:s[e.route.id])));y(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(s).join(","))),i=i.slice(0,Math.min(i.length,e+1))}let a=!1,o=-1;if(n)for(let e=0;e<i.length;e++){let t=i[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(o=e),t.route.id){let{loaderData:e,errors:r}=n,s=t.route.loader&&!e.hasOwnProperty(t.route.id)&&(!r||void 0===r[t.route.id]);if(t.route.lazy||s){a=!0,i=o>=0?i.slice(0,o+1):[i[0]];break}}}return i.reduceRight(((t,l,c)=>{let u,h=!1,d=null,f=null;n&&(u=s&&l.route.id?s[l.route.id]:void 0,d=l.route.errorElement||me,a&&(o<0&&0===c?(Ee("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,f=null):o===c&&(h=!0,f=l.route.hydrateFallbackElement||null)));let p=r.concat(i.slice(0,c+1)),m=()=>{let r;return r=u?d:h?f:l.route.Component?e.createElement(l.route.Component,null):l.route.element?l.route.element:t,e.createElement(ve,{match:l,routeContext:{outlet:t,matches:p,isDataRoute:null!=n},children:r})};return n&&(l.route.ErrorBoundary||l.route.errorElement||0===c)?e.createElement(ge,{location:n.location,revalidation:n.revalidation,component:d,error:u,children:m(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):m()}),null)}function be(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function we(t){let r=e.useContext(J);return y(r,be(t)),r}function xe(t){let r=e.useContext($);return y(r,be(t)),r}function Se(t){let r=function(t){let r=e.useContext(se);return y(r,be(t)),r}(t),n=r.matches[r.matches.length-1];return y(n.route.id,"".concat(t,' can only be used on routes that contain a unique "id"')),n.route.id}function _e(){var t;let r=e.useContext(ae),n=xe("useRouteError"),i=Se("useRouteError");return void 0!==r?r:null===(t=n.errors)||void 0===t?void 0:t[i]}var Ce={};function Ee(e,t,r){t||Ce[e]||(Ce[e]=!0,b(!1,r))}e.memo((function(e){let{routes:t,future:r,state:n}=e;return fe(t,void 0,n,r)}));function Ae(t){let{to:r,replace:n,state:i,relative:s}=t;y(oe(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=e.useContext(ne);b(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=e.useContext(se),{pathname:l}=le(),c=he(),u=W(r,H(o),l,"path"===s),h=JSON.stringify(u);return e.useEffect((()=>{c(JSON.parse(h),{replace:n,state:i,relative:s})}),[c,h,s,n,i]),null}function Me(e){y(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Te(t){let{basename:r="/",children:n=null,location:i,navigationType:s="POP",navigator:a,static:o=!1}=t;y(!oe(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=r.replace(/^\/*/,"/"),c=e.useMemo((()=>({basename:l,navigator:a,static:o,future:{}})),[l,a,o]);"string"===typeof i&&(i=_(i));let{pathname:u="/",search:h="",hash:d="",state:f=null,key:p="default"}=i,m=e.useMemo((()=>{let e=j(u,l);return null==e?null:{location:{pathname:e,search:h,hash:d,state:f,key:p},navigationType:s}}),[l,u,h,d,f,p,s]);return b(null!=m,'<Router basename="'.concat(l,'"> is not able to match the URL "').concat(u).concat(h).concat(d,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==m?null:e.createElement(ne.Provider,{value:c},e.createElement(ie.Provider,{children:n,value:m}))}function Pe(e){let{children:t,location:r}=e;return fe(ke(t),r)}e.Component;function ke(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return e.Children.forEach(t,((t,i)=>{if(!e.isValidElement(t))return;let s=[...r,i];if(t.type===e.Fragment)return void n.push.apply(n,ke(t.props.children,s));y(t.type===Me,"[".concat("string"===typeof t.type?t.type:t.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),y(!t.props.index||!t.props.children,"An index route cannot have child routes.");let a={id:t.props.id||s.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,hydrateFallbackElement:t.props.hydrateFallbackElement,HydrateFallback:t.props.HydrateFallback,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:!0===t.props.hasErrorBoundary||null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(a.children=ke(t.props.children,s)),n.push(a)})),n}var De="get",Ie="application/x-www-form-urlencoded";function Oe(e){return null!=e&&"string"===typeof e.tagName}var Re=null;var Le=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ne(e){return null==e||Le.has(e)?e:(b(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Ie,'"')),null)}function Be(e,t){let r,n,i,s,a;if(Oe(o=e)&&"form"===o.tagName.toLowerCase()){let a=e.getAttribute("action");n=a?j(a,t):null,r=e.getAttribute("method")||De,i=Ne(e.getAttribute("enctype"))||Ie,s=new FormData(e)}else if(function(e){return Oe(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Oe(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||a.getAttribute("action");if(n=o?j(o,t):null,r=e.getAttribute("formmethod")||a.getAttribute("method")||De,i=Ne(e.getAttribute("formenctype"))||Ne(a.getAttribute("enctype"))||Ie,s=new FormData(a,e),!function(){if(null===Re)try{new FormData(document.createElement("form"),0),Re=!1}catch(n0){Re=!0}return Re}()){let{name:t,type:r,value:n}=e;if("image"===r){let e=t?"".concat(t,"."):"";s.append("".concat(e,"x"),"0"),s.append("".concat(e,"y"),"0")}else t&&s.append(t,n)}}else{if(Oe(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=De,n=null,i=Ie,a=e}var o;return s&&"text/plain"===i&&(a=s,s=void 0),{action:n,method:r.toLowerCase(),encType:i,formData:s,body:a}}function ze(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}async function Fe(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise((()=>{}))}}function je(e){return null!=e&&"string"===typeof e.page}function Ue(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Ve(e,t,r,n,i,s){let a=(e,t)=>!r[t]||e.route.id!==r[t].route.id,o=(e,t)=>{var n;return r[t].pathname!==e.pathname||(null===(n=r[t].route.path)||void 0===n?void 0:n.endsWith("*"))&&r[t].params["*"]!==e.params["*"]};return"assets"===s?t.filter(((e,t)=>a(e,t)||o(e,t))):"data"===s?t.filter(((t,s)=>{let l=n.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(a(t,s)||o(t,s))return!0;if(t.route.shouldRevalidate){var c;let n=t.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:(null===(c=r[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof n)return n}return!0})):[]}function He(e){return[...new Set(e)]}function We(e,t){let r=new Set,n=new Set(t);return e.reduce(((e,i)=>{if(t&&!je(i)&&"script"===i.as&&i.href&&n.has(i.href))return e;let s=JSON.stringify(function(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}(i));return r.has(s)||(r.add(s),e.push({key:s,link:i})),e}),[])}function Ge(e){return{__html:e}}Symbol("SingleFetchRedirect");function qe(e){let t="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===t.pathname?t.pathname="_root.data":t.pathname="".concat(t.pathname.replace(/\/$/,""),".data"),t}e.Component;function Xe(t){let{error:r,isOutsideRemixApp:n}=t;console.error(r);let i,s=e.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://remix.run/guides/errors for more information."\n        );\n      '}});if(K(r))return e.createElement(Ye,{title:"Unhandled Thrown Response!"},e.createElement("h1",{style:{fontSize:"24px"}},r.status," ",r.statusText),s);if(r instanceof Error)0;else{let e=null==r?"Unknown Error":"object"===typeof r&&"toString"in r?r.toString():JSON.stringify(r);new Error(e)}return e.createElement(Ye,{title:"Application Error!",isOutsideRemixApp:n},e.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),e.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},i.stack),s)}function Ye(t){var r;let{title:n,renderScripts:i,isOutsideRemixApp:s,children:a}=t,{routeModules:o}=$e();return null!==o.root&&void 0!==r&&r.Layout&&!s?a:e.createElement("html",{lang:"en"},e.createElement("head",null,e.createElement("meta",{charSet:"utf-8"}),e.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),e.createElement("title",null,n)),e.createElement("body",null,e.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},a,i?e.createElement(at,null):null)))}function Ke(e){return!e}function Qe(){let t=e.useContext(J);return ze(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function Ze(){let t=e.useContext($);return ze(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Je=e.createContext(void 0);function $e(){let t=e.useContext(Je);return ze(t,"You must render this element inside a <HydratedRouter> element"),t}function et(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function tt(e,t,r){if(r&&!st)return[e[0]];if(t){let r=e.findIndex((e=>void 0!==t[e.route.id]));return e.slice(0,r+1)}return e}function rt(t){let{page:r}=t,n=s(t,h),{router:i}=Qe(),a=e.useMemo((()=>E(i.routes,r,i.basename)),[i.routes,r,i.basename]);return a?e.createElement(it,u({page:r,matches:a},n)):(console.warn("Tried to prefetch ".concat(r," but no routes matched.")),null)}function nt(t){let{manifest:r,routeModules:n}=$e(),[i,s]=e.useState([]);return e.useEffect((()=>{let e=!1;return async function(e,t,r){return We((await Promise.all(e.map((async e=>{let n=t.routes[e.route.id];if(n){let e=await Fe(n,r);return e.links?e.links():[]}return[]})))).flat(1).filter(Ue).filter((e=>"stylesheet"===e.rel||"preload"===e.rel)).map((e=>"stylesheet"===e.rel?u(u({},e),{},{rel:"prefetch",as:"style"}):u(u({},e),{},{rel:"prefetch"}))))}(t,r,n).then((t=>{e||s(t)})),()=>{e=!0}}),[t,r,n]),i}function it(t){let{page:r,matches:n}=t,i=s(t,d),a=le(),{manifest:o,routeModules:l}=$e(),{loaderData:c,matches:h}=Ze(),f=e.useMemo((()=>Ve(r,n,h,o,a,"data")),[r,n,h,o,a]),p=e.useMemo((()=>Ve(r,n,h,o,a,"assets")),[r,n,h,o,a]),m=e.useMemo((()=>{if(r===a.pathname+a.search+a.hash)return[];let e=new Set,t=!1;if(n.forEach((r=>{var n;let i=o.routes[r.route.id];i&&i.hasLoader&&(!f.some((e=>e.route.id===r.route.id))&&r.route.id in c&&null!==(n=l[r.route.id])&&void 0!==n&&n.shouldRevalidate||i.hasClientLoader?t=!0:e.add(r.route.id))})),0===e.size)return[];let i=qe(r);return t&&e.size>0&&i.searchParams.set("_routes",n.filter((t=>e.has(t.route.id))).map((e=>e.route.id)).join(",")),[i.pathname+i.search]}),[c,a,o,f,n,r,l]),g=e.useMemo((()=>function(e,t){return He(e.map((e=>{let r=t.routes[e.route.id];if(!r)return[];let n=[r.module];return r.imports&&(n=n.concat(r.imports)),n})).flat(1))}(p,o)),[p,o]),v=nt(p);return e.createElement(e.Fragment,null,m.map((t=>e.createElement("link",u({key:t,rel:"prefetch",as:"fetch",href:t},i)))),g.map((t=>e.createElement("link",u({key:t,rel:"modulepreload",href:t},i)))),v.map((t=>{let{key:r,link:n}=t;return e.createElement("link",u({key:r},n))})))}Je.displayName="FrameworkContext";var st=!1;function at(t){let{manifest:r,serverHandoffString:n,isSpaMode:i,renderMeta:s}=$e(),{router:a,static:o,staticContext:l}=Qe(),{matches:c}=Ze(),h=Ke(i);s&&(s.didRenderScripts=!0);let d=tt(c,null,i);e.useEffect((()=>{0}),[]);let f=e.useMemo((()=>{var i;let s=l?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",c=o?"".concat(null!==r.hmr&&void 0!==i&&i.runtime?"import ".concat(JSON.stringify(r.hmr.runtime),";"):"").concat(h?"":"import ".concat(JSON.stringify(r.url)),";\n").concat(d.map(((e,t)=>"import * as route".concat(t," from ").concat(JSON.stringify(r.routes[e.route.id].module),";"))).join("\n"),"\n  ").concat(h?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let r=new Set(t.state.matches.map((e=>e.route.id))),n=t.state.location.pathname.split("/").filter(Boolean),i=["/"];for(n.pop();n.length>0;)i.push("/".concat(n.join("/"))),n.pop();i.forEach((e=>{let n=E(t.routes,e,t.basename);n&&n.forEach((e=>r.add(e.route.id)))}));let s=[...r].reduce(((t,r)=>Object.assign(t,{[r]:e.routes[r]})),{});return u(u({},e),{},{routes:s})}(r,a),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(d.map(((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t))).join(","),"};\n\nimport(").concat(JSON.stringify(r.entry.module),");"):" ";return e.createElement(e.Fragment,null,e.createElement("script",u(u({},t),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:Ge(s),type:void 0})),e.createElement("script",u(u({},t),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:Ge(c),type:"module",async:!0})))}),[]),p=d.map((e=>{let t=r.routes[e.route.id];return t?(t.imports||[]).concat([t.module]):[]})).flat(1),m=st?[]:r.entry.imports.concat(p);return st?null:e.createElement(e.Fragment,null,h?null:e.createElement("link",{rel:"modulepreload",href:r.url,crossOrigin:t.crossOrigin}),e.createElement("link",{rel:"modulepreload",href:r.entry.module,crossOrigin:t.crossOrigin}),[...new Set(g)].map((r=>e.createElement("link",{key:r,rel:"modulepreload",href:r,crossOrigin:t.crossOrigin}))),f);var g}function ot(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>{t.forEach((t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)}))}}var lt="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{lt&&(window.__reactRouterVersion="7.0.2")}catch(n0){}function ct(t){let{basename:r,children:n,window:i}=t,s=e.useRef();null==s.current&&(s.current=v({window:i,v5Compat:!0}));let a=s.current,[o,l]=e.useState({action:a.action,location:a.location}),c=e.useCallback((t=>{e.startTransition((()=>l(t)))}),[l]);return e.useLayoutEffect((()=>a.listen(c)),[a,c]),e.createElement(Te,{basename:r,children:n,location:o.location,navigationType:o.action,navigator:a})}var ut=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ht=e.forwardRef((function(t,r){let n,{onClick:i,discover:a="render",prefetch:o="none",relative:l,reloadDocument:c,replace:h,state:d,target:p,to:m,preventScrollReset:g,viewTransition:v}=t,w=s(t,f),{basename:x}=e.useContext(ne),_="string"===typeof m&&ut.test(m),C=!1;if("string"===typeof m&&_&&(n=m,lt))try{let e=new URL(window.location.href),t=m.startsWith("//")?new URL(e.protocol+m):new URL(m),r=j(t.pathname,x);t.origin===e.origin&&null!=r?m=r+t.search+t.hash:C=!0}catch(n0){b(!1,'<Link to="'.concat(m,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let E=function(t){let{relative:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};y(oe(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=e.useContext(ne),{hash:s,pathname:a,search:o}=de(t,{relative:r}),l=a;return"/"!==n&&(l="/"===a?n:G([n,a])),i.createHref({pathname:l,search:o,hash:s})}(m,{relative:l}),[A,M,T]=function(t,r){let n=e.useContext(Je),[i,s]=e.useState(!1),[a,o]=e.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:h,onTouchStart:d}=r,f=e.useRef(null);e.useEffect((()=>{if("render"===t&&o(!0),"viewport"===t){let e=new IntersectionObserver((e=>{e.forEach((e=>{o(e.isIntersecting)}))}),{threshold:.5});return f.current&&e.observe(f.current),()=>{e.disconnect()}}}),[t]),e.useEffect((()=>{if(i){let e=setTimeout((()=>{o(!0)}),100);return()=>{clearTimeout(e)}}}),[i]);let p=()=>{s(!0)},m=()=>{s(!1),o(!1)};return n?"intent"!==t?[a,f,{}]:[a,f,{onFocus:et(l,p),onBlur:et(c,m),onMouseEnter:et(u,p),onMouseLeave:et(h,m),onTouchStart:et(d,p)}]:[!1,f,{}]}(o,w),P=function(t){let{target:r,replace:n,state:i,preventScrollReset:s,relative:a,viewTransition:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=he(),c=le(),u=de(t,{relative:a});return e.useCallback((e=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(e,r)){e.preventDefault();let r=void 0!==n?n:S(c)===S(u);l(t,{replace:r,state:i,preventScrollReset:s,relative:a,viewTransition:o})}}),[c,l,u,n,i,r,t,s,a,o])}(m,{replace:h,state:d,target:p,preventScrollReset:g,relative:l,viewTransition:v});let k=e.createElement("a",u(u(u({},w),T),{},{href:n||E,onClick:C||c?i:function(e){i&&i(e),e.defaultPrevented||P(e)},ref:ot(r,M),target:p,"data-discover":_||"render"!==a?void 0:"true"}));return A&&!_?e.createElement(e.Fragment,null,k,e.createElement(rt,{page:E})):k}));ht.displayName="Link";var dt=e.forwardRef((function(t,r){let{"aria-current":n="page",caseSensitive:i=!1,className:a="",end:o=!1,style:l,to:c,viewTransition:h,children:d}=t,f=s(t,p),m=de(c,{relative:f.relative}),g=le(),v=e.useContext($),{navigator:b,basename:w}=e.useContext(ne),x=null!=v&&function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.useContext(ee);y(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=mt("useViewTransitionState"),s=de(t,{relative:r.relative});if(!n.isTransitioning)return!1;let a=j(n.currentLocation.pathname,i)||n.currentLocation.pathname,o=j(n.nextLocation.pathname,i)||n.nextLocation.pathname;return null!=z(s.pathname,o)||null!=z(s.pathname,a)}(m)&&!0===h,S=b.encodeLocation?b.encodeLocation(m).pathname:m.pathname,_=g.pathname,C=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;i||(_=_.toLowerCase(),C=C?C.toLowerCase():null,S=S.toLowerCase()),C&&w&&(C=j(C,w)||C);const E="/"!==S&&S.endsWith("/")?S.length-1:S.length;let A,M=_===S||!o&&_.startsWith(S)&&"/"===_.charAt(E),T=null!=C&&(C===S||!o&&C.startsWith(S)&&"/"===C.charAt(S.length)),P={isActive:M,isPending:T,isTransitioning:x},k=M?n:void 0;A="function"===typeof a?a(P):[a,M?"active":null,T?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let D="function"===typeof l?l(P):l;return e.createElement(ht,u(u({},f),{},{"aria-current":k,className:A,ref:r,style:D,to:c,viewTransition:h}),"function"===typeof d?d(P):d)}));dt.displayName="NavLink";var ft=e.forwardRef(((t,r)=>{let{discover:n="render",fetcherKey:i,navigate:a,reloadDocument:o,replace:l,state:c,method:h=De,action:d,onSubmit:f,relative:p,preventScrollReset:g,viewTransition:v}=t,b=s(t,m),w=yt(),x=function(t){let{relative:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=e.useContext(ne),i=e.useContext(se);y(i,"useFormAction must be used inside a RouteContext");let[s]=i.matches.slice(-1),a=u({},de(t||".",{relative:r})),o=le();if(null==t){a.search=o.search;let e=new URLSearchParams(a.search),t=e.getAll("index"),r=t.some((e=>""===e));if(r){e.delete("index"),t.filter((e=>e)).forEach((t=>e.append("index",t)));let r=e.toString();a.search=r?"?".concat(r):""}}t&&"."!==t||!s.route.index||(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(a.pathname="/"===a.pathname?n:G([n,a.pathname]));return S(a)}(d,{relative:p}),_="get"===h.toLowerCase()?"get":"post",C="string"===typeof d&&ut.test(d);return e.createElement("form",u(u({ref:r,method:_,action:x,onSubmit:o?f:e=>{if(f&&f(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,r=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||h;w(t||e.currentTarget,{fetcherKey:i,method:r,navigate:a,replace:l,state:c,relative:p,preventScrollReset:g,viewTransition:v})}},b),{},{"data-discover":C||"render"!==n?void 0:"true"}))}));function pt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function mt(t){let r=e.useContext(J);return y(r,pt(t)),r}ft.displayName="Form";var gt=0,vt=()=>"__".concat(String(++gt),"__");function yt(){let{router:t}=mt("useSubmit"),{basename:r}=e.useContext(ne),n=Se("useRouteId");return e.useCallback((async function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:s,method:a,encType:o,formData:l,body:c}=Be(e,r);if(!1===i.navigate){let e=i.fetcherKey||vt();await t.fetch(e,n,i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||a,formEncType:i.encType||o,flushSync:i.flushSync})}else await t.navigate(i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||a,formEncType:i.encType||o,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})}),[t,r,n])}new TextEncoder;var bt=r(579);function wt(e){const t=new URL("https://mui.com/production-error/?code=".concat(e));for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.forEach((e=>t.searchParams.append("args[]",e))),"Minified MUI error #".concat(e,"; visit ").concat(t," for the full message.")}function xt(e){if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function St(t){if(e.isValidElement(t)||!xt(t))return t;const r={};return Object.keys(t).forEach((e=>{r[e]=St(t[e])})),r}function _t(t,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0};const i=n.clone?u({},t):t;return xt(t)&&xt(r)&&Object.keys(r).forEach((s=>{e.isValidElement(r[s])?i[s]=r[s]:xt(r[s])&&Object.prototype.hasOwnProperty.call(t,s)&&xt(t[s])?i[s]=_t(t[s],r[s],n):n.clone?i[s]=xt(r[s])?St(r[s]):r[s]:i[s]=r[s]})),i}const Ct=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MIN_SAFE_INTEGER,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.MAX_SAFE_INTEGER;return Math.max(t,Math.min(e,r))};function Et(e){return Ct(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1)}function At(e){if(e.type)return e;if("#"===e.charAt(0))return At(function(e){e=e.slice(1);const t=new RegExp(".{1,".concat(e.length>=6?2:1,"}"),"g");let r=e.match(t);return r&&1===r[0].length&&(r=r.map((e=>e+e))),r?"rgb".concat(4===r.length?"a":"","(").concat(r.map(((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3)).join(", "),")"):""}(e));const t=e.indexOf("("),r=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(r))throw new Error(wt(9,e));let n,i=e.substring(t+1,e.length-1);if("color"===r){if(i=i.split(" "),n=i.shift(),4===i.length&&"/"===i[3].charAt(0)&&(i[3]=i[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(n))throw new Error(wt(10,n))}else i=i.split(",");return i=i.map((e=>parseFloat(e))),{type:r,values:i,colorSpace:n}}const Mt=(e,t)=>{try{return(e=>{const t=At(e);return t.values.slice(0,3).map(((e,r)=>t.type.includes("hsl")&&0!==r?"".concat(e,"%"):e)).join(" ")})(e)}catch(r){return e}};function Tt(e){const{type:t,colorSpace:r}=e;let{values:n}=e;return t.includes("rgb")?n=n.map(((e,t)=>t<3?parseInt(e,10):e)):t.includes("hsl")&&(n[1]="".concat(n[1],"%"),n[2]="".concat(n[2],"%")),n=t.includes("color")?"".concat(r," ").concat(n.join(" ")):"".concat(n.join(", ")),"".concat(t,"(").concat(n,")")}function Pt(e){e=At(e);const{values:t}=e,r=t[0],n=t[1]/100,i=t[2]/100,s=n*Math.min(i,1-i),a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+r/30)%12;return i-s*Math.max(Math.min(t-3,9-t,1),-1)};let o="rgb";const l=[Math.round(255*a(0)),Math.round(255*a(8)),Math.round(255*a(4))];return"hsla"===e.type&&(o+="a",l.push(t[3])),Tt({type:o,values:l})}function kt(e){let t="hsl"===(e=At(e)).type||"hsla"===e.type?At(Pt(e)).values:e.values;return t=t.map((t=>("color"!==e.type&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4))),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function Dt(e,t){return e=At(e),t=Et(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]="/".concat(t):e.values[3]=t,Tt(e)}function It(e,t,r){try{return Dt(e,t)}catch(n){return e}}function Ot(e,t){if(e=At(e),t=Et(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let r=0;r<3;r+=1)e.values[r]*=1-t;return Tt(e)}function Rt(e,t,r){try{return Ot(e,t)}catch(n){return e}}function Lt(e,t){if(e=At(e),t=Et(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let r=0;r<3;r+=1)e.values[r]+=(255-e.values[r])*t;else if(e.type.includes("color"))for(let r=0;r<3;r+=1)e.values[r]+=(1-e.values[r])*t;return Tt(e)}function Nt(e,t,r){try{return Lt(e,t)}catch(n){return e}}function Bt(e,t,r){try{return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.15;return kt(e)>.5?Ot(e,t):Lt(e,t)}(e,t)}catch(n){return e}}const zt={black:"#000",white:"#fff"},Ft={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},jt={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Ut={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Vt={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Ht={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Wt={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Gt={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},qt=["mode","contrastThreshold","tonalOffset"];function Xt(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:zt.white,default:zt.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const Yt=Xt();function Kt(){return{text:{primary:zt.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:zt.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const Qt=Kt();function Zt(e,t,r,n){const i=n.light||n,s=n.dark||1.5*n;e[t]||(e.hasOwnProperty(r)?e[t]=e[r]:"light"===t?e.light=Lt(e.main,i):"dark"===t&&(e.dark=Ot(e.main,s)))}function Jt(e){const{mode:t="light",contrastThreshold:r=3,tonalOffset:n=.2}=e,i=s(e,qt),a=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Ht[200],light:Ht[50],dark:Ht[400]}:{main:Ht[700],light:Ht[400],dark:Ht[800]}}(t),o=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:jt[200],light:jt[50],dark:jt[400]}:{main:jt[500],light:jt[300],dark:jt[700]}}(t),l=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Ut[500],light:Ut[300],dark:Ut[700]}:{main:Ut[700],light:Ut[400],dark:Ut[800]}}(t),c=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Wt[400],light:Wt[300],dark:Wt[700]}:{main:Wt[700],light:Wt[500],dark:Wt[900]}}(t),h=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Gt[400],light:Gt[300],dark:Gt[700]}:{main:Gt[800],light:Gt[500],dark:Gt[900]}}(t),d=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Vt[400],light:Vt[300],dark:Vt[700]}:{main:"#ed6c02",light:Vt[500],dark:Vt[900]}}(t);function f(e){const t=function(e,t){const r=kt(e),n=kt(t);return(Math.max(r,n)+.05)/(Math.min(r,n)+.05)}(e,Qt.text.primary)>=r?Qt.text.primary:Yt.text.primary;return t}const p=e=>{let{color:t,name:r,mainShade:i=500,lightShade:s=300,darkShade:a=700}=e;if(t=u({},t),!t.main&&t[i]&&(t.main=t[i]),!t.hasOwnProperty("main"))throw new Error(wt(11,r?" (".concat(r,")"):"",i));if("string"!==typeof t.main)throw new Error(wt(12,r?" (".concat(r,")"):"",JSON.stringify(t.main)));return Zt(t,"light",s,n),Zt(t,"dark",a,n),t.contrastText||(t.contrastText=f(t.main)),t};let m;"light"===t?m=Xt():"dark"===t&&(m=Kt());return _t(u({common:u({},zt),mode:t,primary:p({color:a,name:"primary"}),secondary:p({color:o,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:p({color:l,name:"error"}),warning:p({color:d,name:"warning"}),info:p({color:c,name:"info"}),success:p({color:h,name:"success"}),grey:Ft,contrastThreshold:r,getContrastText:f,augmentColor:p,tonalOffset:n},m),i)}function $t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";function t(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];if(!n.length)return"";const s=n[0];return"string"!==typeof s||s.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?", ".concat(s):", var(--".concat(e?"".concat(e,"-"):"").concat(s).concat(t(...n.slice(1)),")")}return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return"var(--".concat(e?"".concat(e,"-"):"").concat(r).concat(t(...i),")")}}const er={xs:0,sm:600,md:900,lg:1200,xl:1536},tr={keys:["xs","sm","md","lg","xl"],up:e=>"@media (min-width:".concat(er[e],"px)")},rr={containerQueries:e=>({up:t=>{let r="number"===typeof t?t:er[t]||t;return"number"===typeof r&&(r="".concat(r,"px")),e?"@container ".concat(e," (min-width:").concat(r,")"):"@container (min-width:".concat(r,")")}})};function nr(e,t,r){const n=e.theme||{};if(Array.isArray(t)){const e=n.breakpoints||tr;return t.reduce(((n,i,s)=>(n[e.up(e.keys[s])]=r(t[s]),n)),{})}if("object"===typeof t){const e=n.breakpoints||tr;return Object.keys(t).reduce(((i,s)=>{if(function(e,t){return"@"===t||t.startsWith("@")&&(e.some((e=>t.startsWith("@".concat(e))))||!!t.match(/^@\d/))}(e.keys,s)){const e=function(e,t){const r=t.match(/^@([^/]+)?\/?(.+)?$/);if(!r)return null;const[,n,i]=r,s=Number.isNaN(+n)?n||0:+n;return e.containerQueries(i).up(s)}(n.containerQueries?n:rr,s);e&&(i[e]=r(t[s],s))}else if(Object.keys(e.values||er).includes(s)){i[e.up(s)]=r(t[s],s)}else{const e=s;i[e]=t[e]}return i}),{})}return r(t)}function ir(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(null===(e=t.keys)||void 0===e?void 0:e.reduce(((e,r)=>(e[t.up(r)]={},e)),{}))||{}}function sr(e,t){return e.reduce(((e,t)=>{const r=e[t];return(!r||0===Object.keys(r).length)&&delete e[t],e}),t)}function ar(e){if("string"!==typeof e)throw new Error(wt(7));return e.charAt(0).toUpperCase()+e.slice(1)}function or(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!==typeof t)return null;if(e&&e.vars&&r){const r="vars.".concat(t).split(".").reduce(((e,t)=>e&&e[t]?e[t]:null),e);if(null!=r)return r}return t.split(".").reduce(((e,t)=>e&&null!=e[t]?e[t]:null),e)}function lr(e,t,r){let n,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r;return n="function"===typeof e?e(r):Array.isArray(e)?e[r]||i:or(e,r)||i,t&&(n=t(n,i,e)),n}const cr=function(e){const{prop:t,cssProperty:r=e.prop,themeKey:n,transform:i}=e,s=e=>{if(null==e[t])return null;const s=e[t],a=or(e.theme,n)||{};return nr(e,s,(e=>{let n=lr(a,i,e);return e===n&&"string"===typeof e&&(n=lr(a,i,"".concat(t).concat("default"===e?"":ar(e)),e)),!1===r?n:{[r]:n}}))};return s.propTypes={},s.filterProps=[t],s};const ur=function(e,t){return t?_t(e,t,{clone:!1}):e};const hr={m:"margin",p:"padding"},dr={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},fr={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},pr=function(e){const t={};return r=>(void 0===t[r]&&(t[r]=e(r)),t[r])}((e=>{if(e.length>2){if(!fr[e])return[e];e=fr[e]}const[t,r]=e.split(""),n=hr[t],i=dr[r]||"";return Array.isArray(i)?i.map((e=>n+e)):[n+i]})),mr=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],gr=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],vr=[...mr,...gr];function yr(e,t,r,n){var i;const s=null!==(i=or(e,t,!0))&&void 0!==i?i:r;return"number"===typeof s||"string"===typeof s?e=>"string"===typeof e?e:"string"===typeof s?"calc(".concat(e," * ").concat(s,")"):s*e:Array.isArray(s)?e=>{if("string"===typeof e)return e;const t=Math.abs(e);const r=s[t];return e>=0?r:"number"===typeof r?-r:"-".concat(r)}:"function"===typeof s?s:()=>{}}function br(e){return yr(e,"spacing",8)}function wr(e,t){return"string"===typeof t||null==t?t:e(t)}function xr(e,t,r,n){if(!t.includes(r))return null;const i=function(e,t){return r=>e.reduce(((e,n)=>(e[n]=wr(t,r),e)),{})}(pr(r),n);return nr(e,e[r],i)}function Sr(e,t){const r=br(e.theme);return Object.keys(e).map((n=>xr(e,t,n,r))).reduce(ur,{})}function _r(e){return Sr(e,mr)}function Cr(e){return Sr(e,gr)}function Er(e){return Sr(e,vr)}_r.propTypes={},_r.filterProps=mr,Cr.propTypes={},Cr.filterProps=gr,Er.propTypes={},Er.filterProps=vr;function Ar(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:br({spacing:e});if(e.mui)return e;const r=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(0===r.length?[1]:r).map((e=>{const r=t(e);return"number"===typeof r?"".concat(r,"px"):r})).join(" ")};return r.mui=!0,r}function Mr(e){const t={};return Object.entries(e).forEach((e=>{const[r,n]=e;"object"===typeof n&&(t[r]="".concat(n.fontStyle?"".concat(n.fontStyle," "):"").concat(n.fontVariant?"".concat(n.fontVariant," "):"").concat(n.fontWeight?"".concat(n.fontWeight," "):"").concat(n.fontStretch?"".concat(n.fontStretch," "):"").concat(n.fontSize||"").concat(n.lineHeight?"/".concat(n.lineHeight," "):"").concat(n.fontFamily||""))})),t}const Tr=function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=e;t.forEach(((e,s)=>{s===t.length-1?Array.isArray(i)?i[Number(e)]=r:i&&"object"===typeof i&&(i[e]=r):i&&"object"===typeof i&&(i[e]||(i[e]=n.includes(e)?[]:{}),i=i[e])}))};function Pr(e,t){const{prefix:r,shouldSkipGeneratingVar:n}=t||{},i={},s={},a={};var o,l;return o=(e,t,o)=>{if(("string"===typeof t||"number"===typeof t)&&(!n||!n(e,t))){const n="--".concat(r?"".concat(r,"-"):"").concat(e.join("-")),l=((e,t)=>"number"===typeof t?["lineHeight","fontWeight","opacity","zIndex"].some((t=>e.includes(t)))||e[e.length-1].toLowerCase().includes("opacity")?t:"".concat(t,"px"):t)(e,t);Object.assign(i,{[n]:l}),Tr(s,e,"var(".concat(n,")"),o),Tr(a,e,"var(".concat(n,", ").concat(l,")"),o)}},l=e=>"vars"===e[0],function e(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Object.entries(t).forEach((t=>{let[i,s]=t;(!l||l&&!l([...r,i]))&&void 0!==s&&null!==s&&("object"===typeof s&&Object.keys(s).length>0?e(s,[...r,i],Array.isArray(s)?[...n,i]:n):o([...r,i],s,n))}))}(e),{css:i,vars:s,varsWithDefaults:a}}const kr=["colorSchemes","components","defaultColorScheme"];const Dr=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{getSelector:r=b,disableCssColorScheme:n,colorSchemeSelector:i}=t,{colorSchemes:a={},components:l,defaultColorScheme:c="light"}=e,h=s(e,kr),{vars:d,css:f,varsWithDefaults:p}=Pr(h,t);let m=p;const g={},{[c]:v}=a,y=s(a,[c].map(o));if(Object.entries(y||{}).forEach((e=>{let[r,n]=e;const{vars:i,css:s,varsWithDefaults:a}=Pr(n,t);m=_t(m,a),g[r]={css:s,vars:i}})),v){const{css:e,vars:r,varsWithDefaults:n}=Pr(v,t);m=_t(m,n),g[c]={css:e,vars:r}}function b(t,r){let n=i;if("class"===i&&(n=".%s"),"data"===i&&(n="[data-%s]"),null!==i&&void 0!==i&&i.startsWith("data-")&&!i.includes("%s")&&(n="[".concat(i,'="%s"]')),t){if("media"===n){var s;if(e.defaultColorScheme===t)return":root";const n=(null===(s=a[t])||void 0===s||null===(s=s.palette)||void 0===s?void 0:s.mode)||t;return{["@media (prefers-color-scheme: ".concat(n,")")]:{":root":r}}}if(n)return e.defaultColorScheme===t?":root, ".concat(n.replace("%s",String(t))):n.replace("%s",String(t))}return":root"}return{vars:m,generateThemeVars:()=>{let e=u({},d);return Object.entries(g).forEach((t=>{let[,{vars:r}]=t;e=_t(e,r)})),e},generateStyleSheets:()=>{const t=[],i=e.defaultColorScheme||"light";function l(e,r){Object.keys(r).length&&t.push("string"===typeof e?{[e]:u({},r)}:e)}l(r(void 0,u({},f)),f);const{[i]:c}=g,h=s(g,[i].map(o));if(c){var d;const{css:e}=c,t=null===(d=a[i])||void 0===d||null===(d=d.palette)||void 0===d?void 0:d.mode,s=u(!n&&t?{colorScheme:t}:{},e);l(r(i,u({},s)),s)}return Object.entries(h).forEach((e=>{var t;let[i,{css:s}]=e;const o=null===(t=a[i])||void 0===t||null===(t=t.palette)||void 0===t?void 0:t.mode,c=u(!n&&o?{colorScheme:o}:{},s);l(r(i,u({},c)),c)})),t}}};const Ir=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const n=t.reduce(((e,t)=>(t.filterProps.forEach((r=>{e[r]=t})),e)),{}),i=e=>Object.keys(e).reduce(((t,r)=>n[r]?ur(t,n[r](e)):t),{});return i.propTypes={},i.filterProps=t.reduce(((e,t)=>e.concat(t.filterProps)),[]),i};function Or(e){return"number"!==typeof e?e:"".concat(e,"px solid")}function Rr(e,t){return cr({prop:e,themeKey:"borders",transform:t})}const Lr=Rr("border",Or),Nr=Rr("borderTop",Or),Br=Rr("borderRight",Or),zr=Rr("borderBottom",Or),Fr=Rr("borderLeft",Or),jr=Rr("borderColor"),Ur=Rr("borderTopColor"),Vr=Rr("borderRightColor"),Hr=Rr("borderBottomColor"),Wr=Rr("borderLeftColor"),Gr=Rr("outline",Or),qr=Rr("outlineColor"),Xr=e=>{if(void 0!==e.borderRadius&&null!==e.borderRadius){const t=yr(e.theme,"shape.borderRadius",4),r=e=>({borderRadius:wr(t,e)});return nr(e,e.borderRadius,r)}return null};Xr.propTypes={},Xr.filterProps=["borderRadius"];Ir(Lr,Nr,Br,zr,Fr,jr,Ur,Vr,Hr,Wr,Xr,Gr,qr);const Yr=e=>{if(void 0!==e.gap&&null!==e.gap){const t=yr(e.theme,"spacing",8),r=e=>({gap:wr(t,e)});return nr(e,e.gap,r)}return null};Yr.propTypes={},Yr.filterProps=["gap"];const Kr=e=>{if(void 0!==e.columnGap&&null!==e.columnGap){const t=yr(e.theme,"spacing",8),r=e=>({columnGap:wr(t,e)});return nr(e,e.columnGap,r)}return null};Kr.propTypes={},Kr.filterProps=["columnGap"];const Qr=e=>{if(void 0!==e.rowGap&&null!==e.rowGap){const t=yr(e.theme,"spacing",8),r=e=>({rowGap:wr(t,e)});return nr(e,e.rowGap,r)}return null};Qr.propTypes={},Qr.filterProps=["rowGap"];Ir(Yr,Kr,Qr,cr({prop:"gridColumn"}),cr({prop:"gridRow"}),cr({prop:"gridAutoFlow"}),cr({prop:"gridAutoColumns"}),cr({prop:"gridAutoRows"}),cr({prop:"gridTemplateColumns"}),cr({prop:"gridTemplateRows"}),cr({prop:"gridTemplateAreas"}),cr({prop:"gridArea"}));function Zr(e,t){return"grey"===t?t:e}Ir(cr({prop:"color",themeKey:"palette",transform:Zr}),cr({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Zr}),cr({prop:"backgroundColor",themeKey:"palette",transform:Zr}));function Jr(e){return e<=1&&0!==e?"".concat(100*e,"%"):e}const $r=cr({prop:"width",transform:Jr}),en=e=>{if(void 0!==e.maxWidth&&null!==e.maxWidth){const t=t=>{var r,n;const i=(null===(r=e.theme)||void 0===r||null===(r=r.breakpoints)||void 0===r||null===(r=r.values)||void 0===r?void 0:r[t])||er[t];return i?"px"!==(null===(n=e.theme)||void 0===n||null===(n=n.breakpoints)||void 0===n?void 0:n.unit)?{maxWidth:"".concat(i).concat(e.theme.breakpoints.unit)}:{maxWidth:i}:{maxWidth:Jr(t)}};return nr(e,e.maxWidth,t)}return null};en.filterProps=["maxWidth"];const tn=cr({prop:"minWidth",transform:Jr}),rn=cr({prop:"height",transform:Jr}),nn=cr({prop:"maxHeight",transform:Jr}),sn=cr({prop:"minHeight",transform:Jr}),an=(cr({prop:"size",cssProperty:"width",transform:Jr}),cr({prop:"size",cssProperty:"height",transform:Jr}),Ir($r,en,tn,rn,nn,sn,cr({prop:"boxSizing"})),{border:{themeKey:"borders",transform:Or},borderTop:{themeKey:"borders",transform:Or},borderRight:{themeKey:"borders",transform:Or},borderBottom:{themeKey:"borders",transform:Or},borderLeft:{themeKey:"borders",transform:Or},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Or},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Xr},color:{themeKey:"palette",transform:Zr},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Zr},backgroundColor:{themeKey:"palette",transform:Zr},p:{style:Cr},pt:{style:Cr},pr:{style:Cr},pb:{style:Cr},pl:{style:Cr},px:{style:Cr},py:{style:Cr},padding:{style:Cr},paddingTop:{style:Cr},paddingRight:{style:Cr},paddingBottom:{style:Cr},paddingLeft:{style:Cr},paddingX:{style:Cr},paddingY:{style:Cr},paddingInline:{style:Cr},paddingInlineStart:{style:Cr},paddingInlineEnd:{style:Cr},paddingBlock:{style:Cr},paddingBlockStart:{style:Cr},paddingBlockEnd:{style:Cr},m:{style:_r},mt:{style:_r},mr:{style:_r},mb:{style:_r},ml:{style:_r},mx:{style:_r},my:{style:_r},margin:{style:_r},marginTop:{style:_r},marginRight:{style:_r},marginBottom:{style:_r},marginLeft:{style:_r},marginX:{style:_r},marginY:{style:_r},marginInline:{style:_r},marginInlineStart:{style:_r},marginInlineEnd:{style:_r},marginBlock:{style:_r},marginBlockStart:{style:_r},marginBlockEnd:{style:_r},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Yr},rowGap:{style:Qr},columnGap:{style:Kr},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Jr},maxWidth:{style:en},minWidth:{transform:Jr},height:{transform:Jr},maxHeight:{transform:Jr},minHeight:{transform:Jr},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}});const on=function(){function e(e,t,r,n){const i={[e]:t,theme:r},s=n[e];if(!s)return{[e]:t};const{cssProperty:a=e,themeKey:o,transform:l,style:c}=s;if(null==t)return null;if("typography"===o&&"inherit"===t)return{[e]:t};const u=or(r,o)||{};if(c)return c(i);return nr(i,t,(t=>{let r=lr(u,l,t);return t===r&&"string"===typeof t&&(r=lr(u,l,"".concat(e).concat("default"===t?"":ar(t)),t)),!1===a?r:{[a]:r}}))}return function t(r){var n;const{sx:i,theme:s={}}=r||{};if(!i)return null;const a=null!==(n=s.unstable_sxConfig)&&void 0!==n?n:an;function o(r){let n=r;if("function"===typeof r)n=r(s);else if("object"!==typeof r)return r;if(!n)return null;const i=ir(s.breakpoints),o=Object.keys(i);let l=i;return Object.keys(n).forEach((r=>{const i=function(e,t){return"function"===typeof e?e(t):e}(n[r],s);if(null!==i&&void 0!==i)if("object"===typeof i)if(a[r])l=ur(l,e(r,i,s,a));else{const e=nr({theme:s},i,(e=>({[r]:e})));!function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const n=t.reduce(((e,t)=>e.concat(Object.keys(t))),[]),i=new Set(n);return t.every((e=>i.size===Object.keys(e).length))}(e,i)?l=ur(l,e):l[r]=t({sx:i,theme:s})}else l=ur(l,e(r,i,s,a))})),function(e,t){if(!e.containerQueries)return t;const r=Object.keys(t).filter((e=>e.startsWith("@container"))).sort(((e,t)=>{var r,n;const i=/min-width:\s*([0-9.]+)/;return+((null===(r=e.match(i))||void 0===r?void 0:r[1])||0)-+((null===(n=t.match(i))||void 0===n?void 0:n[1])||0)}));return r.length?r.reduce(((e,r)=>{const n=t[r];return delete e[r],e[r]=n,e}),u({},t)):t}(s,sr(o,l))}return Array.isArray(i)?i.map(o):o(i)}}();on.filterProps=["sx"];const ln=on,cn=["values","unit","step"];function un(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:r="px",step:n=5}=e,i=s(e,cn),a=(e=>{const t=Object.keys(e).map((t=>({key:t,val:e[t]})))||[];return t.sort(((e,t)=>e.val-t.val)),t.reduce(((e,t)=>u(u({},e),{},{[t.key]:t.val})),{})})(t),o=Object.keys(a);function l(e){const n="number"===typeof t[e]?t[e]:e;return"@media (min-width:".concat(n).concat(r,")")}function c(e){const i="number"===typeof t[e]?t[e]:e;return"@media (max-width:".concat(i-n/100).concat(r,")")}function h(e,i){const s=o.indexOf(i);return"@media (min-width:".concat("number"===typeof t[e]?t[e]:e).concat(r,") and ")+"(max-width:".concat((-1!==s&&"number"===typeof t[o[s]]?t[o[s]]:i)-n/100).concat(r,")")}return u({keys:o,values:a,up:l,down:c,between:h,only:function(e){return o.indexOf(e)+1<o.length?h(e,o[o.indexOf(e)+1]):l(e)},not:function(e){const t=o.indexOf(e);return 0===t?l(o[1]):t===o.length-1?c(o[t]):h(e,o[o.indexOf(e)+1]).replace("@media","@media not all and")},unit:r},i)}const hn={borderRadius:4};function dn(e,t){const r=this;if(r.vars){var n;if(null===(n=r.colorSchemes)||void 0===n||!n[e]||"function"!==typeof r.getColorSchemeSelector)return{};let i=r.getColorSchemeSelector(e);return"&"===i?t:((i.includes("data-")||i.includes("."))&&(i="*:where(".concat(i.replace(/\s*&$/,""),") &")),{[i]:t})}return r.palette.mode===e?t:{}}const fn=["breakpoints","palette","spacing","shape"];const pn=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:t={},palette:r={},spacing:n,shape:i={}}=e,a=s(e,fn),o=un(t),l=Ar(n);let c=_t({breakpoints:o,direction:"ltr",components:{},palette:u({mode:"light"},r),spacing:l,shape:u(u({},hn),i)},a);c=function(e){const t=(e,t)=>e.replace("@media",t?"@container ".concat(t):"@container");function r(r,n){r.up=function(){return t(e.breakpoints.up(...arguments),n)},r.down=function(){return t(e.breakpoints.down(...arguments),n)},r.between=function(){return t(e.breakpoints.between(...arguments),n)},r.only=function(){return t(e.breakpoints.only(...arguments),n)},r.not=function(){const r=t(e.breakpoints.not(...arguments),n);return r.includes("not all and")?r.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):r}}const n={},i=e=>(r(n,e),n);return r(i),u(u({},e),{},{containerQueries:i})}(c),c.applyStyles=dn;for(var h=arguments.length,d=new Array(h>1?h-1:0),f=1;f<h;f++)d[f-1]=arguments[f];return c=d.reduce(((e,t)=>_t(e,t)),c),c.unstable_sxConfig=u(u({},an),null===a||void 0===a?void 0:a.unstable_sxConfig),c.unstable_sx=function(e){return ln({sx:e,theme:this})},c};function mn(e,t){return u({toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}}},t)}const gn=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];const vn={textTransform:"uppercase"},yn='"Roboto", "Helvetica", "Arial", sans-serif';function bn(e,t){const r="function"===typeof t?t(e):t,{fontFamily:n=yn,fontSize:i=14,fontWeightLight:a=300,fontWeightRegular:o=400,fontWeightMedium:l=500,fontWeightBold:c=700,htmlFontSize:h=16,allVariants:d,pxToRem:f}=r,p=s(r,gn);const m=i/14,g=f||(e=>"".concat(e/h*m,"rem")),v=(e,t,r,i,s)=>{return u(u(u({fontFamily:n,fontWeight:e,fontSize:g(t),lineHeight:r},n===yn?{letterSpacing:"".concat((a=i/t,Math.round(1e5*a)/1e5),"em")}:{}),s),d);var a},y={h1:v(a,96,1.167,-1.5),h2:v(a,60,1.2,-.5),h3:v(o,48,1.167,0),h4:v(o,34,1.235,.25),h5:v(o,24,1.334,0),h6:v(l,20,1.6,.15),subtitle1:v(o,16,1.75,.15),subtitle2:v(l,14,1.57,.1),body1:v(o,16,1.5,.15),body2:v(o,14,1.43,.15),button:v(l,14,1.75,.4,vn),caption:v(o,12,1.66,.4),overline:v(o,12,2.66,1,vn),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return _t(u({htmlFontSize:h,pxToRem:g,fontFamily:n,fontSize:i,fontWeightLight:a,fontWeightRegular:o,fontWeightMedium:l,fontWeightBold:c},y),p,{clone:!1})}function wn(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}const xn=["none",wn(0,2,1,-1,0,1,1,0,0,1,3,0),wn(0,3,1,-2,0,2,2,0,0,1,5,0),wn(0,3,3,-2,0,3,4,0,0,1,8,0),wn(0,2,4,-1,0,4,5,0,0,1,10,0),wn(0,3,5,-1,0,5,8,0,0,1,14,0),wn(0,3,5,-1,0,6,10,0,0,1,18,0),wn(0,4,5,-2,0,7,10,1,0,2,16,1),wn(0,5,5,-3,0,8,10,1,0,3,14,2),wn(0,5,6,-3,0,9,12,1,0,3,16,2),wn(0,6,6,-3,0,10,14,1,0,4,18,3),wn(0,6,7,-4,0,11,15,1,0,4,20,3),wn(0,7,8,-4,0,12,17,2,0,5,22,4),wn(0,7,8,-4,0,13,19,2,0,5,24,4),wn(0,7,9,-4,0,14,21,2,0,5,26,4),wn(0,8,9,-5,0,15,22,2,0,6,28,5),wn(0,8,10,-5,0,16,24,2,0,6,30,5),wn(0,8,11,-5,0,17,26,2,0,6,32,5),wn(0,9,11,-5,0,18,28,2,0,7,34,6),wn(0,9,12,-6,0,19,29,2,0,7,36,6),wn(0,10,13,-6,0,20,31,3,0,8,38,7),wn(0,10,13,-6,0,21,33,3,0,8,40,7),wn(0,10,14,-6,0,22,35,3,0,8,42,7),wn(0,11,14,-7,0,23,36,3,0,9,44,8),wn(0,11,15,-7,0,24,38,3,0,9,46,8)],Sn=["duration","easing","delay"],_n={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Cn={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function En(e){return"".concat(Math.round(e),"ms")}function An(e){if(!e)return 0;const t=e/36;return Math.min(Math.round(10*(4+15*t**.25+t/5)),3e3)}function Mn(e){const t=u(u({},_n),e.easing),r=u(u({},Cn),e.duration);return u(u({getAutoHeightDuration:An,create:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{duration:i=r.standard,easing:a=t.easeInOut,delay:o=0}=n;s(n,Sn);return(Array.isArray(e)?e:[e]).map((e=>"".concat(e," ").concat("string"===typeof i?i:En(i)," ").concat(a," ").concat("string"===typeof o?o:En(o)))).join(",")}},e),{},{easing:t,duration:r})}const Tn={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function Pn(){const e=u({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return function e(t){const r=Object.entries(t);for(let i=0;i<r.length;i++){const[s,a]=r[i];!xt(n=a)&&"undefined"!==typeof n&&"string"!==typeof n&&"boolean"!==typeof n&&"number"!==typeof n&&!Array.isArray(n)||s.startsWith("unstable_")?delete t[s]:xt(a)&&(t[s]=u({},a),e(t[s]))}var n}(e),"import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';\n\nconst theme = ".concat(JSON.stringify(e,null,2),";\n\ntheme.breakpoints = createBreakpoints(theme.breakpoints || {});\ntheme.transitions = createTransitions(theme.transitions || {});\n\nexport default theme;")}const kn=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function Dn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:t,mixins:r={},spacing:n,palette:i={},transitions:a={},typography:o={},shape:l}=e,c=s(e,kn);if(e.vars)throw new Error(wt(20));const h=Jt(i),d=pn(e);let f=_t(d,{mixins:mn(d.breakpoints,r),palette:h,shadows:xn.slice(),typography:bn(h,o),transitions:Mn(a),zIndex:u({},Tn)});f=_t(f,c);for(var p=arguments.length,m=new Array(p>1?p-1:0),g=1;g<p;g++)m[g-1]=arguments[g];return f=m.reduce(((e,t)=>_t(e,t)),f),f.unstable_sxConfig=u(u({},an),null===c||void 0===c?void 0:c.unstable_sxConfig),f.unstable_sx=function(e){return ln({sx:e,theme:this})},f.toRuntimeSource=Pn,f}const In=Dn;function On(e){let t;return t=e<1?5.11916*e**2:4.5*Math.log(e+1)+2,Math.round(10*t)/1e3}const Rn=["palette","opacity","overlays"],Ln=[...Array(25)].map(((e,t)=>{if(0===t)return"none";const r=On(t);return"linear-gradient(rgba(255 255 255 / ".concat(r,"), rgba(255 255 255 / ").concat(r,"))")}));function Nn(e){return{inputPlaceholder:"dark"===e?.5:.42,inputUnderline:"dark"===e?.7:.42,switchTrackDisabled:"dark"===e?.2:.12,switchTrack:"dark"===e?.3:.38}}function Bn(e){return"dark"===e?Ln:[]}function zn(e){var t;return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||"palette"===e[0]&&!(null===(t=e[1])||void 0===t||!t.match(/(mode|contrastThreshold|tonalOffset)/))}const Fn=e=>[...[...Array(25)].map(((t,r)=>"--".concat(e?"".concat(e,"-"):"","overlays-").concat(r))),"--".concat(e?"".concat(e,"-"):"","palette-AppBar-darkBg"),"--".concat(e?"".concat(e,"-"):"","palette-AppBar-darkColor")],jn=e=>(t,r)=>{const n=e.rootSelector||":root",i=e.colorSchemeSelector;let s=i;if("class"===i&&(s=".%s"),"data"===i&&(s="[data-%s]"),null!==i&&void 0!==i&&i.startsWith("data-")&&!i.includes("%s")&&(s="[".concat(i,'="%s"]')),e.defaultColorScheme===t){if("dark"===t){const i={};return Fn(e.cssVarPrefix).forEach((e=>{i[e]=r[e],delete r[e]})),"media"===s?{[n]:r,"@media (prefers-color-scheme: dark)":{[n]:i}}:s?{[s.replace("%s",t)]:i,["".concat(n,", ").concat(s.replace("%s",t))]:r}:{[n]:u(u({},r),i)}}if(s&&"media"!==s)return"".concat(n,", ").concat(s.replace("%s",String(t)))}else if(t){if("media"===s)return{["@media (prefers-color-scheme: ".concat(String(t),")")]:{[n]:r}};if(s)return s.replace("%s",String(t))}return n},Un=["palette"],Vn=["colorSchemes","defaultColorScheme","disableCssColorScheme","cssVarPrefix","shouldSkipGeneratingVar","colorSchemeSelector","rootSelector"];function Hn(e,t,r){!e[t]&&r&&(e[t]=r)}function Wn(e){return"string"===typeof e&&e.startsWith("hsl")?Pt(e):e}function Gn(e,t){"".concat(t,"Channel")in e||(e["".concat(t,"Channel")]=Mt(Wn(e[t]),("MUI: Can't create `palette.".concat(t,"Channel` because `palette.").concat(t,"` is not one of these formats: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color()."),"To suppress this warning, you need to explicitly provide the `palette.".concat(t,'Channel` as a string (in rgb format, for example "12 12 12") or undefined if you want to remove the channel token.'))))}const qn=e=>{try{return e()}catch(t){}};function Xn(e,t,r,n){var i,a,o;if(!t)return;t=!0===t?{}:t;const l="dark"===n?"dark":"light";var c;if(!r)return void(e[n]=function(e){const{palette:t={mode:"light"},opacity:r,overlays:n}=e,i=s(e,Rn),a=Jt(t);return u({palette:a,opacity:u(u({},Nn(a.mode)),r),overlays:n||Bn(a.mode)},i)}(u(u({},t),{},{palette:u({mode:l},null===(c=t)||void 0===c?void 0:c.palette)})));const h=In(u(u({},r),{},{palette:u({mode:l},null===(i=t)||void 0===i?void 0:i.palette)})),{palette:d}=h,f=s(h,Un);return e[n]=u(u({},t),{},{palette:d,opacity:u(u({},Nn(l)),null===(a=t)||void 0===a?void 0:a.opacity),overlays:(null===(o=t)||void 0===o?void 0:o.overlays)||Bn(l)}),f}function Yn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{colorSchemes:t={light:!0},defaultColorScheme:r,disableCssColorScheme:n=!1,cssVarPrefix:i="mui",shouldSkipGeneratingVar:a=zn,colorSchemeSelector:l=(t.light&&t.dark?"media":void 0),rootSelector:c=":root"}=e,h=s(e,Vn),d=Object.keys(t)[0],f=r||(t.light&&"light"!==d?"light":d),p=function(){return $t(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mui")}(i),{[f]:m,light:g,dark:v}=t,y=u({},s(t,[f,"light","dark"].map(o)));let b=m;if(("dark"===f&&!("dark"in t)||"light"===f&&!("light"in t))&&(b=!0),!b)throw new Error(wt(21,f));const w=Xn(y,b,h,f);g&&!y.light&&Xn(y,g,void 0,"light"),v&&!y.dark&&Xn(y,v,void 0,"dark");let x=u(u({defaultColorScheme:f},w),{},{cssVarPrefix:i,colorSchemeSelector:l,rootSelector:c,getCssVar:p,colorSchemes:y,font:u(u({},Mr(w.typography)),w.font),spacing:(S=h.spacing,"number"===typeof S?"".concat(S,"px"):"string"===typeof S||"function"===typeof S||Array.isArray(S)?S:"8px")});var S;Object.keys(x.colorSchemes).forEach((e=>{const t=x.colorSchemes[e].palette,r=e=>{const r=e.split("-"),n=r[1],i=r[2];return p(e,t[n][i])};var n;if("light"===t.mode&&(Hn(t.common,"background","#fff"),Hn(t.common,"onBackground","#000")),"dark"===t.mode&&(Hn(t.common,"background","#000"),Hn(t.common,"onBackground","#fff")),n=t,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"].forEach((e=>{n[e]||(n[e]={})})),"light"===t.mode){Hn(t.Alert,"errorColor",Rt(t.error.light,.6)),Hn(t.Alert,"infoColor",Rt(t.info.light,.6)),Hn(t.Alert,"successColor",Rt(t.success.light,.6)),Hn(t.Alert,"warningColor",Rt(t.warning.light,.6)),Hn(t.Alert,"errorFilledBg",r("palette-error-main")),Hn(t.Alert,"infoFilledBg",r("palette-info-main")),Hn(t.Alert,"successFilledBg",r("palette-success-main")),Hn(t.Alert,"warningFilledBg",r("palette-warning-main")),Hn(t.Alert,"errorFilledColor",qn((()=>t.getContrastText(t.error.main)))),Hn(t.Alert,"infoFilledColor",qn((()=>t.getContrastText(t.info.main)))),Hn(t.Alert,"successFilledColor",qn((()=>t.getContrastText(t.success.main)))),Hn(t.Alert,"warningFilledColor",qn((()=>t.getContrastText(t.warning.main)))),Hn(t.Alert,"errorStandardBg",Nt(t.error.light,.9)),Hn(t.Alert,"infoStandardBg",Nt(t.info.light,.9)),Hn(t.Alert,"successStandardBg",Nt(t.success.light,.9)),Hn(t.Alert,"warningStandardBg",Nt(t.warning.light,.9)),Hn(t.Alert,"errorIconColor",r("palette-error-main")),Hn(t.Alert,"infoIconColor",r("palette-info-main")),Hn(t.Alert,"successIconColor",r("palette-success-main")),Hn(t.Alert,"warningIconColor",r("palette-warning-main")),Hn(t.AppBar,"defaultBg",r("palette-grey-100")),Hn(t.Avatar,"defaultBg",r("palette-grey-400")),Hn(t.Button,"inheritContainedBg",r("palette-grey-300")),Hn(t.Button,"inheritContainedHoverBg",r("palette-grey-A100")),Hn(t.Chip,"defaultBorder",r("palette-grey-400")),Hn(t.Chip,"defaultAvatarColor",r("palette-grey-700")),Hn(t.Chip,"defaultIconColor",r("palette-grey-700")),Hn(t.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Hn(t.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Hn(t.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Hn(t.LinearProgress,"primaryBg",Nt(t.primary.main,.62)),Hn(t.LinearProgress,"secondaryBg",Nt(t.secondary.main,.62)),Hn(t.LinearProgress,"errorBg",Nt(t.error.main,.62)),Hn(t.LinearProgress,"infoBg",Nt(t.info.main,.62)),Hn(t.LinearProgress,"successBg",Nt(t.success.main,.62)),Hn(t.LinearProgress,"warningBg",Nt(t.warning.main,.62)),Hn(t.Skeleton,"bg","rgba(".concat(r("palette-text-primaryChannel")," / 0.11)")),Hn(t.Slider,"primaryTrack",Nt(t.primary.main,.62)),Hn(t.Slider,"secondaryTrack",Nt(t.secondary.main,.62)),Hn(t.Slider,"errorTrack",Nt(t.error.main,.62)),Hn(t.Slider,"infoTrack",Nt(t.info.main,.62)),Hn(t.Slider,"successTrack",Nt(t.success.main,.62)),Hn(t.Slider,"warningTrack",Nt(t.warning.main,.62));const e=Bt(t.background.default,.8);Hn(t.SnackbarContent,"bg",e),Hn(t.SnackbarContent,"color",qn((()=>t.getContrastText(e)))),Hn(t.SpeedDialAction,"fabHoverBg",Bt(t.background.paper,.15)),Hn(t.StepConnector,"border",r("palette-grey-400")),Hn(t.StepContent,"border",r("palette-grey-400")),Hn(t.Switch,"defaultColor",r("palette-common-white")),Hn(t.Switch,"defaultDisabledColor",r("palette-grey-100")),Hn(t.Switch,"primaryDisabledColor",Nt(t.primary.main,.62)),Hn(t.Switch,"secondaryDisabledColor",Nt(t.secondary.main,.62)),Hn(t.Switch,"errorDisabledColor",Nt(t.error.main,.62)),Hn(t.Switch,"infoDisabledColor",Nt(t.info.main,.62)),Hn(t.Switch,"successDisabledColor",Nt(t.success.main,.62)),Hn(t.Switch,"warningDisabledColor",Nt(t.warning.main,.62)),Hn(t.TableCell,"border",Nt(It(t.divider,1),.88)),Hn(t.Tooltip,"bg",It(t.grey[700],.92))}if("dark"===t.mode){Hn(t.Alert,"errorColor",Nt(t.error.light,.6)),Hn(t.Alert,"infoColor",Nt(t.info.light,.6)),Hn(t.Alert,"successColor",Nt(t.success.light,.6)),Hn(t.Alert,"warningColor",Nt(t.warning.light,.6)),Hn(t.Alert,"errorFilledBg",r("palette-error-dark")),Hn(t.Alert,"infoFilledBg",r("palette-info-dark")),Hn(t.Alert,"successFilledBg",r("palette-success-dark")),Hn(t.Alert,"warningFilledBg",r("palette-warning-dark")),Hn(t.Alert,"errorFilledColor",qn((()=>t.getContrastText(t.error.dark)))),Hn(t.Alert,"infoFilledColor",qn((()=>t.getContrastText(t.info.dark)))),Hn(t.Alert,"successFilledColor",qn((()=>t.getContrastText(t.success.dark)))),Hn(t.Alert,"warningFilledColor",qn((()=>t.getContrastText(t.warning.dark)))),Hn(t.Alert,"errorStandardBg",Rt(t.error.light,.9)),Hn(t.Alert,"infoStandardBg",Rt(t.info.light,.9)),Hn(t.Alert,"successStandardBg",Rt(t.success.light,.9)),Hn(t.Alert,"warningStandardBg",Rt(t.warning.light,.9)),Hn(t.Alert,"errorIconColor",r("palette-error-main")),Hn(t.Alert,"infoIconColor",r("palette-info-main")),Hn(t.Alert,"successIconColor",r("palette-success-main")),Hn(t.Alert,"warningIconColor",r("palette-warning-main")),Hn(t.AppBar,"defaultBg",r("palette-grey-900")),Hn(t.AppBar,"darkBg",r("palette-background-paper")),Hn(t.AppBar,"darkColor",r("palette-text-primary")),Hn(t.Avatar,"defaultBg",r("palette-grey-600")),Hn(t.Button,"inheritContainedBg",r("palette-grey-800")),Hn(t.Button,"inheritContainedHoverBg",r("palette-grey-700")),Hn(t.Chip,"defaultBorder",r("palette-grey-700")),Hn(t.Chip,"defaultAvatarColor",r("palette-grey-300")),Hn(t.Chip,"defaultIconColor",r("palette-grey-300")),Hn(t.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Hn(t.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Hn(t.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Hn(t.LinearProgress,"primaryBg",Rt(t.primary.main,.5)),Hn(t.LinearProgress,"secondaryBg",Rt(t.secondary.main,.5)),Hn(t.LinearProgress,"errorBg",Rt(t.error.main,.5)),Hn(t.LinearProgress,"infoBg",Rt(t.info.main,.5)),Hn(t.LinearProgress,"successBg",Rt(t.success.main,.5)),Hn(t.LinearProgress,"warningBg",Rt(t.warning.main,.5)),Hn(t.Skeleton,"bg","rgba(".concat(r("palette-text-primaryChannel")," / 0.13)")),Hn(t.Slider,"primaryTrack",Rt(t.primary.main,.5)),Hn(t.Slider,"secondaryTrack",Rt(t.secondary.main,.5)),Hn(t.Slider,"errorTrack",Rt(t.error.main,.5)),Hn(t.Slider,"infoTrack",Rt(t.info.main,.5)),Hn(t.Slider,"successTrack",Rt(t.success.main,.5)),Hn(t.Slider,"warningTrack",Rt(t.warning.main,.5));const e=Bt(t.background.default,.98);Hn(t.SnackbarContent,"bg",e),Hn(t.SnackbarContent,"color",qn((()=>t.getContrastText(e)))),Hn(t.SpeedDialAction,"fabHoverBg",Bt(t.background.paper,.15)),Hn(t.StepConnector,"border",r("palette-grey-600")),Hn(t.StepContent,"border",r("palette-grey-600")),Hn(t.Switch,"defaultColor",r("palette-grey-300")),Hn(t.Switch,"defaultDisabledColor",r("palette-grey-600")),Hn(t.Switch,"primaryDisabledColor",Rt(t.primary.main,.55)),Hn(t.Switch,"secondaryDisabledColor",Rt(t.secondary.main,.55)),Hn(t.Switch,"errorDisabledColor",Rt(t.error.main,.55)),Hn(t.Switch,"infoDisabledColor",Rt(t.info.main,.55)),Hn(t.Switch,"successDisabledColor",Rt(t.success.main,.55)),Hn(t.Switch,"warningDisabledColor",Rt(t.warning.main,.55)),Hn(t.TableCell,"border",Rt(It(t.divider,1),.68)),Hn(t.Tooltip,"bg",It(t.grey[700],.92))}Gn(t.background,"default"),Gn(t.background,"paper"),Gn(t.common,"background"),Gn(t.common,"onBackground"),Gn(t,"divider"),Object.keys(t).forEach((e=>{const r=t[e];"tonalOffset"!==e&&r&&"object"===typeof r&&(r.main&&Hn(t[e],"mainChannel",Mt(Wn(r.main))),r.light&&Hn(t[e],"lightChannel",Mt(Wn(r.light))),r.dark&&Hn(t[e],"darkChannel",Mt(Wn(r.dark))),r.contrastText&&Hn(t[e],"contrastTextChannel",Mt(Wn(r.contrastText))),"text"===e&&(Gn(t[e],"primary"),Gn(t[e],"secondary")),"action"===e&&(r.active&&Gn(t[e],"active"),r.selected&&Gn(t[e],"selected")))}))}));for(var _=arguments.length,C=new Array(_>1?_-1:0),E=1;E<_;E++)C[E-1]=arguments[E];x=C.reduce(((e,t)=>_t(e,t)),x);const A={prefix:i,disableCssColorScheme:n,shouldSkipGeneratingVar:a,getSelector:jn(x)},{vars:M,generateThemeVars:T,generateStyleSheets:P}=Dr(x,A);return x.vars=M,Object.entries(x.colorSchemes[x.defaultColorScheme]).forEach((e=>{let[t,r]=e;x[t]=r})),x.generateThemeVars=T,x.generateStyleSheets=P,x.generateSpacing=function(){return Ar(h.spacing,br(this))},x.getColorSchemeSelector=function(e){return function(t){return"media"===e?"@media (prefers-color-scheme: ".concat(t,")"):e?e.startsWith("data-")&&!e.includes("%s")?"[".concat(e,'="').concat(t,'"] &'):"class"===e?".".concat(t," &"):"data"===e?"[data-".concat(t,"] &"):"".concat(e.replace("%s",t)," &"):"&"}}(l),x.spacing=x.generateSpacing(),x.shouldSkipGeneratingVar=a,x.unstable_sxConfig=u(u({},an),null===h||void 0===h?void 0:h.unstable_sxConfig),x.unstable_sx=function(e){return ln({sx:e,theme:this})},x.toRuntimeSource=Pn,x}const Kn=["palette","cssVariables","colorSchemes","defaultColorScheme"];function Qn(e,t,r){e.colorSchemes&&r&&(e.colorSchemes[t]=u(u({},!0!==r&&r),{},{palette:Jt(u(u({},!0===r?{}:r.palette),{},{mode:t}))}))}function Zn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{palette:t,cssVariables:r=!1,colorSchemes:n=(t?void 0:{light:!0}),defaultColorScheme:i=(null===t||void 0===t?void 0:t.mode)}=e,a=s(e,Kn),o=i||"light",l=null===n||void 0===n?void 0:n[o],c=u(u({},n),t?{[o]:u(u({},"boolean"!==typeof l&&l),{},{palette:t})}:void 0);for(var h=arguments.length,d=new Array(h>1?h-1:0),f=1;f<h;f++)d[f-1]=arguments[f];if(!1===r){if(!("colorSchemes"in e))return In(e,...d);let r=t;"palette"in e||c[o]&&(!0!==c[o]?r=c[o].palette:"dark"===o&&(r={mode:"dark"}));const n=In(u(u({},e),{},{palette:r}),...d);return n.defaultColorScheme=o,n.colorSchemes=c,"light"===n.palette.mode&&(n.colorSchemes.light=u(u({},!0!==c.light&&c.light),{},{palette:n.palette}),Qn(n,"dark",c.dark)),"dark"===n.palette.mode&&(n.colorSchemes.dark=u(u({},!0!==c.dark&&c.dark),{},{palette:n.palette}),Qn(n,"light",c.light)),n}return t||"light"in c||"light"!==o||(c.light=!0),Yn(u(u({},a),{},{colorSchemes:c,defaultColorScheme:o},"boolean"!==typeof r&&r),...d)}const Jn=e.createContext(null);function $n(){return e.useContext(Jn)}const ei="function"===typeof Symbol&&Symbol.for?Symbol.for("mui.nested"):"__THEME_NESTED__";const ti=function(t){const{children:r,theme:n}=t,i=$n(),s=e.useMemo((()=>{const e=null===i?u({},n):function(e,t){if("function"===typeof t)return t(e);return u(u({},e),t)}(i,n);return null!=e&&(e[ei]=null!==i),e}),[n,i]);return(0,bt.jsx)(Jn.Provider,{value:s,children:r})};var ri=function(){function e(e){var t=this;this._insertTag=function(e){var r;r=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,r),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var r=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{r.insertRule(e,r.cssRules.length)}catch(n0){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)})),this.tags=[],this.ctr=0},e}(),ni=Math.abs,ii=String.fromCharCode,si=Object.assign;function ai(e){return e.trim()}function oi(e,t,r){return e.replace(t,r)}function li(e,t){return e.indexOf(t)}function ci(e,t){return 0|e.charCodeAt(t)}function ui(e,t,r){return e.slice(t,r)}function hi(e){return e.length}function di(e){return e.length}function fi(e,t){return t.push(e),e}var pi=1,mi=1,gi=0,vi=0,yi=0,bi="";function wi(e,t,r,n,i,s,a){return{value:e,root:t,parent:r,type:n,props:i,children:s,line:pi,column:mi,length:a,return:""}}function xi(e,t){return si(wi("",null,null,"",null,null,0),e,{length:-e.length},t)}function Si(){return yi=vi>0?ci(bi,--vi):0,mi--,10===yi&&(mi=1,pi--),yi}function _i(){return yi=vi<gi?ci(bi,vi++):0,mi++,10===yi&&(mi=1,pi++),yi}function Ci(){return ci(bi,vi)}function Ei(){return vi}function Ai(e,t){return ui(bi,e,t)}function Mi(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Ti(e){return pi=mi=1,gi=hi(bi=e),vi=0,[]}function Pi(e){return bi="",e}function ki(e){return ai(Ai(vi-1,Oi(91===e?e+2:40===e?e+1:e)))}function Di(e){for(;(yi=Ci())&&yi<33;)_i();return Mi(e)>2||Mi(yi)>3?"":" "}function Ii(e,t){for(;--t&&_i()&&!(yi<48||yi>102||yi>57&&yi<65||yi>70&&yi<97););return Ai(e,Ei()+(t<6&&32==Ci()&&32==_i()))}function Oi(e){for(;_i();)switch(yi){case e:return vi;case 34:case 39:34!==e&&39!==e&&Oi(yi);break;case 40:41===e&&Oi(e);break;case 92:_i()}return vi}function Ri(e,t){for(;_i()&&e+yi!==57&&(e+yi!==84||47!==Ci()););return"/*"+Ai(t,vi-1)+"*"+ii(47===e?e:_i())}function Li(e){for(;!Mi(Ci());)_i();return Ai(e,vi)}var Ni="-ms-",Bi="-moz-",zi="-webkit-",Fi="comm",ji="rule",Ui="decl",Vi="@keyframes";function Hi(e,t){for(var r="",n=di(e),i=0;i<n;i++)r+=t(e[i],i,e,t)||"";return r}function Wi(e,t,r,n){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case Ui:return e.return=e.return||e.value;case Fi:return"";case Vi:return e.return=e.value+"{"+Hi(e.children,n)+"}";case ji:e.value=e.props.join(",")}return hi(r=Hi(e.children,n))?e.return=e.value+"{"+r+"}":""}function Gi(e){return Pi(qi("",null,null,null,[""],e=Ti(e),0,[0],e))}function qi(e,t,r,n,i,s,a,o,l){for(var c=0,u=0,h=a,d=0,f=0,p=0,m=1,g=1,v=1,y=0,b="",w=i,x=s,S=n,_=b;g;)switch(p=y,y=_i()){case 40:if(108!=p&&58==ci(_,h-1)){-1!=li(_+=oi(ki(y),"&","&\f"),"&\f")&&(v=-1);break}case 34:case 39:case 91:_+=ki(y);break;case 9:case 10:case 13:case 32:_+=Di(p);break;case 92:_+=Ii(Ei()-1,7);continue;case 47:switch(Ci()){case 42:case 47:fi(Yi(Ri(_i(),Ei()),t,r),l);break;default:_+="/"}break;case 123*m:o[c++]=hi(_)*v;case 125*m:case 59:case 0:switch(y){case 0:case 125:g=0;case 59+u:-1==v&&(_=oi(_,/\f/g,"")),f>0&&hi(_)-h&&fi(f>32?Ki(_+";",n,r,h-1):Ki(oi(_," ","")+";",n,r,h-2),l);break;case 59:_+=";";default:if(fi(S=Xi(_,t,r,c,u,i,o,b,w=[],x=[],h),s),123===y)if(0===u)qi(_,t,S,S,w,s,h,o,x);else switch(99===d&&110===ci(_,3)?100:d){case 100:case 108:case 109:case 115:qi(e,S,S,n&&fi(Xi(e,S,S,0,0,i,o,b,i,w=[],h),x),i,x,h,o,n?w:x);break;default:qi(_,S,S,S,[""],x,0,o,x)}}c=u=f=0,m=v=1,b=_="",h=a;break;case 58:h=1+hi(_),f=p;default:if(m<1)if(123==y)--m;else if(125==y&&0==m++&&125==Si())continue;switch(_+=ii(y),y*m){case 38:v=u>0?1:(_+="\f",-1);break;case 44:o[c++]=(hi(_)-1)*v,v=1;break;case 64:45===Ci()&&(_+=ki(_i())),d=Ci(),u=h=hi(b=_+=Li(Ei())),y++;break;case 45:45===p&&2==hi(_)&&(m=0)}}return s}function Xi(e,t,r,n,i,s,a,o,l,c,u){for(var h=i-1,d=0===i?s:[""],f=di(d),p=0,m=0,g=0;p<n;++p)for(var v=0,y=ui(e,h+1,h=ni(m=a[p])),b=e;v<f;++v)(b=ai(m>0?d[v]+" "+y:oi(y,/&\f/g,d[v])))&&(l[g++]=b);return wi(e,t,r,0===i?ji:o,l,c,u)}function Yi(e,t,r){return wi(e,t,r,Fi,ii(yi),ui(e,2,-2),0)}function Ki(e,t,r,n){return wi(e,t,r,Ui,ui(e,0,n),ui(e,n+1,-1),n)}var Qi=function(e,t,r){for(var n=0,i=0;n=i,i=Ci(),38===n&&12===i&&(t[r]=1),!Mi(i);)_i();return Ai(e,vi)},Zi=function(e,t){return Pi(function(e,t){var r=-1,n=44;do{switch(Mi(n)){case 0:38===n&&12===Ci()&&(t[r]=1),e[r]+=Qi(vi-1,t,r);break;case 2:e[r]+=ki(n);break;case 4:if(44===n){e[++r]=58===Ci()?"&\f":"",t[r]=e[r].length;break}default:e[r]+=ii(n)}}while(n=_i());return e}(Ti(e),t))},Ji=new WeakMap,$i=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,r=e.parent,n=e.column===r.column&&e.line===r.line;"rule"!==r.type;)if(!(r=r.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||Ji.get(r))&&!n){Ji.set(e,!0);for(var i=[],s=Zi(t,i),a=r.props,o=0,l=0;o<s.length;o++)for(var c=0;c<a.length;c++,l++)e.props[l]=i[o]?s[o].replace(/&\f/g,a[c]):a[c]+" "+s[o]}}},es=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function ts(e,t){switch(function(e,t){return 45^ci(e,0)?(((t<<2^ci(e,0))<<2^ci(e,1))<<2^ci(e,2))<<2^ci(e,3):0}(e,t)){case 5103:return zi+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return zi+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return zi+e+Bi+e+Ni+e+e;case 6828:case 4268:return zi+e+Ni+e+e;case 6165:return zi+e+Ni+"flex-"+e+e;case 5187:return zi+e+oi(e,/(\w+).+(:[^]+)/,zi+"box-$1$2"+Ni+"flex-$1$2")+e;case 5443:return zi+e+Ni+"flex-item-"+oi(e,/flex-|-self/,"")+e;case 4675:return zi+e+Ni+"flex-line-pack"+oi(e,/align-content|flex-|-self/,"")+e;case 5548:return zi+e+Ni+oi(e,"shrink","negative")+e;case 5292:return zi+e+Ni+oi(e,"basis","preferred-size")+e;case 6060:return zi+"box-"+oi(e,"-grow","")+zi+e+Ni+oi(e,"grow","positive")+e;case 4554:return zi+oi(e,/([^-])(transform)/g,"$1"+zi+"$2")+e;case 6187:return oi(oi(oi(e,/(zoom-|grab)/,zi+"$1"),/(image-set)/,zi+"$1"),e,"")+e;case 5495:case 3959:return oi(e,/(image-set\([^]*)/,zi+"$1$`$1");case 4968:return oi(oi(e,/(.+:)(flex-)?(.*)/,zi+"box-pack:$3"+Ni+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+zi+e+e;case 4095:case 3583:case 4068:case 2532:return oi(e,/(.+)-inline(.+)/,zi+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(hi(e)-1-t>6)switch(ci(e,t+1)){case 109:if(45!==ci(e,t+4))break;case 102:return oi(e,/(.+:)(.+)-([^]+)/,"$1"+zi+"$2-$3$1"+Bi+(108==ci(e,t+3)?"$3":"$2-$3"))+e;case 115:return~li(e,"stretch")?ts(oi(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==ci(e,t+1))break;case 6444:switch(ci(e,hi(e)-3-(~li(e,"!important")&&10))){case 107:return oi(e,":",":"+zi)+e;case 101:return oi(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+zi+(45===ci(e,14)?"inline-":"")+"box$3$1"+zi+"$2$3$1"+Ni+"$2box$3")+e}break;case 5936:switch(ci(e,t+11)){case 114:return zi+e+Ni+oi(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return zi+e+Ni+oi(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return zi+e+Ni+oi(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return zi+e+Ni+e+e}return e}var rs=[function(e,t,r,n){if(e.length>-1&&!e.return)switch(e.type){case Ui:e.return=ts(e.value,e.length);break;case Vi:return Hi([xi(e,{value:oi(e.value,"@","@"+zi)})],n);case ji:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Hi([xi(e,{props:[oi(t,/:(read-\w+)/,":-moz-$1")]})],n);case"::placeholder":return Hi([xi(e,{props:[oi(t,/:(plac\w+)/,":"+zi+"input-$1")]}),xi(e,{props:[oi(t,/:(plac\w+)/,":-moz-$1")]}),xi(e,{props:[oi(t,/:(plac\w+)/,Ni+"input-$1")]})],n)}return""}))}}],ns=function(e){var t=e.key;if("css"===t){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var n,i,s=e.stylisPlugins||rs,a={},o=[];n=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),r=1;r<t.length;r++)a[t[r]]=!0;o.push(e)}));var l,c,u=[Wi,(c=function(e){l.insert(e)},function(e){e.root||(e=e.return)&&c(e)})],h=function(e){var t=di(e);return function(r,n,i,s){for(var a="",o=0;o<t;o++)a+=e[o](r,n,i,s)||"";return a}}([$i,es].concat(s,u));i=function(e,t,r,n){l=r,function(e){Hi(Gi(e),h)}(e?e+"{"+t.styles+"}":t.styles),n&&(d.inserted[t.name]=!0)};var d={key:t,sheet:new ri({key:t,container:n,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:a,registered:{},insert:i};return d.sheet.hydrate(o),d};function is(e,t,r){var n="";return r.split(" ").forEach((function(r){void 0!==e[r]?t.push(e[r]+";"):r&&(n+=r+" ")})),n}var ss=function(e,t,r){var n=e.key+"-"+t.name;!1===r&&void 0===e.registered[n]&&(e.registered[n]=t.styles)},as=function(e,t,r){ss(e,t,r);var n=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var i=t;do{e.insert(t===i?"."+n:"",i,e.sheet,!0),i=i.next}while(void 0!==i)}};var os={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function ls(e){var t=Object.create(null);return function(r){return void 0===t[r]&&(t[r]=e(r)),t[r]}}var cs=/[A-Z]|^ms/g,us=/_EMO_([^_]+?)_([^]*?)_EMO_/g,hs=function(e){return 45===e.charCodeAt(1)},ds=function(e){return null!=e&&"boolean"!==typeof e},fs=ls((function(e){return hs(e)?e:e.replace(cs,"-$&").toLowerCase()})),ps=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(us,(function(e,t,r){return gs={name:t,styles:r,next:gs},t}))}return 1===os[e]||hs(e)||"number"!==typeof t||0===t?t:t+"px"};function ms(e,t,r){if(null==r)return"";var n=r;if(void 0!==n.__emotion_styles)return n;switch(typeof r){case"boolean":return"";case"object":var i=r;if(1===i.anim)return gs={name:i.name,styles:i.styles,next:gs},i.name;var s=r;if(void 0!==s.styles){var a=s.next;if(void 0!==a)for(;void 0!==a;)gs={name:a.name,styles:a.styles,next:gs},a=a.next;return s.styles+";"}return function(e,t,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=ms(e,t,r[i])+";";else for(var s in r){var a=r[s];if("object"!==typeof a){var o=a;null!=t&&void 0!==t[o]?n+=s+"{"+t[o]+"}":ds(o)&&(n+=fs(s)+":"+ps(s,o)+";")}else if(!Array.isArray(a)||"string"!==typeof a[0]||null!=t&&void 0!==t[a[0]]){var l=ms(e,t,a);switch(s){case"animation":case"animationName":n+=fs(s)+":"+l+";";break;default:n+=s+"{"+l+"}"}}else for(var c=0;c<a.length;c++)ds(a[c])&&(n+=fs(s)+":"+ps(s,a[c])+";")}return n}(e,t,r);case"function":if(void 0!==e){var o=gs,l=r(e);return gs=o,ms(e,t,l)}}var c=r;if(null==t)return c;var u=t[c];return void 0!==u?u:c}var gs,vs=/label:\s*([^\s;{]+)\s*(;|$)/g;function ys(e,t,r){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var n=!0,i="";gs=void 0;var s=e[0];null==s||void 0===s.raw?(n=!1,i+=ms(r,t,s)):i+=s[0];for(var a=1;a<e.length;a++){if(i+=ms(r,t,e[a]),n)i+=s[a]}vs.lastIndex=0;for(var o,l="";null!==(o=vs.exec(i));)l+="-"+o[1];var c=function(e){for(var t,r=0,n=0,i=e.length;i>=4;++n,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))+(59797*(t>>>16)<<16),r=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&r)+(59797*(r>>>16)<<16);switch(i){case 3:r^=(255&e.charCodeAt(n+2))<<16;case 2:r^=(255&e.charCodeAt(n+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(n)))+(59797*(r>>>16)<<16)}return(((r=1540483477*(65535&(r^=r>>>13))+(59797*(r>>>16)<<16))^r>>>15)>>>0).toString(36)}(i)+l;return{name:c,styles:i,next:gs}}var bs=!!t.useInsertionEffect&&t.useInsertionEffect,ws=bs||function(e){return e()},xs=bs||e.useLayoutEffect,Ss=e.createContext("undefined"!==typeof HTMLElement?ns({key:"css"}):null),_s=(Ss.Provider,function(t){return(0,e.forwardRef)((function(r,n){var i=(0,e.useContext)(Ss);return t(r,i,n)}))}),Cs=e.createContext({});var Es={}.hasOwnProperty,As="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",Ms=function(e){var t=e.cache,r=e.serialized,n=e.isStringTag;return ss(t,r,n),ws((function(){return as(t,r,n)})),null},Ts=_s((function(t,r,n){var i=t.css;"string"===typeof i&&void 0!==r.registered[i]&&(i=r.registered[i]);var s=t[As],a=[i],o="";"string"===typeof t.className?o=is(r.registered,a,t.className):null!=t.className&&(o=t.className+" ");var l=ys(a,void 0,e.useContext(Cs));o+=r.key+"-"+l.name;var c={};for(var u in t)Es.call(t,u)&&"css"!==u&&u!==As&&(c[u]=t[u]);return c.className=o,n&&(c.ref=n),e.createElement(e.Fragment,null,e.createElement(Ms,{cache:r,serialized:l,isStringTag:"string"===typeof s}),e.createElement(s,c))}));const Ps=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const r=e.useContext(Cs);return r&&(n=r,0!==Object.keys(n).length)?r:t;var n},ks=["value"],Ds=e.createContext();const Is=()=>{const t=e.useContext(Ds);return null!==t&&void 0!==t&&t},Os=function(e){let{value:t}=e,r=s(e,ks);return(0,bt.jsx)(Ds.Provider,u({value:null===t||void 0===t||t},r))};function Rs(e,t){const r=u({},t);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const i=n;if("components"===i||"slots"===i)r[i]=u(u({},e[i]),r[i]);else if("componentsProps"===i||"slotProps"===i){const n=e[i],s=t[i];if(s)if(n){r[i]=u({},s);for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)){const t=e;r[i][t]=Rs(n[t],s[t])}}else r[i]=s;else r[i]=n||{}}else void 0===r[i]&&(r[i]=e[i])}return r}const Ls=e.createContext(void 0);function Ns(t){let{props:r,name:n}=t;return function(e){const{theme:t,name:r,props:n}=e;if(!t||!t.components||!t.components[r])return n;const i=t.components[r];return i.defaultProps?Rs(i.defaultProps,n):i.styleOverrides||i.variants?n:Rs(i,n)}({props:r,name:n,theme:{components:e.useContext(Ls)}})}const Bs=function(e){let{value:t,children:r}=e;return(0,bt.jsx)(Ls.Provider,{value:t,children:r})},zs={};function Fs(t,r,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return e.useMemo((()=>{const e=t&&r[t]||r;if("function"===typeof n){const s=n(e),a=t?u(u({},r),{},{[t]:s}):s;return i?()=>a:a}return t?u(u({},r),{},{[t]:n}):u(u({},r),n)}),[t,r,n,i])}const js=function(e){const{children:t,theme:r,themeId:n}=e,i=Ps(zs),s=$n()||zs,a=Fs(n,i,r),o=Fs(n,s,r,!0),l="rtl"===(n?a[n]:a).direction;return(0,bt.jsx)(ti,{theme:o,children:(0,bt.jsx)(Cs.Provider,{value:a,children:(0,bt.jsx)(Os,{value:l,children:(0,bt.jsx)(Bs,{value:n?a[n].components:a.components,children:t})})})})},Us="$$material",Vs=["theme"];function Hs(e){let{theme:t}=e,r=s(e,Vs);const n=Us in t?t[Us]:void 0;return(0,bt.jsx)(js,u(u({},r),{},{themeId:n?Us:void 0,theme:n||t}))}r(219);var Ws=function(t,r){var n=arguments;if(null==r||!Es.call(r,"css"))return e.createElement.apply(void 0,n);var i=n.length,s=new Array(i);s[0]=Ts,s[1]=function(e,t){var r={};for(var n in t)Es.call(t,n)&&(r[n]=t[n]);return r[As]=e,r}(t,r);for(var a=2;a<i;a++)s[a]=n[a];return e.createElement.apply(null,s)};!function(e){var t;t||(t=e.JSX||(e.JSX={}))}(Ws||(Ws={}));var Gs=_s((function(t,r){var n=ys([t.styles],void 0,e.useContext(Cs)),i=e.useRef();return xs((function(){var e=r.key+"-global",t=new r.sheet.constructor({key:e,nonce:r.sheet.nonce,container:r.sheet.container,speedy:r.sheet.isSpeedy}),s=!1,a=document.querySelector('style[data-emotion="'+e+" "+n.name+'"]');return r.sheet.tags.length&&(t.before=r.sheet.tags[0]),null!==a&&(s=!0,a.setAttribute("data-emotion",e),t.hydrate([a])),i.current=[t,s],function(){t.flush()}}),[r]),xs((function(){var e=i.current,t=e[0];if(e[1])e[1]=!1;else{if(void 0!==n.next&&as(r,n.next,!0),t.tags.length){var s=t.tags[t.tags.length-1].nextElementSibling;t.before=s,t.flush()}r.insert("",n,t,!1)}}),[r,n.name]),null}));function qs(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ys(t)}function Xs(){var e=qs.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function Ys(e){const{styles:t,defaultTheme:r={}}=e,n="function"===typeof t?e=>{return t(void 0===(n=e)||null===n||0===Object.keys(n).length?r:e);var n}:t;return(0,bt.jsx)(Gs,{styles:n})}const Ks="mode",Qs="color-scheme",Zs="data-color-scheme";function Js(e){if("undefined"!==typeof window&&"function"===typeof window.matchMedia&&"system"===e){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}}function $s(e,t){return"light"===e.mode||"system"===e.mode&&"light"===e.systemMode?t("light"):"dark"===e.mode||"system"===e.mode&&"dark"===e.systemMode?t("dark"):void 0}function ea(e,t){if("undefined"===typeof window)return;let r;try{r=localStorage.getItem(e)||void 0,r||localStorage.setItem(e,t)}catch(n){}return r||t}function ta(t){const{defaultMode:r="light",defaultLightColorScheme:n,defaultDarkColorScheme:i,supportedColorSchemes:s=[],modeStorageKey:a=Ks,colorSchemeStorageKey:o=Qs,storageWindow:l=("undefined"===typeof window?void 0:window),noSsr:c=!1}=t,h=s.join(","),d=s.length>1,[f,p]=e.useState((()=>{const e=ea(a,r),t=ea("".concat(o,"-light"),n),s=ea("".concat(o,"-dark"),i);return{mode:e,systemMode:Js(e),lightColorScheme:t,darkColorScheme:s}})),[m,g]=e.useState(c||!d);e.useEffect((()=>{g(!0)}),[]);const v=function(e){return $s(e,(t=>"light"===t?e.lightColorScheme:"dark"===t?e.darkColorScheme:void 0))}(f),y=e.useCallback((e=>{p((t=>{if(e===t.mode)return t;const n=null!==e&&void 0!==e?e:r;try{localStorage.setItem(a,n)}catch(i){}return u(u({},t),{},{mode:n,systemMode:Js(n)})}))}),[a,r]),b=e.useCallback((e=>{e?"string"===typeof e?e&&!h.includes(e)?console.error("`".concat(e,"` does not exist in `theme.colorSchemes`.")):p((t=>{const r=u({},t);return $s(t,(t=>{try{localStorage.setItem("".concat(o,"-").concat(t),e)}catch(n){}"light"===t&&(r.lightColorScheme=e),"dark"===t&&(r.darkColorScheme=e)})),r})):p((t=>{const r=u({},t),s=null===e.light?n:e.light,a=null===e.dark?i:e.dark;if(s)if(h.includes(s)){r.lightColorScheme=s;try{localStorage.setItem("".concat(o,"-light"),s)}catch(l){}}else console.error("`".concat(s,"` does not exist in `theme.colorSchemes`."));if(a)if(h.includes(a)){r.darkColorScheme=a;try{localStorage.setItem("".concat(o,"-dark"),a)}catch(l){}}else console.error("`".concat(a,"` does not exist in `theme.colorSchemes`."));return r})):p((e=>{try{localStorage.setItem("".concat(o,"-light"),n),localStorage.setItem("".concat(o,"-dark"),i)}catch(t){}return u(u({},e),{},{lightColorScheme:n,darkColorScheme:i})}))}),[h,o,n,i]),w=e.useCallback((e=>{"system"===f.mode&&p((t=>{const r=null!==e&&void 0!==e&&e.matches?"dark":"light";return t.systemMode===r?t:u(u({},t),{},{systemMode:r})}))}),[f.mode]),x=e.useRef(w);return x.current=w,e.useEffect((()=>{if("function"!==typeof window.matchMedia||!d)return;const e=function(){return x.current(...arguments)},t=window.matchMedia("(prefers-color-scheme: dark)");return t.addListener(e),e(t),()=>{t.removeListener(e)}}),[d]),e.useEffect((()=>{if(l&&d){const e=e=>{const t=e.newValue;"string"!==typeof e.key||!e.key.startsWith(o)||t&&!h.match(t)||(e.key.endsWith("light")&&b({light:t}),e.key.endsWith("dark")&&b({dark:t})),e.key!==a||t&&!["light","dark","system"].includes(t)||y(t||r)};return l.addEventListener("storage",e),()=>{l.removeEventListener("storage",e)}}}),[b,y,a,o,h,r,l,d]),u(u({},f),{},{mode:m?f.mode:void 0,systemMode:m?f.systemMode:void 0,colorScheme:m?v:void 0,setMode:y,setColorScheme:b})}const ra={attribute:"data-mui-color-scheme",colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:na,useColorScheme:ia,getInitColorSchemeScript:sa}=function(t){const{themeId:r,theme:n={},modeStorageKey:i=Ks,colorSchemeStorageKey:s=Qs,disableTransitionOnChange:a=!1,defaultColorScheme:o,resolveTheme:l}=t,c={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},h=e.createContext(void 0),d={},f={},p="string"===typeof o?o:o.light,m="string"===typeof o?o:o.dark;return{CssVarsProvider:function(t){var c,p,m;const{children:g,theme:v,modeStorageKey:y=i,colorSchemeStorageKey:b=s,disableTransitionOnChange:w=a,storageWindow:x=("undefined"===typeof window?void 0:window),documentNode:S=("undefined"===typeof document?void 0:document),colorSchemeNode:_=("undefined"===typeof document?void 0:document.documentElement),disableNestedContext:C=!1,disableStyleSheetGeneration:E=!1,defaultMode:A="system",noSsr:M}=t,T=e.useRef(!1),P=$n(),k=e.useContext(h),D=!!k&&!C,I=e.useMemo((()=>v||("function"===typeof n?n():n)),[v]),O=I[r],R=O||I,{colorSchemes:L=d,components:N=f,cssVarPrefix:B}=R,z=Object.keys(L).filter((e=>!!L[e])).join(","),F=e.useMemo((()=>z.split(",")),[z]),j="string"===typeof o?o:o.light,U="string"===typeof o?o:o.dark,V=L[j]&&L[U]?A:(null===(c=L[R.defaultColorScheme])||void 0===c||null===(c=c.palette)||void 0===c?void 0:c.mode)||(null===(p=R.palette)||void 0===p?void 0:p.mode),{mode:H,setMode:W,systemMode:G,lightColorScheme:q,darkColorScheme:X,colorScheme:Y,setColorScheme:K}=ta({supportedColorSchemes:F,defaultLightColorScheme:j,defaultDarkColorScheme:U,modeStorageKey:y,colorSchemeStorageKey:b,defaultMode:V,storageWindow:x,noSsr:M});let Q=H,Z=Y;D&&(Q=k.mode,Z=k.colorScheme);const J=e.useMemo((()=>{var e;const t=Z||R.defaultColorScheme,r=(null===(e=R.generateThemeVars)||void 0===e?void 0:e.call(R))||R.vars,n=u(u({},R),{},{components:N,colorSchemes:L,cssVarPrefix:B,vars:r});if("function"===typeof n.generateSpacing&&(n.spacing=n.generateSpacing()),t){const e=L[t];e&&"object"===typeof e&&Object.keys(e).forEach((t=>{e[t]&&"object"===typeof e[t]?n[t]=u(u({},n[t]),e[t]):n[t]=e[t]}))}return l?l(n):n}),[R,Z,N,L,B]),$=R.colorSchemeSelector;e.useEffect((()=>{if(Z&&_&&$&&"media"!==$){const e=$;let t=$;if("class"===e&&(t=".%s"),"data"===e&&(t="[data-%s]"),null!==e&&void 0!==e&&e.startsWith("data-")&&!e.includes("%s")&&(t="[".concat(e,'="%s"]')),t.startsWith("."))_.classList.remove(...F.map((e=>t.substring(1).replace("%s",e)))),_.classList.add(t.substring(1).replace("%s",Z));else{const e=t.replace("%s",Z).match(/\[([^\]]+)\]/);if(e){const[t,r]=e[1].split("=");r||F.forEach((e=>{_.removeAttribute(t.replace(Z,e))})),_.setAttribute(t,r?r.replace(/"|'/g,""):"")}else _.setAttribute(t,Z)}}}),[Z,$,_,F]),e.useEffect((()=>{let e;if(w&&T.current&&S){const t=S.createElement("style");t.appendChild(S.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),S.head.appendChild(t),window.getComputedStyle(S.body),e=setTimeout((()=>{S.head.removeChild(t)}),1)}return()=>{clearTimeout(e)}}),[Z,w,S]),e.useEffect((()=>(T.current=!0,()=>{T.current=!1})),[]);const ee=e.useMemo((()=>({allColorSchemes:F,colorScheme:Z,darkColorScheme:X,lightColorScheme:q,mode:Q,setColorScheme:K,setMode:W,systemMode:G})),[F,Z,X,q,Q,K,W,G,J.colorSchemeSelector]);let te=!0;(E||!1===R.cssVariables||D&&(null===P||void 0===P?void 0:P.cssVarPrefix)===B)&&(te=!1);const re=(0,bt.jsxs)(e.Fragment,{children:[(0,bt.jsx)(js,{themeId:O?r:void 0,theme:J,children:g}),te&&(0,bt.jsx)(Ys,{styles:(null===(m=J.generateStyleSheets)||void 0===m?void 0:m.call(J))||[]})]});return D?re:(0,bt.jsx)(h.Provider,{value:ee,children:re})},useColorScheme:()=>e.useContext(h)||c,getInitColorSchemeScript:e=>function(e){const{defaultMode:t="system",defaultLightColorScheme:r="light",defaultDarkColorScheme:n="dark",modeStorageKey:i=Ks,colorSchemeStorageKey:s=Qs,attribute:a=Zs,colorSchemeNode:o="document.documentElement",nonce:l}=e||{};let c="",u=a;if("class"===a&&(u=".%s"),"data"===a&&(u="[data-%s]"),u.startsWith(".")){const e=u.substring(1);c+="".concat(o,".classList.remove('").concat(e,"'.replace('%s', light), '").concat(e,"'.replace('%s', dark));\n      ").concat(o,".classList.add('").concat(e,"'.replace('%s', colorScheme));")}const h=u.match(/\[([^\]]+)\]/);if(h){const[e,t]=h[1].split("=");t||(c+="".concat(o,".removeAttribute('").concat(e,"'.replace('%s', light));\n      ").concat(o,".removeAttribute('").concat(e,"'.replace('%s', dark));")),c+="\n      ".concat(o,".setAttribute('").concat(e,"'.replace('%s', colorScheme), ").concat(t?"".concat(t,".replace('%s', colorScheme)"):'""',");")}else c+="".concat(o,".setAttribute('").concat(u,"', colorScheme);");return(0,bt.jsx)("script",{suppressHydrationWarning:!0,nonce:"undefined"===typeof window?l:"",dangerouslySetInnerHTML:{__html:"(function() {\ntry {\n  let colorScheme = '';\n  const mode = localStorage.getItem('".concat(i,"') || '").concat(t,"';\n  const dark = localStorage.getItem('").concat(s,"-dark') || '").concat(n,"';\n  const light = localStorage.getItem('").concat(s,"-light') || '").concat(r,"';\n  if (mode === 'system') {\n    // handle system mode\n    const mql = window.matchMedia('(prefers-color-scheme: dark)');\n    if (mql.matches) {\n      colorScheme = dark\n    } else {\n      colorScheme = light\n    }\n  }\n  if (mode === 'light') {\n    colorScheme = light;\n  }\n  if (mode === 'dark') {\n    colorScheme = dark;\n  }\n  if (colorScheme) {\n    ").concat(c,"\n  }\n} catch(e){}})();")}},"mui-color-scheme-init")}(u({colorSchemeStorageKey:s,defaultLightColorScheme:p,defaultDarkColorScheme:m,modeStorageKey:i},e))}}({themeId:Us,theme:()=>Zn({cssVariables:!0}),colorSchemeStorageKey:ra.colorSchemeStorageKey,modeStorageKey:ra.modeStorageKey,defaultColorScheme:{light:ra.defaultLightColorScheme,dark:ra.defaultDarkColorScheme},resolveTheme:e=>{const t=u(u({},e),{},{typography:bn(e.palette,e.typography)});return t.unstable_sx=function(e){return ln({sx:e,theme:this})},t}});const aa=na,oa=["theme"];function la(e){let{theme:t}=e,r=s(e,oa);if("function"===typeof t)return(0,bt.jsx)(Hs,u({theme:t},r));return"colorSchemes"in(Us in t?t[Us]:t)?(0,bt.jsx)(aa,u({theme:t},r)):(0,bt.jsx)(Hs,u({theme:t},r))}function ca(e){var t,r,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=ca(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}const ua=function(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=ca(e))&&(n&&(n+=" "),n+=t);return n};function ha(){return ha=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ha.apply(null,arguments)}var da=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,fa=ls((function(e){return da.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),pa=function(e){return"theme"!==e},ma=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?fa:pa},ga=function(e,t,r){var n;if(t){var i=t.shouldForwardProp;n=e.__emotion_forwardProp&&i?function(t){return e.__emotion_forwardProp(t)&&i(t)}:i}return"function"!==typeof n&&r&&(n=e.__emotion_forwardProp),n},va=function(e){var t=e.cache,r=e.serialized,n=e.isStringTag;return ss(t,r,n),ws((function(){return as(t,r,n)})),null},ya=function t(r,n){var i,s,a=r.__emotion_real===r,o=a&&r.__emotion_base||r;void 0!==n&&(i=n.label,s=n.target);var l=ga(r,n,a),c=l||ma(o),u=!c("as");return function(){var h=arguments,d=a&&void 0!==r.__emotion_styles?r.__emotion_styles.slice(0):[];if(void 0!==i&&d.push("label:"+i+";"),null==h[0]||void 0===h[0].raw)d.push.apply(d,h);else{var f=h[0];d.push(f[0]);for(var p=h.length,m=1;m<p;m++)d.push(h[m],f[m])}var g=_s((function(t,r,n){var i=u&&t.as||o,a="",h=[],f=t;if(null==t.theme){for(var p in f={},t)f[p]=t[p];f.theme=e.useContext(Cs)}"string"===typeof t.className?a=is(r.registered,h,t.className):null!=t.className&&(a=t.className+" ");var m=ys(d.concat(h),r.registered,f);a+=r.key+"-"+m.name,void 0!==s&&(a+=" "+s);var g=u&&void 0===l?ma(i):c,v={};for(var y in t)u&&"as"===y||g(y)&&(v[y]=t[y]);return v.className=a,n&&(v.ref=n),e.createElement(e.Fragment,null,e.createElement(va,{cache:r,serialized:m,isStringTag:"string"===typeof i}),e.createElement(i,v))}));return g.displayName=void 0!==i?i:"Styled("+("string"===typeof o?o:o.displayName||o.name||"Component")+")",g.defaultProps=r.defaultProps,g.__emotion_real=g,g.__emotion_base=o,g.__emotion_styles=d,g.__emotion_forwardProp=l,Object.defineProperty(g,"toString",{value:function(){return"."+s}}),g.withComponent=function(e,r){return t(e,ha({},n,r,{shouldForwardProp:ga(g,r,!0)})).apply(void 0,d)},g}}.bind(null);function ba(e,t){return ya(e,t)}["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){ya[e]=ya(e)}));const wa=[];function xa(e){return wa[0]=e,ys(wa)}const Sa=["sx"];function _a(e){const{sx:t}=e,r=s(e,Sa),{systemProps:n,otherProps:i}=(e=>{var t,r;const n={systemProps:{},otherProps:{}},i=null!==(t=null===e||void 0===e||null===(r=e.theme)||void 0===r?void 0:r.unstable_sxConfig)&&void 0!==t?t:an;return Object.keys(e).forEach((t=>{i[t]?n.systemProps[t]=e[t]:n.otherProps[t]=e[t]})),n})(r);let a;return a=Array.isArray(t)?[n,...t]:"function"===typeof t?function(){const e=t(...arguments);return xt(e)?u(u({},n),e):n}:u(u({},n),t),u(u({},i),{},{sx:a})}const Ca=pn();const Ea=function(){return Ps(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ca)},Aa=["className","component"];const Ma=e=>e,Ta=(()=>{let e=Ma;return{configure(t){e=t},generate:t=>e(t),reset(){e=Ma}}})(),Pa={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function ka(e,t){const r=Pa[t];return r?"".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui","-").concat(r):"".concat(Ta.generate(e),"-").concat(t)}function Da(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui";const n={};return t.forEach((t=>{n[t]=ka(e,t,r)})),n}const Ia=Da("MuiBox",["root"]),Oa=Zn(),Ra=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:r,defaultTheme:n,defaultClassName:i="MuiBox-root",generateClassName:a}=t,o=ba("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(ln);return e.forwardRef((function(e,t){const l=Ea(n),c=_a(e),{className:h,component:d="div"}=c,f=s(c,Aa);return(0,bt.jsx)(o,u({as:d,ref:t,className:ua(h,a?a(i):i),theme:r&&l[r]||l},f))}))}({themeId:Us,defaultTheme:Oa,defaultClassName:Ia.root,generateClassName:Ta.generate}),La=Ra;function Na(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const n={};for(const i in e){const s=e[i];let a="",o=!0;for(let e=0;e<s.length;e+=1){const n=s[e];n&&(a+=(!0===o?"":" ")+t(n),o=!1,r&&r[n]&&(a+=" "+r[n]))}n[i]=a}return n}const Ba=function(e){let{styles:t,themeId:r,defaultTheme:n={}}=e;const i=Ea(n),s="function"===typeof t?t(r&&i[r]||i):t;return(0,bt.jsx)(Ys,{styles:s})},za=Zn();const Fa=function(e){return(0,bt.jsx)(Ba,u(u({},e),{},{defaultTheme:za,themeId:Us}))};const ja=["variants"];function Ua(e){const{variants:t}=e,r=s(e,ja),n={variants:t,style:xa(r),isProcessed:!0};return n.style===r||t&&t.forEach((e=>{"function"!==typeof e.style&&(e.style=xa(e.style))})),n}const Va=["variants"],Ha=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],Wa=pn();function Ga(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}function qa(e){return e?(t,r)=>r[e]:null}function Xa(e,t){const r="function"===typeof t?t(e):t;if(Array.isArray(r))return r.flatMap((t=>Xa(e,t)));if(Array.isArray(null===r||void 0===r?void 0:r.variants)){let t;if(r.isProcessed)t=r.style;else{const{variants:e}=r;t=s(r,Va)}return Ya(e,r.variants,[t])}return null!==r&&void 0!==r&&r.isProcessed?r.style:r}function Ya(e,t){let r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];e:for(let o=0;o<t.length;o+=1){const l=t[o];var i,s;if("function"===typeof l.props){if(null!==(i=r)&&void 0!==i||(r=u(u(u({},e),e.ownerState),{},{ownerState:e.ownerState})),!l.props(r))continue}else for(const t in l.props){var a;if(e[t]!==l.props[t]&&(null===(a=e.ownerState)||void 0===a?void 0:a[t])!==l.props[t])continue e}if("function"===typeof l.style)null!==(s=r)&&void 0!==s||(r=u(u(u({},e),e.ownerState),{},{ownerState:e.ownerState})),n.push(l.style(r));else n.push(l.style)}return n}function Ka(e,t){}function Qa(e){return e?e.charAt(0).toLowerCase()+e.slice(1):e}const Za=function(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e},Ja=e=>Za(e)&&"classes"!==e,$a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:r=Wa,rootShouldForwardProp:n=Ga,slotShouldForwardProp:i=Ga}=e;function a(e){!function(e,t,r){e.theme=function(e){for(const t in e)return!1;return!0}(e.theme)?r:e.theme[t]||e.theme}(e,t,r)}return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}(e,(e=>e.filter((e=>e!==ln))));const{name:r,slot:o,skipVariantsResolver:l,skipSx:c,overridesResolver:h=qa(Qa(o))}=t,d=s(t,Ha),f=void 0!==l?l:o&&"Root"!==o&&"root"!==o||!1,p=c||!1;let m=Ga;"Root"===o||"root"===o?m=n:o?m=i:function(e){return"string"===typeof e&&e.charCodeAt(0)>96}(e)&&(m=void 0);const g=ba(e,u({shouldForwardProp:m,label:Ka(r,o)},d)),v=e=>{if("function"===typeof e&&e.__emotion_real!==e)return function(t){return Xa(t,e)};if(xt(e)){const t=Ua(e);return t.variants?function(e){return Xa(e,t)}:t.style}return e},y=function(){const t=[];for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];const o=i.map(v),l=[];if(t.push(a),r&&h&&l.push((function(e){var t;const n=null===(t=e.theme.components)||void 0===t||null===(t=t[r])||void 0===t?void 0:t.styleOverrides;if(!n)return null;const i={};for(const r in n)i[r]=Xa(e,n[r]);return h(e,i)})),r&&!f&&l.push((function(e){var t;const n=e.theme,i=null===n||void 0===n||null===(t=n.components)||void 0===t||null===(t=t[r])||void 0===t?void 0:t.variants;return i?Ya(e,i):null})),p||l.push(ln),Array.isArray(o[0])){const e=o.shift(),r=new Array(t.length).fill(""),n=new Array(l.length).fill("");let i;i=[...r,...e,...n],i.raw=[...r,...e.raw,...n],t.unshift(i)}const c=[...t,...o,...l],u=g(...c);return e.muiName&&(u.muiName=e.muiName),u};return g.withConfig&&(y.withConfig=g.withConfig),y}}({themeId:Us,defaultTheme:za,rootShouldForwardProp:Ja}),eo=$a,to={theme:void 0};const ro=function(e){let t,r;return function(n){let i=t;return void 0!==i&&n.theme===r||(to.theme=n.theme,i=Ua(e(to)),t=i,r=n.theme),i}};function no(e){return Ns(e)}const io=ar;function so(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t=>{let[,r]=t;return r&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!function(e){return"string"===typeof e.main}(e))return!1;for(const r of t)if(!e.hasOwnProperty(r)||"string"!==typeof e[r])return!1;return!0}(r,e)}}function ao(e){return ka("MuiTypography",e)}const oo=Da("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]),lo=["color"],co=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],uo={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},ho=_a,fo=eo("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.variant&&t[r.variant],"inherit"!==r.align&&t["align".concat(io(r.align))],r.noWrap&&t.noWrap,r.gutterBottom&&t.gutterBottom,r.paragraph&&t.paragraph]}})(ro((e=>{var t;let{theme:r}=e;return{margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(r.typography).filter((e=>{let[t,r]=e;return"inherit"!==t&&r&&"object"===typeof r})).map((e=>{let[t,r]=e;return{props:{variant:t},style:r}})),...Object.entries(r.palette).filter(so()).map((e=>{let[t]=e;return{props:{color:t},style:{color:(r.vars||r).palette[t].main}}})),...Object.entries((null===(t=r.palette)||void 0===t?void 0:t.text)||{}).filter((e=>{let[,t]=e;return"string"===typeof t})).map((e=>{let[t]=e;return{props:{color:"text".concat(io(t))},style:{color:(r.vars||r).palette.text[t]}}})),{props:e=>{let{ownerState:t}=e;return"inherit"!==t.align},style:{textAlign:"var(--Typography-textAlign)"}},{props:e=>{let{ownerState:t}=e;return t.noWrap},style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:e=>{let{ownerState:t}=e;return t.gutterBottom},style:{marginBottom:"0.35em"}},{props:e=>{let{ownerState:t}=e;return t.paragraph},style:{marginBottom:16}}]}}))),po={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},mo=e.forwardRef((function(e,t){const r=no({props:e,name:"MuiTypography"}),{color:n}=r,i=s(r,lo),a=!uo[n],o=ho(u(u({},i),a&&{color:n})),{align:l="inherit",className:c,component:h,gutterBottom:d=!1,noWrap:f=!1,paragraph:p=!1,variant:m="body1",variantMapping:g=po}=o,v=s(o,co),y=u(u({},o),{},{align:l,color:n,className:c,component:h,gutterBottom:d,noWrap:f,paragraph:p,variant:m,variantMapping:g}),b=h||(p?"p":g[m]||po[m])||"span",w=(e=>{const{align:t,gutterBottom:r,noWrap:n,paragraph:i,variant:s,classes:a}=e;return Na({root:["root",s,"inherit"!==e.align&&"align".concat(io(t)),r&&"gutterBottom",n&&"noWrap",i&&"paragraph"]},ao,a)})(y);return(0,bt.jsx)(fo,u(u({as:b,ref:t,className:ua(w.root,c)},v),{},{ownerState:y,style:u(u({},"inherit"!==l&&{"--Typography-textAlign":l}),v.style)}))})),go=mo;let vo=0;const yo=u({},t).useId;function bo(t){if(void 0!==yo){const e=yo();return null!==t&&void 0!==t?t:e}return function(t){const[r,n]=e.useState(t),i=t||r;return e.useEffect((()=>{null==r&&(vo+=1,n("mui-".concat(vo)))}),[r]),i}(t)}function wo(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function xo(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.useMemo((()=>r.every((e=>null==e))?null:e=>{r.forEach((t=>{wo(t,e)}))}),r)}function So(e){return e&&e.ownerDocument||document}function _o(e){return So(e).defaultView||window}const Co="undefined"!==typeof window?e.useLayoutEffect:e.useEffect;function Eo(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function n(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];clearTimeout(t),t=setTimeout((()=>{e.apply(this,i)}),r)}return n.clear=()=>{clearTimeout(t)},n}const Ao=["onChange","maxRows","minRows","style","value"];function Mo(e){return parseInt(e,10)||0}const To={visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"};const Po=e.forwardRef((function(t,r){const{onChange:n,maxRows:i,minRows:a=1,style:o,value:l}=t,c=s(t,Ao),{current:h}=e.useRef(null!=l),d=e.useRef(null),f=xo(r,d),p=e.useRef(null),m=e.useRef(null),g=e.useCallback((()=>{const e=d.current,r=_o(e).getComputedStyle(e);if("0px"===r.width)return{outerHeightStyle:0,overflowing:!1};const n=m.current;n.style.width=r.width,n.value=e.value||t.placeholder||"x","\n"===n.value.slice(-1)&&(n.value+=" ");const s=r.boxSizing,o=Mo(r.paddingBottom)+Mo(r.paddingTop),l=Mo(r.borderBottomWidth)+Mo(r.borderTopWidth),c=n.scrollHeight;n.value="x";const u=n.scrollHeight;let h=c;a&&(h=Math.max(Number(a)*u,h)),i&&(h=Math.min(Number(i)*u,h)),h=Math.max(h,u);return{outerHeightStyle:h+("border-box"===s?o+l:0),overflowing:Math.abs(h-c)<=1}}),[i,a,t.placeholder]),v=e.useCallback((()=>{const e=g();if(void 0===(t=e)||null===t||0===Object.keys(t).length||0===t.outerHeightStyle&&!t.overflowing)return;var t;const r=e.outerHeightStyle,n=d.current;p.current!==r&&(p.current=r,n.style.height="".concat(r,"px")),n.style.overflow=e.overflowing?"hidden":""}),[g]);Co((()=>{const e=()=>{v()};let t;const r=Eo(e),n=d.current,i=_o(n);let s;return i.addEventListener("resize",r),"undefined"!==typeof ResizeObserver&&(s=new ResizeObserver(e),s.observe(n)),()=>{r.clear(),cancelAnimationFrame(t),i.removeEventListener("resize",r),s&&s.disconnect()}}),[g,v]),Co((()=>{v()}));return(0,bt.jsxs)(e.Fragment,{children:[(0,bt.jsx)("textarea",u({value:l,onChange:e=>{h||v(),n&&n(e)},ref:f,rows:a,style:o},c)),(0,bt.jsx)("textarea",{"aria-hidden":!0,className:t.className,readOnly:!0,ref:m,tabIndex:-1,style:u(u(u({},To),o),{},{paddingTop:0,paddingBottom:0})})]})})),ko=Po;const Do=function(e){return"string"===typeof e};function Io(e){let{props:t,states:r,muiFormControl:n}=e;return r.reduce(((e,r)=>(e[r]=t[r],n&&"undefined"===typeof t[r]&&(e[r]=n[r]),e)),{})}const Oo=e.createContext(void 0);function Ro(){return e.useContext(Oo)}const Lo=xo,No=Co;function Bo(e){return null!=e&&!(Array.isArray(e)&&0===e.length)}function zo(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e&&(Bo(e.value)&&""!==e.value||t&&Bo(e.defaultValue)&&""!==e.defaultValue)}function Fo(e){return ka("MuiInputBase",e)}const jo=Da("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),Uo=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"];var Vo;const Ho=(e,t)=>{const{ownerState:r}=e;return[t.root,r.formControl&&t.formControl,r.startAdornment&&t.adornedStart,r.endAdornment&&t.adornedEnd,r.error&&t.error,"small"===r.size&&t.sizeSmall,r.multiline&&t.multiline,r.color&&t["color".concat(io(r.color))],r.fullWidth&&t.fullWidth,r.hiddenLabel&&t.hiddenLabel]},Wo=(e,t)=>{const{ownerState:r}=e;return[t.input,"small"===r.size&&t.inputSizeSmall,r.multiline&&t.inputMultiline,"search"===r.type&&t.inputTypeSearch,r.startAdornment&&t.inputAdornedStart,r.endAdornment&&t.inputAdornedEnd,r.hiddenLabel&&t.inputHiddenLabel]},Go=eo("div",{name:"MuiInputBase",slot:"Root",overridesResolver:Ho})(ro((e=>{let{theme:t}=e;return u(u({},t.typography.body1),{},{color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",["&.".concat(jo.disabled)]:{color:(t.vars||t).palette.text.disabled,cursor:"default"},variants:[{props:e=>{let{ownerState:t}=e;return t.multiline},style:{padding:"4px 0 5px"}},{props:e=>{let{ownerState:t,size:r}=e;return t.multiline&&"small"===r},style:{paddingTop:1}},{props:e=>{let{ownerState:t}=e;return t.fullWidth},style:{width:"100%"}}]})}))),qo=eo("input",{name:"MuiInputBase",slot:"Input",overridesResolver:Wo})(ro((e=>{let{theme:t}=e;const r="light"===t.palette.mode,n=u(u({color:"currentColor"},t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5}),{},{transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})}),i={opacity:"0 !important"},s=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":n,"&::-moz-placeholder":n,"&::-ms-input-placeholder":n,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},["label[data-shrink=false] + .".concat(jo.formControl," &")]:{"&::-webkit-input-placeholder":i,"&::-moz-placeholder":i,"&::-ms-input-placeholder":i,"&:focus::-webkit-input-placeholder":s,"&:focus::-moz-placeholder":s,"&:focus::-ms-input-placeholder":s},["&.".concat(jo.disabled)]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},variants:[{props:e=>{let{ownerState:t}=e;return!t.disableInjectingGlobalStyles},style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:e=>{let{ownerState:t}=e;return t.multiline},style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}}))),Xo=function(e){return function(t){return(0,bt.jsx)(Fa,{styles:"function"===typeof e?r=>e(u({theme:r},t)):e})}}({"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}),Yo=e.forwardRef((function(t,r){var n;const i=no({props:t,name:"MuiInputBase"}),{"aria-describedby":a,autoComplete:o,autoFocus:l,className:c,color:h,components:d={},componentsProps:f={},defaultValue:p,disabled:m,disableInjectingGlobalStyles:g,endAdornment:v,error:y,fullWidth:b=!1,id:w,inputComponent:x="input",inputProps:S={},inputRef:_,margin:C,maxRows:E,minRows:A,multiline:M=!1,name:T,onBlur:P,onChange:k,onClick:D,onFocus:I,onKeyDown:O,onKeyUp:R,placeholder:L,readOnly:N,renderSuffix:B,rows:z,size:F,slotProps:j={},slots:U={},startAdornment:V,type:H="text",value:W}=i,G=s(i,Uo),q=null!=S.value?S.value:W,{current:X}=e.useRef(null!=q),Y=e.useRef(),K=e.useCallback((e=>{0}),[]),Q=Lo(Y,_,S.ref,K),[Z,J]=e.useState(!1),$=Ro();const ee=Io({props:i,muiFormControl:$,states:["color","disabled","error","hiddenLabel","size","required","filled"]});ee.focused=$?$.focused:Z,e.useEffect((()=>{!$&&m&&Z&&(J(!1),P&&P())}),[$,m,Z,P]);const te=$&&$.onFilled,re=$&&$.onEmpty,ne=e.useCallback((e=>{zo(e)?te&&te():re&&re()}),[te,re]);No((()=>{X&&ne({value:q})}),[q,ne,X]);e.useEffect((()=>{ne(Y.current)}),[]);let ie=x,se=S;M&&"input"===ie&&(se=u(z?{type:void 0,minRows:z,maxRows:z}:{type:void 0,maxRows:E,minRows:A},se),ie=ko);e.useEffect((()=>{$&&$.setAdornedStart(Boolean(V))}),[$,V]);const ae=u(u({},i),{},{color:ee.color||"primary",disabled:ee.disabled,endAdornment:v,error:ee.error,focused:ee.focused,formControl:$,fullWidth:b,hiddenLabel:ee.hiddenLabel,multiline:M,size:ee.size,startAdornment:V,type:H}),oe=(e=>{const{classes:t,color:r,disabled:n,error:i,endAdornment:s,focused:a,formControl:o,fullWidth:l,hiddenLabel:c,multiline:u,readOnly:h,size:d,startAdornment:f,type:p}=e;return Na({root:["root","color".concat(io(r)),n&&"disabled",i&&"error",l&&"fullWidth",a&&"focused",o&&"formControl",d&&"medium"!==d&&"size".concat(io(d)),u&&"multiline",f&&"adornedStart",s&&"adornedEnd",c&&"hiddenLabel",h&&"readOnly"],input:["input",n&&"disabled","search"===p&&"inputTypeSearch",u&&"inputMultiline","small"===d&&"inputSizeSmall",c&&"inputHiddenLabel",f&&"inputAdornedStart",s&&"inputAdornedEnd",h&&"readOnly"]},Fo,t)})(ae),le=U.root||d.Root||Go,ce=j.root||f.root||{},ue=U.input||d.Input||qo;return se=u(u({},se),null!==(n=j.input)&&void 0!==n?n:f.input),(0,bt.jsxs)(e.Fragment,{children:[!g&&"function"===typeof Xo&&(Vo||(Vo=(0,bt.jsx)(Xo,{}))),(0,bt.jsxs)(le,u(u(u(u({},ce),{},{ref:r,onClick:e=>{Y.current&&e.currentTarget===e.target&&Y.current.focus(),D&&D(e)}},G),!Do(le)&&{ownerState:u(u({},ae),ce.ownerState)}),{},{className:ua(oe.root,ce.className,c,N&&"MuiInputBase-readOnly"),children:[V,(0,bt.jsx)(Oo.Provider,{value:null,children:(0,bt.jsx)(ue,u(u(u({"aria-invalid":ee.error,"aria-describedby":a,autoComplete:o,autoFocus:l,defaultValue:p,disabled:ee.disabled,id:w,onAnimationStart:e=>{ne("mui-auto-fill-cancel"===e.animationName?Y.current:{value:"x"})},name:T,placeholder:L,readOnly:N,required:ee.required,rows:z,value:q,onKeyDown:O,onKeyUp:R,type:H},se),!Do(ue)&&{as:ie,ownerState:u(u({},ae),se.ownerState)}),{},{ref:Q,className:ua(oe.input,se.className,N&&"MuiInputBase-readOnly"),onBlur:e=>{P&&P(e),S.onBlur&&S.onBlur(e),$&&$.onBlur?$.onBlur(e):J(!1)},onChange:function(e){if(!X){const t=e.target||Y.current;if(null==t)throw new Error(wt(1));ne({value:t.value})}for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];S.onChange&&S.onChange(e,...r),k&&k(e,...r)},onFocus:e=>{I&&I(e),S.onFocus&&S.onFocus(e),$&&$.onFocus?$.onFocus(e):J(!0)}}))}),v,B?B(u(u({},ee),{},{startAdornment:V})):null]}))]})})),Ko=Yo;function Qo(e){return ka("MuiInput",e)}const Zo=u(u({},jo),Da("MuiInput",["root","underline","input"])),Jo=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],$o=eo(Go,{shouldForwardProp:e=>Ja(e)||"classes"===e,name:"MuiInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[...Ho(e,t),!r.disableUnderline&&t.underline]}})(ro((e=>{let{theme:t}=e;let r="light"===t.palette.mode?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r="rgba(".concat(t.vars.palette.common.onBackgroundChannel," / ").concat(t.vars.opacity.inputUnderline,")")),{position:"relative",variants:[{props:e=>{let{ownerState:t}=e;return t.formControl},style:{"label + &":{marginTop:16}}},{props:e=>{let{ownerState:t}=e;return!t.disableUnderline},style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},["&.".concat(Zo.focused,":after")]:{transform:"scaleX(1) translateX(0)"},["&.".concat(Zo.error)]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:"1px solid ".concat(r),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},["&:hover:not(.".concat(Zo.disabled,", .").concat(Zo.error,"):before")]:{borderBottom:"2px solid ".concat((t.vars||t).palette.text.primary),"@media (hover: none)":{borderBottom:"1px solid ".concat(r)}},["&.".concat(Zo.disabled,":before")]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(so()).map((e=>{let[r]=e;return{props:{color:r,disableUnderline:!1},style:{"&::after":{borderBottom:"2px solid ".concat((t.vars||t).palette[r].main)}}}}))]}}))),el=eo(qo,{name:"MuiInput",slot:"Input",overridesResolver:Wo})({}),tl=e.forwardRef((function(e,t){var r,n,i,a;const o=no({props:e,name:"MuiInput"}),{disableUnderline:l=!1,components:c={},componentsProps:h,fullWidth:d=!1,inputComponent:f="input",multiline:p=!1,slotProps:m,slots:g={},type:v="text"}=o,y=s(o,Jo),b=(e=>{const{classes:t,disableUnderline:r}=e,n=Na({root:["root",!r&&"underline"],input:["input"]},Qo,t);return u(u({},t),n)})(o),w={root:{ownerState:{disableUnderline:l}}},x=(null!==m&&void 0!==m?m:h)?_t(null!==m&&void 0!==m?m:h,w):w,S=null!==(r=null!==(n=g.root)&&void 0!==n?n:c.Root)&&void 0!==r?r:$o,_=null!==(i=null!==(a=g.input)&&void 0!==a?a:c.Input)&&void 0!==i?i:el;return(0,bt.jsx)(Ko,u(u({slots:{root:S,input:_},slotProps:x,fullWidth:d,inputComponent:f,multiline:p,ref:t,type:v},y),{},{classes:b}))}));tl&&(tl.muiName="Input");const rl=tl;function nl(e){return ka("MuiFilledInput",e)}const il=u(u({},jo),Da("MuiFilledInput",["root","underline","input","adornedStart","adornedEnd","sizeSmall","multiline","hiddenLabel"])),sl=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],al=eo(Go,{shouldForwardProp:e=>Ja(e)||"classes"===e,name:"MuiFilledInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[...Ho(e,t),!r.disableUnderline&&t.underline]}})(ro((e=>{let{theme:t}=e;const r="light"===t.palette.mode,n=r?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",i=r?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",s=r?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",a=r?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:i,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:s,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:i}},["&.".concat(il.focused)]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:i},["&.".concat(il.disabled)]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:a},variants:[{props:e=>{let{ownerState:t}=e;return!t.disableUnderline},style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},["&.".concat(il.focused,":after")]:{transform:"scaleX(1) translateX(0)"},["&.".concat(il.error)]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:"1px solid ".concat(t.vars?"rgba(".concat(t.vars.palette.common.onBackgroundChannel," / ").concat(t.vars.opacity.inputUnderline,")"):n),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},["&:hover:not(.".concat(il.disabled,", .").concat(il.error,"):before")]:{borderBottom:"1px solid ".concat((t.vars||t).palette.text.primary)},["&.".concat(il.disabled,":before")]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(so()).map((e=>{var r;let[n]=e;return{props:{disableUnderline:!1,color:n},style:{"&::after":{borderBottom:"2px solid ".concat(null===(r=(t.vars||t).palette[n])||void 0===r?void 0:r.main)}}}})),{props:e=>{let{ownerState:t}=e;return t.startAdornment},style:{paddingLeft:12}},{props:e=>{let{ownerState:t}=e;return t.endAdornment},style:{paddingRight:12}},{props:e=>{let{ownerState:t}=e;return t.multiline},style:{padding:"25px 12px 8px"}},{props:e=>{let{ownerState:t,size:r}=e;return t.multiline&&"small"===r},style:{paddingTop:21,paddingBottom:4}},{props:e=>{let{ownerState:t}=e;return t.multiline&&t.hiddenLabel},style:{paddingTop:16,paddingBottom:17}},{props:e=>{let{ownerState:t}=e;return t.multiline&&t.hiddenLabel&&"small"===t.size},style:{paddingTop:8,paddingBottom:9}}]}}))),ol=eo(qo,{name:"MuiFilledInput",slot:"Input",overridesResolver:Wo})(ro((e=>{let{theme:t}=e;return u(u(u({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}}),t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}}),{},{variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:e=>{let{ownerState:t}=e;return t.hiddenLabel},style:{paddingTop:16,paddingBottom:17}},{props:e=>{let{ownerState:t}=e;return t.startAdornment},style:{paddingLeft:0}},{props:e=>{let{ownerState:t}=e;return t.endAdornment},style:{paddingRight:0}},{props:e=>{let{ownerState:t}=e;return t.hiddenLabel&&"small"===t.size},style:{paddingTop:8,paddingBottom:9}},{props:e=>{let{ownerState:t}=e;return t.multiline},style:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}]})}))),ll=e.forwardRef((function(e,t){var r,n,i,a;const o=no({props:e,name:"MuiFilledInput"}),{disableUnderline:l=!1,components:c={},componentsProps:h,fullWidth:d=!1,hiddenLabel:f,inputComponent:p="input",multiline:m=!1,slotProps:g,slots:v={},type:y="text"}=o,b=s(o,sl),w=u(u({},o),{},{disableUnderline:l,fullWidth:d,inputComponent:p,multiline:m,type:y}),x=(e=>{const{classes:t,disableUnderline:r,startAdornment:n,endAdornment:i,size:s,hiddenLabel:a,multiline:o}=e,l=Na({root:["root",!r&&"underline",n&&"adornedStart",i&&"adornedEnd","small"===s&&"size".concat(io(s)),a&&"hiddenLabel",o&&"multiline"],input:["input"]},nl,t);return u(u({},t),l)})(o),S={root:{ownerState:w},input:{ownerState:w}},_=(null!==g&&void 0!==g?g:h)?_t(S,null!==g&&void 0!==g?g:h):S,C=null!==(r=null!==(n=v.root)&&void 0!==n?n:c.Root)&&void 0!==r?r:al,E=null!==(i=null!==(a=v.input)&&void 0!==a?a:c.Input)&&void 0!==i?i:ol;return(0,bt.jsx)(Ko,u(u({slots:{root:C,input:E},slotProps:_,fullWidth:d,inputComponent:p,multiline:m,ref:t,type:y},b),{},{classes:x}))}));ll&&(ll.muiName="Input");const cl=ll,ul=["children","classes","className","label","notched"];var hl;const dl=eo("fieldset",{shouldForwardProp:Ja})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),fl=eo("legend",{shouldForwardProp:Ja})(ro((e=>{let{theme:t}=e;return{float:"unset",width:"auto",overflow:"hidden",variants:[{props:e=>{let{ownerState:t}=e;return!t.withLabel},style:{padding:0,lineHeight:"11px",transition:t.transitions.create("width",{duration:150,easing:t.transitions.easing.easeOut})}},{props:e=>{let{ownerState:t}=e;return t.withLabel},style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:t.transitions.create("max-width",{duration:50,easing:t.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:e=>{let{ownerState:t}=e;return t.withLabel&&t.notched},style:{maxWidth:"100%",transition:t.transitions.create("max-width",{duration:100,easing:t.transitions.easing.easeOut,delay:50})}}]}})));function pl(e){return ka("MuiOutlinedInput",e)}const ml=u(u({},jo),Da("MuiOutlinedInput",["root","notchedOutline","input"])),gl=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],vl=eo(Go,{shouldForwardProp:e=>Ja(e)||"classes"===e,name:"MuiOutlinedInput",slot:"Root",overridesResolver:Ho})(ro((e=>{let{theme:t}=e;const r="light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{position:"relative",borderRadius:(t.vars||t).shape.borderRadius,["&:hover .".concat(ml.notchedOutline)]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{["&:hover .".concat(ml.notchedOutline)]:{borderColor:t.vars?"rgba(".concat(t.vars.palette.common.onBackgroundChannel," / 0.23)"):r}},["&.".concat(ml.focused," .").concat(ml.notchedOutline)]:{borderWidth:2},variants:[...Object.entries(t.palette).filter(so()).map((e=>{let[r]=e;return{props:{color:r},style:{["&.".concat(ml.focused," .").concat(ml.notchedOutline)]:{borderColor:(t.vars||t).palette[r].main}}}})),{props:{},style:{["&.".concat(ml.error," .").concat(ml.notchedOutline)]:{borderColor:(t.vars||t).palette.error.main},["&.".concat(ml.disabled," .").concat(ml.notchedOutline)]:{borderColor:(t.vars||t).palette.action.disabled}}},{props:e=>{let{ownerState:t}=e;return t.startAdornment},style:{paddingLeft:14}},{props:e=>{let{ownerState:t}=e;return t.endAdornment},style:{paddingRight:14}},{props:e=>{let{ownerState:t}=e;return t.multiline},style:{padding:"16.5px 14px"}},{props:e=>{let{ownerState:t,size:r}=e;return t.multiline&&"small"===r},style:{padding:"8.5px 14px"}}]}}))),yl=eo((function(e){const{children:t,classes:r,className:n,label:i,notched:a}=e,o=s(e,ul),l=null!=i&&""!==i,c=u(u({},e),{},{notched:a,withLabel:l});return(0,bt.jsx)(dl,u(u({"aria-hidden":!0,className:n,ownerState:c},o),{},{children:(0,bt.jsx)(fl,{ownerState:c,children:l?(0,bt.jsx)("span",{children:i}):hl||(hl=(0,bt.jsx)("span",{className:"notranslate","aria-hidden":!0,children:"\u200b"}))})}))}),{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(e,t)=>t.notchedOutline})(ro((e=>{let{theme:t}=e;const r="light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?"rgba(".concat(t.vars.palette.common.onBackgroundChannel," / 0.23)"):r}}))),bl=eo(qo,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:Wo})(ro((e=>{let{theme:t}=e;return u(u(u({padding:"16.5px 14px"},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderRadius:"inherit"}}),t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}}),{},{variants:[{props:{size:"small"},style:{padding:"8.5px 14px"}},{props:e=>{let{ownerState:t}=e;return t.multiline},style:{padding:0}},{props:e=>{let{ownerState:t}=e;return t.startAdornment},style:{paddingLeft:0}},{props:e=>{let{ownerState:t}=e;return t.endAdornment},style:{paddingRight:0}}]})}))),wl=e.forwardRef((function(t,r){var n,i,a,o,l;const c=no({props:t,name:"MuiOutlinedInput"}),{components:h={},fullWidth:d=!1,inputComponent:f="input",label:p,multiline:m=!1,notched:g,slots:v={},type:y="text"}=c,b=s(c,gl),w=(e=>{const{classes:t}=e,r=Na({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},pl,t);return u(u({},t),r)})(c),x=Ro(),S=Io({props:c,muiFormControl:x,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),_=u(u({},c),{},{color:S.color||"primary",disabled:S.disabled,error:S.error,focused:S.focused,formControl:x,fullWidth:d,hiddenLabel:S.hiddenLabel,multiline:m,size:S.size,type:y}),C=null!==(n=null!==(i=v.root)&&void 0!==i?i:h.Root)&&void 0!==n?n:vl,E=null!==(a=null!==(o=v.input)&&void 0!==o?o:h.Input)&&void 0!==a?a:bl;return(0,bt.jsx)(Ko,u(u({slots:{root:C,input:E},renderSuffix:t=>(0,bt.jsx)(yl,{ownerState:_,className:w.notchedOutline,label:null!=p&&""!==p&&S.required?l||(l=(0,bt.jsxs)(e.Fragment,{children:[p,"\u2009","*"]})):p,notched:"undefined"!==typeof g?g:Boolean(t.startAdornment||t.filled||t.focused)}),fullWidth:d,inputComponent:f,multiline:m,ref:r,type:y},b),{},{classes:u(u({},w),{},{notchedOutline:null})}))}));wl&&(wl.muiName="Input");const xl=wl;function Sl(e){return ka("MuiFormLabel",e)}const _l=Da("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),Cl=["children","className","color","component","disabled","error","filled","focused","required"],El=eo("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,"secondary"===r.color&&t.colorSecondary,r.filled&&t.filled]}})(ro((e=>{let{theme:t}=e;return u(u({color:(t.vars||t).palette.text.secondary},t.typography.body1),{},{lineHeight:"1.4375em",padding:0,position:"relative",variants:[...Object.entries(t.palette).filter(so()).map((e=>{let[r]=e;return{props:{color:r},style:{["&.".concat(_l.focused)]:{color:(t.vars||t).palette[r].main}}}})),{props:{},style:{["&.".concat(_l.disabled)]:{color:(t.vars||t).palette.text.disabled},["&.".concat(_l.error)]:{color:(t.vars||t).palette.error.main}}}]})}))),Al=eo("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})(ro((e=>{let{theme:t}=e;return{["&.".concat(_l.error)]:{color:(t.vars||t).palette.error.main}}}))),Ml=e.forwardRef((function(e,t){const r=no({props:e,name:"MuiFormLabel"}),{children:n,className:i,color:a,component:o="label",disabled:l,error:c,filled:h,focused:d,required:f}=r,p=s(r,Cl),m=Io({props:r,muiFormControl:Ro(),states:["color","required","focused","disabled","error","filled"]}),g=u(u({},r),{},{color:m.color||"primary",component:o,disabled:m.disabled,error:m.error,filled:m.filled,focused:m.focused,required:m.required}),v=(e=>{const{classes:t,color:r,focused:n,disabled:i,error:s,filled:a,required:o}=e;return Na({root:["root","color".concat(io(r)),i&&"disabled",s&&"error",a&&"filled",n&&"focused",o&&"required"],asterisk:["asterisk",s&&"error"]},Sl,t)})(g);return(0,bt.jsxs)(El,u(u({as:o,ownerState:g,className:ua(v.root,i),ref:t},p),{},{children:[n,m.required&&(0,bt.jsxs)(Al,{ownerState:g,"aria-hidden":!0,className:v.asterisk,children:["\u2009","*"]})]}))})),Tl=Ml;function Pl(e){return ka("MuiInputLabel",e)}Da("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const kl=["disableAnimation","margin","shrink","variant","className"],Dl=eo(Tl,{shouldForwardProp:e=>Ja(e)||"classes"===e,name:"MuiInputLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[{["& .".concat(_l.asterisk)]:t.asterisk},t.root,r.formControl&&t.formControl,"small"===r.size&&t.sizeSmall,r.shrink&&t.shrink,!r.disableAnimation&&t.animated,r.focused&&t.focused,t[r.variant]]}})(ro((e=>{let{theme:t}=e;return{display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",variants:[{props:e=>{let{ownerState:t}=e;return t.formControl},style:{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"}},{props:{size:"small"},style:{transform:"translate(0, 17px) scale(1)"}},{props:e=>{let{ownerState:t}=e;return t.shrink},style:{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"}},{props:e=>{let{ownerState:t}=e;return!t.disableAnimation},style:{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})}},{props:{variant:"filled"},style:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"filled",size:"small"},style:{transform:"translate(12px, 13px) scale(1)"}},{props:e=>{let{variant:t,ownerState:r}=e;return"filled"===t&&r.shrink},style:{userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"}},{props:e=>{let{variant:t,ownerState:r,size:n}=e;return"filled"===t&&r.shrink&&"small"===n},style:{transform:"translate(12px, 4px) scale(0.75)"}},{props:{variant:"outlined"},style:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"outlined",size:"small"},style:{transform:"translate(14px, 9px) scale(1)"}},{props:e=>{let{variant:t,ownerState:r}=e;return"outlined"===t&&r.shrink},style:{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}}]}}))),Il=e.forwardRef((function(e,t){const r=no({name:"MuiInputLabel",props:e}),{disableAnimation:n=!1,margin:i,shrink:a,variant:o,className:l}=r,c=s(r,kl),h=Ro();let d=a;"undefined"===typeof d&&h&&(d=h.filled||h.focused||h.adornedStart);const f=Io({props:r,muiFormControl:h,states:["size","variant","required","focused"]}),p=u(u({},r),{},{disableAnimation:n,formControl:h,shrink:d,size:f.size,variant:f.variant,required:f.required,focused:f.focused}),m=(e=>{const{classes:t,formControl:r,size:n,shrink:i,disableAnimation:s,variant:a,required:o}=e,l=Na({root:["root",r&&"formControl",!s&&"animated",i&&"shrink",n&&"normal"!==n&&"size".concat(io(n)),a],asterisk:[o&&"asterisk"]},Pl,t);return u(u({},t),l)})(p);return(0,bt.jsx)(Dl,u(u({"data-shrink":d,ref:t,className:ua(m.root,l)},c),{},{ownerState:p,classes:m}))})),Ol=Il;const Rl=function(t,r){var n,i;return e.isValidElement(t)&&-1!==r.indexOf(null!==(n=t.type.muiName)&&void 0!==n?n:null===(i=t.type)||void 0===i||null===(i=i._payload)||void 0===i||null===(i=i.value)||void 0===i?void 0:i.muiName)};function Ll(e){return ka("MuiFormControl",e)}Da("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const Nl=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],Bl=eo("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t["margin".concat(io(r.margin))],r.fullWidth&&t.fullWidth]}})({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top",variants:[{props:{margin:"normal"},style:{marginTop:16,marginBottom:8}},{props:{margin:"dense"},style:{marginTop:8,marginBottom:4}},{props:{fullWidth:!0},style:{width:"100%"}}]}),zl=e.forwardRef((function(t,r){const n=no({props:t,name:"MuiFormControl"}),{children:i,className:a,color:o="primary",component:l="div",disabled:c=!1,error:h=!1,focused:d,fullWidth:f=!1,hiddenLabel:p=!1,margin:m="none",required:g=!1,size:v="medium",variant:y="outlined"}=n,b=s(n,Nl),w=u(u({},n),{},{color:o,component:l,disabled:c,error:h,fullWidth:f,hiddenLabel:p,margin:m,required:g,size:v,variant:y}),x=(e=>{const{classes:t,margin:r,fullWidth:n}=e;return Na({root:["root","none"!==r&&"margin".concat(io(r)),n&&"fullWidth"]},Ll,t)})(w),[S,_]=e.useState((()=>{let t=!1;return i&&e.Children.forEach(i,(e=>{if(!Rl(e,["Input","Select"]))return;const r=Rl(e,["Select"])?e.props.input:e;r&&r.props.startAdornment&&(t=!0)})),t})),[C,E]=e.useState((()=>{let t=!1;return i&&e.Children.forEach(i,(e=>{Rl(e,["Input","Select"])&&(zo(e.props,!0)||zo(e.props.inputProps,!0))&&(t=!0)})),t})),[A,M]=e.useState(!1);c&&A&&M(!1);const T=void 0===d||c?A:d;let P;e.useRef(!1);const k=e.useMemo((()=>({adornedStart:S,setAdornedStart:_,color:o,disabled:c,error:h,filled:C,focused:T,fullWidth:f,hiddenLabel:p,size:v,onBlur:()=>{M(!1)},onEmpty:()=>{E(!1)},onFilled:()=>{E(!0)},onFocus:()=>{M(!0)},registerEffect:P,required:g,variant:y})),[S,o,c,h,C,T,f,p,P,g,v,y]);return(0,bt.jsx)(Oo.Provider,{value:k,children:(0,bt.jsx)(Bl,u(u({as:l,ownerState:w,className:ua(x.root,a),ref:r},b),{},{children:i}))})})),Fl=zl;function jl(e){return ka("MuiFormHelperText",e)}const Ul=Da("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]),Vl=["children","className","component","disabled","error","filled","focused","margin","required","variant"];var Hl;const Wl=eo("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.size&&t["size".concat(io(r.size))],r.contained&&t.contained,r.filled&&t.filled]}})(ro((e=>{let{theme:t}=e;return u(u({color:(t.vars||t).palette.text.secondary},t.typography.caption),{},{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,["&.".concat(Ul.disabled)]:{color:(t.vars||t).palette.text.disabled},["&.".concat(Ul.error)]:{color:(t.vars||t).palette.error.main},variants:[{props:{size:"small"},style:{marginTop:4}},{props:e=>{let{ownerState:t}=e;return t.contained},style:{marginLeft:14,marginRight:14}}]})}))),Gl=e.forwardRef((function(e,t){const r=no({props:e,name:"MuiFormHelperText"}),{children:n,className:i,component:a="p",disabled:o,error:l,filled:c,focused:h,margin:d,required:f,variant:p}=r,m=s(r,Vl),g=Io({props:r,muiFormControl:Ro(),states:["variant","size","disabled","error","filled","focused","required"]}),v=u(u({},r),{},{component:a,contained:"filled"===g.variant||"outlined"===g.variant,variant:g.variant,size:g.size,disabled:g.disabled,error:g.error,filled:g.filled,focused:g.focused,required:g.required});delete v.ownerState;const y=(e=>{const{classes:t,contained:r,size:n,disabled:i,error:s,filled:a,focused:o,required:l}=e;return Na({root:["root",i&&"disabled",s&&"error",n&&"size".concat(io(n)),r&&"contained",o&&"focused",a&&"filled",l&&"required"]},jl,t)})(v);return(0,bt.jsx)(Wl,u(u({as:a,className:ua(y.root,i),ref:t},m),{},{ownerState:v,children:" "===n?Hl||(Hl=(0,bt.jsx)("span",{className:"notranslate","aria-hidden":!0,children:"\u200b"})):n}))}));function ql(t){var r;return parseInt(e.version,10)>=19?(null===t||void 0===t||null===(r=t.props)||void 0===r?void 0:r.ref)||null:(null===t||void 0===t?void 0:t.ref)||null}const Xl=So;const Yl=function(e){return"string"===typeof e};const Kl=function(e,t,r){return void 0===e||Yl(e)?t:u(u({},t),{},{ownerState:u(u({},t.ownerState),r)})};const Ql=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(void 0===e)return{};const r={};return Object.keys(e).filter((r=>r.match(/^on[A-Z]/)&&"function"===typeof e[r]&&!t.includes(r))).forEach((t=>{r[t]=e[t]})),r};const Zl=function(e){if(void 0===e)return{};const t={};return Object.keys(e).filter((t=>!(t.match(/^on[A-Z]/)&&"function"===typeof e[t]))).forEach((r=>{t[r]=e[r]})),t};const Jl=function(e){const{getSlotProps:t,additionalProps:r,externalSlotProps:n,externalForwardedProps:i,className:s}=e;if(!t){const e=ua(null===r||void 0===r?void 0:r.className,s,null===i||void 0===i?void 0:i.className,null===n||void 0===n?void 0:n.className),t=u(u(u({},null===r||void 0===r?void 0:r.style),null===i||void 0===i?void 0:i.style),null===n||void 0===n?void 0:n.style),a=u(u(u({},r),i),n);return e.length>0&&(a.className=e),Object.keys(t).length>0&&(a.style=t),{props:a,internalRef:void 0}}const a=Ql(u(u({},i),n)),o=Zl(n),l=Zl(i),c=t(a),h=ua(null===c||void 0===c?void 0:c.className,null===r||void 0===r?void 0:r.className,s,null===i||void 0===i?void 0:i.className,null===n||void 0===n?void 0:n.className),d=u(u(u(u({},null===c||void 0===c?void 0:c.style),null===r||void 0===r?void 0:r.style),null===i||void 0===i?void 0:i.style),null===n||void 0===n?void 0:n.style),f=u(u(u(u({},c),r),l),o);return h.length>0&&(f.className=h),Object.keys(d).length>0&&(f.style=d),{props:f,internalRef:c.ref}};const $l=function(e,t,r){return"function"===typeof e?e(t,r):e},ec=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];const tc=function(e){var t;const{elementType:r,externalSlotProps:n,ownerState:i,skipResolvingSlotProps:a=!1}=e,o=s(e,ec),l=a?{}:$l(n,i),{props:c,internalRef:h}=Jl(u(u({},o),{},{externalSlotProps:l})),d=xo(h,null===l||void 0===l?void 0:l.ref,null===(t=e.additionalProps)||void 0===t?void 0:t.ref);return Kl(r,u(u({},c),{},{ref:d}),i)};const rc=e.createContext({});function nc(e){return ka("MuiList",e)}Da("MuiList",["root","padding","dense","subheader"]);const ic=["children","className","component","dense","disablePadding","subheader"],sc=eo("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,!r.disablePadding&&t.padding,r.dense&&t.dense,r.subheader&&t.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:e=>{let{ownerState:t}=e;return!t.disablePadding},style:{paddingTop:8,paddingBottom:8}},{props:e=>{let{ownerState:t}=e;return t.subheader},style:{paddingTop:0}}]}),ac=e.forwardRef((function(t,r){const n=no({props:t,name:"MuiList"}),{children:i,className:a,component:o="ul",dense:l=!1,disablePadding:c=!1,subheader:h}=n,d=s(n,ic),f=e.useMemo((()=>({dense:l})),[l]),p=u(u({},n),{},{component:o,dense:l,disablePadding:c}),m=(e=>{const{classes:t,disablePadding:r,dense:n,subheader:i}=e;return Na({root:["root",!r&&"padding",n&&"dense",i&&"subheader"]},nc,t)})(p);return(0,bt.jsx)(rc.Provider,{value:f,children:(0,bt.jsxs)(sc,u(u({as:o,className:ua(m.root,a),ref:r,ownerState:p},d),{},{children:[h,i]}))})}));function oc(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;const t=e.document.documentElement.clientWidth;return e.innerWidth-t}const lc=oc,cc=_o,uc=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function hc(e,t,r){return e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:r?null:e.firstChild}function dc(e,t,r){return e===t?r?e.firstChild:e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:r?null:e.lastChild}function fc(e,t){if(void 0===t)return!0;let r=e.innerText;return void 0===r&&(r=e.textContent),r=r.trim().toLowerCase(),0!==r.length&&(t.repeating?r[0]===t.keys[0]:r.startsWith(t.keys.join("")))}function pc(e,t,r,n,i,s){let a=!1,o=i(e,t,!!t&&r);for(;o;){if(o===e.firstChild){if(a)return!1;a=!0}const t=!n&&(o.disabled||"true"===o.getAttribute("aria-disabled"));if(o.hasAttribute("tabindex")&&fc(o,s)&&!t)return o.focus(),!0;o=i(e,o,r)}return!1}const mc=e.forwardRef((function(t,r){const{actions:n,autoFocus:i=!1,autoFocusItem:a=!1,children:o,className:l,disabledItemsFocusable:c=!1,disableListWrap:h=!1,onKeyDown:d,variant:f="selectedMenu"}=t,p=s(t,uc),m=e.useRef(null),g=e.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});No((()=>{i&&m.current.focus()}),[i]),e.useImperativeHandle(n,(()=>({adjustStyleForScrollbar:(e,t)=>{let{direction:r}=t;const n=!m.current.style.width;if(e.clientHeight<m.current.clientHeight&&n){const t="".concat(lc(cc(e)),"px");m.current.style["rtl"===r?"paddingLeft":"paddingRight"]=t,m.current.style.width="calc(100% + ".concat(t,")")}return m.current}})),[]);const v=Lo(m,r);let y=-1;e.Children.forEach(o,((t,r)=>{e.isValidElement(t)?(t.props.disabled||("selectedMenu"===f&&t.props.selected||-1===y)&&(y=r),y===r&&(t.props.disabled||t.props.muiSkipListHighlight||t.type.muiSkipListHighlight)&&(y+=1,y>=o.length&&(y=-1))):y===r&&(y+=1,y>=o.length&&(y=-1))}));const b=e.Children.map(o,((t,r)=>{if(r===y){const r={};return a&&(r.autoFocus=!0),void 0===t.props.tabIndex&&"selectedMenu"===f&&(r.tabIndex=0),e.cloneElement(t,r)}return t}));return(0,bt.jsx)(ac,u(u({role:"menu",ref:v,className:l,onKeyDown:e=>{const t=m.current,r=e.key;if(e.ctrlKey||e.metaKey||e.altKey)return void(d&&d(e));const n=Xl(t).activeElement;if("ArrowDown"===r)e.preventDefault(),pc(t,n,h,c,hc);else if("ArrowUp"===r)e.preventDefault(),pc(t,n,h,c,dc);else if("Home"===r)e.preventDefault(),pc(t,null,h,c,hc);else if("End"===r)e.preventDefault(),pc(t,null,h,c,dc);else if(1===r.length){const i=g.current,s=r.toLowerCase(),a=performance.now();i.keys.length>0&&(a-i.lastTime>500?(i.keys=[],i.repeating=!0,i.previousKeyMatched=!0):i.repeating&&s!==i.keys[0]&&(i.repeating=!1)),i.lastTime=a,i.keys.push(s);const o=n&&!i.repeating&&fc(n,i);i.previousKeyMatched&&(o||pc(t,n,!1,c,hc,i))?e.preventDefault():i.previousKeyMatched=!1}d&&d(e)},tabIndex:i?0:-1},p),{},{children:b}))})),gc=mc,vc=Eo,yc={};function bc(t,r){const n=e.useRef(yc);return n.current===yc&&(n.current=t(r)),n}const wc=[];class xc{constructor(){l(this,"currentId",null),l(this,"clear",(()=>{null!==this.currentId&&(clearTimeout(this.currentId),this.currentId=null)})),l(this,"disposeEffect",(()=>this.clear))}static create(){return new xc}start(e,t){this.clear(),this.currentId=setTimeout((()=>{this.currentId=null,t()}),e)}}function Sc(){const t=bc(xc.create).current;return function(t){e.useEffect(t,wc)}(t.disposeEffect),t}function _c(e,t){return _c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_c(e,t)}function Cc(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_c(e,t)}var Ec=r(950);const Ac=!1,Mc=e.createContext(null);var Tc=function(e){return e.scrollTop},Pc="unmounted",kc="exited",Dc="entering",Ic="entered",Oc="exiting",Rc=function(t){function r(e,r){var n;n=t.call(this,e,r)||this;var i,s=r&&!r.isMounting?e.enter:e.appear;return n.appearStatus=null,e.in?s?(i=kc,n.appearStatus=Dc):i=Ic:i=e.unmountOnExit||e.mountOnEnter?Pc:kc,n.state={status:i},n.nextCallback=null,n}Cc(r,t),r.getDerivedStateFromProps=function(e,t){return e.in&&t.status===Pc?{status:kc}:null};var n=r.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var r=this.state.status;this.props.in?r!==Dc&&r!==Ic&&(t=Dc):r!==Dc&&r!==Ic||(t=Oc)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,r,n=this.props.timeout;return e=t=r=n,null!=n&&"number"!==typeof n&&(e=n.exit,t=n.enter,r=void 0!==n.appear?n.appear:t),{exit:e,enter:t,appear:r}},n.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===Dc){if(this.props.unmountOnExit||this.props.mountOnEnter){var r=this.props.nodeRef?this.props.nodeRef.current:Ec.findDOMNode(this);r&&Tc(r)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===kc&&this.setState({status:Pc})},n.performEnter=function(e){var t=this,r=this.props.enter,n=this.context?this.context.isMounting:e,i=this.props.nodeRef?[n]:[Ec.findDOMNode(this),n],s=i[0],a=i[1],o=this.getTimeouts(),l=n?o.appear:o.enter;!e&&!r||Ac?this.safeSetState({status:Ic},(function(){t.props.onEntered(s)})):(this.props.onEnter(s,a),this.safeSetState({status:Dc},(function(){t.props.onEntering(s,a),t.onTransitionEnd(l,(function(){t.safeSetState({status:Ic},(function(){t.props.onEntered(s,a)}))}))})))},n.performExit=function(){var e=this,t=this.props.exit,r=this.getTimeouts(),n=this.props.nodeRef?void 0:Ec.findDOMNode(this);t&&!Ac?(this.props.onExit(n),this.safeSetState({status:Oc},(function(){e.props.onExiting(n),e.onTransitionEnd(r.exit,(function(){e.safeSetState({status:kc},(function(){e.props.onExited(n)}))}))}))):this.safeSetState({status:kc},(function(){e.props.onExited(n)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,r=!0;return this.nextCallback=function(n){r&&(r=!1,t.nextCallback=null,e(n))},this.nextCallback.cancel=function(){r=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var r=this.props.nodeRef?this.props.nodeRef.current:Ec.findDOMNode(this),n=null==e&&!this.props.addEndListener;if(r&&!n){if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[r,this.nextCallback],s=i[0],a=i[1];this.props.addEndListener(s,a)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var t=this.state.status;if(t===Pc)return null;var r=this.props,n=r.children,s=(r.in,r.mountOnEnter,r.unmountOnExit,r.appear,r.enter,r.exit,r.timeout,r.addEndListener,r.onEnter,r.onEntering,r.onEntered,r.onExit,r.onExiting,r.onExited,r.nodeRef,i(r,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return e.createElement(Mc.Provider,{value:null},"function"===typeof n?n(t,s):e.cloneElement(e.Children.only(n),s))},r}(e.Component);function Lc(){}Rc.contextType=Mc,Rc.propTypes={},Rc.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Lc,onEntering:Lc,onEntered:Lc,onExit:Lc,onExiting:Lc,onExited:Lc},Rc.UNMOUNTED=Pc,Rc.EXITED=kc,Rc.ENTERING=Dc,Rc.ENTERED=Ic,Rc.EXITING=Oc;const Nc=Rc;function Bc(){const e=Ea(za);return e[Us]||e}const zc=e=>e.scrollTop;function Fc(e,t){var r,n;const{timeout:i,easing:s,style:a={}}=e;return{duration:null!==(r=a.transitionDuration)&&void 0!==r?r:"number"===typeof i?i:i[t.mode]||0,easing:null!==(n=a.transitionTimingFunction)&&void 0!==n?n:"object"===typeof s?s[t.mode]:s,delay:a.transitionDelay}}const jc=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function Uc(e){return"scale(".concat(e,", ").concat(e**2,")")}const Vc={entering:{opacity:1,transform:Uc(1)},entered:{opacity:1,transform:"none"}},Hc="undefined"!==typeof navigator&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Wc=e.forwardRef((function(t,r){const{addEndListener:n,appear:i=!0,children:a,easing:o,in:l,onEnter:c,onEntered:h,onEntering:d,onExit:f,onExited:p,onExiting:m,style:g,timeout:v="auto",TransitionComponent:y=Nc}=t,b=s(t,jc),w=Sc(),x=e.useRef(),S=Bc(),_=e.useRef(null),C=Lo(_,ql(a),r),E=e=>t=>{if(e){const r=_.current;void 0===t?e(r):e(r,t)}},A=E(d),M=E(((e,t)=>{zc(e);const{duration:r,delay:n,easing:i}=Fc({style:g,timeout:v,easing:o},{mode:"enter"});let s;"auto"===v?(s=S.transitions.getAutoHeightDuration(e.clientHeight),x.current=s):s=r,e.style.transition=[S.transitions.create("opacity",{duration:s,delay:n}),S.transitions.create("transform",{duration:Hc?s:.666*s,delay:n,easing:i})].join(","),c&&c(e,t)})),T=E(h),P=E(m),k=E((e=>{const{duration:t,delay:r,easing:n}=Fc({style:g,timeout:v,easing:o},{mode:"exit"});let i;"auto"===v?(i=S.transitions.getAutoHeightDuration(e.clientHeight),x.current=i):i=t,e.style.transition=[S.transitions.create("opacity",{duration:i,delay:r}),S.transitions.create("transform",{duration:Hc?i:.666*i,delay:Hc?r:r||.333*i,easing:n})].join(","),e.style.opacity=0,e.style.transform=Uc(.75),f&&f(e)})),D=E(p);return(0,bt.jsx)(y,u(u({appear:i,in:l,nodeRef:_,onEnter:M,onEntered:T,onEntering:A,onExit:k,onExited:D,onExiting:P,addEndListener:e=>{"auto"===v&&w.start(x.current||0,e),n&&n(_.current,e)},timeout:"auto"===v?null:v},b),{},{children:(t,r)=>e.cloneElement(a,u({style:u(u(u({opacity:0,transform:Uc(.75),visibility:"exited"!==t||l?void 0:"hidden"},Vc[t]),g),a.props.style),ref:C},r))}))}));Wc&&(Wc.muiSupportAuto=!0);const Gc=Wc,qc=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function Xc(e){const t=[],r=[];return Array.from(e.querySelectorAll(qc)).forEach(((e,n)=>{const i=function(e){const t=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(t)?"true"===e.contentEditable||("AUDIO"===e.nodeName||"VIDEO"===e.nodeName||"DETAILS"===e.nodeName)&&null===e.getAttribute("tabindex")?0:e.tabIndex:t}(e);-1!==i&&function(e){return!(e.disabled||"INPUT"===e.tagName&&"hidden"===e.type||function(e){if("INPUT"!==e.tagName||"radio"!==e.type)return!1;if(!e.name)return!1;const t=t=>e.ownerDocument.querySelector('input[type="radio"]'.concat(t));let r=t('[name="'.concat(e.name,'"]:checked'));return r||(r=t('[name="'.concat(e.name,'"]'))),r!==e}(e))}(e)&&(0===i?t.push(e):r.push({documentOrder:n,tabIndex:i,node:e}))})),r.sort(((e,t)=>e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex)).map((e=>e.node)).concat(t)}function Yc(){return!0}const Kc=function(t){const{children:r,disableAutoFocus:n=!1,disableEnforceFocus:i=!1,disableRestoreFocus:s=!1,getTabbable:a=Xc,isEnabled:o=Yc,open:l}=t,c=e.useRef(!1),u=e.useRef(null),h=e.useRef(null),d=e.useRef(null),f=e.useRef(null),p=e.useRef(!1),m=e.useRef(null),g=xo(ql(r),m),v=e.useRef(null);e.useEffect((()=>{l&&m.current&&(p.current=!n)}),[n,l]),e.useEffect((()=>{if(!l||!m.current)return;const e=So(m.current);return m.current.contains(e.activeElement)||(m.current.hasAttribute("tabIndex")||m.current.setAttribute("tabIndex","-1"),p.current&&m.current.focus()),()=>{s||(d.current&&d.current.focus&&(c.current=!0,d.current.focus()),d.current=null)}}),[l]),e.useEffect((()=>{if(!l||!m.current)return;const e=So(m.current),t=t=>{v.current=t,!i&&o()&&"Tab"===t.key&&e.activeElement===m.current&&t.shiftKey&&(c.current=!0,h.current&&h.current.focus())},r=()=>{const t=m.current;if(null===t)return;if(!e.hasFocus()||!o()||c.current)return void(c.current=!1);if(t.contains(e.activeElement))return;if(i&&e.activeElement!==u.current&&e.activeElement!==h.current)return;if(e.activeElement!==f.current)f.current=null;else if(null!==f.current)return;if(!p.current)return;let r=[];if(e.activeElement!==u.current&&e.activeElement!==h.current||(r=a(m.current)),r.length>0){var n,s;const e=Boolean((null===(n=v.current)||void 0===n?void 0:n.shiftKey)&&"Tab"===(null===(s=v.current)||void 0===s?void 0:s.key)),t=r[0],i=r[r.length-1];"string"!==typeof t&&"string"!==typeof i&&(e?i.focus():t.focus())}else t.focus()};e.addEventListener("focusin",r),e.addEventListener("keydown",t,!0);const n=setInterval((()=>{e.activeElement&&"BODY"===e.activeElement.tagName&&r()}),50);return()=>{clearInterval(n),e.removeEventListener("focusin",r),e.removeEventListener("keydown",t,!0)}}),[n,i,s,o,l,a]);const y=e=>{null===d.current&&(d.current=e.relatedTarget),p.current=!0};return(0,bt.jsxs)(e.Fragment,{children:[(0,bt.jsx)("div",{tabIndex:l?0:-1,onFocus:y,ref:u,"data-testid":"sentinelStart"}),e.cloneElement(r,{ref:g,onFocus:e=>{null===d.current&&(d.current=e.relatedTarget),p.current=!0,f.current=e.target;const t=r.props.onFocus;t&&t(e)}}),(0,bt.jsx)("div",{tabIndex:l?0:-1,onFocus:y,ref:h,"data-testid":"sentinelEnd"})]})};const Qc=e.forwardRef((function(t,r){const{children:n,container:i,disablePortal:s=!1}=t,[a,o]=e.useState(null),l=xo(e.isValidElement(n)?ql(n):null,r);if(Co((()=>{s||o(function(e){return"function"===typeof e?e():e}(i)||document.body)}),[i,s]),Co((()=>{if(a&&!s)return wo(r,a),()=>{wo(r,null)}}),[r,a,s]),s){if(e.isValidElement(n)){const t={ref:l};return e.cloneElement(n,t)}return n}return a?Ec.createPortal(n,a):a})),Zc=["className","elementType","ownerState","externalForwardedProps","internalForwardedProps"],Jc=["component","slots","slotProps"],$c=["component"];function eu(e,t){const{className:r,elementType:n,ownerState:i,externalForwardedProps:a,internalForwardedProps:o}=t,l=s(t,Zc),{component:c,slots:h={[e]:void 0},slotProps:d={[e]:void 0}}=a,f=s(a,Jc),p=h[e]||n,m=$l(d[e],i),g=Jl(u(u({className:r},l),{},{externalForwardedProps:"root"===e?f:void 0,externalSlotProps:m})),{props:{component:v},internalRef:y}=g,b=s(g.props,$c),w=xo(y,null===m||void 0===m?void 0:m.ref,t.ref),x="root"===e?v||c:v;return[p,Kl(p,u(u(u(u(u({},"root"===e&&!c&&!h[e]&&o),"root"!==e&&!h[e]&&o),b),x&&{as:x}),{},{ref:w}),i)]}const tu=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],ru={entering:{opacity:1},entered:{opacity:1}},nu=e.forwardRef((function(t,r){const n=Bc(),i={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:a,appear:o=!0,children:l,easing:c,in:h,onEnter:d,onEntered:f,onEntering:p,onExit:m,onExited:g,onExiting:v,style:y,timeout:b=i,TransitionComponent:w=Nc}=t,x=s(t,tu),S=e.useRef(null),_=Lo(S,ql(l),r),C=e=>t=>{if(e){const r=S.current;void 0===t?e(r):e(r,t)}},E=C(p),A=C(((e,t)=>{zc(e);const r=Fc({style:y,timeout:b,easing:c},{mode:"enter"});e.style.webkitTransition=n.transitions.create("opacity",r),e.style.transition=n.transitions.create("opacity",r),d&&d(e,t)})),M=C(f),T=C(v),P=C((e=>{const t=Fc({style:y,timeout:b,easing:c},{mode:"exit"});e.style.webkitTransition=n.transitions.create("opacity",t),e.style.transition=n.transitions.create("opacity",t),m&&m(e)})),k=C(g);return(0,bt.jsx)(w,u(u({appear:o,in:h,nodeRef:S,onEnter:A,onEntered:M,onEntering:E,onExit:P,onExited:k,onExiting:T,addEndListener:e=>{a&&a(S.current,e)},timeout:b},x),{},{children:(t,r)=>e.cloneElement(l,u({style:u(u(u({opacity:0,visibility:"exited"!==t||h?void 0:"hidden"},ru[t]),y),l.props.style),ref:_},r))}))})),iu=nu;function su(e){return ka("MuiBackdrop",e)}Da("MuiBackdrop",["root","invisible"]);const au=["ownerState"],ou=["children","className","component","invisible","open","components","componentsProps","slotProps","slots","TransitionComponent","transitionDuration"],lu=eo("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.invisible&&t.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),cu=e.forwardRef((function(e,t){const r=no({props:e,name:"MuiBackdrop"}),{children:n,className:i,component:a="div",invisible:o=!1,open:l,components:c={},componentsProps:h={},slotProps:d={},slots:f={},TransitionComponent:p,transitionDuration:m}=r,g=s(r,ou),v=u(u({},r),{},{component:a,invisible:o}),y=(e=>{const{classes:t,invisible:r}=e;return Na({root:["root",r&&"invisible"]},su,t)})(v),b={slots:u({transition:p,root:c.Root},f),slotProps:u(u({},h),d)},[w,x]=eu("root",{elementType:lu,externalForwardedProps:b,className:ua(y.root,i),ownerState:v}),[S,_]=eu("transition",{elementType:iu,externalForwardedProps:b,ownerState:v}),C=(e=>{const{ownerState:t}=e;return s(e,au)})(_);return(0,bt.jsx)(S,u(u(u({in:l,timeout:m},g),C),{},{children:(0,bt.jsx)(w,u(u({"aria-hidden":!0},x),{},{classes:y,ref:t,children:n}))}))}));const uu=function(t){const r=e.useRef(t);return Co((()=>{r.current=t})),e.useRef((function(){return(0,r.current)(...arguments)})).current};function hu(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(((e,t)=>null==t?e:function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n),t.apply(this,n)}),(()=>{}))}function du(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function fu(e){return parseInt(_o(e).getComputedStyle(e).paddingRight,10)||0}function pu(e,t,r,n,i){const s=[t,r,...n];[].forEach.call(e.children,(e=>{const t=!s.includes(e),r=!function(e){const t=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(e.tagName),r="INPUT"===e.tagName&&"hidden"===e.getAttribute("type");return t||r}(e);t&&r&&du(e,i)}))}function mu(e,t){let r=-1;return e.some(((e,n)=>!!t(e)&&(r=n,!0))),r}function gu(e,t){const r=[],n=e.container;if(!t.disableScrollLock){if(function(e){const t=So(e);return t.body===e?_o(e).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}(n)){const e=oc(_o(n));r.push({value:n.style.paddingRight,property:"padding-right",el:n}),n.style.paddingRight="".concat(fu(n)+e,"px");const t=So(n).querySelectorAll(".mui-fixed");[].forEach.call(t,(t=>{r.push({value:t.style.paddingRight,property:"padding-right",el:t}),t.style.paddingRight="".concat(fu(t)+e,"px")}))}let e;if(n.parentNode instanceof DocumentFragment)e=So(n).body;else{const t=n.parentElement,r=_o(n);e="HTML"===(null===t||void 0===t?void 0:t.nodeName)&&"scroll"===r.getComputedStyle(t).overflowY?t:n}r.push({value:e.style.overflow,property:"overflow",el:e},{value:e.style.overflowX,property:"overflow-x",el:e},{value:e.style.overflowY,property:"overflow-y",el:e}),e.style.overflow="hidden"}return()=>{r.forEach((e=>{let{value:t,el:r,property:n}=e;t?r.style.setProperty(n,t):r.style.removeProperty(n)}))}}const vu=()=>{},yu=new class{constructor(){this.modals=[],this.containers=[]}add(e,t){let r=this.modals.indexOf(e);if(-1!==r)return r;r=this.modals.length,this.modals.push(e),e.modalRef&&du(e.modalRef,!1);const n=function(e){const t=[];return[].forEach.call(e.children,(e=>{"true"===e.getAttribute("aria-hidden")&&t.push(e)})),t}(t);pu(t,e.mount,e.modalRef,n,!0);const i=mu(this.containers,(e=>e.container===t));return-1!==i?(this.containers[i].modals.push(e),r):(this.containers.push({modals:[e],container:t,restore:null,hiddenSiblings:n}),r)}mount(e,t){const r=mu(this.containers,(t=>t.modals.includes(e))),n=this.containers[r];n.restore||(n.restore=gu(n,t))}remove(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const r=this.modals.indexOf(e);if(-1===r)return r;const n=mu(this.containers,(t=>t.modals.includes(e))),i=this.containers[n];if(i.modals.splice(i.modals.indexOf(e),1),this.modals.splice(r,1),0===i.modals.length)i.restore&&i.restore(),e.modalRef&&du(e.modalRef,t),pu(i.container,e.mount,e.modalRef,i.hiddenSiblings,!1),this.containers.splice(n,1);else{const e=i.modals[i.modals.length-1];e.modalRef&&du(e.modalRef,!1)}return r}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}};const bu=function(t){const{container:r,disableEscapeKeyDown:n=!1,disableScrollLock:i=!1,closeAfterTransition:s=!1,onTransitionEnter:a,onTransitionExited:o,children:l,onClose:c,open:h,rootRef:d}=t,f=e.useRef({}),p=e.useRef(null),m=e.useRef(null),g=xo(m,d),[v,y]=e.useState(!h),b=function(e){return!!e&&e.props.hasOwnProperty("in")}(l);let w=!0;"false"!==t["aria-hidden"]&&!1!==t["aria-hidden"]||(w=!1);const x=()=>(f.current.modalRef=m.current,f.current.mount=p.current,f.current),S=()=>{yu.mount(x(),{disableScrollLock:i}),m.current&&(m.current.scrollTop=0)},_=uu((()=>{const e=function(e){return"function"===typeof e?e():e}(r)||So(p.current).body;yu.add(x(),e),m.current&&S()})),C=()=>yu.isTopModal(x()),E=uu((e=>{p.current=e,e&&(h&&C()?S():m.current&&du(m.current,w))})),A=e.useCallback((()=>{yu.remove(x(),w)}),[w]);e.useEffect((()=>()=>{A()}),[A]),e.useEffect((()=>{h?_():b&&s||A()}),[h,A,b,s,_]);const M=e=>t=>{var r;null===(r=e.onKeyDown)||void 0===r||r.call(e,t),"Escape"===t.key&&229!==t.which&&C()&&(n||(t.stopPropagation(),c&&c(t,"escapeKeyDown")))},T=e=>t=>{var r;null===(r=e.onClick)||void 0===r||r.call(e,t),t.target===t.currentTarget&&c&&c(t,"backdropClick")};return{getRootProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=Ql(t);delete r.onTransitionEnter,delete r.onTransitionExited;const n=u(u({},r),e);return u(u({role:"presentation"},n),{},{onKeyDown:M(n),ref:g})},getBackdropProps:function(){const e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u(u({"aria-hidden":!0},e),{},{onClick:T(e),open:h})},getTransitionProps:()=>{var e,t;return{onEnter:hu((()=>{y(!1),a&&a()}),null!==(e=null===l||void 0===l?void 0:l.props.onEnter)&&void 0!==e?e:vu),onExited:hu((()=>{y(!0),o&&o(),s&&A()}),null!==(t=null===l||void 0===l?void 0:l.props.onExited)&&void 0!==t?t:vu)}},rootRef:g,portalRef:E,isTopModal:C,exited:v,hasTransition:b}};function wu(e){return ka("MuiModal",e)}Da("MuiModal",["root","hidden","backdrop"]);const xu=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],Su=eo("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,!r.open&&r.exited&&t.hidden]}})(ro((e=>{let{theme:t}=e;return{position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:e=>{let{ownerState:t}=e;return!t.open&&t.exited},style:{visibility:"hidden"}}]}}))),_u=eo(cu,{name:"MuiModal",slot:"Backdrop",overridesResolver:(e,t)=>t.backdrop})({zIndex:-1}),Cu=e.forwardRef((function(t,r){const n=no({name:"MuiModal",props:t}),{BackdropComponent:i=_u,BackdropProps:a,classes:o,className:l,closeAfterTransition:c=!1,children:h,container:d,component:f,components:p={},componentsProps:m={},disableAutoFocus:g=!1,disableEnforceFocus:v=!1,disableEscapeKeyDown:y=!1,disablePortal:b=!1,disableRestoreFocus:w=!1,disableScrollLock:x=!1,hideBackdrop:S=!1,keepMounted:_=!1,onBackdropClick:C,onClose:E,onTransitionEnter:A,onTransitionExited:M,open:T,slotProps:P={},slots:k={},theme:D}=n,I=s(n,xu),O=u(u({},n),{},{closeAfterTransition:c,disableAutoFocus:g,disableEnforceFocus:v,disableEscapeKeyDown:y,disablePortal:b,disableRestoreFocus:w,disableScrollLock:x,hideBackdrop:S,keepMounted:_}),{getRootProps:R,getBackdropProps:L,getTransitionProps:N,portalRef:B,isTopModal:z,exited:F,hasTransition:j}=bu(u(u({},O),{},{rootRef:r})),U=u(u({},O),{},{exited:F}),V=(e=>{const{open:t,exited:r,classes:n}=e;return Na({root:["root",!t&&r&&"hidden"],backdrop:["backdrop"]},wu,n)})(U),H={};if(void 0===h.props.tabIndex&&(H.tabIndex="-1"),j){const{onEnter:e,onExited:t}=N();H.onEnter=e,H.onExited=t}const W=u(u({},I),{},{slots:u({root:p.Root,backdrop:p.Backdrop},k),slotProps:u(u({},m),P)}),[G,q]=eu("root",{elementType:Su,externalForwardedProps:W,getSlotProps:R,additionalProps:{ref:r,as:f},ownerState:U,className:ua(l,null===V||void 0===V?void 0:V.root,!U.open&&U.exited&&(null===V||void 0===V?void 0:V.hidden))}),[X,Y]=eu("backdrop",{elementType:i,externalForwardedProps:W,additionalProps:a,getSlotProps:e=>L(u(u({},e),{},{onClick:t=>{C&&C(t),null!==e&&void 0!==e&&e.onClick&&e.onClick(t)}})),className:ua(null===a||void 0===a?void 0:a.className,null===V||void 0===V?void 0:V.backdrop),ownerState:U}),K=Lo(null===a||void 0===a?void 0:a.ref,Y.ref);return _||T||j&&!F?(0,bt.jsx)(Qc,{ref:B,container:d,disablePortal:b,children:(0,bt.jsxs)(G,u(u({},q),{},{children:[!S&&i?(0,bt.jsx)(X,u(u({},Y),{},{ref:K})):null,(0,bt.jsx)(Kc,{disableEnforceFocus:v,disableAutoFocus:g,disableRestoreFocus:w,isEnabled:z,open:T,children:e.cloneElement(h,H)})]}))}):null})),Eu=Cu;function Au(e){return ka("MuiPaper",e)}Da("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const Mu=["className","component","elevation","square","variant"],Tu=eo("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.variant],!r.square&&t.rounded,"elevation"===r.variant&&t["elevation".concat(r.elevation)]]}})(ro((e=>{let{theme:t}=e;return{backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow"),variants:[{props:e=>{let{ownerState:t}=e;return!t.square},style:{borderRadius:t.shape.borderRadius}},{props:{variant:"outlined"},style:{border:"1px solid ".concat((t.vars||t).palette.divider)}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}}))),Pu=e.forwardRef((function(e,t){var r;const n=no({props:e,name:"MuiPaper"}),i=Bc(),{className:a,component:o="div",elevation:l=1,square:c=!1,variant:h="elevation"}=n,d=s(n,Mu),f=u(u({},n),{},{component:o,elevation:l,square:c,variant:h}),p=(e=>{const{square:t,elevation:r,variant:n,classes:i}=e;return Na({root:["root",n,!t&&"rounded","elevation"===n&&"elevation".concat(r)]},Au,i)})(f);return(0,bt.jsx)(Tu,u(u({as:o,ownerState:f,className:ua(p.root,a),ref:t},d),{},{style:u(u({},"elevation"===h&&u(u({"--Paper-shadow":(i.vars||i).shadows[l]},i.vars&&{"--Paper-overlay":null===(r=i.vars.overlays)||void 0===r?void 0:r[l]}),!i.vars&&"dark"===i.palette.mode&&{"--Paper-overlay":"linear-gradient(".concat(Dt("#fff",On(l)),", ").concat(Dt("#fff",On(l)),")")})),d.style)}))})),ku=Pu;function Du(e){return ka("MuiPopover",e)}Da("MuiPopover",["root","paper"]);const Iu=["onEntering"],Ou=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],Ru=["slotProps"];function Lu(e,t){let r=0;return"number"===typeof t?r=t:"center"===t?r=e.height/2:"bottom"===t&&(r=e.height),r}function Nu(e,t){let r=0;return"number"===typeof t?r=t:"center"===t?r=e.width/2:"right"===t&&(r=e.width),r}function Bu(e){return[e.horizontal,e.vertical].map((e=>"number"===typeof e?"".concat(e,"px"):e)).join(" ")}function zu(e){return"function"===typeof e?e():e}const Fu=eo(Eu,{name:"MuiPopover",slot:"Root",overridesResolver:(e,t)=>t.root})({}),ju=eo(ku,{name:"MuiPopover",slot:"Paper",overridesResolver:(e,t)=>t.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Uu=e.forwardRef((function(t,r){var n;const i=no({props:t,name:"MuiPopover"}),{action:a,anchorEl:o,anchorOrigin:l={vertical:"top",horizontal:"left"},anchorPosition:c,anchorReference:h="anchorEl",children:d,className:f,container:p,elevation:m=8,marginThreshold:g=16,open:v,PaperProps:y={},slots:b={},slotProps:w={},transformOrigin:x={vertical:"top",horizontal:"left"},TransitionComponent:S=Gc,transitionDuration:_="auto",TransitionProps:{onEntering:C}={},disableScrollLock:E=!1}=i,A=s(i.TransitionProps,Iu),M=s(i,Ou),T=null!==(n=null===w||void 0===w?void 0:w.paper)&&void 0!==n?n:y,P=e.useRef(),k=u(u({},i),{},{anchorOrigin:l,anchorReference:h,elevation:m,marginThreshold:g,externalPaperSlotProps:T,transformOrigin:x,TransitionComponent:S,transitionDuration:_,TransitionProps:A}),D=(e=>{const{classes:t}=e;return Na({root:["root"],paper:["paper"]},Du,t)})(k),I=e.useCallback((()=>{if("anchorPosition"===h)return c;const e=zu(o),t=(e&&1===e.nodeType?e:Xl(P.current).body).getBoundingClientRect();return{top:t.top+Lu(t,l.vertical),left:t.left+Nu(t,l.horizontal)}}),[o,l.horizontal,l.vertical,c,h]),O=e.useCallback((e=>({vertical:Lu(e,x.vertical),horizontal:Nu(e,x.horizontal)})),[x.horizontal,x.vertical]),R=e.useCallback((e=>{const t={width:e.offsetWidth,height:e.offsetHeight},r=O(t);if("none"===h)return{top:null,left:null,transformOrigin:Bu(r)};const n=I();let i=n.top-r.vertical,s=n.left-r.horizontal;const a=i+t.height,l=s+t.width,c=cc(zu(o)),u=c.innerHeight-g,d=c.innerWidth-g;if(null!==g&&i<g){const e=i-g;i-=e,r.vertical+=e}else if(null!==g&&a>u){const e=a-u;i-=e,r.vertical+=e}if(null!==g&&s<g){const e=s-g;s-=e,r.horizontal+=e}else if(l>d){const e=l-d;s-=e,r.horizontal+=e}return{top:"".concat(Math.round(i),"px"),left:"".concat(Math.round(s),"px"),transformOrigin:Bu(r)}}),[o,h,I,O,g]),[L,N]=e.useState(v),B=e.useCallback((()=>{const e=P.current;if(!e)return;const t=R(e);null!==t.top&&e.style.setProperty("top",t.top),null!==t.left&&(e.style.left=t.left),e.style.transformOrigin=t.transformOrigin,N(!0)}),[R]);e.useEffect((()=>(E&&window.addEventListener("scroll",B),()=>window.removeEventListener("scroll",B))),[o,E,B]);e.useEffect((()=>{v&&B()})),e.useImperativeHandle(a,(()=>v?{updatePosition:()=>{B()}}:null),[v,B]),e.useEffect((()=>{if(!v)return;const e=vc((()=>{B()})),t=cc(o);return t.addEventListener("resize",e),()=>{e.clear(),t.removeEventListener("resize",e)}}),[o,v,B]);let z=_;"auto"!==_||S.muiSupportAuto||(z=void 0);const F=p||(o?Xl(zu(o)).body:void 0),j={slots:b,slotProps:u(u({},w),{},{paper:T})},[U,V]=eu("paper",{elementType:ju,externalForwardedProps:j,additionalProps:{elevation:m,className:ua(D.paper,null===T||void 0===T?void 0:T.className),style:L?T.style:u(u({},T.style),{},{opacity:0})},ownerState:k}),[H,W]=eu("root",{elementType:Fu,externalForwardedProps:j,additionalProps:{slotProps:{backdrop:{invisible:!0}},container:F,open:v},ownerState:k,className:ua(D.root,f)}),{slotProps:G}=W,q=s(W,Ru),X=Lo(P,V.ref);return(0,bt.jsx)(H,u(u(u(u({},q),!Do(H)&&{slotProps:G,disableScrollLock:E}),M),{},{ref:r,children:(0,bt.jsx)(S,u(u({appear:!0,in:v,onEntering:(e,t)=>{C&&C(e,t),B()},onExited:()=>{N(!1)},timeout:z},A),{},{children:(0,bt.jsx)(U,u(u({},V),{},{ref:X,children:d}))}))}))})),Vu=Uu;function Hu(e){return ka("MuiMenu",e)}Da("MuiMenu",["root","paper","list"]);const Wu=["onEntering"],Gu=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],qu={vertical:"top",horizontal:"right"},Xu={vertical:"top",horizontal:"left"},Yu=eo(Vu,{shouldForwardProp:e=>Ja(e)||"classes"===e,name:"MuiMenu",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Ku=eo(ju,{name:"MuiMenu",slot:"Paper",overridesResolver:(e,t)=>t.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),Qu=eo(gc,{name:"MuiMenu",slot:"List",overridesResolver:(e,t)=>t.list})({outline:0}),Zu=e.forwardRef((function(t,r){var n,i;const a=no({props:t,name:"MuiMenu"}),{autoFocus:o=!0,children:l,className:c,disableAutoFocusItem:h=!1,MenuListProps:d={},onClose:f,open:p,PaperProps:m={},PopoverClasses:g,transitionDuration:v="auto",TransitionProps:{onEntering:y}={},variant:b="selectedMenu",slots:w={},slotProps:x={}}=a,S=s(a.TransitionProps,Wu),_=s(a,Gu),C=Is(),E=u(u({},a),{},{autoFocus:o,disableAutoFocusItem:h,MenuListProps:d,onEntering:y,PaperProps:m,transitionDuration:v,TransitionProps:S,variant:b}),A=(e=>{const{classes:t}=e;return Na({root:["root"],paper:["paper"],list:["list"]},Hu,t)})(E),M=o&&!h&&p,T=e.useRef(null);let P=-1;e.Children.map(l,((t,r)=>{e.isValidElement(t)&&(t.props.disabled||("selectedMenu"===b&&t.props.selected||-1===P)&&(P=r))}));const k=null!==(n=w.paper)&&void 0!==n?n:Ku,D=null!==(i=x.paper)&&void 0!==i?i:m,I=tc({elementType:w.root,externalSlotProps:x.root,ownerState:E,className:[A.root,c]}),O=tc({elementType:k,externalSlotProps:D,ownerState:E,className:A.paper});return(0,bt.jsx)(Yu,u(u({onClose:f,anchorOrigin:{vertical:"bottom",horizontal:C?"right":"left"},transformOrigin:C?qu:Xu,slots:{paper:k,root:w.root},slotProps:{root:I,paper:O},open:p,ref:r,transitionDuration:v,TransitionProps:u({onEntering:(e,t)=>{T.current&&T.current.adjustStyleForScrollbar(e,{direction:C?"rtl":"ltr"}),y&&y(e,t)}},S),ownerState:E},_),{},{classes:g,children:(0,bt.jsx)(Qu,u(u({onKeyDown:e=>{"Tab"===e.key&&(e.preventDefault(),f&&f(e,"tabKeyDown"))},actions:T,autoFocus:o&&(-1===P||h),autoFocusItem:M,variant:b},d),{},{className:ua(A.list,d.className),children:l}))}))})),Ju=Zu;function $u(e){return ka("MuiNativeSelect",e)}const eh=Da("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),th=["className","disabled","error","IconComponent","inputRef","variant"],rh=eo("select")((e=>{let{theme:t}=e;return{MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{borderRadius:0},["&.".concat(eh.disabled)]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(t.vars||t).palette.background.paper},variants:[{props:e=>{let{ownerState:t}=e;return"filled"!==t.variant&&"outlined"!==t.variant},style:{"&&&":{paddingRight:24,minWidth:16}}},{props:{variant:"filled"},style:{"&&&":{paddingRight:32}}},{props:{variant:"outlined"},style:{borderRadius:(t.vars||t).shape.borderRadius,"&:focus":{borderRadius:(t.vars||t).shape.borderRadius},"&&&":{paddingRight:32}}}]}})),nh=eo(rh,{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Ja,overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.select,t[r.variant],r.error&&t.error,{["&.".concat(eh.multiple)]:t.multiple}]}})({}),ih=eo("svg")((e=>{let{theme:t}=e;return{position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(t.vars||t).palette.action.active,["&.".concat(eh.disabled)]:{color:(t.vars||t).palette.action.disabled},variants:[{props:e=>{let{ownerState:t}=e;return t.open},style:{transform:"rotate(180deg)"}},{props:{variant:"filled"},style:{right:7}},{props:{variant:"outlined"},style:{right:7}}]}})),sh=eo(ih,{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.icon,r.variant&&t["icon".concat(io(r.variant))],r.open&&t.iconOpen]}})({}),ah=e.forwardRef((function(t,r){const{className:n,disabled:i,error:a,IconComponent:o,inputRef:l,variant:c="standard"}=t,h=s(t,th),d=u(u({},t),{},{disabled:i,variant:c,error:a}),f=(e=>{const{classes:t,variant:r,disabled:n,multiple:i,open:s,error:a}=e;return Na({select:["select",r,n&&"disabled",i&&"multiple",a&&"error"],icon:["icon","icon".concat(io(r)),s&&"iconOpen",n&&"disabled"]},$u,t)})(d);return(0,bt.jsxs)(e.Fragment,{children:[(0,bt.jsx)(nh,u({ownerState:d,className:ua(f.select,n),disabled:i,ref:l||r},h)),t.multiple?null:(0,bt.jsx)(sh,{as:o,ownerState:d,className:f.icon})]})})),oh=ah;function lh(t){let{controlled:r,default:n,name:i,state:s="value"}=t;const{current:a}=e.useRef(void 0!==r),[o,l]=e.useState(n);return[a?r:o,e.useCallback((e=>{a||l(e)}),[])]}const ch=lh;function uh(e){return ka("MuiSelect",e)}const hh=Da("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),dh=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","required","SelectDisplayProps","tabIndex","type","value","variant"];var fh;const ph=eo(rh,{name:"MuiSelect",slot:"Select",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[{["&.".concat(hh.select)]:t.select},{["&.".concat(hh.select)]:t[r.variant]},{["&.".concat(hh.error)]:t.error},{["&.".concat(hh.multiple)]:t.multiple}]}})({["&.".concat(hh.select)]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),mh=eo(ih,{name:"MuiSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.icon,r.variant&&t["icon".concat(io(r.variant))],r.open&&t.iconOpen]}})({}),gh=eo("input",{shouldForwardProp:e=>Za(e)&&"classes"!==e,name:"MuiSelect",slot:"NativeInput",overridesResolver:(e,t)=>t.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function vh(e,t){return"object"===typeof t&&null!==t?e===t:String(e)===String(t)}function yh(e){return null==e||"string"===typeof e&&!e.trim()}const bh=e.forwardRef((function(t,r){var n;const{"aria-describedby":i,"aria-label":a,autoFocus:o,autoWidth:l,children:c,className:h,defaultOpen:d,defaultValue:f,disabled:p,displayEmpty:m,error:g=!1,IconComponent:v,inputRef:y,labelId:b,MenuProps:w={},multiple:x,name:S,onBlur:_,onChange:C,onClose:E,onFocus:A,onOpen:M,open:T,readOnly:P,renderValue:k,required:D,SelectDisplayProps:I={},tabIndex:O,type:R,value:L,variant:N="standard"}=t,B=s(t,dh),[z,F]=ch({controlled:L,default:f,name:"Select"}),[j,U]=ch({controlled:T,default:d,name:"Select"}),V=e.useRef(null),H=e.useRef(null),[W,G]=e.useState(null),{current:q}=e.useRef(null!=T),[X,Y]=e.useState(),K=Lo(r,y),Q=e.useCallback((e=>{H.current=e,e&&G(e)}),[]),Z=null===W||void 0===W?void 0:W.parentNode;e.useImperativeHandle(K,(()=>({focus:()=>{H.current.focus()},node:V.current,value:z})),[z]),e.useEffect((()=>{d&&j&&W&&!q&&(Y(l?null:Z.clientWidth),H.current.focus())}),[W,l]),e.useEffect((()=>{o&&H.current.focus()}),[o]),e.useEffect((()=>{if(!b)return;const e=Xl(H.current).getElementById(b);if(e){const t=()=>{getSelection().isCollapsed&&H.current.focus()};return e.addEventListener("click",t),()=>{e.removeEventListener("click",t)}}}),[b]);const J=(e,t)=>{e?M&&M(t):E&&E(t),q||(Y(l?null:Z.clientWidth),U(e))},$=e.Children.toArray(c),ee=e=>t=>{let r;if(t.currentTarget.hasAttribute("tabindex")){if(x){r=Array.isArray(z)?z.slice():[];const t=z.indexOf(e.props.value);-1===t?r.push(e.props.value):r.splice(t,1)}else r=e.props.value;if(e.props.onClick&&e.props.onClick(t),z!==r&&(F(r),C)){const n=t.nativeEvent||t,i=new n.constructor(n.type,n);Object.defineProperty(i,"target",{writable:!0,value:{value:r,name:S}}),C(i,e)}x||J(!1,t)}},te=null!==W&&j;let re,ne;delete B["aria-invalid"];const ie=[];let se=!1,ae=!1;(zo({value:z})||m)&&(k?re=k(z):se=!0);const oe=$.map((t=>{if(!e.isValidElement(t))return null;let r;if(x){if(!Array.isArray(z))throw new Error(wt(2));r=z.some((e=>vh(e,t.props.value))),r&&se&&ie.push(t.props.children)}else r=vh(z,t.props.value),r&&se&&(ne=t.props.children);return r&&(ae=!0),e.cloneElement(t,{"aria-selected":r?"true":"false",onClick:ee(t),onKeyUp:e=>{" "===e.key&&e.preventDefault(),t.props.onKeyUp&&t.props.onKeyUp(e)},role:"option",selected:r,value:void 0,"data-value":t.props.value})}));se&&(re=x?0===ie.length?null:ie.reduce(((e,t,r)=>(e.push(t),r<ie.length-1&&e.push(", "),e)),[]):ne);let le,ce=X;!l&&q&&W&&(ce=Z.clientWidth),le="undefined"!==typeof O?O:p?null:0;const ue=I.id||(S?"mui-component-select-".concat(S):void 0),he=u(u({},t),{},{variant:N,value:z,open:te,error:g}),de=(e=>{const{classes:t,variant:r,disabled:n,multiple:i,open:s,error:a}=e;return Na({select:["select",r,n&&"disabled",i&&"multiple",a&&"error"],icon:["icon","icon".concat(io(r)),s&&"iconOpen",n&&"disabled"],nativeInput:["nativeInput"]},uh,t)})(he),fe=u(u({},w.PaperProps),null===(n=w.slotProps)||void 0===n?void 0:n.paper),pe=bo();return(0,bt.jsxs)(e.Fragment,{children:[(0,bt.jsx)(ph,u(u({as:"div",ref:Q,tabIndex:le,role:"combobox","aria-controls":pe,"aria-disabled":p?"true":void 0,"aria-expanded":te?"true":"false","aria-haspopup":"listbox","aria-label":a,"aria-labelledby":[b,ue].filter(Boolean).join(" ")||void 0,"aria-describedby":i,"aria-required":D?"true":void 0,"aria-invalid":g?"true":void 0,onKeyDown:e=>{if(!P){[" ","ArrowUp","ArrowDown","Enter"].includes(e.key)&&(e.preventDefault(),J(!0,e))}},onMouseDown:p||P?null:e=>{0===e.button&&(e.preventDefault(),H.current.focus(),J(!0,e))},onBlur:e=>{!te&&_&&(Object.defineProperty(e,"target",{writable:!0,value:{value:z,name:S}}),_(e))},onFocus:A},I),{},{ownerState:he,className:ua(I.className,de.select,h),id:ue,children:yh(re)?fh||(fh=(0,bt.jsx)("span",{className:"notranslate","aria-hidden":!0,children:"\u200b"})):re})),(0,bt.jsx)(gh,u(u({"aria-invalid":g,value:Array.isArray(z)?z.join(","):z,name:S,ref:V,"aria-hidden":!0,onChange:e=>{const t=$.find((t=>t.props.value===e.target.value));void 0!==t&&(F(t.props.value),C&&C(e,t))},tabIndex:-1,disabled:p,className:de.nativeInput,autoFocus:o,required:D},B),{},{ownerState:he})),(0,bt.jsx)(mh,{as:v,className:de.icon,ownerState:he}),(0,bt.jsx)(Ju,u(u({id:"menu-".concat(S||""),anchorEl:Z,open:te,onClose:e=>{J(!1,e)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},w),{},{MenuListProps:u({"aria-labelledby":b,role:"listbox","aria-multiselectable":x?"true":void 0,disableListWrap:!0,id:pe},w.MenuListProps),slotProps:u(u({},w.slotProps),{},{paper:u(u({},fe),{},{style:u({minWidth:ce},null!=fe?fe.style:null)})}),children:oe}))]})})),wh=bh;function xh(e){return ka("MuiSvgIcon",e)}Da("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const Sh=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],_h=eo("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,"inherit"!==r.color&&t["color".concat(io(r.color))],t["fontSize".concat(io(r.fontSize))]]}})(ro((e=>{var t,r,n,i,s,a,o,l,c,u,h,d,f,p,m;let{theme:g}=e;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:null===(t=g.transitions)||void 0===t||null===(r=t.create)||void 0===r?void 0:r.call(t,"fill",{duration:null===(n=(null!==(i=g.vars)&&void 0!==i?i:g).transitions)||void 0===n||null===(n=n.duration)||void 0===n?void 0:n.shorter}),variants:[{props:e=>!e.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:(null===(s=g.typography)||void 0===s||null===(a=s.pxToRem)||void 0===a?void 0:a.call(s,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:(null===(o=g.typography)||void 0===o||null===(l=o.pxToRem)||void 0===l?void 0:l.call(o,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:(null===(c=g.typography)||void 0===c||null===(u=c.pxToRem)||void 0===u?void 0:u.call(c,35))||"2.1875rem"}},...Object.entries((null!==(h=g.vars)&&void 0!==h?h:g).palette).filter((e=>{let[,t]=e;return t&&t.main})).map((e=>{var t,r;let[n]=e;return{props:{color:n},style:{color:null===(t=(null!==(r=g.vars)&&void 0!==r?r:g).palette)||void 0===t||null===(t=t[n])||void 0===t?void 0:t.main}}})),{props:{color:"action"},style:{color:null===(d=(null!==(f=g.vars)&&void 0!==f?f:g).palette)||void 0===d||null===(d=d.action)||void 0===d?void 0:d.active}},{props:{color:"disabled"},style:{color:null===(p=(null!==(m=g.vars)&&void 0!==m?m:g).palette)||void 0===p||null===(p=p.action)||void 0===p?void 0:p.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}}))),Ch=e.forwardRef((function(t,r){const n=no({props:t,name:"MuiSvgIcon"}),{children:i,className:a,color:o="inherit",component:l="svg",fontSize:c="medium",htmlColor:h,inheritViewBox:d=!1,titleAccess:f,viewBox:p="0 0 24 24"}=n,m=s(n,Sh),g=e.isValidElement(i)&&"svg"===i.type,v=u(u({},n),{},{color:o,component:l,fontSize:c,instanceFontSize:t.fontSize,inheritViewBox:d,viewBox:p,hasSvgAsChild:g}),y={};d||(y.viewBox=p);const b=(e=>{const{color:t,fontSize:r,classes:n}=e;return Na({root:["root","inherit"!==t&&"color".concat(io(t)),"fontSize".concat(io(r))]},xh,n)})(v);return(0,bt.jsxs)(_h,u(u(u(u({as:l,className:ua(b.root,a),focusable:"false",color:h,"aria-hidden":!f||void 0,role:f?"img":void 0,ref:r},y),m),g&&i.props),{},{ownerState:v,children:[g?i.props.children:i,f?(0,bt.jsx)("title",{children:f}):null]}))}));Ch&&(Ch.muiName="SvgIcon");const Eh=Ch;function Ah(t,r){function n(e,n){return(0,bt.jsx)(Eh,u(u({"data-testid":"".concat(r,"Icon"),ref:n},e),{},{children:t}))}return n.muiName=Eh.muiName,e.memo(e.forwardRef(n))}const Mh=Ah((0,bt.jsx)("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),Th=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],Ph=["root"],kh={name:"MuiSelect",overridesResolver:(e,t)=>t.root,shouldForwardProp:e=>Ja(e)&&"variant"!==e,slot:"Root"},Dh=eo(rl,kh)(""),Ih=eo(xl,kh)(""),Oh=eo(cl,kh)(""),Rh=e.forwardRef((function(t,r){const n=no({name:"MuiSelect",props:t}),{autoWidth:i=!1,children:a,classes:o={},className:l,defaultOpen:c=!1,displayEmpty:h=!1,IconComponent:d=Mh,id:f,input:p,inputProps:m,label:g,labelId:v,MenuProps:y,multiple:b=!1,native:w=!1,onClose:x,onOpen:S,open:_,renderValue:C,SelectDisplayProps:E,variant:A="outlined"}=n,M=s(n,Th),T=w?oh:wh,P=Io({props:n,muiFormControl:Ro(),states:["variant","error"]}),k=P.variant||A,D=u(u({},n),{},{variant:k,classes:o}),I=(e=>{const{classes:t}=e;return t})(D),{root:O}=I,R=s(I,Ph),L=p||{standard:(0,bt.jsx)(Dh,{ownerState:D}),outlined:(0,bt.jsx)(Ih,{label:g,ownerState:D}),filled:(0,bt.jsx)(Oh,{ownerState:D})}[k],N=Lo(r,ql(L));return(0,bt.jsx)(e.Fragment,{children:e.cloneElement(L,u(u(u({inputComponent:T,inputProps:u(u(u({children:a,error:P.error,IconComponent:d,variant:k,type:void 0,multiple:b},w?{id:f}:{autoWidth:i,defaultOpen:c,displayEmpty:h,labelId:v,MenuProps:y,onClose:x,onOpen:S,open:_,renderValue:C,SelectDisplayProps:u({id:f},E)}),m),{},{classes:m?_t(R,m.classes):R},p?p.props.inputProps:{})},(b&&w||h)&&"outlined"===k?{notched:!0}:{}),{},{ref:N,className:ua(L.props.className,l,I.root)},!p&&{variant:k}),M))})}));Rh.muiName="Select";const Lh=Rh;function Nh(e){return ka("MuiTextField",e)}Da("MuiTextField",["root"]);const Bh=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","slots","slotProps","type","value","variant"],zh={standard:rl,filled:cl,outlined:xl},Fh=eo(Fl,{name:"MuiTextField",slot:"Root",overridesResolver:(e,t)=>t.root})({}),jh=e.forwardRef((function(e,t){const r=no({props:e,name:"MuiTextField"}),{autoComplete:n,autoFocus:i=!1,children:a,className:o,color:l="primary",defaultValue:c,disabled:h=!1,error:d=!1,FormHelperTextProps:f,fullWidth:p=!1,helperText:m,id:g,InputLabelProps:v,inputProps:y,InputProps:b,inputRef:w,label:x,maxRows:S,minRows:_,multiline:C=!1,name:E,onBlur:A,onChange:M,onFocus:T,placeholder:P,required:k=!1,rows:D,select:I=!1,SelectProps:O,slots:R={},slotProps:L={},type:N,value:B,variant:z="outlined"}=r,F=s(r,Bh),j=u(u({},r),{},{autoFocus:i,color:l,disabled:h,error:d,fullWidth:p,multiline:C,required:k,select:I,variant:z}),U=(e=>{const{classes:t}=e;return Na({root:["root"]},Nh,t)})(j);const V=bo(g),H=m&&V?"".concat(V,"-helper-text"):void 0,W=x&&V?"".concat(V,"-label"):void 0,G=zh[z],q={slots:R,slotProps:u({input:b,inputLabel:v,htmlInput:y,formHelperText:f,select:O},L)},X={},Y=q.slotProps.inputLabel;"outlined"===z&&(Y&&"undefined"!==typeof Y.shrink&&(X.notched=Y.shrink),X.label=x),I&&(O&&O.native||(X.id=void 0),X["aria-describedby"]=void 0);const[K,Q]=eu("input",{elementType:G,externalForwardedProps:q,additionalProps:X,ownerState:j}),[Z,J]=eu("inputLabel",{elementType:Ol,externalForwardedProps:q,ownerState:j}),[$,ee]=eu("htmlInput",{elementType:"input",externalForwardedProps:q,ownerState:j}),[te,re]=eu("formHelperText",{elementType:Gl,externalForwardedProps:q,ownerState:j}),[ne,ie]=eu("select",{elementType:Lh,externalForwardedProps:q,ownerState:j}),se=(0,bt.jsx)(K,u({"aria-describedby":H,autoComplete:n,autoFocus:i,defaultValue:c,fullWidth:p,multiline:C,name:E,rows:D,maxRows:S,minRows:_,type:N,value:B,id:V,inputRef:w,onBlur:A,onChange:M,onFocus:T,placeholder:P,inputProps:ee,slots:{input:R.htmlInput?$:void 0}},Q));return(0,bt.jsxs)(Fh,u(u({className:ua(U.root,o),disabled:h,error:d,fullWidth:p,ref:t,required:k,color:l,variant:z,ownerState:j},F),{},{children:[null!=x&&""!==x&&(0,bt.jsx)(Z,u(u({htmlFor:V,id:W},J),{},{children:x})),I?(0,bt.jsx)(ne,u(u({"aria-describedby":H,id:V,labelId:W,value:B,input:se},ie),{},{children:a})):se,m&&(0,bt.jsx)(te,u(u({id:H},re),{},{children:m}))]}))})),Uh=jh;function Vh(e){return ka("MuiDivider",e)}const Hh=Da("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),Wh=["absolute","children","className","orientation","component","flexItem","light","role","textAlign","variant"],Gh=eo("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.absolute&&t.absolute,t[r.variant],r.light&&t.light,"vertical"===r.orientation&&t.vertical,r.flexItem&&t.flexItem,r.children&&t.withChildren,r.children&&"vertical"===r.orientation&&t.withChildrenVertical,"right"===r.textAlign&&"vertical"!==r.orientation&&t.textAlignRight,"left"===r.textAlign&&"vertical"!==r.orientation&&t.textAlignLeft]}})(ro((e=>{let{theme:t}=e;return{margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(t.vars||t).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:t.vars?"rgba(".concat(t.vars.palette.dividerChannel," / 0.08)"):Dt(t.palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:t.spacing(2),marginRight:t.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:t.spacing(1),marginBottom:t.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:e=>{let{ownerState:t}=e;return!!t.children},style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:e=>{let{ownerState:t}=e;return t.children&&"vertical"!==t.orientation},style:{"&::before, &::after":{width:"100%",borderTop:"thin solid ".concat((t.vars||t).palette.divider),borderTopStyle:"inherit"}}},{props:e=>{let{ownerState:t}=e;return"vertical"===t.orientation&&t.children},style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:"thin solid ".concat((t.vars||t).palette.divider),borderLeftStyle:"inherit"}}},{props:e=>{let{ownerState:t}=e;return"right"===t.textAlign&&"vertical"!==t.orientation},style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:e=>{let{ownerState:t}=e;return"left"===t.textAlign&&"vertical"!==t.orientation},style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}}))),qh=eo("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.wrapper,"vertical"===r.orientation&&t.wrapperVertical]}})(ro((e=>{let{theme:t}=e;return{display:"inline-block",paddingLeft:"calc(".concat(t.spacing(1)," * 1.2)"),paddingRight:"calc(".concat(t.spacing(1)," * 1.2)"),whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:"calc(".concat(t.spacing(1)," * 1.2)"),paddingBottom:"calc(".concat(t.spacing(1)," * 1.2)")}}]}}))),Xh=e.forwardRef((function(e,t){const r=no({props:e,name:"MuiDivider"}),{absolute:n=!1,children:i,className:a,orientation:o="horizontal",component:l=(i||"vertical"===o?"div":"hr"),flexItem:c=!1,light:h=!1,role:d=("hr"!==l?"separator":void 0),textAlign:f="center",variant:p="fullWidth"}=r,m=s(r,Wh),g=u(u({},r),{},{absolute:n,component:l,flexItem:c,light:h,orientation:o,role:d,textAlign:f,variant:p}),v=(e=>{const{absolute:t,children:r,classes:n,flexItem:i,light:s,orientation:a,textAlign:o,variant:l}=e;return Na({root:["root",t&&"absolute",l,s&&"light","vertical"===a&&"vertical",i&&"flexItem",r&&"withChildren",r&&"vertical"===a&&"withChildrenVertical","right"===o&&"vertical"!==a&&"textAlignRight","left"===o&&"vertical"!==a&&"textAlignLeft"],wrapper:["wrapper","vertical"===a&&"wrapperVertical"]},Vh,n)})(g);return(0,bt.jsx)(Gh,u(u({as:l,className:ua(v.root,a),role:d,ref:t,ownerState:g,"aria-orientation":"separator"!==d||"hr"===l&&"vertical"!==o?void 0:o},m),{},{children:i?(0,bt.jsx)(qh,{className:v.wrapper,ownerState:g,children:i}):null}))}));Xh&&(Xh.muiSkipListHighlight=!0);const Yh=Xh,Kh=Ah((0,bt.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person"),Qh=Ah((0,bt.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2z"}),"Assessment"),Zh=Ah((0,bt.jsx)("path",{d:"M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 16H5V10h14zM9 14H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2zm-8 4H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2z"}),"CalendarMonth");var Jh=r(446),$h=r.n(Jh),ed=r(865),td=r.n(ed),rd=r(988),nd=r.n(rd),id=r(443),sd=r.n(id),ad=r(525),od=r.n(ad),ld=r(76),cd=r.n(ld);$h().extend(sd()),$h().extend(td()),$h().extend(od()),$h().extend(cd());const ud={YY:"year",YYYY:{sectionType:"year",contentType:"digit",maxLength:4},M:{sectionType:"month",contentType:"digit",maxLength:2},MM:"month",MMM:{sectionType:"month",contentType:"letter"},MMMM:{sectionType:"month",contentType:"letter"},D:{sectionType:"day",contentType:"digit",maxLength:2},DD:"day",Do:{sectionType:"day",contentType:"digit-with-letter"},d:{sectionType:"weekDay",contentType:"digit",maxLength:2},dd:{sectionType:"weekDay",contentType:"letter"},ddd:{sectionType:"weekDay",contentType:"letter"},dddd:{sectionType:"weekDay",contentType:"letter"},A:"meridiem",a:"meridiem",H:{sectionType:"hours",contentType:"digit",maxLength:2},HH:"hours",h:{sectionType:"hours",contentType:"digit",maxLength:2},hh:"hours",m:{sectionType:"minutes",contentType:"digit",maxLength:2},mm:"minutes",s:{sectionType:"seconds",contentType:"digit",maxLength:2},ss:"seconds"},hd={year:"YYYY",month:"MMMM",monthShort:"MMM",dayOfMonth:"D",dayOfMonthFull:"Do",weekday:"dddd",weekdayShort:"dd",hours24h:"HH",hours12h:"hh",meridiem:"A",minutes:"mm",seconds:"ss",fullDate:"ll",keyboardDate:"L",shortDate:"MMM D",normalDate:"D MMMM",normalDateWithWeekday:"ddd, MMM D",fullTime:"LT",fullTime12h:"hh:mm A",fullTime24h:"HH:mm",keyboardDateTime:"L LT",keyboardDateTime12h:"L hh:mm A",keyboardDateTime24h:"L HH:mm"},dd=["Missing UTC plugin","To be able to use UTC or timezones, you have to enable the `utc` plugin","Find more information on https://mui.com/x/react-date-pickers/timezone/#day-js-and-utc"].join("\n"),fd=["Missing timezone plugin","To be able to use timezones, you have to enable both the `utc` and the `timezone` plugin","Find more information on https://mui.com/x/react-date-pickers/timezone/#day-js-and-timezone"].join("\n");class pd{constructor(){var e=this;let{locale:t,formats:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var n,i;this.isMUIAdapter=!0,this.isTimezoneCompatible=!0,this.lib="dayjs",this.dayjs=void 0,this.locale=void 0,this.formats=void 0,this.escapedCharacters={start:"[",end:"]"},this.formatTokenMap=ud,this.setLocaleToValue=e=>{const t=this.getCurrentLocaleCode();return t===e.locale()?e:e.locale(t)},this.hasUTCPlugin=()=>"undefined"!==typeof $h().utc,this.hasTimezonePlugin=()=>"undefined"!==typeof $h().tz,this.isSame=(e,t,r)=>{const n=this.setTimezone(t,this.getTimezone(e));return e.format(r)===n.format(r)},this.cleanTimezone=e=>{switch(e){case"default":return;case"system":return $h().tz.guess();default:return e}},this.createSystemDate=e=>{if(this.hasUTCPlugin()&&this.hasTimezonePlugin()){const t=$h().tz.guess();return"UTC"!==t?$h().tz(e,t):$h()(e)}return $h()(e)},this.createUTCDate=e=>{if(!this.hasUTCPlugin())throw new Error(dd);return $h().utc(e)},this.createTZDate=(e,t)=>{if(!this.hasUTCPlugin())throw new Error(dd);if(!this.hasTimezonePlugin())throw new Error(fd);const r=void 0!==e&&!e.endsWith("Z");return $h()(e).tz(this.cleanTimezone(t),r)},this.getLocaleFormats=()=>{const e=$h().Ls;let t=e[this.locale||"en"];return void 0===t&&(t=e.en),t.formats},this.adjustOffset=e=>{if(!this.hasTimezonePlugin())return e;const t=this.getTimezone(e);if("UTC"!==t){var r;const n=e.tz(this.cleanTimezone(t),!0);if(n.$offset===(null!==(r=e.$offset)&&void 0!==r?r:0))return e;e.$offset=n.$offset}return e},this.date=function(t){let r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";return null===t?null:(r="UTC"===n?e.createUTCDate(t):"system"===n||"default"===n&&!e.hasTimezonePlugin()?e.createSystemDate(t):e.createTZDate(t,n),void 0===e.locale?r:r.locale(e.locale))},this.getInvalidDate=()=>$h()(new Date("Invalid date")),this.getTimezone=e=>{if(this.hasTimezonePlugin()){var t;const r=null===(t=e.$x)||void 0===t?void 0:t.$timezone;if(r)return r}return this.hasUTCPlugin()&&e.isUTC()?"UTC":"system"},this.setTimezone=(e,t)=>{if(this.getTimezone(e)===t)return e;if("UTC"===t){if(!this.hasUTCPlugin())throw new Error(dd);return e.utc()}if("system"===t)return e.local();if(!this.hasTimezonePlugin()){if("default"===t)return e;throw new Error(fd)}return $h().tz(e,this.cleanTimezone(t))},this.toJsDate=e=>e.toDate(),this.parse=(e,t)=>""===e?null:this.dayjs(e,t,this.locale,!0),this.getCurrentLocaleCode=()=>this.locale||"en",this.is12HourCycleInCurrentLocale=()=>/A|a/.test(this.getLocaleFormats().LT||""),this.expandFormat=e=>{const t=this.getLocaleFormats();return e.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,((e,r,n)=>{const i=n&&n.toUpperCase();return r||t[n]||t[i].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,((e,t,r)=>t||r.slice(1)))}))},this.isValid=e=>null!=e&&e.isValid(),this.format=(e,t)=>this.formatByString(e,this.formats[t]),this.formatByString=(e,t)=>this.dayjs(e).format(t),this.formatNumber=e=>e,this.isEqual=(e,t)=>null===e&&null===t||null!==e&&null!==t&&e.toDate().getTime()===t.toDate().getTime(),this.isSameYear=(e,t)=>this.isSame(e,t,"YYYY"),this.isSameMonth=(e,t)=>this.isSame(e,t,"YYYY-MM"),this.isSameDay=(e,t)=>this.isSame(e,t,"YYYY-MM-DD"),this.isSameHour=(e,t)=>e.isSame(t,"hour"),this.isAfter=(e,t)=>e>t,this.isAfterYear=(e,t)=>this.hasUTCPlugin()?!this.isSameYear(e,t)&&e.utc()>t.utc():e.isAfter(t,"year"),this.isAfterDay=(e,t)=>this.hasUTCPlugin()?!this.isSameDay(e,t)&&e.utc()>t.utc():e.isAfter(t,"day"),this.isBefore=(e,t)=>e<t,this.isBeforeYear=(e,t)=>this.hasUTCPlugin()?!this.isSameYear(e,t)&&e.utc()<t.utc():e.isBefore(t,"year"),this.isBeforeDay=(e,t)=>this.hasUTCPlugin()?!this.isSameDay(e,t)&&e.utc()<t.utc():e.isBefore(t,"day"),this.isWithinRange=(e,t)=>{let[r,n]=t;return e>=r&&e<=n},this.startOfYear=e=>this.adjustOffset(e.startOf("year")),this.startOfMonth=e=>this.adjustOffset(e.startOf("month")),this.startOfWeek=e=>this.adjustOffset(this.setLocaleToValue(e).startOf("week")),this.startOfDay=e=>this.adjustOffset(e.startOf("day")),this.endOfYear=e=>this.adjustOffset(e.endOf("year")),this.endOfMonth=e=>this.adjustOffset(e.endOf("month")),this.endOfWeek=e=>this.adjustOffset(this.setLocaleToValue(e).endOf("week")),this.endOfDay=e=>this.adjustOffset(e.endOf("day")),this.addYears=(e,t)=>this.adjustOffset(t<0?e.subtract(Math.abs(t),"year"):e.add(t,"year")),this.addMonths=(e,t)=>this.adjustOffset(t<0?e.subtract(Math.abs(t),"month"):e.add(t,"month")),this.addWeeks=(e,t)=>this.adjustOffset(t<0?e.subtract(Math.abs(t),"week"):e.add(t,"week")),this.addDays=(e,t)=>this.adjustOffset(t<0?e.subtract(Math.abs(t),"day"):e.add(t,"day")),this.addHours=(e,t)=>this.adjustOffset(t<0?e.subtract(Math.abs(t),"hour"):e.add(t,"hour")),this.addMinutes=(e,t)=>this.adjustOffset(t<0?e.subtract(Math.abs(t),"minute"):e.add(t,"minute")),this.addSeconds=(e,t)=>this.adjustOffset(t<0?e.subtract(Math.abs(t),"second"):e.add(t,"second")),this.getYear=e=>e.year(),this.getMonth=e=>e.month(),this.getDate=e=>e.date(),this.getHours=e=>e.hour(),this.getMinutes=e=>e.minute(),this.getSeconds=e=>e.second(),this.getMilliseconds=e=>e.millisecond(),this.setYear=(e,t)=>this.adjustOffset(e.set("year",t)),this.setMonth=(e,t)=>this.adjustOffset(e.set("month",t)),this.setDate=(e,t)=>this.adjustOffset(e.set("date",t)),this.setHours=(e,t)=>this.adjustOffset(e.set("hour",t)),this.setMinutes=(e,t)=>this.adjustOffset(e.set("minute",t)),this.setSeconds=(e,t)=>this.adjustOffset(e.set("second",t)),this.setMilliseconds=(e,t)=>this.adjustOffset(e.set("millisecond",t)),this.getDaysInMonth=e=>e.daysInMonth(),this.getWeekArray=e=>{const t=this.startOfWeek(this.startOfMonth(e)),r=this.endOfWeek(this.endOfMonth(e));let n=0,i=t;const s=[];for(;i<r;){const e=Math.floor(n/7);s[e]=s[e]||[],s[e].push(i),i=this.addDays(i,1),n+=1}return s},this.getWeekNumber=e=>e.week(),this.getYearRange=e=>{let[t,r]=e;const n=this.startOfYear(t),i=this.endOfYear(r),s=[];let a=n;for(;this.isBefore(a,i);)s.push(a),a=this.addYears(a,1);return s},this.dayjs=(n=$h(),(i=t)?function(){return n(...arguments).locale(i)}:n),this.locale=t,this.formats=ha({},hd,r),$h().extend(nd())}getDayOfWeek(e){return e.day()+1}}function md(e){const{theme:t,name:r,props:n}=e;return t&&t.components&&t.components[r]&&t.components[r].defaultProps?Rs(t.components[r].defaultProps,n):n}function gd(e){let{props:t,name:r}=e;return function(e){let{props:t,name:r,defaultTheme:n,themeId:i}=e,s=Ea(n);return i&&(s=s[i]||s),md({theme:s,name:r,props:t})}({props:t,name:r,defaultTheme:za,themeId:Us})}const vd=["localeText"],yd=e.createContext(null);const bd=function(t){var r;const{localeText:n}=t,s=i(t,vd),{utils:a,localeText:o}=null!==(r=e.useContext(yd))&&void 0!==r?r:{utils:void 0,localeText:void 0},l=gd({props:s,name:"MuiLocalizationProvider"}),{children:c,dateAdapter:u,dateFormats:h,dateLibInstance:d,adapterLocale:f,localeText:p}=l,m=e.useMemo((()=>ha({},p,o,n)),[p,o,n]),g=e.useMemo((()=>{if(!u)return a||null;const e=new u({locale:f,formats:h,instance:d});if(!e.isMUIAdapter)throw new Error(["MUI X: The date adapter should be imported from `@mui/x-date-pickers` or `@mui/x-date-pickers-pro`, not from `@date-io`","For example, `import { AdapterDayjs } from '@mui/x-date-pickers/AdapterDayjs'` instead of `import AdapterDayjs from '@date-io/dayjs'`","More information on the installation documentation: https://mui.com/x/react-date-pickers/getting-started/#installation"].join("\n"));return e}),[u,f,h,d,a]),v=e.useMemo((()=>g?{minDate:g.date("1900-01-01T00:00:00.000"),maxDate:g.date("2099-12-31T00:00:00.000")}:null),[g]),y=e.useMemo((()=>({utils:g,defaultDates:v,localeText:m})),[v,g,m]);return(0,bt.jsx)(yd.Provider,{value:y,children:c})};function wd(t,r,n,i,s){const[a,o]=e.useState((()=>s&&n?n(t).matches:i?i(t).matches:r));return Co((()=>{if(!n)return;const e=n(t),r=()=>{o(e.matches)};return r(),e.addEventListener("change",r),()=>{e.removeEventListener("change",r)}}),[t,n]),a}const xd=u({},t).useSyncExternalStore;function Sd(t,r,n,i,s){const a=e.useCallback((()=>r),[r]),o=e.useMemo((()=>{if(s&&n)return()=>n(t).matches;if(null!==i){const{matches:e}=i(t);return()=>e}return a}),[a,t,i,s,n]),[l,c]=e.useMemo((()=>{if(null===n)return[a,()=>()=>{}];const e=n(t);return[()=>e.matches,t=>(e.addEventListener("change",t),()=>{e.removeEventListener("change",t)})]}),[a,n,t]);return xd(c,l,o)}function _d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t}=e;return function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ps();n&&t&&(n=n[t]||n);const i="undefined"!==typeof window&&"undefined"!==typeof window.matchMedia,{defaultMatches:s=!1,matchMedia:a=(i?window.matchMedia:null),ssrMatchMedia:o=null,noSsr:l=!1}=md({name:"MuiUseMediaQuery",props:r,theme:n});let c="function"===typeof e?e(n):e;c=c.replace(/^@media( ?)/m,"");return(void 0!==xd?Sd:wd)(c,s,a,o,l)}}_d();const Cd=_d({themeId:Us});var Ed=r(173),Ad=r.n(Ed);const Md=Ad().oneOfType([Ad().func,Ad().object]),Td=(e,t)=>e.length===t.length&&t.every((t=>e.includes(t))),Pd=(e,t,r)=>{let n=t;return n=e.setHours(n,e.getHours(r)),n=e.setMinutes(n,e.getMinutes(r)),n=e.setSeconds(n,e.getSeconds(r)),n=e.setMilliseconds(n,e.getMilliseconds(r)),n},kd=e=>{let{date:t,disableFuture:r,disablePast:n,maxDate:i,minDate:s,isDateDisabled:a,utils:o,timezone:l}=e;const c=Pd(o,o.date(void 0,l),t);n&&o.isBefore(s,c)&&(s=c),r&&o.isAfter(i,c)&&(i=c);let u=t,h=t;for(o.isBefore(t,s)&&(u=s,h=null),o.isAfter(t,i)&&(h&&(h=i),u=null);u||h;){if(u&&o.isAfter(u,i)&&(u=null),h&&o.isBefore(h,s)&&(h=null),u){if(!a(u))return u;u=o.addDays(u,1)}if(h){if(!a(h))return h;h=o.addDays(h,-1)}}return null},Dd=(e,t,r)=>null!=t&&e.isValid(t)?t:r,Id=(e,t)=>{const r=[e.startOfYear(t)];for(;r.length<12;){const t=r[r.length-1];r.push(e.addMonths(t,1))}return r},Od=(e,t,r)=>"date"===r?e.startOfDay(e.date(void 0,t)):e.date(void 0,t),Rd=["year","month","day"],Ld=e=>Rd.includes(e),Nd=(e,t,r)=>{let{format:n,views:i}=t;if(null!=n)return n;const s=e.formats;return Td(i,["year"])?s.year:Td(i,["month"])?s.month:Td(i,["day"])?s.dayOfMonth:Td(i,["month","year"])?"".concat(s.month," ").concat(s.year):Td(i,["day","month"])?"".concat(s.month," ").concat(s.dayOfMonth):r?/en/.test(e.getCurrentLocaleCode())?s.normalDateWithWeekday:s.normalDate:s.keyboardDate},Bd=(e,t)=>{const r=e.startOfWeek(t);return[0,1,2,3,4,5,6].map((t=>e.addDays(r,t)))},zd=["hours","minutes","seconds"],Fd=(e,t)=>3600*t.getHours(e)+60*t.getMinutes(e)+t.getSeconds(e),jd={year:1,month:2,day:3,hours:4,minutes:5,seconds:6,milliseconds:7},Ud=(e,t,r)=>{if(t===jd.year)return e.startOfYear(r);if(t===jd.month)return e.startOfMonth(r);if(t===jd.day)return e.startOfDay(r);let n=r;return t<jd.minutes&&(n=e.setMinutes(n,0)),t<jd.seconds&&(n=e.setSeconds(n,0)),t<jd.milliseconds&&(n=e.setMilliseconds(n,0)),n},Vd=e=>{var t;let{props:r,utils:n,granularity:i,timezone:s,getTodayDate:a}=e,o=a?a():Ud(n,i,Od(n,s));null!=r.minDate&&n.isAfterDay(r.minDate,o)&&(o=Ud(n,i,r.minDate)),null!=r.maxDate&&n.isBeforeDay(r.maxDate,o)&&(o=Ud(n,i,r.maxDate));const l=((e,t)=>(r,n)=>e?t.isAfter(r,n):Fd(r,t)>Fd(n,t))(null!==(t=r.disableIgnoringDatePartForTimeValidation)&&void 0!==t&&t,n);return null!=r.minTime&&l(r.minTime,o)&&(o=Ud(n,i,r.disableIgnoringDatePartForTimeValidation?r.minTime:Pd(n,o,r.minTime))),null!=r.maxTime&&l(o,r.maxTime)&&(o=Ud(n,i,r.disableIgnoringDatePartForTimeValidation?r.maxTime:Pd(n,o,r.maxTime))),o},Hd=(e,t)=>{const r=e.formatTokenMap[t];if(null==r)throw new Error(['MUI X: The token "'.concat(t,'" is not supported by the Date and Time Pickers.'),"Please try using another token or open an issue on https://github.com/mui/mui-x/issues/new/choose if you think it should be supported."].join("\n"));return"string"===typeof r?{type:r,contentType:"meridiem"===r?"letter":"digit",maxLength:void 0}:{type:r.sectionType,contentType:r.contentType,maxLength:r.maxLength}},Wd=(e,t)=>{const r=[],n=e.date(void 0,"default"),i=e.startOfWeek(n),s=e.endOfWeek(n);let a=i;for(;e.isBefore(a,s);)r.push(a),a=e.addDays(a,1);return r.map((r=>e.formatByString(r,t)))},Gd=(e,t,r,n)=>{switch(r){case"month":return Id(e,e.date(void 0,t)).map((t=>e.formatByString(t,n)));case"weekDay":return Wd(e,n);case"meridiem":{const r=e.date(void 0,t);return[e.startOfDay(r),e.endOfDay(r)].map((t=>e.formatByString(t,n)))}default:return[]}},qd=["0","1","2","3","4","5","6","7","8","9"],Xd=(e,t)=>{if("0"===t[0])return e;const r=[];let n="";for(let i=0;i<e.length;i+=1){n+=e[i];const s=t.indexOf(n);s>-1&&(r.push(s.toString()),n="")}return r.join("")},Yd=(e,t)=>"0"===t[0]?e:e.split("").map((e=>t[Number(e)])).join(""),Kd=(e,t)=>{const r=Xd(e,t);return" "!==r&&!Number.isNaN(Number(r))},Qd=(e,t)=>{let r=e;for(r=Number(r).toString();r.length<t;)r="0".concat(r);return r},Zd=(e,t,r,n,i)=>{if("day"===i.type&&"digit-with-letter"===i.contentType){const n=e.setDate(r.longestMonth,t);return e.formatByString(n,i.format)}let s=t.toString();return i.hasLeadingZerosInInput&&(s=Qd(s,i.maxLength)),Yd(s,n)},Jd=(e,t,r,n,i,s,a,o)=>{const l=(e=>{switch(e){case"ArrowUp":return 1;case"ArrowDown":return-1;case"PageUp":return 5;case"PageDown":return-5;default:return 0}})(n),c="Home"===n,u="End"===n,h=""===r.value||c||u;return"digit"===r.contentType||"digit-with-letter"===r.contentType?(()=>{const n=i[r.type]({currentDate:a,format:r.format,contentType:r.contentType}),d=t=>Zd(e,t,n,s,r),f="minutes"===r.type&&null!==o&&void 0!==o&&o.minutesStep?o.minutesStep:1;let p=parseInt(Xd(r.value,s),10)+l*f;if(h){if("year"===r.type&&!u&&!c)return e.formatByString(e.date(void 0,t),r.format);p=l>0||c?n.minimum:n.maximum}return p%f!==0&&((l<0||c)&&(p+=f-(f+p)%f),(l>0||u)&&(p-=p%f)),p>n.maximum?d(n.minimum+(p-n.maximum-1)%(n.maximum-n.minimum+1)):p<n.minimum?d(n.maximum-(n.minimum-p-1)%(n.maximum-n.minimum+1)):d(p)})():(()=>{const n=Gd(e,t,r.type,r.format);if(0===n.length)return r.value;if(h)return l>0||c?n[0]:n[n.length-1];const i=n.indexOf(r.value);return n[((i+l)%n.length+n.length)%n.length]})()},$d=(e,t,r)=>{let n=e.value||e.placeholder;const i="non-input"===t?e.hasLeadingZerosInFormat:e.hasLeadingZerosInInput;"non-input"===t&&e.hasLeadingZerosInInput&&!e.hasLeadingZerosInFormat&&(n=Number(Xd(n,r)).toString());return["input-rtl","input-ltr"].includes(t)&&"digit"===e.contentType&&!i&&1===n.length&&(n="".concat(n,"\u200e")),"input-rtl"===t&&(n="\u2068".concat(n,"\u2069")),n},ef=(e,t,r,n)=>e.formatByString(e.parse(t,r),n),tf=(e,t)=>4===e.formatByString(e.date(void 0,"system"),t).length,rf=(e,t,r,n)=>{if("digit"!==t)return!1;const i=e.date(void 0,"default");switch(r){case"year":if(tf(e,n)){return"0001"===e.formatByString(e.setYear(i,1),n)}return"01"===e.formatByString(e.setYear(i,2001),n);case"month":return e.formatByString(e.startOfYear(i),n).length>1;case"day":return e.formatByString(e.startOfMonth(i),n).length>1;case"weekDay":return e.formatByString(e.startOfWeek(i),n).length>1;case"hours":return e.formatByString(e.setHours(i,1),n).length>1;case"minutes":return e.formatByString(e.setMinutes(i,1),n).length>1;case"seconds":return e.formatByString(e.setSeconds(i,1),n).length>1;default:throw new Error("Invalid section type")}};const nf=(e,t)=>{0},sf={year:1,month:2,day:3,weekDay:4,hours:5,minutes:6,seconds:7,meridiem:8,empty:9},af=(e,t,r,n,i)=>[...r].sort(((e,t)=>sf[e.type]-sf[t.type])).reduce(((r,n)=>!i||n.modified?((e,t,r,n)=>{switch(t.type){case"year":return e.setYear(n,e.getYear(r));case"month":return e.setMonth(n,e.getMonth(r));case"weekDay":{const n=Wd(e,t.format),i=e.formatByString(r,t.format),s=n.indexOf(i),a=n.indexOf(t.value)-s;return e.addDays(r,a)}case"day":return e.setDate(n,e.getDate(r));case"meridiem":{const t=e.getHours(r)<12,i=e.getHours(n);return t&&i>=12?e.addHours(n,-12):!t&&i<12?e.addHours(n,12):n}case"hours":return e.setHours(n,e.getHours(r));case"minutes":return e.setMinutes(n,e.getMinutes(r));case"seconds":return e.setSeconds(n,e.getSeconds(r));default:return n}})(e,n,t,r):r),n),of=(e,t)=>{if(null==e)return null;if("all"===e)return"all";if("string"===typeof e){const r=t.findIndex((t=>t.type===e));return-1===r?null:r}return e},lf=(e,t)=>{if(e.value)switch(e.type){case"month":{if("digit"===e.contentType)return t.format(t.setMonth(t.date(),Number(e.value)-1),"month");const r=t.parse(e.value,e.format);return r?t.format(r,"month"):void 0}case"day":return"digit"===e.contentType?t.format(t.setDate(t.startOfYear(t.date()),Number(e.value)),"dayOfMonthFull"):e.value;default:return}},cf=(e,t)=>{if(e.value)switch(e.type){case"weekDay":if("letter"===e.contentType)return;return Number(e.value);case"meridiem":{const r=t.parse("01:00 ".concat(e.value),"".concat(t.formats.hours12h,":").concat(t.formats.minutes," ").concat(e.format));return r?t.getHours(r)>=12?1:0:void 0}case"day":return"digit-with-letter"===e.contentType?parseInt(e.value,10):Number(e.value);case"month":{if("digit"===e.contentType)return Number(e.value);const r=t.parse(e.value,e.format);return r?t.getMonth(r)+1:void 0}default:return"letter"!==e.contentType?Number(e.value):void 0}},uf=["value","referenceDate"],hf={emptyValue:null,getTodayValue:Od,getInitialReferenceValue:e=>{let{value:t,referenceDate:r}=e,n=i(e,uf);return null!=t&&n.utils.isValid(t)?t:null!=r?r:Vd(n)},cleanValue:(e,t)=>null!=t&&e.isValid(t)?t:null,areValuesEqual:(e,t,r)=>!e.isValid(t)&&null!=t&&!e.isValid(r)&&null!=r||e.isEqual(t,r),isSameError:(e,t)=>e===t,hasError:e=>null!=e,defaultErrorState:null,getTimezone:(e,t)=>null!=t&&e.isValid(t)?e.getTimezone(t):null,setTimezone:(e,t,r)=>null==r?null:e.setTimezone(r,t)},df={updateReferenceValue:(e,t,r)=>null!=t&&e.isValid(t)?t:r,getSectionsFromValue:(e,t,r,n)=>!e.isValid(t)&&!!r?r:n(t),getV7HiddenInputValueFromSections:e=>e.map((e=>"".concat(e.startSeparator).concat(e.value||e.placeholder).concat(e.endSeparator))).join(""),getV6InputValueFromSections:(e,t,r)=>{const n=e.map((e=>{const n=$d(e,r?"input-rtl":"input-ltr",t);return"".concat(e.startSeparator).concat(n).concat(e.endSeparator)})).join("");return r?"\u2066".concat(n,"\u2069"):n},getActiveDateManager:(e,t)=>({date:t.value,referenceDate:t.referenceValue,getSections:e=>e,getNewValuesFromNewActiveDate:r=>({value:r,referenceValue:null!=r&&e.isValid(r)?r:t.referenceValue})}),parseValueStr:(e,t,r)=>r(e.trim(),t)},ff=e=>{const{utils:t,formatKey:r,contextTranslation:n,propsTranslation:i}=e;return e=>{const s=null!==e&&t.isValid(e)?t.format(e,r):null;return(null!==i&&void 0!==i?i:n)(e,t,s)}},pf={previousMonth:"Previous month",nextMonth:"Next month",openPreviousView:"Open previous view",openNextView:"Open next view",calendarViewSwitchingButtonAriaLabel:e=>"year"===e?"year view is open, switch to calendar view":"calendar view is open, switch to year view",start:"Start",end:"End",startDate:"Start date",startTime:"Start time",endDate:"End date",endTime:"End time",cancelButtonLabel:"Cancel",clearButtonLabel:"Clear",okButtonLabel:"OK",todayButtonLabel:"Today",datePickerToolbarTitle:"Select date",dateTimePickerToolbarTitle:"Select date & time",timePickerToolbarTitle:"Select time",dateRangePickerToolbarTitle:"Select date range",clockLabelText:(e,t,r,n)=>"Select ".concat(e,". ").concat(n||null!==t&&r.isValid(t)?"Selected time is ".concat(null!==n&&void 0!==n?n:r.format(t,"fullTime")):"No time selected"),hoursClockNumberText:e=>"".concat(e," hours"),minutesClockNumberText:e=>"".concat(e," minutes"),secondsClockNumberText:e=>"".concat(e," seconds"),selectViewText:e=>"Select ".concat(e),calendarWeekNumberHeaderLabel:"Week number",calendarWeekNumberHeaderText:"#",calendarWeekNumberAriaLabelText:e=>"Week ".concat(e),calendarWeekNumberText:e=>"".concat(e),openDatePickerDialogue:(e,t,r)=>r||null!==e&&t.isValid(e)?"Choose date, selected date is ".concat(null!==r&&void 0!==r?r:t.format(e,"fullDate")):"Choose date",openTimePickerDialogue:(e,t,r)=>r||null!==e&&t.isValid(e)?"Choose time, selected time is ".concat(null!==r&&void 0!==r?r:t.format(e,"fullTime")):"Choose time",fieldClearLabel:"Clear",timeTableLabel:"pick time",dateTableLabel:"pick date",fieldYearPlaceholder:e=>"Y".repeat(e.digitAmount),fieldMonthPlaceholder:e=>"letter"===e.contentType?"MMMM":"MM",fieldDayPlaceholder:()=>"DD",fieldWeekDayPlaceholder:e=>"letter"===e.contentType?"EEEE":"EE",fieldHoursPlaceholder:()=>"hh",fieldMinutesPlaceholder:()=>"mm",fieldSecondsPlaceholder:()=>"ss",fieldMeridiemPlaceholder:()=>"aa",year:"Year",month:"Month",day:"Day",weekDay:"Week day",hours:"Hours",minutes:"Minutes",seconds:"Seconds",meridiem:"Meridiem",empty:"Empty"},mf=pf;ha({},pf);const gf=()=>{const t=e.useContext(yd);if(null===t)throw new Error(["MUI X: Can not find the date and time pickers localization context.","It looks like you forgot to wrap your component in LocalizationProvider.","This can also happen if you are bundling multiple versions of the `@mui/x-date-pickers` package"].join("\n"));if(null===t.utils)throw new Error(["MUI X: Can not find the date and time pickers adapter from its localization context.","It looks like you forgot to pass a `dateAdapter` to your LocalizationProvider."].join("\n"));const r=e.useMemo((()=>ha({},mf,t.localeText)),[t.localeText]);return e.useMemo((()=>ha({},t,{localeText:r})),[t,r])},vf=()=>gf().utils,yf=()=>gf().defaultDates,bf=t=>{const r=vf(),n=e.useRef();return void 0===n.current&&(n.current=r.date(void 0,t)),n.current};function wf(e){return ka("MuiPickersToolbar",e)}Da("MuiPickersToolbar",["root","content"]);const xf=["children","className","toolbarTitle","hidden","titleId","isLandscape","classes","landscapeDirection"],Sf=eo("div",{name:"MuiPickersToolbar",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{let{theme:t}=e;return{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",padding:t.spacing(2,3),variants:[{props:{isLandscape:!0},style:{height:"auto",maxWidth:160,padding:16,justifyContent:"flex-start",flexWrap:"wrap"}}]}})),_f=eo("div",{name:"MuiPickersToolbar",slot:"Content",overridesResolver:(e,t)=>t.content})({display:"flex",flexWrap:"wrap",width:"100%",flex:1,justifyContent:"space-between",alignItems:"center",flexDirection:"row",variants:[{props:{isLandscape:!0},style:{justifyContent:"flex-start",alignItems:"flex-start",flexDirection:"column"}},{props:{isLandscape:!0,landscapeDirection:"row"},style:{flexDirection:"row"}}]}),Cf=e.forwardRef((function(e,t){const r=gd({props:e,name:"MuiPickersToolbar"}),{children:n,className:s,toolbarTitle:a,hidden:o,titleId:l}=r,c=i(r,xf),u=r,h=(e=>{const{classes:t}=e;return Na({root:["root"],content:["content"]},wf,t)})(u);return o?null:(0,bt.jsxs)(Sf,ha({ref:t,className:ua(h.root,s),ownerState:u},c,{children:[(0,bt.jsx)(go,{color:"text.secondary",variant:"overline",id:l,children:a}),(0,bt.jsx)(_f,{className:h.content,ownerState:u,children:n})]}))})),Ef=()=>gf().localeText;function Af(e){return ka("MuiDatePickerToolbar",e)}Da("MuiDatePickerToolbar",["root","title"]);const Mf=["value","isLandscape","onChange","toolbarFormat","toolbarPlaceholder","views","className","onViewChange","view"],Tf=eo(Cf,{name:"MuiDatePickerToolbar",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Pf=eo(go,{name:"MuiDatePickerToolbar",slot:"Title",overridesResolver:(e,t)=>t.title})({variants:[{props:{isLandscape:!0},style:{margin:"auto 16px auto auto"}}]}),kf=e.forwardRef((function(t,r){const n=gd({props:t,name:"MuiDatePickerToolbar"}),{value:s,isLandscape:a,toolbarFormat:o,toolbarPlaceholder:l="\u2013\u2013",views:c,className:u}=n,h=i(n,Mf),d=vf(),f=Ef(),p=(e=>{const{classes:t}=e;return Na({root:["root"],title:["title"]},Af,t)})(n),m=e.useMemo((()=>{if(!s)return l;const e=Nd(d,{format:o,views:c},!0);return d.formatByString(s,e)}),[s,o,l,d,c]),g=n;return(0,bt.jsx)(Tf,ha({ref:r,toolbarTitle:f.datePickerToolbarTitle,isLandscape:a,className:ua(p.root,u)},h,{children:(0,bt.jsx)(Pf,{variant:"h4",align:a?"left":"center",ownerState:g,className:p.title,children:m})}))}));function Df(t,r){var n,i;const s=vf(),a=yf(),o=gd({props:t,name:r}),l=e.useMemo((()=>{var e;return null==(null===(e=o.localeText)||void 0===e?void 0:e.toolbarTitle)?o.localeText:ha({},o.localeText,{datePickerToolbarTitle:o.localeText.toolbarTitle})}),[o.localeText]);return ha({},o,{localeText:l},(e=>{let{openTo:t,defaultOpenTo:r,views:n,defaultViews:i}=e;const s=null!==n&&void 0!==n?n:i;let a;if(null!=t)a=t;else if(s.includes(r))a=r;else{if(!(s.length>0))throw new Error("MUI X: The `views` prop must contain at least one view.");a=s[0]}return{views:s,openTo:a}})({views:o.views,openTo:o.openTo,defaultViews:["year","day"],defaultOpenTo:"day"}),{disableFuture:null!==(n=o.disableFuture)&&void 0!==n&&n,disablePast:null!==(i=o.disablePast)&&void 0!==i&&i,minDate:Dd(s,o.minDate,a.minDate),maxDate:Dd(s,o.maxDate,a.maxDate),slots:ha({toolbar:kf},o.slots)})}const If=["disablePast","disableFuture","minDate","maxDate","shouldDisableDate","shouldDisableMonth","shouldDisableYear"],Of=["disablePast","disableFuture","minTime","maxTime","shouldDisableTime","minutesStep","ampm","disableIgnoringDatePartForTimeValidation"],Rf=["minDateTime","maxDateTime"],Lf=[...If,...Of,...Rf],Nf=e=>Lf.reduce(((t,r)=>(e.hasOwnProperty(r)&&(t[r]=e[r]),t)),{}),Bf=e=>{let{props:t,value:r,timezone:n,adapter:i}=e;if(null===r)return null;const{shouldDisableDate:s,shouldDisableMonth:a,shouldDisableYear:o,disablePast:l,disableFuture:c}=t,u=i.utils.date(void 0,n),h=Dd(i.utils,t.minDate,i.defaultDates.minDate),d=Dd(i.utils,t.maxDate,i.defaultDates.maxDate);switch(!0){case!i.utils.isValid(r):return"invalidDate";case Boolean(s&&s(r)):return"shouldDisableDate";case Boolean(a&&a(r)):return"shouldDisableMonth";case Boolean(o&&o(r)):return"shouldDisableYear";case Boolean(c&&i.utils.isAfterDay(r,u)):return"disableFuture";case Boolean(l&&i.utils.isBeforeDay(r,u)):return"disablePast";case Boolean(h&&i.utils.isBeforeDay(r,h)):return"minDate";case Boolean(d&&i.utils.isAfterDay(r,d)):return"maxDate";default:return null}};function zf(e){return ka("MuiInputAdornment",e)}Bf.valueManager=hf;const Ff=Da("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]),jf=["children","className","component","disablePointerEvents","disableTypography","position","variant"];var Uf;const Vf=eo("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t["position".concat(io(r.position))],!0===r.disablePointerEvents&&t.disablePointerEvents,t[r.variant]]}})(ro((e=>{let{theme:t}=e;return{display:"flex",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(t.vars||t).palette.action.active,variants:[{props:{variant:"filled"},style:{["&.".concat(Ff.positionStart,"&:not(.").concat(Ff.hiddenLabel,")")]:{marginTop:16}}},{props:{position:"start"},style:{marginRight:8}},{props:{position:"end"},style:{marginLeft:8}},{props:{disablePointerEvents:!0},style:{pointerEvents:"none"}}]}}))),Hf=e.forwardRef((function(t,r){const n=no({props:t,name:"MuiInputAdornment"}),{children:i,className:a,component:o="div",disablePointerEvents:l=!1,disableTypography:c=!1,position:h,variant:d}=n,f=s(n,jf),p=Ro()||{};let m=d;d&&p.variant,p&&!m&&(m=p.variant);const g=u(u({},n),{},{hiddenLabel:p.hiddenLabel,size:p.size,disablePointerEvents:l,position:h,variant:m}),v=(e=>{const{classes:t,disablePointerEvents:r,hiddenLabel:n,position:i,size:s,variant:a}=e;return Na({root:["root",r&&"disablePointerEvents",i&&"position".concat(io(i)),a,n&&"hiddenLabel",s&&"size".concat(io(s))]},zf,t)})(g);return(0,bt.jsx)(Oo.Provider,{value:null,children:(0,bt.jsx)(Vf,u(u({as:o,ownerState:g,className:ua(v.root,a),ref:r},f),{},{children:"string"!==typeof i||c?(0,bt.jsxs)(e.Fragment,{children:["start"===h?Uf||(Uf=(0,bt.jsx)("span",{className:"notranslate","aria-hidden":!0,children:"\u200b"})):null,i]}):(0,bt.jsx)(go,{color:"textSecondary",children:i})}))})})),Wf=Hf;function Gf(e){try{return e.matches(":focus-visible")}catch(t){0}return!1}const qf=uu;class Xf{static create(){return new Xf}static use(){const t=bc(Xf.create).current,[r,n]=e.useState(!1);return t.shouldMount=r,t.setShouldMount=n,e.useEffect(t.mountEffect,[r]),t}constructor(){l(this,"mountEffect",(()=>{this.shouldMount&&!this.didMount&&null!==this.ref.current&&(this.didMount=!0,this.mounted.resolve())})),this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}mount(){return this.mounted||(this.mounted=function(){let e,t;const r=new Promise(((r,n)=>{e=r,t=n}));return r.resolve=e,r.reject=t,r}(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.mount().then((()=>{var e;return null===(e=this.ref.current)||void 0===e?void 0:e.start(...t)}))}stop(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.mount().then((()=>{var e;return null===(e=this.ref.current)||void 0===e?void 0:e.stop(...t)}))}pulsate(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.mount().then((()=>{var e;return null===(e=this.ref.current)||void 0===e?void 0:e.pulsate(...t)}))}}function Yf(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Kf(t,r){var n=Object.create(null);return t&&e.Children.map(t,(function(e){return e})).forEach((function(t){n[t.key]=function(t){return r&&(0,e.isValidElement)(t)?r(t):t}(t)})),n}function Qf(e,t,r){return null!=r[t]?r[t]:e.props[t]}function Zf(t,r,n){var i=Kf(t.children),s=function(e,t){function r(r){return r in t?t[r]:e[r]}e=e||{},t=t||{};var n,i=Object.create(null),s=[];for(var a in e)a in t?s.length&&(i[a]=s,s=[]):s.push(a);var o={};for(var l in t){if(i[l])for(n=0;n<i[l].length;n++){var c=i[l][n];o[i[l][n]]=r(c)}o[l]=r(l)}for(n=0;n<s.length;n++)o[s[n]]=r(s[n]);return o}(r,i);return Object.keys(s).forEach((function(a){var o=s[a];if((0,e.isValidElement)(o)){var l=a in r,c=a in i,u=r[a],h=(0,e.isValidElement)(u)&&!u.props.in;!c||l&&!h?c||!l||h?c&&l&&(0,e.isValidElement)(u)&&(s[a]=(0,e.cloneElement)(o,{onExited:n.bind(null,o),in:u.props.in,exit:Qf(o,"exit",t),enter:Qf(o,"enter",t)})):s[a]=(0,e.cloneElement)(o,{in:!1}):s[a]=(0,e.cloneElement)(o,{onExited:n.bind(null,o),in:!0,exit:Qf(o,"exit",t),enter:Qf(o,"enter",t)})}})),s}var Jf=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},$f=function(t){function r(e,r){var n,i=(n=t.call(this,e,r)||this).handleExited.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n));return n.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},n}Cc(r,t);var n=r.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},r.getDerivedStateFromProps=function(t,r){var n,i,s=r.children,a=r.handleExited;return{children:r.firstRender?(n=t,i=a,Kf(n.children,(function(t){return(0,e.cloneElement)(t,{onExited:i.bind(null,t),in:!0,appear:Qf(t,"appear",n),enter:Qf(t,"enter",n),exit:Qf(t,"exit",n)})}))):Zf(t,s,a),firstRender:!1}},n.handleExited=function(e,t){var r=Kf(this.props.children);e.key in r||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var r=ha({},t.children);return delete r[e.key],{children:r}})))},n.render=function(){var t=this.props,r=t.component,n=t.childFactory,s=i(t,["component","childFactory"]),a=this.state.contextValue,o=Jf(this.state.children).map(n);return delete s.appear,delete s.enter,delete s.exit,null===r?e.createElement(Mc.Provider,{value:a},o):e.createElement(Mc.Provider,{value:a},e.createElement(r,s,o))},r}(e.Component);$f.propTypes={},$f.defaultProps={component:"div",childFactory:function(e){return e}};const ep=$f;const tp=function(t){const{className:r,classes:n,pulsate:i=!1,rippleX:s,rippleY:a,rippleSize:o,in:l,onExited:c,timeout:u}=t,[h,d]=e.useState(!1),f=ua(r,n.ripple,n.rippleVisible,i&&n.ripplePulsate),p={width:o,height:o,top:-o/2+a,left:-o/2+s},m=ua(n.child,h&&n.childLeaving,i&&n.childPulsate);return l||h||d(!0),e.useEffect((()=>{if(!l&&null!=c){const e=setTimeout(c,u);return()=>{clearTimeout(e)}}}),[c,l,u]),(0,bt.jsx)("span",{className:f,style:p,children:(0,bt.jsx)("span",{className:m})})};const rp=Da("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),np=["center","classes","className"];var ip,sp,ap,op;const lp=Xs(ip||(ip=Yf(["\n  0% {\n    transform: scale(0);\n    opacity: 0.1;\n  }\n\n  100% {\n    transform: scale(1);\n    opacity: 0.3;\n  }\n"]))),cp=Xs(sp||(sp=Yf(["\n  0% {\n    opacity: 1;\n  }\n\n  100% {\n    opacity: 0;\n  }\n"]))),up=Xs(ap||(ap=Yf(["\n  0% {\n    transform: scale(1);\n  }\n\n  50% {\n    transform: scale(0.92);\n  }\n\n  100% {\n    transform: scale(1);\n  }\n"]))),hp=eo("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),dp=eo(tp,{name:"MuiTouchRipple",slot:"Ripple"})(op||(op=Yf(["\n  opacity: 0;\n  position: absolute;\n\n  &."," {\n    opacity: 0.3;\n    transform: scale(1);\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  &."," {\n    animation-duration: ","ms;\n  }\n\n  & ."," {\n    opacity: 1;\n    display: block;\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    background-color: currentColor;\n  }\n\n  & ."," {\n    opacity: 0;\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  & ."," {\n    position: absolute;\n    /* @noflip */\n    left: 0px;\n    top: 0;\n    animation-name: ",";\n    animation-duration: 2500ms;\n    animation-timing-function: ",";\n    animation-iteration-count: infinite;\n    animation-delay: 200ms;\n  }\n"])),rp.rippleVisible,lp,550,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut}),rp.ripplePulsate,(e=>{let{theme:t}=e;return t.transitions.duration.shorter}),rp.child,rp.childLeaving,cp,550,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut}),rp.childPulsate,up,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut})),fp=e.forwardRef((function(t,r){const n=no({props:t,name:"MuiTouchRipple"}),{center:i=!1,classes:a={},className:o}=n,l=s(n,np),[c,h]=e.useState([]),d=e.useRef(0),f=e.useRef(null);e.useEffect((()=>{f.current&&(f.current(),f.current=null)}),[c]);const p=e.useRef(!1),m=Sc(),g=e.useRef(null),v=e.useRef(null),y=e.useCallback((e=>{const{pulsate:t,rippleX:r,rippleY:n,rippleSize:i,cb:s}=e;h((e=>[...e,(0,bt.jsx)(dp,{classes:{ripple:ua(a.ripple,rp.ripple),rippleVisible:ua(a.rippleVisible,rp.rippleVisible),ripplePulsate:ua(a.ripplePulsate,rp.ripplePulsate),child:ua(a.child,rp.child),childLeaving:ua(a.childLeaving,rp.childLeaving),childPulsate:ua(a.childPulsate,rp.childPulsate)},timeout:550,pulsate:t,rippleX:r,rippleY:n,rippleSize:i},d.current)])),d.current+=1,f.current=s}),[a]),b=e.useCallback((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};const{pulsate:n=!1,center:s=i||t.pulsate,fakeElement:a=!1}=t;if("mousedown"===(null===e||void 0===e?void 0:e.type)&&p.current)return void(p.current=!1);"touchstart"===(null===e||void 0===e?void 0:e.type)&&(p.current=!0);const o=a?null:v.current,l=o?o.getBoundingClientRect():{width:0,height:0,left:0,top:0};let c,u,h;if(s||void 0===e||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)c=Math.round(l.width/2),u=Math.round(l.height/2);else{const{clientX:t,clientY:r}=e.touches&&e.touches.length>0?e.touches[0]:e;c=Math.round(t-l.left),u=Math.round(r-l.top)}if(s)h=Math.sqrt((2*l.width**2+l.height**2)/3),h%2===0&&(h+=1);else{const e=2*Math.max(Math.abs((o?o.clientWidth:0)-c),c)+2,t=2*Math.max(Math.abs((o?o.clientHeight:0)-u),u)+2;h=Math.sqrt(e**2+t**2)}null!==e&&void 0!==e&&e.touches?null===g.current&&(g.current=()=>{y({pulsate:n,rippleX:c,rippleY:u,rippleSize:h,cb:r})},m.start(80,(()=>{g.current&&(g.current(),g.current=null)}))):y({pulsate:n,rippleX:c,rippleY:u,rippleSize:h,cb:r})}),[i,y,m]),w=e.useCallback((()=>{b({},{pulsate:!0})}),[b]),x=e.useCallback(((e,t)=>{if(m.clear(),"touchend"===(null===e||void 0===e?void 0:e.type)&&g.current)return g.current(),g.current=null,void m.start(0,(()=>{x(e,t)}));g.current=null,h((e=>e.length>0?e.slice(1):e)),f.current=t}),[m]);return e.useImperativeHandle(r,(()=>({pulsate:w,start:b,stop:x})),[w,b,x]),(0,bt.jsx)(hp,u(u({className:ua(rp.root,a.root,o),ref:v},l),{},{children:(0,bt.jsx)(ep,{component:null,exit:!0,children:c})}))})),pp=fp;function mp(e){return ka("MuiButtonBase",e)}const gp=Da("MuiButtonBase",["root","disabled","focusVisible"]),vp=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],yp=eo("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},["&.".concat(gp.disabled)]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}});function bp(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return qf((i=>(r&&r(i),n||e[t](i),!0)))}const wp=e.forwardRef((function(t,r){const n=no({props:t,name:"MuiButtonBase"}),{action:i,centerRipple:a=!1,children:o,className:l,component:c="button",disabled:h=!1,disableRipple:d=!1,disableTouchRipple:f=!1,focusRipple:p=!1,focusVisibleClassName:m,LinkComponent:g="a",onBlur:v,onClick:y,onContextMenu:b,onDragLeave:w,onFocus:x,onFocusVisible:S,onKeyDown:_,onKeyUp:C,onMouseDown:E,onMouseLeave:A,onMouseUp:M,onTouchEnd:T,onTouchMove:P,onTouchStart:k,tabIndex:D=0,TouchRippleProps:I,touchRippleRef:O,type:R}=n,L=s(n,vp),N=e.useRef(null),B=Xf.use(),z=Lo(B.ref,O),[F,j]=e.useState(!1);h&&F&&j(!1),e.useImperativeHandle(i,(()=>({focusVisible:()=>{j(!0),N.current.focus()}})),[]);const U=B.shouldMount&&!d&&!h;e.useEffect((()=>{F&&p&&!d&&B.pulsate()}),[d,p,F,B]);const V=bp(B,"start",E,f),H=bp(B,"stop",b,f),W=bp(B,"stop",w,f),G=bp(B,"stop",M,f),q=bp(B,"stop",(e=>{F&&e.preventDefault(),A&&A(e)}),f),X=bp(B,"start",k,f),Y=bp(B,"stop",T,f),K=bp(B,"stop",P,f),Q=bp(B,"stop",(e=>{Gf(e.target)||j(!1),v&&v(e)}),!1),Z=qf((e=>{N.current||(N.current=e.currentTarget),Gf(e.target)&&(j(!0),S&&S(e)),x&&x(e)})),J=()=>{const e=N.current;return c&&"button"!==c&&!("A"===e.tagName&&e.href)},$=qf((e=>{p&&!e.repeat&&F&&" "===e.key&&B.stop(e,(()=>{B.start(e)})),e.target===e.currentTarget&&J()&&" "===e.key&&e.preventDefault(),_&&_(e),e.target===e.currentTarget&&J()&&"Enter"===e.key&&!h&&(e.preventDefault(),y&&y(e))})),ee=qf((e=>{p&&" "===e.key&&F&&!e.defaultPrevented&&B.stop(e,(()=>{B.pulsate(e)})),C&&C(e),y&&e.target===e.currentTarget&&J()&&" "===e.key&&!e.defaultPrevented&&y(e)}));let te=c;"button"===te&&(L.href||L.to)&&(te=g);const re={};"button"===te?(re.type=void 0===R?"button":R,re.disabled=h):(L.href||L.to||(re.role="button"),h&&(re["aria-disabled"]=h));const ne=Lo(r,N),ie=u(u({},n),{},{centerRipple:a,component:c,disabled:h,disableRipple:d,disableTouchRipple:f,focusRipple:p,tabIndex:D,focusVisible:F}),se=(e=>{const{disabled:t,focusVisible:r,focusVisibleClassName:n,classes:i}=e,s=Na({root:["root",t&&"disabled",r&&"focusVisible"]},mp,i);return r&&n&&(s.root+=" ".concat(n)),s})(ie);return(0,bt.jsxs)(yp,u(u(u({as:te,className:ua(se.root,l),ownerState:ie,onBlur:Q,onClick:y,onContextMenu:H,onFocus:Z,onKeyDown:$,onKeyUp:ee,onMouseDown:V,onMouseLeave:q,onMouseUp:G,onDragLeave:W,onTouchEnd:Y,onTouchMove:K,onTouchStart:X,ref:ne,tabIndex:h?-1:D,type:R},re),L),{},{children:[o,U?(0,bt.jsx)(pp,u({ref:z,center:a},I)):null]}))}));function xp(e){return ka("MuiIconButton",e)}const Sp=Da("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),_p=["edge","children","className","color","disabled","disableFocusRipple","size"],Cp=eo(wp,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,"default"!==r.color&&t["color".concat(io(r.color))],r.edge&&t["edge".concat(io(r.edge))],t["size".concat(io(r.size))]]}})(ro((e=>{let{theme:t}=e;return{textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),variants:[{props:e=>!e.disableRipple,style:{"--IconButton-hoverBg":t.vars?"rgba(".concat(t.vars.palette.action.activeChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):Dt(t.palette.action.active,t.palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]}})),ro((e=>{let{theme:t}=e;return{variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(t.palette).filter(so()).map((e=>{let[r]=e;return{props:{color:r},style:{color:(t.vars||t).palette[r].main}}})),...Object.entries(t.palette).filter(so()).map((e=>{let[r]=e;return{props:{color:r},style:{"--IconButton-hoverBg":t.vars?"rgba(".concat((t.vars||t).palette[r].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):Dt((t.vars||t).palette[r].main,t.palette.action.hoverOpacity)}}})),{props:{size:"small"},style:{padding:5,fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:t.typography.pxToRem(28)}}],["&.".concat(Sp.disabled)]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled}}}))),Ep=e.forwardRef((function(e,t){const r=no({props:e,name:"MuiIconButton"}),{edge:n=!1,children:i,className:a,color:o="default",disabled:l=!1,disableFocusRipple:c=!1,size:h="medium"}=r,d=s(r,_p),f=u(u({},r),{},{edge:n,color:o,disabled:l,disableFocusRipple:c,size:h}),p=(e=>{const{classes:t,disabled:r,color:n,edge:i,size:s}=e;return Na({root:["root",r&&"disabled","default"!==n&&"color".concat(io(n)),i&&"edge".concat(io(i)),"size".concat(io(s))]},xp,t)})(f);return(0,bt.jsx)(Cp,u(u({className:ua(p.root,a),centerRipple:!0,focusRipple:!c,disabled:l,ref:t},d),{},{ownerState:f,children:i}))})),Ap=Ep;function Mp(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Tp(e){return e instanceof Mp(e).Element||e instanceof Element}function Pp(e){return e instanceof Mp(e).HTMLElement||e instanceof HTMLElement}function kp(e){return"undefined"!==typeof ShadowRoot&&(e instanceof Mp(e).ShadowRoot||e instanceof ShadowRoot)}var Dp=Math.max,Ip=Math.min,Op=Math.round;function Rp(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function Lp(){return!/^((?!chrome|android).)*safari/i.test(Rp())}function Np(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!1);var n=e.getBoundingClientRect(),i=1,s=1;t&&Pp(e)&&(i=e.offsetWidth>0&&Op(n.width)/e.offsetWidth||1,s=e.offsetHeight>0&&Op(n.height)/e.offsetHeight||1);var a=(Tp(e)?Mp(e):window).visualViewport,o=!Lp()&&r,l=(n.left+(o&&a?a.offsetLeft:0))/i,c=(n.top+(o&&a?a.offsetTop:0))/s,u=n.width/i,h=n.height/s;return{width:u,height:h,top:c,right:l+u,bottom:c+h,left:l,x:l,y:c}}function Bp(e){var t=Mp(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function zp(e){return e?(e.nodeName||"").toLowerCase():null}function Fp(e){return((Tp(e)?e.ownerDocument:e.document)||window.document).documentElement}function jp(e){return Np(Fp(e)).left+Bp(e).scrollLeft}function Up(e){return Mp(e).getComputedStyle(e)}function Vp(e){var t=Up(e),r=t.overflow,n=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function Hp(e,t,r){void 0===r&&(r=!1);var n=Pp(t),i=Pp(t)&&function(e){var t=e.getBoundingClientRect(),r=Op(t.width)/e.offsetWidth||1,n=Op(t.height)/e.offsetHeight||1;return 1!==r||1!==n}(t),s=Fp(t),a=Np(e,i,r),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(n||!n&&!r)&&(("body"!==zp(t)||Vp(s))&&(o=function(e){return e!==Mp(e)&&Pp(e)?{scrollLeft:(t=e).scrollLeft,scrollTop:t.scrollTop}:Bp(e);var t}(t)),Pp(t)?((l=Np(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):s&&(l.x=jp(s))),{x:a.left+o.scrollLeft-l.x,y:a.top+o.scrollTop-l.y,width:a.width,height:a.height}}function Wp(e){var t=Np(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function Gp(e){return"html"===zp(e)?e:e.assignedSlot||e.parentNode||(kp(e)?e.host:null)||Fp(e)}function qp(e){return["html","body","#document"].indexOf(zp(e))>=0?e.ownerDocument.body:Pp(e)&&Vp(e)?e:qp(Gp(e))}function Xp(e,t){var r;void 0===t&&(t=[]);var n=qp(e),i=n===(null==(r=e.ownerDocument)?void 0:r.body),s=Mp(n),a=i?[s].concat(s.visualViewport||[],Vp(n)?n:[]):n,o=t.concat(a);return i?o:o.concat(Xp(Gp(a)))}function Yp(e){return["table","td","th"].indexOf(zp(e))>=0}function Kp(e){return Pp(e)&&"fixed"!==Up(e).position?e.offsetParent:null}function Qp(e){for(var t=Mp(e),r=Kp(e);r&&Yp(r)&&"static"===Up(r).position;)r=Kp(r);return r&&("html"===zp(r)||"body"===zp(r)&&"static"===Up(r).position)?t:r||function(e){var t=/firefox/i.test(Rp());if(/Trident/i.test(Rp())&&Pp(e)&&"fixed"===Up(e).position)return null;var r=Gp(e);for(kp(r)&&(r=r.host);Pp(r)&&["html","body"].indexOf(zp(r))<0;){var n=Up(r);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||t&&"filter"===n.willChange||t&&n.filter&&"none"!==n.filter)return r;r=r.parentNode}return null}(e)||t}var Zp="top",Jp="bottom",$p="right",em="left",tm="auto",rm=[Zp,Jp,$p,em],nm="start",im="end",sm="viewport",am="popper",om=rm.reduce((function(e,t){return e.concat([t+"-"+nm,t+"-"+im])}),[]),lm=[].concat(rm,[tm]).reduce((function(e,t){return e.concat([t,t+"-"+nm,t+"-"+im])}),[]),cm=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function um(e){var t=new Map,r=new Set,n=[];function i(e){r.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!r.has(e)){var n=t.get(e);n&&i(n)}})),n.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){r.has(e.name)||i(e)})),n}function hm(e){var t;return function(){return t||(t=new Promise((function(r){Promise.resolve().then((function(){t=void 0,r(e())}))}))),t}}var dm={placement:"bottom",modifiers:[],strategy:"absolute"};function fm(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some((function(e){return!(e&&"function"===typeof e.getBoundingClientRect)}))}function pm(e){void 0===e&&(e={});var t=e,r=t.defaultModifiers,n=void 0===r?[]:r,i=t.defaultOptions,s=void 0===i?dm:i;return function(e,t,r){void 0===r&&(r=s);var i={placement:"bottom",orderedModifiers:[],options:Object.assign({},dm,s),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},a=[],o=!1,l={state:i,setOptions:function(r){var o="function"===typeof r?r(i.options):r;c(),i.options=Object.assign({},s,i.options,o),i.scrollParents={reference:Tp(e)?Xp(e):e.contextElement?Xp(e.contextElement):[],popper:Xp(t)};var u=function(e){var t=um(e);return cm.reduce((function(e,r){return e.concat(t.filter((function(e){return e.phase===r})))}),[])}(function(e){var t=e.reduce((function(e,t){var r=e[t.name];return e[t.name]=r?Object.assign({},r,t,{options:Object.assign({},r.options,t.options),data:Object.assign({},r.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}([].concat(n,i.options.modifiers)));return i.orderedModifiers=u.filter((function(e){return e.enabled})),i.orderedModifiers.forEach((function(e){var t=e.name,r=e.options,n=void 0===r?{}:r,s=e.effect;if("function"===typeof s){var o=s({state:i,name:t,instance:l,options:n}),c=function(){};a.push(o||c)}})),l.update()},forceUpdate:function(){if(!o){var e=i.elements,t=e.reference,r=e.popper;if(fm(t,r)){i.rects={reference:Hp(t,Qp(r),"fixed"===i.options.strategy),popper:Wp(r)},i.reset=!1,i.placement=i.options.placement,i.orderedModifiers.forEach((function(e){return i.modifiersData[e.name]=Object.assign({},e.data)}));for(var n=0;n<i.orderedModifiers.length;n++)if(!0!==i.reset){var s=i.orderedModifiers[n],a=s.fn,c=s.options,u=void 0===c?{}:c,h=s.name;"function"===typeof a&&(i=a({state:i,options:u,name:h,instance:l})||i)}else i.reset=!1,n=-1}}},update:hm((function(){return new Promise((function(e){l.forceUpdate(),e(i)}))})),destroy:function(){c(),o=!0}};if(!fm(e,t))return l;function c(){a.forEach((function(e){return e()})),a=[]}return l.setOptions(r).then((function(e){!o&&r.onFirstUpdate&&r.onFirstUpdate(e)})),l}}var mm={passive:!0};function gm(e){return e.split("-")[0]}function vm(e){return e.split("-")[1]}function ym(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function bm(e){var t,r=e.reference,n=e.element,i=e.placement,s=i?gm(i):null,a=i?vm(i):null,o=r.x+r.width/2-n.width/2,l=r.y+r.height/2-n.height/2;switch(s){case Zp:t={x:o,y:r.y-n.height};break;case Jp:t={x:o,y:r.y+r.height};break;case $p:t={x:r.x+r.width,y:l};break;case em:t={x:r.x-n.width,y:l};break;default:t={x:r.x,y:r.y}}var c=s?ym(s):null;if(null!=c){var u="y"===c?"height":"width";switch(a){case nm:t[c]=t[c]-(r[u]/2-n[u]/2);break;case im:t[c]=t[c]+(r[u]/2-n[u]/2)}}return t}var wm={top:"auto",right:"auto",bottom:"auto",left:"auto"};function xm(e){var t,r=e.popper,n=e.popperRect,i=e.placement,s=e.variation,a=e.offsets,o=e.position,l=e.gpuAcceleration,c=e.adaptive,u=e.roundOffsets,h=e.isFixed,d=a.x,f=void 0===d?0:d,p=a.y,m=void 0===p?0:p,g="function"===typeof u?u({x:f,y:m}):{x:f,y:m};f=g.x,m=g.y;var v=a.hasOwnProperty("x"),y=a.hasOwnProperty("y"),b=em,w=Zp,x=window;if(c){var S=Qp(r),_="clientHeight",C="clientWidth";if(S===Mp(r)&&"static"!==Up(S=Fp(r)).position&&"absolute"===o&&(_="scrollHeight",C="scrollWidth"),i===Zp||(i===em||i===$p)&&s===im)w=Jp,m-=(h&&S===x&&x.visualViewport?x.visualViewport.height:S[_])-n.height,m*=l?1:-1;if(i===em||(i===Zp||i===Jp)&&s===im)b=$p,f-=(h&&S===x&&x.visualViewport?x.visualViewport.width:S[C])-n.width,f*=l?1:-1}var E,A=Object.assign({position:o},c&&wm),M=!0===u?function(e,t){var r=e.x,n=e.y,i=t.devicePixelRatio||1;return{x:Op(r*i)/i||0,y:Op(n*i)/i||0}}({x:f,y:m},Mp(r)):{x:f,y:m};return f=M.x,m=M.y,l?Object.assign({},A,((E={})[w]=y?"0":"",E[b]=v?"0":"",E.transform=(x.devicePixelRatio||1)<=1?"translate("+f+"px, "+m+"px)":"translate3d("+f+"px, "+m+"px, 0)",E)):Object.assign({},A,((t={})[w]=y?m+"px":"",t[b]=v?f+"px":"",t.transform="",t))}const Sm={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var r=t.styles[e]||{},n=t.attributes[e]||{},i=t.elements[e];Pp(i)&&zp(i)&&(Object.assign(i.style,r),Object.keys(n).forEach((function(e){var t=n[e];!1===t?i.removeAttribute(e):i.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach((function(e){var n=t.elements[e],i=t.attributes[e]||{},s=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:r[e]).reduce((function(e,t){return e[t]="",e}),{});Pp(n)&&zp(n)&&(Object.assign(n.style,s),Object.keys(i).forEach((function(e){n.removeAttribute(e)})))}))}},requires:["computeStyles"]};const _m={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,r=e.options,n=e.name,i=r.offset,s=void 0===i?[0,0]:i,a=lm.reduce((function(e,r){return e[r]=function(e,t,r){var n=gm(e),i=[em,Zp].indexOf(n)>=0?-1:1,s="function"===typeof r?r(Object.assign({},t,{placement:e})):r,a=s[0],o=s[1];return a=a||0,o=(o||0)*i,[em,$p].indexOf(n)>=0?{x:o,y:a}:{x:a,y:o}}(r,t.rects,s),e}),{}),o=a[t.placement],l=o.x,c=o.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[n]=a}};var Cm={left:"right",right:"left",bottom:"top",top:"bottom"};function Em(e){return e.replace(/left|right|bottom|top/g,(function(e){return Cm[e]}))}var Am={start:"end",end:"start"};function Mm(e){return e.replace(/start|end/g,(function(e){return Am[e]}))}function Tm(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&kp(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Pm(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function km(e,t,r){return t===sm?Pm(function(e,t){var r=Mp(e),n=Fp(e),i=r.visualViewport,s=n.clientWidth,a=n.clientHeight,o=0,l=0;if(i){s=i.width,a=i.height;var c=Lp();(c||!c&&"fixed"===t)&&(o=i.offsetLeft,l=i.offsetTop)}return{width:s,height:a,x:o+jp(e),y:l}}(e,r)):Tp(t)?function(e,t){var r=Np(e,!1,"fixed"===t);return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}(t,r):Pm(function(e){var t,r=Fp(e),n=Bp(e),i=null==(t=e.ownerDocument)?void 0:t.body,s=Dp(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),a=Dp(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),o=-n.scrollLeft+jp(e),l=-n.scrollTop;return"rtl"===Up(i||r).direction&&(o+=Dp(r.clientWidth,i?i.clientWidth:0)-s),{width:s,height:a,x:o,y:l}}(Fp(e)))}function Dm(e,t,r,n){var i="clippingParents"===t?function(e){var t=Xp(Gp(e)),r=["absolute","fixed"].indexOf(Up(e).position)>=0&&Pp(e)?Qp(e):e;return Tp(r)?t.filter((function(e){return Tp(e)&&Tm(e,r)&&"body"!==zp(e)})):[]}(e):[].concat(t),s=[].concat(i,[r]),a=s[0],o=s.reduce((function(t,r){var i=km(e,r,n);return t.top=Dp(i.top,t.top),t.right=Ip(i.right,t.right),t.bottom=Ip(i.bottom,t.bottom),t.left=Dp(i.left,t.left),t}),km(e,a,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function Im(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function Om(e,t){return t.reduce((function(t,r){return t[r]=e,t}),{})}function Rm(e,t){void 0===t&&(t={});var r=t,n=r.placement,i=void 0===n?e.placement:n,s=r.strategy,a=void 0===s?e.strategy:s,o=r.boundary,l=void 0===o?"clippingParents":o,c=r.rootBoundary,u=void 0===c?sm:c,h=r.elementContext,d=void 0===h?am:h,f=r.altBoundary,p=void 0!==f&&f,m=r.padding,g=void 0===m?0:m,v=Im("number"!==typeof g?g:Om(g,rm)),y=d===am?"reference":am,b=e.rects.popper,w=e.elements[p?y:d],x=Dm(Tp(w)?w:w.contextElement||Fp(e.elements.popper),l,u,a),S=Np(e.elements.reference),_=bm({reference:S,element:b,strategy:"absolute",placement:i}),C=Pm(Object.assign({},b,_)),E=d===am?C:S,A={top:x.top-E.top+v.top,bottom:E.bottom-x.bottom+v.bottom,left:x.left-E.left+v.left,right:E.right-x.right+v.right},M=e.modifiersData.offset;if(d===am&&M){var T=M[i];Object.keys(A).forEach((function(e){var t=[$p,Jp].indexOf(e)>=0?1:-1,r=[Zp,Jp].indexOf(e)>=0?"y":"x";A[e]+=T[r]*t}))}return A}const Lm={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var i=r.mainAxis,s=void 0===i||i,a=r.altAxis,o=void 0===a||a,l=r.fallbackPlacements,c=r.padding,u=r.boundary,h=r.rootBoundary,d=r.altBoundary,f=r.flipVariations,p=void 0===f||f,m=r.allowedAutoPlacements,g=t.options.placement,v=gm(g),y=l||(v===g||!p?[Em(g)]:function(e){if(gm(e)===tm)return[];var t=Em(e);return[Mm(e),t,Mm(t)]}(g)),b=[g].concat(y).reduce((function(e,r){return e.concat(gm(r)===tm?function(e,t){void 0===t&&(t={});var r=t,n=r.placement,i=r.boundary,s=r.rootBoundary,a=r.padding,o=r.flipVariations,l=r.allowedAutoPlacements,c=void 0===l?lm:l,u=vm(n),h=u?o?om:om.filter((function(e){return vm(e)===u})):rm,d=h.filter((function(e){return c.indexOf(e)>=0}));0===d.length&&(d=h);var f=d.reduce((function(t,r){return t[r]=Rm(e,{placement:r,boundary:i,rootBoundary:s,padding:a})[gm(r)],t}),{});return Object.keys(f).sort((function(e,t){return f[e]-f[t]}))}(t,{placement:r,boundary:u,rootBoundary:h,padding:c,flipVariations:p,allowedAutoPlacements:m}):r)}),[]),w=t.rects.reference,x=t.rects.popper,S=new Map,_=!0,C=b[0],E=0;E<b.length;E++){var A=b[E],M=gm(A),T=vm(A)===nm,P=[Zp,Jp].indexOf(M)>=0,k=P?"width":"height",D=Rm(t,{placement:A,boundary:u,rootBoundary:h,altBoundary:d,padding:c}),I=P?T?$p:em:T?Jp:Zp;w[k]>x[k]&&(I=Em(I));var O=Em(I),R=[];if(s&&R.push(D[M]<=0),o&&R.push(D[I]<=0,D[O]<=0),R.every((function(e){return e}))){C=A,_=!1;break}S.set(A,R)}if(_)for(var L=function(e){var t=b.find((function(t){var r=S.get(t);if(r)return r.slice(0,e).every((function(e){return e}))}));if(t)return C=t,"break"},N=p?3:1;N>0;N--){if("break"===L(N))break}t.placement!==C&&(t.modifiersData[n]._skip=!0,t.placement=C,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Nm(e,t,r){return Dp(e,Ip(t,r))}const Bm={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,r=e.options,n=e.name,i=r.mainAxis,s=void 0===i||i,a=r.altAxis,o=void 0!==a&&a,l=r.boundary,c=r.rootBoundary,u=r.altBoundary,h=r.padding,d=r.tether,f=void 0===d||d,p=r.tetherOffset,m=void 0===p?0:p,g=Rm(t,{boundary:l,rootBoundary:c,padding:h,altBoundary:u}),v=gm(t.placement),y=vm(t.placement),b=!y,w=ym(v),x="x"===w?"y":"x",S=t.modifiersData.popperOffsets,_=t.rects.reference,C=t.rects.popper,E="function"===typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,A="number"===typeof E?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),M=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,T={x:0,y:0};if(S){if(s){var P,k="y"===w?Zp:em,D="y"===w?Jp:$p,I="y"===w?"height":"width",O=S[w],R=O+g[k],L=O-g[D],N=f?-C[I]/2:0,B=y===nm?_[I]:C[I],z=y===nm?-C[I]:-_[I],F=t.elements.arrow,j=f&&F?Wp(F):{width:0,height:0},U=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},V=U[k],H=U[D],W=Nm(0,_[I],j[I]),G=b?_[I]/2-N-W-V-A.mainAxis:B-W-V-A.mainAxis,q=b?-_[I]/2+N+W+H+A.mainAxis:z+W+H+A.mainAxis,X=t.elements.arrow&&Qp(t.elements.arrow),Y=X?"y"===w?X.clientTop||0:X.clientLeft||0:0,K=null!=(P=null==M?void 0:M[w])?P:0,Q=O+q-K,Z=Nm(f?Ip(R,O+G-K-Y):R,O,f?Dp(L,Q):L);S[w]=Z,T[w]=Z-O}if(o){var J,$="x"===w?Zp:em,ee="x"===w?Jp:$p,te=S[x],re="y"===x?"height":"width",ne=te+g[$],ie=te-g[ee],se=-1!==[Zp,em].indexOf(v),ae=null!=(J=null==M?void 0:M[x])?J:0,oe=se?ne:te-_[re]-C[re]-ae+A.altAxis,le=se?te+_[re]+C[re]-ae-A.altAxis:ie,ce=f&&se?function(e,t,r){var n=Nm(e,t,r);return n>r?r:n}(oe,te,le):Nm(f?oe:ne,te,f?le:ie);S[x]=ce,T[x]=ce-te}t.modifiersData[n]=T}},requiresIfExists:["offset"]};const zm={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,r=e.state,n=e.name,i=e.options,s=r.elements.arrow,a=r.modifiersData.popperOffsets,o=gm(r.placement),l=ym(o),c=[em,$p].indexOf(o)>=0?"height":"width";if(s&&a){var u=function(e,t){return Im("number"!==typeof(e="function"===typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:Om(e,rm))}(i.padding,r),h=Wp(s),d="y"===l?Zp:em,f="y"===l?Jp:$p,p=r.rects.reference[c]+r.rects.reference[l]-a[l]-r.rects.popper[c],m=a[l]-r.rects.reference[l],g=Qp(s),v=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,y=p/2-m/2,b=u[d],w=v-h[c]-u[f],x=v/2-h[c]/2+y,S=Nm(b,x,w),_=l;r.modifiersData[n]=((t={})[_]=S,t.centerOffset=S-x,t)}},effect:function(e){var t=e.state,r=e.options.element,n=void 0===r?"[data-popper-arrow]":r;null!=n&&("string"!==typeof n||(n=t.elements.popper.querySelector(n)))&&Tm(t.elements.popper,n)&&(t.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Fm(e,t,r){return void 0===r&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function jm(e){return[Zp,$p,Jp,em].some((function(t){return e[t]>=0}))}var Um=pm({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,r=e.instance,n=e.options,i=n.scroll,s=void 0===i||i,a=n.resize,o=void 0===a||a,l=Mp(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&c.forEach((function(e){e.addEventListener("scroll",r.update,mm)})),o&&l.addEventListener("resize",r.update,mm),function(){s&&c.forEach((function(e){e.removeEventListener("scroll",r.update,mm)})),o&&l.removeEventListener("resize",r.update,mm)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,r=e.name;t.modifiersData[r]=bm({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,r=e.options,n=r.gpuAcceleration,i=void 0===n||n,s=r.adaptive,a=void 0===s||s,o=r.roundOffsets,l=void 0===o||o,c={placement:gm(t.placement),variation:vm(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,xm(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,xm(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},Sm,_m,Lm,Bm,zm,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,r=e.name,n=t.rects.reference,i=t.rects.popper,s=t.modifiersData.preventOverflow,a=Rm(t,{elementContext:"reference"}),o=Rm(t,{altBoundary:!0}),l=Fm(a,n),c=Fm(o,i,s),u=jm(l),h=jm(c);t.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:h},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":h})}}]});function Vm(e){return ka("MuiPopper",e)}Da("MuiPopper",["root"]);const Hm=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],Wm=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function Gm(e){return"function"===typeof e?e():e}function qm(e){return void 0!==e.nodeType}const Xm={},Ym=e.forwardRef((function(t,r){var n;const{anchorEl:i,children:a,direction:o,disablePortal:l,modifiers:c,open:h,placement:d,popperOptions:f,popperRef:p,slotProps:m={},slots:g={},TransitionProps:v,ownerState:y}=t,b=s(t,Hm),w=e.useRef(null),x=xo(w,r),S=e.useRef(null),_=xo(S,p),C=e.useRef(_);Co((()=>{C.current=_}),[_]),e.useImperativeHandle(p,(()=>S.current),[]);const E=function(e,t){if("ltr"===t)return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}(d,o),[A,M]=e.useState(E),[T,P]=e.useState(Gm(i));e.useEffect((()=>{S.current&&S.current.forceUpdate()})),e.useEffect((()=>{i&&P(Gm(i))}),[i]),Co((()=>{if(!T||!h)return;let e=[{name:"preventOverflow",options:{altBoundary:l}},{name:"flip",options:{altBoundary:l}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:e=>{let{state:t}=e;(e=>{M(e.placement)})(t)}}];null!=c&&(e=e.concat(c)),f&&null!=f.modifiers&&(e=e.concat(f.modifiers));const t=Um(T,w.current,u(u({placement:E},f),{},{modifiers:e}));return C.current(t),()=>{t.destroy(),C.current(null)}}),[T,l,c,h,f,E]);const k={placement:A};null!==v&&(k.TransitionProps=v);const D=(e=>{const{classes:t}=e;return Na({root:["root"]},Vm,t)})(t),I=null!==(n=g.root)&&void 0!==n?n:"div",O=tc({elementType:I,externalSlotProps:m.root,externalForwardedProps:b,additionalProps:{role:"tooltip",ref:x},ownerState:t,className:D.root});return(0,bt.jsx)(I,u(u({},O),{},{children:"function"===typeof a?a(k):a}))})),Km=e.forwardRef((function(t,r){const{anchorEl:n,children:i,container:a,direction:o="ltr",disablePortal:l=!1,keepMounted:c=!1,modifiers:h,open:d,placement:f="bottom",popperOptions:p=Xm,popperRef:m,style:g,transition:v=!1,slotProps:y={},slots:b={}}=t,w=s(t,Wm),[x,S]=e.useState(!0);if(!c&&!d&&(!v||x))return null;let _;if(a)_=a;else if(n){const e=Gm(n);_=e&&qm(e)?So(e).body:So(null).body}const C=d||!c||v&&!x?void 0:"none",E=v?{in:d,onEnter:()=>{S(!1)},onExited:()=>{S(!0)}}:void 0;return(0,bt.jsx)(Qc,{disablePortal:l,container:_,children:(0,bt.jsx)(Ym,u(u({anchorEl:n,direction:o,disablePortal:l,modifiers:h,ref:r,open:v?!x:d,placement:f,popperOptions:p,popperRef:m,slotProps:y,slots:b},w),{},{style:u({position:"fixed",top:0,left:0,display:C},g),TransitionProps:E,children:i}))})})),Qm=["anchorEl","component","components","componentsProps","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","transition","slots","slotProps"],Zm=eo(Km,{name:"MuiPopper",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Jm=e.forwardRef((function(e,t){var r;const n=Is(),i=no({props:e,name:"MuiPopper"}),{anchorEl:a,component:o,components:l,componentsProps:c,container:h,disablePortal:d,keepMounted:f,modifiers:p,open:m,placement:g,popperOptions:v,popperRef:y,transition:b,slots:w,slotProps:x}=i,S=s(i,Qm),_=null!==(r=null===w||void 0===w?void 0:w.root)&&void 0!==r?r:null===l||void 0===l?void 0:l.Root,C=u({anchorEl:a,container:h,disablePortal:d,keepMounted:f,modifiers:p,open:m,placement:g,popperOptions:v,popperRef:y,transition:b},S);return(0,bt.jsx)(Zm,u(u({as:o,direction:n?"rtl":"ltr",slots:{root:_},slotProps:null!==x&&void 0!==x?x:c},C),{},{ref:t}))}));function $m(e){return ka("MuiPickersPopper",e)}Da("MuiPickersPopper",["root","paper"]);const eg=function(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:document).activeElement;return e?e.shadowRoot?eg(e.shadowRoot):e:null},tg="@media (pointer: fine)",rg="undefined"!==typeof navigator&&navigator.userAgent.match(/android\s(\d+)|OS\s(\d+)/i),ng=rg&&rg[1]?parseInt(rg[1],10):null,ig=rg&&rg[2]?parseInt(rg[2],10):null,sg=ng&&ng<10||ig&&ig<13||!1,ag=()=>Cd("@media (prefers-reduced-motion: reduce)",{defaultMatches:!1})||sg,og=["PaperComponent","popperPlacement","ownerState","children","paperSlotProps","paperClasses","onPaperClick","onPaperTouchStart"],lg=eo(Jm,{name:"MuiPickersPopper",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{let{theme:t}=e;return{zIndex:t.zIndex.modal}})),cg=eo(ku,{name:"MuiPickersPopper",slot:"Paper",overridesResolver:(e,t)=>t.paper})({outline:0,transformOrigin:"top center",variants:[{props:e=>{let{placement:t}=e;return["top","top-start","top-end"].includes(t)},style:{transformOrigin:"bottom center"}}]});const ug=e.forwardRef(((e,t)=>{const{PaperComponent:r,popperPlacement:n,ownerState:s,children:a,paperSlotProps:o,paperClasses:l,onPaperClick:c,onPaperTouchStart:u}=e,h=i(e,og),d=ha({},s,{placement:n}),f=tc({elementType:r,externalSlotProps:o,additionalProps:{tabIndex:-1,elevation:8,ref:t},className:l,ownerState:d});return(0,bt.jsx)(r,ha({},h,f,{onClick:e=>{var t;c(e),null===(t=f.onClick)||void 0===t||t.call(f,e)},onTouchStart:e=>{var t;u(e),null===(t=f.onTouchStart)||void 0===t||t.call(f,e)},ownerState:d,children:a}))}));function hg(t){var r,n,i,s;const a=gd({props:t,name:"MuiPickersPopper"}),{anchorEl:o,children:l,containerRef:c=null,shouldRestoreFocus:u,onBlur:h,onDismiss:d,open:f,role:p,placement:m,slots:g,slotProps:v,reduceAnimations:y}=a;e.useEffect((()=>{function e(e){f&&"Escape"===e.key&&d()}return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[d,f]);const b=e.useRef(null);e.useEffect((()=>{"tooltip"===p||u&&!u()||(f?b.current=eg(document):b.current&&b.current instanceof HTMLElement&&setTimeout((()=>{b.current instanceof HTMLElement&&b.current.focus()})))}),[f,p,u]);const[w,x,S]=function(t,r){const n=e.useRef(!1),i=e.useRef(!1),s=e.useRef(null),a=e.useRef(!1);e.useEffect((()=>{if(t)return document.addEventListener("mousedown",e,!0),document.addEventListener("touchstart",e,!0),()=>{document.removeEventListener("mousedown",e,!0),document.removeEventListener("touchstart",e,!0),a.current=!1};function e(){a.current=!0}}),[t]);const o=uu((e=>{if(!a.current)return;const t=i.current;i.current=!1;const o=So(s.current);if(!s.current||"clientX"in e&&function(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}(e,o))return;if(n.current)return void(n.current=!1);let l;l=e.composedPath?e.composedPath().indexOf(s.current)>-1:!o.documentElement.contains(e.target)||s.current.contains(e.target),l||t||r(e)})),l=()=>{i.current=!0};return e.useEffect((()=>{if(t){const e=So(s.current),t=()=>{n.current=!0};return e.addEventListener("touchstart",o),e.addEventListener("touchmove",t),()=>{e.removeEventListener("touchstart",o),e.removeEventListener("touchmove",t)}}}),[t,o]),e.useEffect((()=>{if(t){const e=So(s.current);return e.addEventListener("click",o),()=>{e.removeEventListener("click",o),i.current=!1}}}),[t,o]),[s,l,l]}(f,null!==h&&void 0!==h?h:d),_=xo(e.useRef(null),c),C=xo(_,w),E=a,A=(e=>{const{classes:t}=e;return Na({root:["root"],paper:["paper"]},$m,t)})(E),M=ag(),T=null!==y&&void 0!==y?y:M,P=(null!==(r=null===g||void 0===g?void 0:g.desktopTransition)&&void 0!==r?r:T)?iu:Gc,k=null!==(n=null===g||void 0===g?void 0:g.desktopTrapFocus)&&void 0!==n?n:Kc,D=null!==(i=null===g||void 0===g?void 0:g.desktopPaper)&&void 0!==i?i:cg,I=null!==(s=null===g||void 0===g?void 0:g.popper)&&void 0!==s?s:lg,O=tc({elementType:I,externalSlotProps:null===v||void 0===v?void 0:v.popper,additionalProps:{transition:!0,role:p,open:f,anchorEl:o,placement:m,onKeyDown:e=>{"Escape"===e.key&&(e.stopPropagation(),d())}},className:A.root,ownerState:a});return(0,bt.jsx)(I,ha({},O,{children:e=>{let{TransitionProps:t,placement:r}=e;return(0,bt.jsx)(k,ha({open:f,disableAutoFocus:!0,disableRestoreFocus:!0,disableEnforceFocus:"tooltip"===p,isEnabled:()=>!0},null===v||void 0===v?void 0:v.desktopTrapFocus,{children:(0,bt.jsx)(P,ha({},t,null===v||void 0===v?void 0:v.desktopTransition,{children:(0,bt.jsx)(ug,{PaperComponent:D,ownerState:E,popperPlacement:r,ref:C,onPaperClick:x,onPaperTouchStart:S,paperClasses:A.paper,paperSlotProps:null===v||void 0===v?void 0:v.desktopPaper,children:l})}))}))}}))}function dg(t){const{props:r,validator:n,value:i,timezone:s,onError:a}=t,o=gf(),l=e.useRef(n.valueManager.defaultErrorState),c=n({adapter:o,value:i,timezone:s,props:r}),u=n.valueManager.hasError(c);e.useEffect((()=>{a&&!n.valueManager.isSameError(c,l.current)&&a(c,i),l.current=c}),[n,a,c,i]);const h=uu((e=>n({adapter:o,value:e,timezone:s,props:r})));return{validationError:c,hasValidationError:u,getValidationErrorForNewValue:h}}const fg=t=>{var r;let{timezone:n,value:i,defaultValue:s,referenceDate:a,onChange:o,valueManager:l}=t;const c=vf(),u=e.useRef(s),h=null!==(r=null!==i&&void 0!==i?i:u.current)&&void 0!==r?r:l.emptyValue,d=e.useMemo((()=>l.getTimezone(c,h)),[c,l,h]),f=uu((e=>null==d?e:l.setTimezone(c,d,e)));let p;p=n||(d||(a?c.getTimezone(a):"default"));return{value:e.useMemo((()=>l.setTimezone(c,p,h)),[l,c,p,h]),handleValueChange:uu((function(e){const t=f(e);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];null===o||void 0===o||o(t,...n)})),timezone:p}},pg=e=>{let{name:t,timezone:r,value:n,defaultValue:i,referenceDate:s,onChange:a,valueManager:o}=e;const[l,c]=lh({name:t,state:"value",controlled:n,default:null!==i&&void 0!==i?i:o.emptyValue}),u=uu((function(e){c(e);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];null===a||void 0===a||a(e,...r)}));return fg({timezone:r,value:l,defaultValue:void 0,referenceDate:s,onChange:u,valueManager:o})},mg=t=>{let{props:r,valueManager:n,valueType:i,wrapperVariant:s,validator:a}=t;const{onAccept:o,onChange:l,value:c,defaultValue:u,closeOnSelect:h="desktop"===s,timezone:d,referenceDate:f}=r,{current:p}=e.useRef(u),{current:m}=e.useRef(void 0!==c),[g,v]=e.useState(d);const y=vf(),b=gf(),{isOpen:w,setIsOpen:x}=(t=>{let{open:r,onOpen:n,onClose:i}=t;const s=e.useRef("boolean"===typeof r).current,[a,o]=e.useState(!1);return e.useEffect((()=>{if(s){if("boolean"!==typeof r)throw new Error("You must not mix controlling and uncontrolled mode for `open` prop");o(r)}}),[s,r]),{isOpen:a,setIsOpen:e.useCallback((e=>{s||o(e),e&&n&&n(),!e&&i&&i()}),[s,n,i])}})(r),{timezone:S,value:_,handleValueChange:C}=fg({timezone:d,value:c,defaultValue:p,referenceDate:f,onChange:l,valueManager:n}),[E,A]=e.useState((()=>{let e;return e=void 0!==_?_:void 0!==p?p:n.emptyValue,{draft:e,lastPublishedValue:e,lastCommittedValue:e,lastControlledValue:c,hasBeenModifiedSinceMount:!1}})),M=n.getTimezone(y,E.draft);g!==d&&(v(d),d&&M&&d!==M&&A((e=>ha({},e,{draft:n.setTimezone(y,d,e.draft)}))));const{getValidationErrorForNewValue:T}=dg({props:r,validator:a,timezone:S,value:E.draft,onError:r.onError}),P=uu((e=>{const t={action:e,dateState:E,hasChanged:t=>!n.areValuesEqual(y,e.value,t),isControlled:m,closeOnSelect:h},r=(e=>{const{action:t,hasChanged:r,dateState:n,isControlled:i}=e,s=!i&&!n.hasBeenModifiedSinceMount;return"setValueFromField"===t.name||("setValueFromAction"===t.name?!(!s||!["accept","today","clear"].includes(t.pickerAction))||r(n.lastPublishedValue):("setValueFromView"===t.name&&"shallow"!==t.selectionState||"setValueFromShortcut"===t.name)&&(!!s||r(n.lastPublishedValue)))})(t),i=(e=>{const{action:t,hasChanged:r,dateState:n,isControlled:i,closeOnSelect:s}=e,a=!i&&!n.hasBeenModifiedSinceMount;return"setValueFromAction"===t.name?!(!a||!["accept","today","clear"].includes(t.pickerAction))||r(n.lastCommittedValue):"setValueFromView"===t.name&&"finish"===t.selectionState&&s?!!a||r(n.lastCommittedValue):"setValueFromShortcut"===t.name&&"accept"===t.changeImportance&&r(n.lastCommittedValue)})(t),s=(e=>{const{action:t,closeOnSelect:r}=e;return"setValueFromAction"===t.name||("setValueFromView"===t.name?"finish"===t.selectionState&&r:"setValueFromShortcut"===t.name&&"accept"===t.changeImportance)})(t);A((t=>ha({},t,{draft:e.value,lastPublishedValue:r?e.value:t.lastPublishedValue,lastCommittedValue:i?e.value:t.lastCommittedValue,hasBeenModifiedSinceMount:!0})));let a=null;const l=()=>{if(!a){const t="setValueFromField"===e.name?e.context.validationError:T(e.value);a={validationError:t},"setValueFromShortcut"===e.name&&(a.shortcut=e.shortcut)}return a};r&&C(e.value,l()),i&&o&&o(e.value,l()),s&&x(!1)}));if(E.lastControlledValue!==c){const e=n.areValuesEqual(y,E.draft,_);A((t=>ha({},t,{lastControlledValue:c},e?{}:{lastCommittedValue:_,lastPublishedValue:_,draft:_,hasBeenModifiedSinceMount:!0})))}const k=uu((()=>{P({value:n.emptyValue,name:"setValueFromAction",pickerAction:"clear"})})),D=uu((()=>{P({value:E.lastPublishedValue,name:"setValueFromAction",pickerAction:"accept"})})),I=uu((()=>{P({value:E.lastPublishedValue,name:"setValueFromAction",pickerAction:"dismiss"})})),O=uu((()=>{P({value:E.lastCommittedValue,name:"setValueFromAction",pickerAction:"cancel"})})),R=uu((()=>{P({value:n.getTodayValue(y,S,i),name:"setValueFromAction",pickerAction:"today"})})),L=uu((e=>{e.preventDefault(),x(!0)})),N=uu((e=>{null===e||void 0===e||e.preventDefault(),x(!1)})),B=uu((function(e){return P({name:"setValueFromView",value:e,selectionState:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"partial"})})),z=uu(((e,t,r)=>P({name:"setValueFromShortcut",value:e,changeImportance:t,shortcut:r}))),F=uu(((e,t)=>P({name:"setValueFromField",value:e,context:t}))),j={onClear:k,onAccept:D,onDismiss:I,onCancel:O,onSetToday:R,onOpen:L,onClose:N},U={value:E.draft,onChange:F},V=e.useMemo((()=>n.cleanValue(y,E.draft)),[y,n,E.draft]),H={value:V,onChange:B,onClose:N,open:w},W=ha({},j,{value:V,onChange:B,onSelectShortcut:z,isValid:e=>{const t=a({adapter:b,value:e,timezone:S,props:r});return!n.hasError(t)}}),G=e.useMemo((()=>({onOpen:L,onClose:N,open:w})),[w,N,L]);return{open:w,fieldProps:U,viewProps:H,layoutProps:W,actions:j,contextValue:G}};function gg(t){var r,n;let{onChange:i,onViewChange:s,openTo:a,view:o,views:l,autoFocus:c,focusedView:u,onFocusedViewChange:h}=t;const d=e.useRef(a),f=e.useRef(l),p=e.useRef(l.includes(a)?a:l[0]),[m,g]=lh({name:"useViews",state:"view",controlled:o,default:p.current}),v=e.useRef(c?m:null),[y,b]=lh({name:"useViews",state:"focusedView",controlled:u,default:v.current});e.useEffect((()=>{(d.current&&d.current!==a||f.current&&f.current.some((e=>!l.includes(e))))&&(g(l.includes(a)?a:l[0]),f.current=l,d.current=a)}),[a,g,m,l]);const w=l.indexOf(m),x=null!==(r=l[w-1])&&void 0!==r?r:null,S=null!==(n=l[w+1])&&void 0!==n?n:null,_=uu(((e,t)=>{b(t?e:t=>e===t?null:t),null===h||void 0===h||h(e,t)})),C=uu((e=>{_(e,!0),e!==m&&(g(e),s&&s(e))})),E=uu((()=>{S&&C(S)})),A=uu(((e,t,r)=>{const n="finish"===t,s=r?l.indexOf(r)<l.length-1:Boolean(S);if(i(e,n&&s?"partial":t,r),r&&r!==m){const e=l[l.indexOf(r)+1];e&&C(e)}else n&&E()}));return{view:m,setView:C,focusedView:y,setFocusedView:_,nextView:S,previousView:x,defaultView:l.includes(a)?a:l[0],goToNextView:E,setValueAndGoToNextView:A}}const vg=["className","sx"],yg=t=>{let{props:r,propsFromPickerValue:n,additionalViewProps:s,autoFocusView:a,rendererInterceptor:o,fieldRef:l}=t;const{onChange:c,open:u,onClose:h}=n,{view:d,views:f,openTo:p,onViewChange:m,viewRenderers:g,timezone:v}=r,y=i(r,vg),{view:b,setView:w,defaultView:x,focusedView:S,setFocusedView:_,setValueAndGoToNextView:C}=gg({view:d,views:f,openTo:p,onChange:c,onViewChange:m,autoFocus:a}),{hasUIView:E,viewModeLookup:A}=e.useMemo((()=>f.reduce(((e,t)=>{let r;return r=null!=g[t]?"UI":"field",e.viewModeLookup[t]=r,"UI"===r&&(e.hasUIView=!0),e}),{hasUIView:!1,viewModeLookup:{}})),[g,f]),M=e.useMemo((()=>f.reduce(((e,t)=>null!=g[t]&&(e=>zd.includes(e))(t)?e+1:e),0)),[g,f]),T=A[b],P=uu((()=>"UI"===T)),[k,D]=e.useState("UI"===T?b:null);k!==b&&"UI"===A[b]&&D(b),Co((()=>{"field"===T&&u&&(h(),setTimeout((()=>{var e,t;null===l||void 0===l||null===(e=l.current)||void 0===e||e.setSelectedSections(b),null===l||void 0===l||null===(t=l.current)||void 0===t||t.focusField(b)})))}),[b]),Co((()=>{if(!u)return;let e=b;"field"===T&&null!=k&&(e=k),e!==x&&"UI"===A[e]&&"UI"===A[x]&&(e=x),e!==b&&w(e),_(e,!0)}),[u]);return{hasUIView:E,shouldRestoreFocus:P,layoutProps:{views:f,view:k,onViewChange:w},renderCurrentView:()=>{if(null==k)return null;const e=g[k];if(null==e)return null;const t=ha({},y,s,n,{views:f,timezone:v,onChange:C,view:k,onViewChange:w,focusedView:S,onFocusedViewChange:_,showViewSwitcher:M>1,timeViewsCount:M});return o?o(g,k,t):e(t)}}};function bg(){return"undefined"===typeof window?"portrait":window.screen&&window.screen.orientation&&window.screen.orientation.angle?90===Math.abs(window.screen.orientation.angle)?"landscape":"portrait":window.orientation&&90===Math.abs(Number(window.orientation))?"landscape":"portrait"}const wg=(t,r)=>{const[n,i]=e.useState(bg);if(Co((()=>{const e=()=>{i(bg())};return window.addEventListener("orientationchange",e),()=>{window.removeEventListener("orientationchange",e)}}),[]),s=t,a=["hours","minutes","seconds"],Array.isArray(a)?a.every((e=>-1!==s.indexOf(e))):-1!==s.indexOf(a))return!1;var s,a;return"landscape"===(r||n)};const xg=t=>{let{props:r,valueManager:n,valueType:i,wrapperVariant:s,additionalViewProps:a,validator:o,autoFocusView:l,rendererInterceptor:c,fieldRef:u}=t;const h=mg({props:r,valueManager:n,valueType:i,wrapperVariant:s,validator:o}),d=yg({props:r,additionalViewProps:a,autoFocusView:l,fieldRef:u,propsFromPickerValue:h.viewProps,rendererInterceptor:c}),f=(e=>{let{props:t,propsFromPickerValue:r,propsFromPickerViews:n,wrapperVariant:i}=e;const{orientation:s}=t;return{layoutProps:ha({},n,r,{isLandscape:wg(n.views,s),isRtl:Is(),wrapperVariant:i,disabled:t.disabled,readOnly:t.readOnly})}})({props:r,wrapperVariant:s,propsFromPickerValue:h.layoutProps,propsFromPickerViews:d.layoutProps}),p=function(t){const{props:r,pickerValueResponse:n}=t;return e.useMemo((()=>{var e,t;return{value:n.viewProps.value,open:n.open,disabled:null!==(e=r.disabled)&&void 0!==e&&e,readOnly:null!==(t=r.readOnly)&&void 0!==t&&t}}),[n.viewProps.value,n.open,r.disabled,r.readOnly])}({props:r,pickerValueResponse:h});return{open:h.open,actions:h.actions,fieldProps:h.fieldProps,renderCurrentView:d.renderCurrentView,hasUIView:d.hasUIView,shouldRestoreFocus:d.shouldRestoreFocus,layoutProps:f.layoutProps,contextValue:h.contextValue,ownerState:p}};function Sg(e){return ka("MuiPickersLayout",e)}const _g=Da("MuiPickersLayout",["root","landscape","contentWrapper","toolbar","actionBar","tabs","shortcuts"]);function Cg(e){return ka("MuiButton",e)}const Eg=Da("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]);const Ag=e.createContext({});const Mg=e.createContext(void 0),Tg=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],Pg=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],kg=eo(wp,{shouldForwardProp:e=>Ja(e)||"classes"===e,name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.variant],t["".concat(r.variant).concat(io(r.color))],t["size".concat(io(r.size))],t["".concat(r.variant,"Size").concat(io(r.size))],"inherit"===r.color&&t.colorInherit,r.disableElevation&&t.disableElevation,r.fullWidth&&t.fullWidth]}})(ro((e=>{let{theme:t}=e;const r="light"===t.palette.mode?t.palette.grey[300]:t.palette.grey[800],n="light"===t.palette.mode?t.palette.grey.A100:t.palette.grey[700];return u(u({},t.typography.button),{},{minWidth:64,padding:"6px 16px",border:0,borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":{textDecoration:"none"},["&.".concat(Eg.disabled)]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(t.vars||t).shadows[2],"&:hover":{boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2]}},"&:active":{boxShadow:(t.vars||t).shadows[8]},["&.".concat(Eg.focusVisible)]:{boxShadow:(t.vars||t).shadows[6]},["&.".concat(Eg.disabled)]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",["&.".concat(Eg.disabled)]:{border:"1px solid ".concat((t.vars||t).palette.action.disabledBackground)}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(t.palette).filter(so()).map((e=>{let[r]=e;return{props:{color:r},style:{"--variant-textColor":(t.vars||t).palette[r].main,"--variant-outlinedColor":(t.vars||t).palette[r].main,"--variant-outlinedBorder":t.vars?"rgba(".concat(t.vars.palette[r].mainChannel," / 0.5)"):Dt(t.palette[r].main,.5),"--variant-containedColor":(t.vars||t).palette[r].contrastText,"--variant-containedBg":(t.vars||t).palette[r].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(t.vars||t).palette[r].dark,"--variant-textBg":t.vars?"rgba(".concat(t.vars.palette[r].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):Dt(t.palette[r].main,t.palette.action.hoverOpacity),"--variant-outlinedBorder":(t.vars||t).palette[r].main,"--variant-outlinedBg":t.vars?"rgba(".concat(t.vars.palette[r].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):Dt(t.palette[r].main,t.palette.action.hoverOpacity)}}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedBg:r,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedHoverBg:n,"--variant-textBg":t.vars?"rgba(".concat(t.vars.palette.text.primaryChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):Dt(t.palette.text.primary,t.palette.action.hoverOpacity),"--variant-outlinedBg":t.vars?"rgba(".concat(t.vars.palette.text.primaryChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):Dt(t.palette.text.primary,t.palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:t.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},["&.".concat(Eg.focusVisible)]:{boxShadow:"none"},"&:active":{boxShadow:"none"},["&.".concat(Eg.disabled)]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}}]})}))),Dg=eo("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.startIcon,t["iconSize".concat(io(r.size))]]}})({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},...Pg]}),Ig=eo("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.endIcon,t["iconSize".concat(io(r.size))]]}})({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},...Pg]}),Og=e.forwardRef((function(t,r){const n=e.useContext(Ag),i=e.useContext(Mg),a=no({props:Rs(n,t),name:"MuiButton"}),{children:o,color:l="primary",component:c="button",className:h,disabled:d=!1,disableElevation:f=!1,disableFocusRipple:p=!1,endIcon:m,focusVisibleClassName:g,fullWidth:v=!1,size:y="medium",startIcon:b,type:w,variant:x="text"}=a,S=s(a,Tg),_=u(u({},a),{},{color:l,component:c,disabled:d,disableElevation:f,disableFocusRipple:p,fullWidth:v,size:y,type:w,variant:x}),C=(e=>{const{color:t,disableElevation:r,fullWidth:n,size:i,variant:s,classes:a}=e,o=Na({root:["root",s,"".concat(s).concat(io(t)),"size".concat(io(i)),"".concat(s,"Size").concat(io(i)),"color".concat(io(t)),r&&"disableElevation",n&&"fullWidth"],label:["label"],startIcon:["icon","startIcon","iconSize".concat(io(i))],endIcon:["icon","endIcon","iconSize".concat(io(i))]},Cg,a);return u(u({},a),o)})(_),E=b&&(0,bt.jsx)(Dg,{className:C.startIcon,ownerState:_,children:b}),A=m&&(0,bt.jsx)(Ig,{className:C.endIcon,ownerState:_,children:m}),M=i||"";return(0,bt.jsxs)(kg,u(u({ownerState:_,className:ua(n.className,C.root,h,M),component:c,disabled:d,focusRipple:!p,focusVisibleClassName:ua(C.focusVisible,g),ref:r,type:w},S),{},{classes:C,children:[E,o,A]}))})),Rg=Og;function Lg(e){return ka("MuiDialogActions",e)}Da("MuiDialogActions",["root","spacing"]);const Ng=["className","disableSpacing"],Bg=eo("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,!r.disableSpacing&&t.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:e=>{let{ownerState:t}=e;return!t.disableSpacing},style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),zg=e.forwardRef((function(e,t){const r=no({props:e,name:"MuiDialogActions"}),{className:n,disableSpacing:i=!1}=r,a=s(r,Ng),o=u(u({},r),{},{disableSpacing:i}),l=(e=>{const{classes:t,disableSpacing:r}=e;return Na({root:["root",!r&&"spacing"]},Lg,t)})(o);return(0,bt.jsx)(Bg,u({className:ua(l.root,n),ownerState:o,ref:t},a))})),Fg=["onAccept","onClear","onCancel","onSetToday","actions"];function jg(e){const{onAccept:t,onClear:r,onCancel:n,onSetToday:s,actions:a}=e,o=i(e,Fg),l=Ef();if(null==a||0===a.length)return null;const c=null===a||void 0===a?void 0:a.map((e=>{switch(e){case"clear":return(0,bt.jsx)(Rg,{onClick:r,children:l.clearButtonLabel},e);case"cancel":return(0,bt.jsx)(Rg,{onClick:n,children:l.cancelButtonLabel},e);case"accept":return(0,bt.jsx)(Rg,{onClick:t,children:l.okButtonLabel},e);case"today":return(0,bt.jsx)(Rg,{onClick:s,children:l.todayButtonLabel},e);default:return null}}));return(0,bt.jsx)(zg,ha({},o,{children:c}))}function Ug(e){return ka("MuiListItem",e)}Da("MuiListItem",["root","container","dense","alignItemsFlexStart","divider","gutters","padding","secondaryAction"]);function Vg(e){return ka("MuiListItemButton",e)}const Hg=Da("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]);function Wg(e){return ka("MuiListItemSecondaryAction",e)}Da("MuiListItemSecondaryAction",["root","disableGutters"]);const Gg=["className"],qg=eo("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.disableGutters&&t.disableGutters]}})({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",variants:[{props:e=>{let{ownerState:t}=e;return t.disableGutters},style:{right:0}}]}),Xg=e.forwardRef((function(t,r){const n=no({props:t,name:"MuiListItemSecondaryAction"}),{className:i}=n,a=s(n,Gg),o=e.useContext(rc),l=u(u({},n),{},{disableGutters:o.disableGutters}),c=(e=>{const{disableGutters:t,classes:r}=e;return Na({root:["root",t&&"disableGutters"]},Wg,r)})(l);return(0,bt.jsx)(qg,u({className:ua(c.root,i),ownerState:l,ref:r},a))}));Xg.muiName="ListItemSecondaryAction";const Yg=Xg,Kg=["className"],Qg=["alignItems","children","className","component","components","componentsProps","ContainerComponent","ContainerProps","dense","disableGutters","disablePadding","divider","secondaryAction","slotProps","slots"],Zg=eo("div",{name:"MuiListItem",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.dense&&t.dense,"flex-start"===r.alignItems&&t.alignItemsFlexStart,r.divider&&t.divider,!r.disableGutters&&t.gutters,!r.disablePadding&&t.padding,r.hasSecondaryAction&&t.secondaryAction]}})(ro((e=>{let{theme:t}=e;return{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",variants:[{props:e=>{let{ownerState:t}=e;return!t.disablePadding},style:{paddingTop:8,paddingBottom:8}},{props:e=>{let{ownerState:t}=e;return!t.disablePadding&&t.dense},style:{paddingTop:4,paddingBottom:4}},{props:e=>{let{ownerState:t}=e;return!t.disablePadding&&!t.disableGutters},style:{paddingLeft:16,paddingRight:16}},{props:e=>{let{ownerState:t}=e;return!t.disablePadding&&!!t.secondaryAction},style:{paddingRight:48}},{props:e=>{let{ownerState:t}=e;return!!t.secondaryAction},style:{["& > .".concat(Hg.root)]:{paddingRight:48}}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:e=>{let{ownerState:t}=e;return t.divider},style:{borderBottom:"1px solid ".concat((t.vars||t).palette.divider),backgroundClip:"padding-box"}},{props:e=>{let{ownerState:t}=e;return t.button},style:{transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}},{props:e=>{let{ownerState:t}=e;return t.hasSecondaryAction},style:{paddingRight:48}}]}}))),Jg=eo("li",{name:"MuiListItem",slot:"Container",overridesResolver:(e,t)=>t.container})({position:"relative"}),$g=e.forwardRef((function(t,r){const n=no({props:t,name:"MuiListItem"}),{alignItems:i="center",children:a,className:o,component:l,components:c={},componentsProps:h={},ContainerComponent:d="li",ContainerProps:{className:f}={},dense:p=!1,disableGutters:m=!1,disablePadding:g=!1,divider:v=!1,secondaryAction:y,slotProps:b={},slots:w={}}=n,x=s(n.ContainerProps,Kg),S=s(n,Qg),_=e.useContext(rc),C=e.useMemo((()=>({dense:p||_.dense||!1,alignItems:i,disableGutters:m})),[i,_.dense,p,m]),E=e.useRef(null),A=e.Children.toArray(a),M=A.length&&Rl(A[A.length-1],["ListItemSecondaryAction"]),T=u(u({},n),{},{alignItems:i,dense:C.dense,disableGutters:m,disablePadding:g,divider:v,hasSecondaryAction:M}),P=(e=>{const{alignItems:t,classes:r,dense:n,disableGutters:i,disablePadding:s,divider:a,hasSecondaryAction:o}=e;return Na({root:["root",n&&"dense",!i&&"gutters",!s&&"padding",a&&"divider","flex-start"===t&&"alignItemsFlexStart",o&&"secondaryAction"],container:["container"]},Ug,r)})(T),k=Lo(E,r),D=w.root||c.Root||Zg,I=b.root||h.root||{},O=u({className:ua(P.root,I.className,o)},S);let R=l||"li";return M?(R=O.component||l?R:"div","li"===d&&("li"===R?R="div":"li"===O.component&&(O.component="div")),(0,bt.jsx)(rc.Provider,{value:C,children:(0,bt.jsxs)(Jg,u(u({as:d,className:ua(P.container,f),ref:k,ownerState:T},x),{},{children:[(0,bt.jsx)(D,u(u(u(u({},I),!Do(D)&&{as:R,ownerState:u(u({},T),I.ownerState)}),O),{},{children:A})),A.pop()]}))})):(0,bt.jsx)(rc.Provider,{value:C,children:(0,bt.jsxs)(D,u(u(u(u({},I),{},{as:R,ref:k},!Do(D)&&{ownerState:u(u({},T),I.ownerState)}),O),{},{children:[A,y&&(0,bt.jsx)(Yg,{children:y})]}))})})),ev=$g,tv=Ah((0,bt.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function rv(e){return ka("MuiChip",e)}const nv=Da("MuiChip",["root","sizeSmall","sizeMedium","colorDefault","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),iv=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant","tabIndex","skipFocusWhenDisabled"],sv=eo("div",{name:"MuiChip",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e,{color:n,iconColor:i,clickable:s,onDelete:a,size:o,variant:l}=r;return[{["& .".concat(nv.avatar)]:t.avatar},{["& .".concat(nv.avatar)]:t["avatar".concat(io(o))]},{["& .".concat(nv.avatar)]:t["avatarColor".concat(io(n))]},{["& .".concat(nv.icon)]:t.icon},{["& .".concat(nv.icon)]:t["icon".concat(io(o))]},{["& .".concat(nv.icon)]:t["iconColor".concat(io(i))]},{["& .".concat(nv.deleteIcon)]:t.deleteIcon},{["& .".concat(nv.deleteIcon)]:t["deleteIcon".concat(io(o))]},{["& .".concat(nv.deleteIcon)]:t["deleteIconColor".concat(io(n))]},{["& .".concat(nv.deleteIcon)]:t["deleteIcon".concat(io(l),"Color").concat(io(n))]},t.root,t["size".concat(io(o))],t["color".concat(io(n))],s&&t.clickable,s&&"default"!==n&&t["clickableColor".concat(io(n),")")],a&&t.deletable,a&&"default"!==n&&t["deletableColor".concat(io(n))],t[l],t["".concat(l).concat(io(n))]]}})(ro((e=>{let{theme:t}=e;const r="light"===t.palette.mode?t.palette.grey[700]:t.palette.grey[300];return{maxWidth:"100%",fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(t.vars||t).palette.text.primary,backgroundColor:(t.vars||t).palette.action.selected,borderRadius:16,whiteSpace:"nowrap",transition:t.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",["&.".concat(nv.disabled)]:{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},["& .".concat(nv.avatar)]:{marginLeft:5,marginRight:-6,width:24,height:24,color:t.vars?t.vars.palette.Chip.defaultAvatarColor:r,fontSize:t.typography.pxToRem(12)},["& .".concat(nv.avatarColorPrimary)]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.dark},["& .".concat(nv.avatarColorSecondary)]:{color:(t.vars||t).palette.secondary.contrastText,backgroundColor:(t.vars||t).palette.secondary.dark},["& .".concat(nv.avatarSmall)]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:t.typography.pxToRem(10)},["& .".concat(nv.icon)]:{marginLeft:5,marginRight:-6},["& .".concat(nv.deleteIcon)]:{WebkitTapHighlightColor:"transparent",color:t.vars?"rgba(".concat(t.vars.palette.text.primaryChannel," / 0.26)"):Dt(t.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:t.vars?"rgba(".concat(t.vars.palette.text.primaryChannel," / 0.4)"):Dt(t.palette.text.primary,.4)}},variants:[{props:{size:"small"},style:{height:24,["& .".concat(nv.icon)]:{fontSize:18,marginLeft:4,marginRight:-4},["& .".concat(nv.deleteIcon)]:{fontSize:16,marginRight:4,marginLeft:-4}}},...Object.entries(t.palette).filter(so(["contrastText"])).map((e=>{let[r]=e;return{props:{color:r},style:{backgroundColor:(t.vars||t).palette[r].main,color:(t.vars||t).palette[r].contrastText,["& .".concat(nv.deleteIcon)]:{color:t.vars?"rgba(".concat(t.vars.palette[r].contrastTextChannel," / 0.7)"):Dt(t.palette[r].contrastText,.7),"&:hover, &:active":{color:(t.vars||t).palette[r].contrastText}}}}})),{props:e=>e.iconColor===e.color,style:{["& .".concat(nv.icon)]:{color:t.vars?t.vars.palette.Chip.defaultIconColor:r}}},{props:e=>e.iconColor===e.color&&"default"!==e.color,style:{["& .".concat(nv.icon)]:{color:"inherit"}}},{props:{onDelete:!0},style:{["&.".concat(nv.focusVisible)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.selectedChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.focusOpacity,"))"):Dt(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}}},...Object.entries(t.palette).filter(so(["dark"])).map((e=>{let[r]=e;return{props:{color:r,onDelete:!0},style:{["&.".concat(nv.focusVisible)]:{background:(t.vars||t).palette[r].dark}}}})),{props:{clickable:!0},style:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.selectedChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.hoverOpacity,"))"):Dt(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity)},["&.".concat(nv.focusVisible)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.selectedChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.focusOpacity,"))"):Dt(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)},"&:active":{boxShadow:(t.vars||t).shadows[1]}}},...Object.entries(t.palette).filter(so(["dark"])).map((e=>{let[r]=e;return{props:{color:r,clickable:!0},style:{["&:hover, &.".concat(nv.focusVisible)]:{backgroundColor:(t.vars||t).palette[r].dark}}}})),{props:{variant:"outlined"},style:{backgroundColor:"transparent",border:t.vars?"1px solid ".concat(t.vars.palette.Chip.defaultBorder):"1px solid ".concat("light"===t.palette.mode?t.palette.grey[400]:t.palette.grey[700]),["&.".concat(nv.clickable,":hover")]:{backgroundColor:(t.vars||t).palette.action.hover},["&.".concat(nv.focusVisible)]:{backgroundColor:(t.vars||t).palette.action.focus},["& .".concat(nv.avatar)]:{marginLeft:4},["& .".concat(nv.avatarSmall)]:{marginLeft:2},["& .".concat(nv.icon)]:{marginLeft:4},["& .".concat(nv.iconSmall)]:{marginLeft:2},["& .".concat(nv.deleteIcon)]:{marginRight:5},["& .".concat(nv.deleteIconSmall)]:{marginRight:3}}},...Object.entries(t.palette).filter(so()).map((e=>{let[r]=e;return{props:{variant:"outlined",color:r},style:{color:(t.vars||t).palette[r].main,border:"1px solid ".concat(t.vars?"rgba(".concat(t.vars.palette[r].mainChannel," / 0.7)"):Dt(t.palette[r].main,.7)),["&.".concat(nv.clickable,":hover")]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette[r].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):Dt(t.palette[r].main,t.palette.action.hoverOpacity)},["&.".concat(nv.focusVisible)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette[r].mainChannel," / ").concat(t.vars.palette.action.focusOpacity,")"):Dt(t.palette[r].main,t.palette.action.focusOpacity)},["& .".concat(nv.deleteIcon)]:{color:t.vars?"rgba(".concat(t.vars.palette[r].mainChannel," / 0.7)"):Dt(t.palette[r].main,.7),"&:hover, &:active":{color:(t.vars||t).palette[r].main}}}}}))]}}))),av=eo("span",{name:"MuiChip",slot:"Label",overridesResolver:(e,t)=>{const{ownerState:r}=e,{size:n}=r;return[t.label,t["label".concat(io(n))]]}})({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",variants:[{props:{variant:"outlined"},style:{paddingLeft:11,paddingRight:11}},{props:{size:"small"},style:{paddingLeft:8,paddingRight:8}},{props:{size:"small",variant:"outlined"},style:{paddingLeft:7,paddingRight:7}}]});function ov(e){return"Backspace"===e.key||"Delete"===e.key}const lv=e.forwardRef((function(t,r){const n=no({props:t,name:"MuiChip"}),{avatar:i,className:a,clickable:o,color:l="default",component:c,deleteIcon:h,disabled:d=!1,icon:f,label:p,onClick:m,onDelete:g,onKeyDown:v,onKeyUp:y,size:b="medium",variant:w="filled",tabIndex:x,skipFocusWhenDisabled:S=!1}=n,_=s(n,iv),C=e.useRef(null),E=Lo(C,r),A=e=>{e.stopPropagation(),g&&g(e)},M=!(!1===o||!m)||o,T=M||g?wp:c||"div",P=u(u({},n),{},{component:T,disabled:d,size:b,color:l,iconColor:e.isValidElement(f)&&f.props.color||l,onDelete:!!g,clickable:M,variant:w}),k=(e=>{const{classes:t,disabled:r,size:n,color:i,iconColor:s,onDelete:a,clickable:o,variant:l}=e;return Na({root:["root",l,r&&"disabled","size".concat(io(n)),"color".concat(io(i)),o&&"clickable",o&&"clickableColor".concat(io(i)),a&&"deletable",a&&"deletableColor".concat(io(i)),"".concat(l).concat(io(i))],label:["label","label".concat(io(n))],avatar:["avatar","avatar".concat(io(n)),"avatarColor".concat(io(i))],icon:["icon","icon".concat(io(n)),"iconColor".concat(io(s))],deleteIcon:["deleteIcon","deleteIcon".concat(io(n)),"deleteIconColor".concat(io(i)),"deleteIcon".concat(io(l),"Color").concat(io(i))]},rv,t)})(P),D=T===wp?u({component:c||"div",focusVisibleClassName:k.focusVisible},g&&{disableRipple:!0}):{};let I=null;g&&(I=h&&e.isValidElement(h)?e.cloneElement(h,{className:ua(h.props.className,k.deleteIcon),onClick:A}):(0,bt.jsx)(tv,{className:ua(k.deleteIcon),onClick:A}));let O=null;i&&e.isValidElement(i)&&(O=e.cloneElement(i,{className:ua(k.avatar,i.props.className)}));let R=null;return f&&e.isValidElement(f)&&(R=e.cloneElement(f,{className:ua(k.icon,f.props.className)})),(0,bt.jsxs)(sv,u(u(u({as:T,className:ua(k.root,a),disabled:!(!M||!d)||void 0,onClick:m,onKeyDown:e=>{e.currentTarget===e.target&&ov(e)&&e.preventDefault(),v&&v(e)},onKeyUp:e=>{e.currentTarget===e.target&&g&&ov(e)&&g(e),y&&y(e)},ref:E,tabIndex:S&&d?-1:x,ownerState:P},D),_),{},{children:[O||R,(0,bt.jsx)(av,{className:ua(k.label),ownerState:P,children:p}),I]}))})),cv=lv,uv=320,hv=["items","changeImportance","isLandscape","onChange","isValid"],dv=["getValue"];function fv(e){const{items:t,changeImportance:r="accept",onChange:n,isValid:s}=e,a=i(e,hv);if(null==t||0===t.length)return null;const o=t.map((e=>{let{getValue:t}=e,a=i(e,dv);const o=t({isValid:s});return ha({},a,{label:a.label,onClick:()=>{n(o,r,a)},disabled:!s(o)})}));return(0,bt.jsx)(ac,ha({dense:!0,sx:[{maxHeight:336,maxWidth:200,overflow:"auto"},...Array.isArray(a.sx)?a.sx:[a.sx]]},a,{children:o.map((e=>{var t;return(0,bt.jsx)(ev,{children:(0,bt.jsx)(cv,ha({},e))},null!==(t=e.id)&&void 0!==t?t:e.label)}))}))}const pv=e=>{var t,r;const{wrapperVariant:n,onAccept:i,onClear:s,onCancel:a,onSetToday:o,view:l,views:c,onViewChange:u,value:h,onChange:d,onSelectShortcut:f,isValid:p,isLandscape:m,disabled:g,readOnly:v,children:y,slots:b,slotProps:w}=e,x=(e=>{const{classes:t,isLandscape:r}=e;return Na({root:["root",r&&"landscape"],contentWrapper:["contentWrapper"],toolbar:["toolbar"],actionBar:["actionBar"],tabs:["tabs"],landscape:["landscape"],shortcuts:["shortcuts"]},Sg,t)})(e),S=null!==(t=null===b||void 0===b?void 0:b.actionBar)&&void 0!==t?t:jg,_=tc({elementType:S,externalSlotProps:null===w||void 0===w?void 0:w.actionBar,additionalProps:{onAccept:i,onClear:s,onCancel:a,onSetToday:o,actions:"desktop"===n?[]:["cancel","accept"]},className:x.actionBar,ownerState:ha({},e,{wrapperVariant:n})}),C=(0,bt.jsx)(S,ha({},_)),E=null===b||void 0===b?void 0:b.toolbar,A=tc({elementType:E,externalSlotProps:null===w||void 0===w?void 0:w.toolbar,additionalProps:{isLandscape:m,onChange:d,value:h,view:l,onViewChange:u,views:c,disabled:g,readOnly:v},className:x.toolbar,ownerState:ha({},e,{wrapperVariant:n})}),M=function(e){return null!==e.view}(A)&&E?(0,bt.jsx)(E,ha({},A)):null,T=y,P=null===b||void 0===b?void 0:b.tabs,k=l&&P?(0,bt.jsx)(P,ha({view:l,onViewChange:u,className:x.tabs},null===w||void 0===w?void 0:w.tabs)):null,D=null!==(r=null===b||void 0===b?void 0:b.shortcuts)&&void 0!==r?r:fv,I=tc({elementType:D,externalSlotProps:null===w||void 0===w?void 0:w.shortcuts,additionalProps:{isValid:p,isLandscape:m,onChange:f},className:x.shortcuts,ownerState:{isValid:p,isLandscape:m,onChange:f,wrapperVariant:n}});return{toolbar:M,content:T,tabs:k,actionBar:C,shortcuts:l&&D?(0,bt.jsx)(D,ha({},I)):null}},mv=eo("div",{name:"MuiPickersLayout",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"grid",gridAutoColumns:"max-content auto max-content",gridAutoRows:"max-content auto max-content",["& .".concat(_g.actionBar)]:{gridColumn:"1 / 4",gridRow:3},variants:[{props:{isLandscape:!0},style:{["& .".concat(_g.toolbar)]:{gridColumn:1,gridRow:"2 / 3"},[".".concat(_g.shortcuts)]:{gridColumn:"2 / 4",gridRow:1}}},{props:{isLandscape:!0,isRtl:!0},style:{["& .".concat(_g.toolbar)]:{gridColumn:3}}},{props:{isLandscape:!1},style:{["& .".concat(_g.toolbar)]:{gridColumn:"2 / 4",gridRow:1},["& .".concat(_g.shortcuts)]:{gridColumn:1,gridRow:"2 / 3"}}},{props:{isLandscape:!1,isRtl:!0},style:{["& .".concat(_g.shortcuts)]:{gridColumn:3}}}]}),gv=eo("div",{name:"MuiPickersLayout",slot:"ContentWrapper",overridesResolver:(e,t)=>t.contentWrapper})({gridColumn:2,gridRow:2,display:"flex",flexDirection:"column"}),vv=e.forwardRef((function(t,r){const n=gd({props:t,name:"MuiPickersLayout"}),{toolbar:i,content:s,tabs:a,actionBar:o,shortcuts:l}=pv(n),{sx:c,className:u,isLandscape:h,wrapperVariant:d}=n,f=(e=>{const{isLandscape:t,classes:r}=e;return Na({root:["root",t&&"landscape"],contentWrapper:["contentWrapper"]},Sg,r)})(n);return(0,bt.jsxs)(mv,{ref:r,sx:c,className:ua(f.root,u),ownerState:n,children:[h?l:i,h?i:l,(0,bt.jsx)(gv,{className:f.contentWrapper,children:"desktop"===d?(0,bt.jsxs)(e.Fragment,{children:[s,a]}):(0,bt.jsxs)(e.Fragment,{children:[a,s]})}),o]})})),yv=e.createContext(null);function bv(e){const{contextValue:t,localeText:r,children:n}=e;return(0,bt.jsx)(yv.Provider,{value:t,children:(0,bt.jsx)(bd,{localeText:r,children:n})})}const wv=["props","getOpenDialogAriaText"],xv=["ownerState"],Sv=["ownerState"],_v=Ah((0,bt.jsx)("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),Cv=Ah((0,bt.jsx)("path",{d:"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"}),"ArrowLeft"),Ev=Ah((0,bt.jsx)("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"ArrowRight"),Av=Ah((0,bt.jsx)("path",{d:"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"}),"Calendar"),Mv=(Ah((0,bt.jsxs)(e.Fragment,{children:[(0,bt.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),(0,bt.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Clock"),Ah((0,bt.jsx)("path",{d:"M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"}),"DateRange"),Ah((0,bt.jsxs)(e.Fragment,{children:[(0,bt.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),(0,bt.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Time"),Ah((0,bt.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear")),Tv=(e,t,r,n)=>{switch(r.type){case"year":return t.fieldYearPlaceholder({digitAmount:e.formatByString(e.date(void 0,"default"),n).length,format:n});case"month":return t.fieldMonthPlaceholder({contentType:r.contentType,format:n});case"day":return t.fieldDayPlaceholder({format:n});case"weekDay":return t.fieldWeekDayPlaceholder({contentType:r.contentType,format:n});case"hours":return t.fieldHoursPlaceholder({format:n});case"minutes":return t.fieldMinutesPlaceholder({format:n});case"seconds":return t.fieldSecondsPlaceholder({format:n});case"meridiem":return t.fieldMeridiemPlaceholder({format:n});default:return n}},Pv=e=>{let{utils:t,date:r,shouldRespectLeadingZeros:n,localeText:i,localizedDigits:s,now:a,token:o,startSeparator:l}=e;if(""===o)throw new Error("MUI X: Should not call `commitToken` with an empty token");const c=Hd(t,o),u=rf(t,c.contentType,c.type,o),h=n?u:"digit"===c.contentType,d=null!=r&&t.isValid(r);let f=d?t.formatByString(r,o):"",p=null;if(h)if(u)p=""===f?t.formatByString(a,o).length:f.length;else{if(null==c.maxLength)throw new Error("MUI X: The token ".concat(o," should have a 'maxDigitNumber' property on it's adapter"));p=c.maxLength,d&&(f=Yd(Qd(Xd(f,s),p),s))}return ha({},c,{format:o,maxLength:p,value:f,placeholder:Tv(t,i,c,o),hasLeadingZerosInFormat:u,hasLeadingZerosInInput:h,startSeparator:l,endSeparator:"",modified:!1})},kv=e=>{let t=(e=>{let{utils:t,format:r}=e,n=10,i=r,s=t.expandFormat(r);for(;s!==i;)if(i=s,s=t.expandFormat(i),n-=1,n<0)throw new Error("MUI X: The format expansion seems to be in an infinite loop. Please open an issue with the format passed to the picker component.");return s})(e);e.isRtl&&e.enableAccessibleFieldDOMStructure&&(t=t.split(" ").reverse().join(" "));const r=(e=>{let{utils:t,expandedFormat:r}=e;const n=[],{start:i,end:s}=t.escapedCharacters,a=new RegExp("(\\".concat(i,"[^\\").concat(s,"]*\\").concat(s,")+"),"g");let o=null;for(;o=a.exec(r);)n.push({start:o.index,end:a.lastIndex-1});return n})(ha({},e,{expandedFormat:t})),n=(e=>{const{utils:t,expandedFormat:r,escapedParts:n}=e,i=t.date(void 0),s=[];let a="";const o=Object.keys(t.formatTokenMap).sort(((e,t)=>t.length-e.length)),l=/^([a-zA-Z]+)/,c=new RegExp("^(".concat(o.join("|"),")*$")),u=new RegExp("^(".concat(o.join("|"),")")),h=e=>n.find((t=>t.start<=e&&t.end>=e));let d=0;for(;d<r.length;){var f;const t=h(d),n=null!=t,o=null===(f=l.exec(r.slice(d)))||void 0===f?void 0:f[1];if(!n&&null!=o&&c.test(o)){let t=o;for(;t.length>0;){const r=u.exec(t)[1];t=t.slice(r.length),s.push(Pv(ha({},e,{now:i,token:r,startSeparator:a}))),a=""}d+=o.length}else{const e=r[d];n&&(null===t||void 0===t?void 0:t.start)===d||(null===t||void 0===t?void 0:t.end)===d||(0===s.length?a+=e:s[s.length-1].endSeparator+=e),d+=1}}return 0===s.length&&a.length>0&&s.push({type:"empty",contentType:"letter",maxLength:null,format:"",value:"",placeholder:"",hasLeadingZerosInFormat:!1,hasLeadingZerosInInput:!1,startSeparator:a,endSeparator:"",modified:!1}),s})(ha({},e,{expandedFormat:t,escapedParts:r}));return(e=>{let{isRtl:t,formatDensity:r,sections:n}=e;return n.map((e=>{const n=e=>{let n=e;return t&&null!==n&&n.includes(" ")&&(n="\u2069".concat(n,"\u2066")),"spacious"===r&&["/",".","-"].includes(n)&&(n=" ".concat(n," ")),n};return e.startSeparator=n(e.startSeparator),e.endSeparator=n(e.endSeparator),e}))})(ha({},e,{sections:n}))},Dv=t=>{const r=vf(),n=Ef(),i=gf(),s=Is(),{valueManager:a,fieldValueManager:o,valueType:l,validator:c,internalProps:u,internalProps:{value:h,defaultValue:d,referenceDate:f,onChange:p,format:m,formatDensity:g="dense",selectedSections:v,onSelectedSectionsChange:y,shouldRespectLeadingZeros:b=!1,timezone:w,enableAccessibleFieldDOMStructure:x=!1}}=t,{timezone:S,value:_,handleValueChange:C}=fg({timezone:w,value:h,defaultValue:d,referenceDate:f,onChange:p,valueManager:a}),E=e.useMemo((()=>(e=>{const t=e.date(void 0);return"0"===e.formatByString(e.setSeconds(t,0),"s")?qd:Array.from({length:10}).map(((r,n)=>e.formatByString(e.setSeconds(t,n),"s")))})(r)),[r]),A=e.useMemo((()=>((e,t,r)=>{const n=e.date(void 0,r),i=e.endOfYear(n),s=e.endOfDay(n),{maxDaysInMonth:a,longestMonth:o}=Id(e,n).reduce(((t,r)=>{const n=e.getDaysInMonth(r);return n>t.maxDaysInMonth?{maxDaysInMonth:n,longestMonth:r}:t}),{maxDaysInMonth:0,longestMonth:null});return{year:t=>{let{format:r}=t;return{minimum:0,maximum:tf(e,r)?9999:99}},month:()=>({minimum:1,maximum:e.getMonth(i)+1}),day:t=>{let{currentDate:r}=t;return{minimum:1,maximum:null!=r&&e.isValid(r)?e.getDaysInMonth(r):a,longestMonth:o}},weekDay:t=>{let{format:r,contentType:n}=t;if("digit"===n){const t=Wd(e,r).map(Number);return{minimum:Math.min(...t),maximum:Math.max(...t)}}return{minimum:1,maximum:7}},hours:r=>{let{format:i}=r;const a=e.getHours(s);return Xd(e.formatByString(e.endOfDay(n),i),t)!==a.toString()?{minimum:1,maximum:Number(Xd(e.formatByString(e.startOfDay(n),i),t))}:{minimum:0,maximum:a}},minutes:()=>({minimum:0,maximum:e.getMinutes(s)}),seconds:()=>({minimum:0,maximum:e.getSeconds(s)}),meridiem:()=>({minimum:0,maximum:1}),empty:()=>({minimum:0,maximum:0})}})(r,E,S)),[r,E,S]),M=e.useCallback((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return o.getSectionsFromValue(r,e,t,(e=>kv({utils:r,localeText:n,localizedDigits:E,format:m,date:e,formatDensity:g,shouldRespectLeadingZeros:b,enableAccessibleFieldDOMStructure:x,isRtl:s})))}),[o,m,n,E,s,b,r,g,x]),[T,P]=e.useState((()=>{const e=M(_);nf();const t={sections:e,value:_,referenceValue:a.emptyValue,tempValueStrAndroid:null},n=(e=>Math.max(...e.map((e=>{var t;return null!==(t=jd[e.type])&&void 0!==t?t:1}))))(e);return ha({},t,{referenceValue:a.getInitialReferenceValue({referenceDate:f,value:_,utils:r,props:u,granularity:n,timezone:S})})})),[k,D]=lh({controlled:v,default:null,name:"useField",state:"selectedSections"}),I=e=>{D(e),null===y||void 0===y||y(e)},O=e.useMemo((()=>of(k,T.sections)),[k,T.sections]),R="all"===O?0:O,L=e=>{let{value:t,referenceValue:n,sections:s}=e;if(P((e=>ha({},e,{sections:s,value:t,referenceValue:n,tempValueStrAndroid:null}))),a.areValuesEqual(r,T.value,t))return;const o={validationError:c({adapter:i,value:t,timezone:S,props:u})};C(t,o)},N=(e,t)=>{const r=[...T.sections];return r[e]=ha({},r[e],{value:t,modified:!0}),r};return e.useEffect((()=>{const e=M(T.value);nf(),P((t=>ha({},t,{sections:e})))}),[m,r.locale,s]),e.useEffect((()=>{let e;e=!a.areValuesEqual(r,T.value,_)||a.getTimezone(r,T.value)!==a.getTimezone(r,_),e&&P((e=>ha({},e,{value:_,referenceValue:o.updateReferenceValue(r,_,e.referenceValue),sections:M(_)})))}),[_]),{state:T,activeSectionIndex:R,parsedSelectedSections:O,setSelectedSections:I,clearValue:()=>{L({value:a.emptyValue,referenceValue:T.referenceValue,sections:M(a.emptyValue)})},clearActiveSection:()=>{if(null==R)return;const e=T.sections[R],t=o.getActiveDateManager(r,T,e),n=t.getSections(T.sections).filter((e=>""!==e.value)).length===(""===e.value?0:1),i=N(R,""),s=n?null:r.getInvalidDate(),a=t.getNewValuesFromNewActiveDate(s);L(ha({},a,{sections:i}))},updateSectionValue:e=>{let{activeSection:t,newSectionValue:n,shouldGoToNextSection:i}=e;i&&R<T.sections.length-1&&I(R+1);const s=o.getActiveDateManager(r,T,t),a=N(R,n),l=s.getSections(a),c=((e,t,r)=>{const n=t.some((e=>"day"===e.type)),i=[],s=[];for(let l=0;l<t.length;l+=1){const e=t[l];n&&"weekDay"===e.type||(i.push(e.format),s.push($d(e,"non-input",r)))}const a=i.join(" "),o=s.join(" ");return e.parse(o,a)})(r,l,E);let u,h;if(null!=c&&r.isValid(c)){const e=af(r,c,l,s.referenceDate,!0);u=s.getNewValuesFromNewActiveDate(e),h=!0}else u=s.getNewValuesFromNewActiveDate(c),h=(null!=c&&!r.isValid(c))!==(null!=s.date&&!r.isValid(s.date));return h?L(ha({},u,{sections:a})):P((e=>ha({},e,u,{sections:a,tempValueStrAndroid:null})))},updateValueFromValueStr:e=>{const t=o.parseValueStr(e,T.referenceValue,((e,t)=>{const i=r.parse(e,m);if(null==i||!r.isValid(i))return null;const a=kv({utils:r,localeText:n,localizedDigits:E,format:m,date:i,formatDensity:g,shouldRespectLeadingZeros:b,enableAccessibleFieldDOMStructure:x,isRtl:s});return af(r,i,a,t,!1)})),i=o.updateReferenceValue(r,t,T.referenceValue);L({value:t,referenceValue:i,sections:M(t,T.sections)})},setTempAndroidValueStr:e=>P((t=>ha({},t,{tempValueStrAndroid:e}))),getSectionsFromValue:M,sectionsValueBoundaries:A,localizedDigits:E,timezone:S}},Iv=e=>null!=e.saveQuery,Ov=t=>{let{sections:r,updateSectionValue:n,sectionsValueBoundaries:i,localizedDigits:s,setTempAndroidValueStr:a,timezone:o}=t;const l=vf(),[c,u]=e.useState(null),h=uu((()=>u(null)));e.useEffect((()=>{var e;null!=c&&(null===(e=r[c.sectionIndex])||void 0===e?void 0:e.type)!==c.sectionType&&h()}),[r,c,h]),e.useEffect((()=>{if(null!=c){const e=setTimeout((()=>h()),5e3);return()=>{clearTimeout(e)}}return()=>{}}),[c,h]);const d=(e,t,n)=>{let{keyPressed:i,sectionIndex:s}=e;const a=i.toLowerCase(),o=r[s];if(null!=c&&(!n||n(c.value))&&c.sectionIndex===s){const e="".concat(c.value).concat(a),r=t(e,o);if(!Iv(r))return u({sectionIndex:s,value:e,sectionType:o.type}),r}const l=t(a,o);return Iv(l)&&!l.saveQuery?(h(),null):(u({sectionIndex:s,value:a,sectionType:o.type}),Iv(l)?null:l)};return{applyCharacterEditing:uu((e=>{const t=r[e.sectionIndex],c=Kd(e.keyPressed,s)?(e=>{const t=(e,t)=>{const r=Xd(e,s),n=Number(r),a=i[t.type]({currentDate:null,format:t.format,contentType:t.contentType});if(n>a.maximum)return{saveQuery:!1};if(n<a.minimum)return{saveQuery:!0};const o=10*n>a.maximum||r.length===a.maximum.toString().length;return{sectionValue:Zd(l,n,a,s,t),shouldGoToNextSection:o}};return d(e,((e,r)=>{if("digit"===r.contentType||"digit-with-letter"===r.contentType)return t(e,r);if("month"===r.type){const n=rf(l,"digit","month","MM"),i=t(e,{type:r.type,format:"MM",hasLeadingZerosInFormat:n,hasLeadingZerosInInput:!0,contentType:"digit",maxLength:2});return Iv(i)?i:ha({},i,{sectionValue:ef(l,i.sectionValue,"MM",r.format)})}if("weekDay"===r.type){const n=t(e,r);return Iv(n)?n:ha({},n,{sectionValue:Wd(l,r.format)[Number(n.sectionValue)-1]})}return{saveQuery:!1}}),(e=>Kd(e,s)))})(ha({},e,{keyPressed:Yd(e.keyPressed,s)})):(e=>{const t=(e,t,r)=>{const n=t.filter((e=>e.toLowerCase().startsWith(r)));return 0===n.length?{saveQuery:!1}:{sectionValue:n[0],shouldGoToNextSection:1===n.length}},r=(e,r,n,i)=>{const s=e=>Gd(l,o,r.type,e);if("letter"===r.contentType)return t(r.format,s(r.format),e);if(n&&null!=i&&"letter"===Hd(l,n).contentType){const r=s(n),a=t(0,r,e);return Iv(a)?{saveQuery:!1}:ha({},a,{sectionValue:i(a.sectionValue,r)})}return{saveQuery:!1}};return d(e,((e,t)=>{switch(t.type){case"month":{const n=e=>ef(l,e,l.formats.month,t.format);return r(e,t,l.formats.month,n)}case"weekDay":{const n=(e,t)=>t.indexOf(e).toString();return r(e,t,l.formats.weekday,n)}case"meridiem":return r(e,t);default:return{saveQuery:!1}}}))})(e);null!=c?n({activeSection:t,newSectionValue:c.sectionValue,shouldGoToNextSection:c.shouldGoToNextSection}):a(null)})),resetCharacterQuery:h}},Rv=t=>{const{internalProps:{disabled:r,readOnly:n=!1},forwardedProps:{sectionListRef:i,onBlur:s,onClick:a,onFocus:o,onInput:l,onPaste:c,focused:u,autoFocus:h=!1},fieldValueManager:d,applyCharacterEditing:f,resetCharacterQuery:p,setSelectedSections:m,parsedSelectedSections:g,state:v,clearActiveSection:y,clearValue:b,updateSectionValue:w,updateValueFromValueStr:x,sectionOrder:S,areAllSectionsEmpty:_,sectionsValueBoundaries:C}=t,E=e.useRef(null),A=xo(i,E),M=Ef(),T=vf(),P=bo(),[k,D]=e.useState(!1),I=e.useMemo((()=>({syncSelectionToDOM:()=>{if(!E.current)return;const e=document.getSelection();if(!e)return;if(null==g)return e.rangeCount>0&&E.current.getRoot().contains(e.getRangeAt(0).startContainer)&&e.removeAllRanges(),void(k&&E.current.getRoot().blur());if(!E.current.getRoot().contains(eg(document)))return;const t=new window.Range;let r;if("all"===g)r=E.current.getRoot();else{r="empty"===v.sections[g].type?E.current.getSectionContainer(g):E.current.getSectionContent(g)}t.selectNodeContents(r),r.focus(),e.removeAllRanges(),e.addRange(t)},getActiveSectionIndexFromDOM:()=>{const e=eg(document);return e&&E.current&&E.current.getRoot().contains(e)?E.current.getSectionIndexFromDOMElement(e):null},focusField:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!E.current)return;const t=of(e,v.sections);D(!0),E.current.getSectionContent(t).focus()},setSelectedSections:e=>{if(!E.current)return;const t=of(e,v.sections);D(null!==("all"===t?0:t)),m(e)},isFieldFocused:()=>{const e=eg(document);return!!E.current&&E.current.getRoot().contains(e)}})),[g,m,v.sections,k]),O=uu((e=>{if(!E.current)return;const t=v.sections[e];E.current.getSectionContent(e).innerHTML=t.value||t.placeholder,I.syncSelectionToDOM()})),R=uu((function(e){if(!e.isDefaultPrevented()&&E.current){D(!0);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(null===a||void 0===a||a(e,...r),"all"===g)setTimeout((()=>{const e=document.getSelection().getRangeAt(0).startOffset;if(0===e)return void m(S.startIndex);let t=0,r=0;for(;r<e&&t<v.sections.length;){const e=v.sections[t];t+=1,r+="".concat(e.startSeparator).concat(e.value||e.placeholder).concat(e.endSeparator).length}m(t-1)}));else if(k){E.current.getRoot().contains(e.target)||m(S.startIndex)}else D(!0),m(S.startIndex)}})),L=uu((e=>{var t;if(null===l||void 0===l||l(e),!E.current||"all"!==g)return;const r=null!==(t=e.target.textContent)&&void 0!==t?t:"";E.current.getRoot().innerHTML=v.sections.map((e=>"".concat(e.startSeparator).concat(e.value||e.placeholder).concat(e.endSeparator))).join(""),I.syncSelectionToDOM(),0===r.length||10===r.charCodeAt(0)?(p(),b(),m("all")):r.length>1?x(r):f({keyPressed:r,sectionIndex:0})})),N=uu((e=>{if(null===c||void 0===c||c(e),n||"all"!==g)return void e.preventDefault();const t=e.clipboardData.getData("text");e.preventDefault(),p(),x(t)})),B=uu((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(null===o||void 0===o||o(...t),k||!E.current)return;D(!0);null!=E.current.getSectionIndexFromDOMElement(eg(document))||m(S.startIndex)})),z=uu((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];null===s||void 0===s||s(...t),setTimeout((()=>{if(!E.current)return;const e=eg(document);!E.current.getRoot().contains(e)&&(D(!1),m(null))}))})),F=uu((e=>t=>{t.isDefaultPrevented()||m(e)})),j=uu((e=>{e.preventDefault()})),U=uu((e=>()=>{m(e)})),V=uu((e=>{if(e.preventDefault(),n||r||"number"!==typeof g)return;const t=v.sections[g],i=e.clipboardData.getData("text"),s=/^[a-zA-Z]+$/.test(i),a=/^[0-9]+$/.test(i),o=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test(i);"letter"===t.contentType&&s||"digit"===t.contentType&&a||"digit-with-letter"===t.contentType&&o?(p(),w({activeSection:t,newSectionValue:i,shouldGoToNextSection:!0})):s||a||(p(),x(i))})),H=uu((e=>{e.preventDefault(),e.dataTransfer.dropEffect="none"})),W=uu((e=>{var t;if(!E.current)return;const r=e.target,i=null!==(t=r.textContent)&&void 0!==t?t:"",s=E.current.getSectionIndexFromDOMElement(r),a=v.sections[s];if(!n&&E.current){if(0===i.length){if(""===a.value)return void O(s);const t=e.nativeEvent.inputType;return"insertParagraph"===t||"insertLineBreak"===t?void O(s):(p(),void y())}f({keyPressed:i,sectionIndex:s}),O(s)}else O(s)}));Co((()=>{if(k&&E.current)if("all"===g)E.current.getRoot().focus();else if("number"===typeof g){const e=E.current.getSectionContent(g);e&&e.focus()}}),[g,k]);const G=e.useMemo((()=>v.sections.reduce(((e,t)=>(e[t.type]=C[t.type]({currentDate:null,contentType:t.contentType,format:t.format}),e)),{})),[C,v.sections]),q="all"===g,X=e.useMemo((()=>v.sections.map(((t,i)=>{const s=!q&&!r&&!n;return{container:{"data-sectionindex":i,onClick:F(i)},content:{tabIndex:q||i>0?-1:0,contentEditable:!q&&!r&&!n,role:"spinbutton",id:"".concat(P,"-").concat(t.type),"aria-labelledby":"".concat(P,"-").concat(t.type),"aria-readonly":n,"aria-valuenow":cf(t,T),"aria-valuemin":G[t.type].minimum,"aria-valuemax":G[t.type].maximum,"aria-valuetext":t.value?lf(t,T):M.empty,"aria-label":M[t.type],"aria-disabled":r,spellCheck:!s&&void 0,autoCapitalize:s?"off":void 0,autoCorrect:s?"off":void 0,[parseInt(e.version,10)>=17?"enterKeyHint":"enterkeyhint"]:s?"next":void 0,children:t.value||t.placeholder,onInput:W,onPaste:V,onFocus:U(i),onDragOver:H,onMouseUp:j,inputMode:"letter"===t.contentType?"text":"numeric"},before:{children:t.startSeparator},after:{children:t.endSeparator}}}))),[v.sections,U,V,H,W,F,j,r,n,q,M,T,G,P]),Y=uu((e=>{x(e.target.value)})),K=e.useMemo((()=>_?"":d.getV7HiddenInputValueFromSections(v.sections)),[_,v.sections,d]);return e.useEffect((()=>{if(null==E.current)throw new Error(["MUI X: The `sectionListRef` prop has not been initialized by `PickersSectionList`","You probably tried to pass a component to the `textField` slot that contains an `<input />` element instead of a `PickersSectionList`.","","If you want to keep using an `<input />` HTML element for the editing, please remove the `enableAccessibleFieldDOMStructure` prop from your picker or field component:","","<DatePicker slots={{ textField: MyCustomTextField }} />","","Learn more about the field accessible DOM structure on the MUI documentation: https://mui.com/x/react-date-pickers/fields/#fields-to-edit-a-single-element"].join("\n"));h&&E.current&&E.current.getSectionContent(S.startIndex).focus()}),[]),{interactions:I,returnedValue:{autoFocus:h,readOnly:n,focused:null!==u&&void 0!==u?u:k,sectionListRef:A,onBlur:z,onClick:R,onFocus:B,onInput:L,onPaste:N,enableAccessibleFieldDOMStructure:!0,elements:X,tabIndex:0===g?-1:0,contentEditable:q,value:K,onChange:Y,areAllSectionsEmpty:_}}},Lv=e=>e.replace(/[\u2066\u2067\u2068\u2069]/g,""),Nv=t=>{const r=Is(),n=e.useRef(),i=e.useRef(),{forwardedProps:{onFocus:s,onClick:a,onPaste:o,onBlur:l,inputRef:c,placeholder:u},internalProps:{readOnly:h=!1,disabled:d=!1},parsedSelectedSections:f,activeSectionIndex:p,state:m,fieldValueManager:g,valueManager:v,applyCharacterEditing:y,resetCharacterQuery:b,updateSectionValue:w,updateValueFromValueStr:x,clearActiveSection:S,clearValue:_,setTempAndroidValueStr:C,setSelectedSections:E,getSectionsFromValue:A,areAllSectionsEmpty:M,localizedDigits:T}=t,P=e.useRef(null),k=xo(c,P),D=e.useMemo((()=>((e,t,r)=>{let n=0,i=r?1:0;const s=[];for(let a=0;a<e.length;a+=1){const o=e[a],l=$d(o,r?"input-rtl":"input-ltr",t),c="".concat(o.startSeparator).concat(l).concat(o.endSeparator),u=Lv(c).length,h=c.length,d=Lv(l),f=i+(""===d?0:l.indexOf(d[0]))+o.startSeparator.length,p=f+d.length;s.push(ha({},o,{start:n,end:n+u,startInInput:f,endInInput:p})),n+=u,i+=h}return s})(m.sections,T,r)),[m.sections,T,r]),I=e.useMemo((()=>({syncSelectionToDOM:()=>{if(!P.current)return;if(null==f)return void(P.current.scrollLeft&&(P.current.scrollLeft=0));if(P.current!==eg(document))return;const e=P.current.scrollTop;if("all"===f)P.current.select();else{const e=D[f],t="empty"===e.type?e.startInInput-e.startSeparator.length:e.startInInput,r="empty"===e.type?e.endInInput+e.endSeparator.length:e.endInInput;t===P.current.selectionStart&&r===P.current.selectionEnd||P.current===eg(document)&&P.current.setSelectionRange(t,r),clearTimeout(i.current),i.current=setTimeout((()=>{!P.current||P.current!==eg(document)||P.current.selectionStart!==P.current.selectionEnd||P.current.selectionStart===t&&P.current.selectionEnd===r||I.syncSelectionToDOM()}))}P.current.scrollTop=e},getActiveSectionIndexFromDOM:()=>{var e,t;const r=null!==(e=P.current.selectionStart)&&void 0!==e?e:0,n=null!==(t=P.current.selectionEnd)&&void 0!==t?t:0;if(0===r&&0===n)return null;const i=r<=D[0].startInInput?1:D.findIndex((e=>e.startInInput-e.startSeparator.length>r));return-1===i?D.length-1:i-1},focusField:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(e=P.current)||void 0===e||e.focus(),E(t)},setSelectedSections:e=>E(e),isFieldFocused:()=>P.current===eg(document)})),[P,f,D,E]),O=()=>{var e;const t=null!==(e=P.current.selectionStart)&&void 0!==e?e:0;let r;r=t<=D[0].startInInput||t>=D[D.length-1].endInInput?1:D.findIndex((e=>e.startInInput-e.startSeparator.length>t));const n=-1===r?D.length-1:r-1;E(n)},R=uu((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];null===s||void 0===s||s(...t);const i=P.current;clearTimeout(n.current),n.current=setTimeout((()=>{i&&i===P.current&&null==p&&(i.value.length&&Number(i.selectionEnd)-Number(i.selectionStart)===i.value.length?E("all"):O())}))})),L=uu((function(e){if(!e.isDefaultPrevented()){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];null===a||void 0===a||a(e,...r),O()}})),N=uu((e=>{if(null===o||void 0===o||o(e),e.preventDefault(),h||d)return;const t=e.clipboardData.getData("text");if("number"===typeof f){const e=m.sections[f],r=/^[a-zA-Z]+$/.test(t),n=/^[0-9]+$/.test(t),i=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test(t);if("letter"===e.contentType&&r||"digit"===e.contentType&&n||"digit-with-letter"===e.contentType&&i)return b(),void w({activeSection:e,newSectionValue:t,shouldGoToNextSection:!0});if(r||n)return}b(),x(t)})),B=uu((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];null===l||void 0===l||l(...t),E(null)})),z=uu((e=>{if(h)return;const t=e.target.value;if(""===t)return b(),void _();const n=e.nativeEvent.data,i=n&&n.length>1,s=i?n:t,a=Lv(s);if(null==p||i)return void x(i?n:a);let o;if("all"===f&&1===a.length)o=a;else{const e=Lv(g.getV6InputValueFromSections(D,T,r));let t=-1,n=-1;for(let r=0;r<e.length;r+=1)-1===t&&e[r]!==a[r]&&(t=r),-1===n&&e[e.length-r-1]!==a[a.length-r-1]&&(n=r);const i=D[p];if(t<i.start||e.length-n-1>i.end)return;const s=a.length-e.length+i.end-Lv(i.endSeparator||"").length;o=a.slice(i.start+Lv(i.startSeparator||"").length,s)}if(0===o.length)return navigator.userAgent.toLowerCase().includes("android")&&C(s),b(),void S();y({keyPressed:o,sectionIndex:p})})),F=e.useMemo((()=>void 0!==u?u:g.getV6InputValueFromSections(A(v.emptyValue),T,r)),[u,g,A,v.emptyValue,T,r]),j=e.useMemo((()=>{var e;return null!==(e=m.tempValueStrAndroid)&&void 0!==e?e:g.getV6InputValueFromSections(m.sections,T,r)}),[m.sections,g,m.tempValueStrAndroid,T,r]);e.useEffect((()=>(P.current&&P.current===eg(document)&&E("all"),()=>{clearTimeout(n.current),clearTimeout(i.current)})),[]);const U=e.useMemo((()=>null==p||"letter"===m.sections[p].contentType?"text":"numeric"),[p,m.sections]),V=P.current&&P.current===eg(document);return{interactions:I,returnedValue:{readOnly:h,onBlur:B,onClick:L,onFocus:R,onPaste:N,inputRef:k,enableAccessibleFieldDOMStructure:!1,placeholder:F,inputMode:U,autoComplete:"off",value:!V&&M?"":j,onChange:z}}},Bv=["value","defaultValue","referenceDate","format","formatDensity","onChange","timezone","onError","shouldRespectLeadingZeros","selectedSections","onSelectedSectionsChange","unstableFieldRef","enableAccessibleFieldDOMStructure","disabled","readOnly","dateSeparator"],zv=t=>{const r=(e=>{var t,r,n;const i=vf(),s=yf();return ha({},e,{disablePast:null!==(t=e.disablePast)&&void 0!==t&&t,disableFuture:null!==(r=e.disableFuture)&&void 0!==r&&r,format:null!==(n=e.format)&&void 0!==n?n:i.formats.keyboardDate,minDate:Dd(i,e.minDate,s.minDate),maxDate:Dd(i,e.maxDate,s.maxDate)})})(t),{forwardedProps:n,internalProps:i}=((t,r)=>e.useMemo((()=>{const e=ha({},t),n={},i=t=>{e.hasOwnProperty(t)&&(n[t]=e[t],delete e[t])};return Bv.forEach(i),"date"===r?If.forEach(i):"time"===r?Of.forEach(i):"date-time"===r&&(If.forEach(i),Of.forEach(i),Rf.forEach(i)),{forwardedProps:e,internalProps:n}}),[t,r]))(r,"date");return(t=>{const r=vf(),{internalProps:n,internalProps:{unstableFieldRef:i,minutesStep:s,enableAccessibleFieldDOMStructure:a=!1,disabled:o=!1,readOnly:l=!1},forwardedProps:{onKeyDown:c,error:u,clearable:h,onClear:d},fieldValueManager:f,valueManager:p,validator:m}=t,g=Is(),v=Dv(t),{state:y,activeSectionIndex:b,parsedSelectedSections:w,setSelectedSections:x,clearValue:S,clearActiveSection:_,updateSectionValue:C,setTempAndroidValueStr:E,sectionsValueBoundaries:A,localizedDigits:M,timezone:T}=v,P=Ov({sections:y.sections,updateSectionValue:C,sectionsValueBoundaries:A,localizedDigits:M,setTempAndroidValueStr:E,timezone:T}),{resetCharacterQuery:k}=P,D=p.areValuesEqual(r,y.value,p.emptyValue),I=a?Rv:Nv,O=e.useMemo((()=>((e,t)=>{const r={};if(!t)return e.forEach(((t,n)=>{const i=0===n?null:n-1,s=n===e.length-1?null:n+1;r[n]={leftIndex:i,rightIndex:s}})),{neighbors:r,startIndex:0,endIndex:e.length-1};const n={},i={};let s=0,a=0,o=e.length-1;for(;o>=0;){a=e.findIndex(((e,t)=>{var r;return t>=s&&(null===(r=e.endSeparator)||void 0===r?void 0:r.includes(" "))&&" / "!==e.endSeparator})),-1===a&&(a=e.length-1);for(let e=a;e>=s;e-=1)i[e]=o,n[o]=e,o-=1;s=a+1}return e.forEach(((t,s)=>{const a=i[s],o=0===a?null:n[a-1],l=a===e.length-1?null:n[a+1];r[s]={leftIndex:o,rightIndex:l}})),{neighbors:r,startIndex:n[0],endIndex:n[e.length-1]}})(y.sections,g&&!a)),[y.sections,g,a]),{returnedValue:R,interactions:L}=I(ha({},t,v,P,{areAllSectionsEmpty:D,sectionOrder:O})),N=uu((e=>{if(null===c||void 0===c||c(e),!o)switch(!0){case(e.ctrlKey||e.metaKey)&&"A"===String.fromCharCode(e.keyCode)&&!e.shiftKey&&!e.altKey:e.preventDefault(),x("all");break;case"ArrowRight"===e.key:if(e.preventDefault(),null==w)x(O.startIndex);else if("all"===w)x(O.endIndex);else{const e=O.neighbors[w].rightIndex;null!==e&&x(e)}break;case"ArrowLeft"===e.key:if(e.preventDefault(),null==w)x(O.endIndex);else if("all"===w)x(O.startIndex);else{const e=O.neighbors[w].leftIndex;null!==e&&x(e)}break;case"Delete"===e.key:if(e.preventDefault(),l)break;null==w||"all"===w?S():_(),k();break;case["ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(e.key):{if(e.preventDefault(),l||null==b)break;const t=y.sections[b],n=f.getActiveDateManager(r,y,t),i=Jd(r,T,t,e.key,A,M,n.date,{minutesStep:s});C({activeSection:t,newSectionValue:i,shouldGoToNextSection:!1});break}}}));Co((()=>{L.syncSelectionToDOM()}));const{hasValidationError:B}=dg({props:n,validator:m,timezone:T,value:y.value,onError:n.onError}),z=e.useMemo((()=>void 0!==u?u:B),[B,u]);e.useEffect((()=>{z||null!=b||k()}),[y.referenceValue,b,z]),e.useEffect((()=>{null!=y.tempValueStrAndroid&&null!=b&&(k(),_())}),[y.sections]),e.useImperativeHandle(i,(()=>({getSections:()=>y.sections,getActiveSectionIndex:L.getActiveSectionIndexFromDOM,setSelectedSections:L.setSelectedSections,focusField:L.focusField,isFieldFocused:L.isFieldFocused})));const F={onKeyDown:N,onClear:uu((function(e){e.preventDefault();for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];null===d||void 0===d||d(e,...r),S(),L.isFieldFocused()?x(O.startIndex):L.focusField(0)})),error:z,clearable:Boolean(h&&!D&&!l&&!o)},j={disabled:o,readOnly:l};return ha({},t.forwardedProps,F,j,R)})({forwardedProps:n,internalProps:i,valueManager:hf,fieldValueManager:df,validator:Bf,valueType:"date"})},Fv=["clearable","onClear","InputProps","sx","slots","slotProps"],jv=["ownerState"];function Uv(e){return ka("MuiPickersTextField",e)}Da("MuiPickersTextField",["root","focused","disabled","error","required"]);function Vv(e){return ka("MuiPickersInputBase",e)}const Hv=Da("MuiPickersInputBase",["root","focused","disabled","error","notchedOutline","sectionContent","sectionBefore","sectionAfter","adornedStart","adornedEnd","input"]);function Wv(e){return ka("MuiPickersOutlinedInput",e)}const Gv=ha({},Hv,Da("MuiPickersOutlinedInput",["root","notchedOutline","input"])),qv=["children","className","label","notched","shrink"],Xv=eo("fieldset",{name:"MuiPickersOutlinedInput",slot:"NotchedOutline",overridesResolver:(e,t)=>t.notchedOutline})((e=>{let{theme:t}=e;const r="light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%",borderColor:t.vars?"rgba(".concat(t.vars.palette.common.onBackgroundChannel," / 0.23)"):r}})),Yv=eo("span")((e=>{let{theme:t}=e;return{fontFamily:t.typography.fontFamily,fontSize:"inherit"}})),Kv=eo("legend")((e=>{let{theme:t}=e;return{float:"unset",width:"auto",overflow:"hidden",variants:[{props:{withLabel:!1},style:{padding:0,lineHeight:"11px",transition:t.transitions.create("width",{duration:150,easing:t.transitions.easing.easeOut})}},{props:{withLabel:!0},style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:t.transitions.create("max-width",{duration:50,easing:t.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:{withLabel:!0,notched:!0},style:{maxWidth:"100%",transition:t.transitions.create("max-width",{duration:100,easing:t.transitions.easing.easeOut,delay:50})}}]}}));function Qv(e){const{className:t,label:r}=e,n=i(e,qv),s=null!=r&&""!==r,a=ha({},e,{withLabel:s});return(0,bt.jsx)(Xv,ha({"aria-hidden":!0,className:t},n,{ownerState:a,children:(0,bt.jsx)(Kv,{ownerState:a,children:s?(0,bt.jsx)(Yv,{children:r}):(0,bt.jsx)(Yv,{className:"notranslate",children:"\u200b"})})}))}const Zv={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function Jv(e){return ka("MuiPickersSectionList",e)}const $v=Da("MuiPickersSectionList",["root","section","sectionContent"]),ey=["slots","slotProps","elements","sectionListRef"],ty=eo("div",{name:"MuiPickersSectionList",slot:"Root",overridesResolver:(e,t)=>t.root})({direction:"ltr /*! @noflip */",outline:"none"}),ry=eo("span",{name:"MuiPickersSectionList",slot:"Section",overridesResolver:(e,t)=>t.section})({}),ny=eo("span",{name:"MuiPickersSectionList",slot:"SectionSeparator",overridesResolver:(e,t)=>t.sectionSeparator})({whiteSpace:"pre"}),iy=eo("span",{name:"MuiPickersSectionList",slot:"SectionContent",overridesResolver:(e,t)=>t.sectionContent})({outline:"none"});function sy(e){var t,r,n;const{slots:i,slotProps:s,element:a,classes:o}=e,l=null!==(t=null===i||void 0===i?void 0:i.section)&&void 0!==t?t:ry,c=tc({elementType:l,externalSlotProps:null===s||void 0===s?void 0:s.section,externalForwardedProps:a.container,className:o.section,ownerState:{}}),u=null!==(r=null===i||void 0===i?void 0:i.sectionContent)&&void 0!==r?r:iy,h=tc({elementType:u,externalSlotProps:null===s||void 0===s?void 0:s.sectionContent,externalForwardedProps:a.content,additionalProps:{suppressContentEditableWarning:!0},className:o.sectionContent,ownerState:{}}),d=null!==(n=null===i||void 0===i?void 0:i.sectionSeparator)&&void 0!==n?n:ny,f=tc({elementType:d,externalSlotProps:null===s||void 0===s?void 0:s.sectionSeparator,externalForwardedProps:a.before,ownerState:{position:"before"}}),p=tc({elementType:d,externalSlotProps:null===s||void 0===s?void 0:s.sectionSeparator,externalForwardedProps:a.after,ownerState:{position:"after"}});return(0,bt.jsxs)(l,ha({},c,{children:[(0,bt.jsx)(d,ha({},f)),(0,bt.jsx)(u,ha({},h)),(0,bt.jsx)(d,ha({},p))]}))}const ay=e.forwardRef((function(t,r){var n;const s=gd({props:t,name:"MuiPickersSectionList"}),{slots:a,slotProps:o,elements:l,sectionListRef:c}=s,u=i(s,ey),h=(e=>{const{classes:t}=e;return Na({root:["root"],section:["section"],sectionContent:["sectionContent"]},Jv,t)})(s),d=e.useRef(null),f=xo(r,d),p=e=>{if(!d.current)throw new Error("MUI X: Cannot call sectionListRef.".concat(e," before the mount of the component."));return d.current};e.useImperativeHandle(c,(()=>({getRoot:()=>p("getRoot"),getSectionContainer:e=>p("getSectionContainer").querySelector(".".concat($v.section,'[data-sectionindex="').concat(e,'"]')),getSectionContent:e=>p("getSectionContent").querySelector(".".concat($v.section,'[data-sectionindex="').concat(e,'"] .').concat($v.sectionContent)),getSectionIndexFromDOMElement(e){const t=p("getSectionIndexFromDOMElement");if(null==e||!t.contains(e))return null;let r=null;return e.classList.contains($v.section)?r=e:e.classList.contains($v.sectionContent)&&(r=e.parentElement),null==r?null:Number(r.dataset.sectionindex)}})));const m=null!==(n=null===a||void 0===a?void 0:a.root)&&void 0!==n?n:ty,g=tc({elementType:m,externalSlotProps:null===o||void 0===o?void 0:o.root,externalForwardedProps:u,additionalProps:{ref:f,suppressContentEditableWarning:!0},className:h.root,ownerState:{}});return(0,bt.jsx)(m,ha({},g,{children:g.contentEditable?l.map((e=>{let{content:t,before:r,after:n}=e;return"".concat(r.children).concat(t.children).concat(n.children)})).join(""):(0,bt.jsx)(e.Fragment,{children:l.map(((e,t)=>(0,bt.jsx)(sy,{slots:a,slotProps:o,element:e,classes:h},t)))})}))})),oy=["elements","areAllSectionsEmpty","defaultValue","label","value","onChange","id","autoFocus","endAdornment","startAdornment","renderSuffix","slots","slotProps","contentEditable","tabIndex","onInput","onPaste","onKeyDown","fullWidth","name","readOnly","inputProps","inputRef","sectionListRef"],ly=eo("div",{name:"MuiPickersInputBase",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{let{theme:t}=e;return ha({},t.typography.body1,{color:(t.vars||t).palette.text.primary,cursor:"text",padding:0,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",boxSizing:"border-box",letterSpacing:"".concat((r=.15/16,Math.round(1e5*r)/1e5),"em"),variants:[{props:{fullWidth:!0},style:{width:"100%"}}]});var r})),cy=eo(ty,{name:"MuiPickersInputBase",slot:"SectionsContainer",overridesResolver:(e,t)=>t.sectionsContainer})((e=>{let{theme:t}=e;return{padding:"4px 0 5px",fontFamily:t.typography.fontFamily,fontSize:"inherit",lineHeight:"1.4375em",flexGrow:1,outline:"none",display:"flex",flexWrap:"nowrap",overflow:"hidden",letterSpacing:"inherit",width:"182px",variants:[{props:{isRtl:!0},style:{textAlign:"right /*! @noflip */"}},{props:{size:"small"},style:{paddingTop:1}},{props:{adornedStart:!1,focused:!1,filled:!1},style:{color:"currentColor",opacity:0}},{props:e=>{let{adornedStart:t,focused:r,filled:n,label:i}=e;return!t&&!r&&!n&&null==i},style:t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:"light"===t.palette.mode?.42:.5}}]}})),uy=eo(ry,{name:"MuiPickersInputBase",slot:"Section",overridesResolver:(e,t)=>t.section})((e=>{let{theme:t}=e;return{fontFamily:t.typography.fontFamily,fontSize:"inherit",letterSpacing:"inherit",lineHeight:"1.4375em",display:"flex"}})),hy=eo(iy,{name:"MuiPickersInputBase",slot:"SectionContent",overridesResolver:(e,t)=>t.content})((e=>{let{theme:t}=e;return{fontFamily:t.typography.fontFamily,lineHeight:"1.4375em",letterSpacing:"inherit",width:"fit-content",outline:"none"}})),dy=eo(ny,{name:"MuiPickersInputBase",slot:"Separator",overridesResolver:(e,t)=>t.separator})((()=>({whiteSpace:"pre",letterSpacing:"inherit"}))),fy=eo("input",{name:"MuiPickersInputBase",slot:"Input",overridesResolver:(e,t)=>t.hiddenInput})(ha({},Zv)),py=e.forwardRef((function(t,r){const n=gd({props:t,name:"MuiPickersInputBase"}),{elements:s,areAllSectionsEmpty:a,value:o,onChange:l,id:c,endAdornment:u,startAdornment:h,renderSuffix:d,slots:f,slotProps:p,contentEditable:m,tabIndex:g,onInput:v,onPaste:y,onKeyDown:b,name:w,readOnly:x,inputProps:S,inputRef:_,sectionListRef:C}=n,E=i(n,oy),A=xo(r,e.useRef(null)),M=xo(null===S||void 0===S?void 0:S.ref,_),T=Is(),P=Ro();if(!P)throw new Error("MUI X: PickersInputBase should always be used inside a PickersTextField component");e.useEffect((()=>{P&&P.setAdornedStart(Boolean(h))}),[P,h]),e.useEffect((()=>{P&&(a?P.onEmpty():P.onFilled())}),[P,a]);const k=ha({},n,P,{isRtl:T}),D=(e=>{const{focused:t,disabled:r,error:n,classes:i,fullWidth:s,readOnly:a,color:o,size:l,endAdornment:c,startAdornment:u}=e;return Na({root:["root",t&&!r&&"focused",r&&"disabled",a&&"readOnly",n&&"error",s&&"fullWidth","color".concat(ar(o)),"small"===l&&"inputSizeSmall",Boolean(u)&&"adornedStart",Boolean(c)&&"adornedEnd"],notchedOutline:["notchedOutline"],input:["input"],sectionsContainer:["sectionsContainer"],sectionContent:["sectionContent"],sectionBefore:["sectionBefore"],sectionAfter:["sectionAfter"]},Vv,i)})(k),I=(null===f||void 0===f?void 0:f.root)||ly,O=tc({elementType:I,externalSlotProps:null===p||void 0===p?void 0:p.root,externalForwardedProps:E,additionalProps:{"aria-invalid":P.error,ref:A},className:D.root,ownerState:k}),R=(null===f||void 0===f?void 0:f.input)||cy;return(0,bt.jsxs)(I,ha({},O,{children:[h,(0,bt.jsx)(ay,{sectionListRef:C,elements:s,contentEditable:m,tabIndex:g,className:D.sectionsContainer,onFocus:e=>{var t;P.disabled?e.stopPropagation():null===(t=P.onFocus)||void 0===t||t.call(P,e)},onBlur:P.onBlur,onInput:v,onPaste:y,onKeyDown:b,slots:{root:R,section:uy,sectionContent:hy,sectionSeparator:dy},slotProps:{root:{ownerState:k},sectionContent:{className:Hv.sectionContent},sectionSeparator:e=>{let{position:t}=e;return{className:"before"===t?Hv.sectionBefore:Hv.sectionAfter}}}}),u,d?d(ha({},P)):null,(0,bt.jsx)(fy,ha({name:w,className:D.input,value:o,onChange:l,id:c,"aria-hidden":"true",tabIndex:-1,readOnly:x,required:P.required,disabled:P.disabled},S,{ref:M}))]}))})),my=["label","autoFocus","ownerState","notched"],gy=eo(ly,{name:"MuiPickersOutlinedInput",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{var t;let{theme:r}=e;const n="light"===r.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{padding:"0 14px",borderRadius:(r.vars||r).shape.borderRadius,["&:hover .".concat(Gv.notchedOutline)]:{borderColor:(r.vars||r).palette.text.primary},"@media (hover: none)":{["&:hover .".concat(Gv.notchedOutline)]:{borderColor:r.vars?"rgba(".concat(r.vars.palette.common.onBackgroundChannel," / 0.23)"):n}},["&.".concat(Gv.focused," .").concat(Gv.notchedOutline)]:{borderStyle:"solid",borderWidth:2},["&.".concat(Gv.disabled)]:{["& .".concat(Gv.notchedOutline)]:{borderColor:(r.vars||r).palette.action.disabled},"*":{color:(r.vars||r).palette.action.disabled}},["&.".concat(Gv.error," .").concat(Gv.notchedOutline)]:{borderColor:(r.vars||r).palette.error.main},variants:Object.keys((null!==(t=r.vars)&&void 0!==t?t:r).palette).filter((e=>{var t,n,i;return null!==(t=null===(n=(null!==(i=r.vars)&&void 0!==i?i:r).palette[e])||void 0===n?void 0:n.main)&&void 0!==t&&t})).map((e=>({props:{color:e},style:{["&.".concat(Gv.focused,":not(.").concat(Gv.error,") .").concat(Gv.notchedOutline)]:{borderColor:(r.vars||r).palette[e].main}}})))}})),vy=eo(cy,{name:"MuiPickersOutlinedInput",slot:"SectionsContainer",overridesResolver:(e,t)=>t.sectionsContainer})({padding:"16.5px 0",variants:[{props:{size:"small"},style:{padding:"8.5px 0"}}]}),yy=e.forwardRef((function(t,r){const n=gd({props:t,name:"MuiPickersOutlinedInput"}),{label:s,ownerState:a,notched:o}=n,l=i(n,my),c=Ro(),u=ha({},n,a,c,{color:(null===c||void 0===c?void 0:c.color)||"primary"}),h=(e=>{const{classes:t}=e;return ha({},t,Na({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},Wv,t))})(u);return(0,bt.jsx)(py,ha({slots:{root:gy,input:vy},renderSuffix:t=>(0,bt.jsx)(Qv,{shrink:Boolean(o||t.adornedStart||t.focused||t.filled),notched:Boolean(o||t.adornedStart||t.focused||t.filled),className:h.notchedOutline,label:null!=s&&""!==s&&null!==c&&void 0!==c&&c.required?(0,bt.jsxs)(e.Fragment,{children:[s,"\u2009","*"]}):s,ownerState:u})},l,{label:s,classes:h,ref:r}))}));function by(e){return ka("MuiPickersFilledInput",e)}yy.muiName="Input";const wy=ha({},Hv,Da("MuiPickersFilledInput",["root","underline","input"])),xy=["label","autoFocus","disableUnderline","ownerState"],Sy=eo(ly,{name:"MuiPickersFilledInput",slot:"Root",overridesResolver:(e,t)=>t.root,shouldForwardProp:e=>Ga(e)&&"disableUnderline"!==e})((e=>{var t;let{theme:r}=e;const n="light"===r.palette.mode,i=n?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",s=n?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",a=n?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",o=n?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{backgroundColor:r.vars?r.vars.palette.FilledInput.bg:s,borderTopLeftRadius:(r.vars||r).shape.borderRadius,borderTopRightRadius:(r.vars||r).shape.borderRadius,transition:r.transitions.create("background-color",{duration:r.transitions.duration.shorter,easing:r.transitions.easing.easeOut}),"&:hover":{backgroundColor:r.vars?r.vars.palette.FilledInput.hoverBg:a,"@media (hover: none)":{backgroundColor:r.vars?r.vars.palette.FilledInput.bg:s}},["&.".concat(wy.focused)]:{backgroundColor:r.vars?r.vars.palette.FilledInput.bg:s},["&.".concat(wy.disabled)]:{backgroundColor:r.vars?r.vars.palette.FilledInput.disabledBg:o},variants:[...Object.keys((null!==(t=r.vars)&&void 0!==t?t:r).palette).filter((e=>{var t;return(null!==(t=r.vars)&&void 0!==t?t:r).palette[e].main})).map((e=>{var t;return{props:{color:e,disableUnderline:!1},style:{"&::after":{borderBottom:"2px solid ".concat(null===(t=(r.vars||r).palette[e])||void 0===t?void 0:t.main)}}}})),{props:{disableUnderline:!1},style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:r.transitions.create("transform",{duration:r.transitions.duration.shorter,easing:r.transitions.easing.easeOut}),pointerEvents:"none"},["&.".concat(wy.focused,":after")]:{transform:"scaleX(1) translateX(0)"},["&.".concat(wy.error)]:{"&:before, &:after":{borderBottomColor:(r.vars||r).palette.error.main}},"&::before":{borderBottom:"1px solid ".concat(r.vars?"rgba(".concat(r.vars.palette.common.onBackgroundChannel," / ").concat(r.vars.opacity.inputUnderline,")"):i),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:r.transitions.create("border-bottom-color",{duration:r.transitions.duration.shorter}),pointerEvents:"none"},["&:hover:not(.".concat(wy.disabled,", .").concat(wy.error,"):before")]:{borderBottom:"1px solid ".concat((r.vars||r).palette.text.primary)},["&.".concat(wy.disabled,":before")]:{borderBottomStyle:"dotted"}}},{props:e=>{let{startAdornment:t}=e;return!!t},style:{paddingLeft:12}},{props:e=>{let{endAdornment:t}=e;return!!t},style:{paddingRight:12}}]}})),_y=eo(cy,{name:"MuiPickersFilledInput",slot:"sectionsContainer",overridesResolver:(e,t)=>t.sectionsContainer})({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:e=>{let{startAdornment:t}=e;return!!t},style:{paddingLeft:0}},{props:e=>{let{endAdornment:t}=e;return!!t},style:{paddingRight:0}},{props:{hiddenLabel:!0},style:{paddingTop:16,paddingBottom:17}},{props:{hiddenLabel:!0,size:"small"},style:{paddingTop:8,paddingBottom:9}}]}),Cy=e.forwardRef((function(e,t){const r=gd({props:e,name:"MuiPickersFilledInput"}),{label:n,disableUnderline:s=!1,ownerState:a}=r,o=i(r,xy),l=Ro(),c=(e=>{const{classes:t,disableUnderline:r}=e;return ha({},t,Na({root:["root",!r&&"underline"],input:["input"]},by,t))})(ha({},r,a,l,{color:(null===l||void 0===l?void 0:l.color)||"primary"}));return(0,bt.jsx)(py,ha({slots:{root:Sy,input:_y},slotProps:{root:{disableUnderline:s}}},o,{label:n,classes:c,ref:t}))}));function Ey(e){return ka("MuiPickersFilledInput",e)}Cy.muiName="Input";const Ay=ha({},Hv,Da("MuiPickersInput",["root","input"])),My=["label","autoFocus","disableUnderline","ownerState"],Ty=eo(ly,{name:"MuiPickersInput",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{var t;let{theme:r}=e;let n="light"===r.palette.mode?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return r.vars&&(n="rgba(".concat(r.vars.palette.common.onBackgroundChannel," / ").concat(r.vars.opacity.inputUnderline,")")),{"label + &":{marginTop:16},variants:[...Object.keys((null!==(t=r.vars)&&void 0!==t?t:r).palette).filter((e=>{var t;return(null!==(t=r.vars)&&void 0!==t?t:r).palette[e].main})).map((e=>({props:{color:e},style:{"&::after":{borderBottom:"2px solid ".concat((r.vars||r).palette[e].main)}}}))),{props:{disableUnderline:!1},style:{"&::after":{background:"red",left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:r.transitions.create("transform",{duration:r.transitions.duration.shorter,easing:r.transitions.easing.easeOut}),pointerEvents:"none"},["&.".concat(Ay.focused,":after")]:{transform:"scaleX(1) translateX(0)"},["&.".concat(Ay.error)]:{"&:before, &:after":{borderBottomColor:(r.vars||r).palette.error.main}},"&::before":{borderBottom:"1px solid ".concat(n),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:r.transitions.create("border-bottom-color",{duration:r.transitions.duration.shorter}),pointerEvents:"none"},["&:hover:not(.".concat(Ay.disabled,", .").concat(Ay.error,"):before")]:{borderBottom:"2px solid ".concat((r.vars||r).palette.text.primary),"@media (hover: none)":{borderBottom:"1px solid ".concat(n)}},["&.".concat(Ay.disabled,":before")]:{borderBottomStyle:"dotted"}}}]}})),Py=e.forwardRef((function(e,t){const r=gd({props:e,name:"MuiPickersInput"}),{label:n,disableUnderline:s=!1,ownerState:a}=r,o=i(r,My),l=Ro(),c=(e=>{const{classes:t,disableUnderline:r}=e;return ha({},t,Na({root:["root",!r&&"underline"],input:["input"]},Ey,t))})(ha({},r,a,l,{disableUnderline:s,color:(null===l||void 0===l?void 0:l.color)||"primary"}));return(0,bt.jsx)(py,ha({slots:{root:Ty}},o,{label:n,classes:c,ref:t}))}));Py.muiName="Input";const ky=["onFocus","onBlur","className","color","disabled","error","variant","required","InputProps","inputProps","inputRef","sectionListRef","elements","areAllSectionsEmpty","onClick","onKeyDown","onKeyUp","onPaste","onInput","endAdornment","startAdornment","tabIndex","contentEditable","focused","value","onChange","fullWidth","id","name","helperText","FormHelperTextProps","label","InputLabelProps"],Dy={standard:Py,filled:Cy,outlined:yy},Iy=eo(Fl,{name:"MuiPickersTextField",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Oy=e.forwardRef((function(t,r){const n=gd({props:t,name:"MuiPickersTextField"}),{onFocus:s,onBlur:a,className:o,color:l="primary",disabled:c=!1,error:u=!1,variant:h="outlined",required:d=!1,InputProps:f,inputProps:p,inputRef:m,sectionListRef:g,elements:v,areAllSectionsEmpty:y,onClick:b,onKeyDown:w,onKeyUp:x,onPaste:S,onInput:_,endAdornment:C,startAdornment:E,tabIndex:A,contentEditable:M,focused:T,value:P,onChange:k,fullWidth:D,id:I,name:O,helperText:R,FormHelperTextProps:L,label:N,InputLabelProps:B}=n,z=i(n,ky),F=xo(r,e.useRef(null)),j=bo(I),U=R&&j?"".concat(j,"-helper-text"):void 0,V=N&&j?"".concat(j,"-label"):void 0,H=ha({},n,{color:l,disabled:c,error:u,focused:T,required:d,variant:h}),W=(e=>{const{focused:t,disabled:r,classes:n,required:i}=e;return Na({root:["root",t&&!r&&"focused",r&&"disabled",i&&"required"]},Uv,n)})(H),G=Dy[h];return(0,bt.jsxs)(Iy,ha({className:ua(W.root,o),ref:F,focused:T,onFocus:s,onBlur:a,disabled:c,variant:h,error:u,color:l,fullWidth:D,required:d,ownerState:H},z,{children:[(0,bt.jsx)(Ol,ha({htmlFor:j,id:V},B,{children:N})),(0,bt.jsx)(G,ha({elements:v,areAllSectionsEmpty:y,onClick:b,onKeyDown:w,onKeyUp:x,onInput:_,onPaste:S,endAdornment:C,startAdornment:E,tabIndex:A,contentEditable:M,value:P,onChange:k,id:j,fullWidth:D,inputProps:p,inputRef:m,sectionListRef:g,label:N,name:O,role:"group","aria-labelledby":V},f)),R&&(0,bt.jsx)(Gl,ha({id:U},L,{children:R}))]}))})),Ry=["enableAccessibleFieldDOMStructure"],Ly=["InputProps","readOnly"],Ny=["onPaste","onKeyDown","inputMode","readOnly","InputProps","inputProps","inputRef"],By=["slots","slotProps","InputProps","inputProps"],zy=e.forwardRef((function(t,r){var n;const s=gd({props:t,name:"MuiDateField"}),{slots:a,slotProps:o,InputProps:l,inputProps:c}=s,u=i(s,By),h=s,d=null!==(n=null===a||void 0===a?void 0:a.textField)&&void 0!==n?n:t.enableAccessibleFieldDOMStructure?Oy:Uh,f=tc({elementType:d,externalSlotProps:null===o||void 0===o?void 0:o.textField,externalForwardedProps:u,additionalProps:{ref:r},ownerState:h});f.inputProps=ha({},c,f.inputProps),f.InputProps=ha({},l,f.InputProps);const p=(e=>{let{enableAccessibleFieldDOMStructure:t}=e,r=i(e,Ry);if(t){const{InputProps:e,readOnly:t}=r;return ha({},i(r,Ly),{InputProps:ha({},null!==e&&void 0!==e?e:{},{readOnly:t})})}const{onPaste:n,onKeyDown:s,inputMode:a,readOnly:o,InputProps:l,inputProps:c,inputRef:u}=r;return ha({},i(r,Ny),{InputProps:ha({},null!==l&&void 0!==l?l:{},{readOnly:o}),inputProps:ha({},null!==c&&void 0!==c?c:{},{inputMode:a,onPaste:n,onKeyDown:s,ref:u})})})(zv(f)),m=(t=>{var r,n;const s=Ef(),{clearable:a,onClear:o,InputProps:l,sx:c,slots:u,slotProps:h}=t,d=i(t,Fv),f=null!==(r=null===u||void 0===u?void 0:u.clearButton)&&void 0!==r?r:Ap,p=i(tc({elementType:f,externalSlotProps:null===h||void 0===h?void 0:h.clearButton,ownerState:{},className:"clearButton",additionalProps:{title:s.fieldClearLabel}}),jv),m=null!==(n=null===u||void 0===u?void 0:u.clearIcon)&&void 0!==n?n:Mv,g=tc({elementType:m,externalSlotProps:null===h||void 0===h?void 0:h.clearIcon,ownerState:{}});return ha({},d,{InputProps:ha({},l,{endAdornment:(0,bt.jsxs)(e.Fragment,{children:[a&&(0,bt.jsx)(Wf,{position:"end",sx:{marginRight:null!==l&&void 0!==l&&l.endAdornment?-1:-1.5},children:(0,bt.jsx)(f,ha({},p,{onClick:o,children:(0,bt.jsx)(m,ha({fontSize:"small"},g))}))}),null===l||void 0===l?void 0:l.endAdornment]})}),sx:[{"& .clearButton":{opacity:1},"@media (pointer: fine)":{"& .clearButton":{opacity:0},"&:hover, &:focus-within":{".clearButton":{opacity:1}}}},...Array.isArray(c)?c:[c]]})})(ha({},p,{slots:a,slotProps:o}));return(0,bt.jsx)(d,ha({},m))})),Fy=t=>{let{shouldDisableDate:r,shouldDisableMonth:n,shouldDisableYear:i,minDate:s,maxDate:a,disableFuture:o,disablePast:l,timezone:c}=t;const u=gf();return e.useCallback((e=>null!==Bf({adapter:u,value:e,timezone:c,props:{shouldDisableDate:r,shouldDisableMonth:n,shouldDisableYear:i,minDate:s,maxDate:a,disableFuture:o,disablePast:l}})),[u,r,n,i,s,a,o,l,c])},jy=t=>{const{value:r,referenceDate:n,disableFuture:i,disablePast:s,disableSwitchToMonthOnDayFocus:a=!1,maxDate:o,minDate:l,onMonthChange:c,reduceAnimations:u,shouldDisableDate:h,timezone:d}=t,f=vf(),p=e.useRef(((e,t,r)=>(n,i)=>{switch(i.type){case"changeMonth":return ha({},n,{slideDirection:i.direction,currentMonth:i.newMonth,isMonthSwitchingAnimating:!e});case"changeMonthTimezone":{const e=i.newTimezone;if(r.getTimezone(n.currentMonth)===e)return n;let t=r.setTimezone(n.currentMonth,e);return r.getMonth(t)!==r.getMonth(n.currentMonth)&&(t=r.setMonth(t,r.getMonth(n.currentMonth))),ha({},n,{currentMonth:t})}case"finishMonthSwitchingAnimation":return ha({},n,{isMonthSwitchingAnimating:!1});case"changeFocusedDay":{if(null!=n.focusedDay&&null!=i.focusedDay&&r.isSameDay(i.focusedDay,n.focusedDay))return n;const s=null!=i.focusedDay&&!t&&!r.isSameMonth(n.currentMonth,i.focusedDay);return ha({},n,{focusedDay:i.focusedDay,isMonthSwitchingAnimating:s&&!e&&!i.withoutMonthSwitchingAnimation,currentMonth:s?r.startOfMonth(i.focusedDay):n.currentMonth,slideDirection:null!=i.focusedDay&&r.isAfterDay(i.focusedDay,n.currentMonth)?"left":"right"})}default:throw new Error("missing support")}})(Boolean(u),a,f)).current,m=e.useMemo((()=>hf.getInitialReferenceValue({value:r,utils:f,timezone:d,props:t,referenceDate:n,granularity:jd.day})),[n,d]),[g,v]=e.useReducer(p,{isMonthSwitchingAnimating:!1,focusedDay:m,currentMonth:f.startOfMonth(m),slideDirection:"left"});e.useEffect((()=>{v({type:"changeMonthTimezone",newTimezone:f.getTimezone(m)})}),[m,f]);const y=e.useCallback((e=>{v(ha({type:"changeMonth"},e)),c&&c(e.newMonth)}),[c]),b=e.useCallback((e=>{const t=e;f.isSameMonth(t,g.currentMonth)||y({newMonth:f.startOfMonth(t),direction:f.isAfterDay(t,g.currentMonth)?"left":"right"})}),[g.currentMonth,y,f]),w=Fy({shouldDisableDate:h,minDate:l,maxDate:o,disableFuture:i,disablePast:s,timezone:d}),x=e.useCallback((()=>{v({type:"finishMonthSwitchingAnimation"})}),[]),S=uu(((e,t)=>{w(e)||v({type:"changeFocusedDay",focusedDay:e,withoutMonthSwitchingAnimation:t})}));return{referenceDate:m,calendarState:g,changeMonth:b,changeFocusedDay:S,isDateDisabled:w,onMonthSwitchingAnimationEnd:x,handleChangeMonth:y}},Uy=e=>ka("MuiPickersFadeTransitionGroup",e),Vy=(Da("MuiPickersFadeTransitionGroup",["root"]),eo(ep,{name:"MuiPickersFadeTransitionGroup",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"block",position:"relative"}));function Hy(e){const t=gd({props:e,name:"MuiPickersFadeTransitionGroup"}),{children:r,className:n,reduceAnimations:i,transKey:s}=t,a=(e=>{const{classes:t}=e;return Na({root:["root"]},Uy,t)})(t),o=Bc();return i?r:(0,bt.jsx)(Vy,{className:ua(a.root,n),children:(0,bt.jsx)(iu,{appear:!1,mountOnEnter:!0,unmountOnExit:!0,timeout:{appear:o.transitions.duration.enteringScreen,enter:o.transitions.duration.enteringScreen,exit:0},children:r},s)})}function Wy(e){return ka("MuiPickersDay",e)}const Gy=Da("MuiPickersDay",["root","dayWithMargin","dayOutsideMonth","hiddenDaySpacingFiller","today","selected","disabled"]),qy=["autoFocus","className","day","disabled","disableHighlightToday","disableMargin","hidden","isAnimating","onClick","onDaySelect","onFocus","onBlur","onKeyDown","onMouseDown","onMouseEnter","outsideCurrentMonth","selected","showDaysOutsideCurrentMonth","children","today","isFirstVisibleCell","isLastVisibleCell"],Xy=e=>{let{theme:t}=e;return ha({},t.typography.caption,{width:36,height:36,borderRadius:"50%",padding:0,backgroundColor:"transparent",transition:t.transitions.create("background-color",{duration:t.transitions.duration.short}),color:(t.vars||t).palette.text.primary,"@media (pointer: fine)":{"&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):Dt(t.palette.primary.main,t.palette.action.hoverOpacity)}},"&:focus":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / ").concat(t.vars.palette.action.focusOpacity,")"):Dt(t.palette.primary.main,t.palette.action.focusOpacity),["&.".concat(Gy.selected)]:{willChange:"background-color",backgroundColor:(t.vars||t).palette.primary.dark}},["&.".concat(Gy.selected)]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.main,fontWeight:t.typography.fontWeightMedium,"&:hover":{willChange:"background-color",backgroundColor:(t.vars||t).palette.primary.dark}},["&.".concat(Gy.disabled,":not(.").concat(Gy.selected,")")]:{color:(t.vars||t).palette.text.disabled},["&.".concat(Gy.disabled,"&.").concat(Gy.selected)]:{opacity:.6},variants:[{props:{disableMargin:!1},style:{margin:"0 ".concat(2,"px")}},{props:{outsideCurrentMonth:!0,showDaysOutsideCurrentMonth:!0},style:{color:(t.vars||t).palette.text.secondary}},{props:{disableHighlightToday:!1,today:!0},style:{["&:not(.".concat(Gy.selected,")")]:{border:"1px solid ".concat((t.vars||t).palette.text.secondary)}}}]})},Yy=(e,t)=>{const{ownerState:r}=e;return[t.root,!r.disableMargin&&t.dayWithMargin,!r.disableHighlightToday&&r.today&&t.today,!r.outsideCurrentMonth&&r.showDaysOutsideCurrentMonth&&t.dayOutsideMonth,r.outsideCurrentMonth&&!r.showDaysOutsideCurrentMonth&&t.hiddenDaySpacingFiller]},Ky=eo(wp,{name:"MuiPickersDay",slot:"Root",overridesResolver:Yy})(Xy),Qy=eo("div",{name:"MuiPickersDay",slot:"Root",overridesResolver:Yy})((e=>{let{theme:t}=e;return ha({},Xy({theme:t}),{opacity:0,pointerEvents:"none"})})),Zy=()=>{},Jy=e.forwardRef((function(t,r){const n=gd({props:t,name:"MuiPickersDay"}),{autoFocus:s=!1,className:a,day:o,disabled:l=!1,disableHighlightToday:c=!1,disableMargin:u=!1,isAnimating:h,onClick:d,onDaySelect:f,onFocus:p=Zy,onBlur:m=Zy,onKeyDown:g=Zy,onMouseDown:v=Zy,onMouseEnter:y=Zy,outsideCurrentMonth:b,selected:w=!1,showDaysOutsideCurrentMonth:x=!1,children:S,today:_=!1}=n,C=i(n,qy),E=ha({},n,{autoFocus:s,disabled:l,disableHighlightToday:c,disableMargin:u,selected:w,showDaysOutsideCurrentMonth:x,today:_}),A=(e=>{const{selected:t,disableMargin:r,disableHighlightToday:n,today:i,disabled:s,outsideCurrentMonth:a,showDaysOutsideCurrentMonth:o,classes:l}=e,c=a&&!o;return Na({root:["root",t&&!c&&"selected",s&&"disabled",!r&&"dayWithMargin",!n&&i&&"today",a&&o&&"dayOutsideMonth",c&&"hiddenDaySpacingFiller"],hiddenDaySpacingFiller:["hiddenDaySpacingFiller"]},Wy,l)})(E),M=vf(),T=e.useRef(null),P=xo(T,r);Co((()=>{!s||l||h||b||T.current.focus()}),[s,l,h,b]);return b&&!x?(0,bt.jsx)(Qy,{className:ua(A.root,A.hiddenDaySpacingFiller,a),ownerState:E,role:C.role}):(0,bt.jsx)(Ky,ha({className:ua(A.root,a),ref:P,centerRipple:!0,disabled:l,tabIndex:w?0:-1,onKeyDown:e=>g(e,o),onFocus:e=>p(e,o),onBlur:e=>m(e,o),onMouseEnter:e=>y(e,o),onClick:e=>{l||f(o),b&&e.currentTarget.focus(),d&&d(e)},onMouseDown:e=>{v(e),b&&e.preventDefault()}},C,{ownerState:E,children:S||M.format(o,"dayOfMonth")}))})),$y=e.memo(Jy);function eb(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}var tb=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return n=t,void((r=e).classList?r.classList.remove(n):"string"===typeof r.className?r.className=eb(r.className,n):r.setAttribute("class",eb(r.className&&r.className.baseVal||"",n)));var r,n}))},rb=function(t){function r(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))||this).appliedClasses={appear:{},enter:{},exit:{}},e.onEnter=function(t,r){var n=e.resolveArguments(t,r),i=n[0],s=n[1];e.removeClasses(i,"exit"),e.addClass(i,s?"appear":"enter","base"),e.props.onEnter&&e.props.onEnter(t,r)},e.onEntering=function(t,r){var n=e.resolveArguments(t,r),i=n[0],s=n[1]?"appear":"enter";e.addClass(i,s,"active"),e.props.onEntering&&e.props.onEntering(t,r)},e.onEntered=function(t,r){var n=e.resolveArguments(t,r),i=n[0],s=n[1]?"appear":"enter";e.removeClasses(i,s),e.addClass(i,s,"done"),e.props.onEntered&&e.props.onEntered(t,r)},e.onExit=function(t){var r=e.resolveArguments(t)[0];e.removeClasses(r,"appear"),e.removeClasses(r,"enter"),e.addClass(r,"exit","base"),e.props.onExit&&e.props.onExit(t)},e.onExiting=function(t){var r=e.resolveArguments(t)[0];e.addClass(r,"exit","active"),e.props.onExiting&&e.props.onExiting(t)},e.onExited=function(t){var r=e.resolveArguments(t)[0];e.removeClasses(r,"exit"),e.addClass(r,"exit","done"),e.props.onExited&&e.props.onExited(t)},e.resolveArguments=function(t,r){return e.props.nodeRef?[e.props.nodeRef.current,t]:[t,r]},e.getClassNames=function(t){var r=e.props.classNames,n="string"===typeof r,i=n?""+(n&&r?r+"-":"")+t:r[t];return{baseClassName:i,activeClassName:n?i+"-active":r[t+"Active"],doneClassName:n?i+"-done":r[t+"Done"]}},e}Cc(r,t);var n=r.prototype;return n.addClass=function(e,t,r){var n=this.getClassNames(t)[r+"ClassName"],i=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===r&&i&&(n+=" "+i),"active"===r&&e&&Tc(e),n&&(this.appliedClasses[t][r]=n,function(e,t){e&&t&&t.split(" ").forEach((function(t){return n=t,void((r=e).classList?r.classList.add(n):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(r,n)||("string"===typeof r.className?r.className=r.className+" "+n:r.setAttribute("class",(r.className&&r.className.baseVal||"")+" "+n)));var r,n}))}(e,n))},n.removeClasses=function(e,t){var r=this.appliedClasses[t],n=r.base,i=r.active,s=r.done;this.appliedClasses[t]={},n&&tb(e,n),i&&tb(e,i),s&&tb(e,s)},n.render=function(){var t=this.props,r=(t.classNames,i(t,["classNames"]));return e.createElement(Nc,ha({},r,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},r}(e.Component);rb.defaultProps={classNames:""},rb.propTypes={};const nb=rb,ib=e=>ka("MuiPickersSlideTransition",e),sb=Da("MuiPickersSlideTransition",["root","slideEnter-left","slideEnter-right","slideEnterActive","slideExit","slideExitActiveLeft-left","slideExitActiveLeft-right"]),ab=["children","className","reduceAnimations","slideDirection","transKey","classes"],ob=eo(ep,{name:"MuiPickersSlideTransition",slot:"Root",overridesResolver:(e,t)=>[t.root,{[".".concat(sb["slideEnter-left"])]:t["slideEnter-left"]},{[".".concat(sb["slideEnter-right"])]:t["slideEnter-right"]},{[".".concat(sb.slideEnterActive)]:t.slideEnterActive},{[".".concat(sb.slideExit)]:t.slideExit},{[".".concat(sb["slideExitActiveLeft-left"])]:t["slideExitActiveLeft-left"]},{[".".concat(sb["slideExitActiveLeft-right"])]:t["slideExitActiveLeft-right"]}]})((e=>{let{theme:t}=e;const r=t.transitions.create("transform",{duration:t.transitions.duration.complex,easing:"cubic-bezier(0.35, 0.8, 0.4, 1)"});return{display:"block",position:"relative",overflowX:"hidden","& > *":{position:"absolute",top:0,right:0,left:0},["& .".concat(sb["slideEnter-left"])]:{willChange:"transform",transform:"translate(100%)",zIndex:1},["& .".concat(sb["slideEnter-right"])]:{willChange:"transform",transform:"translate(-100%)",zIndex:1},["& .".concat(sb.slideEnterActive)]:{transform:"translate(0%)",transition:r},["& .".concat(sb.slideExit)]:{transform:"translate(0%)"},["& .".concat(sb["slideExitActiveLeft-left"])]:{willChange:"transform",transform:"translate(-100%)",transition:r,zIndex:0},["& .".concat(sb["slideExitActiveLeft-right"])]:{willChange:"transform",transform:"translate(100%)",transition:r,zIndex:0}}}));const lb=e=>ka("MuiDayCalendar",e),cb=(Da("MuiDayCalendar",["root","header","weekDayLabel","loadingContainer","slideTransition","monthContainer","weekContainer","weekNumberLabel","weekNumber"]),["parentProps","day","focusableDay","selectedDays","isDateDisabled","currentMonthNumber","isViewFocused"]),ub=["ownerState"],hb=eo("div",{name:"MuiDayCalendar",slot:"Root",overridesResolver:(e,t)=>t.root})({}),db=eo("div",{name:"MuiDayCalendar",slot:"Header",overridesResolver:(e,t)=>t.header})({display:"flex",justifyContent:"center",alignItems:"center"}),fb=eo(go,{name:"MuiDayCalendar",slot:"WeekDayLabel",overridesResolver:(e,t)=>t.weekDayLabel})((e=>{let{theme:t}=e;return{width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(t.vars||t).palette.text.secondary}})),pb=eo(go,{name:"MuiDayCalendar",slot:"WeekNumberLabel",overridesResolver:(e,t)=>t.weekNumberLabel})((e=>{let{theme:t}=e;return{width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:t.palette.text.disabled}})),mb=eo(go,{name:"MuiDayCalendar",slot:"WeekNumber",overridesResolver:(e,t)=>t.weekNumber})((e=>{let{theme:t}=e;return ha({},t.typography.caption,{width:36,height:36,padding:0,margin:"0 ".concat(2,"px"),color:t.palette.text.disabled,fontSize:"0.75rem",alignItems:"center",justifyContent:"center",display:"inline-flex"})})),gb=eo("div",{name:"MuiDayCalendar",slot:"LoadingContainer",overridesResolver:(e,t)=>t.loadingContainer})({display:"flex",justifyContent:"center",alignItems:"center",minHeight:240}),vb=eo((function(t){const r=gd({props:t,name:"MuiPickersSlideTransition"}),{children:n,className:s,reduceAnimations:a,transKey:o}=r,l=i(r,ab),c=(e=>{const{classes:t,slideDirection:r}=e;return Na({root:["root"],exit:["slideExit"],enterActive:["slideEnterActive"],enter:["slideEnter-".concat(r)],exitActive:["slideExitActiveLeft-".concat(r)]},ib,t)})(r),u=Bc();if(a)return(0,bt.jsx)("div",{className:ua(c.root,s),children:n});const h={exit:c.exit,enterActive:c.enterActive,enter:c.enter,exitActive:c.exitActive};return(0,bt.jsx)(ob,{className:ua(c.root,s),childFactory:t=>e.cloneElement(t,{classNames:h}),role:"presentation",children:(0,bt.jsx)(nb,ha({mountOnEnter:!0,unmountOnExit:!0,timeout:u.transitions.duration.complex,classNames:h},l,{children:n}),o)})}),{name:"MuiDayCalendar",slot:"SlideTransition",overridesResolver:(e,t)=>t.slideTransition})({minHeight:240}),yb=eo("div",{name:"MuiDayCalendar",slot:"MonthContainer",overridesResolver:(e,t)=>t.monthContainer})({overflow:"hidden"}),bb=eo("div",{name:"MuiDayCalendar",slot:"WeekContainer",overridesResolver:(e,t)=>t.weekContainer})({margin:"".concat(2,"px 0"),display:"flex",justifyContent:"center"});function wb(t){var r;let{parentProps:n,day:s,focusableDay:a,selectedDays:o,isDateDisabled:l,currentMonthNumber:c,isViewFocused:u}=t,h=i(t,cb);const{disabled:d,disableHighlightToday:f,isMonthSwitchingAnimating:p,showDaysOutsideCurrentMonth:m,slots:g,slotProps:v,timezone:y}=n,b=vf(),w=bf(y),x=null!==a&&b.isSameDay(s,a),S=o.some((e=>b.isSameDay(e,s))),_=b.isSameDay(s,w),C=null!==(r=null===g||void 0===g?void 0:g.day)&&void 0!==r?r:$y,E=i(tc({elementType:C,externalSlotProps:null===v||void 0===v?void 0:v.day,additionalProps:ha({disableHighlightToday:f,showDaysOutsideCurrentMonth:m,role:"gridcell",isAnimating:p,"data-timestamp":b.toJsDate(s).valueOf()},h),ownerState:ha({},n,{day:s,selected:S})}),ub),A=e.useMemo((()=>d||l(s)),[d,l,s]),M=e.useMemo((()=>b.getMonth(s)!==c),[b,s,c]),T=e.useMemo((()=>{const e=b.startOfMonth(b.setMonth(s,c));return m?b.isSameDay(s,b.startOfWeek(e)):b.isSameDay(s,e)}),[c,s,m,b]),P=e.useMemo((()=>{const e=b.endOfMonth(b.setMonth(s,c));return m?b.isSameDay(s,b.endOfWeek(e)):b.isSameDay(s,e)}),[c,s,m,b]);return(0,bt.jsx)(C,ha({},E,{day:s,disabled:A,autoFocus:u&&x,today:_,outsideCurrentMonth:M,isFirstVisibleCell:T,isLastVisibleCell:P,selected:S,tabIndex:x?0:-1,"aria-selected":S,"aria-current":_?"date":void 0}))}function xb(t){const r=gd({props:t,name:"MuiDayCalendar"}),n=vf(),{onFocusedDayChange:i,className:s,currentMonth:a,selectedDays:o,focusedDay:l,loading:c,onSelectedDaysChange:u,onMonthSwitchingAnimationEnd:h,readOnly:d,reduceAnimations:f,renderLoading:p=()=>(0,bt.jsx)("span",{children:"..."}),slideDirection:m,TransitionProps:g,disablePast:v,disableFuture:y,minDate:b,maxDate:w,shouldDisableDate:x,shouldDisableMonth:S,shouldDisableYear:_,dayOfWeekFormatter:C=e=>n.format(e,"weekdayShort").charAt(0).toUpperCase(),hasFocus:E,onFocusedViewChange:A,gridLabelId:M,displayWeekNumber:T,fixedWeekNumber:P,autoFocus:k,timezone:D}=r,I=bf(D),O=(e=>{const{classes:t}=e;return Na({root:["root"],header:["header"],weekDayLabel:["weekDayLabel"],loadingContainer:["loadingContainer"],slideTransition:["slideTransition"],monthContainer:["monthContainer"],weekContainer:["weekContainer"],weekNumberLabel:["weekNumberLabel"],weekNumber:["weekNumber"]},lb,t)})(r),R=Is(),L=Fy({shouldDisableDate:x,shouldDisableMonth:S,shouldDisableYear:_,minDate:b,maxDate:w,disablePast:v,disableFuture:y,timezone:D}),N=Ef(),[B,z]=lh({name:"DayCalendar",state:"hasFocus",controlled:E,default:null!==k&&void 0!==k&&k}),[F,j]=e.useState((()=>l||I)),U=uu((e=>{d||u(e)})),V=e=>{L(e)||(i(e),j(e),null===A||void 0===A||A(!0),z(!0))},H=uu(((e,t)=>{switch(e.key){case"ArrowUp":V(n.addDays(t,-7)),e.preventDefault();break;case"ArrowDown":V(n.addDays(t,7)),e.preventDefault();break;case"ArrowLeft":{const r=n.addDays(t,R?1:-1),i=n.addMonths(t,R?1:-1),s=kd({utils:n,date:r,minDate:R?r:n.startOfMonth(i),maxDate:R?n.endOfMonth(i):r,isDateDisabled:L,timezone:D});V(s||r),e.preventDefault();break}case"ArrowRight":{const r=n.addDays(t,R?-1:1),i=n.addMonths(t,R?-1:1),s=kd({utils:n,date:r,minDate:R?n.startOfMonth(i):r,maxDate:R?r:n.endOfMonth(i),isDateDisabled:L,timezone:D});V(s||r),e.preventDefault();break}case"Home":V(n.startOfWeek(t)),e.preventDefault();break;case"End":V(n.endOfWeek(t)),e.preventDefault();break;case"PageUp":V(n.addMonths(t,1)),e.preventDefault();break;case"PageDown":V(n.addMonths(t,-1)),e.preventDefault()}})),W=uu(((e,t)=>V(t))),G=uu(((e,t)=>{B&&n.isSameDay(F,t)&&(null===A||void 0===A||A(!1))})),q=n.getMonth(a),X=n.getYear(a),Y=e.useMemo((()=>o.filter((e=>!!e)).map((e=>n.startOfDay(e)))),[n,o]),K="".concat(X,"-").concat(q),Q=e.useMemo((()=>e.createRef()),[K]),Z=e.useMemo((()=>{const e=n.startOfMonth(a),t=n.endOfMonth(a);return L(F)||n.isAfterDay(F,t)||n.isBeforeDay(F,e)?kd({utils:n,date:F,minDate:e,maxDate:t,disablePast:v,disableFuture:y,isDateDisabled:L,timezone:D}):F}),[a,y,v,F,L,n,D]),J=e.useMemo((()=>{const e=n.getWeekArray(a);let t=n.addMonths(a,1);for(;P&&e.length<P;){const r=n.getWeekArray(t),i=n.isSameDay(e[e.length-1][0],r[0][0]);r.slice(i?1:0).forEach((t=>{e.length<P&&e.push(t)})),t=n.addMonths(t,1)}return e}),[a,P,n]);return(0,bt.jsxs)(hb,{role:"grid","aria-labelledby":M,className:O.root,children:[(0,bt.jsxs)(db,{role:"row",className:O.header,children:[T&&(0,bt.jsx)(pb,{variant:"caption",role:"columnheader","aria-label":N.calendarWeekNumberHeaderLabel,className:O.weekNumberLabel,children:N.calendarWeekNumberHeaderText}),Bd(n,I).map(((e,t)=>(0,bt.jsx)(fb,{variant:"caption",role:"columnheader","aria-label":n.format(e,"weekday"),className:O.weekDayLabel,children:C(e)},t.toString())))]}),c?(0,bt.jsx)(gb,{className:O.loadingContainer,children:p()}):(0,bt.jsx)(vb,ha({transKey:K,onExited:h,reduceAnimations:f,slideDirection:m,className:ua(s,O.slideTransition)},g,{nodeRef:Q,children:(0,bt.jsx)(yb,{ref:Q,role:"rowgroup",className:O.monthContainer,children:J.map(((e,t)=>(0,bt.jsxs)(bb,{role:"row",className:O.weekContainer,"aria-rowindex":t+1,children:[T&&(0,bt.jsx)(mb,{className:O.weekNumber,role:"rowheader","aria-label":N.calendarWeekNumberAriaLabelText(n.getWeekNumber(e[0])),children:N.calendarWeekNumberText(n.getWeekNumber(e[0]))}),e.map(((e,t)=>(0,bt.jsx)(wb,{parentProps:r,day:e,selectedDays:Y,focusableDay:Z,onKeyDown:H,onFocus:W,onBlur:G,onDaySelect:U,isDateDisabled:L,currentMonthNumber:q,isViewFocused:B,"aria-colindex":t+1},e.toString())))]},"week-".concat(e[0]))))})}))]})}function Sb(e){return ka("MuiPickersMonth",e)}const _b=Da("MuiPickersMonth",["root","monthButton","disabled","selected"]),Cb=["autoFocus","className","children","disabled","selected","value","tabIndex","onClick","onKeyDown","onFocus","onBlur","aria-current","aria-label","monthsPerRow","slots","slotProps"],Eb=eo("div",{name:"MuiPickersMonth",slot:"Root",overridesResolver:(e,t)=>[t.root]})({display:"flex",alignItems:"center",justifyContent:"center",flexBasis:"33.3%",variants:[{props:{monthsPerRow:4},style:{flexBasis:"25%"}}]}),Ab=eo("button",{name:"MuiPickersMonth",slot:"MonthButton",overridesResolver:(e,t)=>[t.monthButton,{["&.".concat(_b.disabled)]:t.disabled},{["&.".concat(_b.selected)]:t.selected}]})((e=>{let{theme:t}=e;return ha({color:"unset",backgroundColor:"transparent",border:0,outline:0},t.typography.subtitle1,{margin:"8px 0",height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.activeChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):Dt(t.palette.action.active,t.palette.action.hoverOpacity)},"&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.activeChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):Dt(t.palette.action.active,t.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},["&.".concat(_b.disabled)]:{color:(t.vars||t).palette.text.secondary},["&.".concat(_b.selected)]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.main,"&:focus, &:hover":{backgroundColor:(t.vars||t).palette.primary.dark}}})})),Mb=e.memo((function(t){var r;const n=gd({props:t,name:"MuiPickersMonth"}),{autoFocus:s,className:a,children:o,disabled:l,selected:c,value:u,tabIndex:h,onClick:d,onKeyDown:f,onFocus:p,onBlur:m,"aria-current":g,"aria-label":v,slots:y,slotProps:b}=n,w=i(n,Cb),x=e.useRef(null),S=(e=>{const{disabled:t,selected:r,classes:n}=e;return Na({root:["root"],monthButton:["monthButton",t&&"disabled",r&&"selected"]},Sb,n)})(n);Co((()=>{var e;s&&(null===(e=x.current)||void 0===e||e.focus())}),[s]);const _=null!==(r=null===y||void 0===y?void 0:y.monthButton)&&void 0!==r?r:Ab,C=tc({elementType:_,externalSlotProps:null===b||void 0===b?void 0:b.monthButton,additionalProps:{children:o,disabled:l,tabIndex:h,ref:x,type:"button",role:"radio","aria-current":g,"aria-checked":c,"aria-label":v,onClick:e=>d(e,u),onKeyDown:e=>f(e,u),onFocus:e=>p(e,u),onBlur:e=>m(e,u)},ownerState:n,className:S.monthButton});return(0,bt.jsx)(Eb,ha({className:ua(S.root,a),ownerState:n},w,{children:(0,bt.jsx)(_,ha({},C))}))}));function Tb(e){return ka("MuiMonthCalendar",e)}Da("MuiMonthCalendar",["root"]);const Pb=["className","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","shouldDisableMonth","readOnly","disableHighlightToday","autoFocus","onMonthFocus","hasFocus","onFocusedViewChange","monthsPerRow","timezone","gridLabelId","slots","slotProps"];const kb=eo("div",{name:"MuiMonthCalendar",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",flexWrap:"wrap",alignContent:"stretch",padding:"0 4px",width:uv,boxSizing:"border-box"}),Db=e.forwardRef((function(t,r){const n=function(e,t){const r=vf(),n=yf(),i=gd({props:e,name:t});return ha({disableFuture:!1,disablePast:!1},i,{minDate:Dd(r,i.minDate,n.minDate),maxDate:Dd(r,i.maxDate,n.maxDate)})}(t,"MuiMonthCalendar"),{className:s,value:a,defaultValue:o,referenceDate:l,disabled:c,disableFuture:u,disablePast:h,maxDate:d,minDate:f,onChange:p,shouldDisableMonth:m,readOnly:g,autoFocus:v=!1,onMonthFocus:y,hasFocus:b,onFocusedViewChange:w,monthsPerRow:x=3,timezone:S,gridLabelId:_,slots:C,slotProps:E}=n,A=i(n,Pb),{value:M,handleValueChange:T,timezone:P}=pg({name:"MonthCalendar",timezone:S,value:a,defaultValue:o,referenceDate:l,onChange:p,valueManager:hf}),k=bf(P),D=Is(),I=vf(),O=e.useMemo((()=>hf.getInitialReferenceValue({value:M,utils:I,props:n,timezone:P,referenceDate:l,granularity:jd.month})),[]),R=n,L=(e=>{const{classes:t}=e;return Na({root:["root"]},Tb,t)})(R),N=e.useMemo((()=>I.getMonth(k)),[I,k]),B=e.useMemo((()=>null!=M?I.getMonth(M):null),[M,I]),[z,F]=e.useState((()=>B||I.getMonth(O))),[j,U]=lh({name:"MonthCalendar",state:"hasFocus",controlled:b,default:null!==v&&void 0!==v&&v}),V=uu((e=>{U(e),w&&w(e)})),H=e.useCallback((e=>{const t=I.startOfMonth(h&&I.isAfter(k,f)?k:f),r=I.startOfMonth(u&&I.isBefore(k,d)?k:d),n=I.startOfMonth(e);return!!I.isBefore(n,t)||(!!I.isAfter(n,r)||!!m&&m(n))}),[u,h,d,f,k,m,I]),W=uu(((e,t)=>{if(g)return;const r=I.setMonth(null!==M&&void 0!==M?M:O,t);T(r)})),G=uu((e=>{H(I.setMonth(null!==M&&void 0!==M?M:O,e))||(F(e),V(!0),y&&y(e))}));e.useEffect((()=>{F((e=>null!==B&&e!==B?B:e))}),[B]);const q=uu(((e,t)=>{const r=12;switch(e.key){case"ArrowUp":G((r+t-3)%r),e.preventDefault();break;case"ArrowDown":G((r+t+3)%r),e.preventDefault();break;case"ArrowLeft":G((r+t+(D?1:-1))%r),e.preventDefault();break;case"ArrowRight":G((r+t+(D?-1:1))%r),e.preventDefault()}})),X=uu(((e,t)=>{G(t)})),Y=uu(((e,t)=>{z===t&&V(!1)}));return(0,bt.jsx)(kb,ha({ref:r,className:ua(L.root,s),ownerState:R,role:"radiogroup","aria-labelledby":_},A,{children:Id(I,null!==M&&void 0!==M?M:O).map((e=>{const t=I.getMonth(e),r=I.format(e,"monthShort"),n=I.format(e,"month"),i=t===B,s=c||H(e);return(0,bt.jsx)(Mb,{selected:i,value:t,onClick:W,onKeyDown:q,autoFocus:j&&t===z,disabled:s,tabIndex:t!==z||s?-1:0,onFocus:X,onBlur:Y,"aria-current":N===t?"date":void 0,"aria-label":n,monthsPerRow:x,slots:C,slotProps:E,children:r},r)}))}))}));function Ib(e){return ka("MuiPickersYear",e)}const Ob=Da("MuiPickersYear",["root","yearButton","selected","disabled"]),Rb=["autoFocus","className","children","disabled","selected","value","tabIndex","onClick","onKeyDown","onFocus","onBlur","aria-current","yearsPerRow","slots","slotProps"],Lb=eo("div",{name:"MuiPickersYear",slot:"Root",overridesResolver:(e,t)=>[t.root]})({display:"flex",alignItems:"center",justifyContent:"center",flexBasis:"33.3%",variants:[{props:{yearsPerRow:4},style:{flexBasis:"25%"}}]}),Nb=eo("button",{name:"MuiPickersYear",slot:"YearButton",overridesResolver:(e,t)=>[t.yearButton,{["&.".concat(Ob.disabled)]:t.disabled},{["&.".concat(Ob.selected)]:t.selected}]})((e=>{let{theme:t}=e;return ha({color:"unset",backgroundColor:"transparent",border:0,outline:0},t.typography.subtitle1,{margin:"6px 0",height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.activeChannel," / ").concat(t.vars.palette.action.focusOpacity,")"):Dt(t.palette.action.active,t.palette.action.focusOpacity)},"&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.activeChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):Dt(t.palette.action.active,t.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},["&.".concat(Ob.disabled)]:{color:(t.vars||t).palette.text.secondary},["&.".concat(Ob.selected)]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.main,"&:focus, &:hover":{backgroundColor:(t.vars||t).palette.primary.dark}}})})),Bb=e.memo((function(t){var r;const n=gd({props:t,name:"MuiPickersYear"}),{autoFocus:s,className:a,children:o,disabled:l,selected:c,value:u,tabIndex:h,onClick:d,onKeyDown:f,onFocus:p,onBlur:m,"aria-current":g,slots:v,slotProps:y}=n,b=i(n,Rb),w=e.useRef(null),x=(e=>{const{disabled:t,selected:r,classes:n}=e;return Na({root:["root"],yearButton:["yearButton",t&&"disabled",r&&"selected"]},Ib,n)})(n);Co((()=>{var e;s&&(null===(e=w.current)||void 0===e||e.focus())}),[s]);const S=null!==(r=null===v||void 0===v?void 0:v.yearButton)&&void 0!==r?r:Nb,_=tc({elementType:S,externalSlotProps:null===y||void 0===y?void 0:y.yearButton,additionalProps:{children:o,disabled:l,tabIndex:h,ref:w,type:"button",role:"radio","aria-current":g,"aria-checked":c,onClick:e=>d(e,u),onKeyDown:e=>f(e,u),onFocus:e=>p(e,u),onBlur:e=>m(e,u)},ownerState:n,className:x.yearButton});return(0,bt.jsx)(Lb,ha({className:ua(x.root,a),ownerState:n},b,{children:(0,bt.jsx)(S,ha({},_))}))}));function zb(e){return ka("MuiYearCalendar",e)}Da("MuiYearCalendar",["root"]);const Fb=["autoFocus","className","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","readOnly","shouldDisableYear","disableHighlightToday","onYearFocus","hasFocus","onFocusedViewChange","yearsOrder","yearsPerRow","timezone","gridLabelId","slots","slotProps"];const jb=eo("div",{name:"MuiYearCalendar",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",flexDirection:"row",flexWrap:"wrap",overflowY:"auto",height:"100%",padding:"0 4px",width:uv,maxHeight:280,boxSizing:"border-box",position:"relative"}),Ub=e.forwardRef((function(t,r){const n=function(e,t){var r;const n=vf(),i=yf(),s=gd({props:e,name:t});return ha({disablePast:!1,disableFuture:!1},s,{yearsPerRow:null!==(r=s.yearsPerRow)&&void 0!==r?r:3,minDate:Dd(n,s.minDate,i.minDate),maxDate:Dd(n,s.maxDate,i.maxDate)})}(t,"MuiYearCalendar"),{autoFocus:s,className:a,value:o,defaultValue:l,referenceDate:c,disabled:u,disableFuture:h,disablePast:d,maxDate:f,minDate:p,onChange:m,readOnly:g,shouldDisableYear:v,onYearFocus:y,hasFocus:b,onFocusedViewChange:w,yearsOrder:x="asc",yearsPerRow:S,timezone:_,gridLabelId:C,slots:E,slotProps:A}=n,M=i(n,Fb),{value:T,handleValueChange:P,timezone:k}=pg({name:"YearCalendar",timezone:_,value:o,defaultValue:l,referenceDate:c,onChange:m,valueManager:hf}),D=bf(k),I=Is(),O=vf(),R=e.useMemo((()=>hf.getInitialReferenceValue({value:T,utils:O,props:n,timezone:k,referenceDate:c,granularity:jd.year})),[]),L=n,N=(e=>{const{classes:t}=e;return Na({root:["root"]},zb,t)})(L),B=e.useMemo((()=>O.getYear(D)),[O,D]),z=e.useMemo((()=>null!=T?O.getYear(T):null),[T,O]),[F,j]=e.useState((()=>z||O.getYear(R))),[U,V]=lh({name:"YearCalendar",state:"hasFocus",controlled:b,default:null!==s&&void 0!==s&&s}),H=uu((e=>{V(e),w&&w(e)})),W=e.useCallback((e=>{if(d&&O.isBeforeYear(e,D))return!0;if(h&&O.isAfterYear(e,D))return!0;if(p&&O.isBeforeYear(e,p))return!0;if(f&&O.isAfterYear(e,f))return!0;if(!v)return!1;const t=O.startOfYear(e);return v(t)}),[h,d,f,p,D,v,O]),G=uu(((e,t)=>{if(g)return;const r=O.setYear(null!==T&&void 0!==T?T:R,t);P(r)})),q=uu((e=>{W(O.setYear(null!==T&&void 0!==T?T:R,e))||(j(e),H(!0),null===y||void 0===y||y(e))}));e.useEffect((()=>{j((e=>null!==z&&e!==z?z:e))}),[z]);const X="desc"!==x?1*S:-1*S,Y=I&&"asc"===x||!I&&"desc"===x?-1:1,K=uu(((e,t)=>{switch(e.key){case"ArrowUp":q(t-X),e.preventDefault();break;case"ArrowDown":q(t+X),e.preventDefault();break;case"ArrowLeft":q(t-Y),e.preventDefault();break;case"ArrowRight":q(t+Y),e.preventDefault()}})),Q=uu(((e,t)=>{q(t)})),Z=uu(((e,t)=>{F===t&&H(!1)})),J=e.useRef(null),$=xo(r,J);e.useEffect((()=>{if(s||null===J.current)return;const e=J.current.querySelector('[tabindex="0"]');if(!e)return;const t=e.offsetHeight,r=e.offsetTop,n=J.current.clientHeight,i=J.current.scrollTop,a=r+t;t>n||r<i||(J.current.scrollTop=a-n/2-t/2)}),[s]);const ee=O.getYearRange([p,f]);return"desc"===x&&ee.reverse(),(0,bt.jsx)(jb,ha({ref:$,className:ua(N.root,a),ownerState:L,role:"radiogroup","aria-labelledby":C},M,{children:ee.map((e=>{const t=O.getYear(e),r=t===z,n=u||W(e);return(0,bt.jsx)(Bb,{selected:r,value:t,onClick:G,onKeyDown:K,autoFocus:U&&t===F,disabled:n,tabIndex:t!==F||n?-1:0,onFocus:Q,onBlur:Z,"aria-current":B===t?"date":void 0,yearsPerRow:S,slots:E,slotProps:A,children:O.format(e,"year")},O.format(e,"year"))}))}))}));function Vb(e){return ka("MuiPickersArrowSwitcher",e)}Da("MuiPickersArrowSwitcher",["root","spacer","button","previousIconButton","nextIconButton","leftArrowIcon","rightArrowIcon"]);const Hb=["children","className","slots","slotProps","isNextDisabled","isNextHidden","onGoToNext","nextLabel","isPreviousDisabled","isPreviousHidden","onGoToPrevious","previousLabel","labelId"],Wb=["ownerState"],Gb=["ownerState"],qb=eo("div",{name:"MuiPickersArrowSwitcher",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex"}),Xb=eo("div",{name:"MuiPickersArrowSwitcher",slot:"Spacer",overridesResolver:(e,t)=>t.spacer})((e=>{let{theme:t}=e;return{width:t.spacing(3)}})),Yb=eo(Ap,{name:"MuiPickersArrowSwitcher",slot:"Button",overridesResolver:(e,t)=>t.button})({variants:[{props:{hidden:!0},style:{visibility:"hidden"}}]}),Kb=e.forwardRef((function(e,t){var r,n,s,a;const o=Is(),l=gd({props:e,name:"MuiPickersArrowSwitcher"}),{children:c,className:u,slots:h,slotProps:d,isNextDisabled:f,isNextHidden:p,onGoToNext:m,nextLabel:g,isPreviousDisabled:v,isPreviousHidden:y,onGoToPrevious:b,previousLabel:w,labelId:x}=l,S=i(l,Hb),_=l,C=(e=>{const{classes:t}=e;return Na({root:["root"],spacer:["spacer"],button:["button"],previousIconButton:["previousIconButton"],nextIconButton:["nextIconButton"],leftArrowIcon:["leftArrowIcon"],rightArrowIcon:["rightArrowIcon"]},Vb,t)})(_),E={isDisabled:f,isHidden:p,goTo:m,label:g},A={isDisabled:v,isHidden:y,goTo:b,label:w},M=null!==(r=null===h||void 0===h?void 0:h.previousIconButton)&&void 0!==r?r:Yb,T=tc({elementType:M,externalSlotProps:null===d||void 0===d?void 0:d.previousIconButton,additionalProps:{size:"medium",title:A.label,"aria-label":A.label,disabled:A.isDisabled,edge:"end",onClick:A.goTo},ownerState:ha({},_,{hidden:A.isHidden}),className:ua(C.button,C.previousIconButton)}),P=null!==(n=null===h||void 0===h?void 0:h.nextIconButton)&&void 0!==n?n:Yb,k=tc({elementType:P,externalSlotProps:null===d||void 0===d?void 0:d.nextIconButton,additionalProps:{size:"medium",title:E.label,"aria-label":E.label,disabled:E.isDisabled,edge:"start",onClick:E.goTo},ownerState:ha({},_,{hidden:E.isHidden}),className:ua(C.button,C.nextIconButton)}),D=null!==(s=null===h||void 0===h?void 0:h.leftArrowIcon)&&void 0!==s?s:Cv,I=i(tc({elementType:D,externalSlotProps:null===d||void 0===d?void 0:d.leftArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:_,className:C.leftArrowIcon}),Wb),O=null!==(a=null===h||void 0===h?void 0:h.rightArrowIcon)&&void 0!==a?a:Ev,R=i(tc({elementType:O,externalSlotProps:null===d||void 0===d?void 0:d.rightArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:_,className:C.rightArrowIcon}),Gb);return(0,bt.jsxs)(qb,ha({ref:t,className:ua(C.root,u),ownerState:_},S,{children:[(0,bt.jsx)(M,ha({},T,{children:o?(0,bt.jsx)(O,ha({},R)):(0,bt.jsx)(D,ha({},I))})),c?(0,bt.jsx)(go,{variant:"subtitle1",component:"span",id:x,children:c}):(0,bt.jsx)(Xb,{className:C.spacer,ownerState:_}),(0,bt.jsx)(P,ha({},k,{children:o?(0,bt.jsx)(D,ha({},I)):(0,bt.jsx)(O,ha({},R))}))]}))}));const Qb=e=>ka("MuiPickersCalendarHeader",e),Zb=Da("MuiPickersCalendarHeader",["root","labelContainer","label","switchViewButton","switchViewIcon"]),Jb=["slots","slotProps","currentMonth","disabled","disableFuture","disablePast","maxDate","minDate","onMonthChange","onViewChange","view","reduceAnimations","views","labelId","className","timezone","format"],$b=["ownerState"],ew=eo("div",{name:"MuiPickersCalendarHeader",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",alignItems:"center",marginTop:12,marginBottom:4,paddingLeft:24,paddingRight:12,maxHeight:40,minHeight:40}),tw=eo("div",{name:"MuiPickersCalendarHeader",slot:"LabelContainer",overridesResolver:(e,t)=>t.labelContainer})((e=>{let{theme:t}=e;return ha({display:"flex",overflow:"hidden",alignItems:"center",cursor:"pointer",marginRight:"auto"},t.typography.body1,{fontWeight:t.typography.fontWeightMedium})})),rw=eo("div",{name:"MuiPickersCalendarHeader",slot:"Label",overridesResolver:(e,t)=>t.label})({marginRight:6}),nw=eo(Ap,{name:"MuiPickersCalendarHeader",slot:"SwitchViewButton",overridesResolver:(e,t)=>t.switchViewButton})({marginRight:"auto",variants:[{props:{view:"year"},style:{[".".concat(Zb.switchViewIcon)]:{transform:"rotate(180deg)"}}}]}),iw=eo(_v,{name:"MuiPickersCalendarHeader",slot:"SwitchViewIcon",overridesResolver:(e,t)=>t.switchViewIcon})((e=>{let{theme:t}=e;return{willChange:"transform",transition:t.transitions.create("transform"),transform:"rotate(0deg)"}})),sw=e.forwardRef((function(t,r){var n,s;const a=Ef(),o=vf(),l=gd({props:t,name:"MuiPickersCalendarHeader"}),{slots:c,slotProps:u,currentMonth:h,disabled:d,disableFuture:f,disablePast:p,maxDate:m,minDate:g,onMonthChange:v,onViewChange:y,view:b,reduceAnimations:w,views:x,labelId:S,className:_,timezone:C,format:E="".concat(o.formats.month," ").concat(o.formats.year)}=l,A=i(l,Jb),M=l,T=(e=>{const{classes:t}=e;return Na({root:["root"],labelContainer:["labelContainer"],label:["label"],switchViewButton:["switchViewButton"],switchViewIcon:["switchViewIcon"]},Qb,t)})(l),P=null!==(n=null===c||void 0===c?void 0:c.switchViewButton)&&void 0!==n?n:nw,k=tc({elementType:P,externalSlotProps:null===u||void 0===u?void 0:u.switchViewButton,additionalProps:{size:"small","aria-label":a.calendarViewSwitchingButtonAriaLabel(b)},ownerState:M,className:T.switchViewButton}),D=null!==(s=null===c||void 0===c?void 0:c.switchViewIcon)&&void 0!==s?s:iw,I=i(tc({elementType:D,externalSlotProps:null===u||void 0===u?void 0:u.switchViewIcon,ownerState:M,className:T.switchViewIcon}),$b),O=function(t,r){let{disableFuture:n,maxDate:i,timezone:s}=r;const a=vf();return e.useMemo((()=>{const e=a.date(void 0,s),r=a.startOfMonth(n&&a.isBefore(e,i)?e:i);return!a.isAfter(r,t)}),[n,i,t,a,s])}(h,{disableFuture:f,maxDate:m,timezone:C}),R=function(t,r){let{disablePast:n,minDate:i,timezone:s}=r;const a=vf();return e.useMemo((()=>{const e=a.date(void 0,s),r=a.startOfMonth(n&&a.isAfter(e,i)?e:i);return!a.isBefore(r,t)}),[n,i,t,a,s])}(h,{disablePast:p,minDate:g,timezone:C});if(1===x.length&&"year"===x[0])return null;const L=o.formatByString(h,E);return(0,bt.jsxs)(ew,ha({},A,{ownerState:M,className:ua(T.root,_),ref:r,children:[(0,bt.jsxs)(tw,{role:"presentation",onClick:()=>{if(1!==x.length&&y&&!d)if(2===x.length)y(x.find((e=>e!==b))||x[0]);else{const e=0!==x.indexOf(b)?0:1;y(x[e])}},ownerState:M,"aria-live":"polite",className:T.labelContainer,children:[(0,bt.jsx)(Hy,{reduceAnimations:w,transKey:L,children:(0,bt.jsx)(rw,{id:S,ownerState:M,className:T.label,children:L})}),x.length>1&&!d&&(0,bt.jsx)(P,ha({},k,{children:(0,bt.jsx)(D,ha({},I))}))]}),(0,bt.jsx)(iu,{in:"day"===b,children:(0,bt.jsx)(Kb,{slots:c,slotProps:u,onGoToPrevious:()=>v(o.addMonths(h,-1),"right"),isPreviousDisabled:R,previousLabel:a.previousMonth,onGoToNext:()=>v(o.addMonths(h,1),"left"),isNextDisabled:O,nextLabel:a.nextMonth})})]}))})),aw=eo("div")({overflow:"hidden",width:uv,maxHeight:336,display:"flex",flexDirection:"column",margin:"0 auto"}),ow=e=>ka("MuiDateCalendar",e),lw=(Da("MuiDateCalendar",["root","viewTransitionContainer"]),["autoFocus","onViewChange","value","defaultValue","referenceDate","disableFuture","disablePast","onChange","onYearChange","onMonthChange","reduceAnimations","shouldDisableDate","shouldDisableMonth","shouldDisableYear","view","views","openTo","className","disabled","readOnly","minDate","maxDate","disableHighlightToday","focusedView","onFocusedViewChange","showDaysOutsideCurrentMonth","fixedWeekNumber","dayOfWeekFormatter","slots","slotProps","loading","renderLoading","displayWeekNumber","yearsOrder","yearsPerRow","monthsPerRow","timezone"]);const cw=eo(aw,{name:"MuiDateCalendar",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",flexDirection:"column",height:336}),uw=eo(Hy,{name:"MuiDateCalendar",slot:"ViewTransitionContainer",overridesResolver:(e,t)=>t.viewTransitionContainer})({}),hw=e.forwardRef((function(t,r){var n;const s=vf(),a=bo(),o=function(e,t){var r,n,i,s,a,o,l;const c=vf(),u=yf(),h=ag(),d=gd({props:e,name:t});return ha({},d,{loading:null!==(r=d.loading)&&void 0!==r&&r,disablePast:null!==(n=d.disablePast)&&void 0!==n&&n,disableFuture:null!==(i=d.disableFuture)&&void 0!==i&&i,openTo:null!==(s=d.openTo)&&void 0!==s?s:"day",views:null!==(a=d.views)&&void 0!==a?a:["year","day"],reduceAnimations:null!==(o=d.reduceAnimations)&&void 0!==o?o:h,renderLoading:null!==(l=d.renderLoading)&&void 0!==l?l:()=>(0,bt.jsx)("span",{children:"..."}),minDate:Dd(c,d.minDate,u.minDate),maxDate:Dd(c,d.maxDate,u.maxDate)})}(t,"MuiDateCalendar"),{autoFocus:l,onViewChange:c,value:u,defaultValue:h,referenceDate:d,disableFuture:f,disablePast:p,onChange:m,onYearChange:g,onMonthChange:v,reduceAnimations:y,shouldDisableDate:b,shouldDisableMonth:w,shouldDisableYear:x,view:S,views:_,openTo:C,className:E,disabled:A,readOnly:M,minDate:T,maxDate:P,disableHighlightToday:k,focusedView:D,onFocusedViewChange:I,showDaysOutsideCurrentMonth:O,fixedWeekNumber:R,dayOfWeekFormatter:L,slots:N,slotProps:B,loading:z,renderLoading:F,displayWeekNumber:j,yearsOrder:U,yearsPerRow:V,monthsPerRow:H,timezone:W}=o,G=i(o,lw),{value:q,handleValueChange:X,timezone:Y}=pg({name:"DateCalendar",timezone:W,value:u,defaultValue:h,referenceDate:d,onChange:m,valueManager:hf}),{view:K,setView:Q,focusedView:Z,setFocusedView:J,goToNextView:$,setValueAndGoToNextView:ee}=gg({view:S,views:_,openTo:C,onChange:X,onViewChange:c,autoFocus:l,focusedView:D,onFocusedViewChange:I}),{referenceDate:te,calendarState:re,changeFocusedDay:ne,changeMonth:ie,handleChangeMonth:se,isDateDisabled:ae,onMonthSwitchingAnimationEnd:oe}=jy({value:q,referenceDate:d,reduceAnimations:y,onMonthChange:v,minDate:T,maxDate:P,shouldDisableDate:b,disablePast:p,disableFuture:f,timezone:Y}),le=A&&q||T,ce=A&&q||P,ue="".concat(a,"-grid-label"),he=null!==Z,de=null!==(n=null===N||void 0===N?void 0:N.calendarHeader)&&void 0!==n?n:sw,fe=tc({elementType:de,externalSlotProps:null===B||void 0===B?void 0:B.calendarHeader,additionalProps:{views:_,view:K,currentMonth:re.currentMonth,onViewChange:Q,onMonthChange:(e,t)=>se({newMonth:e,direction:t}),minDate:le,maxDate:ce,disabled:A,disablePast:p,disableFuture:f,reduceAnimations:y,timezone:Y,labelId:ue},ownerState:o}),pe=uu((e=>{const t=s.startOfMonth(e),r=s.endOfMonth(e),n=ae(e)?kd({utils:s,date:e,minDate:s.isBefore(T,t)?t:T,maxDate:s.isAfter(P,r)?r:P,disablePast:p,disableFuture:f,isDateDisabled:ae,timezone:Y}):e;n?(ee(n,"finish"),null===v||void 0===v||v(t)):($(),ie(t)),ne(n,!0)})),me=uu((e=>{const t=s.startOfYear(e),r=s.endOfYear(e),n=ae(e)?kd({utils:s,date:e,minDate:s.isBefore(T,t)?t:T,maxDate:s.isAfter(P,r)?r:P,disablePast:p,disableFuture:f,isDateDisabled:ae,timezone:Y}):e;n?(ee(n,"finish"),null===g||void 0===g||g(n)):($(),ie(t)),ne(n,!0)})),ge=uu((e=>X(e?Pd(s,e,null!==q&&void 0!==q?q:te):e,"finish",K)));e.useEffect((()=>{null!=q&&s.isValid(q)&&ie(q)}),[q]);const ve=o,ye=(e=>{const{classes:t}=e;return Na({root:["root"],viewTransitionContainer:["viewTransitionContainer"]},ow,t)})(ve),be={disablePast:p,disableFuture:f,maxDate:P,minDate:T},we={disableHighlightToday:k,readOnly:M,disabled:A,timezone:Y,gridLabelId:ue,slots:N,slotProps:B},xe=e.useRef(K);e.useEffect((()=>{xe.current!==K&&(Z===xe.current&&J(K,!0),xe.current=K)}),[Z,J,K]);const Se=e.useMemo((()=>[q]),[q]);return(0,bt.jsxs)(cw,ha({ref:r,className:ua(ye.root,E),ownerState:ve},G,{children:[(0,bt.jsx)(de,ha({},fe,{slots:N,slotProps:B})),(0,bt.jsx)(uw,{reduceAnimations:y,className:ye.viewTransitionContainer,transKey:K,ownerState:ve,children:(0,bt.jsxs)("div",{children:["year"===K&&(0,bt.jsx)(Ub,ha({},be,we,{value:q,onChange:me,shouldDisableYear:x,hasFocus:he,onFocusedViewChange:e=>J("year",e),yearsOrder:U,yearsPerRow:V,referenceDate:te})),"month"===K&&(0,bt.jsx)(Db,ha({},be,we,{hasFocus:he,className:E,value:q,onChange:pe,shouldDisableMonth:w,onFocusedViewChange:e=>J("month",e),monthsPerRow:H,referenceDate:te})),"day"===K&&(0,bt.jsx)(xb,ha({},re,be,we,{onMonthSwitchingAnimationEnd:oe,onFocusedDayChange:ne,reduceAnimations:y,selectedDays:Se,onSelectedDaysChange:ge,shouldDisableDate:b,shouldDisableMonth:w,shouldDisableYear:x,hasFocus:he,onFocusedViewChange:e=>J("day",e),showDaysOutsideCurrentMonth:O,fixedWeekNumber:R,dayOfWeekFormatter:L,displayWeekNumber:j,loading:z,renderLoading:F}))]})})]}))})),dw=e=>{let{view:t,onViewChange:r,views:n,focusedView:i,onFocusedViewChange:s,value:a,defaultValue:o,referenceDate:l,onChange:c,className:u,classes:h,disableFuture:d,disablePast:f,minDate:p,maxDate:m,shouldDisableDate:g,shouldDisableMonth:v,shouldDisableYear:y,reduceAnimations:b,onMonthChange:w,monthsPerRow:x,onYearChange:S,yearsOrder:_,yearsPerRow:C,slots:E,slotProps:A,loading:M,renderLoading:T,disableHighlightToday:P,readOnly:k,disabled:D,showDaysOutsideCurrentMonth:I,dayOfWeekFormatter:O,sx:R,autoFocus:L,fixedWeekNumber:N,displayWeekNumber:B,timezone:z}=e;return(0,bt.jsx)(hw,{view:t,onViewChange:r,views:n.filter(Ld),focusedView:i&&Ld(i)?i:null,onFocusedViewChange:s,value:a,defaultValue:o,referenceDate:l,onChange:c,className:u,classes:h,disableFuture:d,disablePast:f,minDate:p,maxDate:m,shouldDisableDate:g,shouldDisableMonth:v,shouldDisableYear:y,reduceAnimations:b,onMonthChange:w,monthsPerRow:x,onYearChange:S,yearsOrder:_,yearsPerRow:C,slots:E,slotProps:A,loading:M,renderLoading:T,disableHighlightToday:P,readOnly:k,disabled:D,showDaysOutsideCurrentMonth:I,dayOfWeekFormatter:O,sx:R,autoFocus:L,fixedWeekNumber:N,displayWeekNumber:B,timezone:z})},fw=e.forwardRef((function(t,r){var n,s,a;const o=Ef(),l=vf(),c=Df(t,"MuiDesktopDatePicker"),u=ha({day:dw,month:dw,year:dw},c.viewRenderers),h=ha({},c,{viewRenderers:u,format:Nd(l,c,!1),yearsPerRow:null!==(n=c.yearsPerRow)&&void 0!==n?n:4,slots:ha({openPickerIcon:Av,field:zy},c.slots),slotProps:ha({},c.slotProps,{field:e=>{var t;return ha({},$l(null===(t=c.slotProps)||void 0===t?void 0:t.field,e),Nf(c),{ref:r})},toolbar:ha({hidden:!0},null===(s=c.slotProps)||void 0===s?void 0:s.toolbar)})}),{renderPicker:d}=(t=>{var r,n,s,a,o;let{props:l,getOpenDialogAriaText:c}=t,u=i(t,wv);const{slots:h,slotProps:d,className:f,sx:p,format:m,formatDensity:g,enableAccessibleFieldDOMStructure:v,selectedSections:y,onSelectedSectionsChange:b,timezone:w,name:x,label:S,inputRef:_,readOnly:C,disabled:E,autoFocus:A,localeText:M,reduceAnimations:T}=l,P=e.useRef(null),k=e.useRef(null),D=bo(),I=null!==(r=null===d||void 0===d||null===(n=d.toolbar)||void 0===n?void 0:n.hidden)&&void 0!==r&&r,{open:O,actions:R,hasUIView:L,layoutProps:N,renderCurrentView:B,shouldRestoreFocus:z,fieldProps:F,contextValue:j,ownerState:U}=xg(ha({},u,{props:l,fieldRef:k,autoFocusView:!0,additionalViewProps:{},wrapperVariant:"desktop"})),V=null!==(s=h.inputAdornment)&&void 0!==s?s:Wf,H=i(tc({elementType:V,externalSlotProps:null===d||void 0===d?void 0:d.inputAdornment,additionalProps:{position:"end"},ownerState:l}),xv),W=null!==(a=h.openPickerButton)&&void 0!==a?a:Ap,G=i(tc({elementType:W,externalSlotProps:null===d||void 0===d?void 0:d.openPickerButton,additionalProps:{disabled:E||C,onClick:O?R.onClose:R.onOpen,"aria-label":c(F.value),edge:H.position},ownerState:l}),Sv),q=h.openPickerIcon,X=tc({elementType:q,externalSlotProps:null===d||void 0===d?void 0:d.openPickerIcon,ownerState:U}),Y=h.field,K=tc({elementType:Y,externalSlotProps:null===d||void 0===d?void 0:d.field,additionalProps:ha({},F,I&&{id:D},{readOnly:C,disabled:E,className:f,sx:p,format:m,formatDensity:g,enableAccessibleFieldDOMStructure:v,selectedSections:y,onSelectedSectionsChange:b,timezone:w,label:S,name:x,autoFocus:A&&!l.open,focused:!!O||void 0},_?{inputRef:_}:{}),ownerState:l});L&&(K.InputProps=ha({},K.InputProps,{ref:P},!l.disableOpenPicker&&{["".concat(H.position,"Adornment")]:(0,bt.jsx)(V,ha({},H,{children:(0,bt.jsx)(W,ha({},G,{children:(0,bt.jsx)(q,ha({},X))}))}))}));const Q=ha({textField:h.textField,clearIcon:h.clearIcon,clearButton:h.clearButton},K.slots),Z=null!==(o=h.layout)&&void 0!==o?o:vv;let J=D;I&&(J=S?"".concat(D,"-label"):void 0);const $=ha({},d,{toolbar:ha({},null===d||void 0===d?void 0:d.toolbar,{titleId:D}),popper:ha({"aria-labelledby":J},null===d||void 0===d?void 0:d.popper)}),ee=xo(k,K.unstableFieldRef);return{renderPicker:()=>(0,bt.jsxs)(bv,{contextValue:j,localeText:M,children:[(0,bt.jsx)(Y,ha({},K,{slots:Q,slotProps:$,unstableFieldRef:ee})),(0,bt.jsx)(hg,ha({role:"dialog",placement:"bottom-start",anchorEl:P.current},R,{open:O,slots:h,slotProps:$,shouldRestoreFocus:z,reduceAnimations:T,children:(0,bt.jsx)(Z,ha({},N,null===$||void 0===$?void 0:$.layout,{slots:h,slotProps:$,children:B()}))}))]})}})({props:h,valueManager:hf,valueType:"date",getOpenDialogAriaText:ff({utils:l,formatKey:"fullDate",contextTranslation:o.openDatePickerDialogue,propsTranslation:null===(a=h.localeText)||void 0===a?void 0:a.openDatePickerDialogue}),validator:Bf});return d()}));function pw(e){return ka("MuiDialogContent",e)}fw.propTypes={autoFocus:Ad().bool,className:Ad().string,closeOnSelect:Ad().bool,dayOfWeekFormatter:Ad().func,defaultValue:Ad().object,disabled:Ad().bool,disableFuture:Ad().bool,disableHighlightToday:Ad().bool,disableOpenPicker:Ad().bool,disablePast:Ad().bool,displayWeekNumber:Ad().bool,enableAccessibleFieldDOMStructure:Ad().any,fixedWeekNumber:Ad().number,format:Ad().string,formatDensity:Ad().oneOf(["dense","spacious"]),inputRef:Md,label:Ad().node,loading:Ad().bool,localeText:Ad().object,maxDate:Ad().object,minDate:Ad().object,monthsPerRow:Ad().oneOf([3,4]),name:Ad().string,onAccept:Ad().func,onChange:Ad().func,onClose:Ad().func,onError:Ad().func,onMonthChange:Ad().func,onOpen:Ad().func,onSelectedSectionsChange:Ad().func,onViewChange:Ad().func,onYearChange:Ad().func,open:Ad().bool,openTo:Ad().oneOf(["day","month","year"]),orientation:Ad().oneOf(["landscape","portrait"]),readOnly:Ad().bool,reduceAnimations:Ad().bool,referenceDate:Ad().object,renderLoading:Ad().func,selectedSections:Ad().oneOfType([Ad().oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),Ad().number]),shouldDisableDate:Ad().func,shouldDisableMonth:Ad().func,shouldDisableYear:Ad().func,showDaysOutsideCurrentMonth:Ad().bool,slotProps:Ad().object,slots:Ad().object,sx:Ad().oneOfType([Ad().arrayOf(Ad().oneOfType([Ad().func,Ad().object,Ad().bool])),Ad().func,Ad().object]),timezone:Ad().string,value:Ad().object,view:Ad().oneOf(["day","month","year"]),viewRenderers:Ad().shape({day:Ad().func,month:Ad().func,year:Ad().func}),views:Ad().arrayOf(Ad().oneOf(["day","month","year"]).isRequired),yearsOrder:Ad().oneOf(["asc","desc"]),yearsPerRow:Ad().oneOf([3,4])};Da("MuiDialogContent",["root","dividers"]);const mw=Da("MuiDialogTitle",["root"]),gw=["className","dividers"],vw=eo("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.dividers&&t.dividers]}})(ro((e=>{let{theme:t}=e;return{flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:e=>{let{ownerState:t}=e;return t.dividers},style:{padding:"16px 24px",borderTop:"1px solid ".concat((t.vars||t).palette.divider),borderBottom:"1px solid ".concat((t.vars||t).palette.divider)}},{props:e=>{let{ownerState:t}=e;return!t.dividers},style:{[".".concat(mw.root," + &")]:{paddingTop:0}}}]}}))),yw=e.forwardRef((function(e,t){const r=no({props:e,name:"MuiDialogContent"}),{className:n,dividers:i=!1}=r,a=s(r,gw),o=u(u({},r),{},{dividers:i}),l=(e=>{const{classes:t,dividers:r}=e;return Na({root:["root",r&&"dividers"]},pw,t)})(o);return(0,bt.jsx)(vw,u({className:ua(l.root,n),ownerState:o,ref:t},a))}));function bw(e){return ka("MuiDialog",e)}const ww=Da("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]);const xw=e.createContext({}),Sw=["aria-describedby","aria-labelledby","aria-modal","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],_w=eo(cu,{name:"MuiDialog",slot:"Backdrop",overrides:(e,t)=>t.backdrop})({zIndex:-1}),Cw=eo(Eu,{name:"MuiDialog",slot:"Root",overridesResolver:(e,t)=>t.root})({"@media print":{position:"absolute !important"}}),Ew=eo("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.container,t["scroll".concat(io(r.scroll))]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),Aw=eo(ku,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.paper,t["scrollPaper".concat(io(r.scroll))],t["paperWidth".concat(io(String(r.maxWidth)))],r.fullWidth&&t.paperFullWidth,r.fullScreen&&t.paperFullScreen]}})(ro((e=>{let{theme:t}=e;return{margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:e=>{let{ownerState:t}=e;return!t.maxWidth},style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:"px"===t.breakpoints.unit?Math.max(t.breakpoints.values.xs,444):"max(".concat(t.breakpoints.values.xs).concat(t.breakpoints.unit,", 444px)"),["&.".concat(ww.paperScrollBody)]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(t.breakpoints.values).filter((e=>"xs"!==e)).map((e=>({props:{maxWidth:e},style:{maxWidth:"".concat(t.breakpoints.values[e]).concat(t.breakpoints.unit),["&.".concat(ww.paperScrollBody)]:{[t.breakpoints.down(t.breakpoints.values[e]+64)]:{maxWidth:"calc(100% - 64px)"}}}}))),{props:e=>{let{ownerState:t}=e;return t.fullWidth},style:{width:"calc(100% - 64px)"}},{props:e=>{let{ownerState:t}=e;return t.fullScreen},style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,["&.".concat(ww.paperScrollBody)]:{margin:0,maxWidth:"100%"}}}]}}))),Mw=e.forwardRef((function(t,r){const n=no({props:t,name:"MuiDialog"}),i=Bc(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{"aria-describedby":o,"aria-labelledby":l,"aria-modal":c=!0,BackdropComponent:h,BackdropProps:d,children:f,className:p,disableEscapeKeyDown:m=!1,fullScreen:g=!1,fullWidth:v=!1,maxWidth:y="sm",onBackdropClick:b,onClick:w,onClose:x,open:S,PaperComponent:_=ku,PaperProps:C={},scroll:E="paper",TransitionComponent:A=iu,transitionDuration:M=a,TransitionProps:T}=n,P=s(n,Sw),k=u(u({},n),{},{disableEscapeKeyDown:m,fullScreen:g,fullWidth:v,maxWidth:y,scroll:E}),D=(e=>{const{classes:t,scroll:r,maxWidth:n,fullWidth:i,fullScreen:s}=e;return Na({root:["root"],container:["container","scroll".concat(io(r))],paper:["paper","paperScroll".concat(io(r)),"paperWidth".concat(io(String(n))),i&&"paperFullWidth",s&&"paperFullScreen"]},bw,t)})(k),I=e.useRef(),O=bo(l),R=e.useMemo((()=>({titleId:O})),[O]);return(0,bt.jsx)(Cw,u(u({className:ua(D.root,p),closeAfterTransition:!0,components:{Backdrop:_w},componentsProps:{backdrop:u({transitionDuration:M,as:h},d)},disableEscapeKeyDown:m,onClose:x,open:S,ref:r,onClick:e=>{w&&w(e),I.current&&(I.current=null,b&&b(e),x&&x(e,"backdropClick"))},ownerState:k},P),{},{children:(0,bt.jsx)(A,u(u({appear:!0,in:S,timeout:M,role:"presentation"},T),{},{children:(0,bt.jsx)(Ew,{className:ua(D.container),onMouseDown:e=>{I.current=e.target===e.currentTarget},ownerState:k,children:(0,bt.jsx)(Aw,u(u({as:_,elevation:24,role:"dialog","aria-describedby":o,"aria-labelledby":O,"aria-modal":c},C),{},{className:ua(D.paper,C.className),ownerState:k,children:(0,bt.jsx)(xw.Provider,{value:R,children:f})}))})}))}))})),Tw=eo(Mw)({["& .".concat(ww.container)]:{outline:0},["& .".concat(ww.paper)]:{outline:0,minWidth:uv}}),Pw=eo(yw)({"&:first-of-type":{padding:0}});function kw(e){var t,r;const{children:n,onDismiss:i,open:s,slots:a,slotProps:o}=e,l=null!==(t=null===a||void 0===a?void 0:a.dialog)&&void 0!==t?t:Tw,c=null!==(r=null===a||void 0===a?void 0:a.mobileTransition)&&void 0!==r?r:iu;return(0,bt.jsx)(l,ha({open:s,onClose:i},null===o||void 0===o?void 0:o.dialog,{TransitionComponent:c,TransitionProps:null===o||void 0===o?void 0:o.mobileTransition,PaperComponent:null===a||void 0===a?void 0:a.mobilePaper,PaperProps:null===o||void 0===o?void 0:o.mobilePaper,children:(0,bt.jsx)(Pw,{children:n})}))}const Dw=["props","getOpenDialogAriaText"],Iw=e.forwardRef((function(t,r){var n,s;const a=Ef(),o=vf(),l=Df(t,"MuiMobileDatePicker"),c=ha({day:dw,month:dw,year:dw},l.viewRenderers),u=ha({},l,{viewRenderers:c,format:Nd(o,l,!1),slots:ha({field:zy},l.slots),slotProps:ha({},l.slotProps,{field:e=>{var t;return ha({},$l(null===(t=l.slotProps)||void 0===t?void 0:t.field,e),Nf(l),{ref:r})},toolbar:ha({hidden:!1},null===(n=l.slotProps)||void 0===n?void 0:n.toolbar)})}),{renderPicker:h}=(t=>{var r,n,s;let{props:a,getOpenDialogAriaText:o}=t,l=i(t,Dw);const{slots:c,slotProps:u,className:h,sx:d,format:f,formatDensity:p,enableAccessibleFieldDOMStructure:m,selectedSections:g,onSelectedSectionsChange:v,timezone:y,name:b,label:w,inputRef:x,readOnly:S,disabled:_,localeText:C}=a,E=e.useRef(null),A=bo(),M=null!==(r=null===u||void 0===u||null===(n=u.toolbar)||void 0===n?void 0:n.hidden)&&void 0!==r&&r,{open:T,actions:P,layoutProps:k,renderCurrentView:D,fieldProps:I,contextValue:O}=xg(ha({},l,{props:a,fieldRef:E,autoFocusView:!0,additionalViewProps:{},wrapperVariant:"mobile"})),R=c.field,L=tc({elementType:R,externalSlotProps:null===u||void 0===u?void 0:u.field,additionalProps:ha({},I,M&&{id:A},!(_||S)&&{onClick:P.onOpen,onKeyDown:(N=P.onOpen,e=>{"Enter"!==e.key&&" "!==e.key||(N(e),e.preventDefault(),e.stopPropagation()),B&&B(e)})},{readOnly:null===S||void 0===S||S,disabled:_,className:h,sx:d,format:f,formatDensity:p,enableAccessibleFieldDOMStructure:m,selectedSections:g,onSelectedSectionsChange:v,timezone:y,label:w,name:b},x?{inputRef:x}:{}),ownerState:a});var N,B;L.inputProps=ha({},L.inputProps,{"aria-label":o(I.value)});const z=ha({textField:c.textField},L.slots),F=null!==(s=c.layout)&&void 0!==s?s:vv;let j=A;M&&(j=w?"".concat(A,"-label"):void 0);const U=ha({},u,{toolbar:ha({},null===u||void 0===u?void 0:u.toolbar,{titleId:A}),mobilePaper:ha({"aria-labelledby":j},null===u||void 0===u?void 0:u.mobilePaper)}),V=xo(E,L.unstableFieldRef);return{renderPicker:()=>(0,bt.jsxs)(bv,{contextValue:O,localeText:C,children:[(0,bt.jsx)(R,ha({},L,{slots:z,slotProps:U,unstableFieldRef:V})),(0,bt.jsx)(kw,ha({},P,{open:T,slots:c,slotProps:U,children:(0,bt.jsx)(F,ha({},k,null===U||void 0===U?void 0:U.layout,{slots:c,slotProps:U,children:D()}))}))]})}})({props:u,valueManager:hf,valueType:"date",getOpenDialogAriaText:ff({utils:o,formatKey:"fullDate",contextTranslation:a.openDatePickerDialogue,propsTranslation:null===(s=u.localeText)||void 0===s?void 0:s.openDatePickerDialogue}),validator:Bf});return h()}));Iw.propTypes={autoFocus:Ad().bool,className:Ad().string,closeOnSelect:Ad().bool,dayOfWeekFormatter:Ad().func,defaultValue:Ad().object,disabled:Ad().bool,disableFuture:Ad().bool,disableHighlightToday:Ad().bool,disableOpenPicker:Ad().bool,disablePast:Ad().bool,displayWeekNumber:Ad().bool,enableAccessibleFieldDOMStructure:Ad().any,fixedWeekNumber:Ad().number,format:Ad().string,formatDensity:Ad().oneOf(["dense","spacious"]),inputRef:Md,label:Ad().node,loading:Ad().bool,localeText:Ad().object,maxDate:Ad().object,minDate:Ad().object,monthsPerRow:Ad().oneOf([3,4]),name:Ad().string,onAccept:Ad().func,onChange:Ad().func,onClose:Ad().func,onError:Ad().func,onMonthChange:Ad().func,onOpen:Ad().func,onSelectedSectionsChange:Ad().func,onViewChange:Ad().func,onYearChange:Ad().func,open:Ad().bool,openTo:Ad().oneOf(["day","month","year"]),orientation:Ad().oneOf(["landscape","portrait"]),readOnly:Ad().bool,reduceAnimations:Ad().bool,referenceDate:Ad().object,renderLoading:Ad().func,selectedSections:Ad().oneOfType([Ad().oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),Ad().number]),shouldDisableDate:Ad().func,shouldDisableMonth:Ad().func,shouldDisableYear:Ad().func,showDaysOutsideCurrentMonth:Ad().bool,slotProps:Ad().object,slots:Ad().object,sx:Ad().oneOfType([Ad().arrayOf(Ad().oneOfType([Ad().func,Ad().object,Ad().bool])),Ad().func,Ad().object]),timezone:Ad().string,value:Ad().object,view:Ad().oneOf(["day","month","year"]),viewRenderers:Ad().shape({day:Ad().func,month:Ad().func,year:Ad().func}),views:Ad().arrayOf(Ad().oneOf(["day","month","year"]).isRequired),yearsOrder:Ad().oneOf(["asc","desc"]),yearsPerRow:Ad().oneOf([3,4])};const Ow=["desktopModeMediaQuery"],Rw=e.forwardRef((function(e,t){const r=gd({props:e,name:"MuiDatePicker"}),{desktopModeMediaQuery:n=tg}=r,s=i(r,Ow);return Cd(n,{defaultMatches:!0})?(0,bt.jsx)(fw,ha({ref:t},s)):(0,bt.jsx)(Iw,ha({ref:t},s))})),Lw=["alignItems","autoFocus","component","children","dense","disableGutters","divider","focusVisibleClassName","selected","className"],Nw=eo(wp,{shouldForwardProp:e=>Ja(e)||"classes"===e,name:"MuiListItemButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.dense&&t.dense,"flex-start"===r.alignItems&&t.alignItemsFlexStart,r.divider&&t.divider,!r.disableGutters&&t.gutters]}})(ro((e=>{let{theme:t}=e;return{display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},["&.".concat(Hg.selected)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / ").concat(t.vars.palette.action.selectedOpacity,")"):Dt(t.palette.primary.main,t.palette.action.selectedOpacity),["&.".concat(Hg.focusVisible)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.focusOpacity,"))"):Dt(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},["&.".concat(Hg.selected,":hover")]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.hoverOpacity,"))"):Dt(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / ").concat(t.vars.palette.action.selectedOpacity,")"):Dt(t.palette.primary.main,t.palette.action.selectedOpacity)}},["&.".concat(Hg.focusVisible)]:{backgroundColor:(t.vars||t).palette.action.focus},["&.".concat(Hg.disabled)]:{opacity:(t.vars||t).palette.action.disabledOpacity},variants:[{props:e=>{let{ownerState:t}=e;return t.divider},style:{borderBottom:"1px solid ".concat((t.vars||t).palette.divider),backgroundClip:"padding-box"}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:e=>{let{ownerState:t}=e;return!t.disableGutters},style:{paddingLeft:16,paddingRight:16}},{props:e=>{let{ownerState:t}=e;return t.dense},style:{paddingTop:4,paddingBottom:4}}]}}))),Bw=e.forwardRef((function(t,r){const n=no({props:t,name:"MuiListItemButton"}),{alignItems:i="center",autoFocus:a=!1,component:o="div",children:l,dense:c=!1,disableGutters:h=!1,divider:d=!1,focusVisibleClassName:f,selected:p=!1,className:m}=n,g=s(n,Lw),v=e.useContext(rc),y=e.useMemo((()=>({dense:c||v.dense||!1,alignItems:i,disableGutters:h})),[i,v.dense,c,h]),b=e.useRef(null);No((()=>{a&&b.current&&b.current.focus()}),[a]);const w=u(u({},n),{},{alignItems:i,dense:y.dense,disableGutters:h,divider:d,selected:p}),x=(e=>{const{alignItems:t,classes:r,dense:n,disabled:i,disableGutters:s,divider:a,selected:o}=e,l=Na({root:["root",n&&"dense",!s&&"gutters",a&&"divider",i&&"disabled","flex-start"===t&&"alignItemsFlexStart",o&&"selected"]},Vg,r);return u(u({},r),l)})(w),S=Lo(b,r);return(0,bt.jsx)(rc.Provider,{value:y,children:(0,bt.jsx)(Nw,u(u({ref:S,href:g.href||g.to,component:(g.href||g.to)&&"div"===o?"button":o,focusVisibleClassName:ua(x.focusVisible,f),ownerState:w,className:ua(x.root,m)},g),{},{classes:x,children:l}))})}));function zw(e){return ka("MuiListItemIcon",e)}const Fw=Da("MuiListItemIcon",["root","alignItemsFlexStart"]),jw=["className"],Uw=eo("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,"flex-start"===r.alignItems&&t.alignItemsFlexStart]}})(ro((e=>{let{theme:t}=e;return{minWidth:56,color:(t.vars||t).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}}))),Vw=e.forwardRef((function(t,r){const n=no({props:t,name:"MuiListItemIcon"}),{className:i}=n,a=s(n,jw),o=e.useContext(rc),l=u(u({},n),{},{alignItems:o.alignItems}),c=(e=>{const{alignItems:t,classes:r}=e;return Na({root:["root","flex-start"===t&&"alignItemsFlexStart"]},zw,r)})(l);return(0,bt.jsx)(Uw,u({className:ua(c.root,i),ownerState:l,ref:r},a))}));function Hw(e){return ka("MuiListItemText",e)}const Ww=Da("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),Gw=["children","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps","slots","slotProps"],qw=eo("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[{["& .".concat(Ww.primary)]:t.primary},{["& .".concat(Ww.secondary)]:t.secondary},t.root,r.inset&&t.inset,r.primary&&r.secondary&&t.multiline,r.dense&&t.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[".".concat(oo.root,":where(& .").concat(Ww.primary,")")]:{display:"block"},[".".concat(oo.root,":where(& .").concat(Ww.secondary,")")]:{display:"block"},variants:[{props:e=>{let{ownerState:t}=e;return t.primary&&t.secondary},style:{marginTop:6,marginBottom:6}},{props:e=>{let{ownerState:t}=e;return t.inset},style:{paddingLeft:56}}]}),Xw=e.forwardRef((function(t,r){const n=no({props:t,name:"MuiListItemText"}),{children:i,className:a,disableTypography:o=!1,inset:l=!1,primary:c,primaryTypographyProps:h,secondary:d,secondaryTypographyProps:f,slots:p={},slotProps:m={}}=n,g=s(n,Gw),{dense:v}=e.useContext(rc);let y=null!=c?c:i,b=d;const w=u(u({},n),{},{disableTypography:o,inset:l,primary:!!y,secondary:!!b,dense:v}),x=(e=>{const{classes:t,inset:r,primary:n,secondary:i,dense:s}=e;return Na({root:["root",r&&"inset",s&&"dense",n&&i&&"multiline"],primary:["primary"],secondary:["secondary"]},Hw,t)})(w),S={slots:p,slotProps:u({primary:h,secondary:f},m)},[_,C]=eu("primary",{className:x.primary,elementType:go,externalForwardedProps:S,ownerState:w}),[E,A]=eu("secondary",{className:x.secondary,elementType:go,externalForwardedProps:S,ownerState:w});return null==y||y.type===go||o||(y=(0,bt.jsx)(_,u(u({variant:v?"body2":"body1",component:null!==C&&void 0!==C&&C.variant?void 0:"span"},C),{},{children:y}))),null==b||b.type===go||o||(b=(0,bt.jsx)(E,u(u({variant:"body2",color:"textSecondary"},A),{},{children:b}))),(0,bt.jsxs)(qw,u(u({className:ua(x.root,a),ownerState:w,ref:r},g),{},{children:[y,b]}))})),Yw=["addEndListener","appear","children","container","direction","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function Kw(e,t,r){var n;const i=function(e,t,r){const n=t.getBoundingClientRect(),i=r&&r.getBoundingClientRect(),s=cc(t);let a;if(t.fakeTransform)a=t.fakeTransform;else{const e=s.getComputedStyle(t);a=e.getPropertyValue("-webkit-transform")||e.getPropertyValue("transform")}let o=0,l=0;if(a&&"none"!==a&&"string"===typeof a){const e=a.split("(")[1].split(")")[0].split(",");o=parseInt(e[4],10),l=parseInt(e[5],10)}return"left"===e?"translateX(".concat(i?i.right+o-n.left:s.innerWidth+o-n.left,"px)"):"right"===e?"translateX(-".concat(i?n.right-i.left-o:n.left+n.width-o,"px)"):"up"===e?"translateY(".concat(i?i.bottom+l-n.top:s.innerHeight+l-n.top,"px)"):"translateY(-".concat(i?n.top-i.top+n.height-l:n.top+n.height-l,"px)")}(e,t,"function"===typeof(n=r)?n():n);i&&(t.style.webkitTransform=i,t.style.transform=i)}const Qw=e.forwardRef((function(t,r){const n=Bc(),i={enter:n.transitions.easing.easeOut,exit:n.transitions.easing.sharp},a={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:o,appear:l=!0,children:c,container:h,direction:d="down",easing:f=i,in:p,onEnter:m,onEntered:g,onEntering:v,onExit:y,onExited:b,onExiting:w,style:x,timeout:S=a,TransitionComponent:_=Nc}=t,C=s(t,Yw),E=e.useRef(null),A=Lo(ql(c),E,r),M=e=>t=>{e&&(void 0===t?e(E.current):e(E.current,t))},T=M(((e,t)=>{Kw(d,e,h),zc(e),m&&m(e,t)})),P=M(((e,t)=>{const r=Fc({timeout:S,style:x,easing:f},{mode:"enter"});e.style.webkitTransition=n.transitions.create("-webkit-transform",u({},r)),e.style.transition=n.transitions.create("transform",u({},r)),e.style.webkitTransform="none",e.style.transform="none",v&&v(e,t)})),k=M(g),D=M(w),I=M((e=>{const t=Fc({timeout:S,style:x,easing:f},{mode:"exit"});e.style.webkitTransition=n.transitions.create("-webkit-transform",t),e.style.transition=n.transitions.create("transform",t),Kw(d,e,h),y&&y(e)})),O=M((e=>{e.style.webkitTransition="",e.style.transition="",b&&b(e)})),R=e.useCallback((()=>{E.current&&Kw(d,E.current,h)}),[d,h]);return e.useEffect((()=>{if(p||"down"===d||"right"===d)return;const e=vc((()=>{E.current&&Kw(d,E.current,h)})),t=cc(E.current);return t.addEventListener("resize",e),()=>{e.clear(),t.removeEventListener("resize",e)}}),[d,p,h]),e.useEffect((()=>{p||R()}),[p,R]),(0,bt.jsx)(_,u(u({nodeRef:E,onEnter:T,onEntered:k,onEntering:P,onExit:I,onExited:O,onExiting:D,addEndListener:e=>{o&&o(E.current,e)},appear:l,in:p,timeout:S},C),{},{children:(t,r)=>e.cloneElement(c,u({ref:A,style:u(u({visibility:"exited"!==t||p?void 0:"hidden"},x),c.props.style)},r))}))})),Zw=Qw;function Jw(e){return ka("MuiDrawer",e)}Da("MuiDrawer",["root","docked","paper","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const $w=["BackdropProps"],ex=["anchor","BackdropProps","children","className","elevation","hideBackdrop","ModalProps","onClose","open","PaperProps","SlideProps","TransitionComponent","transitionDuration","variant"],tx=(e,t)=>{const{ownerState:r}=e;return[t.root,("permanent"===r.variant||"persistent"===r.variant)&&t.docked,t.modal]},rx=eo(Eu,{name:"MuiDrawer",slot:"Root",overridesResolver:tx})(ro((e=>{let{theme:t}=e;return{zIndex:(t.vars||t).zIndex.drawer}}))),nx=eo("div",{shouldForwardProp:Ja,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:tx})({flex:"0 0 auto"}),ix=eo(ku,{name:"MuiDrawer",slot:"Paper",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.paper,t["paperAnchor".concat(io(r.anchor))],"temporary"!==r.variant&&t["paperAnchorDocked".concat(io(r.anchor))]]}})(ro((e=>{let{theme:t}=e;return{overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(t.vars||t).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0,variants:[{props:{anchor:"left"},style:{left:0}},{props:{anchor:"top"},style:{top:0,left:0,right:0,height:"auto",maxHeight:"100%"}},{props:{anchor:"right"},style:{right:0}},{props:{anchor:"bottom"},style:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"}},{props:e=>{let{ownerState:t}=e;return"left"===t.anchor&&"temporary"!==t.variant},style:{borderRight:"1px solid ".concat((t.vars||t).palette.divider)}},{props:e=>{let{ownerState:t}=e;return"top"===t.anchor&&"temporary"!==t.variant},style:{borderBottom:"1px solid ".concat((t.vars||t).palette.divider)}},{props:e=>{let{ownerState:t}=e;return"right"===t.anchor&&"temporary"!==t.variant},style:{borderLeft:"1px solid ".concat((t.vars||t).palette.divider)}},{props:e=>{let{ownerState:t}=e;return"bottom"===t.anchor&&"temporary"!==t.variant},style:{borderTop:"1px solid ".concat((t.vars||t).palette.divider)}}]}}))),sx={left:"right",right:"left",top:"down",bottom:"up"};const ax=e.forwardRef((function(t,r){const n=no({props:t,name:"MuiDrawer"}),i=Bc(),a=Is(),o={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{anchor:l="left",BackdropProps:c,children:h,className:d,elevation:f=16,hideBackdrop:p=!1,ModalProps:{BackdropProps:m}={},onClose:g,open:v=!1,PaperProps:y={},SlideProps:b,TransitionComponent:w=Zw,transitionDuration:x=o,variant:S="temporary"}=n,_=s(n.ModalProps,$w),C=s(n,ex),E=e.useRef(!1);e.useEffect((()=>{E.current=!0}),[]);const A=function(e,t){let{direction:r}=e;return"rtl"===r&&function(e){return["left","right"].includes(e)}(t)?sx[t]:t}({direction:a?"rtl":"ltr"},l),M=l,T=u(u({},n),{},{anchor:M,elevation:f,open:v,variant:S},C),P=(e=>{const{classes:t,anchor:r,variant:n}=e;return Na({root:["root"],docked:[("permanent"===n||"persistent"===n)&&"docked"],modal:["modal"],paper:["paper","paperAnchor".concat(io(r)),"temporary"!==n&&"paperAnchorDocked".concat(io(r))]},Jw,t)})(T),k=(0,bt.jsx)(ix,u(u({elevation:"temporary"===S?f:0,square:!0},y),{},{className:ua(P.paper,y.className),ownerState:T,children:h}));if("permanent"===S)return(0,bt.jsx)(nx,u(u({className:ua(P.root,P.docked,d),ownerState:T,ref:r},C),{},{children:k}));const D=(0,bt.jsx)(w,u(u({in:v,direction:sx[A],timeout:x,appear:E.current},b),{},{children:k}));return"persistent"===S?(0,bt.jsx)(nx,u(u({className:ua(P.root,P.docked,d),ownerState:T,ref:r},C),{},{children:D})):(0,bt.jsx)(rx,u(u(u({BackdropProps:u(u(u({},c),m),{},{transitionDuration:x}),className:ua(P.root,P.modal,d),open:v,ownerState:T,onClose:g,hideBackdrop:p,ref:r},C),_),{},{children:D}))})),ox=ax,lx=Ah((0,bt.jsx)("path",{d:"M20 6h-8l-2-2H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2m-1 8h-3v3h-2v-3h-3v-2h3V9h2v3h3z"}),"CreateNewFolder"),cx=Ah((0,bt.jsx)("path",{d:"M14 2H4c-1.11 0-2 .9-2 2v10h2V4h10zm4 4H8c-1.11 0-2 .9-2 2v10h2V8h10zm2 4h-8c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2h8c1.1 0 2-.9 2-2v-8c0-1.1-.9-2-2-2"}),"AutoAwesomeMotion"),ux=Ah((0,bt.jsx)("path",{d:"m22 5.72-4.6-3.86-1.29 1.53 4.6 3.86zM7.88 3.39 6.6 1.86 2 5.71l1.29 1.53zM12.5 8H11v6l4.75 2.85.75-1.23-4-2.37zM12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9c4.97 0 9-4.03 9-9s-4.03-9-9-9m0 16c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"}),"AccessAlarm"),hx=r.p+"static/media/logo2.0f773baf197aee1f9000.png",dx=e=>{let{open:t,toggleDrawer:r}=e;const n=he(),i=(0,bt.jsxs)(La,{sx:{width:250},role:"presentation",onClick:r(!1),children:[(0,bt.jsx)("img",{style:{width:"80%",margin:"10px"},src:hx,alt:"Kabinari",srcset:""}),(0,bt.jsx)(Yh,{sx:{borderBottomWidth:3,backgroundColor:"#DEDDDB"}}),(0,bt.jsx)(ac,{children:["Yeni Proje","T\xfcm Projeler"].map(((e,t)=>(0,bt.jsx)(ev,{disablePadding:!0,children:(0,bt.jsxs)(Bw,{onClick:()=>(e=>{n(["/Yeni-Proje","/T\xfcm-Projeler","/*"][e])})(t),children:[(0,bt.jsx)(Vw,{children:0==t?(0,bt.jsx)(lx,{}):1==t?(0,bt.jsx)(cx,{}):(0,bt.jsx)(ux,{})}),(0,bt.jsx)(Xw,{primary:e})]})},e)))}),(0,bt.jsx)(Yh,{})]});return(0,bt.jsx)(bt.Fragment,{children:(0,bt.jsx)(ox,{open:t,onClose:r(!1),children:i})})};function fx(e){return ka("MuiAppBar",e)}Da("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const px=["className","color","enableColorOnDark","position"],mx=(e,t)=>e?"".concat(null===e||void 0===e?void 0:e.replace(")",""),", ").concat(t,")"):t,gx=eo(ku,{name:"MuiAppBar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t["position".concat(io(r.position))],t["color".concat(io(r.color))]]}})(ro((e=>{let{theme:t}=e;return{display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0,variants:[{props:{position:"fixed"},style:{position:"fixed",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}}},{props:{position:"absolute"},style:{position:"absolute",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"sticky"},style:{position:"sticky",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"static"},style:{position:"static"}},{props:{position:"relative"},style:{position:"relative"}},{props:{color:"inherit"},style:{"--AppBar-color":"inherit"}},{props:{color:"default"},style:u({"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[100],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[100])},t.applyStyles("dark",{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[900],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[900])}))},...Object.entries(t.palette).filter(so(["contrastText"])).map((e=>{var r,n;let[i]=e;return{props:{color:i},style:{"--AppBar-background":(null!==(r=t.vars)&&void 0!==r?r:t).palette[i].main,"--AppBar-color":(null!==(n=t.vars)&&void 0!==n?n:t).palette[i].contrastText}}})),{props:e=>!0===e.enableColorOnDark&&!["inherit","transparent"].includes(e.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"}},{props:e=>!1===e.enableColorOnDark&&!["inherit","transparent"].includes(e.color),style:u({backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"},t.applyStyles("dark",{backgroundColor:t.vars?mx(t.vars.palette.AppBar.darkBg,"var(--AppBar-background)"):null,color:t.vars?mx(t.vars.palette.AppBar.darkColor,"var(--AppBar-color)"):null}))},{props:{color:"transparent"},style:u({"--AppBar-background":"transparent","--AppBar-color":"inherit",backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"},t.applyStyles("dark",{backgroundImage:"none"}))}]}}))),vx=e.forwardRef((function(e,t){const r=no({props:e,name:"MuiAppBar"}),{className:n,color:i="primary",enableColorOnDark:a=!1,position:o="fixed"}=r,l=s(r,px),c=u(u({},r),{},{color:i,position:o,enableColorOnDark:a}),h=(e=>{const{color:t,position:r,classes:n}=e;return Na({root:["root","color".concat(io(t)),"position".concat(io(r))]},fx,n)})(c);return(0,bt.jsx)(gx,u({square:!0,component:"header",ownerState:c,elevation:4,className:ua(h.root,n,"fixed"===o&&"mui-fixed"),ref:t},l))})),yx=vx;function bx(e){return ka("MuiToolbar",e)}Da("MuiToolbar",["root","gutters","regular","dense"]);const wx=["className","component","disableGutters","variant"],xx=eo("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,!r.disableGutters&&t.gutters,t[r.variant]]}})(ro((e=>{let{theme:t}=e;return{position:"relative",display:"flex",alignItems:"center",variants:[{props:e=>{let{ownerState:t}=e;return!t.disableGutters},style:{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:t.mixins.toolbar}]}}))),Sx=e.forwardRef((function(e,t){const r=no({props:e,name:"MuiToolbar"}),{className:n,component:i="div",disableGutters:a=!1,variant:o="regular"}=r,l=s(r,wx),c=u(u({},r),{},{component:i,disableGutters:a,variant:o}),h=(e=>{const{classes:t,disableGutters:r,variant:n}=e;return Na({root:["root",!r&&"gutters",n]},bx,t)})(c);return(0,bt.jsx)(xx,u({as:i,className:ua(h.root,n),ref:t,ownerState:c},l))})),_x=Sx,Cx=Ah((0,bt.jsx)("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu"),Ex=e=>{let{toggleDrawer:t}=e;return(0,bt.jsx)(bt.Fragment,{children:(0,bt.jsx)(La,{sx:{flexGrow:1,height:"10%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,bt.jsx)(yx,{position:"static",sx:{bgcolor:"#FFFFFF",padding:"10px"},children:(0,bt.jsxs)(_x,{children:[(0,bt.jsx)(Ap,{size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2,color:" rgb(28, 57, 96)"},onClick:t(!0),children:(0,bt.jsx)(Cx,{sx:{fontSize:"32px"}})}),(0,bt.jsx)(La,{sx:{width:"15%",height:"70%",margin:"5px"},children:(0,bt.jsx)("a",{href:"http://www.kabinari.com/",target:"_blank",children:(0,bt.jsx)("img",{style:{height:"100%",width:"100%"},src:hx,alt:"Kabinari",srcset:""})})})]})})})})};function Ax(e){return ka("MuiMenuItem",e)}const Mx=Da("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),Tx=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],Px=eo(wp,{shouldForwardProp:e=>Ja(e)||"classes"===e,name:"MuiMenuItem",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.dense&&t.dense,r.divider&&t.divider,!r.disableGutters&&t.gutters]}})(ro((e=>{let{theme:t}=e;return u(u({},t.typography.body1),{},{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},["&.".concat(Mx.selected)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / ").concat(t.vars.palette.action.selectedOpacity,")"):Dt(t.palette.primary.main,t.palette.action.selectedOpacity),["&.".concat(Mx.focusVisible)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.focusOpacity,"))"):Dt(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},["&.".concat(Mx.selected,":hover")]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.hoverOpacity,"))"):Dt(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / ").concat(t.vars.palette.action.selectedOpacity,")"):Dt(t.palette.primary.main,t.palette.action.selectedOpacity)}},["&.".concat(Mx.focusVisible)]:{backgroundColor:(t.vars||t).palette.action.focus},["&.".concat(Mx.disabled)]:{opacity:(t.vars||t).palette.action.disabledOpacity},["& + .".concat(Hh.root)]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},["& + .".concat(Hh.inset)]:{marginLeft:52},["& .".concat(Ww.root)]:{marginTop:0,marginBottom:0},["& .".concat(Ww.inset)]:{paddingLeft:36},["& .".concat(Fw.root)]:{minWidth:36},variants:[{props:e=>{let{ownerState:t}=e;return!t.disableGutters},style:{paddingLeft:16,paddingRight:16}},{props:e=>{let{ownerState:t}=e;return t.divider},style:{borderBottom:"1px solid ".concat((t.vars||t).palette.divider),backgroundClip:"padding-box"}},{props:e=>{let{ownerState:t}=e;return!t.dense},style:{[t.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:e=>{let{ownerState:t}=e;return t.dense},style:u(u({minHeight:32,paddingTop:4,paddingBottom:4},t.typography.body2),{},{["& .".concat(Fw.root," svg")]:{fontSize:"1.25rem"}})}]})}))),kx=e.forwardRef((function(t,r){const n=no({props:t,name:"MuiMenuItem"}),{autoFocus:i=!1,component:a="li",dense:o=!1,divider:l=!1,disableGutters:c=!1,focusVisibleClassName:h,role:d="menuitem",tabIndex:f,className:p}=n,m=s(n,Tx),g=e.useContext(rc),v=e.useMemo((()=>({dense:o||g.dense||!1,disableGutters:c})),[g.dense,o,c]),y=e.useRef(null);No((()=>{i&&y.current&&y.current.focus()}),[i]);const b=u(u({},n),{},{dense:v.dense,divider:l,disableGutters:c}),w=(e=>{const{disabled:t,dense:r,divider:n,disableGutters:i,selected:s,classes:a}=e,o=Na({root:["root",r&&"dense",t&&"disabled",!i&&"gutters",n&&"divider",s&&"selected"]},Ax,a);return u(u({},a),o)})(n),x=Lo(y,r);let S;return n.disabled||(S=void 0!==f?f:-1),(0,bt.jsx)(rc.Provider,{value:v,children:(0,bt.jsx)(Px,u(u({ref:x,role:d,tabIndex:S,component:a,focusVisibleClassName:ua(w.focusVisible,h),className:ua(w.root,p)},m),{},{ownerState:b,classes:w}))})})),Dx=Ah((0,bt.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check");function Ix(e){return ka("MuiToggleButton",e)}const Ox=Da("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]);const Rx=e.createContext({});const Lx=e.createContext(void 0);function Nx(e,t){return void 0!==t&&void 0!==e&&(Array.isArray(t)?t.includes(e):e===t)}const Bx=["value"],zx=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],Fx=eo(wp,{name:"MuiToggleButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t["size".concat(io(r.size))]]}})(ro((e=>{let{theme:t}=e;return u(u({},t.typography.button),{},{borderRadius:(t.vars||t).shape.borderRadius,padding:11,border:"1px solid ".concat((t.vars||t).palette.divider),color:(t.vars||t).palette.action.active,["&.".concat(Ox.disabled)]:{color:(t.vars||t).palette.action.disabled,border:"1px solid ".concat((t.vars||t).palette.action.disabledBackground)},"&:hover":{textDecoration:"none",backgroundColor:t.vars?"rgba(".concat(t.vars.palette.text.primaryChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):Dt(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[{props:{color:"standard"},style:{["&.".concat(Ox.selected)]:{color:(t.vars||t).palette.text.primary,backgroundColor:t.vars?"rgba(".concat(t.vars.palette.text.primaryChannel," / ").concat(t.vars.palette.action.selectedOpacity,")"):Dt(t.palette.text.primary,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.text.primaryChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.hoverOpacity,"))"):Dt(t.palette.text.primary,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.text.primaryChannel," / ").concat(t.vars.palette.action.selectedOpacity,")"):Dt(t.palette.text.primary,t.palette.action.selectedOpacity)}}}}},...Object.entries(t.palette).filter(so()).map((e=>{let[r]=e;return{props:{color:r},style:{["&.".concat(Ox.selected)]:{color:(t.vars||t).palette[r].main,backgroundColor:t.vars?"rgba(".concat(t.vars.palette[r].mainChannel," / ").concat(t.vars.palette.action.selectedOpacity,")"):Dt(t.palette[r].main,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette[r].mainChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.hoverOpacity,"))"):Dt(t.palette[r].main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette[r].mainChannel," / ").concat(t.vars.palette.action.selectedOpacity,")"):Dt(t.palette[r].main,t.palette.action.selectedOpacity)}}}}}})),{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{padding:7,fontSize:t.typography.pxToRem(13)}},{props:{size:"large"},style:{padding:15,fontSize:t.typography.pxToRem(15)}}]})}))),jx=e.forwardRef((function(t,r){const n=e.useContext(Rx),{value:i}=n,a=s(n,Bx),o=e.useContext(Lx),l=no({props:Rs(u(u({},a),{},{selected:Nx(t.value,i)}),t),name:"MuiToggleButton"}),{children:c,className:h,color:d="standard",disabled:f=!1,disableFocusRipple:p=!1,fullWidth:m=!1,onChange:g,onClick:v,selected:y,size:b="medium",value:w}=l,x=s(l,zx),S=u(u({},l),{},{color:d,disabled:f,disableFocusRipple:p,fullWidth:m,size:b}),_=(e=>{const{classes:t,fullWidth:r,selected:n,disabled:i,size:s,color:a}=e;return Na({root:["root",n&&"selected",i&&"disabled",r&&"fullWidth","size".concat(io(s)),a]},Ix,t)})(S),C=o||"";return(0,bt.jsx)(Fx,u(u({className:ua(a.className,_.root,h,C),disabled:f,focusRipple:!p,ref:r,onClick:e=>{v&&(v(e,w),e.defaultPrevented)||g&&g(e,w)},onChange:g,value:w,ownerState:S,"aria-pressed":y},x),{},{children:c}))})),Ux=jx,Vx=t=>{let{id:r,data:n,onChange:i}=t;const[s,a]=(0,e.useState)({kat:(null===n||void 0===n?void 0:n.kat)||"",tip:(null===n||void 0===n?void 0:n.tip)||"",mahalNo:(null===n||void 0===n?void 0:n.mahalNo)||"",mahal:(null===n||void 0===n?void 0:n.mahal)||"",en:(null===n||void 0===n?void 0:n.en)||"",boy:(null===n||void 0===n?void 0:n.boy)||"",duvarKalinligi:(null===n||void 0===n?void 0:n.duvarKalinligi)||"",yon:(null===n||void 0===n?void 0:n.yon)||"",kanat:(null===n||void 0===n?void 0:n.kanat)||"",kasa:(null===n||void 0===n?void 0:n.kasa)||"",barel:(null===n||void 0===n?void 0:n.barel)||"",kilit:(null===n||void 0===n?void 0:n.kilit)||"",cumba:(null===n||void 0===n?void 0:n.cumba)||"",kol:(null===n||void 0===n?void 0:n.kol)||"",tekmelik:!1,itmelik:!1,menfez:!1,hidrolik:!1,lumboz:!1,"yang\u0131naD":!1});(0,e.useEffect)((()=>{i(r,s)}),[s]);const o=(e,t)=>{a((r=>u(u({},r),{},{[e]:t})))};return(0,bt.jsxs)(La,{sx:{height:"50px",display:"flex",alignItems:"center",justifyContent:"space-around",marginBottom:"10px",paddingX:"5px",borderBottom:"2px solid #DEDDDB"},children:[(0,bt.jsx)(Rg,{sx:{maxWidth:"30px",maxHeight:"30px",minWidth:"30px",minHeight:"30px",bgcolor:"#394c64",marginRight:"5px"},variant:"contained",children:r+1}),[{label:"Kat",key:"kat",width:"4%"},{label:"Tip",key:"tip",width:"4%"},{label:"Mahal-No",key:"mahalNo",width:"4%"},{label:"Mahal",key:"mahal",width:"4%"},{label:"En",key:"en",width:"7%"},{label:"Boy",key:"boy",width:"7%"},{label:"D.K",key:"duvarKalinligi",width:"7%"},{label:"Kanat",key:"kanat",width:"4%"},{label:"Kasa",key:"kasa",width:"7%"},{label:"Kilit",key:"kilit",width:"7%"}].map(((e,t)=>(0,bt.jsx)(Uh,{sx:{width:e.width},size:"small",label:e.label,value:s[e.key],onChange:t=>o(e.key,t.target.value)},"textfield-".concat(t)))),[{label:"Y\xf6n",key:"yon",options:["Sa\u011f","Sol","D\u0131\u015far\u0131-Sa\u011f","D\u0131\u015far\u0131-Sol"]},{label:"Barel",key:"barel",options:["?1","?2","?3"]},{label:"Cumba",key:"cumba",options:["PVC","U"]},{label:"Kol",key:"kol",options:["Baston","Boru"]}].map(((e,t)=>(0,bt.jsxs)(Fl,{size:"small",sx:{width:"8%"},children:[(0,bt.jsx)(Ol,{children:e.label}),(0,bt.jsx)(Lh,{value:s[e.key],onChange:t=>o(e.key,t.target.value),children:e.options.map((e=>(0,bt.jsx)(kx,{value:e,children:e},e)))})]},"select-".concat(t)))),["tekmelik","itmelik","menfez","hidrolik","lumboz","yang\u0131naD"].map(((e,t)=>(0,bt.jsx)(Ux,{size:"small",value:"check",selected:s[e],onChange:()=>{return t=e,void a((e=>u(u({},e),{},{[t]:!e[t]})));var t},children:(0,bt.jsx)(Dx,{})},"toggle-".concat(t))))]})},Hx=["name"],Wx=["_f"],Gx=["_f"],qx=["ref","message","type"];var Xx=e=>"checkbox"===e.type,Yx=e=>e instanceof Date,Kx=e=>null==e;const Qx=e=>"object"===typeof e;var Zx=e=>!Kx(e)&&!Array.isArray(e)&&Qx(e)&&!Yx(e),Jx=e=>Zx(e)&&e.target?Xx(e.target)?e.target.checked:e.target.value:e,$x=(e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)),eS="undefined"!==typeof window&&"undefined"!==typeof window.HTMLElement&&"undefined"!==typeof document;function tS(e){let t;const r=Array.isArray(e),n="undefined"!==typeof FileList&&e instanceof FileList;if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else{if(eS&&(e instanceof Blob||n)||!r&&!Zx(e))return e;if(t=r?[]:{},r||(e=>{const t=e.constructor&&e.constructor.prototype;return Zx(t)&&t.hasOwnProperty("isPrototypeOf")})(e))for(const r in e)e.hasOwnProperty(r)&&(t[r]=tS(e[r]));else t=e}return t}var rS=e=>Array.isArray(e)?e.filter(Boolean):[],nS=e=>void 0===e,iS=(e,t,r)=>{if(!t||!Zx(e))return r;const n=rS(t.split(/[,[\].]+?/)).reduce(((e,t)=>Kx(e)?e:e[t]),e);return nS(n)||n===e?nS(e[t])?r:e[t]:n},sS=e=>"boolean"===typeof e,aS=e=>/^\w*$/.test(e),oS=e=>rS(e.replace(/["|']|\]/g,"").split(/\.|\[/)),lS=(e,t,r)=>{let n=-1;const i=aS(t)?[t]:oS(t),s=i.length,a=s-1;for(;++n<s;){const t=i[n];let s=r;if(n!==a){const r=e[t];s=Zx(r)||Array.isArray(r)?r:isNaN(+i[n+1])?{}:[]}if("__proto__"===t||"constructor"===t||"prototype"===t)return;e[t]=s,e=e[t]}return e};const cS="blur",uS="focusout",hS="change",dS="onBlur",fS="onChange",pS="onSubmit",mS="onTouched",gS="all",vS="max",yS="min",bS="maxLength",wS="minLength",xS="pattern",SS="required",_S="validate",CS=e.createContext(null),ES=()=>e.useContext(CS);var AS=function(e,t,r){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i={defaultValues:t._defaultValues};for(const s in e)Object.defineProperty(i,s,{get:()=>{const i=s;return t._proxyFormState[i]!==gS&&(t._proxyFormState[i]=!n||gS),r&&(r[i]=!0),e[i]}});return i},MS=e=>Zx(e)&&!Object.keys(e).length,TS=(e,t,r,n)=>{r(e);const{name:i}=e,a=s(e,Hx);return MS(a)||Object.keys(a).length>=Object.keys(t).length||Object.keys(a).find((e=>t[e]===(!n||gS)))},PS=e=>Array.isArray(e)?e:[e],kS=(e,t,r)=>!e||!t||e===t||PS(e).some((e=>e&&(r?e===t:e.startsWith(t)||t.startsWith(e))));function DS(t){const r=e.useRef(t);r.current=t,e.useEffect((()=>{const e=!t.disabled&&r.current.subject&&r.current.subject.subscribe({next:r.current.next});return()=>{e&&e.unsubscribe()}}),[t.disabled])}var IS=e=>"string"===typeof e,OS=(e,t,r,n,i)=>IS(e)?(n&&t.watch.add(e),iS(r,e,i)):Array.isArray(e)?e.map((e=>(n&&t.watch.add(e),iS(r,e)))):(n&&(t.watchAll=!0),r);function RS(t){const r=ES(),{name:n,disabled:i,control:s=r.control,shouldUnregister:a}=t,o=$x(s._names.array,n),l=function(t){const r=ES(),{control:n=r.control,name:i,defaultValue:s,disabled:a,exact:o}=t||{},l=e.useRef(i);l.current=i,DS({disabled:a,subject:n._subjects.values,next:e=>{kS(l.current,e.name,o)&&u(tS(OS(l.current,n._names,e.values||n._formValues,!1,s)))}});const[c,u]=e.useState(n._getWatch(i,s));return e.useEffect((()=>n._removeUnmounted())),c}({control:s,name:n,defaultValue:iS(s._formValues,n,iS(s._defaultValues,n,t.defaultValue)),exact:!0}),c=function(t){const r=ES(),{control:n=r.control,disabled:i,name:s,exact:a}=t||{},[o,l]=e.useState(n._formState),c=e.useRef(!0),h=e.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),d=e.useRef(s);return d.current=s,DS({disabled:i,next:e=>c.current&&kS(d.current,e.name,a)&&TS(e,h.current,n._updateFormState)&&l(u(u({},n._formState),e)),subject:n._subjects.state}),e.useEffect((()=>(c.current=!0,h.current.isValid&&n._updateValid(!0),()=>{c.current=!1})),[n]),e.useMemo((()=>AS(o,n,h.current,!1)),[o,n])}({control:s,name:n,exact:!0}),h=e.useRef(s.register(n,u(u({},t.rules),{},{value:l},sS(t.disabled)?{disabled:t.disabled}:{}))),d=e.useMemo((()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!iS(c.errors,n)},isDirty:{enumerable:!0,get:()=>!!iS(c.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!iS(c.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!iS(c.validatingFields,n)},error:{enumerable:!0,get:()=>iS(c.errors,n)}})),[c,n]),f=e.useMemo((()=>u(u({name:n,value:l},sS(i)||c.disabled?{disabled:c.disabled||i}:{}),{},{onChange:e=>h.current.onChange({target:{value:Jx(e),name:n},type:hS}),onBlur:()=>h.current.onBlur({target:{value:iS(s._formValues,n),name:n},type:cS}),ref:e=>{const t=iS(s._fields,n);t&&e&&(t._f.ref={focus:()=>e.focus(),select:()=>e.select(),setCustomValidity:t=>e.setCustomValidity(t),reportValidity:()=>e.reportValidity()})}})),[n,s._formValues,i,c.disabled,l,s._fields]);return e.useEffect((()=>{const e=s._options.shouldUnregister||a,t=(e,t)=>{const r=iS(s._fields,e);r&&r._f&&(r._f.mount=t)};if(t(n,!0),e){const e=tS(iS(s._options.defaultValues,n));lS(s._defaultValues,n,e),nS(iS(s._formValues,n))&&lS(s._formValues,n,e)}return()=>{(o?e&&!s._state.action:e)?s.unregister(n):t(n,!1)}}),[n,s,o,a]),e.useEffect((()=>{sS(i)&&iS(s._fields,n)&&s._updateDisabledField({disabled:i,fields:s._fields,name:n,value:iS(s._fields,n)._f.value})}),[i,n,s]),e.useMemo((()=>({field:f,formState:c,fieldState:d})),[f,c,d])}const LS=e=>e.render(RS(e));var NS=(e,t,r,n,i)=>t?u(u({},r[e]),{},{types:u(u({},r[e]&&r[e].types?r[e].types:{}),{},{[n]:i||!0})}):{},BS=e=>({isOnSubmit:!e||e===pS,isOnBlur:e===dS,isOnChange:e===fS,isOnAll:e===gS,isOnTouch:e===mS}),zS=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some((t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length)))));const FS=(e,t,r,n)=>{for(const i of r||Object.keys(e)){const r=iS(e,i);if(r){const{_f:e}=r,a=s(r,Wx);if(e){if(e.refs&&e.refs[0]&&t(e.refs[0],i)&&!n)return!0;if(e.ref&&t(e.ref,e.name)&&!n)return!0;if(FS(a,t))break}else if(Zx(a)&&FS(a,t))break}}};var jS=(e,t,r)=>{const n=PS(iS(e,r));return lS(n,"root",t[r]),lS(e,r,n),e},US=e=>"file"===e.type,VS=e=>"function"===typeof e,HS=e=>{if(!eS)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},WS=e=>IS(e),GS=e=>"radio"===e.type,qS=e=>e instanceof RegExp;const XS={value:!1,isValid:!1},YS={value:!0,isValid:!0};var KS=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter((e=>e&&e.checked&&!e.disabled)).map((e=>e.value));return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!nS(e[0].attributes.value)?nS(e[0].value)||""===e[0].value?YS:{value:e[0].value,isValid:!0}:YS:XS}return XS};const QS={isValid:!1,value:null};var ZS=e=>Array.isArray(e)?e.reduce(((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e),QS):QS;function JS(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"validate";if(WS(e)||Array.isArray(e)&&e.every(WS)||sS(e)&&!e)return{type:r,message:WS(e)?e:"",ref:t}}var $S=e=>Zx(e)&&!qS(e)?e:{value:e,message:""},e_=async(e,t,r,n,i)=>{const{ref:s,refs:a,required:o,maxLength:l,minLength:c,min:h,max:d,pattern:f,validate:p,name:m,valueAsNumber:g,mount:v,disabled:y}=e._f,b=iS(t,m);if(!v||y)return{};const w=a?a[0]:s,x=e=>{n&&w.reportValidity&&(w.setCustomValidity(sS(e)?"":e||""),w.reportValidity())},S={},_=GS(s),C=Xx(s),E=_||C,A=(g||US(s))&&nS(s.value)&&nS(b)||HS(s)&&""===s.value||""===b||Array.isArray(b)&&!b.length,M=NS.bind(null,m,r,S),T=function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:bS,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:wS;const a=e?t:r;S[m]=u({type:e?n:i,message:a,ref:s},M(e?n:i,a))};if(i?!Array.isArray(b)||!b.length:o&&(!E&&(A||Kx(b))||sS(b)&&!b||C&&!KS(a).isValid||_&&!ZS(a).isValid)){const{value:e,message:t}=WS(o)?{value:!!o,message:o}:$S(o);if(e&&(S[m]=u({type:SS,message:t,ref:w},M(SS,t)),!r))return x(t),S}if(!A&&(!Kx(h)||!Kx(d))){let e,t;const n=$S(d),i=$S(h);if(Kx(b)||isNaN(b)){const r=s.valueAsDate||new Date(b),a=e=>new Date((new Date).toDateString()+" "+e),o="time"==s.type,l="week"==s.type;IS(n.value)&&b&&(e=o?a(b)>a(n.value):l?b>n.value:r>new Date(n.value)),IS(i.value)&&b&&(t=o?a(b)<a(i.value):l?b<i.value:r<new Date(i.value))}else{const r=s.valueAsNumber||(b?+b:b);Kx(n.value)||(e=r>n.value),Kx(i.value)||(t=r<i.value)}if((e||t)&&(T(!!e,n.message,i.message,vS,yS),!r))return x(S[m].message),S}if((l||c)&&!A&&(IS(b)||i&&Array.isArray(b))){const e=$S(l),t=$S(c),n=!Kx(e.value)&&b.length>+e.value,i=!Kx(t.value)&&b.length<+t.value;if((n||i)&&(T(n,e.message,t.message),!r))return x(S[m].message),S}if(f&&!A&&IS(b)){const{value:e,message:t}=$S(f);if(qS(e)&&!b.match(e)&&(S[m]=u({type:xS,message:t,ref:s},M(xS,t)),!r))return x(t),S}if(p)if(VS(p)){const e=JS(await p(b,t),w);if(e&&(S[m]=u(u({},e),M(_S,e.message)),!r))return x(e.message),S}else if(Zx(p)){let e={};for(const n in p){if(!MS(e)&&!r)break;const i=JS(await p[n](b,t),w,n);i&&(e=u(u({},i),M(n,i.message)),x(i.message),r&&(S[m]=e))}if(!MS(e)&&(S[m]=u({ref:w},e),!r))return S}return x(!0),S};function t_(e,t){const r=Array.isArray(t)?t:aS(t)?[t]:oS(t),n=1===r.length?e:function(e,t){const r=t.slice(0,-1).length;let n=0;for(;n<r;)e=nS(e)?n++:e[t[n++]];return e}(e,r),i=r.length-1,s=r[i];return n&&delete n[s],0!==i&&(Zx(n)&&MS(n)||Array.isArray(n)&&function(e){for(const t in e)if(e.hasOwnProperty(t)&&!nS(e[t]))return!1;return!0}(n))&&t_(e,r.slice(0,-1)),e}var r_=()=>{let e=[];return{get observers(){return e},next:t=>{for(const r of e)r.next&&r.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter((e=>e!==t))}}),unsubscribe:()=>{e=[]}}},n_=e=>Kx(e)||!Qx(e);function i_(e,t){if(n_(e)||n_(t))return e===t;if(Yx(e)&&Yx(t))return e.getTime()===t.getTime();const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const i of r){const r=e[i];if(!n.includes(i))return!1;if("ref"!==i){const e=t[i];if(Yx(r)&&Yx(e)||Zx(r)&&Zx(e)||Array.isArray(r)&&Array.isArray(e)?!i_(r,e):r!==e)return!1}}return!0}var s_=e=>"select-multiple"===e.type,a_=e=>HS(e)&&e.isConnected,o_=e=>{for(const t in e)if(VS(e[t]))return!0;return!1};function l_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=Array.isArray(e);if(Zx(e)||r)for(const n in e)Array.isArray(e[n])||Zx(e[n])&&!o_(e[n])?(t[n]=Array.isArray(e[n])?[]:{},l_(e[n],t[n])):Kx(e[n])||(t[n]=!0);return t}function c_(e,t,r){const n=Array.isArray(e);if(Zx(e)||n)for(const i in e)Array.isArray(e[i])||Zx(e[i])&&!o_(e[i])?nS(t)||n_(r[i])?r[i]=Array.isArray(e[i])?l_(e[i],[]):u({},l_(e[i])):c_(e[i],Kx(t)?{}:t[i],r[i]):r[i]=!i_(e[i],t[i]);return r}var u_=(e,t)=>c_(e,t,l_(t)),h_=(e,t)=>{let{valueAsNumber:r,valueAsDate:n,setValueAs:i}=t;return nS(e)?e:r?""===e?NaN:e?+e:e:n&&IS(e)?new Date(e):i?i(e):e};function d_(e){const t=e.ref;if(!(e.refs?e.refs.every((e=>e.disabled)):t.disabled))return US(t)?t.files:GS(t)?ZS(e.refs).value:s_(t)?[...t.selectedOptions].map((e=>{let{value:t}=e;return t})):Xx(t)?KS(e.refs).value:h_(nS(t.value)?e.ref.value:t.value,e)}var f_=e=>nS(e)?e:qS(e)?e.source:Zx(e)?qS(e.value)?e.value.source:e.value:e;const p_="AsyncFunction";function m_(e,t,r){const n=iS(e,r);if(n||aS(r))return{error:n,name:r};const i=r.split(".");for(;i.length;){const n=i.join("."),s=iS(t,n),a=iS(e,n);if(s&&!Array.isArray(s)&&r!==n)return{name:r};if(a&&a.type)return{name:n,error:a};i.pop()}return{name:r}}const g_={mode:pS,reValidateMode:fS,shouldFocusError:!0};function v_(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=u(u({},g_),t),n={submitCount:0,isDirty:!1,isLoading:VS(r.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1},i={},a=(Zx(r.defaultValues)||Zx(r.values))&&tS(r.defaultValues||r.values)||{},o=r.shouldUnregister?{}:tS(a),l={action:!1,mount:!1,watch:!1},c={mount:new Set,unMount:new Set,array:new Set,watch:new Set},h=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},f={values:r_(),array:r_(),state:r_()},p=BS(r.mode),m=BS(r.reValidateMode),g=r.criteriaMode===gS,v=async e=>{if(!r.disabled&&(d.isValid||e)){const e=r.resolver?MS((await S()).errors):await _(i,!0);e!==n.isValid&&f.state.next({isValid:e})}},y=(e,t)=>{r.disabled||!d.isValidating&&!d.validatingFields||((e||Array.from(c.mount)).forEach((e=>{e&&(t?lS(n.validatingFields,e,t):t_(n.validatingFields,e))})),f.state.next({validatingFields:n.validatingFields,isValidating:!MS(n.validatingFields)}))},b=(e,t,r,n)=>{const s=iS(i,e);if(s){const i=iS(o,e,nS(r)?iS(a,e):r);nS(i)||n&&n.defaultChecked||t?lS(o,e,t?i:d_(s._f)):A(e,i),l.mount&&v()}},w=(e,t,s,o,l)=>{let c=!1,u=!1;const h={name:e};if(!r.disabled){const r=!!(iS(i,e)&&iS(i,e)._f&&iS(i,e)._f.disabled);if(!s||o){d.isDirty&&(u=n.isDirty,n.isDirty=h.isDirty=C(),c=u!==h.isDirty);const i=r||i_(iS(a,e),t);u=!(r||!iS(n.dirtyFields,e)),i||r?t_(n.dirtyFields,e):lS(n.dirtyFields,e,!0),h.dirtyFields=n.dirtyFields,c=c||d.dirtyFields&&u!==!i}if(s){const t=iS(n.touchedFields,e);t||(lS(n.touchedFields,e,s),h.touchedFields=n.touchedFields,c=c||d.touchedFields&&t!==s)}c&&l&&f.state.next(h)}return c?h:{}},x=(t,i,s,a)=>{const o=iS(n.errors,t),l=d.isValid&&sS(i)&&n.isValid!==i;var c;if(r.delayError&&s?(c=()=>((e,t)=>{lS(n.errors,e,t),f.state.next({errors:n.errors})})(t,s),e=e=>{clearTimeout(h),h=setTimeout(c,e)},e(r.delayError)):(clearTimeout(h),e=null,s?lS(n.errors,t,s):t_(n.errors,t)),(s?!i_(o,s):o)||!MS(a)||l){const e=u(u(u({},a),l&&sS(i)?{isValid:i}:{}),{},{errors:n.errors,name:t});n=u(u({},n),e),f.state.next(e)}},S=async e=>{y(e,!0);const t=await r.resolver(o,r.context,((e,t,r,n)=>{const i={};for(const s of e){const e=iS(t,s);e&&lS(i,s,e._f)}return{criteriaMode:r,names:[...e],fields:i,shouldUseNativeValidation:n}})(e||c.mount,i,r.criteriaMode,r.shouldUseNativeValidation));return y(e),t},_=async function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{valid:!0};for(const l in e){const u=e[l];if(u){const{_f:e}=u,h=s(u,Gx);if(e){const s=c.array.has(e.name),h=u._f&&(!!(a=u._f)&&!!a.validate&&!!(VS(a.validate)&&a.validate.constructor.name===p_||Zx(a.validate)&&Object.values(a.validate).find((e=>e.constructor.name===p_))));h&&d.validatingFields&&y([l],!0);const f=await e_(u,o,g,r.shouldUseNativeValidation&&!t,s);if(h&&d.validatingFields&&y([l]),f[e.name]&&(i.valid=!1,t))break;!t&&(iS(f,e.name)?s?jS(n.errors,f,e.name):lS(n.errors,e.name,f[e.name]):t_(n.errors,e.name))}!MS(h)&&await _(h,t,i)}}var a;return i.valid},C=(e,t)=>!r.disabled&&(e&&t&&lS(o,e,t),!i_(I(),a)),E=(e,t,r)=>OS(e,c,u({},l.mount?o:nS(t)?a:IS(e)?{[e]:t}:t),r,t),A=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=iS(i,e);let s=t;if(n){const r=n._f;r&&(!r.disabled&&lS(o,e,h_(t,r)),s=HS(r.ref)&&Kx(t)?"":t,s_(r.ref)?[...r.ref.options].forEach((e=>e.selected=s.includes(e.value))):r.refs?Xx(r.ref)?r.refs.length>1?r.refs.forEach((e=>(!e.defaultChecked||!e.disabled)&&(e.checked=Array.isArray(s)?!!s.find((t=>t===e.value)):s===e.value))):r.refs[0]&&(r.refs[0].checked=!!s):r.refs.forEach((e=>e.checked=e.value===s)):US(r.ref)?r.ref.value="":(r.ref.value=s,r.ref.type||f.values.next({name:e,values:u({},o)})))}(r.shouldDirty||r.shouldTouch)&&w(e,s,r.shouldTouch,r.shouldDirty,!0),r.shouldValidate&&D(e)},M=(e,t,r)=>{for(const n in t){const s=t[n],a="".concat(e,".").concat(n),o=iS(i,a);(c.array.has(e)||Zx(s)||o&&!o._f)&&!Yx(s)?M(a,s,r):A(a,s,r)}},T=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=iS(i,e),h=c.array.has(e),p=tS(t);lS(o,e,p),h?(f.array.next({name:e,values:u({},o)}),(d.isDirty||d.dirtyFields)&&r.shouldDirty&&f.state.next({name:e,dirtyFields:u_(a,o),isDirty:C(e,p)})):!s||s._f||Kx(p)?A(e,p,r):M(e,p,r),zS(e,c)&&f.state.next(u({},n)),f.values.next({name:l.mount?e:void 0,values:u({},o)})},P=async t=>{l.mount=!0;const s=t.target;let a=s.name,h=!0;const b=iS(i,a),C=e=>{h=Number.isNaN(e)||Yx(e)&&isNaN(e.getTime())||i_(e,iS(o,a,e))};if(b){let l,A;const M=s.type?d_(b._f):Jx(t),T=t.type===cS||t.type===uS,P=!((E=b._f).mount&&(E.required||E.min||E.max||E.maxLength||E.minLength||E.pattern||E.validate))&&!r.resolver&&!iS(n.errors,a)&&!b._f.deps||((e,t,r,n,i)=>!i.isOnAll&&(!r&&i.isOnTouch?!(t||e):(r?n.isOnBlur:i.isOnBlur)?!e:!(r?n.isOnChange:i.isOnChange)||e))(T,iS(n.touchedFields,a),n.isSubmitted,m,p),k=zS(a,c,T);lS(o,a,M),T?(b._f.onBlur&&b._f.onBlur(t),e&&e(0)):b._f.onChange&&b._f.onChange(t);const I=w(a,M,T,!1),O=!MS(I)||k;if(!T&&f.values.next({name:a,type:t.type,values:u({},o)}),P)return d.isValid&&("onBlur"===r.mode?T&&v():v()),O&&f.state.next(u({name:a},k?{}:I));if(!T&&k&&f.state.next(u({},n)),r.resolver){const{errors:e}=await S([a]);if(C(M),h){const t=m_(n.errors,i,a),r=m_(e,i,t.name||a);l=r.error,a=r.name,A=MS(e)}}else y([a],!0),l=(await e_(b,o,g,r.shouldUseNativeValidation))[a],y([a]),C(M),h&&(l?A=!1:d.isValid&&(A=await _(i,!0)));h&&(b._f.deps&&D(b._f.deps),x(a,A,l,I))}var E},k=(e,t)=>{if(iS(n.errors,t)&&e.focus)return e.focus(),1},D=async function(e){let t,s,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=PS(e);if(r.resolver){const r=await(async e=>{const{errors:t}=await S(e);if(e)for(const r of e){const e=iS(t,r);e?lS(n.errors,r,e):t_(n.errors,r)}else n.errors=t;return t})(nS(e)?e:o);t=MS(r),s=e?!o.some((e=>iS(r,e))):t}else e?(s=(await Promise.all(o.map((async e=>{const t=iS(i,e);return await _(t&&t._f?{[e]:t}:t)})))).every(Boolean),(s||n.isValid)&&v()):s=t=await _(i);return f.state.next(u(u(u({},!IS(e)||d.isValid&&t!==n.isValid?{}:{name:e}),r.resolver||!e?{isValid:t}:{}),{},{errors:n.errors})),a.shouldFocus&&!s&&FS(i,k,e?o:c.mount),s},I=e=>{const t=u({},l.mount?o:a);return nS(e)?t:IS(e)?iS(t,e):e.map((e=>iS(t,e)))},O=(e,t)=>({invalid:!!iS((t||n).errors,e),isDirty:!!iS((t||n).dirtyFields,e),error:iS((t||n).errors,e),isValidating:!!iS(n.validatingFields,e),isTouched:!!iS((t||n).touchedFields,e)}),R=(e,t,r)=>{const a=(iS(i,e,{_f:{}})._f||{}).ref,o=iS(n.errors,e)||{},{ref:l,message:c,type:h}=o,d=s(o,qx);lS(n.errors,e,u(u(u({},d),t),{},{ref:a})),f.state.next({name:e,errors:n.errors,isValid:!1}),r&&r.shouldFocus&&a&&a.focus&&a.focus()},L=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(const s of e?PS(e):c.mount)c.mount.delete(s),c.array.delete(s),t.keepValue||(t_(i,s),t_(o,s)),!t.keepError&&t_(n.errors,s),!t.keepDirty&&t_(n.dirtyFields,s),!t.keepTouched&&t_(n.touchedFields,s),!t.keepIsValidating&&t_(n.validatingFields,s),!r.shouldUnregister&&!t.keepDefaultValue&&t_(a,s);f.values.next({values:u({},o)}),f.state.next(u(u({},n),t.keepDirty?{isDirty:C()}:{})),!t.keepIsValid&&v()},N=e=>{let{disabled:t,name:r,field:n,fields:i,value:s}=e;if(sS(t)&&l.mount||t){const e=t?void 0:nS(s)?d_(n?n._f:iS(i,r)._f):s;(t||!t&&!nS(e))&&lS(o,r,e),w(r,e,!1,!1,!0)}},B=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=iS(i,e);const s=sS(t.disabled)||sS(r.disabled);return lS(i,e,u(u({},n||{}),{},{_f:u(u({},n&&n._f?n._f:{ref:{name:e}}),{},{name:e,mount:!0},t)})),c.mount.add(e),n?N({field:n,disabled:sS(t.disabled)?t.disabled:r.disabled,name:e,value:t.value}):b(e,!0,t.value),u(u(u({},s?{disabled:t.disabled||r.disabled}:{}),r.progressive?{required:!!t.required,min:f_(t.min),max:f_(t.max),minLength:f_(t.minLength),maxLength:f_(t.maxLength),pattern:f_(t.pattern)}:{}),{},{name:e,onChange:P,onBlur:P,ref:s=>{if(s){B(e,t),n=iS(i,e);const r=nS(s.value)&&s.querySelectorAll&&s.querySelectorAll("input,select,textarea")[0]||s,o=(e=>GS(e)||Xx(e))(r),l=n._f.refs||[];if(o?l.find((e=>e===r)):r===n._f.ref)return;lS(i,e,{_f:u(u({},n._f),o?{refs:[...l.filter(a_),r,...Array.isArray(iS(a,e))?[{}]:[]],ref:{type:r.type,name:e}}:{ref:r})}),b(e,!1,void 0,r)}else n=iS(i,e,{}),n._f&&(n._f.mount=!1),(r.shouldUnregister||t.shouldUnregister)&&(!$x(c.array,e)||!l.action)&&c.unMount.add(e)}})},z=()=>r.shouldFocusError&&FS(i,k,c.mount),F=(e,t)=>async s=>{let a;if(s&&(s.preventDefault&&s.preventDefault(),s.persist&&s.persist()),r.disabled)return void(t&&await t(u({},n.errors),s));let l=tS(o);if(f.state.next({isSubmitting:!0}),r.resolver){const{errors:e,values:t}=await S();n.errors=e,l=t}else await _(i);if(t_(n.errors,"root"),MS(n.errors)){f.state.next({errors:{}});try{await e(l,s)}catch(c){a=c}}else t&&await t(u({},n.errors),s),z(),setTimeout(z);if(f.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:MS(n.errors)&&!a,submitCount:n.submitCount+1,errors:n.errors}),a)throw a},j=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=e?tS(e):a,h=tS(s),p=MS(e),m=p?a:h;if(t.keepDefaultValues||(a=s),!t.keepValues){if(t.keepDirtyValues){const e=new Set([...c.mount,...Object.keys(u_(a,o))]);for(const t of Array.from(e))iS(n.dirtyFields,t)?lS(m,t,iS(o,t)):T(t,iS(m,t))}else{if(eS&&nS(e))for(const e of c.mount){const t=iS(i,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(HS(e)){const t=e.closest("form");if(t){t.reset();break}}}}i={}}o=r.shouldUnregister?t.keepDefaultValues?tS(a):{}:tS(m),f.array.next({values:u({},m)}),f.values.next({values:u({},m)})}c={mount:t.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},l.mount=!d.isValid||!!t.keepIsValid||!!t.keepDirtyValues,l.watch=!!r.shouldUnregister,f.state.next({submitCount:t.keepSubmitCount?n.submitCount:0,isDirty:!p&&(t.keepDirty?n.isDirty:!(!t.keepDefaultValues||i_(e,a))),isSubmitted:!!t.keepIsSubmitted&&n.isSubmitted,dirtyFields:p?{}:t.keepDirtyValues?t.keepDefaultValues&&o?u_(a,o):n.dirtyFields:t.keepDefaultValues&&e?u_(a,e):t.keepDirty?n.dirtyFields:{},touchedFields:t.keepTouched?n.touchedFields:{},errors:t.keepErrors?n.errors:{},isSubmitSuccessful:!!t.keepIsSubmitSuccessful&&n.isSubmitSuccessful,isSubmitting:!1})},U=(e,t)=>j(VS(e)?e(o):e,t);return{control:{register:B,unregister:L,getFieldState:O,handleSubmit:F,setError:R,_executeSchema:S,_getWatch:E,_getDirty:C,_updateValid:v,_removeUnmounted:()=>{for(const e of c.unMount){const t=iS(i,e);t&&(t._f.refs?t._f.refs.every((e=>!a_(e))):!a_(t._f.ref))&&L(e)}c.unMount=new Set},_updateFieldArray:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0,u=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],h=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(c&&s&&!r.disabled){if(l.action=!0,h&&Array.isArray(iS(i,e))){const t=s(iS(i,e),c.argA,c.argB);u&&lS(i,e,t)}if(h&&Array.isArray(iS(n.errors,e))){const t=s(iS(n.errors,e),c.argA,c.argB);u&&lS(n.errors,e,t),((e,t)=>{!rS(iS(e,t)).length&&t_(e,t)})(n.errors,e)}if(d.touchedFields&&h&&Array.isArray(iS(n.touchedFields,e))){const t=s(iS(n.touchedFields,e),c.argA,c.argB);u&&lS(n.touchedFields,e,t)}d.dirtyFields&&(n.dirtyFields=u_(a,o)),f.state.next({name:e,isDirty:C(e,t),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else lS(o,e,t)},_updateDisabledField:N,_getFieldArray:e=>rS(iS(l.mount?o:a,e,r.shouldUnregister?iS(a,e,[]):[])),_reset:j,_resetDefaultValues:()=>VS(r.defaultValues)&&r.defaultValues().then((e=>{U(e,r.resetOptions),f.state.next({isLoading:!1})})),_updateFormState:e=>{n=u(u({},n),e)},_disableForm:e=>{sS(e)&&(f.state.next({disabled:e}),FS(i,((t,r)=>{const n=iS(i,r);n&&(t.disabled=n._f.disabled||e,Array.isArray(n._f.refs)&&n._f.refs.forEach((t=>{t.disabled=n._f.disabled||e})))}),0,!1))},_subjects:f,_proxyFormState:d,_setErrors:e=>{n.errors=e,f.state.next({errors:n.errors,isValid:!1})},get _fields(){return i},get _formValues(){return o},get _state(){return l},set _state(e){l=e},get _defaultValues(){return a},get _names(){return c},set _names(e){c=e},get _formState(){return n},set _formState(e){n=e},get _options(){return r},set _options(e){r=u(u({},r),e)}},trigger:D,register:B,handleSubmit:F,watch:(e,t)=>VS(e)?f.values.subscribe({next:r=>e(E(void 0,t),r)}):E(e,t,!0),setValue:T,getValues:I,reset:U,resetField:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};iS(i,e)&&(nS(t.defaultValue)?T(e,tS(iS(a,e))):(T(e,t.defaultValue),lS(a,e,tS(t.defaultValue))),t.keepTouched||t_(n.touchedFields,e),t.keepDirty||(t_(n.dirtyFields,e),n.isDirty=t.defaultValue?C(e,tS(iS(a,e))):C()),t.keepError||(t_(n.errors,e),d.isValid&&v()),f.state.next(u({},n)))},clearErrors:e=>{e&&PS(e).forEach((e=>t_(n.errors,e))),f.state.next({errors:e?n.errors:{}})},unregister:L,setError:R,setFocus:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=iS(i,e),n=r&&r._f;if(n){const e=n.refs?n.refs[0]:n.ref;e.focus&&(e.focus(),t.shouldSelect&&VS(e.select)&&e.select())}},getFieldState:O}}function y_(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=e.useRef(void 0),n=e.useRef(void 0),[i,s]=e.useState({isDirty:!1,isValidating:!1,isLoading:VS(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,defaultValues:VS(t.defaultValues)?void 0:t.defaultValues});r.current||(r.current=u(u({},v_(t)),{},{formState:i}));const a=r.current.control;return a._options=t,DS({subject:a._subjects.state,next:e=>{TS(e,a._proxyFormState,a._updateFormState,!0)&&s(u({},a._formState))}}),e.useEffect((()=>a._disableForm(t.disabled)),[a,t.disabled]),e.useEffect((()=>{if(a._proxyFormState.isDirty){const e=a._getDirty();e!==i.isDirty&&a._subjects.state.next({isDirty:e})}}),[a,i.isDirty]),e.useEffect((()=>{t.values&&!i_(t.values,n.current)?(a._reset(t.values,a._options.resetOptions),n.current=t.values,s((e=>u({},e)))):a._resetDefaultValues()}),[t.values,a]),e.useEffect((()=>{t.errors&&a._setErrors(t.errors)}),[t.errors,a]),e.useEffect((()=>{a._state.mount||(a._updateValid(),a._state.mount=!0),a._state.watch&&(a._state.watch=!1,a._subjects.state.next(u({},a._formState))),a._removeUnmounted()})),e.useEffect((()=>{t.shouldUnregister&&a._subjects.values.next({values:a._getWatch()})}),[t.shouldUnregister,a]),r.current.formState=AS(i,a),r.current}function b_(e){return ka("PrivateSwitchBase",e)}Da("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const w_=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],x_=eo(wp)({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:e=>{let{edge:t,ownerState:r}=e;return"start"===t&&"small"!==r.size},style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:e=>{let{edge:t,ownerState:r}=e;return"end"===t&&"small"!==r.size},style:{marginRight:-12}}]}),S_=eo("input",{shouldForwardProp:Ja})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),__=e.forwardRef((function(e,t){const{autoFocus:r,checked:n,checkedIcon:i,className:a,defaultChecked:o,disabled:l,disableFocusRipple:c=!1,edge:h=!1,icon:d,id:f,inputProps:p,inputRef:m,name:g,onBlur:v,onChange:y,onFocus:b,readOnly:w,required:x=!1,tabIndex:S,type:_,value:C}=e,E=s(e,w_),[A,M]=ch({controlled:n,default:Boolean(o),name:"SwitchBase",state:"checked"}),T=Ro();let P=l;T&&"undefined"===typeof P&&(P=T.disabled);const k="checkbox"===_||"radio"===_,D=u(u({},e),{},{checked:A,disabled:P,disableFocusRipple:c,edge:h}),I=(e=>{const{classes:t,checked:r,disabled:n,edge:i}=e;return Na({root:["root",r&&"checked",n&&"disabled",i&&"edge".concat(io(i))],input:["input"]},b_,t)})(D);return(0,bt.jsxs)(x_,u(u({component:"span",className:ua(I.root,a),centerRipple:!0,focusRipple:!c,disabled:P,tabIndex:null,role:void 0,onFocus:e=>{b&&b(e),T&&T.onFocus&&T.onFocus(e)},onBlur:e=>{v&&v(e),T&&T.onBlur&&T.onBlur(e)},ownerState:D,ref:t},E),{},{children:[(0,bt.jsx)(S_,u(u({autoFocus:r,checked:n,defaultChecked:o,className:I.input,disabled:P,id:k?f:void 0,name:g,onChange:e=>{if(e.nativeEvent.defaultPrevented)return;const t=e.target.checked;M(t),y&&y(e,t)},readOnly:w,ref:m,required:x,ownerState:D,tabIndex:S,type:_},"checkbox"===_&&void 0===C?{}:{value:C}),p)),A?i:d]}))})),C_=__,E_=Ah((0,bt.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),A_=Ah((0,bt.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),M_=Ah((0,bt.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function T_(e){return ka("MuiCheckbox",e)}const P_=Da("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),k_=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","disableRipple","className"],D_=eo(C_,{shouldForwardProp:e=>Ja(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.indeterminate&&t.indeterminate,t["size".concat(io(r.size))],"default"!==r.color&&t["color".concat(io(r.color))]]}})(ro((e=>{let{theme:t}=e;return{color:(t.vars||t).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.activeChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):Dt(t.palette.action.active,t.palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter(so()).map((e=>{let[r]=e;return{props:{color:r,disableRipple:!1},style:{"&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette[r].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):Dt(t.palette[r].main,t.palette.action.hoverOpacity)}}}})),...Object.entries(t.palette).filter(so()).map((e=>{let[r]=e;return{props:{color:r},style:{["&.".concat(P_.checked,", &.").concat(P_.indeterminate)]:{color:(t.vars||t).palette[r].main},["&.".concat(P_.disabled)]:{color:(t.vars||t).palette.action.disabled}}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}}))),I_=(0,bt.jsx)(A_,{}),O_=(0,bt.jsx)(E_,{}),R_=(0,bt.jsx)(M_,{}),L_=e.forwardRef((function(t,r){var n,i;const a=no({props:t,name:"MuiCheckbox"}),{checkedIcon:o=I_,color:l="primary",icon:c=O_,indeterminate:h=!1,indeterminateIcon:d=R_,inputProps:f,size:p="medium",disableRipple:m=!1,className:g}=a,v=s(a,k_),y=h?d:c,b=h?d:o,w=u(u({},a),{},{disableRipple:m,color:l,indeterminate:h,size:p}),x=(e=>{const{classes:t,indeterminate:r,color:n,size:i}=e,s=Na({root:["root",r&&"indeterminate","color".concat(io(n)),"size".concat(io(i))]},T_,t);return u(u({},t),s)})(w);return(0,bt.jsx)(D_,u(u({type:"checkbox",inputProps:u({"data-indeterminate":h},f),icon:e.cloneElement(y,{fontSize:null!==(n=y.props.fontSize)&&void 0!==n?n:p}),checkedIcon:e.cloneElement(b,{fontSize:null!==(i=b.props.fontSize)&&void 0!==i?i:p}),ownerState:w,ref:r,className:ua(x.root,g),disableRipple:m},v),{},{classes:x}))})),N_=L_,B_=Ah((0,bt.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),z_=Ah((0,bt.jsx)("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"}),"ContentCopy"),F_=Ah((0,bt.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M17 13l-5 5-5-5h3V9h4v4z"}),"CloudDownload"),j_=Ah((0,bt.jsx)("path",{d:"M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2m-1 8V6h2v4h3l-4 4-4-4zm6 7H7v-2h10z"}),"DownloadForOffline"),U_=Ah((0,bt.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete"),V_=["theme","type","isLoading"];!function(e){if(!e||"undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}(':root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}\n');var H_=e=>"number"==typeof e&&!isNaN(e),W_=e=>"string"==typeof e,G_=e=>"function"==typeof e,q_=e=>W_(e)||G_(e)?e:null,X_=(e,t)=>!1===e||H_(e)&&e>0?e:t,Y_=t=>(0,e.isValidElement)(t)||W_(t)||G_(t)||H_(t);function K_(t){let{enter:r,exit:n,appendPosition:i=!1,collapse:s=!0,collapseDuration:a=300}=t;return function(t){let{children:o,position:l,preventExitTransition:c,done:u,nodeRef:h,isIn:d,playToast:f}=t,p=i?"".concat(r,"--").concat(l):r,m=i?"".concat(n,"--").concat(l):n,g=(0,e.useRef)(0);return(0,e.useLayoutEffect)((()=>{let e=h.current,t=p.split(" "),r=n=>{n.target===h.current&&(f(),e.removeEventListener("animationend",r),e.removeEventListener("animationcancel",r),0===g.current&&"animationcancel"!==n.type&&e.classList.remove(...t))};e.classList.add(...t),e.addEventListener("animationend",r),e.addEventListener("animationcancel",r)}),[]),(0,e.useEffect)((()=>{let e=h.current,t=()=>{e.removeEventListener("animationend",t),s?function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,{scrollHeight:n,style:i}=e;requestAnimationFrame((()=>{i.minHeight="initial",i.height=n+"px",i.transition="all ".concat(r,"ms"),requestAnimationFrame((()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(t,r)}))}))}(e,u,a):u()};d||(c?t():(g.current=1,e.className+=" ".concat(m),e.addEventListener("animationend",t)))}),[d]),e.createElement(e.Fragment,null,o)}}function Q_(e,t){return{content:Z_(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function Z_(t,r){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,e.isValidElement)(t)&&!W_(t.type)?(0,e.cloneElement)(t,{closeToast:r.closeToast,toastProps:r,data:r.data,isPaused:n}):G_(t)?t({closeToast:r.closeToast,toastProps:r,data:r.data,isPaused:n}):t}function J_(t){let{delay:r,isRunning:n,closeToast:i,type:s="default",hide:a,className:o,controlledProgress:l,progress:c,rtl:h,isIn:d,theme:f}=t,p=a||l&&0===c,m={animationDuration:"".concat(r,"ms"),animationPlayState:n?"running":"paused"};l&&(m.transform="scaleX(".concat(c,")"));let g=ua("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated","Toastify__progress-bar-theme--".concat(f),"Toastify__progress-bar--".concat(s),{"Toastify__progress-bar--rtl":h}),v=G_(o)?o({rtl:h,type:s,defaultClassName:g}):ua(g,o),y={[l&&c>=1?"onTransitionEnd":"onAnimationEnd"]:l&&c<1?null:()=>{d&&i()}};return e.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":p},e.createElement("div",{className:"Toastify__progress-bar--bg Toastify__progress-bar-theme--".concat(f," Toastify__progress-bar--").concat(s)}),e.createElement("div",u({role:"progressbar","aria-hidden":p?"true":"false","aria-label":"notification timer",className:v,style:m},y)))}var $_=1,eC=()=>"".concat($_++);function tC(e,t,r){let n=1,i=0,s=[],a=[],o=t,l=new Map,c=new Set,h=()=>{a=Array.from(l.values()),c.forEach((e=>e()))},d=e=>{var t,r;null==(r=null==(t=e.props)?void 0:t.onClose)||r.call(t,e.removalReason),e.isActive=!1},f=e=>{if(null==e)l.forEach(d);else{let t=l.get(e);t&&d(t)}h()},p=e=>{var t,n;let{toastId:i,updateId:s}=e.props,a=null==s;e.staleId&&l.delete(e.staleId),e.isActive=!0,l.set(i,e),h(),r(Q_(e,a?"added":"updated")),a&&(null==(n=(t=e.props).onOpen)||n.call(t))};return{id:e,props:o,observe:e=>(c.add(e),()=>c.delete(e)),toggle:(e,t)=>{l.forEach((r=>{var n;(null==t||t===r.props.toastId)&&(null==(n=r.toggle)||n.call(r,e))}))},removeToast:f,toasts:l,clearQueue:()=>{i-=s.length,s=[]},buildToast:(t,a)=>{if((t=>{let{containerId:r,toastId:n,updateId:i}=t,s=r?r!==e:1!==e,a=l.has(n)&&null==i;return s||a})(a))return;let{toastId:c,updateId:d,data:m,staleId:g,delay:v}=a,y=null==d;y&&i++;let b=u(u(u({},o),{},{style:o.toastStyle,key:n++},Object.fromEntries(Object.entries(a).filter((e=>{let[t,r]=e;return null!=r})))),{},{toastId:c,updateId:d,data:m,isIn:!1,className:q_(a.className||o.toastClassName),progressClassName:q_(a.progressClassName||o.progressClassName),autoClose:!a.isLoading&&X_(a.autoClose,o.autoClose),closeToast(e){l.get(c).removalReason=e,f(c)},deleteToast(){let e=l.get(c);if(null!=e){if(r(Q_(e,"removed")),l.delete(c),i--,i<0&&(i=0),s.length>0)return void p(s.shift());h()}}});b.closeButton=o.closeButton,!1===a.closeButton||Y_(a.closeButton)?b.closeButton=a.closeButton:!0===a.closeButton&&(b.closeButton=!Y_(o.closeButton)||o.closeButton);let w={content:t,props:b,staleId:g};o.limit&&o.limit>0&&i>o.limit&&y?s.push(w):H_(v)?setTimeout((()=>{p(w)}),v):p(w)},setProps(e){o=e},setToggle:(e,t)=>{let r=l.get(e);r&&(r.toggle=t)},isToastActive:e=>{var t;return null==(t=l.get(e))?void 0:t.isActive},getSnapshot:()=>a}}var rC=new Map,nC=[],iC=new Set,sC=e=>iC.forEach((t=>t(e))),aC=()=>rC.size>0;function oC(e,t){var r;if(t)return!(null==(r=rC.get(t))||!r.isToastActive(e));let n=!1;return rC.forEach((t=>{t.isToastActive(e)&&(n=!0)})),n}function lC(e){if(aC()){if(null==e||(e=>W_(e)||H_(e))(e))rC.forEach((t=>{t.removeToast(e)}));else if(e&&("containerId"in e||"id"in e)){let t=rC.get(e.containerId);t?t.removeToast(e.id):rC.forEach((t=>{t.removeToast(e.id)}))}}else nC=nC.filter((t=>null!=e&&t.options.toastId!==e))}function cC(e,t){Y_(e)&&(aC()||nC.push({content:e,options:t}),rC.forEach((r=>{r.buildToast(e,t)})))}function uC(e,t){rC.forEach((r=>{(null==t||null==t||!t.containerId||(null==t?void 0:t.containerId)===r.id)&&r.toggle(e,null==t?void 0:t.id)}))}function hC(e){let t=e.containerId||1;return{subscribe(r){let n=tC(t,e,sC);rC.set(t,n);let i=n.observe(r);return nC.forEach((e=>cC(e.content,e.options))),nC=[],()=>{i(),rC.delete(t)}},setProps(e){var r;null==(r=rC.get(t))||r.setProps(e)},getSnapshot(){var e;return null==(e=rC.get(t))?void 0:e.getSnapshot()}}}function dC(e){return e&&(W_(e.toastId)||H_(e.toastId))?e.toastId:eC()}function fC(e,t){return cC(e,t),t.toastId}function pC(e,t){return u(u({},t),{},{type:t&&t.type||e,toastId:dC(t)})}function mC(e){return(t,r)=>fC(t,pC(e,r))}function gC(e,t){return fC(e,pC("default",t))}function vC(t){let[r,n]=(0,e.useState)(!1),[i,s]=(0,e.useState)(!1),a=(0,e.useRef)(null),o=(0,e.useRef)({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:c,closeToast:u,onClick:h,closeOnClick:d}=t;function f(){n(!0)}function p(){n(!1)}function m(e){let n=a.current;if(o.canDrag&&n){o.didMove=!0,r&&p(),"x"===t.draggableDirection?o.delta=e.clientX-o.start:o.delta=e.clientY-o.start,o.start!==e.clientX&&(o.canCloseOnClick=!1);let i="x"===t.draggableDirection?"".concat(o.delta,"px, var(--y)"):"0, calc(".concat(o.delta,"px + var(--y))");n.style.transform="translate3d(".concat(i,",0)"),n.style.opacity="".concat(1-Math.abs(o.delta/o.removalDistance))}}function g(){document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",g);let e=a.current;if(o.canDrag&&o.didMove&&e){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance)return s(!0),t.closeToast(!0),void t.collapseAll();e.style.transition="transform 0.2s, opacity 0.2s",e.style.removeProperty("transform"),e.style.removeProperty("opacity")}}(function(e){var t;null==(t=rC.get(e.containerId||1))||t.setToggle(e.id,e.fn)})({id:t.toastId,containerId:t.containerId,fn:n}),(0,e.useEffect)((()=>{if(t.pauseOnFocusLoss)return document.hasFocus()||p(),window.addEventListener("focus",f),window.addEventListener("blur",p),()=>{window.removeEventListener("focus",f),window.removeEventListener("blur",p)}}),[t.pauseOnFocusLoss]);let v={onPointerDown:function(e){if(!0===t.draggable||t.draggable===e.pointerType){o.didMove=!1,document.addEventListener("pointermove",m),document.addEventListener("pointerup",g);let r=a.current;o.canCloseOnClick=!0,o.canDrag=!0,r.style.transition="none","x"===t.draggableDirection?(o.start=e.clientX,o.removalDistance=r.offsetWidth*(t.draggablePercent/100)):(o.start=e.clientY,o.removalDistance=r.offsetHeight*(80===t.draggablePercent?1.5*t.draggablePercent:t.draggablePercent)/100)}},onPointerUp:function(e){let{top:r,bottom:n,left:i,right:s}=a.current.getBoundingClientRect();"touchend"!==e.nativeEvent.type&&t.pauseOnHover&&e.clientX>=i&&e.clientX<=s&&e.clientY>=r&&e.clientY<=n?p():f()}};return l&&c&&(v.onMouseEnter=p,t.stacked||(v.onMouseLeave=f)),d&&(v.onClick=e=>{h&&h(e),o.canCloseOnClick&&u(!0)}),{playToast:f,pauseToast:p,isRunning:r,preventExitTransition:i,toastRef:a,eventHandlers:v}}gC.loading=(e,t)=>fC(e,pC("default",u({isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1},t))),gC.promise=function(e,t,r){let n,{pending:i,error:s,success:a}=t;i&&(n=W_(i)?gC.loading(i,r):gC.loading(i.render,u(u({},r),i)));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(e,t,i)=>{if(null==t)return void gC.dismiss(n);let s=u(u(u({type:e},o),r),{},{data:i}),a=W_(t)?{render:t}:t;return n?gC.update(n,u(u({},s),a)):gC(a.render,u(u({},s),a)),i},c=G_(e)?e():e;return c.then((e=>l("success",a,e))).catch((e=>l("error",s,e))),c},gC.success=mC("success"),gC.info=mC("info"),gC.error=mC("error"),gC.warning=mC("warning"),gC.warn=gC.warning,gC.dark=(e,t)=>fC(e,pC("default",u({theme:"dark"},t))),gC.dismiss=function(e){lC(e)},gC.clearWaitingQueue=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};rC.forEach((t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()}))},gC.isActive=oC,gC.update=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=((e,t)=>{let{containerId:r}=t;var n;return null==(n=rC.get(r||1))?void 0:n.toasts.get(e)})(e,t);if(r){let{props:n,content:i}=r,s=u(u(u({delay:100},n),t),{},{toastId:t.toastId||e,updateId:eC()});s.toastId!==e&&(s.staleId=e);let a=s.render||i;delete s.render,fC(a,s)}},gC.done=e=>{gC.update(e,{progress:1})},gC.onChange=function(e){return iC.add(e),()=>{iC.delete(e)}},gC.play=e=>uC(!0,e),gC.pause=e=>uC(!1,e);var yC="undefined"!=typeof window?e.useLayoutEffect:e.useEffect,bC=t=>{let{theme:r,type:n,isLoading:i}=t,a=s(t,V_);return e.createElement("svg",u({viewBox:"0 0 24 24",width:"100%",height:"100%",fill:"colored"===r?"currentColor":"var(--toastify-icon-color-".concat(n,")")},a))};var wC={info:function(t){return e.createElement(bC,u({},t),e.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(t){return e.createElement(bC,u({},t),e.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(t){return e.createElement(bC,u({},t),e.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(t){return e.createElement(bC,u({},t),e.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return e.createElement("div",{className:"Toastify__spinner"})}};function xC(t){let{theme:r,type:n,isLoading:i,icon:s}=t,a=null,o={theme:r,type:n};return!1===s||(G_(s)?a=s(u(u({},o),{},{isLoading:i})):(0,e.isValidElement)(s)?a=(0,e.cloneElement)(s,o):i?a=wC.spinner():(e=>e in wC)(n)&&(a=wC[n](o))),a}var SC=t=>{let{isRunning:r,preventExitTransition:n,toastRef:i,eventHandlers:s,playToast:a}=vC(t),{closeButton:o,children:l,autoClose:c,onClick:h,type:d,hideProgressBar:f,closeToast:p,transition:m,position:g,className:v,style:y,progressClassName:b,updateId:w,role:x,progress:S,rtl:_,toastId:C,deleteToast:E,isIn:A,isLoading:M,closeOnClick:T,theme:P,ariaLabel:k}=t,D=ua("Toastify__toast","Toastify__toast-theme--".concat(P),"Toastify__toast--".concat(d),{"Toastify__toast--rtl":_},{"Toastify__toast--close-on-click":T}),I=G_(v)?v({rtl:_,position:g,type:d,defaultClassName:D}):ua(D,v),O=xC(t),R=!!S||!c,L={closeToast:p,type:d,theme:P},N=null;return!1===o||(N=G_(o)?o(L):(0,e.isValidElement)(o)?(0,e.cloneElement)(o,L):function(t){let{closeToast:r,theme:n,ariaLabel:i="close"}=t;return e.createElement("button",{className:"Toastify__close-button Toastify__close-button--".concat(n),type:"button",onClick:e=>{e.stopPropagation(),r(!0)},"aria-label":i},e.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},e.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(L)),e.createElement(m,{isIn:A,done:E,position:g,preventExitTransition:n,nodeRef:i,playToast:a},e.createElement("div",u(u({id:C,tabIndex:0,onClick:h,"data-in":A,className:I},s),{},{style:y,ref:i},A&&{role:x,"aria-label":k}),null!=O&&e.createElement("div",{className:ua("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!M})},O),Z_(l,t,!r),N,!t.customProgressBar&&e.createElement(J_,u(u({},w&&!R?{key:"p-".concat(w)}:{}),{},{rtl:_,theme:P,delay:c,isRunning:r,isIn:A,closeToast:p,hide:f,type:d,className:b,controlledProgress:R,progress:S||0}))))},_C=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{enter:"Toastify--animate Toastify__".concat(e,"-enter"),exit:"Toastify--animate Toastify__".concat(e,"-exit"),appendPosition:t}},CC=K_(_C("bounce",!0)),EC=(K_(_C("slide",!0)),K_(_C("zoom")),K_(_C("flip")),{position:"top-right",transition:CC,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&"KeyT"===e.code});function AC(t){let r=u(u({},EC),t),n=t.stacked,[i,s]=(0,e.useState)(!0),a=(0,e.useRef)(null),{getToastToRender:o,isToastActive:l,count:c}=function(t){var r;let{subscribe:n,getSnapshot:i,setProps:s}=(0,e.useRef)(hC(t)).current;s(t);let a=null==(r=(0,e.useSyncExternalStore)(n,i,i))?void 0:r.slice();return{getToastToRender:function(e){if(!a)return[];let r=new Map;return t.newestOnTop&&a.reverse(),a.forEach((e=>{let{position:t}=e.props;r.has(t)||r.set(t,[]),r.get(t).push(e)})),Array.from(r,(t=>e(t[0],t[1])))},isToastActive:oC,count:null==a?void 0:a.length}}(r),{className:h,style:d,rtl:f,containerId:p,hotKeys:m}=r;function g(e){let t=ua("Toastify__toast-container","Toastify__toast-container--".concat(e),{"Toastify__toast-container--rtl":f});return G_(h)?h({position:e,rtl:f,defaultClassName:t}):ua(t,q_(h))}function v(){n&&(s(!0),gC.play())}return yC((()=>{var e;if(n){let t=a.current.querySelectorAll('[data-in="true"]'),n=12,s=null==(e=r.position)?void 0:e.includes("top"),o=0,l=0;Array.from(t).reverse().forEach(((e,t)=>{let r=e;r.classList.add("Toastify__toast--stacked"),t>0&&(r.dataset.collapsed="".concat(i)),r.dataset.pos||(r.dataset.pos=s?"top":"bot");let a=o*(i?.2:1)+(i?0:n*t);r.style.setProperty("--y","".concat(s?a:-1*a,"px")),r.style.setProperty("--g","".concat(n)),r.style.setProperty("--s","".concat(1-(i?l:0))),o+=r.offsetHeight,l+=.025}))}}),[i,c,n]),(0,e.useEffect)((()=>{function e(e){var t;let r=a.current;m(e)&&(null==(t=r.querySelector('[tabIndex="0"]'))||t.focus(),s(!1),gC.pause()),"Escape"===e.key&&(document.activeElement===r||null!=r&&r.contains(document.activeElement))&&(s(!0),gC.play())}return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[m]),e.createElement("section",{ref:a,className:"Toastify",id:p,onMouseEnter:()=>{n&&(s(!1),gC.pause())},onMouseLeave:v,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":r["aria-label"]},o(((t,r)=>{let i=r.length?u({},d):u(u({},d),{},{pointerEvents:"none"});return e.createElement("div",{tabIndex:-1,className:g(t),"data-stacked":n,style:i,key:"c-".concat(t)},r.map((t=>{let{content:r,props:i}=t;return e.createElement(SC,u(u({},i),{},{stacked:n,collapseAll:v,isIn:l(i.toastId,i.containerId),key:"t-".concat(i.key)}),r)})))})))}var MC=r(223),TC=r.n(MC),PC=r(450);const kC=(e,t)=>{let r={tekmelik:!1,itmelik:!1,menfez:!1,hidrolik:!1,"l\xfcmboz":!1,"yang\u0131naD":!1};e.forEach((e=>{1==e.tekmelik&&(r.tekmelik=!0),1==e.itmelik&&(r.itmelik=!0),1==e.menfez&&(r.menfez=!0),1==e.hidrolik&&(r.hidrolik=!0),1==e.lumboz&&(r.l\u00fcmboz=!0),1==e.yang\u0131naD&&(r.yang\u0131naD=!0)}));let n=0;r.tekmelik&&n++,r.itmelik&&n++,r.menfez&&n++,r.hidrolik&&n++,r.l\u00fcmboz&&n++,r.yang\u0131naD&&n++;(async()=>{const i=new(TC().Workbook),s=i.addWorksheet(""===t?"Project":t),a=i.addWorksheet("Al\xfcminyum Kasa"),o=i.addWorksheet("Laminat Kap\u0131 Kesim");let l;s.pageSetup={paperSize:9,orientation:"landscape",fitToPage:!0,fitToWidth:1,fitToHeight:1,margins:{left:.3,right:.3,top:.3,bottom:.3,header:.3,footer:.3}},a.pageSetup={paperSize:9,orientation:"landscape",fitToPage:!0,fitToWidth:1,fitToHeight:1,margins:{left:.3,right:.3,top:.3,bottom:.3,header:.3,footer:.3}},o.pageSetup={paperSize:9,orientation:"landscape",fitToPage:!0,fitToWidth:1,fitToHeight:1,margins:{left:.3,right:.3,top:.3,bottom:.3,header:.3,footer:.3}},0==n&&(l="A1:P1"),1==n&&(l="A1:Q1"),2==n&&(l="A1:R1"),3==n&&(l="A1:S1"),4==n&&(l="A1:T1"),5==n&&(l="A1:U1"),6==n&&(l="A1:V1"),s.mergeCells(l);const c=s.getRow(1);c.getCell(1).value=""===t?"Project":t,c.getCell(1).font={bold:!0,size:16},c.getCell(1).alignment={vertical:"middle",horizontal:"center"},c.border={top:{style:"bold"},left:{style:"bold"},bottom:{style:"bold"},right:{style:"bold"}},c.height=50,s.mergeCells("A2:J2"),s.mergeCells("K2:L2");const u=s.getRow(2);u.getCell(1).value="Yerinde Al\u0131nan \xd6l\xe7\xfc",u.getCell(1).font={bold:!0,size:12},u.getCell(11).value="Renk",u.getCell(11).font={bold:!0,size:12},u.height=50;s.addRow(["NO","T\u0130P","KAT","MAHAL NO","MAHAL","EN","BOY","D.K.","ADET","Y\xd6N","KANAT","KASA"]);const h=s.getRow(3);h.font={bold:!1,size:8},h.alignment={vertical:"middle",horizontal:"center",textRotation:"50"},h.height=35,h.eachCell(((e,t)=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.font={bold:!0}})),e.forEach(((e,t)=>{const n=[t+1,e.tip.toUpperCase(),e.kat.toUpperCase(),e.mahalNo.toUpperCase(),e.mahal.toUpperCase(),Number(e.en),Number(e.boy),Number(e.duvarKalinligi),1,e.yon.toUpperCase(),e.kanat.toUpperCase(),e.kasa.toUpperCase(),e.barel.toUpperCase(),e.kilit.toUpperCase(),e.cumba.toUpperCase(),e.kol.toUpperCase()];console.log("extrasCheck",r),r.tekmelik&&n.push(1==e.tekmelik?"\u2714\ufe0f":""),r.itmelik&&n.push(1==e.itmelik?"\u2714\ufe0f":""),r.menfez&&n.push(1==e.menfez?"\u2714\ufe0f":""),r.hidrolik&&n.push(1==e.hidrolik?"\u2714\ufe0f":""),r.l\u00fcmboz&&n.push(1==e.lumboz?"\u2714\ufe0f":""),r.yang\u0131naD&&n.push(1==e.yang\u0131naD?"\u2714\ufe0f":""),s.addRow(n).height=25})),s.eachRow(((e,t)=>{e.eachCell((e=>{e.alignment={vertical:"middle",horizontal:"center"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}))})),s.columns=[{width:5},{width:10},{width:10},{width:12},{width:15},{width:10},{width:10},{width:10},{width:10},{width:10},{width:10},{width:10},{width:10},{width:13},{width:10},{width:10},{width:5},{width:5},{width:5},{width:5},{width:5},{width:5}];const d=(e,t)=>{const[r,n,i,s]=e;for(let a=n;a<=s;a++)for(let e=r;e<=i;e++){t.getCell(a,e).border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}};s.mergeCells("M2:M3"),s.mergeCells("N2:N3"),s.mergeCells("O2:O3"),s.mergeCells("P2:P3"),s.mergeCells("Q2:Q3"),s.mergeCells("R2:R3"),s.mergeCells("S2:S3"),s.mergeCells("T2:T3"),s.mergeCells("U2:U3"),s.mergeCells("V2:V3");const f=["BAREL","K\u0130L\u0130T","CUMBA","KOL"];r.tekmelik&&f.push("TEKMEL\u0130K"),r.itmelik&&f.push("\u0130TMEL\u0130K"),r.menfez&&f.push("MENFEZ"),r.hidrolik&&f.push("H\u0130DROL\u0130K"),r.l\u00fcmboz&&f.push("L\xdcMBOZ"),r.yang\u0131naD&&f.push("YANGINA D."),f.forEach(((e,t)=>{const r=13+t,n=h.getCell(r);n.value=e,n.alignment={textRotation:90,vertical:"center",horizontal:"center"},n.font={bold:!0,size:12}})),d([13,2,13,3],s),d([14,2,14,3],s),d([15,2,15,3],s),d([16,2,16,3],s),n>=1&&d([17,2,17,3],s),n>=2&&d([18,2,18,3],s),n>=3&&d([19,2,19,3],s),n>=4&&d([20,2,20,3],s),n>=5&&d([21,2,21,3],s),6==n&&d([22,2,22,3],s),a.mergeCells("A1:N1");const p=a.getRow(1);p.getCell(1).value="AL\xdcM\u0130NYUM KASA KES\u0130M NET \xd6L\xc7\xdcS\xdc",p.getCell(1).font={bold:!0,size:16},p.getCell(1).alignment={vertical:"middle",horizontal:"center"},p.border={top:{style:"bold"},left:{style:"bold"},bottom:{style:"bold"},right:{style:"bold"}},p.height=50;a.addRow(["NO","T\u0130P","KAT","MAHAL NO","MAHAL","EN","BOY","D.K.","ADET","Y\xd6N","RENK","KASA","PERVAZ","EK"]);const m=a.getRow(2);m.font={bold:!1,size:8},m.alignment={vertical:"middle",horizontal:"center"},m.height=30,m.eachCell((e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.font={bold:!0}})),a.columns=[{width:5},{width:10},{width:10},{width:15},{width:15},{width:10},{width:10},{width:10},{width:10},{width:10},{width:10},{width:10},{width:10},{width:10}],e.forEach(((e,t)=>{let r,n="";switch(Number(e.duvarKalinligi)){case 9:case 10:case 11:r=60;break;case 12:case 13:case 14:r=90;break;case 15:case 16:case 17:r=120;break;case 18:case 19:case 20:r=140;break;case 21:case 22:r=120,n=45;break;case 23:case 24:r=140,n=45;break;case 25:case 26:r=120,n=85;break;case 27:case 28:case 29:r=140,n=85;break;default:r="Ge\xe7ersiz Duvar Kal\u0131nl\u0131\u011f\u0131"}const i=[t+1,e.tip.toUpperCase(),e.kat.toUpperCase(),e.mahalNo.toUpperCase(),e.mahal.toUpperCase(),Number(e.en)+4.4,Number(e.boy-.3),Number(e.duvarKalinligi),1,e.yon.toUpperCase(),e.kasa.toUpperCase(),35,r,n];a.addRow(i).height=25})),a.eachRow(((e,t)=>{e.eachCell((e=>{e.alignment={vertical:"middle",horizontal:"center"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}))})),o.mergeCells("A1:I1"),o.mergeCells("J1:K1");const g=o.getRow(1);g.getCell(1).value="LAM\u0130NAT KAPI KES\u0130M NET \xd6L\xc7\xdcS\xdc",g.getCell(11).value="KAPI CUMBASI",g.getCell(1).font={bold:!0,size:14},g.getCell(11).font={bold:!0,size:14},g.getCell(1).alignment={vertical:"middle",horizontal:"center"},g.getCell(2).alignment={vertical:"middle",horizontal:"center"},g.getCell(11).alignment={vertical:"middle",horizontal:"center"},g.height=60;o.addRow(["NO","T\u0130P","MAHAL","EN","BOY","D.K.","ADET","K\u0130L\u0130T","RENK","RENK","T\u0130P"]);const v=o.getRow(2);v.font={bold:!1,size:8},v.alignment={vertical:"middle",horizontal:"center"},v.height=30,v.eachCell((e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.font={bold:!0}})),o.columns=[{width:5},{width:10},{width:15},{width:10},{width:10},{width:10},{width:10},{width:15},{width:15},{width:15},{width:10}],e.forEach(((e,t)=>{const r=[t+1,e.tip.toUpperCase(),e.mahal.toUpperCase(),"pvc"==e.cumba?Number(e.en-7.9):Number(e.en-8.1),Number(e.boy-6),Number(e.duvarKalinligi),1,e.kilit.toUpperCase(),e.kanat.toUpperCase(),"???".toUpperCase(),e.cumba.toUpperCase()];o.addRow(r).height=25})),o.eachRow(((e,t)=>{e.eachCell((e=>{e.alignment={vertical:"middle",horizontal:"center"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}))}));const y=await i.xlsx.writeBuffer();(0,PC.saveAs)(new Blob([y]),"".concat(""===t?"Project":t,".xlsx"))})()},DC=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=63&i|128):55296===(64512&i)&&n+1<e.length&&56320===(64512&e.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++n)),t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=63&i|128)}return t},IC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,a=s?e[i+1]:0,o=i+2<e.length,l=o?e[i+2]:0,c=t>>2,u=(3&t)<<4|a>>4;let h=(15&a)<<2|l>>6,d=63&l;o||(d=64,s||(h=64)),n.push(r[c],r[u],r[h],r[d])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(DC(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let r=0,n=0;for(;r<e.length;){const i=e[r++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[r++];t[n++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536;t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))}else{const s=e[r++],a=e[r++];t[n++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<e.length;){const t=r[e.charAt(i++)],s=i<e.length?r[e.charAt(i)]:0;++i;const a=i<e.length?r[e.charAt(i)]:64;++i;const o=i<e.length?r[e.charAt(i)]:64;if(++i,null==t||null==s||null==a||null==o)throw new OC;const l=t<<2|s>>4;if(n.push(l),64!==a){const e=s<<4&240|a>>2;if(n.push(e),64!==o){const e=a<<6&192|o;n.push(e)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class OC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const RC=function(e){return function(e){const t=DC(e);return IC.encodeByteArray(t,!0)}(e).replace(/\./g,"")},LC=function(e){try{return IC.decodeString(e,!0)}catch(n0){console.error("base64Decode failed: ",n0)}return null};const NC=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof r.g)return r.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,BC=()=>{try{return NC()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/Kabinari-Project",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n0){return}const t=e&&LC(e[1]);return t&&JSON.parse(t)})()}catch(n0){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(n0))}},zC=e=>{const t=(e=>{var t,r;return null===(r=null===(t=BC())||void 0===t?void 0:t.emulatorHosts)||void 0===r?void 0:r[e]})(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const n=parseInt(t.substring(r+1),10);return"["===t[0]?[t.substring(1,r-1),n]:[t.substring(0,r),n]},FC=()=>{var e;return null===(e=BC())||void 0===e?void 0:e.config};class jC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,r))}}}function UC(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function VC(){return!function(){var e;const t=null===(e=BC())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(r.g.process)}catch(n0){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function HC(){try{return"object"===typeof indexedDB}catch(n0){return!1}}class WC extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,WC.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,GC.prototype.create)}}class GC{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},r="".concat(this.service,"/").concat(e),n=this.errors[e],i=n?function(e,t){return e.replace(qC,((e,r)=>{const n=t[r];return null!=n?String(n):"<".concat(r,"?>")}))}(n,t):"Error",s="".concat(this.serviceName,": ").concat(i," (").concat(r,").");return new WC(r,s,t)}}const qC=/\{\$([^}]+)}/g;function XC(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const i of r){if(!n.includes(i))return!1;const r=e[i],s=t[i];if(YC(r)&&YC(s)){if(!XC(r,s))return!1}else if(r!==s)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function YC(e){return null!==e&&"object"===typeof e}function KC(e){return e&&e._delegate?e._delegate:e}class QC{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ZC="[DEFAULT]";class JC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new jC;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&e.resolve(r)}catch(n0){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),n=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(n)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(n0){if(n)return null;throw n0}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:ZC})}catch(n0){}for(const[e,t]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});t.resolve(e)}catch(n0){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ZC;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ZC;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ZC;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const n=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,s]of this.instancesDeferred.entries()){r===this.normalizeInstanceIdentifier(i)&&s.resolve(n)}return n}onInit(e,t){var r;const n=this.normalizeInstanceIdentifier(t),i=null!==(r=this.onInitCallbacks.get(n))&&void 0!==r?r:new Set;i.add(e),this.onInitCallbacks.set(n,i);const s=this.instances.get(n);return s&&e(s,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const n of r)try{n(e,t)}catch(E2){}}getOrInitializeService(e){let{instanceIdentifier:t,options:r={}}=e,n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:$C(t),options:r}),this.instances.set(t,n),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(E2){}return n||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ZC;return this.component?this.component.multipleInstances?e:ZC:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function $C(e){return e===ZC?void 0:e}class eE{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new JC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const tE=[];var rE;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(rE||(rE={}));const nE={debug:rE.DEBUG,verbose:rE.VERBOSE,info:rE.INFO,warn:rE.WARN,error:rE.ERROR,silent:rE.SILENT},iE=rE.INFO,sE={[rE.DEBUG]:"log",[rE.VERBOSE]:"log",[rE.INFO]:"info",[rE.WARN]:"warn",[rE.ERROR]:"error"},aE=function(e,t){if(t<e.logLevel)return;const r=(new Date).toISOString(),n=sE[t];if(!n)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,s=new Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];console[n]("[".concat(r,"]  ").concat(e.name,":"),...s)};class oE{constructor(e){this.name=e,this._logLevel=iE,this._logHandler=aE,this._userLogHandler=null,tE.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in rE))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?nE[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,rE.DEBUG,...t),this._logHandler(this,rE.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,rE.VERBOSE,...t),this._logHandler(this,rE.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,rE.INFO,...t),this._logHandler(this,rE.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,rE.WARN,...t),this._logHandler(this,rE.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,rE.ERROR,...t),this._logHandler(this,rE.ERROR,...t)}}let lE,cE;const uE=new WeakMap,hE=new WeakMap,dE=new WeakMap,fE=new WeakMap,pE=new WeakMap;let mE={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return hE.get(e);if("objectStoreNames"===t)return e.objectStoreNames||dE.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return yE(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function gE(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(cE||(cE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.apply(bE(this),r),yE(uE.get(this))}:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return yE(e.apply(bE(this),r))}:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const s=e.call(bE(this),t,...n);return dE.set(s,t.sort?t.sort():[t]),yE(s)}}function vE(e){return"function"===typeof e?gE(e):(e instanceof IDBTransaction&&function(e){if(hE.has(e))return;const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),n()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));hE.set(e,t)}(e),t=e,(lE||(lE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,mE):e);var t}function yE(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(yE(e.result)),n()},s=()=>{r(e.error),n()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&uE.set(t,e)})).catch((()=>{})),pE.set(t,e),t}(e);if(fE.has(e))return fE.get(e);const t=vE(e);return t!==e&&(fE.set(e,t),pE.set(t,e)),t}const bE=e=>pE.get(e);const wE=["get","getKey","getAll","getAllKeys","count"],xE=["put","add","delete","clear"],SE=new Map;function _E(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(SE.get(t))return SE.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,i=xE.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!wE.includes(r))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var a=arguments.length,o=new Array(a>1?a-1:0),l=1;l<a;l++)o[l-1]=arguments[l];return n&&(s=s.index(o.shift())),(await Promise.all([s[r](...o),i&&t.done]))[0]};return SE.set(t,s),s}mE=(e=>u(u({},e),{},{get:(t,r,n)=>_E(t,r)||e.get(t,r,n),has:(t,r)=>!!_E(t,r)||e.has(t,r)}))(mE);class CE{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((e=>e)).join(" ")}}const EE="@firebase/app",AE="0.10.17",ME=new oE("@firebase/app"),TE="@firebase/app-compat",PE="@firebase/analytics-compat",kE="@firebase/analytics",DE="@firebase/app-check-compat",IE="@firebase/app-check",OE="@firebase/auth",RE="@firebase/auth-compat",LE="@firebase/database",NE="@firebase/data-connect",BE="@firebase/database-compat",zE="@firebase/functions",FE="@firebase/functions-compat",jE="@firebase/installations",UE="@firebase/installations-compat",VE="@firebase/messaging",HE="@firebase/messaging-compat",WE="@firebase/performance",GE="@firebase/performance-compat",qE="@firebase/remote-config",XE="@firebase/remote-config-compat",YE="@firebase/storage",KE="@firebase/storage-compat",QE="@firebase/firestore",ZE="@firebase/vertexai",JE="@firebase/firestore-compat",$E="firebase",eA="[DEFAULT]",tA={[EE]:"fire-core",[TE]:"fire-core-compat",[kE]:"fire-analytics",[PE]:"fire-analytics-compat",[IE]:"fire-app-check",[DE]:"fire-app-check-compat",[OE]:"fire-auth",[RE]:"fire-auth-compat",[LE]:"fire-rtdb",[NE]:"fire-data-connect",[BE]:"fire-rtdb-compat",[zE]:"fire-fn",[FE]:"fire-fn-compat",[jE]:"fire-iid",[UE]:"fire-iid-compat",[VE]:"fire-fcm",[HE]:"fire-fcm-compat",[WE]:"fire-perf",[GE]:"fire-perf-compat",[qE]:"fire-rc",[XE]:"fire-rc-compat",[YE]:"fire-gcs",[KE]:"fire-gcs-compat",[QE]:"fire-fst",[JE]:"fire-fst-compat",[ZE]:"fire-vertex","fire-js":"fire-js",[$E]:"fire-js-all"},rA=new Map,nA=new Map,iA=new Map;function sA(e,t){try{e.container.addComponent(t)}catch(n0){ME.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n0)}}function aA(e){const t=e.name;if(iA.has(t))return ME.debug("There were multiple attempts to register component ".concat(t,".")),!1;iA.set(t,e);for(const r of rA.values())sA(r,e);for(const r of nA.values())sA(r,e);return!0}function oA(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}const lA=new GC("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class cA{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new QC("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw lA.create("app-deleted",{appName:this._name})}}function uA(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e;if("object"!==typeof t){t={name:t}}const n=Object.assign({name:eA,automaticDataCollectionEnabled:!1},t),i=n.name;if("string"!==typeof i||!i)throw lA.create("bad-app-name",{appName:String(i)});if(r||(r=FC()),!r)throw lA.create("no-options");const s=rA.get(i);if(s){if(XC(r,s.options)&&XC(n,s.config))return s;throw lA.create("duplicate-app",{appName:i})}const a=new eE(i);for(const l of iA.values())a.addComponent(l);const o=new cA(r,n,a);return rA.set(i,o),o}function hA(e,t,r){var n;let i=null!==(n=tA[e])&&void 0!==n?n:e;r&&(i+="-".concat(r));const s=i.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const e=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return s&&e.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),s&&a&&e.push("and"),a&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void ME.warn(e.join(" "))}aA(new QC("".concat(i,"-version"),(()=>({library:i,version:t})),"VERSION"))}const dA="firebase-heartbeat-store";let fA=null;function pA(){return fA||(fA=function(e,t){let{blocked:r,upgrade:n,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=indexedDB.open(e,t),o=yE(a);return n&&a.addEventListener("upgradeneeded",(e=>{n(yE(a.result),e.oldVersion,e.newVersion,yE(a.transaction),e)})),r&&a.addEventListener("blocked",(e=>r(e.oldVersion,e.newVersion,e))),o.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(dA)}catch(n0){console.warn(n0)}}}).catch((e=>{throw lA.create("idb-open",{originalErrorMessage:e.message})}))),fA}async function mA(e,t){try{const r=(await pA()).transaction(dA,"readwrite"),n=r.objectStore(dA);await n.put(t,gA(e)),await r.done}catch(n0){if(n0 instanceof WC)ME.warn(n0.message);else{const t=lA.create("idb-set",{originalErrorMessage:null===n0||void 0===n0?void 0:n0.message});ME.warn(t.message)}}}function gA(e){return"".concat(e.name,"!").concat(e.options.appId)}class vA{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new bA(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=yA();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some((e=>e.date===n)))return;return this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}catch(n0){ME.warn(n0)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=yA(),{heartbeatsToSend:r,unsentEntries:n}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const r=[];let n=e.slice();for(const i of e){const e=r.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),wA(r)>t){e.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),wA(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}(this._heartbeatsCache.heartbeats),i=RC(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n0){return ME.warn(n0),""}}}function yA(){return(new Date).toISOString().substring(0,10)}class bA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!HC()&&new Promise(((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(r){t(r)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await pA()).transaction(dA),r=await t.objectStore(dA).get(gA(e));return await t.done,r}catch(n0){if(n0 instanceof WC)ME.warn(n0.message);else{const t=lA.create("idb-get",{originalErrorMessage:null===n0||void 0===n0?void 0:n0.message});ME.warn(t.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return mA(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return mA(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}}}function wA(e){return RC(JSON.stringify({version:2,heartbeats:e})).length}var xA;xA="",aA(new QC("platform-logger",(e=>new CE(e)),"PRIVATE")),aA(new QC("heartbeat",(e=>new vA(e)),"PRIVATE")),hA(EE,AE,xA),hA(EE,AE,"esm2017"),hA("fire-js","");var SA,_A,CA="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},EA={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function r(e,t,r){r||(r=0);var n=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)n[i]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(i=0;16>i;++i)n[i]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],i=e.g[2];var s=e.g[3],a=t+(s^r&(i^s))+n[0]+3614090360&4294967295;a=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=r+(a<<7&4294967295|a>>>25))+((a=s+(i^t&(r^i))+n[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=i+(r^s&(t^r))+n[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=r+(t^i&(s^t))+n[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^r&(i^s))+n[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(r^i))+n[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=i+(r^s&(t^r))+n[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=r+(t^i&(s^t))+n[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^r&(i^s))+n[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(r^i))+n[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=i+(r^s&(t^r))+n[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=r+(t^i&(s^t))+n[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^r&(i^s))+n[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(r^i))+n[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=i+(r^s&(t^r))+n[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=r+(t^i&(s^t))+n[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^s&(r^i))+n[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=s+(r^i&(t^r))+n[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^r&(s^t))+n[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=r+(s^t&(i^s))+n[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(r^i))+n[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=s+(r^i&(t^r))+n[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^r&(s^t))+n[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=r+(s^t&(i^s))+n[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(r^i))+n[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=s+(r^i&(t^r))+n[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^r&(s^t))+n[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=r+(s^t&(i^s))+n[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(r^i))+n[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=s+(r^i&(t^r))+n[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^r&(s^t))+n[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=r+(s^t&(i^s))+n[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=t+(r^i^s)+n[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^r^i)+n[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^r)+n[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=r+(i^s^t)+n[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=t+(r^i^s)+n[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^r^i)+n[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^r)+n[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=r+(i^s^t)+n[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=t+(r^i^s)+n[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^r^i)+n[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^r)+n[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=r+(i^s^t)+n[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=t+(r^i^s)+n[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^r^i)+n[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^r)+n[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=r+(i^s^t)+n[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=t+(i^(r|~s))+n[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=s+(r^(t|~i))+n[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~r))+n[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=r+(s^(i|~t))+n[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=t+(i^(r|~s))+n[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=s+(r^(t|~i))+n[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~r))+n[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=r+(s^(i|~t))+n[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=t+(i^(r|~s))+n[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=s+(r^(t|~i))+n[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~r))+n[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=r+(s^(i|~t))+n[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((s=(t=r+((a=t+(i^(r|~s))+n[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=s+(r^(t|~i))+n[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((i=s+((a=i+(t^(s|~r))+n[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~t))+n[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function n(e,t){this.h=t;for(var r=[],n=!0,i=e.length-1;0<=i;i--){var s=0|e[i];n&&s==t||(r[i]=s,n=!1)}this.g=r}!function(e,t){function r(){}r.prototype=t.prototype,e.D=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.C=function(e,r,n){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[r].apply(e,i)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,i=this.B,s=this.h,a=0;a<t;){if(0==s)for(;a<=n;)r(this,e,a),a+=this.blockSize;if("string"===typeof e){for(;a<t;)if(i[s++]=e.charCodeAt(a++),s==this.blockSize){r(this,i),s=0;break}}else for(;a<t;)if(i[s++]=e[a++],s==this.blockSize){r(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var r=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&r,r/=256;for(this.u(e),e=Array(16),t=r=0;4>t;++t)for(var n=0;32>n;n+=8)e[r++]=this.g[t]>>>n&255;return e};var i={};function s(e){return-128<=e&&128>e?function(e,t){var r=i;return Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=t(e)}(e,(function(e){return new n([0|e],0>e?-1:0)})):new n([0|e],0>e?-1:0)}function a(e){if(isNaN(e)||!isFinite(e))return o;if(0>e)return d(a(-e));for(var t=[],r=1,i=0;e>=r;i++)t[i]=e/r|0,r*=4294967296;return new n(t,0)}var o=s(0),l=s(1),c=s(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function d(e){for(var t=e.g.length,r=[],i=0;i<t;i++)r[i]=~e.g[i];return new n(r,~e.h).add(l)}function f(e,t){return e.add(d(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(o,o);if(h(e))return t=g(d(e),t),new m(d(t.g),d(t.h));if(h(t))return t=g(e,d(t)),new m(d(t.g),t.h);if(30<e.g.length){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var r=l,n=t;0>=n.l(e);)r=v(r),n=v(n);var i=y(r,1),s=y(n,1);for(n=y(n,2),r=y(r,2);!u(n);){var c=s.add(n);0>=c.l(e)&&(i=i.add(r),s=c),n=y(n,1),r=y(r,1)}return t=f(e,i.j(t)),new m(i,t)}for(i=o;0<=e.l(t);){for(r=Math.max(1,Math.floor(e.m()/t.m())),n=48>=(n=Math.ceil(Math.log(r)/Math.LN2))?1:Math.pow(2,n-48),c=(s=a(r)).j(t);h(c)||0<c.l(e);)c=(s=a(r-=n)).j(t);u(s)&&(s=l),i=i.add(s),e=f(e,c)}return new m(i,e)}function v(e){for(var t=e.g.length+1,r=[],i=0;i<t;i++)r[i]=e.i(i)<<1|e.i(i-1)>>>31;return new n(r,e.h)}function y(e,t){var r=t>>5;t%=32;for(var i=e.g.length-r,s=[],a=0;a<i;a++)s[a]=0<t?e.i(a+r)>>>t|e.i(a+r+1)<<32-t:e.i(a+r);return new n(s,e.h)}(e=n.prototype).m=function(){if(h(this))return-d(this).m();for(var e=0,t=1,r=0;r<this.g.length;r++){var n=this.i(r);e+=(0<=n?n:4294967296+n)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+d(this).toString(e);for(var t=a(Math.pow(e,6)),r=this,n="";;){var i=g(r,t).g,s=((0<(r=f(r,i.j(t))).g.length?r.g[0]:r.h)>>>0).toString(e);if(u(r=i))return s+n;for(;6>s.length;)s="0"+s;n=s+n}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return h(this)?d(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],i=0,s=0;s<=t;s++){var a=i+(65535&this.i(s))+(65535&e.i(s)),o=(a>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);i=o>>>16,a&=65535,o&=65535,r[s]=o<<16|a}return new n(r,-2147483648&r[r.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return o;if(h(this))return h(e)?d(this).j(d(e)):d(d(this).j(e));if(h(e))return d(this.j(d(e)));if(0>this.l(c)&&0>e.l(c))return a(this.m()*e.m());for(var t=this.g.length+e.g.length,r=[],i=0;i<2*t;i++)r[i]=0;for(i=0;i<this.g.length;i++)for(var s=0;s<e.g.length;s++){var l=this.i(i)>>>16,f=65535&this.i(i),m=e.i(s)>>>16,g=65535&e.i(s);r[2*i+2*s]+=f*g,p(r,2*i+2*s),r[2*i+2*s+1]+=l*g,p(r,2*i+2*s+1),r[2*i+2*s+1]+=f*m,p(r,2*i+2*s+1),r[2*i+2*s+2]+=l*m,p(r,2*i+2*s+2)}for(i=0;i<t;i++)r[i]=r[2*i+1]<<16|r[2*i];for(i=t;i<2*t;i++)r[i]=0;return new n(r,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],i=0;i<t;i++)r[i]=this.i(i)&e.i(i);return new n(r,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],i=0;i<t;i++)r[i]=this.i(i)|e.i(i);return new n(r,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],i=0;i<t;i++)r[i]=this.i(i)^e.i(i);return new n(r,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,_A=EA.Md5=t,n.prototype.add=n.prototype.add,n.prototype.multiply=n.prototype.j,n.prototype.modulo=n.prototype.A,n.prototype.compare=n.prototype.l,n.prototype.toNumber=n.prototype.m,n.prototype.toString=n.prototype.toString,n.prototype.getBits=n.prototype.i,n.fromNumber=a,n.fromString=function e(t,r){if(0==t.length)throw Error("number format error: empty string");if(2>(r=r||10)||36<r)throw Error("radix out of range: "+r);if("-"==t.charAt(0))return d(e(t.substring(1),r));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=a(Math.pow(r,8)),i=o,s=0;s<t.length;s+=8){var l=Math.min(8,t.length-s),c=parseInt(t.substring(s,s+l),r);8>l?(l=a(Math.pow(r,l)),i=i.j(l).add(a(c))):i=(i=i.j(n)).add(a(c))}return i},SA=EA.Integer=n}).apply("undefined"!==typeof CA?CA:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var AA,MA,TA,PA,kA,DA,IA,OA,RA="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},LA={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){return e==Array.prototype||e==Object.prototype||(e[t]=r.value),e};var r=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof RA&&RA];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);!function(e,n){if(n)e:{var i=r;e=e.split(".");for(var s=0;s<e.length-1;s++){var a=e[s];if(!(a in i))break e;i=i[a]}(n=n(s=i[e=e[e.length-1]]))!=s&&null!=n&&t(i,e,{configurable:!0,writable:!0,value:n})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var r=0,n=!1,i={next:function(){if(!n&&r<e.length){var i=r++;return{value:t(i,e[i]),done:!1}}return n=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e,t){return t}))}}));var n=n||{},i=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function a(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,r){return e.call.apply(e.bind,arguments)}function l(e,t,r){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),e.apply(t,r)}}return function(){return e.apply(t,arguments)}}function c(e,t,r){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function u(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=r.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function h(e,t){function r(){}r.prototype=t.prototype,e.aa=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.Qb=function(e,r,n){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[r].apply(e,i)}}function d(e){const t=e.length;if(0<t){const r=Array(t);for(let n=0;n<t;n++)r[n]=e[n];return r}return[]}function f(e,t){for(let r=1;r<arguments.length;r++){const t=arguments[r];if(s(t)){const r=e.length||0,n=t.length||0;e.length=r+n;for(let i=0;i<n;i++)e[r+i]=t[i]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var v=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function y(e,t,r){for(const n in e)t.call(r,e[n],n,e)}function b(e){const t={};for(const r in e)t[r]=e[r];return t}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(e,t){let r,n;for(let i=1;i<arguments.length;i++){for(r in n=arguments[i],n)e[r]=n[r];for(let t=0;t<w.length;t++)r=w[t],Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}}function S(e){var t=1;e=e.split(":");const r=[];for(;0<t&&e.length;)r.push(e.shift()),t--;return e.length&&r.push(e.join(":")),r}function _(e){i.setTimeout((()=>{throw e}),0)}function C(){var e=P;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var E=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new A),(e=>e.reset()));class A{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let M,T=!1,P=new class{constructor(){this.h=this.g=null}add(e,t){const r=E.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},k=()=>{const e=i.Promise.resolve(void 0);M=()=>{e.then(D)}};var D=()=>{for(var e;e=C();){try{e.h.call(e.g)}catch(G0){_(G0)}var t=E;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}T=!1};function I(){this.s=this.s,this.C=this.C}function O(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}I.prototype.s=!1,I.prototype.ma=function(){this.s||(this.s=!0,this.N())},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},O.prototype.h=function(){this.defaultPrevented=!0};var R=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(G0){}return e}();function L(e,t){if(O.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var r=this.type=e.type,n=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(v){e:{try{g(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==r?t=e.fromElement:"mouseout"==r&&(t=e.toElement);this.relatedTarget=t,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:N[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&L.aa.h.call(this)}}h(L,O);var N={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var B="closure_listenable_"+(1e6*Math.random()|0),z=0;function F(e,t,r,n,i){this.listener=e,this.proxy=null,this.src=t,this.type=r,this.capture=!!n,this.ha=i,this.key=++z,this.da=this.fa=!1}function j(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function U(e){this.src=e,this.g={},this.h=0}function V(e,t){var r=t.type;if(r in e.g){var n,i=e.g[r],s=Array.prototype.indexOf.call(i,t,void 0);(n=0<=s)&&Array.prototype.splice.call(i,s,1),n&&(j(t),0==e.g[r].length&&(delete e.g[r],e.h--))}}function H(e,t,r,n){for(var i=0;i<e.length;++i){var s=e[i];if(!s.da&&s.listener==t&&s.capture==!!r&&s.ha==n)return i}return-1}U.prototype.add=function(e,t,r,n,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var a=H(e,t,n,i);return-1<a?(t=e[a],r||(t.fa=!1)):((t=new F(t,this.src,s,!!n,i)).fa=r,e.push(t)),t};var W="closure_lm_"+(1e6*Math.random()|0),G={};function q(e,t,r,n,i){if(n&&n.once)return Y(e,t,r,n,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)q(e,t[s],r,n,i);return null}return r=te(r),e&&e[B]?e.K(t,r,a(n)?!!n.capture:!!n,i):X(e,t,r,!1,n,i)}function X(e,t,r,n,i,s){if(!t)throw Error("Invalid event type");var o=a(i)?!!i.capture:!!i,l=$(e);if(l||(e[W]=l=new U(e)),(r=l.add(t,r,n,o,s)).proxy)return r;if(n=function(){function e(r){return t.call(e.src,e.listener,r)}const t=J;return e}(),r.proxy=n,n.src=e,n.listener=r,e.addEventListener)R||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),n,i);else if(e.attachEvent)e.attachEvent(Z(t.toString()),n);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(n)}return r}function Y(e,t,r,n,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)Y(e,t[s],r,n,i);return null}return r=te(r),e&&e[B]?e.L(t,r,a(n)?!!n.capture:!!n,i):X(e,t,r,!0,n,i)}function K(e,t,r,n,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)K(e,t[s],r,n,i);else n=a(n)?!!n.capture:!!n,r=te(r),e&&e[B]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(r=H(s=e.g[t],r,n,i))&&(j(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=$(e))&&(t=e.g[t.toString()],e=-1,t&&(e=H(t,r,n,i)),(r=-1<e?t[e]:null)&&Q(r))}function Q(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[B])V(t.i,e);else{var r=e.type,n=e.proxy;t.removeEventListener?t.removeEventListener(r,n,e.capture):t.detachEvent?t.detachEvent(Z(r),n):t.addListener&&t.removeListener&&t.removeListener(n),(r=$(t))?(V(r,e),0==r.h&&(r.src=null,t[W]=null)):j(e)}}}function Z(e){return e in G?G[e]:G[e]="on"+e}function J(e,t){if(e.da)e=!0;else{t=new L(t,this);var r=e.listener,n=e.ha||e.src;e.fa&&Q(e),e=r.call(n,t)}return e}function $(e){return(e=e[W])instanceof U?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function re(){I.call(this),this.i=new U(this),this.M=this,this.F=null}function ne(e,t){var r,n=e.F;if(n)for(r=[];n;n=n.F)r.push(n);if(e=e.M,n=t.type||t,"string"===typeof t)t=new O(t,e);else if(t instanceof O)t.target=t.target||e;else{var i=t;x(t=new O(n,e),i)}if(i=!0,r)for(var s=r.length-1;0<=s;s--){var a=t.g=r[s];i=ie(a,n,!0,t)&&i}if(i=ie(a=t.g=e,n,!0,t)&&i,i=ie(a,n,!1,t)&&i,r)for(s=0;s<r.length;s++)i=ie(a=t.g=r[s],n,!1,t)&&i}function ie(e,t,r,n){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var a=t[s];if(a&&!a.da&&a.capture==r){var o=a.listener,l=a.ha||a.src;a.fa&&V(e.i,a),i=!1!==o.call(l,n)&&i}}return i&&!n.defaultPrevented}function se(e,t,r){if("function"===typeof e)r&&(e=c(e,r));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function ae(e){e.g=se((()=>{e.g=null,e.i&&(e.i=!1,ae(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}h(re,I),re.prototype[B]=!0,re.prototype.removeEventListener=function(e,t,r,n){K(this,e,t,r,n)},re.prototype.N=function(){if(re.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var r=t.g[e],n=0;n<r.length;n++)j(r[n]);delete t.g[e],t.h--}}this.F=null},re.prototype.K=function(e,t,r,n){return this.i.add(String(e),t,!1,r,n)},re.prototype.L=function(e,t,r,n){return this.i.add(String(e),t,!0,r,n)};class oe extends I{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ae(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){I.call(this),this.h=e,this.g={}}h(le,I);var ce=[];function ue(e){y(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Q(e)}),e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var he=i.JSON.stringify,de=i.JSON.parse,fe=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function pe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}pe.prototype.h=null;var ve={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ye(){O.call(this,"d")}function be(){O.call(this,"c")}h(ye,O),h(be,O);var we={},xe=null;function Se(){return xe=xe||new re}function _e(e){O.call(this,we.La,e)}function Ce(e){const t=Se();ne(t,new _e(t))}function Ee(e,t){O.call(this,we.STAT_EVENT,e),this.stat=t}function Ae(e){const t=Se();ne(t,new Ee(t,e))}function Me(e,t){O.call(this,we.Ma,e),this.size=t}function Te(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout((function(){e()}),t)}function Pe(){this.g=!0}function ke(e,t,r,n){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var r=JSON.parse(t);if(r)for(e=0;e<r.length;e++)if(Array.isArray(r[e])){var n=r[e];if(!(2>n.length)){var i=n[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var a=1;a<i.length;a++)i[a]=""}}}return he(r)}catch(o){return t}}(e,r)+(n?" "+n:"")}))}we.La="serverreachability",h(_e,O),we.STAT_EVENT="statevent",h(Ee,O),we.Ma="timingevent",h(Me,O),Pe.prototype.xa=function(){this.g=!1},Pe.prototype.info=function(){};var De,Ie={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Oe={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Re(){}function Le(e,t,r,n){this.j=e,this.i=t,this.l=r,this.R=n||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ne}function Ne(){this.i=null,this.g="",this.h=!1}h(Re,pe),Re.prototype.g=function(){return new XMLHttpRequest},Re.prototype.i=function(){return{}},De=new Re;var Be={},ze={};function Fe(e,t,r){e.L=1,e.v=ht(at(t)),e.m=r,e.P=!0,je(e,null)}function je(e,t){e.F=Date.now(),He(e),e.A=at(e.v);var r=e.A,n=e.R;Array.isArray(n)||(n=[String(n)]),Et(r.i,"t",n),e.C=0,r=e.j.J,e.h=new Ne,e.g=dr(e.j,r?t:null,!e.m),0<e.O&&(e.M=new oe(c(e.Y,e,e.g),e.O)),t=e.U,r=e.g,n=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(ce[0]=i.toString()),i=ce);for(var s=0;s<i.length;s++){var a=q(r,i[s],n||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ce(),function(e,t,r,n,i,s){e.info((function(){if(e.g)if(s)for(var a="",o=s.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");a=2<=h.length&&"type"==h[1]?a+(u+"=")+c+"&":a+(u+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+n+") [attempt "+i+"]: "+t+"\n"+r+"\n"+a}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Ue(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Ve(e,t){var r=e.C,n=t.indexOf("\n",r);return-1==n?ze:(r=Number(t.substring(r,n)),isNaN(r)?Be:(n+=1)+r>t.length?ze:(t=t.slice(n,n+r),e.C=n+r,t))}function He(e){e.S=Date.now()+e.I,We(e,e.I)}function We(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Te(c(e.ba,e),t)}function Ge(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function qe(e){0==e.j.G||e.J||or(e.j,e)}function Xe(e){Ge(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ye(e,t){try{var r=e.j;if(0!=r.G&&(r.g==e||$e(r.h,e)))if(!e.K&&$e(r.h,e)&&3==r.G){try{var n=r.Da.g.parse(t)}catch(u){n=null}if(Array.isArray(n)&&3==n.length){var i=n;if(0==i[0]){e:if(!r.u){if(r.g){if(!(r.g.F+3e3<e.F))break e;ar(r),Qt(r)}nr(r),Ae(18)}}else r.za=i[1],0<r.za-r.T&&37500>i[2]&&r.F&&0==r.v&&!r.C&&(r.C=Te(c(r.Za,r),6e3));if(1>=Je(r.h)&&r.ca){try{r.ca()}catch(u){}r.ca=void 0}}else cr(r,11)}else if((e.K||r.g==e)&&ar(r),!p(t))for(i=r.Da.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(r.T=c[0],c=c[1],2==r.G)if("c"==c[0]){r.K=c[1],r.ia=c[2];const t=c[3];null!=t&&(r.la=t,r.j.info("VER="+r.la));const i=c[4];null!=i&&(r.Aa=i,r.j.info("SVER="+r.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(n=1.5*u,r.L=n,r.j.info("backChannelRequestTimeoutMs_="+n)),n=r;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=n.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(et(s,s.h),s.h=null))}if(n.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(n.ya=e,ut(n.I,n.D,e))}}r.G=3,r.l&&r.l.ua(),r.ba&&(r.R=Date.now()-e.F,r.j.info("Handshake RTT: "+r.R+"ms"));var a=e;if((n=r).qa=hr(n,n.J?n.ia:null,n.W),a.K){tt(n.h,a);var o=a,l=n.L;l&&(o.I=l),o.B&&(Ge(o),He(o)),n.g=a}else rr(n);0<r.i.length&&Jt(r)}else"stop"!=c[0]&&"close"!=c[0]||cr(r,7);else 3==r.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?cr(r,7):Kt(r):"noop"!=c[0]&&r.l&&r.l.ta(c),r.v=0)}Ce()}catch(u){}}Le.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==Gt(e)?t.j():this.Y(e)},Le.prototype.Y=function(e){try{if(e==this.g)e:{const d=Gt(this.g);var t=this.g.Ba();this.g.Z();if(!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||qt(this.g)))){this.J||4!=d||7==t||Ce(),Ge(this);var r=this.g.Z();this.X=r;t:if(Ue(this)){var n=qt(this.g);e="";var s=n.length,a=4==Gt(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Xe(this),qe(this);var o="";break t}this.h.i=new i.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(n[t],{stream:!(a&&t==s-1)});n.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==r,function(e,t,r,n,i,s,a){e.info((function(){return"XMLHTTP RESP ("+n+") [ attempt "+i+"]: "+t+"\n"+r+"\n"+s+" "+a}))}(this.i,this.u,this.A,this.l,this.R,d,r),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var u=l;break t}}u=null}if(!(r=u)){this.o=!1,this.s=3,Ae(12),Xe(this),qe(this);break e}ke(this.i,this.l,r,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ye(this,r)}if(this.P){let e;for(r=!0;!this.J&&this.C<o.length;){if(e=Ve(this,o),e==ze){4==d&&(this.s=4,Ae(14),r=!1),ke(this.i,this.l,null,"[Incomplete Response]");break}if(e==Be){this.s=4,Ae(15),ke(this.i,this.l,o,"[Invalid Chunk]"),r=!1;break}ke(this.i,this.l,e,null),Ye(this,e)}if(Ue(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=o.length||this.h.h||(this.s=1,Ae(16),r=!1),this.o=this.o&&r,r){if(0<o.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),ir(h),h.M=!0,Ae(11))}}else ke(this.i,this.l,o,"[Invalid Chunked Response]"),Xe(this),qe(this)}else ke(this.i,this.l,o,null),Ye(this,o);4==d&&Xe(this),this.o&&!this.J&&(4==d?or(this.j,this):(this.o=!1,He(this)))}else(function(e){const t={};e=(e.g&&2<=Gt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<e.length;n++){if(p(e[n]))continue;var r=S(e[n]);const i=r[0];if("string"!==typeof(r=r[1]))continue;r=r.trim();const s=t[i]||[];t[i]=s,s.push(r)}!function(e,t){for(const r in e)t.call(void 0,e[r],r,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==r&&0<o.indexOf("Unknown SID")?(this.s=3,Ae(12)):(this.s=0,Ae(13)),Xe(this),qe(this)}}}catch(NA){}},Le.prototype.cancel=function(){this.J=!0,Xe(this)},Le.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(Ce(),Ae(17)),Xe(this),this.s=2,qe(this)):We(this,this.S-e)};var Ke=class{constructor(e,t){this.g=e,this.map=t}};function Qe(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ze(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Je(e){return e.h?1:e.g?e.g.size:0}function $e(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function rt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const r of e.g.values())t=t.concat(r.D);return t}return d(e.i)}function nt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var r=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var r=0;r<e;r++)t.push(r);return t}t=[],r=0;for(const n in e)t[r++]=n;return t}}}(e),n=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],r=e.length,n=0;n<r;n++)t.push(e[n]);return t}for(n in t=[],r=0,e)t[r++]=e[n];return t}(e),i=n.length,a=0;a<i;a++)t.call(void 0,n[a],r&&r[a],e)}Qe.prototype.cancel=function(){if(this.i=rt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var it=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function st(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof st){this.h=e.h,ot(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,r=new xt;r.i=t.i,t.g&&(r.g=new Map(t.g),r.h=t.h),ct(this,r),this.m=e.m}else e&&(t=String(e).match(it))?(this.h=!1,ot(this,t[1]||"",!0),this.o=dt(t[2]||""),this.g=dt(t[3]||"",!0),lt(this,t[4]),this.l=dt(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=dt(t[7]||"")):(this.h=!1,this.i=new xt(null,this.h))}function at(e){return new st(e)}function ot(e,t,r){e.j=r?dt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,r){t instanceof xt?(e.i=t,function(e,t){t&&!e.j&&(St(e),e.i=null,e.g.forEach((function(e,t){var r=t.toLowerCase();t!=r&&(_t(this,t),Et(this,r,e))}),e)),e.j=t}(e.i,e.h)):(r||(t=ft(t,bt)),e.i=new xt(t,e.h))}function ut(e,t,r){e.i.set(t,r)}function ht(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function dt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ft(e,t,r){return"string"===typeof e?(e=encodeURI(e).replace(t,pt),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}st.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ft(t,gt,!0),":");var r=this.g;return(r||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ft(t,gt,!0),"@"),e.push(encodeURIComponent(String(r)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(r=this.s)&&e.push(":",String(r))),(r=this.l)&&(this.g&&"/"!=r.charAt(0)&&e.push("/"),e.push(ft(r,"/"==r.charAt(0)?yt:vt,!0))),(r=this.i.toString())&&e.push("?",r),(r=this.m)&&e.push("#",ft(r,wt)),e.join("")};var mt,gt=/[#\/\?@]/g,vt=/[#\?:]/g,yt=/[#\?]/g,bt=/[#\?@]/g,wt=/#/g;function xt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function St(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var r=0;r<e.length;r++){var n=e[r].indexOf("="),i=null;if(0<=n){var s=e[r].substring(0,n);i=e[r].substring(n+1)}else s=e[r];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,r){e.add(decodeURIComponent(t.replace(/\+/g," ")),r)})))}function _t(e,t){St(e),t=At(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Ct(e,t){return St(e),t=At(e,t),e.g.has(t)}function Et(e,t,r){_t(e,t),0<r.length&&(e.i=null,e.g.set(At(e,t),d(r)),e.h+=r.length)}function At(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Mt(e,t,r,n,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),n(r)}catch(s){}}function Tt(){this.g=new fe}function Pt(e,t,r){const n=r||"";try{nt(e,(function(e,r){let i=e;a(e)&&(i=he(e)),t.push(n+r+"="+encodeURIComponent(i))}))}catch(n0){throw t.push(n+"type="+encodeURIComponent("_badmap")),n0}}function kt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Dt(e,t){re.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function It(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Ot(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Rt(e)}function Rt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Lt(e){let t="";return y(e,(function(e,r){t+=r,t+=":",t+=e,t+="\r\n"})),t}function Nt(e,t,r){e:{for(n in r){var n=!1;break e}n=!0}n||(r=Lt(r),"string"===typeof e?null!=r&&encodeURIComponent(String(r)):ut(e,t,r))}function Bt(e){re.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=xt.prototype).add=function(e,t){St(this),this.i=null,e=At(this,e);var r=this.g.get(e);return r||this.g.set(e,r=[]),r.push(t),this.h+=1,this},e.forEach=function(e,t){St(this),this.g.forEach((function(r,n){r.forEach((function(r){e.call(t,r,n,this)}),this)}),this)},e.na=function(){St(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),r=[];for(let n=0;n<t.length;n++){const i=e[n];for(let e=0;e<i.length;e++)r.push(t[n])}return r},e.V=function(e){St(this);let t=[];if("string"===typeof e)Ct(this,e)&&(t=t.concat(this.g.get(At(this,e))));else{e=Array.from(this.g.values());for(let r=0;r<e.length;r++)t=t.concat(e[r])}return t},e.set=function(e,t){return St(this),this.i=null,Ct(this,e=At(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var r=0;r<t.length;r++){var n=t[r];const s=encodeURIComponent(String(n)),a=this.V(n);for(n=0;n<a.length;n++){var i=s;""!==a[n]&&(i+="="+encodeURIComponent(String(a[n]))),e.push(i)}}return this.i=e.join("&")},h(kt,pe),kt.prototype.g=function(){return new Dt(this.l,this.j)},kt.prototype.i=(mt={},function(){return mt}),h(Dt,re),(e=Dt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Rt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ot(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Rt(this)),this.g&&(this.readyState=3,Rt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;It(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ot(this):Rt(this),3==this.readyState&&It(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Ot(this))},e.Qa=function(e){this.g&&(this.response=e,Ot(this))},e.ga=function(){this.g&&Ot(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var r=t.next();!r.done;)r=r.value,e.push(r[0]+": "+r[1]),r=t.next();return e.join("\r\n")},Object.defineProperty(Dt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),h(Bt,re);var zt=/^https?$/i,Ft=["POST","PUT"];function jt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Ut(e),Ht(e)}function Ut(e){e.A||(e.A=!0,ne(e,"complete"),ne(e,"error"))}function Vt(e){if(e.h&&"undefined"!=typeof n&&(!e.v[1]||4!=Gt(e)||2!=e.Z()))if(e.u&&4==Gt(e))se(e.Ea,0,e);else if(ne(e,"readystatechange"),4==Gt(e)){e.h=!1;try{const n=e.Z();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var r;if(!(r=t)){var s;if(s=0===n){var a=String(e.D).match(it)[1]||null;!a&&i.self&&i.self.location&&(a=i.self.location.protocol.slice(0,-1)),s=!zt.test(a?a.toLowerCase():"")}r=s}if(r)ne(e,"complete"),ne(e,"success");else{e.m=6;try{var o=2<Gt(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",Ut(e)}}finally{Ht(e)}}}function Ht(e,t){if(e.g){Wt(e);const r=e.g,n=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||ne(e,"ready");try{r.onreadystatechange=n}catch(n0){}}}function Wt(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function Gt(e){return e.g?e.g.readyState:0}function qt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(FA){return null}}function Xt(e,t,r){return r&&r.internalChannelParams&&r.internalChannelParams[e]||t}function Yt(e){this.Aa=0,this.i=[],this.j=new Pe,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Xt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Xt("baseRetryDelayMs",5e3,e),this.cb=Xt("retryDelaySeedMs",1e4,e),this.Wa=Xt("forwardChannelMaxRetries",2,e),this.wa=Xt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Qe(e&&e.concurrentRequestLimit),this.Da=new Tt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Kt(e){if(Zt(e),3==e.G){var t=e.U++,r=at(e.I);if(ut(r,"SID",e.K),ut(r,"RID",t),ut(r,"TYPE","terminate"),er(e,r),(t=new Le(e,e.j,t)).L=2,t.v=ht(at(r)),r=!1,i.navigator&&i.navigator.sendBeacon)try{r=i.navigator.sendBeacon(t.v.toString(),"")}catch(n){}!r&&i.Image&&((new Image).src=t.v,r=!0),r||(t.g=dr(t.j,null),t.g.ea(t.v)),t.F=Date.now(),He(t)}ur(e)}function Qt(e){e.g&&(ir(e),e.g.cancel(),e.g=null)}function Zt(e){Qt(e),e.u&&(i.clearTimeout(e.u),e.u=null),ar(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function Jt(e){if(!Ze(e.h)&&!e.s){e.s=!0;var t=e.Ga;M||k(),T||(M(),T=!0),P.add(t,e),e.B=0}}function $t(e,t){var r;r=t?t.l:e.U++;const n=at(e.I);ut(n,"SID",e.K),ut(n,"RID",r),ut(n,"AID",e.T),er(e,n),e.m&&e.o&&Nt(n,e.m,e.o),r=new Le(e,e.j,r,e.B+1),null===e.m&&(r.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tr(e,r,1e3),r.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,r),Fe(r,n,t)}function er(e,t){e.H&&y(e.H,(function(e,r){ut(t,r,e)})),e.l&&nt({},(function(e,r){ut(t,r,e)}))}function tr(e,t,r){r=Math.min(e.i.length,r);var n=e.l?c(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+r];-1==t?0<r?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let a=0;a<r;a++){let r=i[a].g;const o=i[a].map;if(r-=t,0>r)t=Math.max(0,i[a].g-100),s=!1;else try{Pt(o,e,"req"+r+"_")}catch(NA){n&&n(o)}}if(s){n=e.join("&");break e}}}return e=e.i.splice(0,r),t.D=e,n}function rr(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;M||k(),T||(M(),T=!0),P.add(t,e),e.v=0}}function nr(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Te(c(e.Fa,e),lr(e,e.v)),e.v++,!0)}function ir(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function sr(e){e.g=new Le(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=at(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),er(e,t),e.m&&e.o&&Nt(t,e.m,e.o),e.L&&(e.g.I=e.L);var r=e.g;e=e.ia,r.L=1,r.v=ht(at(t)),r.m=null,r.P=!0,je(r,e)}function ar(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function or(e,t){var r=null;if(e.g==t){ar(e),ir(e),e.g=null;var n=2}else{if(!$e(e.h,t))return;r=t.D,tt(e.h,t),n=1}if(0!=e.G)if(t.o)if(1==n){r=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;ne(n=Se(),new Me(n,r)),Jt(e)}else rr(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==n&&function(e,t){return!(Je(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Te(c(e.Ga,e,t),lr(e,e.B)),e.B++,!0))}(e,t)||2==n&&nr(e)))switch(r&&0<r.length&&(t=e.h,t.i=t.i.concat(r)),i){case 1:cr(e,5);break;case 4:cr(e,10);break;case 3:cr(e,6);break;default:cr(e,2)}}function lr(e,t){let r=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(r*=2),r*t}function cr(e,t){if(e.j.info("Error code "+t),2==t){var r=c(e.fb,e),n=e.Xa;const t=!n;n=new st(n||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||ot(n,"https"),ht(n),t?function(e,t){const r=new Pe;if(i.Image){const n=new Image;n.onload=u(Mt,r,"TestLoadImage: loaded",!0,t,n),n.onerror=u(Mt,r,"TestLoadImage: error",!1,t,n),n.onabort=u(Mt,r,"TestLoadImage: abort",!1,t,n),n.ontimeout=u(Mt,r,"TestLoadImage: timeout",!1,t,n),i.setTimeout((function(){n.ontimeout&&n.ontimeout()}),1e4),n.src=e}else t(!1)}(n.toString(),r):function(e,t){new Pe;const r=new AbortController,n=setTimeout((()=>{r.abort(),Mt(0,0,!1,t)}),1e4);fetch(e,{signal:r.signal}).then((e=>{clearTimeout(n),e.ok?Mt(0,0,!0,t):Mt(0,0,!1,t)})).catch((()=>{clearTimeout(n),Mt(0,0,!1,t)}))}(n.toString(),r)}else Ae(2);e.G=0,e.l&&e.l.sa(t),ur(e),Zt(e)}function ur(e){if(e.G=0,e.ka=[],e.l){const t=rt(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,d(e.i),e.i.length=0),e.l.ra()}}function hr(e,t,r){var n=r instanceof st?at(r):new st(r);if(""!=n.g)t&&(n.g=t+"."+n.g),lt(n,n.s);else{var s=i.location;n=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var a=new st(null);n&&ot(a,n),t&&(a.g=t),s&&lt(a,s),r&&(a.l=r),n=a}return r=e.D,t=e.ya,r&&t&&ut(n,r,t),ut(n,"VER",e.la),er(e,n),n}function dr(e,t,r){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Bt(new kt({eb:r})):new Bt(e.pa)).Ha(e.J),t}function fr(){}function pr(){}function mr(e,t){re.call(this),this.g=new Yt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new yr(this)}function gr(e){ye.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const r in t){e=r;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function vr(){be.call(this),this.status=1}function yr(e){this.g=e}(e=Bt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,r,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():De.g(),this.v=this.o?me(this.o):me(De),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(a){return void jt(this,a)}if(e=r||"",r=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var s in n)r.set(s,n[s]);else{if("function"!==typeof n.keys||"function"!==typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(const e of n.keys())r.set(e,n.get(e))}n=Array.from(r.keys()).find((e=>"content-type"==e.toLowerCase())),s=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Ft,t,void 0))||n||s||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of r)this.g.setRequestHeader(i,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wt(this),this.u=!0,this.g.send(e),this.u=!1}catch(a){jt(this,a)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,ne(this,"complete"),ne(this,"abort"),Ht(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ht(this,!0)),Bt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Vt(this):this.bb())},e.bb=function(){Vt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<Gt(this)?this.g.status:-1}catch(mt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(mt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),de(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Yt.prototype).la=8,e.G=1,e.connect=function(e,t,r,n){Ae(0),this.W=e,this.H=t||{},r&&void 0!==n&&(this.H.OSID=r,this.H.OAID=n),this.F=this.X,this.I=hr(this,null,this.W),Jt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new Le(this,this.j,e);let s=this.o;if(this.S&&(s?(s=b(s),x(s,this.S)):s=this.S),null!==this.m||this.O||(i.H=s,s=null),this.P)e:{for(var t=0,r=0;r<this.i.length;r++){var n=this.i[r];if(void 0===(n="__data__"in n.map&&"string"===typeof(n=n.map.__data__)?n.length:void 0))break;if(4096<(t+=n)){t=r;break e}if(4096===t||r===this.i.length-1){t=r+1;break e}}t=1e3}else t=1e3;t=tr(this,i,t),ut(r=at(this.I),"RID",e),ut(r,"CVER",22),this.D&&ut(r,"X-HTTP-Session-Id",this.D),er(this,r),s&&(this.O?t="headers="+encodeURIComponent(String(Lt(s)))+"&"+t:this.m&&Nt(r,this.m,s)),et(this.h,i),this.Ua&&ut(r,"TYPE","init"),this.P?(ut(r,"$req",t),ut(r,"SID","null"),i.T=!0,Fe(i,r,null)):Fe(i,r,t),this.G=2}}else 3==this.G&&(e?$t(this,e):0==this.i.length||Ze(this.h)||$t(this))},e.Fa=function(){if(this.u=null,sr(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Te(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ae(10),Qt(this),sr(this))},e.Za=function(){null!=this.C&&(this.C=null,Qt(this),nr(this),Ae(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Ae(2)):(this.j.info("Failed to ping google.com"),Ae(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=fr.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},pr.prototype.g=function(e,t){return new mr(e,t)},h(mr,re),mr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},mr.prototype.close=function(){Kt(this.g)},mr.prototype.o=function(e){var t=this.g;if("string"===typeof e){var r={};r.__data__=e,e=r}else this.u&&((r={}).__data__=he(e),e=r);t.i.push(new Ke(t.Ya++,e)),3==t.G&&Jt(t)},mr.prototype.N=function(){this.g.l=null,delete this.j,Kt(this.g),delete this.g,mr.aa.N.call(this)},h(gr,ye),h(vr,be),h(yr,fr),yr.prototype.ua=function(){ne(this.g,"a")},yr.prototype.ta=function(e){ne(this.g,new gr(e))},yr.prototype.sa=function(e){ne(this.g,new vr)},yr.prototype.ra=function(){ne(this.g,"b")},pr.prototype.createWebChannel=pr.prototype.g,mr.prototype.send=mr.prototype.o,mr.prototype.open=mr.prototype.m,mr.prototype.close=mr.prototype.close,OA=LA.createWebChannelTransport=function(){return new pr},IA=LA.getStatEventTarget=function(){return Se()},DA=LA.Event=we,kA=LA.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,PA=LA.ErrorCode=Ie,Oe.COMPLETE="complete",TA=LA.EventType=Oe,ge.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",re.prototype.listen=re.prototype.K,MA=LA.WebChannel=ge,LA.FetchXmlHttpFactory=kt,Bt.prototype.listenOnce=Bt.prototype.L,Bt.prototype.getLastError=Bt.prototype.Ka,Bt.prototype.getLastErrorCode=Bt.prototype.Ba,Bt.prototype.getStatus=Bt.prototype.Z,Bt.prototype.getResponseJson=Bt.prototype.Oa,Bt.prototype.getResponseText=Bt.prototype.oa,Bt.prototype.send=Bt.prototype.ea,Bt.prototype.setWithCredentials=Bt.prototype.Ha,AA=LA.XhrIo=Bt}).apply("undefined"!==typeof RA?RA:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const NA="@firebase/firestore";class BA{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}BA.UNAUTHENTICATED=new BA(null),BA.GOOGLE_CREDENTIALS=new BA("google-credentials-uid"),BA.FIRST_PARTY=new BA("first-party-uid"),BA.MOCK_USER=new BA("mock-user");let zA="11.0.2";const FA=new oE("@firebase/firestore");function jA(){return FA.logLevel}function UA(e){if(FA.logLevel<=rE.DEBUG){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const i=r.map(WA);FA.debug("Firestore (".concat(zA,"): ").concat(e),...i)}}function VA(e){if(FA.logLevel<=rE.ERROR){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const i=r.map(WA);FA.error("Firestore (".concat(zA,"): ").concat(e),...i)}}function HA(e){if(FA.logLevel<=rE.WARN){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const i=r.map(WA);FA.warn("Firestore (".concat(zA,"): ").concat(e),...i)}}function WA(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function GA(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state";const t="FIRESTORE (".concat(zA,") INTERNAL ASSERTION FAILED: ")+e;throw VA(t),new Error(t)}function qA(e,t){e||GA()}function XA(e,t){return e}const YA={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class KA extends WC{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class QA{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class ZA{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class JA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(BA.UNAUTHENTICATED)))}shutdown(){}}class $A{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class eM{constructor(e){this.t=e,this.currentUser=BA.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){qA(void 0===this.o);let r=this.i;const n=e=>this.i!==r?(r=this.i,t(e)):Promise.resolve();let i=new QA;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new QA,e.enqueueRetryable((()=>n(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await n(this.currentUser)}))},a=e=>{UA("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit((e=>a(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?a(e):(UA("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new QA)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(UA("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(qA("string"==typeof t.accessToken),new ZA(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return qA(null===e||"string"==typeof e),new BA(e)}}class tM{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=BA.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class rM{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new tM(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(BA.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class nM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class iM{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){qA(void 0===this.o);const r=e=>{null!=e.error&&UA("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const r=e.token!==this.R;return this.R=e.token,UA("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>r(t)))};const n=e=>{UA("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>n(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?n(e):UA("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(qA("string"==typeof e.token),this.R=e.token,new nM(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function sM(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(r);else for(let n=0;n<e;n++)r[n]=Math.floor(256*Math.random());return r}class aM{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let r="";for(;r.length<20;){const n=sM(40);for(let i=0;i<n.length;++i)r.length<20&&n[i]<t&&(r+=e.charAt(n[i]%62))}return r}}function oM(e,t){return e<t?-1:e>t?1:0}function lM(e,t,r){return e.length===t.length&&e.every(((e,n)=>r(e,t[n])))}class cM{static now(){return cM.fromMillis(Date.now())}static fromDate(e){return cM.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new cM(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new KA(YA.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new KA(YA.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new KA(YA.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new KA(YA.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?oM(this.nanoseconds,e.nanoseconds):oM(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class uM{static fromTimestamp(e){return new uM(e)}static min(){return new uM(new cM(0,0))}static max(){return new uM(new cM(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class hM{constructor(e,t,r){void 0===t?t=0:t>e.length&&GA(),void 0===r?r=e.length-t:r>e.length-t&&GA(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===hM.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof hM?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let n=0;n<r;n++){const r=e.get(n),i=t.get(n);if(r<i)return-1;if(r>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class dM extends hM{construct(e,t,r){return new dM(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(const i of r){if(i.indexOf("//")>=0)throw new KA(YA.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));e.push(...i.split("/").filter((e=>e.length>0)))}return new dM(e)}static emptyPath(){return new dM([])}}const fM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pM extends hM{construct(e,t,r){return new pM(e,t,r)}static isValidIdentifier(e){return fM.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pM.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new pM(["__name__"])}static fromServerFormat(e){const t=[];let r="",n=0;const i=()=>{if(0===r.length)throw new KA(YA.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""};let s=!1;for(;n<e.length;){const t=e[n];if("\\"===t){if(n+1===e.length)throw new KA(YA.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[n+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new KA(YA.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=t,n+=2}else"`"===t?(s=!s,n++):"."!==t||s?(r+=t,n++):(i(),n++)}if(i(),s)throw new KA(YA.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new pM(t)}static emptyPath(){return new pM([])}}class mM{constructor(e){this.path=e}static fromPath(e){return new mM(dM.fromString(e))}static fromName(e){return new mM(dM.fromString(e).popFirst(5))}static empty(){return new mM(dM.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===dM.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return dM.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new mM(new dM(e.slice()))}}class gM{constructor(e,t,r,n){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=n}}gM.UNKNOWN_ID=-1;function vM(e,t){const r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1,i=uM.fromTimestamp(1e9===n?new cM(r+1,0):new cM(r,n));return new bM(i,mM.empty(),t)}function yM(e){return new bM(e.readTime,e.key,-1)}class bM{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new bM(uM.min(),mM.empty(),-1)}static max(){return new bM(uM.max(),mM.empty(),-1)}}function wM(e,t){let r=e.readTime.compareTo(t.readTime);return 0!==r?r:(r=mM.comparator(e.documentKey,t.documentKey),0!==r?r:oM(e.largestBatchId,t.largestBatchId))}const xM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class SM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function _M(e){if(e.code!==YA.FAILED_PRECONDITION||e.message!==xM)throw e;UA("LocalStore","Unexpectedly lost primary lease")}class CM{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&GA(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new CM(((r,n)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(r,n)},this.catchCallback=e=>{this.wrapFailure(t,e).next(r,n)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof CM?t:CM.resolve(t)}catch(e){return CM.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):CM.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):CM.reject(t)}static resolve(e){return new CM(((t,r)=>{t(e)}))}static reject(e){return new CM(((t,r)=>{r(e)}))}static waitFor(e){return new CM(((t,r)=>{let n=0,i=0,s=!1;e.forEach((e=>{++n,e.next((()=>{++i,s&&i===n&&t()}),(e=>r(e)))})),s=!0,i===n&&t()}))}static or(e){let t=CM.resolve(!1);for(const r of e)t=t.next((e=>e?CM.resolve(e):r()));return t}static forEach(e,t){const r=[];return e.forEach(((e,n)=>{r.push(t.call(this,e,n))})),this.waitFor(r)}static mapArray(e,t){return new CM(((r,n)=>{const i=e.length,s=new Array(i);let a=0;for(let o=0;o<i;o++){const l=o;t(e[l]).next((e=>{s[l]=e,++a,a===i&&r(s)}),(e=>n(e)))}}))}static doWhile(e,t){return new CM(((r,n)=>{const i=()=>{!0===e()?t().next((()=>{i()}),n):r()};i()}))}}function EM(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function AM(e){return"IndexedDbTransactionError"===e.name}class MM{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function TM(e){return null==e}function PM(e){return 0===e&&1/e==-1/0}function kM(e){return"number"==typeof e&&Number.isInteger(e)&&!PM(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function DM(e){let t="";for(let r=0;r<e.length;r++)t.length>0&&(t=OM(t)),t=IM(e.get(r),t);return OM(t)}function IM(e,t){let r=t;const n=e.length;for(let i=0;i<n;i++){const t=e.charAt(i);switch(t){case"\0":r+="\x01\x10";break;case"\x01":r+="\x01\x11";break;default:r+=t}}return r}function OM(e){return e+"\x01\x01"}MM.oe=-1;const RM=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],LM=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],NM=LM,BM=[...NM,"indexConfiguration","indexState","indexEntries"];function zM(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function FM(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function jM(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class UM{constructor(e,t){this.comparator=e,this.root=t||HM.EMPTY}insert(e,t){return new UM(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,HM.BLACK,null,null))}remove(e){return new UM(this.comparator,this.root.remove(e,this.comparator).copy(null,null,HM.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(0===n)return t+r.left.size;n<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push("".concat(t,":").concat(r)),!1))),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new VM(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new VM(this.root,e,this.comparator,!1)}getReverseIterator(){return new VM(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new VM(this.root,e,this.comparator,!0)}}class VM{constructor(e,t,r,n){this.isReverse=n,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&n&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class HM{constructor(e,t,r,n,i){this.key=e,this.value=t,this.color=null!=r?r:HM.RED,this.left=null!=n?n:HM.EMPTY,this.right=null!=i?i:HM.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,n,i){return new HM(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=n?n:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let n=this;const i=r(e,n.key);return n=i<0?n.copy(null,null,null,n.left.insert(e,t,r),null):0===i?n.copy(null,t,null,null,null):n.copy(null,null,null,null,n.right.insert(e,t,r)),n.fixUp()}removeMin(){if(this.left.isEmpty())return HM.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,n=this;if(t(e,n.key)<0)n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),0===t(e,n.key)){if(n.right.isEmpty())return HM.EMPTY;r=n.right.min(),n=n.copy(r.key,r.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,HM.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,HM.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw GA();if(this.right.isRed())throw GA();const e=this.left.check();if(e!==this.right.check())throw GA();return e+(this.isRed()?0:1)}}HM.EMPTY=null,HM.RED=!0,HM.BLACK=!1,HM.EMPTY=new class{constructor(){this.size=0}get key(){throw GA()}get value(){throw GA()}get color(){throw GA()}get left(){throw GA()}get right(){throw GA()}copy(e,t,r,n,i){return this}insert(e,t,r){return new HM(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class WM{constructor(e){this.comparator=e,this.data=new UM(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const n=r.getNext();if(this.comparator(n.key,e[1])>=0)return;t(n.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new GM(this.data.getIterator())}getIteratorFrom(e){return new GM(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof WM))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,n=r.getNext().key;if(0!==this.comparator(e,n))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new WM(this.comparator);return t.data=e,t}}class GM{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class qM{constructor(e){this.fields=e,e.sort(pM.comparator)}static empty(){return new qM([])}unionWith(e){let t=new WM(pM.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new qM(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return lM(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class XM extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class YM{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new XM("Invalid base64 string: "+e):e}}(e);return new YM(t)}static fromUint8Array(e){const t=function(e){let t="";for(let r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t}(e);return new YM(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return oM(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}YM.EMPTY_BYTE_STRING=new YM("");const KM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function QM(e){if(qA(!!e),"string"==typeof e){let t=0;const r=KM.exec(e);if(qA(!!r),r[1]){let e=r[1];e=(e+"000000000").substr(0,9),t=Number(e)}const n=new Date(e);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:ZM(e.seconds),nanos:ZM(e.nanos)}}function ZM(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function JM(e){return"string"==typeof e?YM.fromBase64String(e):YM.fromUint8Array(e)}function $M(e){var t,r;return"server_timestamp"===(null===(r=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===r?void 0:r.stringValue)}function eT(e){const t=e.mapValue.fields.__previous_value__;return $M(t)?eT(t):t}function tT(e){const t=QM(e.mapValue.fields.__local_write_time__.timestampValue);return new cM(t.seconds,t.nanos)}class rT{constructor(e,t,r,n,i,s,a,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=n,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l}}class nT{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new nT("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof nT&&e.projectId===this.projectId&&e.database===this.database}}const iT={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function sT(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?$M(e)?4:xT(e)?9007199254740991:bT(e)?10:11:GA()}function aT(e,t){if(e===t)return!0;const r=sT(e);if(r!==sT(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return tT(e).isEqual(tT(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const r=QM(e.timestampValue),n=QM(t.timestampValue);return r.seconds===n.seconds&&r.nanos===n.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return JM(e.bytesValue).isEqual(JM(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return ZM(e.geoPointValue.latitude)===ZM(t.geoPointValue.latitude)&&ZM(e.geoPointValue.longitude)===ZM(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return ZM(e.integerValue)===ZM(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const r=ZM(e.doubleValue),n=ZM(t.doubleValue);return r===n?PM(r)===PM(n):isNaN(r)&&isNaN(n)}return!1}(e,t);case 9:return lM(e.arrayValue.values||[],t.arrayValue.values||[],aT);case 10:case 11:return function(e,t){const r=e.mapValue.fields||{},n=t.mapValue.fields||{};if(zM(r)!==zM(n))return!1;for(const i in r)if(r.hasOwnProperty(i)&&(void 0===n[i]||!aT(r[i],n[i])))return!1;return!0}(e,t);default:return GA()}}function oT(e,t){return void 0!==(e.values||[]).find((e=>aT(e,t)))}function lT(e,t){if(e===t)return 0;const r=sT(e),n=sT(t);if(r!==n)return oM(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return oM(e.booleanValue,t.booleanValue);case 2:return function(e,t){const r=ZM(e.integerValue||e.doubleValue),n=ZM(t.integerValue||t.doubleValue);return r<n?-1:r>n?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1}(e,t);case 3:return cT(e.timestampValue,t.timestampValue);case 4:return cT(tT(e),tT(t));case 5:return oM(e.stringValue,t.stringValue);case 6:return function(e,t){const r=JM(e),n=JM(t);return r.compareTo(n)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const r=e.split("/"),n=t.split("/");for(let i=0;i<r.length&&i<n.length;i++){const e=oM(r[i],n[i]);if(0!==e)return e}return oM(r.length,n.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const r=oM(ZM(e.latitude),ZM(t.latitude));return 0!==r?r:oM(ZM(e.longitude),ZM(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return uT(e.arrayValue,t.arrayValue);case 10:return function(e,t){var r,n,i,s;const a=e.fields||{},o=t.fields||{},l=null===(r=a.value)||void 0===r?void 0:r.arrayValue,c=null===(n=o.value)||void 0===n?void 0:n.arrayValue,u=oM((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(s=null==c?void 0:c.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:uT(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===iT.mapValue&&t===iT.mapValue)return 0;if(e===iT.mapValue)return 1;if(t===iT.mapValue)return-1;const r=e.fields||{},n=Object.keys(r),i=t.fields||{},s=Object.keys(i);n.sort(),s.sort();for(let a=0;a<n.length&&a<s.length;++a){const e=oM(n[a],s[a]);if(0!==e)return e;const t=lT(r[n[a]],i[s[a]]);if(0!==t)return t}return oM(n.length,s.length)}(e.mapValue,t.mapValue);default:throw GA()}}function cT(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return oM(e,t);const r=QM(e),n=QM(t),i=oM(r.seconds,n.seconds);return 0!==i?i:oM(r.nanos,n.nanos)}function uT(e,t){const r=e.values||[],n=t.values||[];for(let i=0;i<r.length&&i<n.length;++i){const e=lT(r[i],n[i]);if(e)return e}return oM(r.length,n.length)}function hT(e){return dT(e)}function dT(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=QM(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return JM(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return mM.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",r=!0;for(const n of e.values||[])r?r=!1:t+=",",t+=dT(n);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let r="{",n=!0;for(const i of t)n?n=!1:r+=",",r+="".concat(i,":").concat(dT(e.fields[i]));return r+"}"}(e.mapValue):GA()}function fT(e){switch(sT(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=eT(e);return t?16+fT(t):16;case 5:return 2*e.stringValue.length;case 6:return JM(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+fT(t)),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return FM(e.fields,((e,r)=>{t+=e.length+fT(r)})),t}(e.mapValue);default:throw GA()}}function pT(e){return!!e&&"integerValue"in e}function mT(e){return!!e&&"arrayValue"in e}function gT(e){return!!e&&"nullValue"in e}function vT(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function yT(e){return!!e&&"mapValue"in e}function bT(e){var t,r;return"__vector__"===(null===(r=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===r?void 0:r.stringValue)}function wT(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return FM(e.mapValue.fields,((e,r)=>t.mapValue.fields[e]=wT(r))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=wT(e.arrayValue.values[r]);return t}return Object.assign({},e)}function xT(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class ST{constructor(e){this.value=e}static empty(){return new ST({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!yT(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=wT(t)}setAll(e){let t=pM.emptyPath(),r={},n=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,r,n),r={},n=[],t=i.popLast()}e?r[i.lastSegment()]=wT(e):n.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,r,n)}delete(e){const t=this.field(e.popLast());yT(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return aT(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let n=t.mapValue.fields[e.get(r)];yT(n)&&n.mapValue.fields||(n={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=n),t=n}return t.mapValue.fields}applyChanges(e,t,r){FM(t,((t,r)=>e[t]=r));for(const n of r)delete e[n]}clone(){return new ST(wT(this.value))}}function _T(e){const t=[];return FM(e.fields,((e,r)=>{const n=new pM([e]);if(yT(r)){const e=_T(r.mapValue).fields;if(0===e.length)t.push(n);else for(const r of e)t.push(n.child(r))}else t.push(n)})),new qM(t)}class CT{constructor(e,t,r,n,i,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=n,this.createTime=i,this.data=s,this.documentState=a}static newInvalidDocument(e){return new CT(e,0,uM.min(),uM.min(),uM.min(),ST.empty(),0)}static newFoundDocument(e,t,r,n){return new CT(e,1,t,uM.min(),r,n,0)}static newNoDocument(e,t){return new CT(e,2,t,uM.min(),uM.min(),ST.empty(),0)}static newUnknownDocument(e,t){return new CT(e,3,t,uM.min(),uM.min(),ST.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(uM.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ST.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ST.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=uM.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof CT&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new CT(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class ET{constructor(e,t){this.position=e,this.inclusive=t}}function AT(e,t,r){let n=0;for(let i=0;i<e.position.length;i++){const s=t[i],a=e.position[i];if(n=s.field.isKeyField()?mM.comparator(mM.fromName(a.referenceValue),r.key):lT(a,r.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function MT(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!aT(e.position[r],t.position[r]))return!1;return!0}class TT{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function PT(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class kT{}class DT extends kT{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new FT(e,t,r):"array-contains"===t?new HT(e,r):"in"===t?new WT(e,r):"not-in"===t?new GT(e,r):"array-contains-any"===t?new qT(e,r):new DT(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new jT(e,r):new UT(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(lT(t,this.value)):null!==t&&sT(this.value)===sT(t)&&this.matchesComparison(lT(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return GA()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class IT extends kT{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new IT(e,t)}matches(e){return OT(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function OT(e){return"and"===e.op}function RT(e){return LT(e)&&OT(e)}function LT(e){for(const t of e.filters)if(t instanceof IT)return!1;return!0}function NT(e){if(e instanceof DT)return e.field.canonicalString()+e.op.toString()+hT(e.value);if(RT(e))return e.filters.map((e=>NT(e))).join(",");{const t=e.filters.map((e=>NT(e))).join(",");return"".concat(e.op,"(").concat(t,")")}}function BT(e,t){return e instanceof DT?function(e,t){return t instanceof DT&&e.op===t.op&&e.field.isEqual(t.field)&&aT(e.value,t.value)}(e,t):e instanceof IT?function(e,t){return t instanceof IT&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,r,n)=>e&&BT(r,t.filters[n])),!0)}(e,t):void GA()}function zT(e){return e instanceof DT?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(hT(e.value))}(e):e instanceof IT?function(e){return e.op.toString()+" {"+e.getFilters().map(zT).join(" ,")+"}"}(e):"Filter"}class FT extends DT{constructor(e,t,r){super(e,t,r),this.key=mM.fromName(r.referenceValue)}matches(e){const t=mM.comparator(e.key,this.key);return this.matchesComparison(t)}}class jT extends DT{constructor(e,t){super(e,"in",t),this.keys=VT("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class UT extends DT{constructor(e,t){super(e,"not-in",t),this.keys=VT("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function VT(e,t){var r;return((null===(r=t.arrayValue)||void 0===r?void 0:r.values)||[]).map((e=>mM.fromName(e.referenceValue)))}class HT extends DT{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return mT(t)&&oT(t.arrayValue,this.value)}}class WT extends DT{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&oT(this.value.arrayValue,t)}}class GT extends DT{constructor(e,t){super(e,"not-in",t)}matches(e){if(oT(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!oT(this.value.arrayValue,t)}}class qT extends DT{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!mT(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>oT(this.value.arrayValue,e)))}}class XT{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=n,this.limit=i,this.startAt=s,this.endAt=a,this.ue=null}}function YT(e){return new XT(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function KT(e){const t=XA(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>NT(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),TM(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>hT(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>hT(e))).join(",")),t.ue=e}return t.ue}function QT(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!PT(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!BT(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!MT(e.startAt,t.startAt)&&MT(e.endAt,t.endAt)}function ZT(e){return mM.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class JT{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=n,this.limit=i,this.limitType=s,this.startAt=a,this.endAt=o,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function $T(e,t,r,n,i,s,a,o){return new JT(e,t,r,n,i,s,a,o)}function eP(e){return new JT(e)}function tP(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function rP(e){return null!==e.collectionGroup}function nP(e){const t=XA(e);if(null===t.ce){t.ce=[];const e=new Set;for(const i of t.explicitOrderBy)t.ce.push(i),e.add(i.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",n=function(e){let t=new WM(pM.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);n.forEach((n=>{e.has(n.canonicalString())||n.isKeyField()||t.ce.push(new TT(n,r))})),e.has(pM.keyField().canonicalString())||t.ce.push(new TT(pM.keyField(),r))}return t.ce}function iP(e){const t=XA(e);return t.le||(t.le=sP(t,nP(e))),t.le}function sP(e,t){if("F"===e.limitType)return YT(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new TT(e.field,t)}));const r=e.endAt?new ET(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new ET(e.startAt.position,e.startAt.inclusive):null;return YT(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function aP(e,t,r){return new JT(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function oP(e,t){return QT(iP(e),iP(t))&&e.limitType===t.limitType}function lP(e){return"".concat(KT(iP(e)),"|lt:").concat(e.limitType)}function cP(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((e=>zT(e))).join(", "),"]")),TM(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e))).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>hT(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>hT(e))).join(",")),"Target(".concat(t,")")}(iP(e)),"; limitType=").concat(e.limitType,")")}function uP(e,t){return t.isFoundDocument()&&function(e,t){const r=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(r):mM.isDocumentKey(e.path)?e.path.isEqual(r):e.path.isImmediateParentOf(r)}(e,t)&&function(e,t){for(const r of nP(e))if(!r.field.isKeyField()&&null===t.data.field(r.field))return!1;return!0}(e,t)&&function(e,t){for(const r of e.filters)if(!r.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,r){const n=AT(e,t,r);return e.inclusive?n<=0:n<0}(e.startAt,nP(e),t))&&!(e.endAt&&!function(e,t,r){const n=AT(e,t,r);return e.inclusive?n>=0:n>0}(e.endAt,nP(e),t))}(e,t)}function hP(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function dP(e){return(t,r)=>{let n=!1;for(const i of nP(e)){const e=fP(i,t,r);if(0!==e)return e;n=n||i.field.isKeyField()}return 0}}function fP(e,t,r){const n=e.field.isKeyField()?mM.comparator(t.key,r.key):function(e,t,r){const n=t.data.field(e),i=r.data.field(e);return null!==n&&null!==i?lT(n,i):GA()}(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return GA()}}class pP{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[n,i]of r)if(this.equalsFn(n,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),n=this.inner[r];if(void 0===n)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return void(n[i]=[e,t]);n.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return 1===r.length?delete this.inner[t]:r.splice(n,1),this.innerSize--,!0;return!1}forEach(e){FM(this.inner,((t,r)=>{for(const[n,i]of r)e(n,i)}))}isEmpty(){return jM(this.inner)}size(){return this.innerSize}}const mP=new UM(mM.comparator);function gP(){return mP}const vP=new UM(mM.comparator);function yP(){let e=vP;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(const i of r)e=e.insert(i.key,i);return e}function bP(e){let t=vP;return e.forEach(((e,r)=>t=t.insert(e,r.overlayedDocument))),t}function wP(){return SP()}function xP(){return SP()}function SP(){return new pP((e=>e.toString()),((e,t)=>e.isEqual(t)))}const _P=new UM(mM.comparator),CP=new WM(mM.comparator);function EP(){let e=CP;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(const i of r)e=e.add(i);return e}const AP=new WM(oM);function MP(){return AP}function TP(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:PM(t)?"-0":t}}function PP(e){return{integerValue:""+e}}function kP(e,t){return kM(t)?PP(t):TP(e,t)}class DP{constructor(){this._=void 0}}function IP(e,t,r){return e instanceof LP?function(e,t){const r={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&$M(t)&&(t=eT(t)),t&&(r.fields.__previous_value__=t),{mapValue:r}}(r,t):e instanceof NP?BP(e,t):e instanceof zP?FP(e,t):function(e,t){const r=RP(e,t),n=UP(r)+UP(e.Pe);return pT(r)&&pT(e.Pe)?PP(n):TP(e.serializer,n)}(e,t)}function OP(e,t,r){return e instanceof NP?BP(e,t):e instanceof zP?FP(e,t):r}function RP(e,t){return e instanceof jP?function(e){return pT(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class LP extends DP{}class NP extends DP{constructor(e){super(),this.elements=e}}function BP(e,t){const r=VP(t);for(const n of e.elements)r.some((e=>aT(e,n)))||r.push(n);return{arrayValue:{values:r}}}class zP extends DP{constructor(e){super(),this.elements=e}}function FP(e,t){let r=VP(t);for(const n of e.elements)r=r.filter((e=>!aT(e,n)));return{arrayValue:{values:r}}}class jP extends DP{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function UP(e){return ZM(e.integerValue||e.doubleValue)}function VP(e){return mT(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class HP{constructor(e,t){this.version=e,this.transformResults=t}}class WP{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new WP}static exists(e){return new WP(void 0,e)}static updateTime(e){return new WP(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function GP(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class qP{}function XP(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new nk(e.key,WP.none()):new JP(e.key,e.data,WP.none());{const r=e.data,n=ST.empty();let i=new WM(pM.comparator);for(let e of t.fields)if(!i.has(e)){let t=r.field(e);null===t&&e.length>1&&(e=e.popLast(),t=r.field(e)),null===t?n.delete(e):n.set(e,t),i=i.add(e)}return new $P(e.key,n,new qM(i.toArray()),WP.none())}}function YP(e,t,r){e instanceof JP?function(e,t,r){const n=e.value.clone(),i=tk(e.fieldTransforms,t,r.transformResults);n.setAll(i),t.convertToFoundDocument(r.version,n).setHasCommittedMutations()}(e,t,r):e instanceof $P?function(e,t,r){if(!GP(e.precondition,t))return void t.convertToUnknownDocument(r.version);const n=tk(e.fieldTransforms,t,r.transformResults),i=t.data;i.setAll(ek(e)),i.setAll(n),t.convertToFoundDocument(r.version,i).setHasCommittedMutations()}(e,t,r):function(e,t,r){t.convertToNoDocument(r.version).setHasCommittedMutations()}(0,t,r)}function KP(e,t,r,n){return e instanceof JP?function(e,t,r,n){if(!GP(e.precondition,t))return r;const i=e.value.clone(),s=rk(e.fieldTransforms,n,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,r,n):e instanceof $P?function(e,t,r,n){if(!GP(e.precondition,t))return r;const i=rk(e.fieldTransforms,n,t),s=t.data;return s.setAll(ek(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===r?null:r.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,r,n):function(e,t,r){return GP(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):r}(e,t,r)}function QP(e,t){let r=null;for(const n of e.fieldTransforms){const e=t.data.field(n.field),i=RP(n.transform,e||null);null!=i&&(null===r&&(r=ST.empty()),r.set(n.field,i))}return r||null}function ZP(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&lM(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof NP&&t instanceof NP||e instanceof zP&&t instanceof zP?lM(e.elements,t.elements,aT):e instanceof jP&&t instanceof jP?aT(e.Pe,t.Pe):e instanceof LP&&t instanceof LP}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class JP extends qP{constructor(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}class $P extends qP{constructor(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=n,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function ek(e){const t=new Map;return e.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=e.data.field(r);t.set(r,n)}})),t}function tk(e,t,r){const n=new Map;qA(e.length===r.length);for(let i=0;i<r.length;i++){const s=e[i],a=s.transform,o=t.data.field(s.field);n.set(s.field,OP(a,o,r[i]))}return n}function rk(e,t,r){const n=new Map;for(const i of e){const e=i.transform,s=r.data.field(i.field);n.set(i.field,IP(e,s,t))}return n}class nk extends qP{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ik extends qP{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class sk{constructor(e,t,r,n){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=n}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let n=0;n<this.mutations.length;n++){const t=this.mutations[n];t.key.isEqual(e.key)&&YP(t,e,r[n])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=KP(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=KP(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=xP();return this.mutations.forEach((n=>{const i=e.get(n.key),s=i.overlayedDocument;let a=this.applyToLocalView(s,i.mutatedFields);a=t.has(n.key)?null:a;const o=XP(s,a);null!==o&&r.set(n.key,o),s.isValidDocument()||s.convertToNoDocument(uM.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),EP())}isEqual(e){return this.batchId===e.batchId&&lM(this.mutations,e.mutations,((e,t)=>ZP(e,t)))&&lM(this.baseMutations,e.baseMutations,((e,t)=>ZP(e,t)))}}class ak{constructor(e,t,r,n){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=n}static from(e,t,r){qA(e.mutations.length===r.length);let n=_P;const i=e.mutations;for(let s=0;s<i.length;s++)n=n.insert(i[s].key,r[s].version);return new ak(e,t,r,n)}}class ok{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class lk{constructor(e,t){this.count=e,this.unchangedNames=t}}var ck,uk;function hk(e){switch(e){default:return GA();case YA.CANCELLED:case YA.UNKNOWN:case YA.DEADLINE_EXCEEDED:case YA.RESOURCE_EXHAUSTED:case YA.INTERNAL:case YA.UNAVAILABLE:case YA.UNAUTHENTICATED:return!1;case YA.INVALID_ARGUMENT:case YA.NOT_FOUND:case YA.ALREADY_EXISTS:case YA.PERMISSION_DENIED:case YA.FAILED_PRECONDITION:case YA.ABORTED:case YA.OUT_OF_RANGE:case YA.UNIMPLEMENTED:case YA.DATA_LOSS:return!0}}function dk(e){if(void 0===e)return VA("GRPC error has no .code"),YA.UNKNOWN;switch(e){case ck.OK:return YA.OK;case ck.CANCELLED:return YA.CANCELLED;case ck.UNKNOWN:return YA.UNKNOWN;case ck.DEADLINE_EXCEEDED:return YA.DEADLINE_EXCEEDED;case ck.RESOURCE_EXHAUSTED:return YA.RESOURCE_EXHAUSTED;case ck.INTERNAL:return YA.INTERNAL;case ck.UNAVAILABLE:return YA.UNAVAILABLE;case ck.UNAUTHENTICATED:return YA.UNAUTHENTICATED;case ck.INVALID_ARGUMENT:return YA.INVALID_ARGUMENT;case ck.NOT_FOUND:return YA.NOT_FOUND;case ck.ALREADY_EXISTS:return YA.ALREADY_EXISTS;case ck.PERMISSION_DENIED:return YA.PERMISSION_DENIED;case ck.FAILED_PRECONDITION:return YA.FAILED_PRECONDITION;case ck.ABORTED:return YA.ABORTED;case ck.OUT_OF_RANGE:return YA.OUT_OF_RANGE;case ck.UNIMPLEMENTED:return YA.UNIMPLEMENTED;case ck.DATA_LOSS:return YA.DATA_LOSS;default:return GA()}}(uk=ck||(ck={}))[uk.OK=0]="OK",uk[uk.CANCELLED=1]="CANCELLED",uk[uk.UNKNOWN=2]="UNKNOWN",uk[uk.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",uk[uk.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",uk[uk.NOT_FOUND=5]="NOT_FOUND",uk[uk.ALREADY_EXISTS=6]="ALREADY_EXISTS",uk[uk.PERMISSION_DENIED=7]="PERMISSION_DENIED",uk[uk.UNAUTHENTICATED=16]="UNAUTHENTICATED",uk[uk.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",uk[uk.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",uk[uk.ABORTED=10]="ABORTED",uk[uk.OUT_OF_RANGE=11]="OUT_OF_RANGE",uk[uk.UNIMPLEMENTED=12]="UNIMPLEMENTED",uk[uk.INTERNAL=13]="INTERNAL",uk[uk.UNAVAILABLE=14]="UNAVAILABLE",uk[uk.DATA_LOSS=15]="DATA_LOSS";let fk=null;function pk(){return new TextEncoder}const mk=new SA([4294967295,4294967295],0);function gk(e){const t=pk().encode(e),r=new _A;return r.update(t),new Uint8Array(r.digest())}function vk(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new SA([r,n],0),new SA([i,s],0)]}class yk{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new bk("Invalid padding: ".concat(t));if(r<0)throw new bk("Invalid hash count: ".concat(r));if(e.length>0&&0===this.hashCount)throw new bk("Invalid hash count: ".concat(r));if(0===e.length&&0!==t)throw new bk("Invalid padding when bitmap length is 0: ".concat(t));this.Te=8*e.length-t,this.Ie=SA.fromNumber(this.Te)}Ee(e,t,r){let n=e.add(t.multiply(SA.fromNumber(r)));return 1===n.compare(mk)&&(n=new SA([n.getBits(0),n.getBits(1)],0)),n.modulo(this.Ie).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const t=gk(e),[r,n]=vk(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(r,n,i);if(!this.de(e))return!1}return!0}static create(e,t,r){const n=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new yk(i,n,t);return r.forEach((e=>s.insert(e))),s}insert(e){if(0===this.Te)return;const t=gk(e),[r,n]=vk(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(r,n,i);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class bk extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class wk{constructor(e,t,r,n,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=n,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const n=new Map;return n.set(e,xk.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new wk(uM.min(),n,new UM(oM),gP(),EP())}}class xk{constructor(e,t,r,n,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=n,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new xk(r,t,EP(),EP(),EP())}}class Sk{constructor(e,t,r,n){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=n}}class _k{constructor(e,t){this.targetId=e,this.me=t}}class Ck{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:YM.EMPTY_BYTE_STRING,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=n}}class Ek{constructor(){this.fe=0,this.ge=Tk(),this.pe=YM.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=EP(),t=EP(),r=EP();return this.ge.forEach(((n,i)=>{switch(i){case 0:e=e.add(n);break;case 2:t=t.add(n);break;case 1:r=r.add(n);break;default:GA()}})),new xk(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Tk()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,qA(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Ak{constructor(e){this.Le=e,this.Be=new Map,this.ke=gP(),this.qe=Mk(),this.Qe=Mk(),this.Ke=new UM(oM)}$e(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(t,e.Ve):this.We(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.We(t,e.key,e.Ve)}Ge(e){this.forEachTarget(e,(t=>{const r=this.ze(t);switch(e.state){case 0:this.je(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.je(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),r.De(e.resumeToken));break;default:GA()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((e,r)=>{this.je(r)&&t(r)}))}Je(e){const t=e.targetId,r=e.me.count,n=this.Ye(t);if(n){const i=n.target;if(ZT(i))if(0===r){const e=new mM(i.path);this.We(t,e,CT.newNoDocument(e,uM.min()))}else qA(1===r);else{const n=this.Ze(t);if(n!==r){const r=this.Xe(e),i=r?this.et(r,e,n):1;if(0!==i){this.He(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,e)}null==fk||fk.tt(function(e,t,r,n,i){var s,a,o,l,c,u;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:r.database,projectId:r.projectId},d=t.unchangedNames;return d&&(h.bloomFilter={applied:0===i,hashCount:null!==(s=null==d?void 0:d.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(l=null===(o=null===(a=null==d?void 0:d.bits)||void 0===a?void 0:a.bitmap)||void 0===o?void 0:o.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==d?void 0:d.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==n?void 0:n.mightContain(e))&&void 0!==t&&t}}),h}(n,e.me,this.Le.nt(),r,i))}}}}Xe(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:n=0},hashCount:i=0}=t;let s,a;try{s=JM(r).toUint8Array()}catch(e){if(e instanceof XM)return HA("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{a=new yk(s,n,i)}catch(e){return HA(e instanceof bk?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===a.Te?null:a}et(e,t,r){return t.me.count===r-this.rt(e,t.targetId)?0:2}rt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let n=0;return r.forEach((r=>{const i=this.Le.nt(),s="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(r.path.canonicalString());e.mightContain(s)||(this.We(t,r,null),n++)})),n}it(e){const t=new Map;this.Be.forEach(((r,n)=>{const i=this.Ye(n);if(i){if(r.current&&ZT(i.target)){const t=new mM(i.target.path);this.st(t).has(n)||this.ot(n,t)||this.We(n,t,CT.newNoDocument(t,e))}r.be&&(t.set(n,r.ve()),r.Ce())}}));let r=EP();this.Qe.forEach(((e,t)=>{let n=!0;t.forEachWhile((e=>{const t=this.Ye(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(n=!1,!1)})),n&&(r=r.add(e))})),this.ke.forEach(((t,r)=>r.setReadTime(e)));const n=new wk(e,t,this.Ke,this.ke,r);return this.ke=gP(),this.qe=Mk(),this.Qe=Mk(),this.Ke=new UM(oM),n}Ue(e,t){if(!this.je(e))return;const r=this.ot(e,t.key)?2:0;this.ze(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e)),this.Qe=this.Qe.insert(t.key,this._t(t.key).add(e))}We(e,t,r){if(!this.je(e))return;const n=this.ze(e);this.ot(e,t)?n.Fe(t,1):n.Me(t),this.Qe=this.Qe.insert(t,this._t(t).delete(e)),this.Qe=this.Qe.insert(t,this._t(t).add(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let t=this.Be.get(e);return t||(t=new Ek,this.Be.set(e,t)),t}_t(e){let t=this.Qe.get(e);return t||(t=new WM(oM),this.Qe=this.Qe.insert(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new WM(oM),this.qe=this.qe.insert(e,t)),t}je(e){const t=null!==this.Ye(e);return t||UA("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ut(e)}He(e){this.Be.set(e,new Ek),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.We(e,t,null)}))}ot(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Mk(){return new UM(mM.comparator)}function Tk(){return new UM(mM.comparator)}const Pk={asc:"ASCENDING",desc:"DESCENDING"},kk={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Dk={and:"AND",or:"OR"};class Ik{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ok(e,t){return e.useProto3Json||TM(t)?t:{value:t}}function Rk(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Lk(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Nk(e,t){return Rk(e,t.toTimestamp())}function Bk(e){return qA(!!e),uM.fromTimestamp(function(e){const t=QM(e);return new cM(t.seconds,t.nanos)}(e))}function zk(e,t){return Fk(e,t).canonicalString()}function Fk(e,t){const r=function(e){return new dM(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?r:r.child(t)}function jk(e){const t=dM.fromString(e);return qA(aD(t)),t}function Uk(e,t){return zk(e.databaseId,t.path)}function Vk(e,t){const r=jk(t);if(r.get(1)!==e.databaseId.projectId)throw new KA(YA.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new KA(YA.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new mM(qk(r))}function Hk(e,t){return zk(e.databaseId,t)}function Wk(e){const t=jk(e);return 4===t.length?dM.emptyPath():qk(t)}function Gk(e){return new dM(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function qk(e){return qA(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Xk(e,t,r){return{name:Uk(e,t),fields:r.value.mapValue.fields}}function Yk(e,t){let r;if(t instanceof JP)r={update:Xk(e,t.key,t.value)};else if(t instanceof nk)r={delete:Uk(e,t.key)};else if(t instanceof $P)r={update:Xk(e,t.key,t.data),updateMask:sD(t.fieldMask)};else{if(!(t instanceof ik))return GA();r={verify:Uk(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const r=t.transform;if(r instanceof LP)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(r instanceof NP)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:r.elements}};if(r instanceof zP)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:r.elements}};if(r instanceof jP)return{fieldPath:t.field.canonicalString(),increment:r.Pe};throw GA()}(0,e)))),t.precondition.isNone||(r.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Nk(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:GA()}(e,t.precondition)),r}function Kk(e,t){return{documents:[Hk(e,t.path)]}}function Qk(e,t){const r={structuredQuery:{}},n=t.path;let i;null!==t.collectionGroup?(i=n,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Hk(e,i);const s=function(e){if(0!==e.length)return iD(IT.create(e,"and"))}(t.filters);s&&(r.structuredQuery.where=s);const a=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:rD(e.field),direction:$k(e.dir)}}(e)))}(t.orderBy);a&&(r.structuredQuery.orderBy=a);const o=Ok(e,t.limit);return null!==o&&(r.structuredQuery.limit=o),t.startAt&&(r.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ct:r,parent:i}}function Zk(e){let t=Wk(e.parent);const r=e.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){qA(1===n);const e=r.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];r.where&&(s=function(e){const t=Jk(e);return t instanceof IT&&RT(t)?t.getFilters():[t]}(r.where));let a=[];r.orderBy&&(a=function(e){return e.map((e=>function(e){return new TT(nD(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(r.orderBy));let o=null;r.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,TM(t)?null:t}(r.limit));let l=null;r.startAt&&(l=function(e){const t=!!e.before,r=e.values||[];return new ET(r,t)}(r.startAt));let c=null;return r.endAt&&(c=function(e){const t=!e.before,r=e.values||[];return new ET(r,t)}(r.endAt)),$T(t,i,a,s,o,"F",l,c)}function Jk(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=nD(e.unaryFilter.field);return DT.create(t,"==",{doubleValue:NaN});case"IS_NULL":const r=nD(e.unaryFilter.field);return DT.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const n=nD(e.unaryFilter.field);return DT.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=nD(e.unaryFilter.field);return DT.create(i,"!=",{nullValue:"NULL_VALUE"});default:return GA()}}(e):void 0!==e.fieldFilter?function(e){return DT.create(nD(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return GA()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return IT.create(e.compositeFilter.filters.map((e=>Jk(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return GA()}}(e.compositeFilter.op))}(e):GA()}function $k(e){return Pk[e]}function eD(e){return kk[e]}function tD(e){return Dk[e]}function rD(e){return{fieldPath:e.canonicalString()}}function nD(e){return pM.fromServerFormat(e.fieldPath)}function iD(e){return e instanceof DT?function(e){if("=="===e.op){if(vT(e.value))return{unaryFilter:{field:rD(e.field),op:"IS_NAN"}};if(gT(e.value))return{unaryFilter:{field:rD(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(vT(e.value))return{unaryFilter:{field:rD(e.field),op:"IS_NOT_NAN"}};if(gT(e.value))return{unaryFilter:{field:rD(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:rD(e.field),op:eD(e.op),value:e.value}}}(e):e instanceof IT?function(e){const t=e.getFilters().map((e=>iD(e)));return 1===t.length?t[0]:{compositeFilter:{op:tD(e.op),filters:t}}}(e):GA()}function sD(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function aD(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class oD{constructor(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:uM.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:uM.min(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:YM.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=n,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new oD(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new oD(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new oD(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new oD(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class lD{constructor(e){this.ht=e}}function cD(e){const t=Zk({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?aP(t,t.limit,"L"):t}class uD{constructor(){}Et(e,t){this.dt(e,t),t.At()}dt(e,t){if("nullValue"in e)this.Rt(t,5);else if("booleanValue"in e)this.Rt(t,10),t.Vt(e.booleanValue?1:0);else if("integerValue"in e)this.Rt(t,15),t.Vt(ZM(e.integerValue));else if("doubleValue"in e){const r=ZM(e.doubleValue);isNaN(r)?this.Rt(t,13):(this.Rt(t,15),PM(r)?t.Vt(0):t.Vt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Rt(t,20),"string"==typeof r&&(r=QM(r)),t.ft("".concat(r.seconds||"")),t.Vt(r.nanos||0)}else if("stringValue"in e)this.gt(e.stringValue,t),this.yt(t);else if("bytesValue"in e)this.Rt(t,30),t.wt(JM(e.bytesValue)),this.yt(t);else if("referenceValue"in e)this.St(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Rt(t,45),t.Vt(r.latitude||0),t.Vt(r.longitude||0)}else"mapValue"in e?xT(e)?this.Rt(t,Number.MAX_SAFE_INTEGER):bT(e)?this.bt(e.mapValue,t):(this.Dt(e.mapValue,t),this.yt(t)):"arrayValue"in e?(this.vt(e.arrayValue,t),this.yt(t)):GA()}gt(e,t){this.Rt(t,25),this.Ct(e,t)}Ct(e,t){t.ft(e)}Dt(e,t){const r=e.fields||{};this.Rt(t,55);for(const n of Object.keys(r))this.gt(n,t),this.dt(r[n],t)}bt(e,t){var r,n;const i=e.fields||{};this.Rt(t,53);const s="value",a=(null===(n=null===(r=i[s].arrayValue)||void 0===r?void 0:r.values)||void 0===n?void 0:n.length)||0;this.Rt(t,15),t.Vt(ZM(a)),this.gt(s,t),this.dt(i[s],t)}vt(e,t){const r=e.values||[];this.Rt(t,50);for(const n of r)this.dt(n,t)}St(e,t){this.Rt(t,37),mM.fromName(e).path.forEach((e=>{this.Rt(t,60),this.Ct(e,t)}))}Rt(e,t){e.Vt(t)}yt(e){e.Vt(2)}}uD.Ft=new uD;class hD{constructor(){this.ln=new dD}addToCollectionParentIndex(e,t){return this.ln.add(t),CM.resolve()}getCollectionParents(e,t){return CM.resolve(this.ln.getEntries(t))}addFieldIndex(e,t){return CM.resolve()}deleteFieldIndex(e,t){return CM.resolve()}deleteAllFieldIndexes(e){return CM.resolve()}createTargetIndexes(e,t){return CM.resolve()}getDocumentsMatchingTarget(e,t){return CM.resolve(null)}getIndexType(e,t){return CM.resolve(0)}getFieldIndexes(e,t){return CM.resolve([])}getNextCollectionGroupToUpdate(e){return CM.resolve(null)}getMinOffset(e,t){return CM.resolve(bM.min())}getMinOffsetFromCollectionGroup(e,t){return CM.resolve(bM.min())}updateCollectionGroup(e,t,r){return CM.resolve()}updateIndexEntries(e,t){return CM.resolve()}}class dD{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),n=this.index[t]||new WM(dM.comparator),i=!n.has(r);return this.index[t]=n.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),n=this.index[t];return n&&n.has(r)}getEntries(e){return(this.index[e]||new WM(dM.comparator)).toArray()}}new Uint8Array(0);const fD={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class pD{static withCacheSize(e){return new pD(e,pD.DEFAULT_COLLECTION_PERCENTILE,pD.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}pD.DEFAULT_COLLECTION_PERCENTILE=10,pD.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pD.DEFAULT=new pD(41943040,pD.DEFAULT_COLLECTION_PERCENTILE,pD.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pD.DISABLED=new pD(-1,0,0);class mD{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new mD(0)}static Qn(){return new mD(-1)}}function gD(e,t){let[r,n]=e,[i,s]=t;const a=oM(r,i);return 0===a?oM(n,s):a}class vD{constructor(e){this.Gn=e,this.buffer=new WM(gD),this.zn=0}jn(){return++this.zn}Hn(e){const t=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();gD(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class yD{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Jn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return null!==this.Jn}Yn(e){UA("LruGarbageCollector","Garbage collection scheduled in ".concat(e,"ms")),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){AM(e)?UA("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await _M(e)}await this.Yn(3e5)}))}}class bD{constructor(e,t){this.Zn=e,this.params=t}calculateTargetCount(e,t){return this.Zn.Xn(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return CM.resolve(MM.oe);const r=new vD(t);return this.Zn.forEachTarget(e,(e=>r.Hn(e.sequenceNumber))).next((()=>this.Zn.er(e,(e=>r.Hn(e))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Zn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Zn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(UA("LruGarbageCollector","Garbage collection skipped; disabled"),CM.resolve(fD)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(UA("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(r," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),fD):this.tr(e,t)))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,t){let r,n,i,s,a,o,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(UA("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),n=this.params.maximumSequenceNumbersToCollect):n=t,s=Date.now(),this.nthSequenceNumber(e,n)))).next((n=>(r=n,a=Date.now(),this.removeTargets(e,r,t)))).next((t=>(i=t,o=Date.now(),this.removeOrphanedDocuments(e,r)))).next((e=>(l=Date.now(),jA()<=rE.DEBUG&&UA("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(s-c,"ms\n\tDetermined least recently used ").concat(n," in ")+(a-s)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(o-a)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(l-o)+"ms\n"+"Total Duration: ".concat(l-c,"ms")),CM.resolve({didRun:!0,sequenceNumbersCollected:n,targetsRemoved:i,documentsRemoved:e}))))}}function wD(e,t){return new bD(e,t)}class xD{constructor(){this.changes=new pP((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,CT.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?CM.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class SD{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class _D{constructor(e,t,r,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=n}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((n=>(r=n,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==r&&KP(r.mutation,e,qM.empty(),cM.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,EP()).next((()=>t))))}getLocalViewOfDocuments(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:EP();const n=wP();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,r).next((e=>{let t=yP();return e.forEach(((e,r)=>{t=t.insert(e,r.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const r=wP();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,EP())))}populateOverlays(e,t,r){const n=[];return r.forEach((e=>{t.has(e)||n.push(e)})),this.documentOverlayCache.getOverlays(e,n).next((e=>{e.forEach(((e,r)=>{t.set(e,r)}))}))}computeViews(e,t,r,n){let i=gP();const s=SP(),a=SP();return t.forEach(((e,t)=>{const a=r.get(t.key);n.has(t.key)&&(void 0===a||a.mutation instanceof $P)?i=i.insert(t.key,t):void 0!==a?(s.set(t.key,a.mutation.getFieldMask()),KP(a.mutation,t,a.mutation.getFieldMask(),cM.now())):s.set(t.key,qM.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var r;return a.set(e,new SD(t,null!==(r=s.get(e))&&void 0!==r?r:null))})),a)))}recalculateAndSaveOverlays(e,t){const r=SP();let n=new UM(((e,t)=>e-t)),i=EP();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let a=r.get(e)||qM.empty();a=i.applyToLocalView(s,a),r.set(e,a);const o=(n.get(i.batchId)||EP()).add(e);n=n.insert(i.batchId,o)}))})).next((()=>{const s=[],a=n.getReverseIterator();for(;a.hasNext();){const n=a.getNext(),o=n.key,l=n.value,c=xP();l.forEach((e=>{if(!i.has(e)){const n=XP(t.get(e),r.get(e));null!==n&&c.set(e,n),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,o,c))}return CM.waitFor(s)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,r,n){return function(e){return mM.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):rP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,n):this.getDocumentsMatchingCollectionQuery(e,t,r,n)}getNextDocuments(e,t,r,n){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,n).next((i=>{const s=n-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,n-i.size):CM.resolve(wP());let a=-1,o=i;return s.next((t=>CM.forEach(t,((t,r)=>(a<r.largestBatchId&&(a=r.largestBatchId),i.get(t)?CM.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{o=o.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,o,t,EP()))).next((e=>({batchId:a,changes:bP(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new mM(t)).next((e=>{let t=yP();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,n){const i=t.collectionGroup;let s=yP();return this.indexManager.getCollectionParents(e,i).next((a=>CM.forEach(a,(a=>{const o=function(e,t){return new JT(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,r,n).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,r,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,n)))).next((e=>{i.forEach(((t,r)=>{const n=r.getKey();null===e.get(n)&&(e=e.insert(n,CT.newInvalidDocument(n)))}));let r=yP();return e.forEach(((e,n)=>{const s=i.get(e);void 0!==s&&KP(s.mutation,n,qM.empty(),cM.now()),uP(t,n)&&(r=r.insert(e,n))})),r}))}}class CD{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,t){return CM.resolve(this.Tr.get(t))}saveBundleMetadata(e,t){return this.Tr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Bk(e.createTime)}}(t)),CM.resolve()}getNamedQuery(e,t){return CM.resolve(this.Ir.get(t))}saveNamedQuery(e,t){return this.Ir.set(t.name,function(e){return{name:e.name,query:cD(e.bundledQuery),readTime:Bk(e.readTime)}}(t)),CM.resolve()}}class ED{constructor(){this.overlays=new UM(mM.comparator),this.Er=new Map}getOverlay(e,t){return CM.resolve(this.overlays.get(t))}getOverlays(e,t){const r=wP();return CM.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&r.set(t,e)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((r,n)=>{this.Tt(e,t,n)})),CM.resolve()}removeOverlaysForBatchId(e,t,r){const n=this.Er.get(r);return void 0!==n&&(n.forEach((e=>this.overlays=this.overlays.remove(e))),this.Er.delete(r)),CM.resolve()}getOverlaysForCollection(e,t,r){const n=wP(),i=t.length+1,s=new mM(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const e=a.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>r&&n.set(e.getKey(),e)}return CM.resolve(n)}getOverlaysForCollectionGroup(e,t,r,n){let i=new UM(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>r){let t=i.get(e.largestBatchId);null===t&&(t=wP(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const a=wP(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((e,t)=>a.set(e,t))),!(a.size()>=n)););return CM.resolve(a)}Tt(e,t,r){const n=this.overlays.get(r.key);if(null!==n){const e=this.Er.get(n.largestBatchId).delete(r.key);this.Er.set(n.largestBatchId,e)}this.overlays=this.overlays.insert(r.key,new ok(t,r));let i=this.Er.get(t);void 0===i&&(i=EP(),this.Er.set(t,i)),this.Er.set(t,i.add(r.key))}}class AD{constructor(){this.sessionToken=YM.EMPTY_BYTE_STRING}getSessionToken(e){return CM.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,CM.resolve()}}class MD{constructor(){this.dr=new WM(TD.Ar),this.Rr=new WM(TD.Vr)}isEmpty(){return this.dr.isEmpty()}addReference(e,t){const r=new TD(e,t);this.dr=this.dr.add(r),this.Rr=this.Rr.add(r)}mr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.gr(new TD(e,t))}pr(e,t){e.forEach((e=>this.removeReference(e,t)))}yr(e){const t=new mM(new dM([])),r=new TD(t,e),n=new TD(t,e+1),i=[];return this.Rr.forEachInRange([r,n],(e=>{this.gr(e),i.push(e.key)})),i}wr(){this.dr.forEach((e=>this.gr(e)))}gr(e){this.dr=this.dr.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){const t=new mM(new dM([])),r=new TD(t,e),n=new TD(t,e+1);let i=EP();return this.Rr.forEachInRange([r,n],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new TD(e,0),r=this.dr.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class TD{constructor(e,t){this.key=e,this.br=t}static Ar(e,t){return mM.comparator(e.key,t.key)||oM(e.br,t.br)}static Vr(e,t){return oM(e.br,t.br)||mM.comparator(e.key,t.key)}}class PD{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Dr=1,this.vr=new WM(TD.Ar)}checkEmpty(e){return CM.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,n){const i=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new sk(i,t,r,n);this.mutationQueue.push(s);for(const a of n)this.vr=this.vr.add(new TD(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return CM.resolve(s)}lookupMutationBatch(e,t){return CM.resolve(this.Cr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,n=this.Fr(r),i=n<0?0:n;return CM.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return CM.resolve(0===this.mutationQueue.length?-1:this.Dr-1)}getAllMutationBatches(e){return CM.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new TD(t,0),n=new TD(t,Number.POSITIVE_INFINITY),i=[];return this.vr.forEachInRange([r,n],(e=>{const t=this.Cr(e.br);i.push(t)})),CM.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new WM(oM);return t.forEach((e=>{const t=new TD(e,0),n=new TD(e,Number.POSITIVE_INFINITY);this.vr.forEachInRange([t,n],(e=>{r=r.add(e.br)}))})),CM.resolve(this.Mr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,n=r.length+1;let i=r;mM.isDocumentKey(i)||(i=i.child(""));const s=new TD(new mM(i),0);let a=new WM(oM);return this.vr.forEachWhile((e=>{const t=e.key.path;return!!r.isPrefixOf(t)&&(t.length===n&&(a=a.add(e.br)),!0)}),s),CM.resolve(this.Mr(a))}Mr(e){const t=[];return e.forEach((e=>{const r=this.Cr(e);null!==r&&t.push(r)})),t}removeMutationBatch(e,t){qA(0===this.Or(t.batchId,"removed")),this.mutationQueue.shift();let r=this.vr;return CM.forEach(t.mutations,(n=>{const i=new TD(n.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,n.key)})).next((()=>{this.vr=r}))}Ln(e){}containsKey(e,t){const r=new TD(t,0),n=this.vr.firstAfterOrEqual(r);return CM.resolve(t.isEqual(n&&n.key))}performConsistencyCheck(e){return this.mutationQueue.length,CM.resolve()}Or(e,t){return this.Fr(e)}Fr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Cr(e){const t=this.Fr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class kD{constructor(e){this.Nr=e,this.docs=new UM(mM.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,n=this.docs.get(r),i=n?n.size:0,s=this.Nr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return CM.resolve(r?r.document.mutableCopy():CT.newInvalidDocument(t))}getEntries(e,t){let r=gP();return t.forEach((e=>{const t=this.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():CT.newInvalidDocument(e))})),CM.resolve(r)}getDocumentsMatchingQuery(e,t,r,n){let i=gP();const s=t.path,a=new mM(s.child("")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){const{key:e,value:{document:a}}=o.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||wM(yM(a),r)<=0||(n.has(a.key)||uP(t,a))&&(i=i.insert(a.key,a.mutableCopy()))}return CM.resolve(i)}getAllFromCollectionGroup(e,t,r,n){GA()}Lr(e,t){return CM.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new DD(this)}getSize(e){return CM.resolve(this.size)}}class DD extends xD{constructor(e){super(),this.hr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,n)=>{n.isValidDocument()?t.push(this.hr.addEntry(e,n)):this.hr.removeEntry(r)})),CM.waitFor(t)}getFromCache(e,t){return this.hr.getEntry(e,t)}getAllFromCache(e,t){return this.hr.getEntries(e,t)}}class ID{constructor(e){this.persistence=e,this.Br=new pP((e=>KT(e)),QT),this.lastRemoteSnapshotVersion=uM.min(),this.highestTargetId=0,this.kr=0,this.qr=new MD,this.targetCount=0,this.Qr=mD.qn()}forEachTarget(e,t){return this.Br.forEach(((e,r)=>t(r))),CM.resolve()}getLastRemoteSnapshotVersion(e){return CM.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return CM.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),CM.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.kr&&(this.kr=t),CM.resolve()}Un(e){this.Br.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Qr=new mD(t),this.highestTargetId=t),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,t){return this.Un(t),this.targetCount+=1,CM.resolve()}updateTargetData(e,t){return this.Un(t),CM.resolve()}removeTargetData(e,t){return this.Br.delete(t.target),this.qr.yr(t.targetId),this.targetCount-=1,CM.resolve()}removeTargets(e,t,r){let n=0;const i=[];return this.Br.forEach(((s,a)=>{a.sequenceNumber<=t&&null===r.get(a.targetId)&&(this.Br.delete(s),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),n++)})),CM.waitFor(i).next((()=>n))}getTargetCount(e){return CM.resolve(this.targetCount)}getTargetData(e,t){const r=this.Br.get(t)||null;return CM.resolve(r)}addMatchingKeys(e,t,r){return this.qr.mr(t,r),CM.resolve()}removeMatchingKeys(e,t,r){this.qr.pr(t,r);const n=this.persistence.referenceDelegate,i=[];return n&&t.forEach((t=>{i.push(n.markPotentiallyOrphaned(e,t))})),CM.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.qr.yr(t),CM.resolve()}getMatchingKeysForTargetId(e,t){const r=this.qr.Sr(t);return CM.resolve(r)}containsKey(e,t){return CM.resolve(this.qr.containsKey(t))}}class OD{constructor(e,t){this.Kr={},this.overlays={},this.$r=new MM(0),this.Ur=!1,this.Ur=!0,this.Wr=new AD,this.referenceDelegate=e(this),this.Gr=new ID(this),this.indexManager=new hD,this.remoteDocumentCache=function(e){return new kD(e)}((e=>this.referenceDelegate.zr(e))),this.serializer=new lD(t),this.jr=new CD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ED,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Kr[e.toKey()];return r||(r=new PD(t,this.referenceDelegate),this.Kr[e.toKey()]=r),r}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,t,r){UA("MemoryPersistence","Starting transaction:",e);const n=new RD(this.$r.next());return this.referenceDelegate.Hr(),r(n).next((e=>this.referenceDelegate.Jr(n).next((()=>e)))).toPromise().then((e=>(n.raiseOnCommittedEvent(),e)))}Yr(e,t){return CM.or(Object.values(this.Kr).map((r=>()=>r.containsKey(e,t))))}}class RD extends SM{constructor(e){super(),this.currentSequenceNumber=e}}class LD{constructor(e){this.persistence=e,this.Zr=new MD,this.Xr=null}static ei(e){return new LD(e)}get ti(){if(this.Xr)return this.Xr;throw GA()}addReference(e,t,r){return this.Zr.addReference(r,t),this.ti.delete(r.toString()),CM.resolve()}removeReference(e,t,r){return this.Zr.removeReference(r,t),this.ti.add(r.toString()),CM.resolve()}markPotentiallyOrphaned(e,t){return this.ti.add(t.toString()),CM.resolve()}removeTarget(e,t){this.Zr.yr(t.targetId).forEach((e=>this.ti.add(e.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.ti.add(e.toString())))})).next((()=>r.removeTargetData(e,t)))}Hr(){this.Xr=new Set}Jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return CM.forEach(this.ti,(r=>{const n=mM.fromPath(r);return this.ni(e,n).next((e=>{e||t.removeEntry(n,uM.min())}))})).next((()=>(this.Xr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ni(e,t).next((e=>{e?this.ti.delete(t.toString()):this.ti.add(t.toString())}))}zr(e){return 0}ni(e,t){return CM.or([()=>CM.resolve(this.Zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Yr(e,t)])}}class ND{constructor(e,t){this.persistence=e,this.ri=new pP((e=>DM(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=wD(this,t)}static ei(e,t){return new ND(e,t)}Hr(){}Jr(e){return CM.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Xn(e){const t=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}nr(e){let t=0;return this.er(e,(e=>{t++})).next((()=>t))}er(e,t){return CM.forEach(this.ri,((r,n)=>this.ir(e,r,n).next((e=>e?CM.resolve():t(n)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const n=this.persistence.getRemoteDocumentCache(),i=n.newChangeBuffer();return n.Lr(e,(n=>this.ir(e,n,t).next((e=>{e||(r++,i.removeEntry(n,uM.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.ri.set(t,e.currentSequenceNumber),CM.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.ri.set(r,e.currentSequenceNumber),CM.resolve()}removeReference(e,t,r){return this.ri.set(r,e.currentSequenceNumber),CM.resolve()}updateLimboDocument(e,t){return this.ri.set(t,e.currentSequenceNumber),CM.resolve()}zr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=fT(e.data.value)),t}ir(e,t,r){return CM.or([()=>this.persistence.Yr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.ri.get(t);return CM.resolve(void 0!==e&&e>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class BD{constructor(e,t,r,n){this.targetId=e,this.fromCache=t,this.Wi=r,this.Gi=n}static zi(e,t){let r=EP(),n=EP();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:n=n.add(i.doc.key)}return new BD(e,t.fromCache,r,n)}}class zD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class FD{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=VC()?8:EM(UC())>0?6:4}initialize(e,t){this.Zi=e,this.indexManager=t,this.ji=!0}getDocumentsMatchingQuery(e,t,r,n){const i={result:null};return this.Xi(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.es(e,t,n,r).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const r=new zD;return this.ts(e,t,r).next((n=>{if(i.result=n,this.Hi)return this.ns(e,t,r,n.size)}))})).next((()=>i.result))}ns(e,t,r,n){return r.documentReadCount<this.Ji?(jA()<=rE.DEBUG&&UA("QueryEngine","SDK will not create cache indexes for query:",cP(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),CM.resolve()):(jA()<=rE.DEBUG&&UA("QueryEngine","Query:",cP(t),"scans",r.documentReadCount,"local documents and returns",n,"documents as results."),r.documentReadCount>this.Yi*n?(jA()<=rE.DEBUG&&UA("QueryEngine","The SDK decides to create cache indexes for query:",cP(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,iP(t))):CM.resolve())}Xi(e,t){if(tP(t))return CM.resolve(null);let r=iP(t);return this.indexManager.getIndexType(e,r).next((n=>0===n?null:(null!==t.limit&&1===n&&(t=aP(t,null,"F"),r=iP(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((n=>{const i=EP(...n);return this.Zi.getDocuments(e,i).next((n=>this.indexManager.getMinOffset(e,r).next((r=>{const s=this.rs(t,n);return this.ss(t,s,i,r.readTime)?this.Xi(e,aP(t,null,"F")):this.os(e,s,t,r)}))))})))))}es(e,t,r,n){return tP(t)||n.isEqual(uM.min())?CM.resolve(null):this.Zi.getDocuments(e,r).next((i=>{const s=this.rs(t,i);return this.ss(t,s,r,n)?CM.resolve(null):(jA()<=rE.DEBUG&&UA("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),cP(t)),this.os(e,s,t,vM(n,-1)).next((e=>e)))}))}rs(e,t){let r=new WM(dP(e));return t.forEach(((t,n)=>{uP(e,n)&&(r=r.add(n))})),r}ss(e,t,r,n){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(n)>0)}ts(e,t,r){return jA()<=rE.DEBUG&&UA("QueryEngine","Using full collection scan to execute query:",cP(t)),this.Zi.getDocumentsMatchingQuery(e,t,bM.min(),r)}os(e,t,r,n){return this.Zi.getDocumentsMatchingQuery(e,r,n).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class jD{constructor(e,t,r,n){this.persistence=e,this._s=t,this.serializer=n,this.us=new UM(oM),this.cs=new pP((e=>KT(e)),QT),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(r)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new _D(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.us)))}}function UD(e,t,r,n){return new jD(e,t,r,n)}async function VD(e,t){const r=XA(e);return await r.persistence.runTransaction("Handle user change","readonly",(e=>{let n;return r.mutationQueue.getAllMutationBatches(e).next((i=>(n=i,r.Ps(t),r.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let a=EP();for(const e of n){i.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}return r.localDocuments.getDocuments(e,a).next((e=>({Ts:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function HD(e){const t=XA(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Gr.getLastRemoteSnapshotVersion(e)))}function WD(e,t,r){let n=EP(),i=EP();return r.forEach((e=>n=n.add(e))),t.getEntries(e,n).next((e=>{let n=gP();return r.forEach(((r,s)=>{const a=e.get(r);s.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(r)),s.isNoDocument()&&s.version.isEqual(uM.min())?(t.removeEntry(r,s.readTime),n=n.insert(r,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(s),n=n.insert(r,s)):UA("LocalStore","Ignoring outdated watch update for ",r,". Current version:",a.version," Watch version:",s.version)})),{Is:n,Es:i}}))}function GD(e,t){const r=XA(e);return r.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function qD(e,t){const r=XA(e);return r.persistence.runTransaction("Allocate target","readwrite",(e=>{let n;return r.Gr.getTargetData(e,t).next((i=>i?(n=i,CM.resolve(n)):r.Gr.allocateTargetId(e).next((i=>(n=new oD(t,i,"TargetPurposeListen",e.currentSequenceNumber),r.Gr.addTargetData(e,n).next((()=>n)))))))})).then((e=>{const n=r.us.get(e.targetId);return(null===n||e.snapshotVersion.compareTo(n.snapshotVersion)>0)&&(r.us=r.us.insert(e.targetId,e),r.cs.set(t,e.targetId)),e}))}async function XD(e,t,r){const n=XA(e),i=n.us.get(t),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,(e=>n.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!AM(e))throw e;UA("LocalStore","Failed to update sequence numbers for target ".concat(t,": ").concat(e))}n.us=n.us.remove(t),n.cs.delete(i.target)}function YD(e,t,r){const n=XA(e);let i=uM.min(),s=EP();return n.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,r){const n=XA(e),i=n.cs.get(r);return void 0!==i?CM.resolve(n.us.get(i)):n.Gr.getTargetData(t,r)}(n,e,iP(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,n.Gr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>n._s.getDocumentsMatchingQuery(e,t,r?i:uM.min(),r?s:EP()))).next((e=>(KD(n,hP(t),e),{documents:e,ds:s})))))}function KD(e,t,r){let n=e.ls.get(t)||uM.min();r.forEach(((e,t)=>{t.readTime.compareTo(n)>0&&(n=t.readTime)})),e.ls.set(t,n)}class QD{constructor(){this.activeTargetIds=MP()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ZD{constructor(){this._o=new QD,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,t,r){this.ao[e]=t}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new QD,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class JD{uo(e){}shutdown(){}}class $D{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){UA("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.To)e(0)}Po(){UA("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.To)e(1)}static p(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let eI=null;function tI(){return null===eI?eI=268435456+Math.round(2147483648*Math.random()):eI++,"0x"+eI.toString(16)}const rI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class nI{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}}const iI="WebChannelConnection";class sI extends class{get Co(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),n=encodeURIComponent(this.databaseId.database);this.Fo=t+"://"+e.host,this.Mo="projects/".concat(r,"/databases/").concat(n),this.xo="(default)"===this.databaseId.database?"project_id=".concat(r):"project_id=".concat(r,"&database_id=").concat(n)}Oo(e,t,r,n,i){const s=tI(),a=this.No(e,t.toUriEncodedString());UA("RestConnection","Sending RPC '".concat(e,"' ").concat(s,":"),a,r);const o={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Lo(o,n,i),this.Bo(e,a,o,r).then((t=>(UA("RestConnection","Received RPC '".concat(e,"' ").concat(s,": "),t),t)),(t=>{throw HA("RestConnection","RPC '".concat(e,"' ").concat(s," failed with error: "),t,"url: ",a,"request:",r),t}))}ko(e,t,r,n,i,s){return this.Oo(e,t,r,n,i)}Lo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+zA,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,r)=>e[r]=t)),r&&r.headers.forEach(((t,r)=>e[r]=t))}No(e,t){const r=rI[e];return"".concat(this.Fo,"/v1/").concat(t,":").concat(r)}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Bo(e,t,r,n){const i=tI();return new Promise(((s,a)=>{const o=new AA;o.setWithCredentials(!0),o.listenOnce(TA.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case PA.NO_ERROR:const t=o.getResponseJson();UA(iI,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(t)),s(t);break;case PA.TIMEOUT:UA(iI,"RPC '".concat(e,"' ").concat(i," timed out")),a(new KA(YA.DEADLINE_EXCEEDED,"Request time out"));break;case PA.HTTP_ERROR:const r=o.getStatus();if(UA(iI,"RPC '".concat(e,"' ").concat(i," failed with status:"),r,"response text:",o.getResponseText()),r>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(YA).indexOf(t)>=0?t:YA.UNKNOWN}(t.status);a(new KA(e,t.message))}else a(new KA(YA.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new KA(YA.UNAVAILABLE,"Connection failed."));break;default:GA()}}finally{UA(iI,"RPC '".concat(e,"' ").concat(i," completed."))}}));const l=JSON.stringify(n);UA(iI,"RPC '".concat(e,"' ").concat(i," sending request:"),n),o.send(t,"POST",l,r,15)}))}qo(e,t,r){const n=tI(),i=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=OA(),a=IA(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Lo(o.initMessageHeaders,t,r),o.encodeInitMessageHeaders=!0;const c=i.join("");UA(iI,"Creating RPC '".concat(e,"' stream ").concat(n,": ").concat(c),o);const u=s.createWebChannel(c,o);let h=!1,d=!1;const f=new nI({Eo:t=>{d?UA(iI,"Not sending because RPC '".concat(e,"' stream ").concat(n," is closed:"),t):(h||(UA(iI,"Opening RPC '".concat(e,"' stream ").concat(n," transport.")),u.open(),h=!0),UA(iI,"RPC '".concat(e,"' stream ").concat(n," sending:"),t),u.send(t))},Ao:()=>u.close()}),p=(e,t,r)=>{e.listen(t,(e=>{try{r(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(u,MA.EventType.OPEN,(()=>{d||(UA(iI,"RPC '".concat(e,"' stream ").concat(n," transport opened.")),f.So())})),p(u,MA.EventType.CLOSE,(()=>{d||(d=!0,UA(iI,"RPC '".concat(e,"' stream ").concat(n," transport closed")),f.Do())})),p(u,MA.EventType.ERROR,(t=>{d||(d=!0,HA(iI,"RPC '".concat(e,"' stream ").concat(n," transport errored:"),t),f.Do(new KA(YA.UNAVAILABLE,"The operation could not be completed")))})),p(u,MA.EventType.MESSAGE,(t=>{var r;if(!d){const i=t.data[0];qA(!!i);const s=i,a=(null==s?void 0:s.error)||(null===(r=s[0])||void 0===r?void 0:r.error);if(a){UA(iI,"RPC '".concat(e,"' stream ").concat(n," received error:"),a);const t=a.status;let r=function(e){const t=ck[e];if(void 0!==t)return dk(t)}(t),i=a.message;void 0===r&&(r=YA.INTERNAL,i="Unknown error status: "+t+" with message "+a.message),d=!0,f.Do(new KA(r,i)),u.close()}else UA(iI,"RPC '".concat(e,"' stream ").concat(n," received:"),i),f.vo(i)}})),p(a,DA.STAT_EVENT,(t=>{t.stat===kA.PROXY?UA(iI,"RPC '".concat(e,"' stream ").concat(n," detected buffering proxy")):t.stat===kA.NOPROXY&&UA(iI,"RPC '".concat(e,"' stream ").concat(n," detected no buffering proxy"))})),setTimeout((()=>{f.bo()}),0),f}}function aI(){return"undefined"!=typeof document?document:null}function oI(e){return new Ik(e,!0)}class lI{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.li=e,this.timerId=t,this.Qo=r,this.Ko=n,this.$o=i,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();const t=Math.floor(this.Uo+this.Ho()),r=Math.max(0,Date.now()-this.Go),n=Math.max(0,t-r);n>0&&UA("ExponentialBackoff","Backing off for ".concat(n," ms (base delay: ").concat(this.Uo," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(r," ms ago)")),this.Wo=this.li.enqueueAfterDelay(this.timerId,n,(()=>(this.Go=Date.now(),e()))),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){null!==this.Wo&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){null!==this.Wo&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}}class cI{constructor(e,t,r,n,i,s,a,o){this.li=e,this.Yo=r,this.Zo=n,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new lI(e,t)}i_(){return 1===this.state||5===this.state||this.s_()}s_(){return 2===this.state||3===this.state}start(){this.n_=0,4!==this.state?this.auth():this.o_()}async stop(){this.i_()&&await this.close(0)}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&null===this.e_&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,(()=>this.u_())))}c_(e){this.l_(),this.stream.send(e)}async u_(){if(this.s_())return this.close(0)}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}async close(e,t){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,4!==e?this.r_.reset():t&&t.code===YA.RESOURCE_EXHAUSTED?(VA(t.toString()),VA("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):t&&t.code===YA.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.po(t)}P_(){}auth(){this.state=1;const e=this.T_(this.Xo),t=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[r,n]=e;this.Xo===t&&this.I_(r,n)}),(t=>{e((()=>{const e=new KA(YA.UNKNOWN,"Fetching auth token failed: "+t.message);return this.E_(e)}))}))}I_(e,t){const r=this.T_(this.Xo);this.stream=this.d_(e,t),this.stream.Ro((()=>{r((()=>this.listener.Ro()))})),this.stream.mo((()=>{r((()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,(()=>(this.s_()&&(this.state=3),Promise.resolve()))),this.listener.mo())))})),this.stream.po((e=>{r((()=>this.E_(e)))})),this.stream.onMessage((e=>{r((()=>1==++this.n_?this.A_(e):this.onNext(e)))}))}o_(){this.state=5,this.r_.jo((async()=>{this.state=0,this.start()}))}E_(e){return UA("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}T_(e){return t=>{this.li.enqueueAndForget((()=>this.Xo===e?t():(UA("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class uI extends cI{constructor(e,t,r,n,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,n,s),this.serializer=i}d_(e,t){return this.connection.qo("Listen",e,t)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();const t=function(e,t){let r;if("targetChange"in t){t.targetChange;const n=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:GA()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(qA(void 0===t||"string"==typeof t),YM.fromBase64String(t||"")):(qA(void 0===t||t instanceof Buffer||t instanceof Uint8Array),YM.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,o=a&&function(e){const t=void 0===e.code?YA.UNKNOWN:dk(e.code);return new KA(t,e.message||"")}(a);r=new Ck(n,i,s,o||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const i=Vk(e,n.document.name),s=Bk(n.document.updateTime),a=n.document.createTime?Bk(n.document.createTime):uM.min(),o=new ST({mapValue:{fields:n.document.fields}}),l=CT.newFoundDocument(i,s,a,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new Sk(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const i=Vk(e,n.document),s=n.readTime?Bk(n.readTime):uM.min(),a=CT.newNoDocument(i,s),o=n.removedTargetIds||[];r=new Sk([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const i=Vk(e,n.document),s=n.removedTargetIds||[];r=new Sk([],s,i,null)}else{if(!("filter"in t))return GA();{t.filter;const e=t.filter;e.targetId;const{count:n=0,unchangedNames:i}=e,s=new lk(n,i),a=e.targetId;r=new _k(a,s)}}return r}(this.serializer,e),r=function(e){if(!("targetChange"in e))return uM.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?uM.min():t.readTime?Bk(t.readTime):uM.min()}(e);return this.listener.R_(t,r)}V_(e){const t={};t.database=Gk(this.serializer),t.addTarget=function(e,t){let r;const n=t.target;if(r=ZT(n)?{documents:Kk(e,n)}:{query:Qk(e,n).ct},r.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){r.resumeToken=Lk(e,t.resumeToken);const n=Ok(e,t.expectedCount);null!==n&&(r.expectedCount=n)}else if(t.snapshotVersion.compareTo(uM.min())>0){r.readTime=Rk(e,t.snapshotVersion.toTimestamp());const n=Ok(e,t.expectedCount);null!==n&&(r.expectedCount=n)}return r}(this.serializer,e);const r=function(e,t){const r=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return GA()}}(t.purpose);return null==r?null:{"goog-listen-tags":r}}(this.serializer,e);r&&(t.labels=r),this.c_(t)}m_(e){const t={};t.database=Gk(this.serializer),t.removeTarget=e,this.c_(t)}}class hI extends cI{constructor(e,t,r,n,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,n,s),this.serializer=i}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}d_(e,t){return this.connection.qo("Write",e,t)}A_(e){return qA(!!e.streamToken),this.lastStreamToken=e.streamToken,qA(!e.writeResults||0===e.writeResults.length),this.listener.p_()}onNext(e){qA(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();const t=function(e,t){return e&&e.length>0?(qA(void 0!==t),e.map((e=>function(e,t){let r=e.updateTime?Bk(e.updateTime):Bk(t);return r.isEqual(uM.min())&&(r=Bk(t)),new HP(r,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),r=Bk(e.commitTime);return this.listener.y_(r,t)}w_(){const e={};e.database=Gk(this.serializer),this.c_(e)}g_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Yk(this.serializer,e)))};this.c_(t)}}class dI extends class{}{constructor(e,t,r,n){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=n,this.S_=!1}b_(){if(this.S_)throw new KA(YA.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,t,r,n){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[s,a]=i;return this.connection.Oo(e,Fk(t,r),n,s,a)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===YA.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new KA(YA.UNKNOWN,e.toString())}))}ko(e,t,r,n,i){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((s=>{let[a,o]=s;return this.connection.ko(e,Fk(t,r),n,a,o,i)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===YA.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new KA(YA.UNKNOWN,e.toString())}))}terminate(){this.S_=!0,this.connection.terminate()}}class fI{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){0===this.D_&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve()))))}O_(e){"Online"===this.state?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.M_("Offline")))}set(e){this.N_(),this.D_=0,"Online"===e&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.C_?(VA(t),this.C_=!1):UA("OnlineStateTracker",t)}N_(){null!==this.v_&&(this.v_.cancel(),this.v_=null)}}class pI{constructor(e,t,r,n,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.L_=[],this.B_=new Map,this.k_=new Set,this.q_=[],this.Q_=i,this.Q_.uo((e=>{r.enqueueAndForget((async()=>{_I(this)&&(UA("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=XA(e);t.k_.add(4),await gI(t),t.K_.set("Unknown"),t.k_.delete(4),await mI(t)}(this))}))})),this.K_=new fI(r,n)}}async function mI(e){if(_I(e))for(const t of e.q_)await t(!0)}async function gI(e){for(const t of e.q_)await t(!1)}function vI(e,t){const r=XA(e);r.B_.has(t.targetId)||(r.B_.set(t.targetId,t),SI(r)?xI(r):VI(r).s_()&&bI(r,t))}function yI(e,t){const r=XA(e),n=VI(r);r.B_.delete(t),n.s_()&&wI(r,t),0===r.B_.size&&(n.s_()?n.a_():_I(r)&&r.K_.set("Unknown"))}function bI(e,t){if(e.U_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(uM.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}VI(e).V_(t)}function wI(e,t){e.U_.xe(t),VI(e).m_(t)}function xI(e){e.U_=new Ak({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ut:t=>e.B_.get(t)||null,nt:()=>e.datastore.serializer.databaseId}),VI(e).start(),e.K_.F_()}function SI(e){return _I(e)&&!VI(e).i_()&&e.B_.size>0}function _I(e){return 0===XA(e).k_.size}function CI(e){e.U_=void 0}async function EI(e){e.K_.set("Online")}async function AI(e){e.B_.forEach(((t,r)=>{bI(e,t)}))}async function MI(e,t){CI(e),SI(e)?(e.K_.O_(t),xI(e)):e.K_.set("Unknown")}async function TI(e,t,r){if(e.K_.set("Online"),t instanceof Ck&&2===t.state&&t.cause)try{await async function(e,t){const r=t.cause;for(const n of t.targetIds)e.B_.has(n)&&(await e.remoteSyncer.rejectListen(n,r),e.B_.delete(n),e.U_.removeTarget(n))}(e,t)}catch(r){UA("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),await PI(e,r)}else if(t instanceof Sk?e.U_.$e(t):t instanceof _k?e.U_.Je(t):e.U_.Ge(t),!r.isEqual(uM.min()))try{const t=await HD(e.localStore);r.compareTo(t)>=0&&await function(e,t){const r=e.U_.it(t);return r.targetChanges.forEach(((r,n)=>{if(r.resumeToken.approximateByteSize()>0){const i=e.B_.get(n);i&&e.B_.set(n,i.withResumeToken(r.resumeToken,t))}})),r.targetMismatches.forEach(((t,r)=>{const n=e.B_.get(t);if(!n)return;e.B_.set(t,n.withResumeToken(YM.EMPTY_BYTE_STRING,n.snapshotVersion)),wI(e,t);const i=new oD(n.target,t,r,n.sequenceNumber);bI(e,i)})),e.remoteSyncer.applyRemoteEvent(r)}(e,r)}catch(t){UA("RemoteStore","Failed to raise snapshot:",t),await PI(e,t)}}async function PI(e,t,r){if(!AM(t))throw t;e.k_.add(1),await gI(e),e.K_.set("Offline"),r||(r=()=>HD(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{UA("RemoteStore","Retrying IndexedDB access"),await r(),e.k_.delete(1),await mI(e)}))}function kI(e,t){return t().catch((r=>PI(e,r,t)))}async function DI(e){const t=XA(e),r=HI(t);let n=t.L_.length>0?t.L_[t.L_.length-1].batchId:-1;for(;II(t);)try{const e=await GD(t.localStore,n);if(null===e){0===t.L_.length&&r.a_();break}n=e.batchId,OI(t,e)}catch(e){await PI(t,e)}RI(t)&&LI(t)}function II(e){return _I(e)&&e.L_.length<10}function OI(e,t){e.L_.push(t);const r=HI(e);r.s_()&&r.f_&&r.g_(t.mutations)}function RI(e){return _I(e)&&!HI(e).i_()&&e.L_.length>0}function LI(e){HI(e).start()}async function NI(e){HI(e).w_()}async function BI(e){const t=HI(e);for(const r of e.L_)t.g_(r.mutations)}async function zI(e,t,r){const n=e.L_.shift(),i=ak.from(n,t,r);await kI(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await DI(e)}async function FI(e,t){t&&HI(e).f_&&await async function(e,t){if(function(e){return hk(e)&&e!==YA.ABORTED}(t.code)){const r=e.L_.shift();HI(e).__(),await kI(e,(()=>e.remoteSyncer.rejectFailedWrite(r.batchId,t))),await DI(e)}}(e,t),RI(e)&&LI(e)}async function jI(e,t){const r=XA(e);r.asyncQueue.verifyOperationInProgress(),UA("RemoteStore","RemoteStore received new credentials");const n=_I(r);r.k_.add(3),await gI(r),n&&r.K_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.k_.delete(3),await mI(r)}async function UI(e,t){const r=XA(e);t?(r.k_.delete(2),await mI(r)):t||(r.k_.add(2),await gI(r),r.K_.set("Unknown"))}function VI(e){return e.W_||(e.W_=function(e,t,r){const n=XA(e);return n.b_(),new uI(t,n.connection,n.authCredentials,n.appCheckCredentials,n.serializer,r)}(e.datastore,e.asyncQueue,{Ro:EI.bind(null,e),mo:AI.bind(null,e),po:MI.bind(null,e),R_:TI.bind(null,e)}),e.q_.push((async t=>{t?(e.W_.__(),SI(e)?xI(e):e.K_.set("Unknown")):(await e.W_.stop(),CI(e))}))),e.W_}function HI(e){return e.G_||(e.G_=function(e,t,r){const n=XA(e);return n.b_(),new hI(t,n.connection,n.authCredentials,n.appCheckCredentials,n.serializer,r)}(e.datastore,e.asyncQueue,{Ro:()=>Promise.resolve(),mo:NI.bind(null,e),po:FI.bind(null,e),p_:BI.bind(null,e),y_:zI.bind(null,e)}),e.q_.push((async t=>{t?(e.G_.__(),await DI(e)):(await e.G_.stop(),e.L_.length>0&&(UA("RemoteStore","Stopping write stream with ".concat(e.L_.length," pending writes")),e.L_=[]))}))),e.G_}class WI{constructor(e,t,r,n,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=n,this.removalCallback=i,this.deferred=new QA,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,n,i){const s=Date.now()+r,a=new WI(e,t,s,n,i);return a.start(r),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new KA(YA.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function GI(e,t){if(VA("AsyncQueue","".concat(t,": ").concat(e)),AM(e))return new KA(YA.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class qI{static emptySet(e){return new qI(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||mM.comparator(t.key,r.key):(e,t)=>mM.comparator(e.key,t.key),this.keyedMap=yP(),this.sortedSet=new UM(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof qI))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,n=r.getNext().key;if(!e.isEqual(n))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new qI;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class XI{constructor(){this.z_=new UM(mM.comparator)}track(e){const t=e.doc.key,r=this.z_.get(t);r?0!==e.type&&3===r.type?this.z_=this.z_.insert(t,e):3===e.type&&1!==r.type?this.z_=this.z_.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.z_=this.z_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.z_=this.z_.remove(t):1===e.type&&2===r.type?this.z_=this.z_.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):GA():this.z_=this.z_.insert(t,e)}j_(){const e=[];return this.z_.inorderTraversal(((t,r)=>{e.push(r)})),e}}class YI{constructor(e,t,r,n,i,s,a,o,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=n,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,n,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new YI(e,t,qI.emptySet(t),s,r,n,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&oP(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let n=0;n<t.length;n++)if(t[n].type!==r[n].type||!t[n].doc.isEqual(r[n].doc))return!1;return!0}}class KI{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some((e=>e.Z_()))}}class QI{constructor(){this.queries=ZI(),this.onlineState="Unknown",this.X_=new Set}terminate(){!function(e,t){const r=XA(e),n=r.queries;r.queries=ZI(),n.forEach(((e,r)=>{for(const n of r.J_)n.onError(t)}))}(this,new KA(YA.ABORTED,"Firestore shutting down"))}}function ZI(){return new pP((e=>lP(e)),oP)}async function JI(e,t){const r=XA(e);let n=3;const i=t.query;let s=r.queries.get(i);s?!s.Y_()&&t.Z_()&&(n=2):(s=new KI,n=t.Z_()?0:1);try{switch(n){case 0:s.H_=await r.onListen(i,!0);break;case 1:s.H_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(e){const r=GI(e,"Initialization of query '".concat(cP(t.query),"' failed"));return void t.onError(r)}r.queries.set(i,s),s.J_.push(t),t.ea(r.onlineState),s.H_&&t.ta(s.H_)&&rO(r)}async function $I(e,t){const r=XA(e),n=t.query;let i=3;const s=r.queries.get(n);if(s){const e=s.J_.indexOf(t);e>=0&&(s.J_.splice(e,1),0===s.J_.length?i=t.Z_()?0:1:!s.Y_()&&t.Z_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function eO(e,t){const r=XA(e);let n=!1;for(const i of t){const e=i.query,t=r.queries.get(e);if(t){for(const e of t.J_)e.ta(i)&&(n=!0);t.H_=i}}n&&rO(r)}function tO(e,t,r){const n=XA(e),i=n.queries.get(t);if(i)for(const s of i.J_)s.onError(r);n.queries.delete(t)}function rO(e){e.X_.forEach((e=>{e.next()}))}var nO,iO;(iO=nO||(nO={})).na="default",iO.Cache="cache";class sO{constructor(e,t,r){this.query=e,this.ra=t,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=r||{}}ta(e){if(!this.options.includeMetadataChanges){const t=[];for(const r of e.docChanges)3!==r.type&&t.push(r);e=new YI(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ia?this.oa(e)&&(this.ra.next(e),t=!0):this._a(e,this.onlineState)&&(this.aa(e),t=!0),this.sa=e,t}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let t=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),t=!0),t}_a(e,t){if(!e.fromCache)return!0;if(!this.Z_())return!0;const r="Offline"!==t;return(!this.options.ua||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}oa(e){if(e.docChanges.length>0)return!0;const t=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}aa(e){e=YI.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==nO.Cache}}class aO{constructor(e){this.key=e}}class oO{constructor(e){this.key=e}}class lO{constructor(e,t){this.query=e,this.da=t,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=EP(),this.mutatedKeys=EP(),this.Va=dP(e),this.ma=new qI(this.Va)}get fa(){return this.da}ga(e,t){const r=t?t.pa:new XI,n=t?t.ma:this.ma;let i=t?t.mutatedKeys:this.mutatedKeys,s=n,a=!1;const o="F"===this.query.limitType&&n.size===this.query.limit?n.last():null,l="L"===this.query.limitType&&n.size===this.query.limit?n.first():null;if(e.inorderTraversal(((e,t)=>{const c=n.get(e),u=uP(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(r.track({type:3,doc:u}),f=!0):this.ya(c,u)||(r.track({type:2,doc:u}),f=!0,(o&&this.Va(u,o)>0||l&&this.Va(u,l)<0)&&(a=!0)):!c&&u?(r.track({type:0,doc:u}),f=!0):c&&!u&&(r.track({type:1,doc:c}),f=!0,(o||l)&&(a=!0)),f&&(u?(s=s.add(u),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),r.track({type:1,doc:e})}return{ma:s,pa:r,ss:a,mutatedKeys:i}}ya(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,n){const i=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;const s=e.pa.j_();s.sort(((e,t)=>function(e,t){const r=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return GA()}};return r(e)-r(t)}(e.type,t.type)||this.Va(e.doc,t.doc))),this.wa(r),n=null!=n&&n;const a=t&&!n?this.Sa():[],o=0===this.Ra.size&&this.current&&!n?1:0,l=o!==this.Aa;return this.Aa=o,0!==s.length||l?{snapshot:new YI(this.query,e.ma,i,s,e.mutatedKeys,0===o,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),ba:a}:{ba:a}}ea(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ma:this.ma,pa:new XI,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.da.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach((e=>this.da=this.da.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.da=this.da.delete(e))),this.current=e.current)}Sa(){if(!this.current)return[];const e=this.Ra;this.Ra=EP(),this.ma.forEach((e=>{this.Da(e.key)&&(this.Ra=this.Ra.add(e.key))}));const t=[];return e.forEach((e=>{this.Ra.has(e)||t.push(new oO(e))})),this.Ra.forEach((r=>{e.has(r)||t.push(new aO(r))})),t}va(e){this.da=e.ds,this.Ra=EP();const t=this.ga(e.documents);return this.applyChanges(t,!0)}Ca(){return YI.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,0===this.Aa,this.hasCachedResults)}}class cO{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class uO{constructor(e){this.key=e,this.Fa=!1}}class hO{constructor(e,t,r,n,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=n,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Ma={},this.xa=new pP((e=>lP(e)),oP),this.Oa=new Map,this.Na=new Set,this.La=new UM(mM.comparator),this.Ba=new Map,this.ka=new MD,this.qa={},this.Qa=new Map,this.Ka=mD.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return!0===this.$a}}async function dO(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=OO(e);let i;const s=n.xa.get(t);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Ca()):i=await pO(n,t,r,!0),i}async function fO(e,t){const r=OO(e);await pO(r,t,!0,!1)}async function pO(e,t,r,n){const i=await qD(e.localStore,iP(t)),s=i.targetId,a=e.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await mO(e,t,s,"current"===a,i.resumeToken)),e.isPrimaryClient&&r&&vI(e.remoteStore,i),o}async function mO(e,t,r,n,i){e.Ua=(t,r,n)=>async function(e,t,r,n){let i=t.view.ga(r);i.ss&&(i=await YD(e.localStore,t.query,!1).then((e=>{let{documents:r}=e;return t.view.ga(r,i)})));const s=n&&n.targetChanges.get(t.targetId),a=n&&null!=n.targetMismatches.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s,a);return MO(e,t.targetId,o.ba),o.snapshot}(e,t,r,n);const s=await YD(e.localStore,t,!0),a=new lO(t,s.ds),o=a.ga(s.documents),l=xk.createSynthesizedTargetChangeForCurrentChange(r,n&&"Offline"!==e.onlineState,i),c=a.applyChanges(o,e.isPrimaryClient,l);MO(e,r,c.ba);const u=new cO(t,r,a);return e.xa.set(t,u),e.Oa.has(r)?e.Oa.get(r).push(t):e.Oa.set(r,[t]),c.snapshot}async function gO(e,t,r){const n=XA(e),i=n.xa.get(t),s=n.Oa.get(i.targetId);if(s.length>1)return n.Oa.set(i.targetId,s.filter((e=>!oP(e,t)))),void n.xa.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await XD(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),r&&yI(n.remoteStore,i.targetId),EO(n,i.targetId)})).catch(_M)):(EO(n,i.targetId),await XD(n.localStore,i.targetId,!0))}async function vO(e,t){const r=XA(e),n=r.xa.get(t),i=r.Oa.get(n.targetId);r.isPrimaryClient&&1===i.length&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),yI(r.remoteStore,n.targetId))}async function yO(e,t){const r=XA(e);try{const e=await function(e,t){const r=XA(e),n=t.snapshotVersion;let i=r.us;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=r.hs.newChangeBuffer({trackRemovals:!0});i=r.us;const a=[];t.targetChanges.forEach(((s,o)=>{const l=i.get(o);if(!l)return;a.push(r.Gr.removeMatchingKeys(e,s.removedDocuments,o).next((()=>r.Gr.addMatchingKeys(e,s.addedDocuments,o))));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(YM.EMPTY_BYTE_STRING,uM.min()).withLastLimboFreeSnapshotVersion(uM.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,n)),i=i.insert(o,c),function(e,t,r){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size>0}(l,c,s)&&a.push(r.Gr.updateTargetData(e,c))}));let o=gP(),l=EP();if(t.documentUpdates.forEach((n=>{t.resolvedLimboDocuments.has(n)&&a.push(r.persistence.referenceDelegate.updateLimboDocument(e,n))})),a.push(WD(e,s,t.documentUpdates).next((e=>{o=e.Is,l=e.Es}))),!n.isEqual(uM.min())){const t=r.Gr.getLastRemoteSnapshotVersion(e).next((t=>r.Gr.setTargetsMetadata(e,e.currentSequenceNumber,n)));a.push(t)}return CM.waitFor(a).next((()=>s.apply(e))).next((()=>r.localDocuments.getLocalViewOfDocuments(e,o,l))).next((()=>o))})).then((e=>(r.us=i,e)))}(r.localStore,t);t.targetChanges.forEach(((e,t)=>{const n=r.Ba.get(t);n&&(qA(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.Fa=!0:e.modifiedDocuments.size>0?qA(n.Fa):e.removedDocuments.size>0&&(qA(n.Fa),n.Fa=!1))})),await kO(r,e,t)}catch(e){await _M(e)}}function bO(e,t,r){const n=XA(e);if(n.isPrimaryClient&&0===r||!n.isPrimaryClient&&1===r){const e=[];n.xa.forEach(((r,n)=>{const i=n.view.ea(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const r=XA(e);r.onlineState=t;let n=!1;r.queries.forEach(((e,r)=>{for(const i of r.J_)i.ea(t)&&(n=!0)})),n&&rO(r)}(n.eventManager,t),e.length&&n.Ma.R_(e),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function wO(e,t,r){const n=XA(e);n.sharedClientState.updateQueryState(t,"rejected",r);const i=n.Ba.get(t),s=i&&i.key;if(s){let e=new UM(mM.comparator);e=e.insert(s,CT.newNoDocument(s,uM.min()));const r=EP().add(s),i=new wk(uM.min(),new Map,new UM(oM),e,r);await yO(n,i),n.La=n.La.remove(s),n.Ba.delete(t),PO(n)}else await XD(n.localStore,t,!1).then((()=>EO(n,t,r))).catch(_M)}async function xO(e,t){const r=XA(e),n=t.batch.batchId;try{const e=await function(e,t){const r=XA(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const n=t.batch.keys(),i=r.hs.newChangeBuffer({trackRemovals:!0});return function(e,t,r,n){const i=r.batch,s=i.keys();let a=CM.resolve();return s.forEach((e=>{a=a.next((()=>n.getEntry(t,e))).next((t=>{const s=r.docVersions.get(e);qA(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,r),t.isValidDocument()&&(t.setReadTime(r.commitVersion),n.addEntry(t)))}))})),a.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(r,e,t,i).next((()=>i.apply(e))).next((()=>r.mutationQueue.performConsistencyCheck(e))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(e,n,t.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=EP();for(let r=0;r<e.mutationResults.length;++r)e.mutationResults[r].transformResults.length>0&&(t=t.add(e.batch.mutations[r].key));return t}(t)))).next((()=>r.localDocuments.getDocuments(e,n)))}))}(r.localStore,t);CO(r,n,null),_O(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await kO(r,e)}catch(e){await _M(e)}}async function SO(e,t,r){const n=XA(e);try{const e=await function(e,t){const r=XA(e);return r.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let n;return r.mutationQueue.lookupMutationBatch(e,t).next((t=>(qA(null!==t),n=t.keys(),r.mutationQueue.removeMutationBatch(e,t)))).next((()=>r.mutationQueue.performConsistencyCheck(e))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(e,n,t))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,n))).next((()=>r.localDocuments.getDocuments(e,n)))}))}(n.localStore,t);CO(n,t,r),_O(n,t),n.sharedClientState.updateMutationState(t,"rejected",r),await kO(n,e)}catch(r){await _M(r)}}function _O(e,t){(e.Qa.get(t)||[]).forEach((e=>{e.resolve()})),e.Qa.delete(t)}function CO(e,t,r){const n=XA(e);let i=n.qa[n.currentUser.toKey()];if(i){const e=i.get(t);e&&(r?e.reject(r):e.resolve(),i=i.remove(t)),n.qa[n.currentUser.toKey()]=i}}function EO(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const n of e.Oa.get(t))e.xa.delete(n),r&&e.Ma.Wa(n,r);e.Oa.delete(t),e.isPrimaryClient&&e.ka.yr(t).forEach((t=>{e.ka.containsKey(t)||AO(e,t)}))}function AO(e,t){e.Na.delete(t.path.canonicalString());const r=e.La.get(t);null!==r&&(yI(e.remoteStore,r),e.La=e.La.remove(t),e.Ba.delete(r),PO(e))}function MO(e,t,r){for(const n of r)n instanceof aO?(e.ka.addReference(n.key,t),TO(e,n)):n instanceof oO?(UA("SyncEngine","Document no longer in limbo: "+n.key),e.ka.removeReference(n.key,t),e.ka.containsKey(n.key)||AO(e,n.key)):GA()}function TO(e,t){const r=t.key,n=r.path.canonicalString();e.La.get(r)||e.Na.has(n)||(UA("SyncEngine","New document in limbo: "+r),e.Na.add(n),PO(e))}function PO(e){for(;e.Na.size>0&&e.La.size<e.maxConcurrentLimboResolutions;){const t=e.Na.values().next().value;e.Na.delete(t);const r=new mM(dM.fromString(t)),n=e.Ka.next();e.Ba.set(n,new uO(r)),e.La=e.La.insert(r,n),vI(e.remoteStore,new oD(iP(eP(r.path)),n,"TargetPurposeLimboResolution",MM.oe))}}async function kO(e,t,r){const n=XA(e),i=[],s=[],a=[];n.xa.isEmpty()||(n.xa.forEach(((e,o)=>{a.push(n.Ua(o,t,r).then((e=>{var t;if((e||r)&&n.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==r?void 0:r.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;n.sharedClientState.updateQueryState(o.targetId,i?"current":"not-current")}if(e){i.push(e);const t=BD.zi(o.targetId,e);s.push(t)}})))})),await Promise.all(a),n.Ma.R_(i),await async function(e,t){const r=XA(e);try{await r.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>CM.forEach(t,(t=>CM.forEach(t.Wi,(n=>r.persistence.referenceDelegate.addReference(e,t.targetId,n))).next((()=>CM.forEach(t.Gi,(n=>r.persistence.referenceDelegate.removeReference(e,t.targetId,n)))))))))}catch(e){if(!AM(e))throw e;UA("LocalStore","Failed to update sequence numbers: "+e)}for(const n of t){const e=n.targetId;if(!n.fromCache){const t=r.us.get(e),n=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(n);r.us=r.us.insert(e,i)}}}(n.localStore,s))}async function DO(e,t){const r=XA(e);if(!r.currentUser.isEqual(t)){UA("SyncEngine","User change. New user:",t.toKey());const e=await VD(r.localStore,t);r.currentUser=t,function(e,t){e.Qa.forEach((e=>{e.forEach((e=>{e.reject(new KA(YA.CANCELLED,t))}))})),e.Qa.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await kO(r,e.Ts)}}function IO(e,t){const r=XA(e),n=r.Ba.get(t);if(n&&n.Fa)return EP().add(n.key);{let e=EP();const n=r.Oa.get(t);if(!n)return e;for(const t of n){const n=r.xa.get(t);e=e.unionWith(n.view.fa)}return e}}function OO(e){const t=XA(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=yO.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=IO.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=wO.bind(null,t),t.Ma.R_=eO.bind(null,t.eventManager),t.Ma.Wa=tO.bind(null,t.eventManager),t}function RO(e){const t=XA(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=xO.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=SO.bind(null,t),t}class LO{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=oI(e.databaseInfo.databaseId),this.sharedClientState=this.za(e),this.persistence=this.ja(e),await this.persistence.start(),this.localStore=this.Ha(e),this.gcScheduler=this.Ja(e,this.localStore),this.indexBackfillerScheduler=this.Ya(e,this.localStore)}Ja(e,t){return null}Ya(e,t){return null}Ha(e){return UD(this.persistence,new FD,e.initialUser,this.serializer)}ja(e){return new OD(LD.ei,this.serializer)}za(e){return new ZD}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}LO.provider={build:()=>new LO};class NO extends LO{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,t){qA(this.persistence.referenceDelegate instanceof ND);const r=this.persistence.referenceDelegate.garbageCollector;return new yD(r,e.asyncQueue,t)}ja(e){const t=void 0!==this.cacheSizeBytes?pD.withCacheSize(this.cacheSizeBytes):pD.DEFAULT;return new OD((e=>ND.ei(e,t)),this.serializer)}}class BO{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>bO(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=DO.bind(null,this.syncEngine),await UI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new QI}createDatastore(e){const t=oI(e.databaseInfo.databaseId),r=function(e){return new sI(e)}(e.databaseInfo);return function(e,t,r,n){return new dI(e,t,r,n)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(e,t,r,n,i){return new pI(e,t,r,n,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>bO(this.syncEngine,e,0)),$D.p()?new $D:new JD)}createSyncEngine(e,t){return function(e,t,r,n,i,s,a){const o=new hO(e,t,r,n,i,s);return a&&(o.$a=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=XA(e);UA("RemoteStore","RemoteStore shutting down."),t.k_.add(5),await gI(t),t.Q_.shutdown(),t.K_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}BO.provider={build:()=>new BO};class zO{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):VA("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class FO{constructor(e,t,r,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=n,this.user=BA.UNAUTHENTICATED,this.clientId=aM.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async e=>{UA("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(r,(e=>(UA("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new QA;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=GI(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function jO(e,t){e.asyncQueue.verifyOperationInProgress(),UA("FirestoreClient","Initializing OfflineComponentProvider");const r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener((async e=>{n.isEqual(e)||(await VD(t.localStore,e),n=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function UO(e,t){e.asyncQueue.verifyOperationInProgress();const r=await VO(e);UA("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener((e=>jI(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,r)=>jI(t.remoteStore,r))),e._onlineComponents=t}async function VO(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){UA("FirestoreClient","Using user provided OfflineComponentProvider");try{await jO(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!function(e){return"FirebaseError"===e.name?e.code===YA.FAILED_PRECONDITION||e.code===YA.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(r))throw r;HA("Error using user provided cache. Falling back to memory cache: "+r),await jO(e,new LO)}}else UA("FirestoreClient","Using default OfflineComponentProvider"),await jO(e,new NO(void 0));return e._offlineComponents}async function HO(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(UA("FirestoreClient","Using user provided OnlineComponentProvider"),await UO(e,e._uninitializedComponentsProvider._online)):(UA("FirestoreClient","Using default OnlineComponentProvider"),await UO(e,new BO))),e._onlineComponents}function WO(e){return HO(e).then((e=>e.syncEngine))}async function GO(e){const t=await HO(e),r=t.eventManager;return r.onListen=dO.bind(null,t.syncEngine),r.onUnlisten=gO.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=fO.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=vO.bind(null,t.syncEngine),r}function qO(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=new QA;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,r,n,i){const s=new zO({next:r=>{s.eu(),t.enqueueAndForget((()=>$I(e,a))),r.fromCache&&"server"===n.source?i.reject(new KA(YA.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(r)},error:e=>i.reject(e)}),a=new sO(r,s,{includeMetadataChanges:!0,ua:!0});return JI(e,a)}(await GO(e),e.asyncQueue,t,r,n))),n.promise}function XO(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const YO=new Map;function KO(e,t,r){if(!r)throw new KA(YA.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function QO(e){if(!mM.isDocumentKey(e))throw new KA(YA.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function ZO(e){if(mM.isDocumentKey(e))throw new KA(YA.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function JO(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":GA()}function $O(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new KA(YA.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=JO(e);throw new KA(YA.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(r))}}return e}class eR{constructor(e){var t,r;if(void 0===e.host){if(void 0!==e.ssl)throw new KA(YA.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new KA(YA.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,r,n){if(!0===t&&!0===n)throw new KA(YA.INVALID_ARGUMENT,"".concat(e," and ").concat(r," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=XO(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new KA(YA.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new KA(YA.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new KA(YA.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class tR{constructor(e,t,r,n){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new eR({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new KA(YA.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new KA(YA.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new eR(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new JA;switch(e.type){case"firstParty":return new rM(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new KA(YA.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=YO.get(e);t&&(UA("ComponentProvider","Removing Datastore"),YO.delete(e),t.terminate())}(this),Promise.resolve()}}function rR(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const s=(e=$O(e,tR))._getSettings(),a="".concat(t,":").concat(r);if("firestore.googleapis.com"!==s.host&&s.host!==a&&HA("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let t,r;if("string"==typeof n.mockUserToken)t=n.mockUserToken,r=BA.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=t||"demo-project",n=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:"https://securetoken.google.com/".concat(r),aud:r,iat:n,exp:n+3600,auth_time:n,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[RC(JSON.stringify({alg:"none",type:"JWT"})),RC(JSON.stringify(s)),""].join(".")}(n.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=n.mockUserToken.sub||n.mockUserToken.user_id;if(!s)throw new KA(YA.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");r=new BA(s)}e._authCredentials=new $A(new ZA(t,r))}}class nR{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new nR(this.firestore,e,this._query)}}class iR{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new sR(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new iR(this.firestore,e,this._key)}}class sR extends nR{constructor(e,t,r){super(e,t,eP(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new iR(this.firestore,null,new mM(e))}withConverter(e){return new sR(this.firestore,e,this._path)}}function aR(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];if(e=KC(e),KO("collection","path",t),e instanceof tR){const r=dM.fromString(t,...n);return ZO(r),new sR(e,null,r)}{if(!(e instanceof iR||e instanceof sR))throw new KA(YA.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(dM.fromString(t,...n));return ZO(r),new sR(e.firestore,null,r)}}function oR(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];if(e=KC(e),1===arguments.length&&(t=aM.newId()),KO("doc","path",t),e instanceof tR){const r=dM.fromString(t,...n);return QO(r),new iR(e,null,new mM(r))}{if(!(e instanceof iR||e instanceof sR))throw new KA(YA.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(dM.fromString(t,...n));return QO(r),new iR(e.firestore,e instanceof sR?e.converter:null,new mM(r))}}class lR{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Iu=[],this.Eu=!1,this.du=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new lI(this,"async_queue_retry"),this.fu=()=>{const e=aI();e&&UA("AsyncQueue","Visibility state changed to "+e.visibilityState),this.r_.Jo()},this.gu=e;const t=aI();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.Eu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.Eu){this.Eu=!0,this.Vu=e||!1;const t=aI();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.Eu)return new Promise((()=>{}));const t=new QA;return this.yu((()=>this.Eu&&this.Vu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Iu.push(e),this.wu())))}async wu(){if(0!==this.Iu.length){try{await this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(n0){if(!AM(n0))throw n0;UA("AsyncQueue","Operation failed with retryable error: "+n0)}this.Iu.length>0&&this.r_.jo((()=>this.wu()))}}yu(e){const t=this.gu.then((()=>(this.Ru=!0,e().catch((e=>{this.Au=e,this.Ru=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw VA("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.Ru=!1,e))))));return this.gu=t,t}enqueueAfterDelay(e,t,r){this.pu(),this.mu.indexOf(e)>-1&&(t=0);const n=WI.createAndSchedule(this,e,t,r,(e=>this.Su(e)));return this.du.push(n),n}pu(){this.Au&&GA()}verifyOperationInProgress(){}async bu(){let e;do{e=this.gu,await e}while(e!==this.gu)}Du(e){for(const t of this.du)if(t.timerId===e)return!0;return!1}vu(e){return this.bu().then((()=>{this.du.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.du)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.bu()}))}Cu(e){this.mu.push(e)}Su(e){const t=this.du.indexOf(e);this.du.splice(t,1)}}class cR extends tR{constructor(e,t,r,n){super(e,t,r,n),this.type="firestore",this._queue=new lR,this._persistenceKey=(null==n?void 0:n.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new lR(e),this._firestoreClient=void 0,await e}}}function uR(e){if(e._terminated)throw new KA(YA.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||hR(e),e._firestoreClient}function hR(e){var t,r,n;const i=e._freezeSettings(),s=function(e,t,r,n){return new rT(e,t,r,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling,XO(n.experimentalLongPollingOptions),n.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(r=i.localCache)||void 0===r?void 0:r._offlineComponentProvider)&&(null===(n=i.localCache)||void 0===n?void 0:n._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new FO(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class dR{constructor(e){this._byteString=e}static fromBase64String(e){try{return new dR(YM.fromBase64String(e))}catch(e){throw new KA(YA.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new dR(YM.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class fR{constructor(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(let n=0;n<t.length;++n)if(0===t[n].length)throw new KA(YA.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pM(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class pR{constructor(e){this._methodName=e}}class mR{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new KA(YA.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new KA(YA.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return oM(this._lat,e._lat)||oM(this._long,e._long)}}class gR{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(this._values,e._values)}}const vR=/^__.*__$/;class yR{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new $P(e,this.data,this.fieldMask,t,this.fieldTransforms):new JP(e,this.data,t,this.fieldTransforms)}}class bR{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new $P(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function wR(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw GA()}}class xR{constructor(e,t,r,n,i,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=n,void 0===i&&this.Fu(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new xR(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),n=this.xu({path:r,Nu:!1});return n.Lu(e),n}Bu(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),n=this.xu({path:r,Nu:!1});return n.Fu(),n}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return LR(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Lu(this.path.get(e))}Lu(e){if(0===e.length)throw this.qu("Document fields must not be empty");if(wR(this.Mu)&&vR.test(e))throw this.qu('Document fields cannot begin and end with "__"')}}class SR{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||oI(e)}$u(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new xR({Mu:e,methodName:t,Ku:r,path:pM.emptyPath(),Nu:!1,Qu:n},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function _R(e){const t=e._freezeSettings(),r=oI(e._databaseId);return new SR(e._databaseId,!!t.ignoreUndefinedProperties,r)}function CR(e,t,r,n,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=e.$u(s.merge||s.mergeFields?2:0,t,r,i);DR("Data must be an object, but it was:",a,n);const o=PR(n,a);let l,c;if(s.merge)l=new qM(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const e=[];for(const n of s.mergeFields){const i=IR(t,n,r);if(!a.contains(i))throw new KA(YA.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));NR(e,i)||e.push(i)}l=new qM(e),c=a.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,c=a.fieldTransforms;return new yR(new ST(o),l,c)}class ER extends pR{_toFieldTransform(e){if(2!==e.Mu)throw 1===e.Mu?e.qu("".concat(this._methodName,"() can only appear at the top level of your update data")):e.qu("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ER}}function AR(e,t,r,n){const i=e.$u(1,t,r);DR("Data must be an object, but it was:",i,n);const s=[],a=ST.empty();FM(n,((e,n)=>{const o=RR(t,e,r);n=KC(n);const l=i.Bu(o);if(n instanceof ER)s.push(o);else{const e=TR(n,l);null!=e&&(s.push(o),a.set(o,e))}}));const o=new qM(s);return new bR(a,o,i.fieldTransforms)}function MR(e,t,r,n,i,s){const a=e.$u(1,t,r),o=[IR(t,n,r)],l=[i];if(s.length%2!=0)throw new KA(YA.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let d=0;d<s.length;d+=2)o.push(IR(t,s[d])),l.push(s[d+1]);const c=[],u=ST.empty();for(let d=o.length-1;d>=0;--d)if(!NR(c,o[d])){const e=o[d];let t=l[d];t=KC(t);const r=a.Bu(e);if(t instanceof ER)c.push(e);else{const n=TR(t,r);null!=n&&(c.push(e),u.set(e,n))}}const h=new qM(c);return new bR(u,h,a.fieldTransforms)}function TR(e,t){if(kR(e=KC(e)))return DR("Unsupported field value:",t,e),PR(e,t);if(e instanceof pR)return function(e,t){if(!wR(t.Mu))throw t.qu("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.qu("".concat(e._methodName,"() is not currently supported inside arrays"));const r=e._toFieldTransform(t);r&&t.fieldTransforms.push(r)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Nu&&4!==t.Mu)throw t.qu("Nested arrays are not supported");return function(e,t){const r=[];let n=0;for(const i of e){let e=TR(i,t.ku(n));null==e&&(e={nullValue:"NULL_VALUE"}),r.push(e),n++}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=KC(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return kP(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const r=cM.fromDate(e);return{timestampValue:Rk(t.serializer,r)}}if(e instanceof cM){const r=new cM(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Rk(t.serializer,r)}}if(e instanceof mR)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof dR)return{bytesValue:Lk(t.serializer,e._byteString)};if(e instanceof iR){const r=t.databaseId,n=e.firestore._databaseId;if(!n.isEqual(r))throw t.qu("Document reference is for database ".concat(n.projectId,"/").concat(n.database," but should be for database ").concat(r.projectId,"/").concat(r.database));return{referenceValue:zk(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof gR)return function(e,t){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.qu("VectorValues must only contain numeric values.");return TP(t.serializer,e)}))}}}}}}(e,t);throw t.qu("Unsupported field value: ".concat(JO(e)))}(e,t)}function PR(e,t){const r={};return jM(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):FM(e,((e,n)=>{const i=TR(n,t.Ou(e));null!=i&&(r[e]=i)})),{mapValue:{fields:r}}}function kR(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof cM||e instanceof mR||e instanceof dR||e instanceof iR||e instanceof pR||e instanceof gR)}function DR(e,t,r){if(!kR(r)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(r)){const n=JO(r);throw"an object"===n?t.qu(e+" a custom object"):t.qu(e+" "+n)}}function IR(e,t,r){if((t=KC(t))instanceof fR)return t._internalPath;if("string"==typeof t)return RR(e,t);throw LR("Field path arguments must be of type string or ",e,!1,void 0,r)}const OR=new RegExp("[~\\*/\\[\\]]");function RR(e,t,r){if(t.search(OR)>=0)throw LR("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,r);try{return new fR(...t.split("."))._internalPath}catch(ca){throw LR("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,r)}}function LR(e,t,r,n,i){const s=n&&!n.isEmpty(),a=void 0!==i;let o="Function ".concat(t,"() called with invalid data");r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=" in field ".concat(n)),a&&(l+=" in document ".concat(i)),l+=")"),new KA(YA.INVALID_ARGUMENT,o+e+l)}function NR(e,t){return e.some((e=>e.isEqual(t)))}class BR{constructor(e,t,r,n,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=n,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new iR(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new zR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(FR("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class zR extends BR{data(){return super.data()}}function FR(e,t){return"string"==typeof t?RR(e,t):t instanceof fR?t._internalPath:t._delegate._internalPath}function jR(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new KA(YA.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class UR{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(sT(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ZM(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(JM(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw GA()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const r={};return FM(e,((e,n)=>{r[e]=this.convertValue(n,t)})),r}convertVectorValue(e){var t,r,n;const i=null===(n=null===(r=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===r?void 0:r.values)||void 0===n?void 0:n.map((e=>ZM(e.doubleValue)));return new gR(i)}convertGeoPoint(e){return new mR(ZM(e.latitude),ZM(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=eT(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(tT(e));default:return null}}convertTimestamp(e){const t=QM(e);return new cM(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=dM.fromString(e);qA(aD(r));const n=new nT(r.get(1),r.get(3)),i=new mM(r.popFirst(5));return n.isEqual(t)||VA("Document ".concat(i," contains a document reference within a different database (").concat(n.projectId,"/").concat(n.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}function VR(e,t,r){let n;return n=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,n}class HR{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class WR extends BR{constructor(e,t,r,n,i,s){super(e,t,r,n,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new GR(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const r=this._document.data.field(FR("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class GR extends WR{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class qR{constructor(e,t,r,n){this._firestore=e,this._userDataWriter=t,this._snapshot=n,this.metadata=new HR(n.hasPendingWrites,n.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new GR(this._firestore,this._userDataWriter,r.key,r,new HR(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new KA(YA.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((r=>{const n=new GR(e._firestore,e._userDataWriter,r.doc.key,r.doc,new HR(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter);return r.doc,{type:"added",doc:n,oldIndex:-1,newIndex:t++}}))}{let r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const n=new GR(e._firestore,e._userDataWriter,t.doc.key,t.doc,new HR(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(r=r.add(t.doc),s=r.indexOf(t.doc.key)),{type:XR(t.type),doc:n,oldIndex:i,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function XR(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return GA()}}class YR extends UR{constructor(e){super(),this.firestore=e}convertBytes(e){return new dR(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new iR(this.firestore,null,t)}}function KR(e){e=$O(e,nR);const t=$O(e.firestore,cR),r=uR(t),n=new YR(t);return jR(e._query),qO(r,e._query).then((r=>new qR(t,n,e,r)))}function QR(e,t){return function(e,t){const r=new QA;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,r){const n=RO(e);try{const e=await function(e,t){const r=XA(e),n=cM.now(),i=t.reduce(((e,t)=>e.add(t.key)),EP());let s,a;return r.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let o=gP(),l=EP();return r.hs.getEntries(e,i).next((e=>{o=e,o.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>r.localDocuments.getOverlayedDocuments(e,o))).next((i=>{s=i;const a=[];for(const e of t){const t=QP(e,s.get(e.key).overlayedDocument);null!=t&&a.push(new $P(e.key,t,_T(t.value.mapValue),WP.exists(!0)))}return r.mutationQueue.addMutationBatch(e,n,a,t)})).next((t=>{a=t;const n=t.applyToLocalDocumentSet(s,l);return r.documentOverlayCache.saveOverlays(e,t.batchId,n)}))})).then((()=>({batchId:a.batchId,changes:bP(s)})))}(n.localStore,t);n.sharedClientState.addPendingMutation(e.batchId),function(e,t,r){let n=e.qa[e.currentUser.toKey()];n||(n=new UM(oM)),n=n.insert(t,r),e.qa[e.currentUser.toKey()]=n}(n,e.batchId,r),await kO(n,e.changes),await DI(n.remoteStore)}catch(e){const t=GI(e,"Failed to persist write");r.reject(t)}}(await WO(e),t,r))),r.promise}(uR(e),t)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){zA=e}("11.1.0"),aA(new QC("firestore",((e,r)=>{let{instanceIdentifier:n,options:i}=r;const s=e.getProvider("app").getImmediate(),a=new cR(new eM(e.getProvider("auth-internal")),new iM(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new KA(YA.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new nT(e.options.projectId,t)}(s,n),s);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a}),"PUBLIC").setMultipleInstances(!0)),hA(NA,"4.7.5",e),hA(NA,"4.7.5","esm2017")}();hA("firebase","11.1.0","app");const ZR=function(e,t){const r="object"==typeof e?e:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:eA;const t=rA.get(e);if(!t&&e===eA&&FC())return uA();if(!t)throw lA.create("no-app",{appName:e});return t}(),n="string"==typeof e?e:t||"(default)",i=oA(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const e=zC("firestore");e&&rR(i,...e)}return i}(uA({apiKey:"AIzaSyAs6mecL9Hh9cJRKBzrY275odNyQR7hYYo",authDomain:"kabinari.firebaseapp.com",projectId:"kabinari",storageBucket:"kabinari.firebasestorage.app",messagingSenderId:"418173211258",appId:"1:418173211258:web:205d407e1bf57ef08f21c3"})),JR=async(e,t,r,n,i,s)=>{try{const s=aR(ZR,"Veriler");await function(e,t){const r=$O(e.firestore,cR),n=oR(e),i=VR(e.converter,t);return QR(r,[CR(_R(e.firestore),"addDoc",n._key,i,null!==e.converter,{}).toMutation(n._key,WP.exists(!1))]).then((()=>n))}(s,{data:e,musteriIsmi:t,olusturmaTarihi:r,"isNumaras\u0131":n}),i()}catch(a){console.error("Error adding new order: ",a),s()}},$R=async(e,t,r,n,i,s,a)=>{try{const s=oR(ZR,"Veriler",a);await function(e,t,r){e=$O(e,iR);const n=$O(e.firestore,cR),i=_R(n);let s;for(var a=arguments.length,o=new Array(a>3?a-3:0),l=3;l<a;l++)o[l-3]=arguments[l];return s="string"==typeof(t=KC(t))||t instanceof fR?MR(i,"updateDoc",e._key,t,r,o):AR(i,"updateDoc",e._key,t),QR(n,[s.toMutation(e._key,WP.exists(!0))])}(s,{data:e,musteriIsmi:t,olusturmaTarihi:r,"isNumaras\u0131":n}),i()}catch(o){console.error("Error updating order: ",o),s()}},eL=t=>{let{"m\xfcsteriIsmi":r,data:n,olusturmaTarihi:i,"isNumaras\u0131":s,databaseId:a}=t;const{control:o,handleSubmit:l,getValues:c,setValue:h,reset:d}=y_(),[f,p]=(0,e.useState)([{id:0}]),m=()=>gC.success("Buluta Y\xfcklendi",{position:"top-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored",transition:CC}),g=()=>gC.error("Buluta Y\xfcklenirken Bir Hata Olu\u015ftu",{position:"top-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored",transition:CC});(0,e.useEffect)((()=>{n&&p((e=>{const t=[...e];for(let r=1;r<n.length;r++)t.push({id:r});return t}))}),[]);return(0,bt.jsxs)(La,{component:"form",onSubmit:l((e=>{const t=f.map((t=>{const r={};return Object.keys(e).forEach((n=>{if(n.includes("-".concat(t.id))){const i=n.replace("-".concat(t.id),"");r[i]=e[n]}})),r}));kC(t,r)})),sx:{padding:2,marginTop:2},children:[(0,bt.jsx)(AC,{position:"top-center",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!1,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"colored",transition:CC}),(0,bt.jsx)(La,{sx:{display:"flex",gap:1,marginBottom:1},children:["Kat","Tip","Mahal No","Mahal","En","Boy","D.K.","Y\xf6n","Kanat","Kasa","Barel","Kilit","Cumba","Kol","Tekmelik","\u0130tmelik","Menfez","Hidrolik","Lumboz","Yang\u0131na D."].map(((e,t)=>(0,bt.jsx)(La,{sx:{width:t>=14?"2.6rem":"8%",paddingLeft:t>=14?"0":".5rem",fontWeight:"bold",textAlign:"start",fontSize:"14px",display:"flex",alignItems:"center",justifyContent:"flex-start",transform:t>=14?"rotate(-60deg) translateX(.5rem) translateY(-.1rem)":"none",whiteSpace:"nowrap"},children:e},t)))}),f.map((e=>{var t,r,i,s,a,l,c,h,d,f,p,m,g,v,y,b,w,x,S,_;return(0,bt.jsxs)(La,{sx:{display:"flex",gap:1,marginBottom:1},children:[(0,bt.jsx)(LS,{name:"kat-".concat(e.id),control:o,defaultValue:n&&null!==(t=n[e.id])&&void 0!==t&&t.kat?n[e.id].kat:"",render:e=>{let{field:t}=e;return(0,bt.jsx)(Uh,u(u({},t),{},{label:"Kat",size:"small",sx:{width:"8%"},inputProps:{autoComplete:"off"}}))}}),(0,bt.jsx)(LS,{name:"tip-".concat(e.id),control:o,defaultValue:n&&null!==(r=n[e.id])&&void 0!==r&&r.tip?n[e.id].tip:"",render:e=>{let{field:t}=e;return(0,bt.jsx)(Uh,u(u({},t),{},{label:"Tip",size:"small",sx:{width:"8%"},inputProps:{autoComplete:"off"}}))}}),(0,bt.jsx)(LS,{name:"mahalNo-".concat(e.id),control:o,defaultValue:n&&null!==(i=n[e.id])&&void 0!==i&&i.mahalNo?n[e.id].mahalNo:"",render:e=>{let{field:t}=e;return(0,bt.jsx)(Uh,u(u({},t),{},{label:"Mahal No",size:"small",sx:{width:"8%"},inputProps:{autoComplete:"off"}}))}}),(0,bt.jsx)(LS,{name:"mahal-".concat(e.id),control:o,defaultValue:n&&null!==(s=n[e.id])&&void 0!==s&&s.mahal?n[e.id].mahal:"",render:e=>{let{field:t}=e;return(0,bt.jsx)(Uh,u(u({},t),{},{label:"Mahal",size:"small",sx:{width:"8%"},inputProps:{autoComplete:"off"}}))}}),(0,bt.jsx)(LS,{name:"en-".concat(e.id),control:o,defaultValue:n&&null!==(a=n[e.id])&&void 0!==a&&a.en?n[e.id].en:"",render:e=>{let{field:t}=e;return(0,bt.jsx)(Uh,u(u({},t),{},{label:"En",size:"small",sx:{width:"8%"},inputProps:{autoComplete:"off"}}))}}),(0,bt.jsx)(LS,{name:"boy-".concat(e.id),control:o,defaultValue:n&&null!==(l=n[e.id])&&void 0!==l&&l.boy?n[e.id].boy:"",render:e=>{let{field:t}=e;return(0,bt.jsx)(Uh,u(u({},t),{},{label:"Boy",size:"small",sx:{width:"8%"},inputProps:{autoComplete:"off"}}))}}),(0,bt.jsx)(LS,{name:"duvarKalinligi-".concat(e.id),control:o,defaultValue:n&&null!==(c=n[e.id])&&void 0!==c&&c.duvarKalinligi?n[e.id].duvarKalinligi:"",render:e=>{let{field:t}=e;return(0,bt.jsx)(Uh,u(u({},t),{},{label:"D.K.",size:"small",sx:{width:"8%"},inputProps:{autoComplete:"off"}}))}}),(0,bt.jsx)(LS,{name:"yon-".concat(e.id),control:o,defaultValue:n&&null!==(h=n[e.id])&&void 0!==h&&h.yon?n[e.id].yon:"",render:e=>{let{field:t}=e;return(0,bt.jsxs)(Fl,{size:"small",sx:{width:"8%"},children:[(0,bt.jsx)(Ol,{children:"Y\xf6n"}),(0,bt.jsxs)(Lh,u(u({},t),{},{label:"Y\xf6n",children:[(0,bt.jsx)(kx,{value:"sa\u011f",children:"Sa\u011f"}),(0,bt.jsx)(kx,{value:"sol",children:"Sol"}),(0,bt.jsx)(kx,{value:"d\u0131\u015far\u0131-sa\u011f",children:"D. Sa\u011f"}),(0,bt.jsx)(kx,{value:"d\u0131\u015far\u0131-sol",children:"D. Sol"})]}))]})}}),(0,bt.jsx)(LS,{name:"kanat-".concat(e.id),control:o,defaultValue:n&&null!==(d=n[e.id])&&void 0!==d&&d.kanat?n[e.id].kanat:"",render:e=>{let{field:t}=e;return(0,bt.jsx)(Uh,u(u({},t),{},{label:"Kanat",size:"small",sx:{width:"8%"},inputProps:{autoComplete:"off"}}))}}),(0,bt.jsx)(LS,{name:"kasa-".concat(e.id),control:o,defaultValue:n&&null!==(f=n[e.id])&&void 0!==f&&f.kasa?n[e.id].kasa:"",render:e=>{let{field:t}=e;return(0,bt.jsx)(Uh,u(u({},t),{},{label:"Kasa",size:"small",sx:{width:"8%"},inputProps:{autoComplete:"off"}}))}}),(0,bt.jsx)(LS,{name:"barel-".concat(e.id),control:o,defaultValue:n&&null!==(p=n[e.id])&&void 0!==p&&p.barel?n[e.id].barel:"",render:e=>{let{field:t}=e;return(0,bt.jsxs)(Fl,{size:"small",sx:{width:"8%"},children:[(0,bt.jsx)(Ol,{children:"Barel"}),(0,bt.jsxs)(Lh,u(u({},t),{},{label:"Barel",children:[(0,bt.jsx)(kx,{value:"?1",children:"?1"}),(0,bt.jsx)(kx,{value:"?2",children:"?2"}),(0,bt.jsx)(kx,{value:"?3",children:"?3"})]}))]})}}),(0,bt.jsx)(LS,{name:"kilit-".concat(e.id),control:o,defaultValue:n&&null!==(m=n[e.id])&&void 0!==m&&m.kilit?n[e.id].kilit:"",render:e=>{let{field:t}=e;return(0,bt.jsx)(Uh,u(u({},t),{},{label:"Kilit",size:"small",sx:{width:"8%"},inputProps:{autoComplete:"off"}}))}}),(0,bt.jsx)(LS,{name:"cumba-".concat(e.id),control:o,defaultValue:n&&null!==(g=n[e.id])&&void 0!==g&&g.cumba?n[e.id].cumba:"",render:e=>{let{field:t}=e;return(0,bt.jsxs)(Fl,{size:"small",sx:{width:"8%"},children:[(0,bt.jsx)(Ol,{children:"Cumba"}),(0,bt.jsxs)(Lh,u(u({},t),{},{label:"Cumba",children:[(0,bt.jsx)(kx,{value:"pvc",children:"PVC"}),(0,bt.jsx)(kx,{value:"u",children:"U"})]}))]})}}),(0,bt.jsx)(LS,{name:"kol-".concat(e.id),control:o,defaultValue:n&&null!==(v=n[e.id])&&void 0!==v&&v.kol?n[e.id].kol:"",render:e=>{let{field:t}=e;return(0,bt.jsxs)(Fl,{size:"small",sx:{width:"8%"},children:[(0,bt.jsx)(Ol,{children:"Kol"}),(0,bt.jsxs)(Lh,u(u({},t),{},{label:"Kol",children:[(0,bt.jsx)(kx,{value:"baston",children:"Baston"}),(0,bt.jsx)(kx,{value:"boru",children:"Boru"})]}))]})}}),(0,bt.jsx)(LS,{name:"tekmelik-".concat(e.id),control:o,defaultValue:!(!n||null===(y=n[e.id])||void 0===y||!y.tekmelik)&&n[e.id].tekmelik,render:e=>{let{field:t}=e;return(0,bt.jsx)(N_,u(u({},t),{},{checked:t.value}))}}),(0,bt.jsx)(LS,{name:"itmelik-".concat(e.id),control:o,defaultValue:!(!n||null===(b=n[e.id])||void 0===b||!b.itmelik)&&n[e.id].itmelik,render:e=>{let{field:t}=e;return(0,bt.jsx)(N_,u(u({},t),{},{checked:t.value}))}}),(0,bt.jsx)(LS,{name:"menfez-".concat(e.id),control:o,defaultValue:!(!n||null===(w=n[e.id])||void 0===w||!w.menfez)&&n[e.id].menfez,render:e=>{let{field:t}=e;return(0,bt.jsx)(N_,u(u({},t),{},{checked:t.value}))}}),(0,bt.jsx)(LS,{name:"hidrolik-".concat(e.id),control:o,defaultValue:!(!n||null===(x=n[e.id])||void 0===x||!x.hidrolik)&&n[e.id].hidrolik,render:e=>{let{field:t}=e;return(0,bt.jsx)(N_,u(u({},t),{},{checked:t.value}))}}),(0,bt.jsx)(LS,{name:"lumboz-".concat(e.id),control:o,defaultValue:!(!n||null===(S=n[e.id])||void 0===S||!S.lumboz)&&n[e.id].lumboz,render:e=>{let{field:t}=e;return(0,bt.jsx)(N_,u(u({},t),{},{checked:t.value}))}}),(0,bt.jsx)(LS,{name:"yang\u0131naD-".concat(e.id),control:o,defaultValue:!(!n||null===(_=n[e.id])||void 0===_||!_.yang\u0131naD)&&n[e.id].yang\u0131naD,render:e=>{let{field:t}=e;return(0,bt.jsx)(N_,u(u({},t),{},{checked:t.value}))}})]},e.id)})),(0,bt.jsxs)(La,{sx:{display:"flex",gap:2,marginTop:2,justifyContent:"flex-end"},children:[(0,bt.jsx)(Rg,{variant:"contained",onClick:l((e=>{if(0===f.length)return;const t=f[f.length-1].id,r=Object.keys(e).filter((e=>!e.endsWith("-".concat(t)))).reduce(((t,r)=>(t[r]=e[r],t)),{});d(r),p(f.slice(0,-1)),n.pop()})),startIcon:(0,bt.jsx)(U_,{}),sx:{backgroundColor:"#c20000","&:hover":{backgroundColor:"#9f0000"}},children:"Son Sat\u0131r\u0131 Sil"}),(0,bt.jsx)(Rg,{variant:"contained",onClick:()=>{const e={id:f.length};p([...f,e])},startIcon:(0,bt.jsx)(B_,{}),sx:{backgroundColor:"#4CAF50","&:hover":{backgroundColor:"#45a049"}},children:"Yeni Sat\u0131r Ekle"}),(0,bt.jsx)(Rg,{variant:"contained",onClick:()=>{if(0===f.length)return;const e=f[f.length-1].id,t=c(),r={id:f.length};p([...f,r]),setTimeout((()=>{Object.keys(t).forEach((n=>{if(n.includes("-".concat(e))){const i=n.replace("-".concat(e),"-".concat(r.id));h(i,t[n])}}))}),0)},startIcon:(0,bt.jsx)(z_,{}),sx:{backgroundColor:"#2196F3","&:hover":{backgroundColor:"#1e88e5"}},children:"Son Sat\u0131r\u0131 Kopyala"}),(0,bt.jsx)(Rg,{variant:"contained",startIcon:(0,bt.jsx)(F_,{}),onClick:l((e=>{const t=f.map((t=>{const r={};return Object.keys(e).forEach((n=>{if(n.includes("-".concat(t.id))){const i=n.replace("-".concat(t.id),"");r[i]=e[n]}})),r}));n?$R(t,r,i,s,m,g,a):JR(t,r,$h()(i).format("DD/MM/YYYY"),s,m,g)})),sx:{backgroundColor:"#dad726","&:hover":{backgroundColor:"#cac727"}},children:n?"BULUTU G\xdcNCELLE":"BULUTA Y\xdcKLE"}),(0,bt.jsx)(Rg,{variant:"contained",type:"submit",startIcon:(0,bt.jsx)(j_,{}),sx:{backgroundColor:"#FF5722","&:hover":{backgroundColor:"#e64a19"}},children:"KAYDET"})]})]})},tL=r.p+"static/media/cool-background2.cb9021bb1ff804471906.png",rL=()=>{const[t,r]=(0,e.useState)(!1),[n,i]=(0,e.useState)(!1),[s,a]=(0,e.useState)(""),[o,l]=(0,e.useState)(""),[c,u]=(0,e.useState)(""),h=Zn({palette:{mode:t?"dark":"light",primary:{main:t?"#BB86FC":"#1976D2"},secondary:{main:"#0c9d0c"}}}),[d,f]=e.useState(!1),p=e=>()=>{f(e)},[m,g]=(0,e.useState)([]),[v,y]=(0,e.useState)([(0,bt.jsx)(Vx,{id:0,onChange:(e,t)=>{g((r=>{const n=[...r];return n[e]=t,n}))}},0)]);return(0,bt.jsx)(la,{theme:h,children:(0,bt.jsxs)(La,{sx:{width:"100%",height:"100vh"},children:[(0,bt.jsx)(Ex,{toggleDrawer:p}),(0,bt.jsx)(dx,{open:d,toggleDrawer:p}),(0,bt.jsxs)(La,{sx:{backgroundColor:"#DEDDDB",width:"100%",minHeight:"90vh"},children:[(0,bt.jsx)(La,{sx:{display:"flex",padding:"10px"},children:(0,bt.jsx)(go,{color:"#A19D95",fontSize:32,fontFamily:"unset",marginLeft:"30px",marginY:"10px",children:"Yeni Proje"})}),(0,bt.jsxs)(La,{sx:{border:"1px solid #FFFFFF",bgcolor:"#FFFFFF",borderRadius:"20px",marginX:"20px",boxShadow:"rgba(50, 50, 93, 0.25) 0px 30px 60px -12px, rgba(0, 0, 0, 0.3) 0px 18px 36px -18px"},children:[(0,bt.jsxs)(La,{sx:{display:"flex",alignItems:"center",flexDirection:"row",margin:"30px",justifyContent:"space-between"},children:[(0,bt.jsxs)(La,{sx:{display:"flex",flexDirection:"row"},children:[(0,bt.jsx)(Kh,{sx:{fontSize:"36px",color:"#A19D95"}}),(0,bt.jsx)(go,{color:"#A19D95",fontSize:24,display:"flex",alignItems:"center",marginX:"10px",children:"M\xfc\u015fteri \u0130smi"})]}),(0,bt.jsx)(Uh,{sx:{width:"60%"},id:"outlined-basic",variant:"outlined",size:"small",inputProps:{autoComplete:"off"},value:s,onChange:e=>{a(e.target.value)}}),(0,bt.jsx)(La,{height:"50px",width:"95px"})]}),(0,bt.jsx)(Yh,{sx:{borderBottomWidth:3,backgroundColor:"#DEDDDB"}}),(0,bt.jsxs)(La,{sx:{display:"flex",flexDirection:"row",margin:"30px",justifyContent:"space-between"},children:[(0,bt.jsxs)(La,{sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,bt.jsx)(Qh,{sx:{fontSize:"36px",color:"#A19D95"}}),(0,bt.jsx)(go,{color:"#A19D95",fontSize:24,display:"flex",alignItems:"center",marginX:"10px",children:"\u0130\u015f Numaras\u0131"})]}),(0,bt.jsx)(Uh,{sx:{width:"60%"},id:"outlined-basic",variant:"outlined",size:"small",inputProps:{autoComplete:"off"},value:o,onChange:e=>{l(e.target.value)}}),(0,bt.jsx)(La,{height:"50px",width:"95px"})]}),(0,bt.jsxs)(La,{sx:{display:"flex",flexDirection:"row",margin:"30px",justifyContent:"space-between"},children:[(0,bt.jsxs)(La,{sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,bt.jsx)(Zh,{sx:{fontSize:"36px",color:"#A19D95"}}),(0,bt.jsx)(go,{color:"#A19D95",fontSize:24,display:"flex",alignItems:"center",marginX:"10px",children:"Olu\u015fturma Tarihi"})]}),(0,bt.jsx)(bd,{dateAdapter:pd,children:(0,bt.jsx)(Rw,{format:"DD/MM/YYYY",sx:{width:"60%"},slotProps:{textField:{size:"small"}},onChange:e=>u(e)})}),(0,bt.jsx)(La,{height:"50px",width:"140px"})]}),(0,bt.jsx)(Yh,{sx:{borderBottomWidth:3,backgroundColor:"#DEDDDB"}}),(0,bt.jsx)(La,{sx:{width:"100%"},children:(0,bt.jsx)(eL,{"m\xfcsteriIsmi":s,olusturmaTarihi:c,"isNumaras\u0131":o})})]})]})]})})},nL=()=>{const[t,r]=(0,e.useState)();return(0,bt.jsxs)(La,{sx:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"20px"},children:[(0,bt.jsx)(Uh,{sx:{width:"20%"},id:"outlined-basic",variant:"outlined",size:"small",value:t,onChange:e=>{r(e.target.value)}}),(0,bt.jsx)(Rg,{sx:{backgroundColor:"#665B59",width:"10%"},variant:"contained",onClick:()=>{console.log("Button clicked!"),console.log("ahmet")},children:"Veri G\xf6ndersss"})]})};function iL(){iL=function(e,t){return new r(e,void 0,t)};var e=RegExp.prototype,t=new WeakMap;function r(e,n,i){var s=RegExp(e,n);return t.set(s,i||t.get(e)),_c(s,r.prototype)}function n(e,r){var n=t.get(r);return Object.keys(n).reduce((function(t,r){var i=n[r];if("number"==typeof i)t[r]=e[i];else{for(var s=0;void 0===e[i[s]]&&s+1<i.length;)s++;t[r]=e[i[s]]}return t}),Object.create(null))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_c(e,t)}(r,RegExp),r.prototype.exec=function(t){var r=e.exec.call(this,t);if(r){r.groups=n(r,this);var i=r.indices;i&&(i.groups=n(i,this))}return r},r.prototype[Symbol.replace]=function(r,i){if("string"==typeof i){var s=t.get(this);return e[Symbol.replace].call(this,r,i.replace(/\$<([^>]+)>/g,(function(e,t){var r=s[t];return"$"+(Array.isArray(r)?r.join("$"):r)})))}if("function"==typeof i){var o=this;return e[Symbol.replace].call(this,r,(function(){var e=arguments;return"object"!=a(e[e.length-1])&&(e=[].slice.call(e)).push(n(e,o)),i.apply(this,e)}))}return e[Symbol.replace].call(this,r,i)},iL.apply(this,arguments)}const sL=["texture"],aL=["texture"],oL=["name"],lL=["material"],cL=["enabled"],uL=["name"];var hL=Object.create,dL=Object.defineProperty,fL=Object.getOwnPropertyDescriptor,pL=Object.getOwnPropertyNames,mL=Object.getPrototypeOf,gL=Object.prototype.hasOwnProperty,vL=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),yL=(e,t,r)=>(r=null!=e?hL(mL(e)):{},((e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let i of pL(t))!gL.call(e,i)&&i!==r&&dL(e,i,{get:()=>t[i],enumerable:!(n=fL(t,i))||n.enumerable});return e})(!t&&e&&e.__esModule?r:dL(r,"default",{value:e,enumerable:!0}),e)),bL=(e,t,r)=>(((e,t,r)=>{t in e?dL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),wL=vL(((e,t)=>{var r,n;r=e,n=function(){return e.importState=function(t){var r=new e;return r.importState(t),r},e;function e(){return function(e){var t=0,r=0,n=0,i=1;0==e.length&&(e=[+new Date]);var s=function(){var e=4022871197,t=function(t){t=t.toString();for(var r=0;r<t.length;r++){var n=.02519603282416938*(e+=t.charCodeAt(r));n-=e=n>>>0,e=(n*=e)>>>0,e+=4294967296*(n-=e)}return 2.3283064365386963e-10*(e>>>0)};return t.version="Mash 0.9",t}();t=s(" "),r=s(" "),n=s(" ");for(var a=0;a<e.length;a++)(t-=s(e[a]))<0&&(t+=1),(r-=s(e[a]))<0&&(r+=1),(n-=s(e[a]))<0&&(n+=1);s=null;var o=function(){var e=2091639*t+2.3283064365386963e-10*i;return t=r,r=n,n=e-(i=0|e)};return o.next=o,o.uint32=function(){return 4294967296*o()},o.fract53=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.version="Alea 0.9",o.args=e,o.exportState=function(){return[t,r,n,i]},o.importState=function(e){t=+e[0]||0,r=+e[1]||0,n=+e[2]||0,i=+e[3]||0},o}(Array.prototype.slice.call(arguments))}},"object"==typeof e?t.exports=n():"function"==typeof define&&define.amd?define(n):r.Alea=n()})),xL=vL(((e,t)=>{var r,n;r=e,n=function(e){e.SVD=function(e,t,r,n,i){if(t=void 0===t||t,r=void 0===r||r,i=1e-64/(n=n||Math.pow(2,-52)),!e)throw new TypeError("Matrix a is not defined");var s,a,o,l,c,u,h,d,f,p,m,g,v=e[0].length,y=e.length;if(y<v)throw new TypeError("Invalid matrix: m < n");for(var b=[],w=[],x=[],S="f"===t?y:v,_=p=h=0;_<y;_++)w[_]=new Array(S).fill(0);for(_=0;_<v;_++)x[_]=new Array(v).fill(0);var C,E=new Array(v).fill(0);for(_=0;_<y;_++)for(s=0;s<v;s++)w[_][s]=e[_][s];for(_=0;_<v;_++){for(b[_]=h,f=0,o=_+1,s=_;s<y;s++)f+=Math.pow(w[s][_],2);if(f<i)h=0;else for(d=(u=w[_][_])*(h=u<0?Math.sqrt(f):-Math.sqrt(f))-f,w[_][_]=u-h,s=o;s<v;s++){for(f=0,a=_;a<y;a++)f+=w[a][_]*w[a][s];for(u=f/d,a=_;a<y;a++)w[a][s]=w[a][s]+u*w[a][_]}for(E[_]=h,f=0,s=o;s<v;s++)f+=Math.pow(w[_][s],2);if(f<i)h=0;else{for(d=(u=w[_][_+1])*(h=u<0?Math.sqrt(f):-Math.sqrt(f))-f,w[_][_+1]=u-h,s=o;s<v;s++)b[s]=w[_][s]/d;for(s=o;s<y;s++){for(f=0,a=o;a<v;a++)f+=w[s][a]*w[_][a];for(a=o;a<v;a++)w[s][a]=w[s][a]+f*b[a]}}p<(m=Math.abs(E[_])+Math.abs(b[_]))&&(p=m)}if(r)for(_=v-1;0<=_;_--){if(0!==h){for(d=w[_][_+1]*h,s=o;s<v;s++)x[s][_]=w[_][s]/d;for(s=o;s<v;s++){for(f=0,a=o;a<v;a++)f+=w[_][a]*x[a][s];for(a=o;a<v;a++)x[a][s]=x[a][s]+f*x[a][_]}}for(s=o;s<v;s++)x[_][s]=0,x[s][_]=0;x[_][_]=1,h=b[_],o=_}if(t){if("f"===t)for(_=v;_<y;_++){for(s=v;s<y;s++)w[_][s]=0;w[_][_]=1}for(_=v-1;0<=_;_--){for(o=_+1,h=E[_],s=o;s<S;s++)w[_][s]=0;if(0!==h){for(d=w[_][_]*h,s=o;s<S;s++){for(f=0,a=o;a<y;a++)f+=w[a][_]*w[a][s];for(u=f/d,a=_;a<y;a++)w[a][s]=w[a][s]+u*w[a][_]}for(s=_;s<y;s++)w[s][_]=w[s][_]/h}else for(s=_;s<y;s++)w[s][_]=0;w[_][_]=w[_][_]+1}}for(n*=p,a=v-1;0<=a;a--)for(var A=0;A<50;A++){for(C=!1,o=a;0<=o;o--){if(Math.abs(b[o])<=n){C=!0;break}if(Math.abs(E[o-1])<=n)break}if(!C)for(c=0,l=o-(f=1),_=o;_<a+1&&(u=f*b[_],b[_]=c*b[_],!(Math.abs(u)<=n));_++)if(h=E[_],E[_]=Math.sqrt(u*u+h*h),c=h/(d=E[_]),f=-u/d,t)for(s=0;s<y;s++)m=w[s][l],g=w[s][_],w[s][l]=m*c+g*f,w[s][_]=-m*f+g*c;if(g=E[a],o===a){if(g<0&&(E[a]=-g,r))for(s=0;s<v;s++)x[s][a]=-x[s][a];break}for(p=E[o],u=(((m=E[a-1])-g)*(m+g)+((h=b[a-1])-(d=b[a]))*(h+d))/(2*d*m),h=Math.sqrt(u*u+1),u=((p-g)*(p+g)+d*(m/(u<0?u-h:u+h)-d))/p,_=o+(f=c=1);_<a+1;_++){if(h=b[_],m=E[_],d=f*h,h*=c,g=Math.sqrt(u*u+d*d),u=p*(c=u/(b[_-1]=g))+h*(f=d/g),h=-p*f+h*c,d=m*f,m*=c,r)for(s=0;s<v;s++)p=x[s][_-1],g=x[s][_],x[s][_-1]=p*c+g*f,x[s][_]=-p*f+g*c;if(g=Math.sqrt(u*u+d*d),u=(c=u/(E[_-1]=g))*h+(f=d/g)*m,p=-f*h+c*m,t)for(s=0;s<y;s++)m=w[s][_-1],g=w[s][_],w[s][_-1]=m*c+g*f,w[s][_]=-m*f+g*c}b[o]=0,b[a]=u,E[a]=p}for(_=0;_<v;_++)E[_]<n&&(E[_]=0);return{u:w,q:E,v:x}},e.VERSION="1.1.1",Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof e&&typeof t<"u"?n(e):"function"==typeof define&&define.amd?define(["exports"],n):n((r=typeof globalThis<"u"?globalThis:r||self).SVDJS={})})),SL=vL(((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)},t.exports=e.default})),_L=vL(((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()},t.exports=e.default})),CL=vL(((e,t)=>{function r(e,t,n,i){this.message=e,this.expected=t,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,r)}!function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(r,Error),r.buildMessage=function(e,t){var r,n={literal:function(e){return'"'+s(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?a(e.parts[t][0])+"-"+a(e.parts[t][1]):a(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function i(e){return e.charCodeAt(0).toString(16).toUpperCase()}function s(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+i(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+i(e)}))}function a(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+i(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+i(e)}))}function o(e){return n[e.type](e)}return"Expected "+function(e){var t,r,n=new Array(e.length);for(t=0;t<e.length;t++)n[t]=o(e[t]);if(n.sort(),n.length>0){for(t=1,r=1;t<n.length;t++)n[t-1]!==n[t]&&(n[r]=n[t],r++);n.length=r}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+(((r=t)?'"'+s(r)+'"':"end of input")+" found.")},t.exports={SyntaxError:r,parse:function(e,t){t=void 0!==t?t:{};var n,i={},s={svg_path:ge},a=ge,o=function(e){if(!e)return[];for(var t=[],r=0;r<e.length;r++)t=t.concat.apply(t,e[r]);var n=t[0];return n&&"m"==n.code&&(delete n.relative,n.code="M"),t},l=function(e,t){return function(e,t){if(!t)return[e];for(var r=[e],n=0,i=t.length;n<i;n++)r[n+1]=t[n][1];return r}(e,t)},c=/^[Mm]/,u=he(["M","m"],!1,!1),h=function(e,t,r){var n=ze(e,[t]);return r&&(n=n.concat(ze("M"==e?"L":"l",r[1]))),n},d=/^[Zz]/,f=he(["Z","z"],!1,!1),p=function(){return ze("Z")},m=/^[Ll]/,g=he(["L","l"],!1,!1),v=function(e,t){return ze(e,t)},y=/^[Hh]/,b=he(["H","h"],!1,!1),w=function(e,t){return ze(e,t.map((function(e){return{x:e}})))},x=/^[Vv]/,S=he(["V","v"],!1,!1),_=function(e,t){return ze(e,t.map((function(e){return{y:e}})))},C=/^[Cc]/,E=he(["C","c"],!1,!1),A=function(e,t,r){return{x1:e.x,y1:e.y,x2:t.x,y2:t.y,x:r.x,y:r.y}},M=/^[Ss]/,T=he(["S","s"],!1,!1),P=function(e,t){return{x2:e.x,y2:e.y,x:t.x,y:t.y}},k=/^[Qq]/,D=he(["Q","q"],!1,!1),I=function(e,t){return{x1:e.x,y1:e.y,x:t.x,y:t.y}},O=/^[Tt]/,R=he(["T","t"],!1,!1),L=/^[Aa]/,N=he(["A","a"],!1,!1),B=function(e,t,r,n,i,s){return{rx:e,ry:t,xAxisRotation:r,largeArc:n,sweep:i,x:s.x,y:s.y}},z=function(e,t){return{x:e,y:t}},F=function(e){return 1*e},j=function(e){return 1*e.join("")},U=/^[01]/,V=he(["0","1"],!1,!1),H=function(e){return"1"==e},W=function(){return""},G=",",q=ue(",",!1),X=function(e){return e.join("")},Y=".",K=ue(".",!1),Q=/^[eE]/,Z=he(["e","E"],!1,!1),J=/^[+\-]/,$=he(["+","-"],!1,!1),ee=/^[0-9]/,te=he([["0","9"]],!1,!1),re=function(e){return e.join("")},ne=/^[ \t\n\r]/,ie=he([" ","\t","\n","\r"],!1,!1),se=0,ae=[{line:1,column:1}],oe=0,le=[],ce=0;if("startRule"in t){if(!(t.startRule in s))throw new Error("Can't start parsing from rule \""+t.startRule+'".');a=s[t.startRule]}function ue(e,t){return{type:"literal",text:e,ignoreCase:t}}function he(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function de(t){var r,n=ae[t];if(n)return n;for(r=t-1;!ae[r];)r--;for(n={line:(n=ae[r]).line,column:n.column};r<t;)10===e.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return ae[t]=n,n}function fe(e,t){var r=de(e),n=de(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function pe(e){se<oe||(se>oe&&(oe=se,le=[]),le.push(e))}function me(e,t,n){return new r(r.buildMessage(e,t),e,t,n)}function ge(){var e,t,r,n,s;for(e=se,t=[],r=Le();r!==i;)t.push(r),r=Le();if(t!==i)if(r=function(){var e,t,r,n,s,a;if(e=se,t=ve(),t!==i){for(r=[],n=se,s=[],a=Le();a!==i;)s.push(a),a=Le();for(s!==i?(a=ve())!==i?n=s=[s,a]:(se=n,n=i):(se=n,n=i);n!==i;){for(r.push(n),n=se,s=[],a=Le();a!==i;)s.push(a),a=Le();s!==i?(a=ve())!==i?n=s=[s,a]:(se=n,n=i):(se=n,n=i)}r!==i?e=t=l(t,r):(se=e,e=i)}else se=e,e=i;return e}(),r===i&&(r=null),r!==i){for(n=[],s=Le();s!==i;)n.push(s),s=Le();n!==i?e=t=o(r):(se=e,e=i)}else se=e,e=i;else se=e,e=i;return e}function ve(){var t,r,n,s,a,o;if(t=se,r=function(){var t,r,n,s,a,o,l;if(t=se,c.test(e.charAt(se))?(r=e.charAt(se),se++):(r=i,0===ce&&pe(u)),r!==i){for(n=[],s=Le();s!==i;)n.push(s),s=Le();n!==i?(s=Ee())!==i?(a=se,(o=Pe())===i&&(o=null),o!==i?(l=be())!==i?a=o=[o,l]:(se=a,a=i):(se=a,a=i),a===i&&(a=null),a!==i?t=r=h(r,s,a):(se=t,t=i)):(se=t,t=i):(se=t,t=i)}else se=t,t=i;return t}(),r!==i){for(n=[],s=se,a=[],o=Le();o!==i;)a.push(o),o=Le();for(a!==i?(o=ye())!==i?s=a=[a,o]:(se=s,s=i):(se=s,s=i);s!==i;){for(n.push(s),s=se,a=[],o=Le();o!==i;)a.push(o),o=Le();a!==i?(o=ye())!==i?s=a=[a,o]:(se=s,s=i):(se=s,s=i)}n!==i?t=r=l(r,n):(se=t,t=i)}else se=t,t=i;return t}function ye(){var t;return(t=function(){var t,r;return t=se,d.test(e.charAt(se))?(r=e.charAt(se),se++):(r=i,0===ce&&pe(f)),r!==i&&(r=p()),t=r,t}())===i&&(t=function(){var t,r,n,s;if(t=se,m.test(e.charAt(se))?(r=e.charAt(se),se++):(r=i,0===ce&&pe(g)),r!==i){for(n=[],s=Le();s!==i;)n.push(s),s=Le();n!==i?(s=be())!==i?t=r=v(r,s):(se=t,t=i):(se=t,t=i)}else se=t,t=i;return t}(),t===i&&(t=function(){var t,r,n,s;if(t=se,y.test(e.charAt(se))?(r=e.charAt(se),se++):(r=i,0===ce&&pe(b)),r!==i){for(n=[],s=Le();s!==i;)n.push(s),s=Le();n!==i?(s=we())!==i?t=r=w(r,s):(se=t,t=i):(se=t,t=i)}else se=t,t=i;return t}(),t===i&&(t=function(){var t,r,n,s;if(t=se,x.test(e.charAt(se))?(r=e.charAt(se),se++):(r=i,0===ce&&pe(S)),r!==i){for(n=[],s=Le();s!==i;)n.push(s),s=Le();n!==i?(s=we())!==i?t=r=_(r,s):(se=t,t=i):(se=t,t=i)}else se=t,t=i;return t}(),t===i&&(t=function(){var t,r,n,s;if(t=se,C.test(e.charAt(se))?(r=e.charAt(se),se++):(r=i,0===ce&&pe(E)),r!==i){for(n=[],s=Le();s!==i;)n.push(s),s=Le();n!==i?(s=function(){var e,t,r,n,s,a;if(e=se,t=xe(),t!==i){for(r=[],n=se,(s=Pe())===i&&(s=null),s!==i?(a=xe())!==i?n=s=[s,a]:(se=n,n=i):(se=n,n=i);n!==i;)r.push(n),n=se,(s=Pe())===i&&(s=null),s!==i?(a=xe())!==i?n=s=[s,a]:(se=n,n=i):(se=n,n=i);r!==i?e=t=l(t,r):(se=e,e=i)}else se=e,e=i;return e}(),s!==i?t=r=v(r,s):(se=t,t=i)):(se=t,t=i)}else se=t,t=i;return t}(),t===i&&(t=function(){var t,r,n,s;if(t=se,M.test(e.charAt(se))?(r=e.charAt(se),se++):(r=i,0===ce&&pe(T)),r!==i){for(n=[],s=Le();s!==i;)n.push(s),s=Le();n!==i?(s=function(){var e,t,r,n,s,a;if(e=se,t=Se(),t!==i){for(r=[],n=se,(s=Pe())===i&&(s=null),s!==i?(a=Se())!==i?n=s=[s,a]:(se=n,n=i):(se=n,n=i);n!==i;)r.push(n),n=se,(s=Pe())===i&&(s=null),s!==i?(a=Se())!==i?n=s=[s,a]:(se=n,n=i):(se=n,n=i);r!==i?e=t=l(t,r):(se=e,e=i)}else se=e,e=i;return e}(),s!==i?t=r=v(r,s):(se=t,t=i)):(se=t,t=i)}else se=t,t=i;return t}(),t===i&&(t=function(){var t,r,n,s;if(t=se,k.test(e.charAt(se))?(r=e.charAt(se),se++):(r=i,0===ce&&pe(D)),r!==i){for(n=[],s=Le();s!==i;)n.push(s),s=Le();n!==i?(s=function(){var e,t,r,n,s,a;if(e=se,t=_e(),t!==i){for(r=[],n=se,(s=Pe())===i&&(s=null),s!==i?(a=_e())!==i?n=s=[s,a]:(se=n,n=i):(se=n,n=i);n!==i;)r.push(n),n=se,(s=Pe())===i&&(s=null),s!==i?(a=_e())!==i?n=s=[s,a]:(se=n,n=i):(se=n,n=i);r!==i?e=t=l(t,r):(se=e,e=i)}else se=e,e=i;return e}(),s!==i?t=r=v(r,s):(se=t,t=i)):(se=t,t=i)}else se=t,t=i;return t}(),t===i&&(t=function(){var t,r,n,s;if(t=se,O.test(e.charAt(se))?(r=e.charAt(se),se++):(r=i,0===ce&&pe(R)),r!==i){for(n=[],s=Le();s!==i;)n.push(s),s=Le();n!==i?(s=function(){var e,t,r,n,s,a;if(e=se,t=Ee(),t!==i){for(r=[],n=se,(s=Pe())===i&&(s=null),s!==i?(a=Ee())!==i?n=s=[s,a]:(se=n,n=i):(se=n,n=i);n!==i;)r.push(n),n=se,(s=Pe())===i&&(s=null),s!==i?(a=Ee())!==i?n=s=[s,a]:(se=n,n=i):(se=n,n=i);r!==i?e=t=l(t,r):(se=e,e=i)}else se=e,e=i;return e}(),s!==i?t=r=v(r,s):(se=t,t=i)):(se=t,t=i)}else se=t,t=i;return t}(),t===i&&(t=function(){var t,r,n,s;if(t=se,L.test(e.charAt(se))?(r=e.charAt(se),se++):(r=i,0===ce&&pe(N)),r!==i){for(n=[],s=Le();s!==i;)n.push(s),s=Le();n!==i?(s=function(){var e,t,r,n,s,a;if(e=se,t=Ce(),t!==i){for(r=[],n=se,(s=Pe())===i&&(s=null),s!==i?(a=Ce())!==i?n=s=[s,a]:(se=n,n=i):(se=n,n=i);n!==i;)r.push(n),n=se,(s=Pe())===i&&(s=null),s!==i?(a=Ce())!==i?n=s=[s,a]:(se=n,n=i):(se=n,n=i);r!==i?e=t=l(t,r):(se=e,e=i)}else se=e,e=i;return e}(),s!==i?t=r=v(r,s):(se=t,t=i)):(se=t,t=i)}else se=t,t=i;return t}())))))))),t}function be(){var e,t,r,n,s,a;if(e=se,(t=Ee())!==i){for(r=[],n=se,(s=Pe())===i&&(s=null),s!==i?(a=Ee())!==i?n=s=[s,a]:(se=n,n=i):(se=n,n=i);n!==i;)r.push(n),n=se,(s=Pe())===i&&(s=null),s!==i?(a=Ee())!==i?n=s=[s,a]:(se=n,n=i):(se=n,n=i);r!==i?e=t=l(t,r):(se=e,e=i)}else se=e,e=i;return e}function we(){var e,t,r,n,s,a;if(e=se,(t=Me())!==i){for(r=[],n=se,(s=Pe())===i&&(s=null),s!==i?(a=Me())!==i?n=s=[s,a]:(se=n,n=i):(se=n,n=i);n!==i;)r.push(n),n=se,(s=Pe())===i&&(s=null),s!==i?(a=Me())!==i?n=s=[s,a]:(se=n,n=i):(se=n,n=i);r!==i?e=t=l(t,r):(se=e,e=i)}else se=e,e=i;return e}function xe(){var e,t,r,n,s,a;return e=se,(t=Ee())!==i?((r=Pe())===i&&(r=null),r!==i?(n=Ee())!==i?((s=Pe())===i&&(s=null),s!==i?(a=Ee())!==i?e=t=A(t,n,a):(se=e,e=i):(se=e,e=i)):(se=e,e=i):(se=e,e=i)):(se=e,e=i),e}function Se(){var e,t,r,n;return e=se,(t=Ee())!==i?((r=Pe())===i&&(r=null),r!==i?(n=Ee())!==i?e=t=P(t,n):(se=e,e=i):(se=e,e=i)):(se=e,e=i),e}function _e(){var e,t,r,n;return e=se,(t=Ee())!==i?((r=Pe())===i&&(r=null),r!==i?(n=Ee())!==i?e=t=I(t,n):(se=e,e=i):(se=e,e=i)):(se=e,e=i),e}function Ce(){var e,t,r,n,s,a,o,l,c,u,h;return e=se,(t=Ae())!==i?((r=Pe())===i&&(r=null),r!==i?(n=Ae())!==i?((s=Pe())===i&&(s=null),s!==i?(a=Me())!==i?Pe()!==i?(o=Te())!==i?((l=Pe())===i&&(l=null),l!==i?(c=Te())!==i?((u=Pe())===i&&(u=null),u!==i?(h=Ee())!==i?e=t=B(t,n,a,o,c,h):(se=e,e=i):(se=e,e=i)):(se=e,e=i):(se=e,e=i)):(se=e,e=i):(se=e,e=i):(se=e,e=i):(se=e,e=i)):(se=e,e=i):(se=e,e=i)):(se=e,e=i),e}function Ee(){var e,t,r,n;return e=se,(t=Me())!==i?((r=Pe())===i&&(r=null),r!==i?(n=Me())!==i?e=t=z(t,n):(se=e,e=i):(se=e,e=i)):(se=e,e=i),e}function Ae(){var e,t;return e=se,(t=De())===i&&(t=Re()),t!==i&&(t=F(t)),e=t}function Me(){var e,t,r,n;return e=se,t=se,(r=Oe())===i&&(r=null),r!==i?(n=De())!==i?t=r=[r,n]:(se=t,t=i):(se=t,t=i),t===i&&(t=se,(r=Oe())===i&&(r=null),r!==i?(n=Re())!==i?t=r=[r,n]:(se=t,t=i):(se=t,t=i)),t!==i&&(t=j(t)),e=t}function Te(){var t,r;return t=se,U.test(e.charAt(se))?(r=e.charAt(se),se++):(r=i,0===ce&&pe(V)),r!==i&&(r=H(r)),t=r}function Pe(){var e,t,r,n,s;if(e=se,t=[],(r=Le())!==i)for(;r!==i;)t.push(r),r=Le();else t=i;if(t!==i)if((r=ke())===i&&(r=null),r!==i){for(n=[],s=Le();s!==i;)n.push(s),s=Le();n!==i?e=t=[t,r,n]:(se=e,e=i)}else se=e,e=i;else se=e,e=i;if(e===i){if(e=se,t=se,(r=ke())!==i){for(n=[],s=Le();s!==i;)n.push(s),s=Le();n!==i?t=r=[r,n]:(se=t,t=i)}else se=t,t=i;t!==i&&(t=W()),e=t}return e}function ke(){var t;return 44===e.charCodeAt(se)?(t=G,se++):(t=i,0===ce&&pe(q)),t}function De(){var t,r,n,s;return t=se,r=se,n=function(){var t,r,n,s,a;return t=se,r=se,n=Re(),n===i&&(n=null),n!==i?(46===e.charCodeAt(se)?(s=Y,se++):(s=i,0===ce&&pe(K)),s!==i?(a=Re(),a!==i?(n=[n,s,a],r=n):(se=r,r=i)):(se=r,r=i)):(se=r,r=i),r===i&&(r=se,n=Re(),n!==i?(46===e.charCodeAt(se)?(s=Y,se++):(s=i,0===ce&&pe(K)),s!==i?(n=[n,s],r=n):(se=r,r=i)):(se=r,r=i)),r!==i&&(r=X(r)),t=r,t}(),n!==i?((s=Ie())===i&&(s=null),s!==i?r=n=[n,s]:(se=r,r=i)):(se=r,r=i),r===i&&(r=se,(n=Re())!==i?(s=Ie())!==i?r=n=[n,s]:(se=r,r=i):(se=r,r=i)),r!==i&&(r=X(r)),t=r}function Ie(){var t,r,n,s,a;return t=se,r=se,Q.test(e.charAt(se))?(n=e.charAt(se),se++):(n=i,0===ce&&pe(Z)),n!==i?((s=Oe())===i&&(s=null),s!==i?(a=Re())!==i?r=n=[n,s,a]:(se=r,r=i):(se=r,r=i)):(se=r,r=i),r!==i&&(r=X(r)),t=r}function Oe(){var t;return J.test(e.charAt(se))?(t=e.charAt(se),se++):(t=i,0===ce&&pe($)),t}function Re(){var t,r,n;if(t=se,r=[],ee.test(e.charAt(se))?(n=e.charAt(se),se++):(n=i,0===ce&&pe(te)),n!==i)for(;n!==i;)r.push(n),ee.test(e.charAt(se))?(n=e.charAt(se),se++):(n=i,0===ce&&pe(te));else r=i;return r!==i&&(r=re(r)),t=r}function Le(){var t,r;return t=se,ne.test(e.charAt(se))?(r=e.charAt(se),se++):(r=i,0===ce&&pe(ie)),r!==i&&(r=W()),t=r}var Ne={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var Be in Ne)Ne[Be.toUpperCase()]=Ne[Be];function ze(e,t){t||(t=[{}]);for(var r=t.length;r--;){var n={code:e,command:Ne[e]};for(var i in e==e.toLowerCase()&&(n.relative=!0),t[r])n[i]=t[r][i];t[r]=n}return t}if((n=a())!==i&&se===e.length)return n;throw n!==i&&se<e.length&&pe({type:"end"}),me(le,oe<e.length?e.charAt(oe):null,oe<e.length?fe(oe,oe+1):fe(oe,oe))}}})),EL=vL(((e,t)=>{var r=CL().parse;r.parseSVG=r,r.makeAbsolute=function(e){var t,r={x:0,y:0},n={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return e.forEach((function(e){for(var i in"moveto"===e.command&&(t=e),e.x0=r.x,e.y0=r.y,n)i in e&&(e[i]+=e.relative?e[n[i]]:0);"x"in e||(e.x=r.x),"y"in e||(e.y=r.y),e.relative=!1,e.code=e.code.toUpperCase(),"closepath"==e.command&&(e.x=t.x,e.y=t.y),r=e})),e},t.exports=r})),AL=vL(((e,t)=>{t.exports=function(e,t){for(var r=e.split("."),n=t.split("."),i=0;i<3;i++){var s=Number(r[i]),a=Number(n[i]);if(s>a)return 1;if(a>s)return-1;if(!isNaN(s)&&isNaN(a))return 1;if(isNaN(s)&&!isNaN(a))return-1}return 0}})),ML="149",TL=0,PL=1,kL=2,DL=3,IL=0,OL=1,RL=2,LL=100,NL=101,BL=102,zL=200,FL=201,jL=202,UL=203,VL=204,HL=205,WL=206,GL=207,qL=208,XL=209,YL=210,KL=301,QL=302,ZL=306,JL=1e3,$L=1001,eN=1002,tN=1003,rN=1004,nN=1005,iN=1006,sN=1007,aN=1008,oN=1009,lN=1014,cN=1015,uN=1016,hN=1020,dN=1023,fN=1026,pN=1027,mN=1028,gN=1030,vN=33776,yN=33777,bN=33778,wN=33779,xN=36492,SN=2202,_N=2300,CN=2301,EN=2302,AN=2400,MN=2401,TN=2402,PN=2500,kN=3e3,DN=3001,IN=3200,ON="srgb",RN="srgb-linear",LN=7680,NN=35044,BN="300 es",zN=1035,FN=class{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});let r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;let r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;let r=this._listeners[e];if(void 0!==r){let e=r.indexOf(t);-1!==e&&r.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;let t=this._listeners[e.type];if(void 0!==t){e.target=this;let r=t.slice(0);for(let t=0,n=r.length;t<n;t++)r[t].call(this,e);e.target=null}}},jN=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],UN=1234567,VN=Math.PI/180,HN=180/Math.PI;function WN(){let e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(jN[255&e]+jN[e>>8&255]+jN[e>>16&255]+jN[e>>24&255]+"-"+jN[255&t]+jN[t>>8&255]+"-"+jN[t>>16&15|64]+jN[t>>24&255]+"-"+jN[63&r|128]+jN[r>>8&255]+"-"+jN[r>>16&255]+jN[r>>24&255]+jN[255&n]+jN[n>>8&255]+jN[n>>16&255]+jN[n>>24&255]).toLowerCase()}function GN(e,t,r){return Math.max(t,Math.min(r,e))}function qN(e,t){return(e%t+t)%t}function XN(e,t,r){return(1-r)*e+r*t}function YN(e){return 0===(e&e-1)&&0!==e}function KN(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function QN(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function ZN(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function JN(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}var $N=Object.freeze({__proto__:null,DEG2RAD:VN,RAD2DEG:HN,ceilPowerOfTwo:KN,clamp:GN,damp:function(e,t,r,n){return XN(e,t,1-Math.exp(-r*n))},degToRad:function(e){return e*VN},denormalize:ZN,euclideanModulo:qN,floorPowerOfTwo:QN,generateUUID:WN,inverseLerp:function(e,t,r){return e!==t?(r-e)/(t-e):0},isPowerOfTwo:YN,lerp:XN,mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},normalize:JN,pingpong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(qN(e,2*t)-t)},radToDeg:function(e){return e*HN},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},seededRandom:function(e){void 0!==e&&(UN=e);let t=UN+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},setQuaternionFromProperEuler:function(e,t,r,n,i){let s=Math.cos,a=Math.sin,o=s(r/2),l=a(r/2),c=s((t+n)/2),u=a((t+n)/2),h=s((t-n)/2),d=a((t-n)/2),f=s((n-t)/2),p=a((n-t)/2);switch(i){case"XYX":e.set(o*u,l*h,l*d,o*c);break;case"YZY":e.set(l*d,o*u,l*h,o*c);break;case"ZXZ":e.set(l*h,l*d,o*u,o*c);break;case"XZX":e.set(o*u,l*p,l*f,o*c);break;case"YXY":e.set(l*f,o*u,l*p,o*c);break;case"ZYZ":e.set(l*p,l*f,o*u,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)}}),eB=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;eB.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let r=Math.cos(t),n=Math.sin(t),i=this.x-e.x,s=this.y-e.y;return this.x=i*r-s*n+e.x,this.y=i*n+s*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},tB=class{constructor(){tB.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,n,i,s,a,o,l){let c=this.elements;return c[0]=e,c[1]=n,c[2]=a,c[3]=t,c[4]=i,c[5]=o,c[6]=r,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,i=this.elements,s=r[0],a=r[3],o=r[6],l=r[1],c=r[4],u=r[7],h=r[2],d=r[5],f=r[8],p=n[0],m=n[3],g=n[6],v=n[1],y=n[4],b=n[7],w=n[2],x=n[5],S=n[8];return i[0]=s*p+a*v+o*w,i[3]=s*m+a*y+o*x,i[6]=s*g+a*b+o*S,i[1]=l*p+c*v+u*w,i[4]=l*m+c*y+u*x,i[7]=l*g+c*b+u*S,i[2]=h*p+d*v+f*w,i[5]=h*m+d*y+f*x,i[8]=h*g+d*b+f*S,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*s*c-t*a*l-r*i*c+r*a*o+n*i*l-n*s*o}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=c*s-a*l,h=a*o-c*i,d=l*i-s*o,f=t*u+r*h+n*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);let p=1/f;return e[0]=u*p,e[1]=(n*l-c*r)*p,e[2]=(a*r-n*s)*p,e[3]=h*p,e[4]=(c*t-n*o)*p,e[5]=(n*i-a*t)*p,e[6]=d*p,e[7]=(r*o-l*t)*p,e[8]=(s*t-r*i)*p,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,n,i,s,a){let o=Math.cos(i),l=Math.sin(i);return this.set(r*o,r*l,-r*(o*s+l*a)+s+e,-n*l,n*o,-n*(-l*s+o*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(rB.makeScale(e,t)),this}rotate(e){return this.premultiply(rB.makeRotation(-e)),this}translate(e,t){return this.premultiply(rB.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,r=e.elements;for(let n=0;n<9;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return(new this.constructor).fromArray(this.elements)}},rB=new tB;function nB(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}var iB={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function sB(e,t){return new iB[e](t)}function aB(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function oB(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function lB(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var cB={[ON]:{[RN]:oB},[RN]:{[ON]:lB}},uB={legacyMode:!0,get workingColorSpace(){return RN},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,r){if(this.legacyMode||t===r||!t||!r)return e;if(cB[t]&&void 0!==cB[t][r]){let n=cB[t][r];return e.r=n(e.r),e.g=n(e.g),e.b=n(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},hB={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},dB={r:0,g:0,b:0},fB={h:0,s:0,l:0},pB={h:0,s:0,l:0};function mB(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+6*(t-e)*(2/3-r):e}function gB(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}var vB=class{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===t&&void 0===r?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ON;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,uB.toWorkingColorSpace(this,t),this}setRGB(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:uB.workingColorSpace;return this.r=e,this.g=t,this.b=r,uB.toWorkingColorSpace(this,n),this}setHSL(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:uB.workingColorSpace;if(e=qN(e,1),t=GN(t,0,1),r=GN(r,0,1),0===t)this.r=this.g=this.b=r;else{let n=r<=.5?r*(1+t):r+t-r*t,i=2*r-n;this.r=mB(i,n,e+1/3),this.g=mB(i,n,e),this.b=mB(i,n,e-1/3)}return uB.toWorkingColorSpace(this,n),this}setStyle(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ON;function n(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let e,i=t[1],s=t[2];switch(i){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,uB.toWorkingColorSpace(this,r),n(e[4]),this;if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,uB.toWorkingColorSpace(this,r),n(e[4]),this;break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){let t=parseFloat(e[1])/360,i=parseFloat(e[2])/100,s=parseFloat(e[3])/100;return n(e[4]),this.setHSL(t,i,s,r)}}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){let e=t[1],n=e.length;if(3===n)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,uB.toWorkingColorSpace(this,r),this;if(6===n)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,uB.toWorkingColorSpace(this,r),this}return e&&e.length>0?this.setColorName(e,r):this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ON,r=hB[e.toLowerCase()];return void 0!==r?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=oB(e.r),this.g=oB(e.g),this.b=oB(e.b),this}copyLinearToSRGB(e){return this.r=lB(e.r),this.g=lB(e.g),this.b=lB(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ON;return uB.fromWorkingColorSpace(gB(this,dB),e),GN(255*dB.r,0,255)<<16^GN(255*dB.g,0,255)<<8^GN(255*dB.b,0,255)}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ON;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uB.workingColorSpace;uB.fromWorkingColorSpace(gB(this,dB),t);let r,n,i=dB.r,s=dB.g,a=dB.b,o=Math.max(i,s,a),l=Math.min(i,s,a),c=(l+o)/2;if(l===o)r=0,n=0;else{let e=o-l;switch(n=c<=.5?e/(o+l):e/(2-o-l),o){case i:r=(s-a)/e+(s<a?6:0);break;case s:r=(a-i)/e+2;break;case a:r=(i-s)/e+4}r/=6}return e.h=r,e.s=n,e.l=c,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uB.workingColorSpace;return uB.fromWorkingColorSpace(gB(this,dB),t),e.r=dB.r,e.g=dB.g,e.b=dB.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ON;return uB.fromWorkingColorSpace(gB(this,dB),e),e!==ON?"color(".concat(e," ").concat(dB.r," ").concat(dB.g," ").concat(dB.b,")"):"rgb(".concat(255*dB.r|0,",").concat(255*dB.g|0,",").concat(255*dB.b|0,")")}offsetHSL(e,t,r){return this.getHSL(fB),fB.h+=e,fB.s+=t,fB.l+=r,this.setHSL(fB.h,fB.s,fB.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(fB),e.getHSL(pB);let r=XN(fB.h,pB.h,t),n=XN(fB.s,pB.s,t),i=XN(fB.l,pB.l,t);return this.setHSL(r,n,i),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};vB.NAMES=hB;var yB,bB=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===yB&&(yB=aB("canvas")),yB.width=e.width,yB.height=e.height;let r=yB.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=yB}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=aB("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);let n=r.getImageData(0,0,e.width,e.height),i=n.data;for(let e=0;e<i.length;e++)i[e]=255*oB(i[e]/255);return r.putImageData(n,0,0),t}if(e.data){let t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*oB(t[e]/255)):t[e]=oB(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},wB=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,this.uuid=WN(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){let t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];let r={uuid:this.uuid,url:""},n=this.data;if(null!==n){let e;if(Array.isArray(n)){e=[];for(let t=0,r=n.length;t<r;t++)n[t].isDataTexture?e.push(xB(n[t].image)):e.push(xB(n[t]))}else e=xB(n);r.url=e}return t||(e.images[this.uuid]=r),r}};function xB(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?bB.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var SB=0,_B=class extends FN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_B.DEFAULT_IMAGE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_B.DEFAULT_MAPPING,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$L,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:$L,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:iN,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:aN,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:dN,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:oN,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:_B.DEFAULT_ANISOTROPY,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:kN;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:SB++}),this.uuid=WN(),this.name="",this.source=new wB(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=n,this.magFilter=i,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new eB(0,0),this.repeat=new eB(1,1),this.center=new eB(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new tB,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];let r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case JL:e.x=e.x-Math.floor(e.x);break;case $L:e.x=e.x<0?0:1;break;case eN:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case JL:e.y=e.y-Math.floor(e.y);break;case $L:e.y=e.y<0?0:1;break;case eN:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}};_B.DEFAULT_IMAGE=null,_B.DEFAULT_MAPPING=300,_B.DEFAULT_ANISOTROPY=1;var CB=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;CB.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,i=this.w,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*n+s[12]*i,this.y=s[1]*t+s[5]*r+s[9]*n+s[13]*i,this.z=s[2]*t+s[6]*r+s[10]*n+s[14]*i,this.w=s[3]*t+s[7]*r+s[11]*n+s[15]*i,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,n,i,s=e.elements,a=s[0],o=s[4],l=s[8],c=s[1],u=s[5],h=s[9],d=s[2],f=s[6],p=s[10];if(Math.abs(o-c)<.01&&Math.abs(l-d)<.01&&Math.abs(h-f)<.01){if(Math.abs(o+c)<.1&&Math.abs(l+d)<.1&&Math.abs(h+f)<.1&&Math.abs(a+u+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let e=(a+1)/2,s=(u+1)/2,m=(p+1)/2,g=(o+c)/4,v=(l+d)/4,y=(h+f)/4;return e>s&&e>m?e<.01?(r=0,n=.707106781,i=.707106781):(r=Math.sqrt(e),n=g/r,i=v/r):s>m?s<.01?(r=.707106781,n=0,i=.707106781):(n=Math.sqrt(s),r=g/n,i=y/n):m<.01?(r=.707106781,n=.707106781,i=0):(i=Math.sqrt(m),r=v/i,n=y/i),this.set(r,n,i,t),this}let m=Math.sqrt((f-h)*(f-h)+(l-d)*(l-d)+(c-o)*(c-o));return Math.abs(m)<.001&&(m=1),this.x=(f-h)/m,this.y=(l-d)/m,this.z=(c-o)/m,this.w=Math.acos((a+u+p-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},EB=class extends FN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new CB(0,0,e,t),this.scissorTest=!1,this.viewport=new CB(0,0,e,t);let n={width:e,height:t,depth:1};this.texture=new _B(n,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,this.texture.internalFormat=void 0!==r.internalFormat?r.internalFormat:null,this.texture.minFilter=void 0!==r.minFilter?r.minFilter:iN,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0!==r.stencilBuffer&&r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null,this.samples=void 0!==r.samples?r.samples:0}setSize(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new wB(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},AB=class extends _B{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=tN,this.minFilter=tN,this.wrapR=$L,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},MB=class extends EB{constructor(){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isWebGLMultipleRenderTargets=!0;let t=this.texture;this.texture=[];for(let r=0;r<e;r++)this.texture[r]=t.clone(),this.texture[r].isRenderTargetTexture=!0}setSize(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let n=0,i=this.texture.length;n<i;n++)this.texture[n].image.width=e,this.texture[n].image.height=t,this.texture[n].image.depth=r;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,r=e.texture.length;t<r;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},TB=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=n}static slerpFlat(e,t,r,n,i,s,a){let o=r[n+0],l=r[n+1],c=r[n+2],u=r[n+3],h=i[s+0],d=i[s+1],f=i[s+2],p=i[s+3];if(0===a)return e[t+0]=o,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===a)return e[t+0]=h,e[t+1]=d,e[t+2]=f,void(e[t+3]=p);if(u!==p||o!==h||l!==d||c!==f){let e=1-a,t=o*h+l*d+c*f+u*p,r=t>=0?1:-1,n=1-t*t;if(n>Number.EPSILON){let i=Math.sqrt(n),s=Math.atan2(i,t*r);e=Math.sin(e*s)/i,a=Math.sin(a*s)/i}let i=a*r;if(o=o*e+h*i,l=l*e+d*i,c=c*e+f*i,u=u*e+p*i,e===1-a){let e=1/Math.sqrt(o*o+l*l+c*c+u*u);o*=e,l*=e,c*=e,u*=e}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,r,n,i,s){let a=r[n],o=r[n+1],l=r[n+2],c=r[n+3],u=i[s],h=i[s+1],d=i[s+2],f=i[s+3];return e[t]=a*f+c*u+o*d-l*h,e[t+1]=o*f+c*h+l*u-a*d,e[t+2]=l*f+c*d+a*h-o*u,e[t+3]=c*f-a*u-o*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let r=e._x,n=e._y,i=e._z,s=e._order,a=Math.cos,o=Math.sin,l=a(r/2),c=a(n/2),u=a(i/2),h=o(r/2),d=o(n/2),f=o(i/2);switch(s){case"XYZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"YXZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"ZXY":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"ZYX":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"YZX":this._x=h*c*u+l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u-h*d*f;break;case"XZY":this._x=h*c*u-l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u+h*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,r=t[0],n=t[4],i=t[8],s=t[1],a=t[5],o=t[9],l=t[2],c=t[6],u=t[10],h=r+a+u;if(h>0){let e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-o)*e,this._y=(i-l)*e,this._z=(s-n)*e}else if(r>a&&r>u){let e=2*Math.sqrt(1+r-a-u);this._w=(c-o)/e,this._x=.25*e,this._y=(n+s)/e,this._z=(i+l)/e}else if(a>u){let e=2*Math.sqrt(1+a-r-u);this._w=(i-l)/e,this._x=(n+s)/e,this._y=.25*e,this._z=(o+c)/e}else{let e=2*Math.sqrt(1+u-r-a);this._w=(s-n)/e,this._x=(i+l)/e,this._y=(o+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(GN(this.dot(e),-1,1)))}rotateTowards(e,t){let r=this.angleTo(e);if(0===r)return this;let n=Math.min(1,t/r);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let r=e._x,n=e._y,i=e._z,s=e._w,a=t._x,o=t._y,l=t._z,c=t._w;return this._x=r*c+s*a+n*l-i*o,this._y=n*c+s*o+i*a-r*l,this._z=i*c+s*l+r*o-n*a,this._w=s*c-r*a-n*o-i*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);let r=this._x,n=this._y,i=this._z,s=this._w,a=s*e._w+r*e._x+n*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=r,this._y=n,this._z=i,this;let o=1-a*a;if(o<=Number.EPSILON){let e=1-t;return this._w=e*s+t*this._w,this._x=e*r+t*this._x,this._y=e*n+t*this._y,this._z=e*i+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(o),c=Math.atan2(l,a),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=s*u+this._w*h,this._x=r*u+this._x*h,this._y=n*u+this._y*h,this._z=i*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){let e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),n=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(t*Math.cos(n),r*Math.sin(i),r*Math.cos(i),t*Math.sin(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},PB=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;PB.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return void 0===r&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(DB.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(DB.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,i=e.elements,s=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*s,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*s,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*s,this}applyQuaternion(e){let t=this.x,r=this.y,n=this.z,i=e.x,s=e.y,a=e.z,o=e.w,l=o*t+s*n-a*r,c=o*r+a*t-i*n,u=o*n+i*r-s*t,h=-i*t-s*r-a*n;return this.x=l*o+h*-i+c*-a-u*-s,this.y=c*o+h*-s+u*-i-l*-a,this.z=u*o+h*-a+l*-s-c*-i,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,n=e.y,i=e.z,s=t.x,a=t.y,o=t.z;return this.x=n*o-i*a,this.y=i*s-r*o,this.z=r*a-n*s,this}projectOnVector(e){let t=e.lengthSq();if(0===t)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return kB.copy(this).projectOnVector(e),this.sub(kB)}reflect(e){return this.sub(kB.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(GN(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},kB=new PB,DB=new TB,IB=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new PB(1/0,1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PB(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,n=1/0,i=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.length;o<l;o+=3){let l=e[o],c=e[o+1],u=e[o+2];l<t&&(t=l),c<r&&(r=c),u<n&&(n=u),l>i&&(i=l),c>s&&(s=c),u>a&&(a=u)}return this.min.set(t,r,n),this.max.set(i,s,a),this}setFromBufferAttribute(e){let t=1/0,r=1/0,n=1/0,i=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.count;o<l;o++){let l=e.getX(o),c=e.getY(o),u=e.getZ(o);l<t&&(t=l),c<r&&(r=c),u<n&&(n=u),l>i&&(i=l),c>s&&(s=c),u>a&&(a=u)}return this.min.set(t,r,n),this.max.set(i,s,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=RB.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);let r=e.geometry;if(void 0!==r)if(t&&null!=r.attributes&&void 0!==r.attributes.position){let t=r.attributes.position;for(let r=0,n=t.count;r<n;r++)RB.fromBufferAttribute(t,r).applyMatrix4(e.matrixWorld),this.expandByPoint(RB)}else null===r.boundingBox&&r.computeBoundingBox(),LB.copy(r.boundingBox),LB.applyMatrix4(e.matrixWorld),this.union(LB);let n=e.children;for(let i=0,s=n.length;i<s;i++)this.expandByObject(n[i],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,RB),RB.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(VB),HB.subVectors(this.max,VB),NB.subVectors(e.a,VB),BB.subVectors(e.b,VB),zB.subVectors(e.c,VB),FB.subVectors(BB,NB),jB.subVectors(zB,BB),UB.subVectors(NB,zB);let t=[0,-FB.z,FB.y,0,-jB.z,jB.y,0,-UB.z,UB.y,FB.z,0,-FB.x,jB.z,0,-jB.x,UB.z,0,-UB.x,-FB.y,FB.x,0,-jB.y,jB.x,0,-UB.y,UB.x,0];return!(!qB(t,NB,BB,zB,HB)||(t=[1,0,0,0,1,0,0,0,1],!qB(t,NB,BB,zB,HB)))&&(WB.crossVectors(FB,jB),t=[WB.x,WB.y,WB.z],qB(t,NB,BB,zB,HB))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return RB.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(RB).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(OB[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),OB[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),OB[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),OB[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),OB[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),OB[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),OB[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),OB[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(OB)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},OB=[new PB,new PB,new PB,new PB,new PB,new PB,new PB,new PB],RB=new PB,LB=new IB,NB=new PB,BB=new PB,zB=new PB,FB=new PB,jB=new PB,UB=new PB,VB=new PB,HB=new PB,WB=new PB,GB=new PB;function qB(e,t,r,n,i){for(let s=0,a=e.length-3;s<=a;s+=3){GB.fromArray(e,s);let a=i.x*Math.abs(GB.x)+i.y*Math.abs(GB.y)+i.z*Math.abs(GB.z),o=t.dot(GB),l=r.dot(GB),c=n.dot(GB);if(Math.max(-Math.max(o,l,c),Math.min(o,l,c))>a)return!1}return!0}var XB=new IB,YB=new PB,KB=new PB,QB=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new PB,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;void 0!==t?r.copy(t):XB.setFromPoints(e).getCenter(r);let n=0;for(let i=0,s=e.length;i<s;i++)n=Math.max(n,r.distanceToSquared(e[i]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;YB.subVectors(e,this.center);let t=YB.lengthSq();if(t>this.radius*this.radius){let e=Math.sqrt(t),r=.5*(e-this.radius);this.center.addScaledVector(YB,r/e),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(KB.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(YB.copy(e.center).add(KB)),this.expandByPoint(YB.copy(e.center).sub(KB))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}},ZB=new PB,JB=new PB,$B=new PB,ez=new PB,tz=new PB,rz=new PB,nz=new PB,iz=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new PB,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PB(0,0,-1);this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ZB)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=ZB.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ZB.copy(this.direction).multiplyScalar(t).add(this.origin),ZB.distanceToSquared(e))}distanceSqToSegment(e,t,r,n){JB.copy(e).add(t).multiplyScalar(.5),$B.copy(t).sub(e).normalize(),ez.copy(this.origin).sub(JB);let i,s,a,o,l=.5*e.distanceTo(t),c=-this.direction.dot($B),u=ez.dot(this.direction),h=-ez.dot($B),d=ez.lengthSq(),f=Math.abs(1-c*c);if(f>0)if(i=c*h-u,s=c*u-h,o=l*f,i>=0)if(s>=-o)if(s<=o){let e=1/f;i*=e,s*=e,a=i*(i+c*s+2*u)+s*(c*i+s+2*h)+d}else s=l,i=Math.max(0,-(c*s+u)),a=-i*i+s*(s+2*h)+d;else s=-l,i=Math.max(0,-(c*s+u)),a=-i*i+s*(s+2*h)+d;else s<=-o?(i=Math.max(0,-(-c*l+u)),s=i>0?-l:Math.min(Math.max(-l,-h),l),a=-i*i+s*(s+2*h)+d):s<=o?(i=0,s=Math.min(Math.max(-l,-h),l),a=s*(s+2*h)+d):(i=Math.max(0,-(c*l+u)),s=i>0?l:Math.min(Math.max(-l,-h),l),a=-i*i+s*(s+2*h)+d);else s=c>0?-l:l,i=Math.max(0,-(c*s+u)),a=-i*i+s*(s+2*h)+d;return r&&r.copy(this.direction).multiplyScalar(i).add(this.origin),n&&n.copy($B).multiplyScalar(s).add(JB),a}intersectSphere(e,t){ZB.subVectors(e.center,this.origin);let r=ZB.dot(this.direction),n=ZB.dot(ZB)-r*r,i=e.radius*e.radius;if(n>i)return null;let s=Math.sqrt(i-n),a=r-s,o=r+s;return a<0&&o<0?null:a<0?this.at(o,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){let r=this.distanceToPlane(e);return null===r?null:this.at(r,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,n,i,s,a,o,l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(r=(e.min.x-h.x)*l,n=(e.max.x-h.x)*l):(r=(e.max.x-h.x)*l,n=(e.min.x-h.x)*l),c>=0?(i=(e.min.y-h.y)*c,s=(e.max.y-h.y)*c):(i=(e.max.y-h.y)*c,s=(e.min.y-h.y)*c),r>s||i>n||((i>r||isNaN(r))&&(r=i),(s<n||isNaN(n))&&(n=s),u>=0?(a=(e.min.z-h.z)*u,o=(e.max.z-h.z)*u):(a=(e.max.z-h.z)*u,o=(e.min.z-h.z)*u),r>o||a>n)||((a>r||r!==r)&&(r=a),(o<n||n!==n)&&(n=o),n<0)?null:this.at(r>=0?r:n,t)}intersectsBox(e){return null!==this.intersectBox(e,ZB)}intersectTriangle(e,t,r,n,i){tz.subVectors(t,e),rz.subVectors(r,e),nz.crossVectors(tz,rz);let s,a=this.direction.dot(nz);if(a>0){if(n)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}ez.subVectors(this.origin,e);let o=s*this.direction.dot(rz.crossVectors(ez,rz));if(o<0)return null;let l=s*this.direction.dot(tz.cross(ez));if(l<0||o+l>a)return null;let c=-s*ez.dot(nz);return c<0?null:this.at(c/a,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}},sz=class{constructor(){sz.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,r,n,i,s,a,o,l,c,u,h,d,f,p,m){let g=this.elements;return g[0]=e,g[4]=t,g[8]=r,g[12]=n,g[1]=i,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new sz).fromArray(this.elements)}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){let t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,r=e.elements,n=1/az.setFromMatrixColumn(e,0).length(),i=1/az.setFromMatrixColumn(e,1).length(),s=1/az.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*i,t[5]=r[5]*i,t[6]=r[6]*i,t[7]=0,t[8]=r[8]*s,t[9]=r[9]*s,t[10]=r[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,r=e.x,n=e.y,i=e.z,s=Math.cos(r),a=Math.sin(r),o=Math.cos(n),l=Math.sin(n),c=Math.cos(i),u=Math.sin(i);if("XYZ"===e.order){let e=s*c,r=s*u,n=a*c,i=a*u;t[0]=o*c,t[4]=-o*u,t[8]=l,t[1]=r+n*l,t[5]=e-i*l,t[9]=-a*o,t[2]=i-e*l,t[6]=n+r*l,t[10]=s*o}else if("YXZ"===e.order){let e=o*c,r=o*u,n=l*c,i=l*u;t[0]=e+i*a,t[4]=n*a-r,t[8]=s*l,t[1]=s*u,t[5]=s*c,t[9]=-a,t[2]=r*a-n,t[6]=i+e*a,t[10]=s*o}else if("ZXY"===e.order){let e=o*c,r=o*u,n=l*c,i=l*u;t[0]=e-i*a,t[4]=-s*u,t[8]=n+r*a,t[1]=r+n*a,t[5]=s*c,t[9]=i-e*a,t[2]=-s*l,t[6]=a,t[10]=s*o}else if("ZYX"===e.order){let e=s*c,r=s*u,n=a*c,i=a*u;t[0]=o*c,t[4]=n*l-r,t[8]=e*l+i,t[1]=o*u,t[5]=i*l+e,t[9]=r*l-n,t[2]=-l,t[6]=a*o,t[10]=s*o}else if("YZX"===e.order){let e=s*o,r=s*l,n=a*o,i=a*l;t[0]=o*c,t[4]=i-e*u,t[8]=n*u+r,t[1]=u,t[5]=s*c,t[9]=-a*c,t[2]=-l*c,t[6]=r*u+n,t[10]=e-i*u}else if("XZY"===e.order){let e=s*o,r=s*l,n=a*o,i=a*l;t[0]=o*c,t[4]=-u,t[8]=l*c,t[1]=e*u+i,t[5]=s*c,t[9]=r*u-n,t[2]=n*u-r,t[6]=a*c,t[10]=i*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(lz,e,cz)}lookAt(e,t,r){let n=this.elements;return dz.subVectors(e,t),0===dz.lengthSq()&&(dz.z=1),dz.normalize(),uz.crossVectors(r,dz),0===uz.lengthSq()&&(1===Math.abs(r.z)?dz.x+=1e-4:dz.z+=1e-4,dz.normalize(),uz.crossVectors(r,dz)),uz.normalize(),hz.crossVectors(dz,uz),n[0]=uz.x,n[4]=hz.x,n[8]=dz.x,n[1]=uz.y,n[5]=hz.y,n[9]=dz.y,n[2]=uz.z,n[6]=hz.z,n[10]=dz.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,i=this.elements,s=r[0],a=r[4],o=r[8],l=r[12],c=r[1],u=r[5],h=r[9],d=r[13],f=r[2],p=r[6],m=r[10],g=r[14],v=r[3],y=r[7],b=r[11],w=r[15],x=n[0],S=n[4],_=n[8],C=n[12],E=n[1],A=n[5],M=n[9],T=n[13],P=n[2],k=n[6],D=n[10],I=n[14],O=n[3],R=n[7],L=n[11],N=n[15];return i[0]=s*x+a*E+o*P+l*O,i[4]=s*S+a*A+o*k+l*R,i[8]=s*_+a*M+o*D+l*L,i[12]=s*C+a*T+o*I+l*N,i[1]=c*x+u*E+h*P+d*O,i[5]=c*S+u*A+h*k+d*R,i[9]=c*_+u*M+h*D+d*L,i[13]=c*C+u*T+h*I+d*N,i[2]=f*x+p*E+m*P+g*O,i[6]=f*S+p*A+m*k+g*R,i[10]=f*_+p*M+m*D+g*L,i[14]=f*C+p*T+m*I+g*N,i[3]=v*x+y*E+b*P+w*O,i[7]=v*S+y*A+b*k+w*R,i[11]=v*_+y*M+b*D+w*L,i[15]=v*C+y*T+b*I+w*N,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],s=e[1],a=e[5],o=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+i*o*u-n*l*u-i*a*h+r*l*h+n*a*d-r*o*d)+e[7]*(+t*o*d-t*l*h+i*s*h-n*s*d+n*l*c-i*o*c)+e[11]*(+t*l*u-t*a*d-i*s*u+r*s*d+i*a*c-r*l*c)+e[15]*(-n*a*c-t*o*u+t*a*h+n*s*u-r*s*h+r*o*c)}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(e,t,r){let n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],f=e[12],p=e[13],m=e[14],g=e[15],v=u*m*l-p*h*l+p*o*d-a*m*d-u*o*g+a*h*g,y=f*h*l-c*m*l-f*o*d+s*m*d+c*o*g-s*h*g,b=c*p*l-f*u*l+f*a*d-s*p*d-c*a*g+s*u*g,w=f*u*o-c*p*o-f*a*h+s*p*h+c*a*m-s*u*m,x=t*v+r*y+n*b+i*w;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let S=1/x;return e[0]=v*S,e[1]=(p*h*i-u*m*i-p*n*d+r*m*d+u*n*g-r*h*g)*S,e[2]=(a*m*i-p*o*i+p*n*l-r*m*l-a*n*g+r*o*g)*S,e[3]=(u*o*i-a*h*i-u*n*l+r*h*l+a*n*d-r*o*d)*S,e[4]=y*S,e[5]=(c*m*i-f*h*i+f*n*d-t*m*d-c*n*g+t*h*g)*S,e[6]=(f*o*i-s*m*i-f*n*l+t*m*l+s*n*g-t*o*g)*S,e[7]=(s*h*i-c*o*i+c*n*l-t*h*l-s*n*d+t*o*d)*S,e[8]=b*S,e[9]=(f*u*i-c*p*i-f*r*d+t*p*d+c*r*g-t*u*g)*S,e[10]=(s*p*i-f*a*i+f*r*l-t*p*l-s*r*g+t*a*g)*S,e[11]=(c*a*i-s*u*i-c*r*l+t*u*l+s*r*d-t*a*d)*S,e[12]=w*S,e[13]=(c*p*n-f*u*n+f*r*h-t*p*h-c*r*m+t*u*m)*S,e[14]=(f*a*n-s*p*n-f*r*o+t*p*o+s*r*m-t*a*m)*S,e[15]=(s*u*n-c*a*n+c*r*o-t*u*o-s*r*h+t*a*h)*S,this}scale(e){let t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let r=Math.cos(t),n=Math.sin(t),i=1-r,s=e.x,a=e.y,o=e.z,l=i*s,c=i*a;return this.set(l*s+r,l*a-n*o,l*o+n*a,0,l*a+n*o,c*a+r,c*o-n*s,0,l*o-n*a,c*o+n*s,i*o*o+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,n,i,s){return this.set(1,r,i,0,e,1,s,0,t,n,1,0,0,0,0,1),this}compose(e,t,r){let n=this.elements,i=t._x,s=t._y,a=t._z,o=t._w,l=i+i,c=s+s,u=a+a,h=i*l,d=i*c,f=i*u,p=s*c,m=s*u,g=a*u,v=o*l,y=o*c,b=o*u,w=r.x,x=r.y,S=r.z;return n[0]=(1-(p+g))*w,n[1]=(d+b)*w,n[2]=(f-y)*w,n[3]=0,n[4]=(d-b)*x,n[5]=(1-(h+g))*x,n[6]=(m+v)*x,n[7]=0,n[8]=(f+y)*S,n[9]=(m-v)*S,n[10]=(1-(h+p))*S,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){let n=this.elements,i=az.set(n[0],n[1],n[2]).length(),s=az.set(n[4],n[5],n[6]).length(),a=az.set(n[8],n[9],n[10]).length();this.determinant()<0&&(i=-i),e.x=n[12],e.y=n[13],e.z=n[14],oz.copy(this);let o=1/i,l=1/s,c=1/a;return oz.elements[0]*=o,oz.elements[1]*=o,oz.elements[2]*=o,oz.elements[4]*=l,oz.elements[5]*=l,oz.elements[6]*=l,oz.elements[8]*=c,oz.elements[9]*=c,oz.elements[10]*=c,t.setFromRotationMatrix(oz),r.x=i,r.y=s,r.z=a,this}makePerspective(e,t,r,n,i,s){let a=this.elements,o=2*i/(t-e),l=2*i/(r-n),c=(t+e)/(t-e),u=(r+n)/(r-n),h=-(s+i)/(s-i),d=-2*s*i/(s-i);return a[0]=o,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,r,n,i,s){let a=this.elements,o=1/(t-e),l=1/(r-n),c=1/(s-i),u=(t+e)*o,h=(r+n)*l,d=(s+i)*c;return a[0]=2*o,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){let t=this.elements,r=e.elements;for(let n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}},az=new PB,oz=new sz,lz=new PB(0,0,0),cz=new PB(1,1,1),uz=new PB,hz=new PB,dz=new PB,fz=new sz,pz=new TB,mz=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:mz.DEFAULT_ORDER;this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e.elements,i=n[0],s=n[4],a=n[8],o=n[1],l=n[5],c=n[9],u=n[2],h=n[6],d=n[10];switch(t){case"XYZ":this._y=Math.asin(GN(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-GN(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(GN(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,i));break;case"ZYX":this._y=Math.asin(-GN(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(o,i)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(GN(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-GN(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(a,i)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===r&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return fz.makeRotationFromQuaternion(e),this.setFromRotationMatrix(fz,t,r)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return pz.setFromEuler(this),this.setFromQuaternion(pz,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};mz.DEFAULT_ORDER="XYZ";var gz=class{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return 0!==(this.mask&1<<e)}},vz=0,yz=new PB,bz=new TB,wz=new sz,xz=new PB,Sz=new PB,_z=new PB,Cz=new TB,Ez=new PB(1,0,0),Az=new PB(0,1,0),Mz=new PB(0,0,1),Tz={type:"added"},Pz={type:"removed"},kz=class extends FN{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:vz++}),this.uuid=WN(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=kz.DEFAULT_UP.clone();let e=new PB,t=new mz,r=new TB,n=new PB(1,1,1);t._onChange((function(){r.setFromEuler(t,!1)})),r._onChange((function(){t.setFromQuaternion(r,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new sz},normalMatrix:{value:new tB}}),this.matrix=new sz,this.matrixWorld=new sz,this.matrixAutoUpdate=kz.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=kz.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new gz,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return bz.setFromAxisAngle(e,t),this.quaternion.multiply(bz),this}rotateOnWorldAxis(e,t){return bz.setFromAxisAngle(e,t),this.quaternion.premultiply(bz),this}rotateX(e){return this.rotateOnAxis(Ez,e)}rotateY(e){return this.rotateOnAxis(Az,e)}rotateZ(e){return this.rotateOnAxis(Mz,e)}translateOnAxis(e,t){return yz.copy(e).applyQuaternion(this.quaternion),this.position.add(yz.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Ez,e)}translateY(e){return this.translateOnAxis(Az,e)}translateZ(e){return this.translateOnAxis(Mz,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(wz.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?xz.copy(e):xz.set(e,t,r);let n=this.parent;this.updateWorldMatrix(!0,!1),Sz.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?wz.lookAt(Sz,xz,this.up):wz.lookAt(xz,Sz,this.up),this.quaternion.setFromRotationMatrix(wz),n&&(wz.extractRotation(n.matrixWorld),bz.setFromRotationMatrix(wz),this.quaternion.premultiply(bz.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Tz)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}let t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Pz)),this}removeFromParent(){let e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent(Pz)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),wz.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),wz.multiply(e.parent.matrixWorld)),e.applyMatrix4(wz),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,n=this.children.length;r<n;r++){let n=this.children[r].getObjectByProperty(e,t);if(void 0!==n)return n}}getObjectsByProperty(e,t){let r=[];this[e]===t&&r.push(this);for(let n=0,i=this.children.length;n<i;n++){let i=this.children[n].getObjectsByProperty(e,t);i.length>0&&(r=r.concat(i))}return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Sz,e,_z),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Sz,Cz,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}traverseAncestors(e){let t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let r=0,n=t.length;r<n;r++){let n=t[r];(!0===n.matrixWorldAutoUpdate||!0===e)&&n.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let r=this.parent;if(!0===e&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){let e=this.children;for(let t=0,r=e.length;t<r;t++){let r=e[t];!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=void 0===e||"string"==typeof e,r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let n={};function i(t,r){return void 0===t[r.uuid]&&(t[r.uuid]=r.toJSON(e)),r.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(n.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=i(e.geometries,this.geometry);let t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){let r=t.shapes;if(Array.isArray(r))for(let t=0,n=r.length;t<n;t++){let n=r[t];i(e.shapes,n)}else i(e.shapes,r)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){let t=[];for(let r=0,n=this.material.length;r<n;r++)t.push(i(e.materials,this.material[r]));n.material=t}else n.material=i(e.materials,this.material);if(this.children.length>0){n.children=[];for(let t=0;t<this.children.length;t++)n.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let t=0;t<this.animations.length;t++){let r=this.animations[t];n.animations.push(i(e.animations,r))}}if(t){let t=s(e.geometries),n=s(e.materials),i=s(e.textures),a=s(e.images),o=s(e.shapes),l=s(e.skeletons),c=s(e.animations),u=s(e.nodes);t.length>0&&(r.geometries=t),n.length>0&&(r.materials=n),i.length>0&&(r.textures=i),a.length>0&&(r.images=a),o.length>0&&(r.shapes=o),l.length>0&&(r.skeletons=l),c.length>0&&(r.animations=c),u.length>0&&(r.nodes=u)}return r.object=n,r;function s(e){let t=[];for(let r in e){let n=e[r];delete n.metadata,t.push(n)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let r=0;r<e.children.length;r++){let t=e.children[r];this.add(t.clone())}return this}};kz.DEFAULT_UP=new PB(0,1,0),kz.DEFAULT_MATRIX_AUTO_UPDATE=!0,kz.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var Dz=new PB,Iz=new PB,Oz=new PB,Rz=new PB,Lz=new PB,Nz=new PB,Bz=new PB,zz=new PB,Fz=new PB,jz=new PB,Uz=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new PB,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PB,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new PB;this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,n){n.subVectors(r,t),Dz.subVectors(e,t),n.cross(Dz);let i=n.lengthSq();return i>0?n.multiplyScalar(1/Math.sqrt(i)):n.set(0,0,0)}static getBarycoord(e,t,r,n,i){Dz.subVectors(n,t),Iz.subVectors(r,t),Oz.subVectors(e,t);let s=Dz.dot(Dz),a=Dz.dot(Iz),o=Dz.dot(Oz),l=Iz.dot(Iz),c=Iz.dot(Oz),u=s*l-a*a;if(0===u)return i.set(-2,-1,-1);let h=1/u,d=(l*o-a*c)*h,f=(s*c-a*o)*h;return i.set(1-d-f,f,d)}static containsPoint(e,t,r,n){return this.getBarycoord(e,t,r,n,Rz),Rz.x>=0&&Rz.y>=0&&Rz.x+Rz.y<=1}static getUV(e,t,r,n,i,s,a,o){return this.getBarycoord(e,t,r,n,Rz),o.set(0,0),o.addScaledVector(i,Rz.x),o.addScaledVector(s,Rz.y),o.addScaledVector(a,Rz.z),o}static isFrontFacing(e,t,r,n){return Dz.subVectors(r,t),Iz.subVectors(e,t),Dz.cross(Iz).dot(n)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,r,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Dz.subVectors(this.c,this.b),Iz.subVectors(this.a,this.b),.5*Dz.cross(Iz).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Uz.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Uz.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,n,i){return Uz.getUV(e,this.a,this.b,this.c,t,r,n,i)}containsPoint(e){return Uz.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Uz.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let r,n,i=this.a,s=this.b,a=this.c;Lz.subVectors(s,i),Nz.subVectors(a,i),zz.subVectors(e,i);let o=Lz.dot(zz),l=Nz.dot(zz);if(o<=0&&l<=0)return t.copy(i);Fz.subVectors(e,s);let c=Lz.dot(Fz),u=Nz.dot(Fz);if(c>=0&&u<=c)return t.copy(s);let h=o*u-c*l;if(h<=0&&o>=0&&c<=0)return r=o/(o-c),t.copy(i).addScaledVector(Lz,r);jz.subVectors(e,a);let d=Lz.dot(jz),f=Nz.dot(jz);if(f>=0&&d<=f)return t.copy(a);let p=d*l-o*f;if(p<=0&&l>=0&&f<=0)return n=l/(l-f),t.copy(i).addScaledVector(Nz,n);let m=c*f-d*u;if(m<=0&&u-c>=0&&d-f>=0)return Bz.subVectors(a,s),n=(u-c)/(u-c+(d-f)),t.copy(s).addScaledVector(Bz,n);let g=1/(m+p+h);return r=p*g,n=h*g,t.copy(i).addScaledVector(Lz,r).addScaledVector(Nz,n)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},Vz=0,Hz=class extends FN{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Vz++}),this.uuid=WN(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=LL,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=LN,this.stencilZFail=LN,this.stencilZPass=LN,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(let t in e){let r=e[t];if(void 0===r){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}let n=this[t];void 0!==n?n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]=r:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){let t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});let r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(e){let t=[];for(let r in e){let n=e[r];delete n.metadata,t.push(n)}return t}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(r.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(r.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),0!==this.side&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(r.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(r.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=this.flatShading),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),!1===this.fog&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData),t){let t=n(e.textures),i=n(e.images);t.length>0&&(r.textures=t),i.length>0&&(r.images=i)}return r}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,r=null;if(null!==t){let e=t.length;r=new Array(e);for(let n=0;n!==e;++n)r[n]=t[n].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}},Wz=class extends Hz{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new vB(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},Gz=new PB,qz=new eB,Xz=class{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=r,this.usage=NN,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let n=0,i=this.itemSize;n<i;n++)this.array[e+n]=t.array[r+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,r=this.count;t<r;t++)qz.fromBufferAttribute(this,t),qz.applyMatrix3(e),this.setXY(t,qz.x,qz.y);else if(3===this.itemSize)for(let t=0,r=this.count;t<r;t++)Gz.fromBufferAttribute(this,t),Gz.applyMatrix3(e),this.setXYZ(t,Gz.x,Gz.y,Gz.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Gz.fromBufferAttribute(this,t),Gz.applyMatrix4(e),this.setXYZ(t,Gz.x,Gz.y,Gz.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Gz.fromBufferAttribute(this,t),Gz.applyNormalMatrix(e),this.setXYZ(t,Gz.x,Gz.y,Gz.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Gz.fromBufferAttribute(this,t),Gz.transformDirection(e),this.setXYZ(t,Gz.x,Gz.y,Gz.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ZN(t,this.array)),t}setX(e,t){return this.normalized&&(t=JN(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ZN(t,this.array)),t}setY(e,t){return this.normalized&&(t=JN(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ZN(t,this.array)),t}setZ(e,t){return this.normalized&&(t=JN(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ZN(t,this.array)),t}setW(e,t){return this.normalized&&(t=JN(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=JN(t,this.array),r=JN(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,n){return e*=this.itemSize,this.normalized&&(t=JN(t,this.array),r=JN(r,this.array),n=JN(n,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this}setXYZW(e,t,r,n,i){return e*=this.itemSize,this.normalized&&(t=JN(t,this.array),r=JN(r,this.array),n=JN(n,this.array),i=JN(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==NN&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},Yz=class extends Xz{constructor(e,t,r){super(new Uint16Array(e),t,r)}},Kz=class extends Xz{constructor(e,t,r){super(new Uint32Array(e),t,r)}},Qz=class extends Xz{constructor(e,t,r){super(new Float32Array(e),t,r)}},Zz=0,Jz=new sz,$z=new kz,eF=new PB,tF=new IB,rF=new IB,nF=new PB,iF=class extends FN{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Zz++}),this.uuid=WN(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(nB(e)?Kz:Yz)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);let r=this.attributes.normal;if(void 0!==r){let t=(new tB).getNormalMatrix(e);r.applyNormalMatrix(t),r.needsUpdate=!0}let n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(e),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Jz.makeRotationFromQuaternion(e),this.applyMatrix4(Jz),this}rotateX(e){return Jz.makeRotationX(e),this.applyMatrix4(Jz),this}rotateY(e){return Jz.makeRotationY(e),this.applyMatrix4(Jz),this}rotateZ(e){return Jz.makeRotationZ(e),this.applyMatrix4(Jz),this}translate(e,t,r){return Jz.makeTranslation(e,t,r),this.applyMatrix4(Jz),this}scale(e,t,r){return Jz.makeScale(e,t,r),this.applyMatrix4(Jz),this}lookAt(e){return $z.lookAt(e),$z.updateMatrix(),this.applyMatrix4($z.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(eF).negate(),this.translate(eF.x,eF.y,eF.z),this}setFromPoints(e){let t=[];for(let r=0,n=e.length;r<n;r++){let n=e[r];t.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new Qz(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new IB);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new PB(-1/0,-1/0,-1/0),new PB(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,n=t.length;r<n;r++){let e=t[r];tF.setFromBufferAttribute(e),this.morphTargetsRelative?(nF.addVectors(this.boundingBox.min,tF.min),this.boundingBox.expandByPoint(nF),nF.addVectors(this.boundingBox.max,tF.max),this.boundingBox.expandByPoint(nF)):(this.boundingBox.expandByPoint(tF.min),this.boundingBox.expandByPoint(tF.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new QB);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new PB,1/0);if(e){let r=this.boundingSphere.center;if(tF.setFromBufferAttribute(e),t)for(let e=0,i=t.length;e<i;e++){let r=t[e];rF.setFromBufferAttribute(r),this.morphTargetsRelative?(nF.addVectors(tF.min,rF.min),tF.expandByPoint(nF),nF.addVectors(tF.max,rF.max),tF.expandByPoint(nF)):(tF.expandByPoint(rF.min),tF.expandByPoint(rF.max))}tF.getCenter(r);let n=0;for(let t=0,i=e.count;t<i;t++)nF.fromBufferAttribute(e,t),n=Math.max(n,r.distanceToSquared(nF));if(t)for(let i=0,s=t.length;i<s;i++){let s=t[i],a=this.morphTargetsRelative;for(let t=0,i=s.count;t<i;t++)nF.fromBufferAttribute(s,t),a&&(eF.fromBufferAttribute(e,t),nF.add(eF)),n=Math.max(n,r.distanceToSquared(nF))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");let r=e.array,n=t.position.array,i=t.normal.array,s=t.uv.array,a=n.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Xz(new Float32Array(4*a),4));let o=this.getAttribute("tangent").array,l=[],c=[];for(let E=0;E<a;E++)l[E]=new PB,c[E]=new PB;let u=new PB,h=new PB,d=new PB,f=new eB,p=new eB,m=new eB,g=new PB,v=new PB;function y(e,t,r){u.fromArray(n,3*e),h.fromArray(n,3*t),d.fromArray(n,3*r),f.fromArray(s,2*e),p.fromArray(s,2*t),m.fromArray(s,2*r),h.sub(u),d.sub(u),p.sub(f),m.sub(f);let i=1/(p.x*m.y-m.x*p.y);!isFinite(i)||(g.copy(h).multiplyScalar(m.y).addScaledVector(d,-p.y).multiplyScalar(i),v.copy(d).multiplyScalar(p.x).addScaledVector(h,-m.x).multiplyScalar(i),l[e].add(g),l[t].add(g),l[r].add(g),c[e].add(v),c[t].add(v),c[r].add(v))}let b=this.groups;0===b.length&&(b=[{start:0,count:r.length}]);for(let E=0,A=b.length;E<A;++E){let e=b[E],t=e.start;for(let n=t,i=t+e.count;n<i;n+=3)y(r[n+0],r[n+1],r[n+2])}let w=new PB,x=new PB,S=new PB,_=new PB;function C(e){S.fromArray(i,3*e),_.copy(S);let t=l[e];w.copy(t),w.sub(S.multiplyScalar(S.dot(t))).normalize(),x.crossVectors(_,t);let r=x.dot(c[e])<0?-1:1;o[4*e]=w.x,o[4*e+1]=w.y,o[4*e+2]=w.z,o[4*e+3]=r}for(let E=0,A=b.length;E<A;++E){let e=b[E],t=e.start;for(let n=t,i=t+e.count;n<i;n+=3)C(r[n+0]),C(r[n+1]),C(r[n+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(void 0!==t){let r=this.getAttribute("normal");if(void 0===r)r=new Xz(new Float32Array(3*t.count),3),this.setAttribute("normal",r);else for(let e=0,t=r.count;e<t;e++)r.setXYZ(e,0,0,0);let n=new PB,i=new PB,s=new PB,a=new PB,o=new PB,l=new PB,c=new PB,u=new PB;if(e)for(let h=0,d=e.count;h<d;h+=3){let d=e.getX(h+0),f=e.getX(h+1),p=e.getX(h+2);n.fromBufferAttribute(t,d),i.fromBufferAttribute(t,f),s.fromBufferAttribute(t,p),c.subVectors(s,i),u.subVectors(n,i),c.cross(u),a.fromBufferAttribute(r,d),o.fromBufferAttribute(r,f),l.fromBufferAttribute(r,p),a.add(c),o.add(c),l.add(c),r.setXYZ(d,a.x,a.y,a.z),r.setXYZ(f,o.x,o.y,o.z),r.setXYZ(p,l.x,l.y,l.z)}else for(let e=0,h=t.count;e<h;e+=3)n.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),s.fromBufferAttribute(t,e+2),c.subVectors(s,i),u.subVectors(n,i),c.cross(u),r.setXYZ(e+0,c.x,c.y,c.z),r.setXYZ(e+1,c.x,c.y,c.z),r.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)nF.fromBufferAttribute(e,t),nF.normalize(),e.setXYZ(t,nF.x,nF.y,nF.z)}toNonIndexed(){function e(e,t){let r=e.array,n=e.itemSize,i=e.normalized,s=new r.constructor(t.length*n),a=0,o=0;for(let l=0,c=t.length;l<c;l++){a=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*n;for(let e=0;e<n;e++)s[o++]=r[a++]}return new Xz(s,n,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new iF,r=this.index.array,n=this.attributes;for(let a in n){let i=e(n[a],r);t.setAttribute(a,i)}let i=this.morphAttributes;for(let a in i){let n=[],s=i[a];for(let t=0,i=s.length;t<i;t++){let i=e(s[t],r);n.push(i)}t.morphAttributes[a]=n}t.morphTargetsRelative=this.morphTargetsRelative;let s=this.groups;for(let a=0,o=s.length;a<o;a++){let e=s[a];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){let t=this.parameters;for(let r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};let t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let r=this.attributes;for(let o in r){let t=r[o];e.data.attributes[o]=t.toJSON(e.data)}let n={},i=!1;for(let o in this.morphAttributes){let t=this.morphAttributes[o],r=[];for(let n=0,i=t.length;n<i;n++){let i=t[n];r.push(i.toJSON(e.data))}r.length>0&&(n[o]=r,i=!0)}i&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);let s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));let a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let r=e.index;null!==r&&this.setIndex(r.clone(t));let n=e.attributes;for(let l in n){let e=n[l];this.setAttribute(l,e.clone(t))}let i=e.morphAttributes;for(let l in i){let e=[],r=i[l];for(let n=0,i=r.length;n<i;n++)e.push(r[n].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;let s=e.groups;for(let l=0,c=s.length;l<c;l++){let e=s[l];this.addGroup(e.start,e.count,e.materialIndex)}let a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());let o=e.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},sF=new sz,aF=new iz,oF=new QB,lF=new PB,cF=new PB,uF=new PB,hF=new PB,dF=new PB,fF=new eB,pF=new eB,mF=new eB,gF=new PB,vF=new PB,yF=class extends kz{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new iF,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wz;super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){let t=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){let r=this.geometry,n=r.attributes.position,i=r.morphAttributes.position,s=r.morphTargetsRelative;t.fromBufferAttribute(n,e);let a=this.morphTargetInfluences;if(i&&a){dF.set(0,0,0);for(let r=0,n=i.length;r<n;r++){let n=a[r],o=i[r];0!==n&&(hF.fromBufferAttribute(o,e),s?dF.addScaledVector(hF,n):dF.addScaledVector(hF.sub(t),n))}t.add(dF)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){let r=this.geometry,n=this.material,i=this.matrixWorld;if(void 0===n||(null===r.boundingSphere&&r.computeBoundingSphere(),oF.copy(r.boundingSphere),oF.applyMatrix4(i),!1===e.ray.intersectsSphere(oF))||(sF.copy(i).invert(),aF.copy(e.ray).applyMatrix4(sF),null!==r.boundingBox&&!1===aF.intersectsBox(r.boundingBox)))return;let s,a=r.index,o=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv2,u=r.groups,h=r.drawRange;if(null!==a)if(Array.isArray(n))for(let d=0,f=u.length;d<f;d++){let r=u[d],i=n[r.materialIndex];for(let n=Math.max(r.start,h.start),o=Math.min(a.count,Math.min(r.start+r.count,h.start+h.count));n<o;n+=3){let o=a.getX(n),u=a.getX(n+1),h=a.getX(n+2);s=bF(this,i,e,aF,l,c,o,u,h),s&&(s.faceIndex=Math.floor(n/3),s.face.materialIndex=r.materialIndex,t.push(s))}}else{for(let r=Math.max(0,h.start),i=Math.min(a.count,h.start+h.count);r<i;r+=3){let i=a.getX(r),o=a.getX(r+1),u=a.getX(r+2);s=bF(this,n,e,aF,l,c,i,o,u),s&&(s.faceIndex=Math.floor(r/3),t.push(s))}}else if(void 0!==o)if(Array.isArray(n))for(let d=0,f=u.length;d<f;d++){let r=u[d],i=n[r.materialIndex];for(let n=Math.max(r.start,h.start),a=Math.min(o.count,Math.min(r.start+r.count,h.start+h.count));n<a;n+=3){s=bF(this,i,e,aF,l,c,n,n+1,n+2),s&&(s.faceIndex=Math.floor(n/3),s.face.materialIndex=r.materialIndex,t.push(s))}}else{for(let r=Math.max(0,h.start),i=Math.min(o.count,h.start+h.count);r<i;r+=3){s=bF(this,n,e,aF,l,c,r,r+1,r+2),s&&(s.faceIndex=Math.floor(r/3),t.push(s))}}}};function bF(e,t,r,n,i,s,a,o,l){e.getVertexPosition(a,lF),e.getVertexPosition(o,cF),e.getVertexPosition(l,uF);let c=function(e,t,r,n,i,s,a,o){let l;if(l=1===t.side?n.intersectTriangle(a,s,i,!0,o):n.intersectTriangle(i,s,a,0===t.side,o),null===l)return null;vF.copy(o),vF.applyMatrix4(e.matrixWorld);let c=r.ray.origin.distanceTo(vF);return c<r.near||c>r.far?null:{distance:c,point:vF.clone(),object:e}}(e,t,r,n,lF,cF,uF,gF);if(c){i&&(fF.fromBufferAttribute(i,a),pF.fromBufferAttribute(i,o),mF.fromBufferAttribute(i,l),c.uv=Uz.getUV(gF,lF,cF,uF,fF,pF,mF,new eB)),s&&(fF.fromBufferAttribute(s,a),pF.fromBufferAttribute(s,o),mF.fromBufferAttribute(s,l),c.uv2=Uz.getUV(gF,lF,cF,uF,fF,pF,mF,new eB));let e={a:a,b:o,c:l,normal:new PB,materialIndex:0};Uz.getNormal(lF,cF,uF,e.normal),c.face=e}return c}var wF=class extends iF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:s};let a=this;n=Math.floor(n),i=Math.floor(i),s=Math.floor(s);let o=[],l=[],c=[],u=[],h=0,d=0;function f(e,t,r,n,i,s,f,p,m,g,v){let y=s/m,b=f/g,w=s/2,x=f/2,S=p/2,_=m+1,C=g+1,E=0,A=0,M=new PB;for(let a=0;a<C;a++){let s=a*b-x;for(let o=0;o<_;o++){let h=o*y-w;M[e]=h*n,M[t]=s*i,M[r]=S,l.push(M.x,M.y,M.z),M[e]=0,M[t]=0,M[r]=p>0?1:-1,c.push(M.x,M.y,M.z),u.push(o/m),u.push(1-a/g),E+=1}}for(let a=0;a<g;a++)for(let e=0;e<m;e++){let t=h+e+_*a,r=h+e+_*(a+1),n=h+(e+1)+_*(a+1),i=h+(e+1)+_*a;o.push(t,r,i),o.push(r,n,i),A+=6}a.addGroup(d,A,v),d+=A,h+=E}f("z","y","x",-1,-1,r,t,e,s,i,0),f("z","y","x",1,-1,r,t,-e,s,i,1),f("x","z","y",1,1,e,r,t,n,s,2),f("x","z","y",1,-1,e,r,-t,n,s,3),f("x","y","z",1,-1,e,t,r,n,i,4),f("x","y","z",-1,-1,e,t,-r,n,i,5),this.setIndex(o),this.setAttribute("position",new Qz(l,3)),this.setAttribute("normal",new Qz(c,3)),this.setAttribute("uv",new Qz(u,2))}static fromJSON(e){return new wF(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function xF(e){let t={};for(let r in e){t[r]={};for(let n in e[r]){let i=e[r][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?t[r][n]=i.clone():Array.isArray(i)?t[r][n]=i.slice():t[r][n]=i}}return t}function SF(e){let t={};for(let r=0;r<e.length;r++){let n=xF(e[r]);for(let e in n)t[e]=n[e]}return t}function _F(e){return null===e.getRenderTarget()&&e.outputEncoding===DN?ON:RN}var CF={clone:xF,merge:SF},EF=class extends Hz{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=xF(e.uniforms),this.uniformsGroups=function(e){let t=[];for(let r=0;r<e.length;r++)t.push(e[r].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let n in this.uniforms){let r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let r={};for(let n in this.extensions)!0===this.extensions[n]&&(r[n]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}},AF=class extends kz{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new sz,this.projectionMatrix=new sz,this.projectionMatrixInverse=new sz}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}},MF=class extends AF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=2*HN*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(.5*VN*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*HN*Math.atan(Math.tan(.5*VN*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,n,i,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(.5*VN*this.fov)/this.zoom,r=2*t,n=this.aspect*r,i=-.5*n,s=this.view;if(null!==this.view&&this.view.enabled){let e=s.fullWidth,a=s.fullHeight;i+=s.offsetX*n/e,t-=s.offsetY*r/a,n*=s.width/e,r*=s.height/a}let a=this.filmOffset;0!==a&&(i+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},TF=-90,PF=class extends kz{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r;let n=new MF(TF,1,e,t);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(1,0,0),this.add(n);let i=new MF(TF,1,e,t);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(-1,0,0),this.add(i);let s=new MF(TF,1,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);let a=new MF(TF,1,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);let o=new MF(TF,1,e,t);o.layers=this.layers,o.up.set(0,1,0),o.lookAt(0,0,1),this.add(o);let l=new MF(TF,1,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){null===this.parent&&this.updateMatrixWorld();let r=this.renderTarget,[n,i,s,a,o,l]=this.children,c=e.getRenderTarget(),u=e.toneMapping,h=e.xr.enabled;e.toneMapping=0,e.xr.enabled=!1;let d=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,n),e.setRenderTarget(r,1),e.render(t,i),e.setRenderTarget(r,2),e.render(t,s),e.setRenderTarget(r,3),e.render(t,a),e.setRenderTarget(r,4),e.render(t,o),r.texture.generateMipmaps=d,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=u,e.xr.enabled=h,r.texture.needsPMREMUpdate=!0}},kF=class extends _B{constructor(e,t,r,n,i,s,a,o,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:KL,r,n,i,s,a,o,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},DF=class extends EB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,e,t),this.isWebGLCubeRenderTarget=!0;let r={width:e,height:e,depth:1},n=[r,r,r,r,r,r];this.texture=new kF(n,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:iN}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={tEquirect:{value:null}},n="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new wF(5,5,5),a=new EF({name:"CubemapFromEquirect",uniforms:xF(r),vertexShader:n,fragmentShader:i,side:1,blending:0});a.uniforms.tEquirect.value=t;let o=new yF(s,a),l=t.minFilter;return t.minFilter===aN&&(t.minFilter=iN),new PF(1,10,this).update(e,o),t.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,r,n){let i=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,r,n);e.setRenderTarget(i)}},IF=new PB,OF=new PB,RF=new tB,LF=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new PB(1,0,0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let n=IF.subVectors(r,t).cross(OF.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let r=e.delta(IF),n=this.normal.dot(r);if(0===n)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;let i=-(e.start.dot(this.normal)+this.constant)/n;return i<0||i>1?null:t.copy(r).multiplyScalar(i).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||RF.getNormalMatrix(e),n=this.coplanarPoint(IF).applyMatrix4(e),i=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}},NF=new QB,BF=new PB,zF=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new LF,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new LF,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new LF,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new LF,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new LF,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new LF;this.planes=[e,t,r,n,i,s]}set(e,t,r,n,i,s){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(n),a[4].copy(i),a[5].copy(s),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){let t=this.planes,r=e.elements,n=r[0],i=r[1],s=r[2],a=r[3],o=r[4],l=r[5],c=r[6],u=r[7],h=r[8],d=r[9],f=r[10],p=r[11],m=r[12],g=r[13],v=r[14],y=r[15];return t[0].setComponents(a-n,u-o,p-h,y-m).normalize(),t[1].setComponents(a+n,u+o,p+h,y+m).normalize(),t[2].setComponents(a+i,u+l,p+d,y+g).normalize(),t[3].setComponents(a-i,u-l,p-d,y-g).normalize(),t[4].setComponents(a-s,u-c,p-f,y-v).normalize(),t[5].setComponents(a+s,u+c,p+f,y+v).normalize(),this}intersectsObject(e){let t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),NF.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(NF)}intersectsSprite(e){return NF.center.set(0,0,0),NF.radius=.7071067811865476,NF.applyMatrix4(e.matrixWorld),this.intersectsSphere(NF)}intersectsSphere(e){let t=this.planes,r=e.center,n=-e.radius;for(let i=0;i<6;i++)if(t[i].distanceToPoint(r)<n)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let n=t[r];if(BF.x=n.normal.x>0?e.max.x:e.min.x,BF.y=n.normal.y>0?e.max.y:e.min.y,BF.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(BF)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}};function FF(){let e=null,t=!1,r=null,n=null;function i(t,s){r(t,s),n=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==r&&(n=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(e){r=e},setContext:function(t){e=t}}}function jF(e,t){let r=t.isWebGL2,n=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),n.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);let r=n.get(t);r&&(e.deleteBuffer(r.buffer),n.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){let e=n.get(t);return void((!e||e.version<t.version)&&n.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);let s=n.get(t);void 0===s?n.set(t,function(t,n){let i,s=t.array,a=t.usage,o=e.createBuffer();if(e.bindBuffer(n,o),e.bufferData(n,s,a),t.onUploadCallback(),s instanceof Float32Array)i=5126;else if(s instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!r)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");i=5131}else i=5123;else if(s instanceof Int16Array)i=5122;else if(s instanceof Uint32Array)i=5125;else if(s instanceof Int32Array)i=5124;else if(s instanceof Int8Array)i=5120;else if(s instanceof Uint8Array)i=5121;else{if(!(s instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+s);i=5121}return{buffer:o,type:i,bytesPerElement:s.BYTES_PER_ELEMENT,version:t.version}}(t,i)):s.version<t.version&&(function(t,n,i){let s=n.array,a=n.updateRange;e.bindBuffer(i,t),-1===a.count?e.bufferSubData(i,0,s):(r?e.bufferSubData(i,a.offset*s.BYTES_PER_ELEMENT,s,a.offset,a.count):e.bufferSubData(i,a.offset*s.BYTES_PER_ELEMENT,s.subarray(a.offset,a.offset+a.count)),a.count=-1),n.onUploadCallback()}(s.buffer,t,i),s.version=t.version)}}}var UF=class extends iF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};let i=e/2,s=t/2,a=Math.floor(r),o=Math.floor(n),l=a+1,c=o+1,u=e/a,h=t/o,d=[],f=[],p=[],m=[];for(let g=0;g<c;g++){let e=g*h-s;for(let t=0;t<l;t++){let r=t*u-i;f.push(r,-e,0),p.push(0,0,1),m.push(t/a),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let e=0;e<a;e++){let t=e+l*g,r=e+l*(g+1),n=e+1+l*(g+1),i=e+1+l*g;d.push(t,r,i),d.push(r,n,i)}this.setIndex(d),this.setAttribute("position",new Qz(f,3)),this.setAttribute("normal",new Qz(p,3)),this.setAttribute("uv",new Qz(m,2))}static fromJSON(e){return new UF(e.width,e.height,e.widthSegments,e.heightSegments)}},VF={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},HF={common:{diffuse:{value:new vB(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new tB},uv2Transform:{value:new tB},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new eB(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new vB(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new vB(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new tB}},sprite:{diffuse:{value:new vB(16777215)},opacity:{value:1},center:{value:new eB(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new tB}}},WF={basic:{uniforms:SF([HF.common,HF.specularmap,HF.envmap,HF.aomap,HF.lightmap,HF.fog]),vertexShader:VF.meshbasic_vert,fragmentShader:VF.meshbasic_frag},lambert:{uniforms:SF([HF.common,HF.specularmap,HF.envmap,HF.aomap,HF.lightmap,HF.emissivemap,HF.bumpmap,HF.normalmap,HF.displacementmap,HF.fog,HF.lights,{emissive:{value:new vB(0)}}]),vertexShader:VF.meshlambert_vert,fragmentShader:VF.meshlambert_frag},phong:{uniforms:SF([HF.common,HF.specularmap,HF.envmap,HF.aomap,HF.lightmap,HF.emissivemap,HF.bumpmap,HF.normalmap,HF.displacementmap,HF.fog,HF.lights,{emissive:{value:new vB(0)},specular:{value:new vB(1118481)},shininess:{value:30}}]),vertexShader:VF.meshphong_vert,fragmentShader:VF.meshphong_frag},standard:{uniforms:SF([HF.common,HF.envmap,HF.aomap,HF.lightmap,HF.emissivemap,HF.bumpmap,HF.normalmap,HF.displacementmap,HF.roughnessmap,HF.metalnessmap,HF.fog,HF.lights,{emissive:{value:new vB(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:VF.meshphysical_vert,fragmentShader:VF.meshphysical_frag},toon:{uniforms:SF([HF.common,HF.aomap,HF.lightmap,HF.emissivemap,HF.bumpmap,HF.normalmap,HF.displacementmap,HF.gradientmap,HF.fog,HF.lights,{emissive:{value:new vB(0)}}]),vertexShader:VF.meshtoon_vert,fragmentShader:VF.meshtoon_frag},matcap:{uniforms:SF([HF.common,HF.bumpmap,HF.normalmap,HF.displacementmap,HF.fog,{matcap:{value:null}}]),vertexShader:VF.meshmatcap_vert,fragmentShader:VF.meshmatcap_frag},points:{uniforms:SF([HF.points,HF.fog]),vertexShader:VF.points_vert,fragmentShader:VF.points_frag},dashed:{uniforms:SF([HF.common,HF.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:VF.linedashed_vert,fragmentShader:VF.linedashed_frag},depth:{uniforms:SF([HF.common,HF.displacementmap]),vertexShader:VF.depth_vert,fragmentShader:VF.depth_frag},normal:{uniforms:SF([HF.common,HF.bumpmap,HF.normalmap,HF.displacementmap,{opacity:{value:1}}]),vertexShader:VF.meshnormal_vert,fragmentShader:VF.meshnormal_frag},sprite:{uniforms:SF([HF.sprite,HF.fog]),vertexShader:VF.sprite_vert,fragmentShader:VF.sprite_frag},background:{uniforms:{uvTransform:{value:new tB},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:VF.background_vert,fragmentShader:VF.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:VF.backgroundCube_vert,fragmentShader:VF.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:VF.cube_vert,fragmentShader:VF.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:VF.equirect_vert,fragmentShader:VF.equirect_frag},distanceRGBA:{uniforms:SF([HF.common,HF.displacementmap,{referencePosition:{value:new PB},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:VF.distanceRGBA_vert,fragmentShader:VF.distanceRGBA_frag},shadow:{uniforms:SF([HF.lights,HF.fog,{color:{value:new vB(0)},opacity:{value:1}}]),vertexShader:VF.shadow_vert,fragmentShader:VF.shadow_frag}};WF.physical={uniforms:SF([WF.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new eB(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new vB(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new eB},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new vB(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new vB(1,1,1)},specularColorMap:{value:null}}]),vertexShader:VF.meshphysical_vert,fragmentShader:VF.meshphysical_frag};var GF={r:0,b:0,g:0};function qF(e,t,r,n,i,s,a){let o,l,c=new vB(0),u=!0===s?0:1,h=null,d=0,f=null;function p(t,r){t.getRGB(GF,_F(e)),n.buffers.color.setClear(GF.r,GF.g,GF.b,r,a)}return{getClearColor:function(){return c},setClearColor:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;c.set(e),u=t,p(c,u)},getClearAlpha:function(){return u},setClearAlpha:function(e){u=e,p(c,u)},render:function(n,s){let a=!1,m=!0===s.isScene?s.background:null;m&&m.isTexture&&(m=(s.backgroundBlurriness>0?r:t).get(m));let g=e.xr,v=g.getSession&&g.getSession();v&&"additive"===v.environmentBlendMode&&(m=null),null===m?p(c,u):m&&m.isColor&&(p(m,1),a=!0),(e.autoClear||a)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),m&&(m.isCubeTexture||m.mapping===ZL)?(void 0===l&&(l=new yF(new wF(1,1,1),new EF({name:"BackgroundCubeMaterial",uniforms:xF(WF.backgroundCube.uniforms),vertexShader:WF.backgroundCube.vertexShader,fragmentShader:WF.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(l)),l.material.uniforms.envMap.value=m,l.material.uniforms.flipEnvMap.value=m.isCubeTexture&&!1===m.isRenderTargetTexture?-1:1,l.material.uniforms.backgroundBlurriness.value=s.backgroundBlurriness,l.material.uniforms.backgroundIntensity.value=s.backgroundIntensity,l.material.toneMapped=m.encoding!==DN,(h!==m||d!==m.version||f!==e.toneMapping)&&(l.material.needsUpdate=!0,h=m,d=m.version,f=e.toneMapping),l.layers.enableAll(),n.unshift(l,l.geometry,l.material,0,0,null)):m&&m.isTexture&&(void 0===o&&(o=new yF(new UF(2,2),new EF({name:"BackgroundMaterial",uniforms:xF(WF.background.uniforms),vertexShader:WF.background.vertexShader,fragmentShader:WF.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),o.geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(o)),o.material.uniforms.t2D.value=m,o.material.uniforms.backgroundIntensity.value=s.backgroundIntensity,o.material.toneMapped=m.encoding!==DN,!0===m.matrixAutoUpdate&&m.updateMatrix(),o.material.uniforms.uvTransform.value.copy(m.matrix),(h!==m||d!==m.version||f!==e.toneMapping)&&(o.material.needsUpdate=!0,h=m,d=m.version,f=e.toneMapping),o.layers.enableAll(),n.unshift(o,o.geometry,o.material,0,0,null))}}}function XF(e,t,r,n){let i=e.getParameter(34921),s=n.isWebGL2?null:t.get("OES_vertex_array_object"),a=n.isWebGL2||null!==s,o={},l=f(null),c=l,u=!1;function h(t){return n.isWebGL2?e.bindVertexArray(t):s.bindVertexArrayOES(t)}function d(t){return n.isWebGL2?e.deleteVertexArray(t):s.deleteVertexArrayOES(t)}function f(e){let t=[],r=[],n=[];for(let s=0;s<i;s++)t[s]=0,r[s]=0,n[s]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:n,object:e,attributes:{},index:null}}function p(){let e=c.newAttributes;for(let t=0,r=e.length;t<r;t++)e[t]=0}function m(e){g(e,0)}function g(r,i){let s=c.newAttributes,a=c.enabledAttributes,o=c.attributeDivisors;s[r]=1,0===a[r]&&(e.enableVertexAttribArray(r),a[r]=1),o[r]!==i&&((n.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](r,i),o[r]=i)}function v(){let t=c.newAttributes,r=c.enabledAttributes;for(let n=0,i=r.length;n<i;n++)r[n]!==t[n]&&(e.disableVertexAttribArray(n),r[n]=0)}function y(t,r,i,s,a,o){!0!==n.isWebGL2||5124!==i&&5125!==i?e.vertexAttribPointer(t,r,i,s,a,o):e.vertexAttribIPointer(t,r,i,a,o)}function b(){w(),u=!0,c!==l&&(c=l,h(c.object))}function w(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,d,b,w){let x=!1;if(a){let t=function(t,r,i){let a=!0===i.wireframe,l=o[t.id];void 0===l&&(l={},o[t.id]=l);let c=l[r.id];void 0===c&&(c={},l[r.id]=c);let u=c[a];return void 0===u&&(u=f(n.isWebGL2?e.createVertexArray():s.createVertexArrayOES()),c[a]=u),u}(b,d,l);c!==t&&(c=t,h(c.object)),x=function(e,t,r,n){let i=c.attributes,s=t.attributes,a=0,o=r.getAttributes();for(let l in o)if(o[l].location>=0){let t=i[l],r=s[l];if(void 0===r&&("instanceMatrix"===l&&e.instanceMatrix&&(r=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(r=e.instanceColor)),void 0===t||t.attribute!==r||r&&t.data!==r.data)return!0;a++}return c.attributesNum!==a||c.index!==n}(i,b,d,w),x&&function(e,t,r,n){let i={},s=t.attributes,a=0,o=r.getAttributes();for(let l in o)if(o[l].location>=0){let t=s[l];void 0===t&&("instanceMatrix"===l&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(t=e.instanceColor));let r={};r.attribute=t,t&&t.data&&(r.data=t.data),i[l]=r,a++}c.attributes=i,c.attributesNum=a,c.index=n}(i,b,d,w)}else{let e=!0===l.wireframe;(c.geometry!==b.id||c.program!==d.id||c.wireframe!==e)&&(c.geometry=b.id,c.program=d.id,c.wireframe=e,x=!0)}null!==w&&r.update(w,34963),(x||u)&&(u=!1,function(i,s,a,o){if(!1===n.isWebGL2&&(i.isInstancedMesh||o.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;p();let l=o.attributes,c=a.getAttributes(),u=s.defaultAttributeValues;for(let t in c){let n=c[t];if(n.location>=0){let s=l[t];if(void 0===s&&("instanceMatrix"===t&&i.instanceMatrix&&(s=i.instanceMatrix),"instanceColor"===t&&i.instanceColor&&(s=i.instanceColor)),void 0!==s){let t=s.normalized,a=s.itemSize,l=r.get(s);if(void 0===l)continue;let c=l.buffer,u=l.type,h=l.bytesPerElement;if(s.isInterleavedBufferAttribute){let r=s.data,l=r.stride,d=s.offset;if(r.isInstancedInterleavedBuffer){for(let e=0;e<n.locationSize;e++)g(n.location+e,r.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=r.meshPerAttribute*r.count)}else for(let e=0;e<n.locationSize;e++)m(n.location+e);e.bindBuffer(34962,c);for(let e=0;e<n.locationSize;e++)y(n.location+e,a/n.locationSize,u,t,l*h,(d+a/n.locationSize*e)*h)}else{if(s.isInstancedBufferAttribute){for(let e=0;e<n.locationSize;e++)g(n.location+e,s.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=s.meshPerAttribute*s.count)}else for(let e=0;e<n.locationSize;e++)m(n.location+e);e.bindBuffer(34962,c);for(let e=0;e<n.locationSize;e++)y(n.location+e,a/n.locationSize,u,t,a*h,a/n.locationSize*e*h)}}else if(void 0!==u){let r=u[t];if(void 0!==r)switch(r.length){case 2:e.vertexAttrib2fv(n.location,r);break;case 3:e.vertexAttrib3fv(n.location,r);break;case 4:e.vertexAttrib4fv(n.location,r);break;default:e.vertexAttrib1fv(n.location,r)}}}}v()}(i,l,d,b),null!==w&&e.bindBuffer(34963,r.get(w).buffer))},reset:b,resetDefaultState:w,dispose:function(){b();for(let e in o){let t=o[e];for(let e in t){let r=t[e];for(let e in r)d(r[e].object),delete r[e];delete t[e]}delete o[e]}},releaseStatesOfGeometry:function(e){if(void 0===o[e.id])return;let t=o[e.id];for(let r in t){let e=t[r];for(let t in e)d(e[t].object),delete e[t];delete t[r]}delete o[e.id]},releaseStatesOfProgram:function(e){for(let t in o){let r=o[t];if(void 0===r[e.id])continue;let n=r[e.id];for(let e in n)d(n[e].object),delete n[e];delete r[e.id]}},initAttributes:p,enableAttribute:m,disableUnusedAttributes:v}}function YF(e,t,r,n){let i,s=n.isWebGL2;this.setMode=function(e){i=e},this.render=function(t,n){e.drawArrays(i,t,n),r.update(n,i,1)},this.renderInstances=function(n,a,o){if(0===o)return;let l,c;if(s)l=e,c="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](i,n,a,o),r.update(a,i,o)}}function KF(e,t,r){let n;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let s=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext,a=void 0!==r.precision?r.precision:"highp",o=i(a);o!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",o,"instead."),a=o);let l=s||t.has("WEBGL_draw_buffers"),c=!0===r.logarithmicDepthBuffer,u=e.getParameter(34930),h=e.getParameter(35660),d=e.getParameter(3379),f=e.getParameter(34076),p=e.getParameter(34921),m=e.getParameter(36347),g=e.getParameter(36348),v=e.getParameter(36349),y=h>0,b=s||t.has("OES_texture_float");return{isWebGL2:s,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==n)return n;if(!0===t.has("EXT_texture_filter_anisotropic")){let r=t.get("EXT_texture_filter_anisotropic");n=e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:f,maxAttributes:p,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:y&&b,maxSamples:s?e.getParameter(36183):0}}function QF(e){let t=this,r=null,n=0,i=!1,s=!1,a=new LF,o=new tB,l={value:null,needsUpdate:!1};function c(e,r,n,i){let s=null!==e?e.length:0,c=null;if(0!==s){if(c=l.value,!0!==i||null===c){let t=n+4*s,i=r.matrixWorldInverse;o.getNormalMatrix(i),(null===c||c.length<t)&&(c=new Float32Array(t));for(let r=0,l=n;r!==s;++r,l+=4)a.copy(e[r]).applyMatrix4(i,o),a.normal.toArray(c,l),c[l+3]=a.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=s,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){let r=0!==e.length||t||0!==n||i;return i=t,n=e.length,r},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(e,t){r=c(e,t,0)},this.setState=function(a,o,u){let h=a.clippingPlanes,d=a.clipIntersection,f=a.clipShadows,p=e.get(a);if(!i||null===h||0===h.length||s&&!f)s?c(null):(l.value!==r&&(l.value=r,l.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0);else{let e=s?0:n,t=4*e,i=p.clippingState||null;l.value=i,i=c(h,o,t,u);for(let n=0;n!==t;++n)i[n]=r[n];p.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function ZF(e){let t=new WeakMap;function r(e,t){return 303===t?e.mapping=KL:304===t&&(e.mapping=QL),e}function n(e){let r=e.target;r.removeEventListener("dispose",n);let i=t.get(r);void 0!==i&&(t.delete(r),i.dispose())}return{get:function(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){let s=i.mapping;if(303===s||304===s){if(t.has(i)){return r(t.get(i).texture,i.mapping)}{let s=i.image;if(s&&s.height>0){let a=new DF(s.height/2);return a.fromEquirectangularTexture(e,i),t.set(i,a),i.addEventListener("dispose",n),r(a.texture,i.mapping)}return null}}}return i},dispose:function(){t=new WeakMap}}}var JF=class extends AF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=i,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,r,n,i,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-e,s=r+e,a=n+t,o=n-t;if(null!==this.view&&this.view.enabled){let e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,s=i+e*this.view.width,a-=t*this.view.offsetY,o=a-t*this.view.height}this.projectionMatrix.makeOrthographic(i,s,a,o,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}},$F=[.125,.215,.35,.446,.526,.582],ej=20,tj=new JF,rj=new vB,nj=null,ij=(1+Math.sqrt(5))/2,sj=1/ij,aj=[new PB(1,1,1),new PB(-1,1,1),new PB(1,1,-1),new PB(-1,1,-1),new PB(0,ij,sj),new PB(0,ij,-sj),new PB(sj,0,ij),new PB(-sj,0,ij),new PB(ij,sj,0),new PB(-ij,sj,0)],oj=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;nj=this._renderer.getRenderTarget(),this._setSize(256);let i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(e,r,n,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=hj(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=uj(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(nj),e.scissorTest=!1,cj(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===KL||e.mapping===QL?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),nj=this._renderer.getRenderTarget();let r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:iN,minFilter:iN,generateMipmaps:!1,type:uN,format:dN,encoding:kN,depthBuffer:!1},n=lj(e,t,r);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=lj(e,t,r);let{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){let t=[],r=[],n=[],i=e,s=e-4+1+$F.length;for(let a=0;a<s;a++){let s=Math.pow(2,i);r.push(s);let o=1/s;a>e-4?o=$F[a-e+4-1]:0===a&&(o=0),n.push(o);let l=1/(s-2),c=-l,u=1+l,h=[c,c,u,c,u,u,c,c,u,u,c,u],d=6,f=6,p=3,m=2,g=1,v=new Float32Array(p*f*d),y=new Float32Array(m*f*d),b=new Float32Array(g*f*d);for(let e=0;e<d;e++){let t=e%3*2/3-1,r=e>2?0:-1,n=[t,r,0,t+2/3,r,0,t+2/3,r+1,0,t,r,0,t+2/3,r+1,0,t,r+1,0];v.set(n,p*f*e),y.set(h,m*f*e);let i=[e,e,e,e,e,e];b.set(i,g*f*e)}let w=new iF;w.setAttribute("position",new Xz(v,p)),w.setAttribute("uv",new Xz(y,m)),w.setAttribute("faceIndex",new Xz(b,g)),t.push(w),i>4&&i--}return{lodPlanes:t,sizeLods:r,sigmas:n}}(n)),this._blurMaterial=function(e,t,r){let n=new Float32Array(ej),i=new PB(0,1,0);return new EF({name:"SphericalGaussianBlur",defines:{n:ej,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(n,e,t)}return n}_compileMaterial(e){let t=new yF(this._lodPlanes[0],e);this._renderer.compile(t,tj)}_sceneToCubeUV(e,t,r,n){let i=new MF(90,1,t,r),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,c=o.toneMapping;o.getClearColor(rj),o.toneMapping=0,o.autoClear=!1;let u=new Wz({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),h=new yF(new wF,u),d=!1,f=e.background;f?f.isColor&&(u.color.copy(f),e.background=null,d=!0):(u.color.copy(rj),d=!0);for(let p=0;p<6;p++){let t=p%3;0===t?(i.up.set(0,s[p],0),i.lookAt(a[p],0,0)):1===t?(i.up.set(0,0,s[p]),i.lookAt(0,a[p],0)):(i.up.set(0,s[p],0),i.lookAt(0,0,a[p]));let r=this._cubeSize;cj(n,t*r,p>2?r:0,r,r),o.setRenderTarget(n),d&&o.render(h,i),o.render(e,i)}h.geometry.dispose(),h.material.dispose(),o.toneMapping=c,o.autoClear=l,e.background=f}_textureToCubeUV(e,t){let r=this._renderer,n=e.mapping===KL||e.mapping===QL;n?(null===this._cubemapMaterial&&(this._cubemapMaterial=hj()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=uj());let i=n?this._cubemapMaterial:this._equirectMaterial,s=new yF(this._lodPlanes[0],i);i.uniforms.envMap.value=e;let a=this._cubeSize;cj(t,0,0,3*a,2*a),r.setRenderTarget(t),r.render(s,tj)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let n=1;n<this._lodPlanes.length;n++){let t=Math.sqrt(this._sigmas[n]*this._sigmas[n]-this._sigmas[n-1]*this._sigmas[n-1]),r=aj[(n-1)%aj.length];this._blur(e,n-1,n,t,r)}t.autoClear=r}_blur(e,t,r,n,i){let s=this._pingPongRenderTarget;this._halfBlur(e,s,t,r,n,"latitudinal",i),this._halfBlur(s,e,r,r,n,"longitudinal",i)}_halfBlur(e,t,r,n,i,s,a){let o=this._renderer,l=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");let c=new yF(this._lodPlanes[n],l),u=l.uniforms,h=this._sizeLods[r]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,f=i/d,p=isFinite(i)?1+Math.floor(3*f):ej;p>ej&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(p," samples when the maximum is set to ").concat(ej));let m=[],g=0;for(let b=0;b<ej;++b){let e=b/f,t=Math.exp(-e*e/2);m.push(t),0===b?g+=t:b<p&&(g+=2*t)}for(let b=0;b<m.length;b++)m[b]=m[b]/g;u.envMap.value=e.texture,u.samples.value=p,u.weights.value=m,u.latitudinal.value="latitudinal"===s,a&&(u.poleAxis.value=a);let{_lodMax:v}=this;u.dTheta.value=d,u.mipInt.value=v-r;let y=this._sizeLods[n];cj(t,3*y*(n>v-4?n-v+4:0),4*(this._cubeSize-y),3*y,2*y),o.setRenderTarget(t),o.render(c,tj)}};function lj(e,t,r){let n=new EB(e,t,r);return n.texture.mapping=ZL,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function cj(e,t,r,n,i){e.viewport.set(t,r,n,i),e.scissor.set(t,r,n,i)}function uj(){return new EF({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function hj(){return new EF({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function dj(e){let t=new WeakMap,r=null;function n(e){let r=e.target;r.removeEventListener("dispose",n);let i=t.get(r);void 0!==i&&(t.delete(r),i.dispose())}return{get:function(i){if(i&&i.isTexture){let s=i.mapping,a=303===s||304===s,o=s===KL||s===QL;if(a||o){if(i.isRenderTargetTexture&&!0===i.needsPMREMUpdate){i.needsPMREMUpdate=!1;let n=t.get(i);return null===r&&(r=new oj(e)),n=a?r.fromEquirectangular(i,n):r.fromCubemap(i,n),t.set(i,n),n.texture}if(t.has(i))return t.get(i).texture;{let s=i.image;if(a&&s&&s.height>0||o&&s&&function(e){let t=0,r=6;for(let n=0;n<r;n++)void 0!==e[n]&&t++;return t===r}(s)){null===r&&(r=new oj(e));let s=a?r.fromEquirectangular(i):r.fromCubemap(i);return t.set(i,s),i.addEventListener("dispose",n),s.texture}return null}}}return i},dispose:function(){t=new WeakMap,null!==r&&(r.dispose(),r=null)}}}function fj(e){let t={};function r(r){if(void 0!==t[r])return t[r];let n;switch(r){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(r)}return t[r]=n,n}return{has:function(e){return null!==r(e)},init:function(e){e.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture")},get:function(e){let t=r(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function pj(e,t,r,n){let i={},s=new WeakMap;function a(e){let o=e.target;null!==o.index&&t.remove(o.index);for(let r in o.attributes)t.remove(o.attributes[r]);o.removeEventListener("dispose",a),delete i[o.id];let l=s.get(o);l&&(t.remove(l),s.delete(o)),n.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,r.memory.geometries--}function o(e){let r=[],n=e.index,i=e.attributes.position,a=0;if(null!==n){let e=n.array;a=n.version;for(let t=0,n=e.length;t<n;t+=3){let n=e[t+0],i=e[t+1],s=e[t+2];r.push(n,i,i,s,s,n)}}else{let e=i.array;a=i.version;for(let t=0,n=e.length/3-1;t<n;t+=3){let e=t+0,n=t+1,i=t+2;r.push(e,n,n,i,i,e)}}let o=new(nB(r)?Kz:Yz)(r,1);o.version=a;let l=s.get(e);l&&t.remove(l),s.set(e,o)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",a),i[t.id]=!0,r.memory.geometries++),t},update:function(e){let r=e.attributes;for(let i in r)t.update(r[i],34962);let n=e.morphAttributes;for(let i in n){let e=n[i];for(let r=0,n=e.length;r<n;r++)t.update(e[r],34962)}},getWireframeAttribute:function(e){let t=s.get(e);if(t){let r=e.index;null!==r&&t.version<r.version&&o(e)}else o(e);return s.get(e)}}}function mj(e,t,r,n){let i,s,a,o=n.isWebGL2;this.setMode=function(e){i=e},this.setIndex=function(e){s=e.type,a=e.bytesPerElement},this.render=function(t,n){e.drawElements(i,n,s,t*a),r.update(n,i,1)},this.renderInstances=function(n,l,c){if(0===c)return;let u,h;if(o)u=e,h="drawElementsInstanced";else if(u=t.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[h](i,l,s,n*a,c),r.update(l,i,c)}}function gj(e){let t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,r,n){switch(t.calls++,r){case 4:t.triangles+=n*(e/3);break;case 1:t.lines+=n*(e/2);break;case 3:t.lines+=n*(e-1);break;case 2:t.lines+=n*e;break;case 0:t.points+=n*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function vj(e,t){return e[0]-t[0]}function yj(e,t){return Math.abs(t[1])-Math.abs(e[1])}function bj(e,t,r){let n={},i=new Float32Array(8),s=new WeakMap,a=new CB,o=[];for(let l=0;l<8;l++)o[l]=[l,0];return{update:function(l,c,u,h){let d=l.morphTargetInfluences;if(!0===t.isWebGL2){let n=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,i=void 0!==n?n.length:0,o=s.get(c);if(void 0===o||o.count!==i){let e=function(){v.dispose(),s.delete(c),c.removeEventListener("dispose",e)};void 0!==o&&o.texture.dispose();let r=void 0!==c.morphAttributes.position,n=void 0!==c.morphAttributes.normal,l=void 0!==c.morphAttributes.color,u=c.morphAttributes.position||[],h=c.morphAttributes.normal||[],d=c.morphAttributes.color||[],f=0;!0===r&&(f=1),!0===n&&(f=2),!0===l&&(f=3);let p=c.attributes.position.count*f,m=1;p>t.maxTextureSize&&(m=Math.ceil(p/t.maxTextureSize),p=t.maxTextureSize);let g=new Float32Array(p*m*4*i),v=new AB(g,p,m,i);v.type=cN,v.needsUpdate=!0;let y=4*f;for(let t=0;t<i;t++){let e=u[t],i=h[t],s=d[t],o=p*m*4*t;for(let t=0;t<e.count;t++){let c=t*y;!0===r&&(a.fromBufferAttribute(e,t),g[o+c+0]=a.x,g[o+c+1]=a.y,g[o+c+2]=a.z,g[o+c+3]=0),!0===n&&(a.fromBufferAttribute(i,t),g[o+c+4]=a.x,g[o+c+5]=a.y,g[o+c+6]=a.z,g[o+c+7]=0),!0===l&&(a.fromBufferAttribute(s,t),g[o+c+8]=a.x,g[o+c+9]=a.y,g[o+c+10]=a.z,g[o+c+11]=4===s.itemSize?a.w:1)}}o={count:i,texture:v,size:new eB(p,m)},s.set(c,o),c.addEventListener("dispose",e)}let l=0;for(let e=0;e<d.length;e++)l+=d[e];let u=c.morphTargetsRelative?1:1-l;h.getUniforms().setValue(e,"morphTargetBaseInfluence",u),h.getUniforms().setValue(e,"morphTargetInfluences",d),h.getUniforms().setValue(e,"morphTargetsTexture",o.texture,r),h.getUniforms().setValue(e,"morphTargetsTextureSize",o.size)}else{let t=void 0===d?0:d.length,r=n[c.id];if(void 0===r||r.length!==t){r=[];for(let e=0;e<t;e++)r[e]=[e,0];n[c.id]=r}for(let e=0;e<t;e++){let t=r[e];t[0]=e,t[1]=d[e]}r.sort(yj);for(let e=0;e<8;e++)e<t&&r[e][1]?(o[e][0]=r[e][0],o[e][1]=r[e][1]):(o[e][0]=Number.MAX_SAFE_INTEGER,o[e][1]=0);o.sort(vj);let s=c.morphAttributes.position,a=c.morphAttributes.normal,l=0;for(let e=0;e<8;e++){let t=o[e],r=t[0],n=t[1];r!==Number.MAX_SAFE_INTEGER&&n?(s&&c.getAttribute("morphTarget"+e)!==s[r]&&c.setAttribute("morphTarget"+e,s[r]),a&&c.getAttribute("morphNormal"+e)!==a[r]&&c.setAttribute("morphNormal"+e,a[r]),i[e]=n,l+=n):(s&&!0===c.hasAttribute("morphTarget"+e)&&c.deleteAttribute("morphTarget"+e),a&&!0===c.hasAttribute("morphNormal"+e)&&c.deleteAttribute("morphNormal"+e),i[e]=0)}let u=c.morphTargetsRelative?1:1-l;h.getUniforms().setValue(e,"morphTargetBaseInfluence",u),h.getUniforms().setValue(e,"morphTargetInfluences",i)}}}}function wj(e,t,r,n){let i=new WeakMap;function s(e){let t=e.target;t.removeEventListener("dispose",s),r.remove(t.instanceMatrix),null!==t.instanceColor&&r.remove(t.instanceColor)}return{update:function(e){let a=n.render.frame,o=e.geometry,l=t.get(e,o);return i.get(l)!==a&&(t.update(l),i.set(l,a)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",s)&&e.addEventListener("dispose",s),r.update(e.instanceMatrix,34962),null!==e.instanceColor&&r.update(e.instanceColor,34962)),l},dispose:function(){i=new WeakMap}}}var xj=new _B,Sj=new AB,_j=new class extends _B{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=tN,this.minFilter=tN,this.wrapR=$L,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Cj=new kF,Ej=[],Aj=[],Mj=new Float32Array(16),Tj=new Float32Array(9),Pj=new Float32Array(4);function kj(e,t,r){let n=e[0];if(null==n||n<=0||n>0)return e;let i=t*r,s=Ej[i];if(void 0===s&&(s=new Float32Array(i),Ej[i]=s),0!==t){n.toArray(s,0);for(let n=1,i=0;n!==t;++n)i+=r,e[n].toArray(s,i)}return s}function Dj(e,t){if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}function Ij(e,t){for(let r=0,n=t.length;r<n;r++)e[r]=t[r]}function Oj(e,t){let r=Aj[t];void 0===r&&(r=new Int32Array(t),Aj[t]=r);for(let n=0;n!==t;++n)r[n]=e.allocateTextureUnit();return r}function Rj(e,t){let r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function Lj(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Dj(r,t))return;e.uniform2fv(this.addr,t),Ij(r,t)}}function Nj(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(void 0!==t.r)(r[0]!==t.r||r[1]!==t.g||r[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(Dj(r,t))return;e.uniform3fv(this.addr,t),Ij(r,t)}}function Bj(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Dj(r,t))return;e.uniform4fv(this.addr,t),Ij(r,t)}}function zj(e,t){let r=this.cache,n=t.elements;if(void 0===n){if(Dj(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),Ij(r,t)}else{if(Dj(r,n))return;Pj.set(n),e.uniformMatrix2fv(this.addr,!1,Pj),Ij(r,n)}}function Fj(e,t){let r=this.cache,n=t.elements;if(void 0===n){if(Dj(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),Ij(r,t)}else{if(Dj(r,n))return;Tj.set(n),e.uniformMatrix3fv(this.addr,!1,Tj),Ij(r,n)}}function jj(e,t){let r=this.cache,n=t.elements;if(void 0===n){if(Dj(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),Ij(r,t)}else{if(Dj(r,n))return;Mj.set(n),e.uniformMatrix4fv(this.addr,!1,Mj),Ij(r,n)}}function Uj(e,t){let r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function Vj(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Dj(r,t))return;e.uniform2iv(this.addr,t),Ij(r,t)}}function Hj(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(Dj(r,t))return;e.uniform3iv(this.addr,t),Ij(r,t)}}function Wj(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Dj(r,t))return;e.uniform4iv(this.addr,t),Ij(r,t)}}function Gj(e,t){let r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function qj(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Dj(r,t))return;e.uniform2uiv(this.addr,t),Ij(r,t)}}function Xj(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(Dj(r,t))return;e.uniform3uiv(this.addr,t),Ij(r,t)}}function Yj(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Dj(r,t))return;e.uniform4uiv(this.addr,t),Ij(r,t)}}function Kj(e,t,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture2D(t||xj,i)}function Qj(e,t,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture3D(t||_j,i)}function Zj(e,t,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTextureCube(t||Cj,i)}function Jj(e,t,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture2DArray(t||Sj,i)}function $j(e,t){e.uniform1fv(this.addr,t)}function eU(e,t){let r=kj(t,this.size,2);e.uniform2fv(this.addr,r)}function tU(e,t){let r=kj(t,this.size,3);e.uniform3fv(this.addr,r)}function rU(e,t){let r=kj(t,this.size,4);e.uniform4fv(this.addr,r)}function nU(e,t){let r=kj(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function iU(e,t){let r=kj(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function sU(e,t){let r=kj(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function aU(e,t){e.uniform1iv(this.addr,t)}function oU(e,t){e.uniform2iv(this.addr,t)}function lU(e,t){e.uniform3iv(this.addr,t)}function cU(e,t){e.uniform4iv(this.addr,t)}function uU(e,t){e.uniform1uiv(this.addr,t)}function hU(e,t){e.uniform2uiv(this.addr,t)}function dU(e,t){e.uniform3uiv(this.addr,t)}function fU(e,t){e.uniform4uiv(this.addr,t)}function pU(e,t,r){let n=this.cache,i=t.length,s=Oj(r,i);Dj(n,s)||(e.uniform1iv(this.addr,s),Ij(n,s));for(let a=0;a!==i;++a)r.setTexture2D(t[a]||xj,s[a])}function mU(e,t,r){let n=this.cache,i=t.length,s=Oj(r,i);Dj(n,s)||(e.uniform1iv(this.addr,s),Ij(n,s));for(let a=0;a!==i;++a)r.setTexture3D(t[a]||_j,s[a])}function gU(e,t,r){let n=this.cache,i=t.length,s=Oj(r,i);Dj(n,s)||(e.uniform1iv(this.addr,s),Ij(n,s));for(let a=0;a!==i;++a)r.setTextureCube(t[a]||Cj,s[a])}function vU(e,t,r){let n=this.cache,i=t.length,s=Oj(r,i);Dj(n,s)||(e.uniform1iv(this.addr,s),Ij(n,s));for(let a=0;a!==i;++a)r.setTexture2DArray(t[a]||Sj,s[a])}var yU=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Rj;case 35664:return Lj;case 35665:return Nj;case 35666:return Bj;case 35674:return zj;case 35675:return Fj;case 35676:return jj;case 5124:case 35670:return Uj;case 35667:case 35671:return Vj;case 35668:case 35672:return Hj;case 35669:case 35673:return Wj;case 5125:return Gj;case 36294:return qj;case 36295:return Xj;case 36296:return Yj;case 35678:case 36198:case 36298:case 36306:case 35682:return Kj;case 35679:case 36299:case 36307:return Qj;case 35680:case 36300:case 36308:case 36293:return Zj;case 36289:case 36303:case 36311:case 36292:return Jj}}(t.type)}},bU=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return $j;case 35664:return eU;case 35665:return tU;case 35666:return rU;case 35674:return nU;case 35675:return iU;case 35676:return sU;case 5124:case 35670:return aU;case 35667:case 35671:return oU;case 35668:case 35672:return lU;case 35669:case 35673:return cU;case 5125:return uU;case 36294:return hU;case 36295:return dU;case 36296:return fU;case 35678:case 36198:case 36298:case 36306:case 35682:return pU;case 35679:case 36299:case 36307:return mU;case 35680:case 36300:case 36308:case 36293:return gU;case 36289:case 36303:case 36311:case 36292:return vU}}(t.type)}},wU=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){if(void 0===t)return;let n=this.seq;for(let i=0,s=n.length;i!==s;++i){let s=n[i];s.setValue(e,t[s.id],r)}}},xU=/(\w+)(\])?(\[|\.)?/g;function SU(e,t){e.seq.push(t),e.map[t.id]=t}function _U(e,t,r){let n=e.name,i=n.length;for(xU.lastIndex=0;;){let s=xU.exec(n),a=xU.lastIndex,o=s[1],l="]"===s[2],c=s[3];if(l&&(o|=0),void 0===c||"["===c&&a+2===i){SU(r,void 0===c?new yU(o,e,t):new bU(o,e,t));break}{let e=r.map[o];void 0===e&&(e=new wU(o),SU(r,e)),r=e}}}var CU=class{constructor(e,t){this.seq=[],this.map={};let r=e.getProgramParameter(t,35718);for(let n=0;n<r;++n){let r=e.getActiveUniform(t,n);_U(r,e.getUniformLocation(t,r.name),this)}}setValue(e,t,r,n){let i=this.map[t];void 0!==i&&i.setValue(e,r,n)}setOptional(e,t,r){let n=t[r];void 0!==n&&this.setValue(e,r,n)}static upload(e,t,r,n){for(let i=0,s=t.length;i!==s;++i){let s=t[i],a=r[s.id];!1!==a.needsUpdate&&s.setValue(e,a.value,n)}}static seqWithValue(e,t){let r=[];for(let n=0,i=e.length;n!==i;++n){let i=e[n];i.id in t&&r.push(i)}return r}};function EU(e,t,r){let n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}var AU=0;function MU(e,t,r){let n=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();if(n&&""===i)return"";let s=/ERROR: 0:(\d+)/.exec(i);if(s){let n=parseInt(s[1]);return r.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){let r=e.split("\n"),n=[],i=Math.max(t-6,0),s=Math.min(t+6,r.length);for(let a=i;a<s;a++){let e=a+1;n.push("".concat(e===t?">":" "," ").concat(e,": ").concat(r[a]))}return n.join("\n")}(e.getShaderSource(t),n)}return i}function TU(e,t){let r=function(e){switch(e){case kN:return["Linear","( value )"];case DN:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function PU(e,t){let r;switch(t){case 1:r="Linear";break;case 2:r="Reinhard";break;case 3:r="OptimizedCineon";break;case 4:r="ACESFilmic";break;case 5:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function kU(e){return""!==e}function DU(e,t){let r=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function IU(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var OU=/^[ \t]*#include +<([\w\d./]+)>/gm;function RU(e){return e.replace(OU,LU)}function LU(e,t){let r=VF[t];if(void 0===r)throw new Error("Can not resolve #include <"+t+">");return RU(r)}var NU=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function BU(e){return e.replace(NU,zU)}function zU(e,t,r,n){let i="";for(let s=parseInt(t);s<parseInt(r);s++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function FU(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function jU(e,t,r,n){let i,s,a=e.getContext(),o=r.defines,l=r.vertexShader,c=r.fragmentShader,u=function(e){let t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(r),h=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case KL:case QL:t="ENVMAP_TYPE_CUBE";break;case ZL:t="ENVMAP_TYPE_CUBE_UV"}return t}(r),d=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===QL&&(t="ENVMAP_MODE_REFRACTION");return t}(r),f=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(r),p=function(e){let t=e.envMapCubeUVHeight;if(null===t)return null;let r=Math.log2(t)-2,n=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,r),112)),texelHeight:n,maxMip:r}}(r),m=r.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(kU).join("\n")}(r),g=function(e){let t=[];for(let r in e){let n=e[r];!1!==n&&t.push("#define "+r+" "+n)}return t.join("\n")}(o),v=a.createProgram(),y=r.glslVersion?"#version "+r.glslVersion+"\n":"";r.isRawShaderMaterial?(i=[g].filter(kU).join("\n"),i.length>0&&(i+="\n"),s=[m,g].filter(kU).join("\n"),s.length>0&&(s+="\n")):(i=[FU(r),"#define SHADER_NAME "+r.shaderName,g,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+d:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.morphColors&&r.isWebGL2?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+u:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(kU).join("\n"),s=[m,FU(r),"#define SHADER_NAME "+r.shaderName,g,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+h:"",r.envMap?"#define "+d:"",r.envMap?"#define "+f:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+u:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==r.toneMapping?"#define TONE_MAPPING":"",0!==r.toneMapping?VF.tonemapping_pars_fragment:"",0!==r.toneMapping?PU("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",VF.encodings_pars_fragment,TU("linearToOutputTexel",r.outputEncoding),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(kU).join("\n")),l=RU(l),l=DU(l,r),l=IU(l,r),c=RU(c),c=DU(c,r),c=IU(c,r),l=BU(l),c=BU(c),r.isWebGL2&&!0!==r.isRawShaderMaterial&&(y="#version 300 es\n",i=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+i,s=["#define varying in",r.glslVersion===BN?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===BN?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+s);let b,w,x=y+s+c,S=EU(a,35633,y+i+l),_=EU(a,35632,x);if(a.attachShader(v,S),a.attachShader(v,_),void 0!==r.index0AttributeName?a.bindAttribLocation(v,0,r.index0AttributeName):!0===r.morphTargets&&a.bindAttribLocation(v,0,"position"),a.linkProgram(v),e.debug.checkShaderErrors){let e=a.getProgramInfoLog(v).trim(),t=a.getShaderInfoLog(S).trim(),r=a.getShaderInfoLog(_).trim(),n=!0,o=!0;if(!1===a.getProgramParameter(v,35714)){n=!1;let t=MU(a,S,"vertex"),r=MU(a,_,"fragment");console.error("THREE.WebGLProgram: Shader Error "+a.getError()+" - VALIDATE_STATUS "+a.getProgramParameter(v,35715)+"\n\nProgram Info Log: "+e+"\n"+t+"\n"+r)}else""!==e?console.warn("THREE.WebGLProgram: Program Info Log:",e):(""===t||""===r)&&(o=!1);o&&(this.diagnostics={runnable:n,programLog:e,vertexShader:{log:t,prefix:i},fragmentShader:{log:r,prefix:s}})}return a.deleteShader(S),a.deleteShader(_),this.getUniforms=function(){return void 0===b&&(b=new CU(a,v)),b},this.getAttributes=function(){return void 0===w&&(w=function(e,t){let r={},n=e.getProgramParameter(t,35721);for(let i=0;i<n;i++){let n=e.getActiveAttrib(t,i),s=n.name,a=1;35674===n.type&&(a=2),35675===n.type&&(a=3),35676===n.type&&(a=4),r[s]={type:n.type,location:e.getAttribLocation(t,s),locationSize:a}}return r}(a,v)),w},this.destroy=function(){n.releaseStatesOfProgram(this),a.deleteProgram(v),this.program=void 0},this.name=r.shaderName,this.id=AU++,this.cacheKey=t,this.usedTimes=1,this.program=v,this.vertexShader=S,this.fragmentShader=_,this}var UU=0,VU=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,r=e.fragmentShader,n=this._getShaderStage(t),i=this._getShaderStage(r),s=this._getShaderCacheForMaterial(e);return!1===s.has(n)&&(s.add(n),n.usedTimes++),!1===s.has(i)&&(s.add(i),i.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let r of t)r.usedTimes--,0===r.usedTimes&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,r=t.get(e);return void 0===r&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){let t=this.shaderCache,r=t.get(e);return void 0===r&&(r=new HU(e),t.set(e,r)),r}},HU=class{constructor(e){this.id=UU++,this.code=e,this.usedTimes=0}};function WU(e,t,r,n,i,s,a){let o=new gz,l=new VU,c=[],u=i.isWebGL2,h=i.logarithmicDepthBuffer,d=i.vertexTextures,f=i.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(s,o,c,m,g){let v=m.fog,y=g.geometry,b=s.isMeshStandardMaterial?m.environment:null,w=(s.isMeshStandardMaterial?r:t).get(s.envMap||b),x=w&&w.mapping===ZL?w.image.height:null,S=p[s.type];null!==s.precision&&(f=i.getMaxPrecision(s.precision),f!==s.precision&&console.warn("THREE.WebGLProgram.getParameters:",s.precision,"not supported, using",f,"instead."));let _,C,E,A,M=y.morphAttributes.position||y.morphAttributes.normal||y.morphAttributes.color,T=void 0!==M?M.length:0,P=0;if(void 0!==y.morphAttributes.position&&(P=1),void 0!==y.morphAttributes.normal&&(P=2),void 0!==y.morphAttributes.color&&(P=3),S){let e=WF[S];_=e.vertexShader,C=e.fragmentShader}else _=s.vertexShader,C=s.fragmentShader,l.update(s),E=l.getVertexShaderID(s),A=l.getFragmentShaderID(s);let k=e.getRenderTarget(),D=s.alphaTest>0,I=s.clearcoat>0,O=s.iridescence>0;return{isWebGL2:u,shaderID:S,shaderName:s.type,vertexShader:_,fragmentShader:C,defines:s.defines,customVertexShaderID:E,customFragmentShaderID:A,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:f,instancing:!0===g.isInstancedMesh,instancingColor:!0===g.isInstancedMesh&&null!==g.instanceColor,supportsVertexTextures:d,outputEncoding:null===k?e.outputEncoding:!0===k.isXRRenderTarget?k.texture.encoding:kN,map:!!s.map,matcap:!!s.matcap,envMap:!!w,envMapMode:w&&w.mapping,envMapCubeUVHeight:x,lightMap:!!s.lightMap,aoMap:!!s.aoMap,emissiveMap:!!s.emissiveMap,bumpMap:!!s.bumpMap,normalMap:!!s.normalMap,objectSpaceNormalMap:1===s.normalMapType,tangentSpaceNormalMap:0===s.normalMapType,decodeVideoTexture:!!s.map&&!0===s.map.isVideoTexture&&s.map.encoding===DN,clearcoat:I,clearcoatMap:I&&!!s.clearcoatMap,clearcoatRoughnessMap:I&&!!s.clearcoatRoughnessMap,clearcoatNormalMap:I&&!!s.clearcoatNormalMap,iridescence:O,iridescenceMap:O&&!!s.iridescenceMap,iridescenceThicknessMap:O&&!!s.iridescenceThicknessMap,displacementMap:!!s.displacementMap,roughnessMap:!!s.roughnessMap,metalnessMap:!!s.metalnessMap,specularMap:!!s.specularMap,specularIntensityMap:!!s.specularIntensityMap,specularColorMap:!!s.specularColorMap,opaque:!1===s.transparent&&1===s.blending,alphaMap:!!s.alphaMap,alphaTest:D,gradientMap:!!s.gradientMap,sheen:s.sheen>0,sheenColorMap:!!s.sheenColorMap,sheenRoughnessMap:!!s.sheenRoughnessMap,transmission:s.transmission>0,transmissionMap:!!s.transmissionMap,thicknessMap:!!s.thicknessMap,combine:s.combine,vertexTangents:!!s.normalMap&&!!y.attributes.tangent,vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!y.attributes.color&&4===y.attributes.color.itemSize,vertexUvs:!!s.map||!!s.bumpMap||!!s.normalMap||!!s.specularMap||!!s.alphaMap||!!s.emissiveMap||!!s.roughnessMap||!!s.metalnessMap||!!s.clearcoatMap||!!s.clearcoatRoughnessMap||!!s.clearcoatNormalMap||!!s.iridescenceMap||!!s.iridescenceThicknessMap||!!s.displacementMap||!!s.transmissionMap||!!s.thicknessMap||!!s.specularIntensityMap||!!s.specularColorMap||!!s.sheenColorMap||!!s.sheenRoughnessMap,uvsVertexOnly:!(s.map||s.bumpMap||s.normalMap||s.specularMap||s.alphaMap||s.emissiveMap||s.roughnessMap||s.metalnessMap||s.clearcoatNormalMap||s.iridescenceMap||s.iridescenceThicknessMap||s.transmission>0||s.transmissionMap||s.thicknessMap||s.specularIntensityMap||s.specularColorMap||s.sheen>0||s.sheenColorMap||s.sheenRoughnessMap)&&!!s.displacementMap,fog:!!v,useFog:!0===s.fog,fogExp2:v&&v.isFogExp2,flatShading:!!s.flatShading,sizeAttenuation:s.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===g.isSkinnedMesh,morphTargets:void 0!==y.morphAttributes.position,morphNormals:void 0!==y.morphAttributes.normal,morphColors:void 0!==y.morphAttributes.color,morphTargetsCount:T,morphTextureStride:P,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:s.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.length>0,shadowMapType:e.shadowMap.type,toneMapping:s.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:s.premultipliedAlpha,doubleSided:2===s.side,flipSided:1===s.side,useDepthPacking:!!s.depthPacking,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionDerivatives:s.extensions&&s.extensions.derivatives,extensionFragDepth:s.extensions&&s.extensions.fragDepth,extensionDrawBuffers:s.extensions&&s.extensions.drawBuffers,extensionShaderTextureLOD:s.extensions&&s.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||n.has("EXT_shader_texture_lod"),customProgramCacheKey:s.customProgramCacheKey()}},getProgramCacheKey:function(t){let r=[];if(t.shaderID?r.push(t.shaderID):(r.push(t.customVertexShaderID),r.push(t.customFragmentShaderID)),void 0!==t.defines)for(let e in t.defines)r.push(e),r.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(function(e,t){e.push(t.precision),e.push(t.outputEncoding),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.combine),e.push(t.vertexUvs),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(r,t),function(e,t){o.disableAll(),t.isWebGL2&&o.enable(0),t.supportsVertexTextures&&o.enable(1),t.instancing&&o.enable(2),t.instancingColor&&o.enable(3),t.map&&o.enable(4),t.matcap&&o.enable(5),t.envMap&&o.enable(6),t.lightMap&&o.enable(7),t.aoMap&&o.enable(8),t.emissiveMap&&o.enable(9),t.bumpMap&&o.enable(10),t.normalMap&&o.enable(11),t.objectSpaceNormalMap&&o.enable(12),t.tangentSpaceNormalMap&&o.enable(13),t.clearcoat&&o.enable(14),t.clearcoatMap&&o.enable(15),t.clearcoatRoughnessMap&&o.enable(16),t.clearcoatNormalMap&&o.enable(17),t.iridescence&&o.enable(18),t.iridescenceMap&&o.enable(19),t.iridescenceThicknessMap&&o.enable(20),t.displacementMap&&o.enable(21),t.specularMap&&o.enable(22),t.roughnessMap&&o.enable(23),t.metalnessMap&&o.enable(24),t.gradientMap&&o.enable(25),t.alphaMap&&o.enable(26),t.alphaTest&&o.enable(27),t.vertexColors&&o.enable(28),t.vertexAlphas&&o.enable(29),t.vertexUvs&&o.enable(30),t.vertexTangents&&o.enable(31),t.uvsVertexOnly&&o.enable(32),e.push(o.mask),o.disableAll(),t.fog&&o.enable(0),t.useFog&&o.enable(1),t.flatShading&&o.enable(2),t.logarithmicDepthBuffer&&o.enable(3),t.skinning&&o.enable(4),t.morphTargets&&o.enable(5),t.morphNormals&&o.enable(6),t.morphColors&&o.enable(7),t.premultipliedAlpha&&o.enable(8),t.shadowMapEnabled&&o.enable(9),t.physicallyCorrectLights&&o.enable(10),t.doubleSided&&o.enable(11),t.flipSided&&o.enable(12),t.useDepthPacking&&o.enable(13),t.dithering&&o.enable(14),t.specularIntensityMap&&o.enable(15),t.specularColorMap&&o.enable(16),t.transmission&&o.enable(17),t.transmissionMap&&o.enable(18),t.thicknessMap&&o.enable(19),t.sheen&&o.enable(20),t.sheenColorMap&&o.enable(21),t.sheenRoughnessMap&&o.enable(22),t.decodeVideoTexture&&o.enable(23),t.opaque&&o.enable(24),e.push(o.mask)}(r,t),r.push(e.outputEncoding)),r.push(t.customProgramCacheKey),r.join()},getUniforms:function(e){let t,r=p[e.type];if(r){let e=WF[r];t=CF.clone(e.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,r){let n;for(let e=0,i=c.length;e<i;e++){let t=c[e];if(t.cacheKey===r){n=t,++n.usedTimes;break}}return void 0===n&&(n=new jU(e,r,t,s),c.push(n)),n},releaseProgram:function(e){if(0===--e.usedTimes){let t=c.indexOf(e);c[t]=c[c.length-1],c.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:c,dispose:function(){l.dispose()}}}function GU(){let e=new WeakMap;return{get:function(t){let r=e.get(t);return void 0===r&&(r={},e.set(t,r)),r},remove:function(t){e.delete(t)},update:function(t,r,n){e.get(t)[r]=n},dispose:function(){e=new WeakMap}}}function qU(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function XU(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function YU(){let e=[],t=0,r=[],n=[],i=[];function s(r,n,i,s,a,o){let l=e[t];return void 0===l?(l={id:r.id,object:r,geometry:n,material:i,groupOrder:s,renderOrder:r.renderOrder,z:a,group:o},e[t]=l):(l.id=r.id,l.object=r,l.geometry=n,l.material=i,l.groupOrder=s,l.renderOrder=r.renderOrder,l.z=a,l.group=o),t++,l}return{opaque:r,transmissive:n,transparent:i,init:function(){t=0,r.length=0,n.length=0,i.length=0},push:function(e,t,a,o,l,c){let u=s(e,t,a,o,l,c);a.transmission>0?n.push(u):!0===a.transparent?i.push(u):r.push(u)},unshift:function(e,t,a,o,l,c){let u=s(e,t,a,o,l,c);a.transmission>0?n.unshift(u):!0===a.transparent?i.unshift(u):r.unshift(u)},finish:function(){for(let r=t,n=e.length;r<n;r++){let t=e[r];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){r.length>1&&r.sort(e||qU),n.length>1&&n.sort(t||XU),i.length>1&&i.sort(t||XU)}}}function KU(){let e=new WeakMap;return{get:function(t,r){let n,i=e.get(t);return void 0===i?(n=new YU,e.set(t,[n])):r>=i.length?(n=new YU,i.push(n)):n=i[r],n},dispose:function(){e=new WeakMap}}}function QU(){let e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let r;switch(t.type){case"DirectionalLight":r={direction:new PB,color:new vB};break;case"SpotLight":r={position:new PB,direction:new PB,color:new vB,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new PB,color:new vB,distance:0,decay:0};break;case"HemisphereLight":r={direction:new PB,skyColor:new vB,groundColor:new vB};break;case"RectAreaLight":r={color:new vB,position:new PB,halfWidth:new PB,halfHeight:new PB}}return e[t.id]=r,r}}}var ZU=0;function JU(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function $U(e,t){let r=new QU,n=function(){let e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let r;switch(t.type){case"DirectionalLight":case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new eB};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new eB,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=r,r}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let l=0;l<9;l++)i.probe.push(new PB);let s=new PB,a=new sz,o=new sz;return{setup:function(s,a){let o=0,l=0,c=0;for(let e=0;e<9;e++)i.probe[e].set(0,0,0);let u=0,h=0,d=0,f=0,p=0,m=0,g=0,v=0,y=0,b=0;s.sort(JU);let w=!0!==a?Math.PI:1;for(let e=0,t=s.length;e<t;e++){let t=s[e],a=t.color,x=t.intensity,S=t.distance,_=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)o+=a.r*x*w,l+=a.g*x*w,c+=a.b*x*w;else if(t.isLightProbe)for(let e=0;e<9;e++)i.probe[e].addScaledVector(t.sh.coefficients[e],x);else if(t.isDirectionalLight){let e=r.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*w),t.castShadow){let e=t.shadow,r=n.get(t);r.shadowBias=e.bias,r.shadowNormalBias=e.normalBias,r.shadowRadius=e.radius,r.shadowMapSize=e.mapSize,i.directionalShadow[u]=r,i.directionalShadowMap[u]=_,i.directionalShadowMatrix[u]=t.shadow.matrix,m++}i.directional[u]=e,u++}else if(t.isSpotLight){let e=r.get(t);e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(a).multiplyScalar(x*w),e.distance=S,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,i.spot[d]=e;let s=t.shadow;if(t.map&&(i.spotLightMap[y]=t.map,y++,s.updateMatrices(t),t.castShadow&&b++),i.spotLightMatrix[d]=s.matrix,t.castShadow){let e=n.get(t);e.shadowBias=s.bias,e.shadowNormalBias=s.normalBias,e.shadowRadius=s.radius,e.shadowMapSize=s.mapSize,i.spotShadow[d]=e,i.spotShadowMap[d]=_,v++}d++}else if(t.isRectAreaLight){let e=r.get(t);e.color.copy(a).multiplyScalar(x),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),i.rectArea[f]=e,f++}else if(t.isPointLight){let e=r.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*w),e.distance=t.distance,e.decay=t.decay,t.castShadow){let e=t.shadow,r=n.get(t);r.shadowBias=e.bias,r.shadowNormalBias=e.normalBias,r.shadowRadius=e.radius,r.shadowMapSize=e.mapSize,r.shadowCameraNear=e.camera.near,r.shadowCameraFar=e.camera.far,i.pointShadow[h]=r,i.pointShadowMap[h]=_,i.pointShadowMatrix[h]=t.shadow.matrix,g++}i.point[h]=e,h++}else if(t.isHemisphereLight){let e=r.get(t);e.skyColor.copy(t.color).multiplyScalar(x*w),e.groundColor.copy(t.groundColor).multiplyScalar(x*w),i.hemi[p]=e,p++}}f>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=HF.LTC_FLOAT_1,i.rectAreaLTC2=HF.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(i.rectAreaLTC1=HF.LTC_HALF_1,i.rectAreaLTC2=HF.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=o,i.ambient[1]=l,i.ambient[2]=c;let x=i.hash;(x.directionalLength!==u||x.pointLength!==h||x.spotLength!==d||x.rectAreaLength!==f||x.hemiLength!==p||x.numDirectionalShadows!==m||x.numPointShadows!==g||x.numSpotShadows!==v||x.numSpotMaps!==y)&&(i.directional.length=u,i.spot.length=d,i.rectArea.length=f,i.point.length=h,i.hemi.length=p,i.directionalShadow.length=m,i.directionalShadowMap.length=m,i.pointShadow.length=g,i.pointShadowMap.length=g,i.spotShadow.length=v,i.spotShadowMap.length=v,i.directionalShadowMatrix.length=m,i.pointShadowMatrix.length=g,i.spotLightMatrix.length=v+y-b,i.spotLightMap.length=y,i.numSpotLightShadowsWithMaps=b,x.directionalLength=u,x.pointLength=h,x.spotLength=d,x.rectAreaLength=f,x.hemiLength=p,x.numDirectionalShadows=m,x.numPointShadows=g,x.numSpotShadows=v,x.numSpotMaps=y,i.version=ZU++)},setupView:function(e,t){let r=0,n=0,l=0,c=0,u=0,h=t.matrixWorldInverse;for(let d=0,f=e.length;d<f;d++){let t=e[d];if(t.isDirectionalLight){let e=i.directional[r];e.direction.setFromMatrixPosition(t.matrixWorld),s.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(h),r++}else if(t.isSpotLight){let e=i.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(t.matrixWorld),s.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(h),l++}else if(t.isRectAreaLight){let e=i.rectArea[c];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),o.identity(),a.copy(t.matrixWorld),a.premultiply(h),o.extractRotation(a),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(o),e.halfHeight.applyMatrix4(o),c++}else if(t.isPointLight){let e=i.point[n];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),n++}else if(t.isHemisphereLight){let e=i.hemi[u];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(h),u++}}},state:i}}function eV(e,t){let r=new $U(e,t),n=[],i=[];return{init:function(){n.length=0,i.length=0},state:{lightsArray:n,shadowsArray:i,lights:r},setupLights:function(e){r.setup(n,e)},setupLightsView:function(e){r.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){i.push(e)}}}function tV(e,t){let r=new WeakMap;return{get:function(n){let i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=r.get(n);return void 0===a?(i=new eV(e,t),r.set(n,[i])):s>=a.length?(i=new eV(e,t),a.push(i)):i=a[s],i},dispose:function(){r=new WeakMap}}}var rV=class extends Hz{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=IN,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},nV=class extends Hz{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new PB,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}};function iV(e,t,r){let n=new zF,i=new eB,s=new eB,a=new CB,o=new rV({depthPacking:3201}),l=new nV,c={},u=r.maxTextureSize,h={[IL]:1,[OL]:0,[RL]:2},d=new EF({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new eB},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=d.clone();f.defines.HORIZONTAL_PASS=1;let p=new iF;p.setAttribute("position",new Xz(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let m=new yF(p,d),g=this;function v(r,n){let s=t.update(m);d.defines.VSM_SAMPLES!==r.blurSamples&&(d.defines.VSM_SAMPLES=r.blurSamples,f.defines.VSM_SAMPLES=r.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),null===r.mapPass&&(r.mapPass=new EB(i.x,i.y)),d.uniforms.shadow_pass.value=r.map.texture,d.uniforms.resolution.value=r.mapSize,d.uniforms.radius.value=r.radius,e.setRenderTarget(r.mapPass),e.clear(),e.renderBufferDirect(n,null,s,d,m,null),f.uniforms.shadow_pass.value=r.mapPass.texture,f.uniforms.resolution.value=r.mapSize,f.uniforms.radius.value=r.radius,e.setRenderTarget(r.map),e.clear(),e.renderBufferDirect(n,null,s,f,m,null)}function y(t,r,n,i,s,a){let u=null,d=!0===n.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==d)u=d;else if(u=!0===n.isPointLight?l:o,e.localClippingEnabled&&!0===r.clipShadows&&Array.isArray(r.clippingPlanes)&&0!==r.clippingPlanes.length||r.displacementMap&&0!==r.displacementScale||r.alphaMap&&r.alphaTest>0||r.map&&r.alphaTest>0){let e=u.uuid,t=r.uuid,n=c[e];void 0===n&&(n={},c[e]=n);let i=n[t];void 0===i&&(i=u.clone(),n[t]=i),u=i}return u.visible=r.visible,u.wireframe=r.wireframe,u.side=3===a?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:h[r.side],u.alphaMap=r.alphaMap,u.alphaTest=r.alphaTest,u.map=r.map,u.clipShadows=r.clipShadows,u.clippingPlanes=r.clippingPlanes,u.clipIntersection=r.clipIntersection,u.displacementMap=r.displacementMap,u.displacementScale=r.displacementScale,u.displacementBias=r.displacementBias,u.wireframeLinewidth=r.wireframeLinewidth,u.linewidth=r.linewidth,!0===n.isPointLight&&!0===u.isMeshDistanceMaterial&&(u.referencePosition.setFromMatrixPosition(n.matrixWorld),u.nearDistance=i,u.farDistance=s),u}function b(r,i,s,a,o){if(!1===r.visible)return;if(r.layers.test(i.layers)&&(r.isMesh||r.isLine||r.isPoints)&&(r.castShadow||r.receiveShadow&&3===o)&&(!r.frustumCulled||n.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,r.matrixWorld);let n=t.update(r),i=r.material;if(Array.isArray(i)){let t=n.groups;for(let l=0,c=t.length;l<c;l++){let c=t[l],u=i[c.materialIndex];if(u&&u.visible){let t=y(r,u,a,s.near,s.far,o);e.renderBufferDirect(s,null,n,t,r,c)}}}else if(i.visible){let t=y(r,i,a,s.near,s.far,o);e.renderBufferDirect(s,null,n,t,r,null)}}let l=r.children;for(let e=0,t=l.length;e<t;e++)b(l[e],i,s,a,o)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,r,o){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===t.length)return;let l=e.getRenderTarget(),c=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),d=e.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let f=0,p=t.length;f<p;f++){let l=t[f],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;i.copy(c.mapSize);let h=c.getFrameExtents();if(i.multiply(h),s.copy(c.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(s.x=Math.floor(u/h.x),i.x=s.x*h.x,c.mapSize.x=s.x),i.y>u&&(s.y=Math.floor(u/h.y),i.y=s.y*h.y,c.mapSize.y=s.y)),null===c.map){let e=3!==this.type?{minFilter:tN,magFilter:tN}:{};c.map=new EB(i.x,i.y,e),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}e.setRenderTarget(c.map),e.clear();let p=c.getViewportCount();for(let e=0;e<p;e++){let t=c.getViewport(e);a.set(s.x*t.x,s.y*t.y,s.x*t.z,s.y*t.w),d.viewport(a),c.updateMatrices(l,e),n=c.getFrustum(),b(r,o,c.camera,l,this.type)}!0!==c.isPointLightShadow&&3===this.type&&v(c,o),c.needsUpdate=!1}g.needsUpdate=!1,e.setRenderTarget(l,c,h)}}function sV(e,t,r){let n=r.isWebGL2;let i=new function(){let t=!1,r=new CB,n=null,i=new CB(0,0,0,0);return{setMask:function(r){n!==r&&!t&&(e.colorMask(r,r,r,r),n=r)},setLocked:function(e){t=e},setClear:function(t,n,s,a,o){!0===o&&(t*=a,n*=a,s*=a),r.set(t,n,s,a),!1===i.equals(r)&&(e.clearColor(t,n,s,a),i.copy(r))},reset:function(){t=!1,n=null,i.set(-1,0,0,0)}}},s=new function(){let t=!1,r=null,n=null,i=null;return{setTest:function(e){e?j(2929):U(2929)},setMask:function(n){r!==n&&!t&&(e.depthMask(n),r=n)},setFunc:function(t){if(n!==t){switch(t){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:default:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517)}n=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,r=null,n=null,i=null}}},a=new function(){let t=!1,r=null,n=null,i=null,s=null,a=null,o=null,l=null,c=null;return{setTest:function(e){t||(e?j(2960):U(2960))},setMask:function(n){r!==n&&!t&&(e.stencilMask(n),r=n)},setFunc:function(t,r,a){(n!==t||i!==r||s!==a)&&(e.stencilFunc(t,r,a),n=t,i=r,s=a)},setOp:function(t,r,n){(a!==t||o!==r||l!==n)&&(e.stencilOp(t,r,n),a=t,o=r,l=n)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,r=null,n=null,i=null,s=null,a=null,o=null,l=null,c=null}}},o=new WeakMap,l=new WeakMap,c={},u={},h=new WeakMap,d=[],f=null,p=!1,m=null,g=null,v=null,y=null,b=null,w=null,x=null,S=!1,_=null,C=null,E=null,A=null,M=null,T=e.getParameter(35661),P=!1,k=0,D=e.getParameter(7938);-1!==D.indexOf("WebGL")?(k=parseFloat(/^WebGL (\d)/.exec(D)[1]),P=k>=1):-1!==D.indexOf("OpenGL ES")&&(k=parseFloat(/^OpenGL ES (\d)/.exec(D)[1]),P=k>=2);let I=null,O={},R=e.getParameter(3088),L=e.getParameter(2978),N=(new CB).fromArray(R),B=(new CB).fromArray(L);function z(t,r,n){let i=new Uint8Array(4),s=e.createTexture();e.bindTexture(t,s),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let a=0;a<n;a++)e.texImage2D(r+a,0,6408,1,1,0,6408,5121,i);return s}let F={};function j(t){!0!==c[t]&&(e.enable(t),c[t]=!0)}function U(t){!1!==c[t]&&(e.disable(t),c[t]=!1)}F[3553]=z(3553,3553,1),F[34067]=z(34067,34069,6),i.setClear(0,0,0,1),s.setClear(1),a.setClear(0),j(2929),s.setFunc(3),G(!1),q(1),j(2884),W(0);let V={[LL]:32774,[NL]:32778,[BL]:32779};if(n)V[103]=32775,V[104]=32776;else{let e=t.get("EXT_blend_minmax");null!==e&&(V[103]=e.MIN_EXT,V[104]=e.MAX_EXT)}let H={[zL]:0,[FL]:1,[jL]:768,[VL]:770,[YL]:776,[qL]:774,[WL]:772,[UL]:769,[HL]:771,[XL]:775,[GL]:773};function W(t,r,n,i,s,a,o,l){if(0!==t){if(!1===p&&(j(3042),p=!0),5===t)s=s||r,a=a||n,o=o||i,(r!==g||s!==b)&&(e.blendEquationSeparate(V[r],V[s]),g=r,b=s),(n!==v||i!==y||a!==w||o!==x)&&(e.blendFuncSeparate(H[n],H[i],H[a],H[o]),v=n,y=i,w=a,x=o),m=t,S=!1;else if(t!==m||l!==S){if((g!==LL||b!==LL)&&(e.blendEquation(32774),g=LL,b=LL),l)switch(t){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,769,0,1);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFuncSeparate(0,769,0,1);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}v=null,y=null,w=null,x=null,m=t,S=l}}else!0===p&&(U(3042),p=!1)}function G(t){_!==t&&(t?e.frontFace(2304):e.frontFace(2305),_=t)}function q(t){0!==t?(j(2884),t!==C&&(1===t?e.cullFace(1029):2===t?e.cullFace(1028):e.cullFace(1032))):U(2884),C=t}function X(t,r,n){t?(j(32823),(A!==r||M!==n)&&(e.polygonOffset(r,n),A=r,M=n)):U(32823)}return{buffers:{color:i,depth:s,stencil:a},enable:j,disable:U,bindFramebuffer:function(t,r){return u[t]!==r&&(e.bindFramebuffer(t,r),u[t]=r,n&&(36009===t&&(u[36160]=r),36160===t&&(u[36009]=r)),!0)},drawBuffers:function(n,i){let s=d,a=!1;if(n)if(s=h.get(i),void 0===s&&(s=[],h.set(i,s)),n.isWebGLMultipleRenderTargets){let e=n.texture;if(s.length!==e.length||36064!==s[0]){for(let t=0,r=e.length;t<r;t++)s[t]=36064+t;s.length=e.length,a=!0}}else 36064!==s[0]&&(s[0]=36064,a=!0);else 1029!==s[0]&&(s[0]=1029,a=!0);a&&(r.isWebGL2?e.drawBuffers(s):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(s))},useProgram:function(t){return f!==t&&(e.useProgram(t),f=t,!0)},setBlending:W,setMaterial:function(e,t){2===e.side?U(2884):j(2884);let r=1===e.side;t&&(r=!r),G(r),1===e.blending&&!1===e.transparent?W(0):W(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),s.setFunc(e.depthFunc),s.setTest(e.depthTest),s.setMask(e.depthWrite),i.setMask(e.colorWrite);let n=e.stencilWrite;a.setTest(n),n&&(a.setMask(e.stencilWriteMask),a.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),a.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),X(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?j(32926):U(32926)},setFlipSided:G,setCullFace:q,setLineWidth:function(t){t!==E&&(P&&e.lineWidth(t),E=t)},setPolygonOffset:X,setScissorTest:function(e){e?j(3089):U(3089)},activeTexture:function(t){void 0===t&&(t=33984+T-1),I!==t&&(e.activeTexture(t),I=t)},bindTexture:function(t,r,n){void 0===n&&(n=null===I?33984+T-1:I);let i=O[n];void 0===i&&(i={type:void 0,texture:void 0},O[n]=i),(i.type!==t||i.texture!==r)&&(I!==n&&(e.activeTexture(n),I=n),e.bindTexture(t,r||F[t]),i.type=t,i.texture=r)},unbindTexture:function(){let t=O[I];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(_C){console.error("THREE.WebGLState:",_C)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(_C){console.error("THREE.WebGLState:",_C)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(_C){console.error("THREE.WebGLState:",_C)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(_C){console.error("THREE.WebGLState:",_C)}},updateUBOMapping:function(t,r){let n=l.get(r);void 0===n&&(n=new WeakMap,l.set(r,n));let i=n.get(t);void 0===i&&(i=e.getUniformBlockIndex(r,t.name),n.set(t,i))},uniformBlockBinding:function(t,r){let n=l.get(r).get(t);o.get(r)!==n&&(e.uniformBlockBinding(r,n,t.__bindingPointIndex),o.set(r,n))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(_C){console.error("THREE.WebGLState:",_C)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(_C){console.error("THREE.WebGLState:",_C)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(_C){console.error("THREE.WebGLState:",_C)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(_C){console.error("THREE.WebGLState:",_C)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(_C){console.error("THREE.WebGLState:",_C)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(_C){console.error("THREE.WebGLState:",_C)}},scissor:function(t){!1===N.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),N.copy(t))},viewport:function(t){!1===B.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),B.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===n&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),c={},I=null,O={},u={},h=new WeakMap,d=[],f=null,p=!1,m=null,g=null,v=null,y=null,b=null,w=null,x=null,S=!1,_=null,C=null,E=null,A=null,M=null,N.set(0,0,e.canvas.width,e.canvas.height),B.set(0,0,e.canvas.width,e.canvas.height),i.reset(),s.reset(),a.reset()}}}function aV(e,t,r,n,i,s,a){let o,l=i.isWebGL2,c=i.maxTextures,u=i.maxCubemapSize,h=i.maxTextureSize,d=i.maxSamples,f=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,p=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),m=new WeakMap,g=new WeakMap,v=!1;try{v=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(V){}function y(e,t){return v?new OffscreenCanvas(e,t):aB("canvas")}function b(e,t,r,n){let i=1;if((e.width>n||e.height>n)&&(i=n/Math.max(e.width,e.height)),i<1||!0===t){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let n=t?QN:Math.floor,s=n(i*e.width),a=n(i*e.height);void 0===o&&(o=y(s,a));let l=r?y(s,a):o;return l.width=s,l.height=a,l.getContext("2d").drawImage(e,0,0,s,a),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+s+"x"+a+")."),l}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function w(e){return YN(e.width)&&YN(e.height)}function x(e,t){return e.generateMipmaps&&t&&e.minFilter!==tN&&e.minFilter!==iN}function S(t){e.generateMipmap(t)}function _(r,n,i,s){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!1===l)return n;if(null!==r){if(void 0!==e[r])return e[r];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+r+"'")}let o=n;return 6403===n&&(5126===i&&(o=33326),5131===i&&(o=33325),5121===i&&(o=33321)),33319===n&&(5126===i&&(o=33328),5131===i&&(o=33327),5121===i&&(o=33323)),6408===n&&(5126===i&&(o=34836),5131===i&&(o=34842),5121===i&&(o=s===DN&&!1===a?35907:32856),32819===i&&(o=32854),32820===i&&(o=32855)),(33325===o||33326===o||33327===o||33328===o||34842===o||34836===o)&&t.get("EXT_color_buffer_float"),o}function C(e,t,r){return!0===x(e,r)||e.isFramebufferTexture&&e.minFilter!==tN&&e.minFilter!==iN?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function E(e){return e===tN||1004===e||e===nN?9728:9729}function A(e){let t=e.target;t.removeEventListener("dispose",A),function(e){let t=n.get(e);if(void 0===t.__webglInit)return;let r=e.source,i=g.get(r);if(i){let n=i[t.__cacheKey];n.usedTimes--,0===n.usedTimes&&T(e),0===Object.keys(i).length&&g.delete(r)}n.remove(e)}(t),t.isVideoTexture&&m.delete(t)}function M(t){let r=t.target;r.removeEventListener("dispose",M),function(t){let r=t.texture,i=n.get(t),s=n.get(r);if(void 0!==s.__webglTexture&&(e.deleteTexture(s.__webglTexture),a.memory.textures--),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(let n=0;n<6;n++)e.deleteFramebuffer(i.__webglFramebuffer[n]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[n]);else{if(e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer)for(let t=0;t<i.__webglColorRenderbuffer.length;t++)i.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(i.__webglColorRenderbuffer[t]);i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer)}if(t.isWebGLMultipleRenderTargets)for(let o=0,l=r.length;o<l;o++){let t=n.get(r[o]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),a.memory.textures--),n.remove(r[o])}n.remove(r),n.remove(t)}(r)}function T(t){let r=n.get(t);e.deleteTexture(r.__webglTexture);let i=t.source;delete g.get(i)[r.__cacheKey],a.memory.textures--}let P=0;function k(e,t){let i=n.get(e);if(e.isVideoTexture&&function(e){let t=a.render.frame;m.get(e)!==t&&(m.set(e,t),e.update())}(e),!1===e.isRenderTargetTexture&&e.version>0&&i.__version!==e.version){let r=e.image;if(null===r)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==r.complete)return void L(i,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}r.bindTexture(3553,i.__webglTexture,33984+t)}let D={[JL]:10497,[$L]:33071,[eN]:33648},I={[tN]:9728,[rN]:9984,[nN]:9986,[iN]:9729,[sN]:9985,[aN]:9987};function O(r,s,a){if(a?(e.texParameteri(r,10242,D[s.wrapS]),e.texParameteri(r,10243,D[s.wrapT]),(32879===r||35866===r)&&e.texParameteri(r,32882,D[s.wrapR]),e.texParameteri(r,10240,I[s.magFilter]),e.texParameteri(r,10241,I[s.minFilter])):(e.texParameteri(r,10242,33071),e.texParameteri(r,10243,33071),(32879===r||35866===r)&&e.texParameteri(r,32882,33071),(s.wrapS!==$L||s.wrapT!==$L)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(r,10240,E(s.magFilter)),e.texParameteri(r,10241,E(s.minFilter)),s.minFilter!==tN&&s.minFilter!==iN&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){let a=t.get("EXT_texture_filter_anisotropic");if(s.magFilter===tN||s.minFilter!==nN&&s.minFilter!==aN||s.type===cN&&!1===t.has("OES_texture_float_linear")||!1===l&&s.type===uN&&!1===t.has("OES_texture_half_float_linear"))return;(s.anisotropy>1||n.get(s).__currentAnisotropy)&&(e.texParameterf(r,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,i.getMaxAnisotropy())),n.get(s).__currentAnisotropy=s.anisotropy)}}function R(t,r){let n=!1;void 0===t.__webglInit&&(t.__webglInit=!0,r.addEventListener("dispose",A));let i=r.source,s=g.get(i);void 0===s&&(s={},g.set(i,s));let o=function(e){let t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.encoding),t.join()}(r);if(o!==t.__cacheKey){void 0===s[o]&&(s[o]={texture:e.createTexture(),usedTimes:0},a.memory.textures++,n=!0),s[o].usedTimes++;let i=s[t.__cacheKey];void 0!==i&&(s[t.__cacheKey].usedTimes--,0===i.usedTimes&&T(r)),t.__cacheKey=o,t.__webglTexture=s[o].texture}return n}function L(t,i,a){let o=3553;(i.isDataArrayTexture||i.isCompressedArrayTexture)&&(o=35866),i.isData3DTexture&&(o=32879);let c=R(t,i),u=i.source;r.bindTexture(o,t.__webglTexture,33984+a);let d=n.get(u);if(u.version!==d.__version||!0===c){r.activeTexture(33984+a),e.pixelStorei(37440,i.flipY),e.pixelStorei(37441,i.premultiplyAlpha),e.pixelStorei(3317,i.unpackAlignment),e.pixelStorei(37443,0);let t=function(e){return!l&&(e.wrapS!==$L||e.wrapT!==$L||e.minFilter!==tN&&e.minFilter!==iN)}(i)&&!1===w(i.image),n=b(i.image,t,!1,h);n=U(i,n);let f=w(n)||l,p=s.convert(i.format,i.encoding),m=s.convert(i.type),g=_(i.internalFormat,p,m,i.encoding,i.isVideoTexture);O(o,i,f);let v,y=i.mipmaps,E=l&&!0!==i.isVideoTexture,A=void 0===d.__version||!0===c,M=C(i,n,f);if(i.isDepthTexture)g=6402,l?g=i.type===cN?36012:i.type===lN?33190:i.type===hN?35056:33189:i.type===cN&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),i.format===fN&&6402===g&&1012!==i.type&&i.type!==lN&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=lN,m=s.convert(i.type)),i.format===pN&&6402===g&&(g=34041,i.type!==hN&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=hN,m=s.convert(i.type))),A&&(E?r.texStorage2D(3553,1,g,n.width,n.height):r.texImage2D(3553,0,g,n.width,n.height,0,p,m,null));else if(i.isDataTexture)if(y.length>0&&f){E&&A&&r.texStorage2D(3553,M,g,y[0].width,y[0].height);for(let e=0,t=y.length;e<t;e++)v=y[e],E?r.texSubImage2D(3553,e,0,0,v.width,v.height,p,m,v.data):r.texImage2D(3553,e,g,v.width,v.height,0,p,m,v.data);i.generateMipmaps=!1}else E?(A&&r.texStorage2D(3553,M,g,n.width,n.height),r.texSubImage2D(3553,0,0,0,n.width,n.height,p,m,n.data)):r.texImage2D(3553,0,g,n.width,n.height,0,p,m,n.data);else if(i.isCompressedTexture)if(i.isCompressedArrayTexture){E&&A&&r.texStorage3D(35866,M,g,y[0].width,y[0].height,n.depth);for(let e=0,t=y.length;e<t;e++)v=y[e],i.format!==dN?null!==p?E?r.compressedTexSubImage3D(35866,e,0,0,0,v.width,v.height,n.depth,p,v.data,0,0):r.compressedTexImage3D(35866,e,g,v.width,v.height,n.depth,0,v.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):E?r.texSubImage3D(35866,e,0,0,0,v.width,v.height,n.depth,p,m,v.data):r.texImage3D(35866,e,g,v.width,v.height,n.depth,0,p,m,v.data)}else{E&&A&&r.texStorage2D(3553,M,g,y[0].width,y[0].height);for(let e=0,t=y.length;e<t;e++)v=y[e],i.format!==dN?null!==p?E?r.compressedTexSubImage2D(3553,e,0,0,v.width,v.height,p,v.data):r.compressedTexImage2D(3553,e,g,v.width,v.height,0,v.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):E?r.texSubImage2D(3553,e,0,0,v.width,v.height,p,m,v.data):r.texImage2D(3553,e,g,v.width,v.height,0,p,m,v.data)}else if(i.isDataArrayTexture)E?(A&&r.texStorage3D(35866,M,g,n.width,n.height,n.depth),r.texSubImage3D(35866,0,0,0,0,n.width,n.height,n.depth,p,m,n.data)):r.texImage3D(35866,0,g,n.width,n.height,n.depth,0,p,m,n.data);else if(i.isData3DTexture)E?(A&&r.texStorage3D(32879,M,g,n.width,n.height,n.depth),r.texSubImage3D(32879,0,0,0,0,n.width,n.height,n.depth,p,m,n.data)):r.texImage3D(32879,0,g,n.width,n.height,n.depth,0,p,m,n.data);else if(i.isFramebufferTexture){if(A)if(E)r.texStorage2D(3553,M,g,n.width,n.height);else{let e=n.width,t=n.height;for(let n=0;n<M;n++)r.texImage2D(3553,n,g,e,t,0,p,m,null),e>>=1,t>>=1}}else if(y.length>0&&f){E&&A&&r.texStorage2D(3553,M,g,y[0].width,y[0].height);for(let e=0,t=y.length;e<t;e++)v=y[e],E?r.texSubImage2D(3553,e,0,0,p,m,v):r.texImage2D(3553,e,g,p,m,v);i.generateMipmaps=!1}else E?(A&&r.texStorage2D(3553,M,g,n.width,n.height),r.texSubImage2D(3553,0,0,0,p,m,n)):r.texImage2D(3553,0,g,p,m,n);x(i,f)&&S(o),d.__version=u.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}function N(t,i,a,o,l){let c=s.convert(a.format,a.encoding),u=s.convert(a.type),h=_(a.internalFormat,c,u,a.encoding);n.get(i).__hasExternalTextures||(32879===l||35866===l?r.texImage3D(l,0,h,i.width,i.height,i.depth,0,c,u,null):r.texImage2D(l,0,h,i.width,i.height,0,c,u,null)),r.bindFramebuffer(36160,t),j(i)?f.framebufferTexture2DMultisampleEXT(36160,o,l,n.get(a).__webglTexture,0,F(i)):(3553===l||l>=34069&&l<=34074)&&e.framebufferTexture2D(36160,o,l,n.get(a).__webglTexture,0),r.bindFramebuffer(36160,null)}function B(t,r,n){if(e.bindRenderbuffer(36161,t),r.depthBuffer&&!r.stencilBuffer){let i=33189;if(n||j(r)){let t=r.depthTexture;t&&t.isDepthTexture&&(t.type===cN?i=36012:t.type===lN&&(i=33190));let n=F(r);j(r)?f.renderbufferStorageMultisampleEXT(36161,n,i,r.width,r.height):e.renderbufferStorageMultisample(36161,n,i,r.width,r.height)}else e.renderbufferStorage(36161,i,r.width,r.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(r.depthBuffer&&r.stencilBuffer){let i=F(r);n&&!1===j(r)?e.renderbufferStorageMultisample(36161,i,35056,r.width,r.height):j(r)?f.renderbufferStorageMultisampleEXT(36161,i,35056,r.width,r.height):e.renderbufferStorage(36161,34041,r.width,r.height),e.framebufferRenderbuffer(36160,33306,36161,t)}else{let t=!0===r.isWebGLMultipleRenderTargets?r.texture:[r.texture];for(let i=0;i<t.length;i++){let a=t[i],o=s.convert(a.format,a.encoding),l=s.convert(a.type),c=_(a.internalFormat,o,l,a.encoding),u=F(r);n&&!1===j(r)?e.renderbufferStorageMultisample(36161,u,c,r.width,r.height):j(r)?f.renderbufferStorageMultisampleEXT(36161,u,c,r.width,r.height):e.renderbufferStorage(36161,c,r.width,r.height)}}e.bindRenderbuffer(36161,null)}function z(t){let i=n.get(t),s=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(36160,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(i.depthTexture).__webglTexture||i.depthTexture.image.width!==i.width||i.depthTexture.image.height!==i.height)&&(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),k(i.depthTexture,0);let s=n.get(i.depthTexture).__webglTexture,a=F(i);if(i.depthTexture.format===fN)j(i)?f.framebufferTexture2DMultisampleEXT(36160,36096,3553,s,0,a):e.framebufferTexture2D(36160,36096,3553,s,0);else{if(i.depthTexture.format!==pN)throw new Error("Unknown depthTexture format");j(i)?f.framebufferTexture2DMultisampleEXT(36160,33306,3553,s,0,a):e.framebufferTexture2D(36160,33306,3553,s,0)}}(i.__webglFramebuffer,t)}else if(s){i.__webglDepthbuffer=[];for(let n=0;n<6;n++)r.bindFramebuffer(36160,i.__webglFramebuffer[n]),i.__webglDepthbuffer[n]=e.createRenderbuffer(),B(i.__webglDepthbuffer[n],t,!1)}else r.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),B(i.__webglDepthbuffer,t,!1);r.bindFramebuffer(36160,null)}function F(e){return Math.min(d,e.samples)}function j(e){let r=n.get(e);return l&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==r.__useRenderToTexture}function U(e,r){let n=e.encoding,i=e.format,s=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||e.format===zN||n!==kN&&(n===DN?!1===l?!0===t.has("EXT_sRGB")&&i===dN?(e.format=zN,e.minFilter=iN,e.generateMipmaps=!1):r=bB.sRGBToLinear(r):(i!==dN||s!==oN)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",n)),r}this.allocateTextureUnit=function(){let e=P;return e>=c&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+c),P+=1,e},this.resetTextureUnits=function(){P=0},this.setTexture2D=k,this.setTexture2DArray=function(e,t){let i=n.get(e);e.version>0&&i.__version!==e.version?L(i,e,t):r.bindTexture(35866,i.__webglTexture,33984+t)},this.setTexture3D=function(e,t){let i=n.get(e);e.version>0&&i.__version!==e.version?L(i,e,t):r.bindTexture(32879,i.__webglTexture,33984+t)},this.setTextureCube=function(t,i){let a=n.get(t);t.version>0&&a.__version!==t.version?function(t,i,a){if(6!==i.image.length)return;let o=R(t,i),c=i.source;r.bindTexture(34067,t.__webglTexture,33984+a);let h=n.get(c);if(c.version!==h.__version||!0===o){r.activeTexture(33984+a),e.pixelStorei(37440,i.flipY),e.pixelStorei(37441,i.premultiplyAlpha),e.pixelStorei(3317,i.unpackAlignment),e.pixelStorei(37443,0);let t=i.isCompressedTexture||i.image[0].isCompressedTexture,n=i.image[0]&&i.image[0].isDataTexture,d=[];for(let e=0;e<6;e++)d[e]=t||n?n?i.image[e].image:i.image[e]:b(i.image[e],!1,!0,u),d[e]=U(i,d[e]);let f,p=d[0],m=w(p)||l,g=s.convert(i.format,i.encoding),v=s.convert(i.type),y=_(i.internalFormat,g,v,i.encoding),E=l&&!0!==i.isVideoTexture,A=void 0===h.__version||!0===o,M=C(i,p,m);if(O(34067,i,m),t){E&&A&&r.texStorage2D(34067,M,y,p.width,p.height);for(let e=0;e<6;e++){f=d[e].mipmaps;for(let t=0;t<f.length;t++){let n=f[t];i.format!==dN?null!==g?E?r.compressedTexSubImage2D(34069+e,t,0,0,n.width,n.height,g,n.data):r.compressedTexImage2D(34069+e,t,y,n.width,n.height,0,n.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):E?r.texSubImage2D(34069+e,t,0,0,n.width,n.height,g,v,n.data):r.texImage2D(34069+e,t,y,n.width,n.height,0,g,v,n.data)}}}else{f=i.mipmaps,E&&A&&(f.length>0&&M++,r.texStorage2D(34067,M,y,d[0].width,d[0].height));for(let e=0;e<6;e++)if(n){E?r.texSubImage2D(34069+e,0,0,0,d[e].width,d[e].height,g,v,d[e].data):r.texImage2D(34069+e,0,y,d[e].width,d[e].height,0,g,v,d[e].data);for(let t=0;t<f.length;t++){let n=f[t].image[e].image;E?r.texSubImage2D(34069+e,t+1,0,0,n.width,n.height,g,v,n.data):r.texImage2D(34069+e,t+1,y,n.width,n.height,0,g,v,n.data)}}else{E?r.texSubImage2D(34069+e,0,0,0,g,v,d[e]):r.texImage2D(34069+e,0,y,g,v,d[e]);for(let t=0;t<f.length;t++){let n=f[t];E?r.texSubImage2D(34069+e,t+1,0,0,g,v,n.image[e]):r.texImage2D(34069+e,t+1,y,g,v,n.image[e])}}}x(i,m)&&S(34067),h.__version=c.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}(a,t,i):r.bindTexture(34067,a.__webglTexture,33984+i)},this.rebindTextures=function(e,t,r){let i=n.get(e);void 0!==t&&N(i.__webglFramebuffer,e,e.texture,36064,3553),void 0!==r&&z(e)},this.setupRenderTarget=function(t){let o=t.texture,c=n.get(t),u=n.get(o);t.addEventListener("dispose",M),!0!==t.isWebGLMultipleRenderTargets&&(void 0===u.__webglTexture&&(u.__webglTexture=e.createTexture()),u.__version=o.version,a.memory.textures++);let h=!0===t.isWebGLCubeRenderTarget,d=!0===t.isWebGLMultipleRenderTargets,f=w(t)||l;if(h){c.__webglFramebuffer=[];for(let t=0;t<6;t++)c.__webglFramebuffer[t]=e.createFramebuffer()}else{if(c.__webglFramebuffer=e.createFramebuffer(),d)if(i.drawBuffers){let r=t.texture;for(let t=0,i=r.length;t<i;t++){let i=n.get(r[t]);void 0===i.__webglTexture&&(i.__webglTexture=e.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(l&&t.samples>0&&!1===j(t)){let n=d?o:[o];c.__webglMultisampledFramebuffer=e.createFramebuffer(),c.__webglColorRenderbuffer=[],r.bindFramebuffer(36160,c.__webglMultisampledFramebuffer);for(let r=0;r<n.length;r++){let i=n[r];c.__webglColorRenderbuffer[r]=e.createRenderbuffer(),e.bindRenderbuffer(36161,c.__webglColorRenderbuffer[r]);let a=s.convert(i.format,i.encoding),o=s.convert(i.type),l=_(i.internalFormat,a,o,i.encoding,!0===t.isXRRenderTarget),u=F(t);e.renderbufferStorageMultisample(36161,u,l,t.width,t.height),e.framebufferRenderbuffer(36160,36064+r,36161,c.__webglColorRenderbuffer[r])}e.bindRenderbuffer(36161,null),t.depthBuffer&&(c.__webglDepthRenderbuffer=e.createRenderbuffer(),B(c.__webglDepthRenderbuffer,t,!0)),r.bindFramebuffer(36160,null)}}if(h){r.bindTexture(34067,u.__webglTexture),O(34067,o,f);for(let e=0;e<6;e++)N(c.__webglFramebuffer[e],t,o,36064,34069+e);x(o,f)&&S(34067),r.unbindTexture()}else if(d){let e=t.texture;for(let i=0,s=e.length;i<s;i++){let s=e[i],a=n.get(s);r.bindTexture(3553,a.__webglTexture),O(3553,s,f),N(c.__webglFramebuffer,t,s,36064+i,3553),x(s,f)&&S(3553)}r.unbindTexture()}else{let e=3553;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(l?e=t.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),r.bindTexture(e,u.__webglTexture),O(e,o,f),N(c.__webglFramebuffer,t,o,36064,e),x(o,f)&&S(e),r.unbindTexture()}t.depthBuffer&&z(t)},this.updateRenderTargetMipmap=function(e){let t=w(e)||l,i=!0===e.isWebGLMultipleRenderTargets?e.texture:[e.texture];for(let s=0,a=i.length;s<a;s++){let a=i[s];if(x(a,t)){let t=e.isWebGLCubeRenderTarget?34067:3553,i=n.get(a).__webglTexture;r.bindTexture(t,i),S(t),r.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(l&&t.samples>0&&!1===j(t)){let i=t.isWebGLMultipleRenderTargets?t.texture:[t.texture],s=t.width,a=t.height,o=16384,l=[],c=t.stencilBuffer?33306:36096,u=n.get(t),h=!0===t.isWebGLMultipleRenderTargets;if(h)for(let t=0;t<i.length;t++)r.bindFramebuffer(36160,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+t,36161,null),r.bindFramebuffer(36160,u.__webglFramebuffer),e.framebufferTexture2D(36009,36064+t,3553,null,0);r.bindFramebuffer(36008,u.__webglMultisampledFramebuffer),r.bindFramebuffer(36009,u.__webglFramebuffer);for(let r=0;r<i.length;r++){l.push(36064+r),t.depthBuffer&&l.push(c);let d=void 0!==u.__ignoreDepthValues&&u.__ignoreDepthValues;if(!1===d&&(t.depthBuffer&&(o|=256),t.stencilBuffer&&(o|=1024)),h&&e.framebufferRenderbuffer(36008,36064,36161,u.__webglColorRenderbuffer[r]),!0===d&&(e.invalidateFramebuffer(36008,[c]),e.invalidateFramebuffer(36009,[c])),h){let t=n.get(i[r]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,t,0)}e.blitFramebuffer(0,0,s,a,0,0,s,a,o,9728),p&&e.invalidateFramebuffer(36008,l)}if(r.bindFramebuffer(36008,null),r.bindFramebuffer(36009,null),h)for(let t=0;t<i.length;t++){r.bindFramebuffer(36160,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+t,36161,u.__webglColorRenderbuffer[t]);let s=n.get(i[t]).__webglTexture;r.bindFramebuffer(36160,u.__webglFramebuffer),e.framebufferTexture2D(36009,36064+t,3553,s,0)}r.bindFramebuffer(36009,u.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=z,this.setupFrameBufferTexture=N,this.useMultisampledRTT=j}function oV(e,t,r){let n=r.isWebGL2;return{convert:function(r){let i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(r===oN)return 5121;if(1017===r)return 32819;if(1018===r)return 32820;if(1010===r)return 5120;if(1011===r)return 5122;if(1012===r)return 5123;if(1013===r)return 5124;if(r===lN)return 5125;if(r===cN)return 5126;if(r===uN)return n?5131:(i=t.get("OES_texture_half_float"),null!==i?i.HALF_FLOAT_OES:null);if(1021===r)return 6406;if(r===dN)return 6408;if(1024===r)return 6409;if(1025===r)return 6410;if(r===fN)return 6402;if(r===pN)return 34041;if(r===zN)return i=t.get("EXT_sRGB"),null!==i?i.SRGB_ALPHA_EXT:null;if(r===mN)return 6403;if(1029===r)return 36244;if(r===gN)return 33319;if(1031===r)return 33320;if(1033===r)return 36249;if(r===vN||r===yN||r===bN||r===wN)if(s===DN){if(i=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(r===vN)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===yN)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===bN)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===wN)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=t.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(r===vN)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===yN)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===bN)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===wN)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===r||35841===r||35842===r||35843===r){if(i=t.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(35840===r)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===r)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===r)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===r)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===r)return i=t.get("WEBGL_compressed_texture_etc1"),null!==i?i.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===r||37496===r){if(i=t.get("WEBGL_compressed_texture_etc"),null===i)return null;if(37492===r)return s===DN?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(37496===r)return s===DN?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(37808===r||37809===r||37810===r||37811===r||37812===r||37813===r||37814===r||37815===r||37816===r||37817===r||37818===r||37819===r||37820===r||37821===r){if(i=t.get("WEBGL_compressed_texture_astc"),null===i)return null;if(37808===r)return s===DN?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===r)return s===DN?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===r)return s===DN?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===r)return s===DN?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===r)return s===DN?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===r)return s===DN?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===r)return s===DN?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===r)return s===DN?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===r)return s===DN?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===r)return s===DN?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===r)return s===DN?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===r)return s===DN?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===r)return s===DN?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===r)return s===DN?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(r===xN){if(i=t.get("EXT_texture_compression_bptc"),null===i)return null;if(r===xN)return s===DN?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===r||36284===r||36285===r||36286===r){if(i=t.get("EXT_texture_compression_rgtc"),null===i)return null;if(r===xN)return i.COMPRESSED_RED_RGTC1_EXT;if(36284===r)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===r)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===r)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return r===hN?n?34042:(i=t.get("WEBGL_depth_texture"),null!==i?i.UNSIGNED_INT_24_8_WEBGL:null):void 0!==e[r]?e[r]:null}}}var lV=class extends MF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isArrayCamera=!0,this.cameras=e}},cV=class extends kz{constructor(){super(),this.isGroup=!0,this.type="Group"}},uV={type:"move"},hV=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new cV,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new cV,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new PB,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new PB),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new cV,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new PB,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new PB),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,r){let n=null,i=null,s=null,a=this._targetRay,o=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){s=!0;for(let s of e.hand.values()){let e=t.getJointPose(s,r),n=this._getHandJoint(l,s);null!==e&&(n.matrix.fromArray(e.transform.matrix),n.matrix.decompose(n.position,n.rotation,n.scale),n.jointRadius=e.radius),n.visible=null!==e}let n=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],a=n.position.distanceTo(i.position),o=.02,c=.005;l.inputState.pinching&&a>o+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&a<=o-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==o&&e.gripSpace&&(i=t.getPose(e.gripSpace,r),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1));null!==a&&(n=t.getPose(e.targetRaySpace,r),null===n&&null!==i&&(n=i),null!==n&&(a.matrix.fromArray(n.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),n.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(n.linearVelocity)):a.hasLinearVelocity=!1,n.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(n.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(uV)))}return null!==a&&(a.visible=null!==n),null!==o&&(o.visible=null!==i),null!==l&&(l.visible=null!==s),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){let r=new cV;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}},dV=class extends _B{constructor(e,t,r,n,i,s,a,o,l,c){if((c=void 0!==c?c:fN)!==fN&&c!==pN)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&c===fN&&(r=lN),void 0===r&&c===pN&&(r=hN),super(null,n,i,s,a,o,c,r,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:tN,this.minFilter=void 0!==o?o:tN,this.flipY=!1,this.generateMipmaps=!1}},fV=class extends FN{constructor(e,t){super();let r=this,n=null,i=1,s=null,a="local-floor",o=1,l=null,c=null,u=null,h=null,d=null,f=null,p=t.getContextAttributes(),m=null,g=null,v=[],y=[],b=new Set,w=new Map,x=new MF;x.layers.enable(1),x.viewport=new CB;let S=new MF;S.layers.enable(2),S.viewport=new CB;let _=[x,S],C=new lV;C.layers.enable(1),C.layers.enable(2);let E=null,A=null;function M(e){let t=y.indexOf(e.inputSource);if(-1===t)return;let r=v[t];void 0!==r&&r.dispatchEvent({type:e.type,data:e.inputSource})}function T(){n.removeEventListener("select",M),n.removeEventListener("selectstart",M),n.removeEventListener("selectend",M),n.removeEventListener("squeeze",M),n.removeEventListener("squeezestart",M),n.removeEventListener("squeezeend",M),n.removeEventListener("end",T),n.removeEventListener("inputsourceschange",P);for(let e=0;e<v.length;e++){let t=y[e];null!==t&&(y[e]=null,v[e].disconnect(t))}E=null,A=null,e.setRenderTarget(m),d=null,h=null,u=null,n=null,g=null,R.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}function P(e){for(let t=0;t<e.removed.length;t++){let r=e.removed[t],n=y.indexOf(r);n>=0&&(y[n]=null,v[n].disconnect(r))}for(let t=0;t<e.added.length;t++){let r=e.added[t],n=y.indexOf(r);if(-1===n){for(let e=0;e<v.length;e++){if(e>=y.length){y.push(r),n=e;break}if(null===y[e]){y[e]=r,n=e;break}}if(-1===n)break}let i=v[n];i&&i.connect(r)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=v[e];return void 0===t&&(t=new hV,v[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=v[e];return void 0===t&&(t=new hV,v[e]=t),t.getGripSpace()},this.getHand=function(e){let t=v[e];return void 0===t&&(t=new hV,v[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){a=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return u},this.getFrame=function(){return f},this.getSession=function(){return n},this.setSession=async function(c){if(n=c,null!==n){if(m=e.getRenderTarget(),n.addEventListener("select",M),n.addEventListener("selectstart",M),n.addEventListener("selectend",M),n.addEventListener("squeeze",M),n.addEventListener("squeezestart",M),n.addEventListener("squeezeend",M),n.addEventListener("end",T),n.addEventListener("inputsourceschange",P),!0!==p.xrCompatible&&await t.makeXRCompatible(),void 0===n.renderState.layers||!1===e.capabilities.isWebGL2){let r={antialias:void 0!==n.renderState.layers||p.antialias,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:i};d=new XRWebGLLayer(n,t,r),n.updateRenderState({baseLayer:d}),g=new EB(d.framebufferWidth,d.framebufferHeight,{format:dN,type:oN,encoding:e.outputEncoding,stencilBuffer:p.stencil})}else{let r=null,s=null,a=null;p.depth&&(a=p.stencil?35056:33190,r=p.stencil?pN:fN,s=p.stencil?hN:lN);let o={colorFormat:32856,depthFormat:a,scaleFactor:i};u=new XRWebGLBinding(n,t),h=u.createProjectionLayer(o),n.updateRenderState({layers:[h]}),g=new EB(h.textureWidth,h.textureHeight,{format:dN,type:oN,depthTexture:new dV(h.textureWidth,h.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,r),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0}),e.properties.get(g).__ignoreDepthValues=h.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await n.requestReferenceSpace(a),R.setContext(n),R.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};let k=new PB,D=new PB;function I(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===n)return;C.near=S.near=x.near=e.near,C.far=S.far=x.far=e.far,(E!==C.near||A!==C.far)&&(n.updateRenderState({depthNear:C.near,depthFar:C.far}),E=C.near,A=C.far);let t=e.parent,r=C.cameras;I(C,t);for(let n=0;n<r.length;n++)I(r[n],t);C.matrixWorld.decompose(C.position,C.quaternion,C.scale),e.matrix.copy(C.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale);let i=e.children;for(let n=0,s=i.length;n<s;n++)i[n].updateMatrixWorld(!0);2===r.length?function(e,t,r){k.setFromMatrixPosition(t.matrixWorld),D.setFromMatrixPosition(r.matrixWorld);let n=k.distanceTo(D),i=t.projectionMatrix.elements,s=r.projectionMatrix.elements,a=i[14]/(i[10]-1),o=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(s[8]+1)/s[0],d=a*u,f=a*h,p=n/(-u+h),m=p*-u;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();let g=a+p,v=o+p,y=d-m,b=f+(n-m),w=l*o/v*g,x=c*o/v*g;e.projectionMatrix.makePerspective(y,b,w,x,g,v)}(C,x,S):C.projectionMatrix.copy(x.projectionMatrix)},this.getCamera=function(){return C},this.getFoveation=function(){if(null!==h||null!==d)return o},this.setFoveation=function(e){o=e,null!==h&&(h.fixedFoveation=e),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=e)},this.getPlanes=function(){return b};let O=null;let R=new FF;R.setAnimationLoop((function(t,n){if(c=n.getViewerPose(l||s),f=n,null!==c){let t=c.views;null!==d&&(e.setRenderTargetFramebuffer(g,d.framebuffer),e.setRenderTarget(g));let r=!1;t.length!==C.cameras.length&&(C.cameras.length=0,r=!0);for(let n=0;n<t.length;n++){let i=t[n],s=null;if(null!==d)s=d.getViewport(i);else{let t=u.getViewSubImage(h,i);s=t.viewport,0===n&&(e.setRenderTargetTextures(g,t.colorTexture,h.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(g))}let a=_[n];void 0===a&&(a=new MF,a.layers.enable(n),a.viewport=new CB,_[n]=a),a.matrix.fromArray(i.transform.matrix),a.projectionMatrix.fromArray(i.projectionMatrix),a.viewport.set(s.x,s.y,s.width,s.height),0===n&&C.matrix.copy(a.matrix),!0===r&&C.cameras.push(a)}}for(let e=0;e<v.length;e++){let t=y[e],r=v[e];null!==t&&void 0!==r&&r.update(t,n,l||s)}if(O&&O(t,n),n.detectedPlanes){r.dispatchEvent({type:"planesdetected",data:n.detectedPlanes});let e=null;for(let t of b)n.detectedPlanes.has(t)||(null===e&&(e=[]),e.push(t));if(null!==e)for(let t of e)b.delete(t),w.delete(t),r.dispatchEvent({type:"planeremoved",data:t});for(let t of n.detectedPlanes)if(b.has(t)){let e=w.get(t);t.lastChangedTime>e&&(w.set(t,t.lastChangedTime),r.dispatchEvent({type:"planechanged",data:t}))}else b.add(t),w.set(t,n.lastChangedTime),r.dispatchEvent({type:"planeadded",data:t})}f=null})),this.setAnimationLoop=function(e){O=e},this.dispose=function(){}}};function pV(e,t){function r(r,n){r.opacity.value=n.opacity,n.color&&r.diffuse.value.copy(n.color),n.emissive&&r.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(r.map.value=n.map),n.alphaMap&&(r.alphaMap.value=n.alphaMap),n.bumpMap&&(r.bumpMap.value=n.bumpMap,r.bumpScale.value=n.bumpScale,1===n.side&&(r.bumpScale.value*=-1)),n.displacementMap&&(r.displacementMap.value=n.displacementMap,r.displacementScale.value=n.displacementScale,r.displacementBias.value=n.displacementBias),n.emissiveMap&&(r.emissiveMap.value=n.emissiveMap),n.normalMap&&(r.normalMap.value=n.normalMap,r.normalScale.value.copy(n.normalScale),1===n.side&&r.normalScale.value.negate()),n.specularMap&&(r.specularMap.value=n.specularMap),n.alphaTest>0&&(r.alphaTest.value=n.alphaTest);let i,s,a=t.get(n).envMap;if(a&&(r.envMap.value=a,r.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,r.reflectivity.value=n.reflectivity,r.ior.value=n.ior,r.refractionRatio.value=n.refractionRatio),n.lightMap){r.lightMap.value=n.lightMap;let t=!0!==e.physicallyCorrectLights?Math.PI:1;r.lightMapIntensity.value=n.lightMapIntensity*t}n.aoMap&&(r.aoMap.value=n.aoMap,r.aoMapIntensity.value=n.aoMapIntensity),n.map?i=n.map:n.specularMap?i=n.specularMap:n.displacementMap?i=n.displacementMap:n.normalMap?i=n.normalMap:n.bumpMap?i=n.bumpMap:n.roughnessMap?i=n.roughnessMap:n.metalnessMap?i=n.metalnessMap:n.alphaMap?i=n.alphaMap:n.emissiveMap?i=n.emissiveMap:n.clearcoatMap?i=n.clearcoatMap:n.clearcoatNormalMap?i=n.clearcoatNormalMap:n.clearcoatRoughnessMap?i=n.clearcoatRoughnessMap:n.iridescenceMap?i=n.iridescenceMap:n.iridescenceThicknessMap?i=n.iridescenceThicknessMap:n.specularIntensityMap?i=n.specularIntensityMap:n.specularColorMap?i=n.specularColorMap:n.transmissionMap?i=n.transmissionMap:n.thicknessMap?i=n.thicknessMap:n.sheenColorMap?i=n.sheenColorMap:n.sheenRoughnessMap&&(i=n.sheenRoughnessMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),r.uvTransform.value.copy(i.matrix)),n.aoMap?s=n.aoMap:n.lightMap&&(s=n.lightMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),r.uv2Transform.value.copy(s.matrix))}return{refreshFogUniforms:function(t,r){r.color.getRGB(t.fogColor.value,_F(e)),r.isFog?(t.fogNear.value=r.near,t.fogFar.value=r.far):r.isFogExp2&&(t.fogDensity.value=r.density)},refreshMaterialUniforms:function(e,n,i,s,a){n.isMeshBasicMaterial||n.isMeshLambertMaterial?r(e,n):n.isMeshToonMaterial?(r(e,n),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,n)):n.isMeshPhongMaterial?(r(e,n),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,n)):n.isMeshStandardMaterial?(r(e,n),function(e,r){e.roughness.value=r.roughness,e.metalness.value=r.metalness,r.roughnessMap&&(e.roughnessMap.value=r.roughnessMap),r.metalnessMap&&(e.metalnessMap.value=r.metalnessMap),t.get(r).envMap&&(e.envMapIntensity.value=r.envMapIntensity)}(e,n),n.isMeshPhysicalMaterial&&function(e,t,r){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap)),t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,1===t.side&&e.clearcoatNormalScale.value.negate())),t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap)),t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor)),e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap)}(e,n,a)):n.isMeshMatcapMaterial?(r(e,n),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,n)):n.isMeshDepthMaterial?r(e,n):n.isMeshDistanceMaterial?(r(e,n),function(e,t){e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,n)):n.isMeshNormalMaterial?r(e,n):n.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,n),n.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,n)):n.isPointsMaterial?function(e,t,r,n){let i;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*n,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest),t.map?i=t.map:t.alphaMap&&(i=t.alphaMap),void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(e,n,i,s):n.isSpriteMaterial?function(e,t){let r;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest),t.map?r=t.map:t.alphaMap&&(r=t.alphaMap),void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}(e,n):n.isShadowMaterial?(e.color.value.copy(n.color),e.opacity.value=n.opacity):n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)}}}function mV(e,t,r,n){let i={},s={},a=[],o=r.isWebGL2?e.getParameter(35375):0;function l(e,t,r){let n=e.value;if(void 0===r[t]){if("number"==typeof n)r[t]=n;else{let e=Array.isArray(n)?n:[n],i=[];for(let t=0;t<e.length;t++)i.push(e[t].clone());r[t]=i}return!0}if("number"==typeof n){if(r[t]!==n)return r[t]=n,!0}else{let e=Array.isArray(r[t])?r[t]:[r[t]],i=Array.isArray(n)?n:[n];for(let t=0;t<e.length;t++){let r=e[t];if(!1===r.equals(i[t]))return r.copy(i[t]),!0}}return!1}function c(e){let t={boundary:0,storage:0};return"number"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function u(t){let r=t.target;r.removeEventListener("dispose",u);let n=a.indexOf(r.__bindingPointIndex);a.splice(n,1),e.deleteBuffer(i[r.id]),delete i[r.id],delete s[r.id]}return{bind:function(e,t){let r=t.program;n.uniformBlockBinding(e,r)},update:function(r,h){let d=i[r.id];void 0===d&&(function(e){let t=e.uniforms,r=0,n=16,i=0;for(let s=0,a=t.length;s<a;s++){let e=t[s],a={boundary:0,storage:0},o=Array.isArray(e.value)?e.value:[e.value];for(let t=0,r=o.length;t<r;t++){let e=c(o[t]);a.boundary+=e.boundary,a.storage+=e.storage}if(e.__data=new Float32Array(a.storage/Float32Array.BYTES_PER_ELEMENT),e.__offset=r,s>0){i=r%n,0!==i&&n-i-a.boundary<0&&(r+=n-i,e.__offset=r)}r+=a.storage}i=r%n,i>0&&(r+=n-i),e.__size=r,e.__cache={}}(r),d=function(t){let r=function(){for(let e=0;e<o;e++)if(-1===a.indexOf(e))return a.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=r;let n=e.createBuffer(),i=t.__size,s=t.usage;return e.bindBuffer(35345,n),e.bufferData(35345,i,s),e.bindBuffer(35345,null),e.bindBufferBase(35345,r,n),n}(r),i[r.id]=d,r.addEventListener("dispose",u));let f=h.program;n.updateUBOMapping(r,f);let p=t.render.frame;s[r.id]!==p&&(function(t){let r=i[t.id],n=t.uniforms,s=t.__cache;e.bindBuffer(35345,r);for(let i=0,a=n.length;i<a;i++){let t=n[i];if(!0===l(t,i,s)){let r=t.__offset,n=Array.isArray(t.value)?t.value:[t.value],i=0;for(let s=0;s<n.length;s++){let a=n[s],o=c(a);"number"==typeof a?(t.__data[0]=a,e.bufferSubData(35345,r+i,t.__data)):a.isMatrix3?(t.__data[0]=a.elements[0],t.__data[1]=a.elements[1],t.__data[2]=a.elements[2],t.__data[3]=a.elements[0],t.__data[4]=a.elements[3],t.__data[5]=a.elements[4],t.__data[6]=a.elements[5],t.__data[7]=a.elements[0],t.__data[8]=a.elements[6],t.__data[9]=a.elements[7],t.__data[10]=a.elements[8],t.__data[11]=a.elements[0]):(a.toArray(t.__data,i),i+=o.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(35345,r,t.__data)}}e.bindBuffer(35345,null)}(r),s[r.id]=p)},dispose:function(){for(let t in i)e.deleteBuffer(i[t]);a=[],i={},s={}}}}function gV(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isWebGLRenderer=!0;let t,r=void 0!==e.canvas?e.canvas:function(){let e=aB("canvas");return e.style.display="block",e}(),n=void 0!==e.context?e.context:null,i=void 0===e.depth||e.depth,s=void 0===e.stencil||e.stencil,a=void 0!==e.antialias&&e.antialias,o=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",u=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;t=null!==n?n.getContextAttributes().alpha:void 0!==e.alpha&&e.alpha;let h=null,d=null,f=[],p=[];this.domElement=r,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=kN,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;let m=this,g=!1,v=0,y=0,b=null,w=-1,x=null,S=new CB,_=new CB,C=null,E=r.width,A=r.height,M=1,T=null,P=null,k=new CB(0,0,E,A),D=new CB(0,0,E,A),I=!1,O=new zF,R=!1,L=!1,N=null,B=new sz,z=new eB,F=new PB,j={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function U(){return null===b?M:1}let V,H,W,G,q,X,Y,K,Q,Z,J,$,ee,te,re,ne,ie,se,ae,oe,le,ce,ue,he,de=n;function fe(e,t){for(let n=0;n<e.length;n++){let i=e[n],s=r.getContext(i,t);if(null!==s)return s}return null}try{let e={alpha:!0,depth:i,stencil:s,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in r&&r.setAttribute("data-engine","three.js r".concat(ML)),r.addEventListener("webglcontextlost",ge,!1),r.addEventListener("webglcontextrestored",ve,!1),r.addEventListener("webglcontextcreationerror",ye,!1),null===de){let t=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&t.shift(),de=fe(t,e),null===de)throw fe(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===de.getShaderPrecisionFormat&&(de.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Y_){throw console.error("THREE.WebGLRenderer: "+Y_.message),Y_}function pe(){V=new fj(de),H=new KF(de,V,e),V.init(H),ce=new oV(de,V,H),W=new sV(de,V,H),G=new gj,q=new GU,X=new aV(de,V,W,q,H,ce,G),Y=new ZF(m),K=new dj(m),Q=new jF(de,H),ue=new XF(de,V,Q,H),Z=new pj(de,Q,G,ue),J=new wj(de,Z,Q,G),ae=new bj(de,H,X),ne=new QF(q),$=new WU(m,Y,K,V,H,ue,ne),ee=new pV(m,q),te=new KU,re=new tV(V,H),se=new qF(m,Y,K,W,J,t,o),ie=new iV(m,J,H),he=new mV(de,G,H,W),oe=new YF(de,V,G,H),le=new mj(de,V,G,H),G.programs=$.programs,m.capabilities=H,m.extensions=V,m.properties=q,m.renderLists=te,m.shadowMap=ie,m.state=W,m.info=G}pe();let me=new fV(m,de);function ge(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function ve(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;let e=G.autoReset,t=ie.enabled,r=ie.autoUpdate,n=ie.needsUpdate,i=ie.type;pe(),G.autoReset=e,ie.enabled=t,ie.autoUpdate=r,ie.needsUpdate=n,ie.type=i}function ye(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function be(e){let t=e.target;t.removeEventListener("dispose",be),function(e){(function(e){let t=q.get(e).programs;void 0!==t&&(t.forEach((function(e){$.releaseProgram(e)})),e.isShaderMaterial&&$.releaseShaderCache(e))})(e),q.remove(e)}(t)}this.xr=me,this.getContext=function(){return de},this.getContextAttributes=function(){return de.getContextAttributes()},this.forceContextLoss=function(){let e=V.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){let e=V.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return M},this.setPixelRatio=function(e){void 0!==e&&(M=e,this.setSize(E,A,!1))},this.getSize=function(e){return e.set(E,A)},this.setSize=function(e,t,n){me.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(E=e,A=t,r.width=Math.floor(e*M),r.height=Math.floor(t*M),!1!==n&&(r.style.width=e+"px",r.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(e){return e.set(E*M,A*M).floor()},this.setDrawingBufferSize=function(e,t,n){E=e,A=t,M=n,r.width=Math.floor(e*n),r.height=Math.floor(t*n),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return e.copy(S)},this.getViewport=function(e){return e.copy(k)},this.setViewport=function(e,t,r,n){e.isVector4?k.set(e.x,e.y,e.z,e.w):k.set(e,t,r,n),W.viewport(S.copy(k).multiplyScalar(M).floor())},this.getScissor=function(e){return e.copy(D)},this.setScissor=function(e,t,r,n){e.isVector4?D.set(e.x,e.y,e.z,e.w):D.set(e,t,r,n),W.scissor(_.copy(D).multiplyScalar(M).floor())},this.getScissorTest=function(){return I},this.setScissorTest=function(e){W.setScissorTest(I=e)},this.setOpaqueSort=function(e){T=e},this.setTransparentSort=function(e){P=e},this.getClearColor=function(e){return e.copy(se.getClearColor())},this.setClearColor=function(){se.setClearColor.apply(se,arguments)},this.getClearAlpha=function(){return se.getClearAlpha()},this.setClearAlpha=function(){se.setClearAlpha.apply(se,arguments)},this.clear=function(){let e=0;(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(e|=16384),(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(e|=256),(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&(e|=1024),de.clear(e)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){r.removeEventListener("webglcontextlost",ge,!1),r.removeEventListener("webglcontextrestored",ve,!1),r.removeEventListener("webglcontextcreationerror",ye,!1),te.dispose(),re.dispose(),q.dispose(),Y.dispose(),K.dispose(),J.dispose(),ue.dispose(),he.dispose(),$.dispose(),me.dispose(),me.removeEventListener("sessionstart",xe),me.removeEventListener("sessionend",Se),N&&(N.dispose(),N=null),_e.stop()},this.renderBufferDirect=function(e,t,r,n,i,s){null===t&&(t=j);let a=i.isMesh&&i.matrixWorld.determinant()<0,o=function(e,t,r,n,i){!0!==t.isScene&&(t=j),X.resetTextureUnits();let s=t.fog,a=n.isMeshStandardMaterial?t.environment:null,o=null===b?m.outputEncoding:!0===b.isXRRenderTarget?b.texture.encoding:kN,l=(n.isMeshStandardMaterial?K:Y).get(n.envMap||a),c=!0===n.vertexColors&&!!r.attributes.color&&4===r.attributes.color.itemSize,u=!!n.normalMap&&!!r.attributes.tangent,h=!!r.morphAttributes.position,f=!!r.morphAttributes.normal,p=!!r.morphAttributes.color,g=n.toneMapped?m.toneMapping:0,v=r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color,y=void 0!==v?v.length:0,S=q.get(n),_=d.state.lights;if(!0===R&&(!0===L||e!==x)){let t=e===x&&n.id===w;ne.setState(n,e,t)}let C=!1;n.version===S.__version?(S.needsLights&&S.lightsStateVersion!==_.state.version||S.outputEncoding!==o||i.isInstancedMesh&&!1===S.instancing||!i.isInstancedMesh&&!0===S.instancing||i.isSkinnedMesh&&!1===S.skinning||!i.isSkinnedMesh&&!0===S.skinning||S.envMap!==l||!0===n.fog&&S.fog!==s||void 0!==S.numClippingPlanes&&(S.numClippingPlanes!==ne.numPlanes||S.numIntersection!==ne.numIntersection)||S.vertexAlphas!==c||S.vertexTangents!==u||S.morphTargets!==h||S.morphNormals!==f||S.morphColors!==p||S.toneMapping!==g||!0===H.isWebGL2&&S.morphTargetsCount!==y)&&(C=!0):(C=!0,S.__version=n.version);let E=S.currentProgram;!0===C&&(E=Te(n,t,i));let T=!1,P=!1,k=!1,D=E.getUniforms(),I=S.uniforms;if(W.useProgram(E.program)&&(T=!0,P=!0,k=!0),n.id!==w&&(w=n.id,P=!0),T||x!==e){if(D.setValue(de,"projectionMatrix",e.projectionMatrix),H.logarithmicDepthBuffer&&D.setValue(de,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),x!==e&&(x=e,P=!0,k=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){let t=D.map.cameraPosition;void 0!==t&&t.setValue(de,F.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&D.setValue(de,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||i.isSkinnedMesh)&&D.setValue(de,"viewMatrix",e.matrixWorldInverse)}if(i.isSkinnedMesh){D.setOptional(de,i,"bindMatrix"),D.setOptional(de,i,"bindMatrixInverse");let e=i.skeleton;e&&(H.floatVertexTextures?(null===e.boneTexture&&e.computeBoneTexture(),D.setValue(de,"boneTexture",e.boneTexture,X),D.setValue(de,"boneTextureSize",e.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let O=r.morphAttributes;if((void 0!==O.position||void 0!==O.normal||void 0!==O.color&&!0===H.isWebGL2)&&ae.update(i,r,n,E),(P||S.receiveShadow!==i.receiveShadow)&&(S.receiveShadow=i.receiveShadow,D.setValue(de,"receiveShadow",i.receiveShadow)),n.isMeshGouraudMaterial&&null!==n.envMap&&(I.envMap.value=l,I.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1),P&&(D.setValue(de,"toneMappingExposure",m.toneMappingExposure),S.needsLights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(I,k),s&&!0===n.fog&&ee.refreshFogUniforms(I,s),ee.refreshMaterialUniforms(I,n,M,A,N),CU.upload(de,S.uniformsList,I,X)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(CU.upload(de,S.uniformsList,I,X),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&D.setValue(de,"center",i.center),D.setValue(de,"modelViewMatrix",i.modelViewMatrix),D.setValue(de,"normalMatrix",i.normalMatrix),D.setValue(de,"modelMatrix",i.matrixWorld),i.previousModelViewMatrix&&D.setValue(de,"previousModelViewMatrix",i.previousModelViewMatrix),e.previousProjectionMatrix&&D.setValue(de,"previousProjectionMatrix",e.previousProjectionMatrix),n.isShaderMaterial||n.isRawShaderMaterial){let e=n.uniformsGroups;for(let t=0,r=e.length;t<r;t++)if(H.isWebGL2){let r=e[t];he.update(r,E),he.bind(r,E)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return E}(e,t,r,n,i);W.setMaterial(n,a);let l=r.index,c=1;!0===n.wireframe&&(l=Z.getWireframeAttribute(r),c=2);let u=r.drawRange,h=r.attributes.position,f=u.start*c,p=(u.start+u.count)*c;null!==s&&(f=Math.max(f,s.start*c),p=Math.min(p,(s.start+s.count)*c)),null!==l?(f=Math.max(f,0),p=Math.min(p,l.count)):null!=h&&(f=Math.max(f,0),p=Math.min(p,h.count));let g=p-f;if(g<0||g===1/0)return;ue.setup(i,n,o,r,l);let v,y=oe;if(null!==l&&(v=Q.get(l),y=le,y.setIndex(v)),i.isMesh)!0===n.wireframe?(W.setLineWidth(n.wireframeLinewidth*U()),y.setMode(1)):y.setMode(4);else if(i.isLine){let e=n.linewidth;void 0===e&&(e=1),W.setLineWidth(e*U()),i.isLineSegments?y.setMode(1):i.isLineLoop?y.setMode(2):y.setMode(3)}else i.isPoints?y.setMode(0):i.isSprite&&y.setMode(4);if(i.isInstancedMesh)y.renderInstances(f,g,i.count);else if(r.isInstancedBufferGeometry){let e=void 0!==r._maxInstanceCount?r._maxInstanceCount:1/0,t=Math.min(r.instanceCount,e);y.renderInstances(f,g,t)}else y.render(f,g)},this.compile=function(e,t){function r(e,t,r){!0===e.transparent&&2===e.side&&!1===e.forceSinglePass?(e.side=1,e.needsUpdate=!0,Te(e,t,r),e.side=0,e.needsUpdate=!0,Te(e,t,r),e.side=2):Te(e,t,r)}d=re.get(e),d.init(),p.push(d),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(d.pushLight(e),e.castShadow&&d.pushShadow(e))})),d.setupLights(m.physicallyCorrectLights),e.traverse((function(t){let n=t.material;if(n)if(Array.isArray(n))for(let i=0;i<n.length;i++){r(n[i],e,t)}else r(n,e,t)})),p.pop(),d=null};let we=null;function xe(){_e.stop()}function Se(){_e.start()}let _e=new FF;function Ce(e,t,r,n){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)r=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)d.pushLight(e),e.castShadow&&d.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||O.intersectsSprite(e)){n&&F.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B);let t=J.update(e),i=e.material;i.visible&&h.push(e,t,i,r,F.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==G.render.frame&&(e.skeleton.update(),e.skeleton.frame=G.render.frame),!e.frustumCulled||O.intersectsObject(e))){n&&F.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B);let t=J.update(e),i=e.material;if(Array.isArray(i)){let n=t.groups;for(let s=0,a=n.length;s<a;s++){let a=n[s],o=i[a.materialIndex];o&&o.visible&&h.push(e,t,o,r,F.z,a)}}else i.visible&&h.push(e,t,i,r,F.z,null)}let i=e.children;for(let s=0,a=i.length;s<a;s++)Ce(i[s],t,r,n)}function Ee(e,t,r,n){let i=e.opaque,s=e.transmissive,o=e.transparent;d.setupLightsView(r),!0===R&&ne.setGlobalState(m.clippingPlanes,r),s.length>0&&function(e,t,r){let n=H.isWebGL2;null===N&&(N=new EB(1,1,{generateMipmaps:!0,type:V.has("EXT_color_buffer_half_float")?uN:oN,minFilter:aN,samples:n&&!0===a?4:0})),m.getDrawingBufferSize(z),n?N.setSize(z.x,z.y):N.setSize(QN(z.x),QN(z.y));let i=m.getRenderTarget();m.setRenderTarget(N),m.clear();let s=m.toneMapping;m.toneMapping=0,Ae(e,t,r),m.toneMapping=s,X.updateMultisampleRenderTarget(N),X.updateRenderTargetMipmap(N),m.setRenderTarget(i)}(i,t,r),n&&W.viewport(S.copy(n)),i.length>0&&Ae(i,t,r),s.length>0&&Ae(s,t,r),o.length>0&&Ae(o,t,r),W.buffers.depth.setTest(!0),W.buffers.depth.setMask(!0),W.buffers.color.setMask(!0),W.setPolygonOffset(!1)}function Ae(e,t,r){let n=!0===t.isScene?t.overrideMaterial:null;for(let i=0,s=e.length;i<s;i++){let s=e[i],a=s.object,o=s.geometry,l=null===n?s.material:n,c=s.group;a.layers.test(r.layers)&&Me(a,t,r,o,l,c)}}function Me(e,t,r,n,i,s){e.onBeforeRender(m,t,r,n,i,s),e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(m,t,r,n,e,s),!0===i.transparent&&2===i.side&&!1===i.forceSinglePass?(i.side=1,i.needsUpdate=!0,m.renderBufferDirect(r,t,n,i,e,s),i.side=0,i.needsUpdate=!0,m.renderBufferDirect(r,t,n,i,e,s),i.side=2):m.renderBufferDirect(r,t,n,i,e,s),e.onAfterRender(m,t,r,n,i,s)}function Te(e,t,r){!0!==t.isScene&&(t=j);let n=q.get(e),i=d.state.lights,s=d.state.shadowsArray,a=i.state.version,o=$.getParameters(e,i.state,s,t,r),l=$.getProgramCacheKey(o),c=n.programs;n.environment=e.isMeshStandardMaterial?t.environment:null,n.fog=t.fog,n.envMap=(e.isMeshStandardMaterial?K:Y).get(e.envMap||n.environment),void 0===c&&(e.addEventListener("dispose",be),c=new Map,n.programs=c);let u=c.get(l);if(void 0!==u){if(n.currentProgram===u&&n.lightsStateVersion===a)return Pe(e,o),u}else o.uniforms=$.getUniforms(e),e.onBuild(r,o,m),e.onBeforeCompile(o,m),u=$.acquireProgram(o,l),c.set(l,u),n.uniforms=o.uniforms;let h=n.uniforms;(!e.isShaderMaterial&&!e.isRawShaderMaterial||!0===e.clipping)&&(h.clippingPlanes=ne.uniform),Pe(e,o),n.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),n.lightsStateVersion=a,n.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotLightMatrix.value=i.state.spotLightMatrix,h.spotLightMap.value=i.state.spotLightMap,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix);let f=u.getUniforms(),p=CU.seqWithValue(f.seq,h);return n.currentProgram=u,n.uniformsList=p,u}function Pe(e,t){let r=q.get(e);r.outputEncoding=t.outputEncoding,r.instancing=t.instancing,r.skinning=t.skinning,r.morphTargets=t.morphTargets,r.morphNormals=t.morphNormals,r.morphColors=t.morphColors,r.morphTargetsCount=t.morphTargetsCount,r.numClippingPlanes=t.numClippingPlanes,r.numIntersection=t.numClipIntersection,r.vertexAlphas=t.vertexAlphas,r.vertexTangents=t.vertexTangents,r.toneMapping=t.toneMapping}_e.setAnimationLoop((function(e){we&&we(e)})),typeof self<"u"&&_e.setContext(self),this.setAnimationLoop=function(e){we=e,me.setAnimationLoop(e),null===e?_e.stop():_e.start()},me.addEventListener("sessionstart",xe),me.addEventListener("sessionend",Se),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===g)return;!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===me.enabled&&!0===me.isPresenting&&(!0===me.cameraAutoUpdate&&me.updateCamera(t),t=me.getCamera()),!0===e.isScene&&e.onBeforeRender(m,e,t,b),d=re.get(e,p.length),d.init(),p.push(d),B.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),O.setFromProjectionMatrix(B),L=this.localClippingEnabled,R=ne.init(this.clippingPlanes,L),h=te.get(e,f.length),h.init(),f.push(h),Ce(e,t,0,m.sortObjects),h.finish(),!0===m.sortObjects&&h.sort(T,P),!0===R&&ne.beginShadows();let r=d.state.shadowsArray;if(ie.render(r,e,t),!0===R&&ne.endShadows(),!0===this.info.autoReset&&this.info.reset(),se.render(h,e),d.setupLights(m.physicallyCorrectLights),t.isArrayCamera){let r=t.cameras;for(let t=0,n=r.length;t<n;t++){let n=r[t];Ee(h,e,n,n.viewport)}}else Ee(h,e,t);null!==b&&(X.updateMultisampleRenderTarget(b),X.updateRenderTargetMipmap(b)),!0===e.isScene&&e.onAfterRender(m,e,t),ue.resetDefaultState(),w=-1,x=null,p.pop(),d=p.length>0?p[p.length-1]:null,f.pop(),h=f.length>0?f[f.length-1]:null},this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(e,t,r){q.get(e.texture).__webglTexture=t,q.get(e.depthTexture).__webglTexture=r;let n=q.get(e);n.__hasExternalTextures=!0,n.__hasExternalTextures&&(n.__autoAllocateDepthBuffer=void 0===r,n.__autoAllocateDepthBuffer||!0===V.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),n.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){let r=q.get(e);r.__webglFramebuffer=t,r.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;b=e,v=t,y=r;let n=!0,i=null,s=!1,a=!1;if(e){let r=q.get(e);void 0!==r.__useDefaultFramebuffer?(W.bindFramebuffer(36160,null),n=!1):void 0===r.__webglFramebuffer?X.setupRenderTarget(e):r.__hasExternalTextures&&X.rebindTextures(e,q.get(e.texture).__webglTexture,q.get(e.depthTexture).__webglTexture);let o=e.texture;(o.isData3DTexture||o.isDataArrayTexture||o.isCompressedArrayTexture)&&(a=!0);let l=q.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=l[t],s=!0):i=H.isWebGL2&&e.samples>0&&!1===X.useMultisampledRTT(e)?q.get(e).__webglMultisampledFramebuffer:l,S.copy(e.viewport),_.copy(e.scissor),C=e.scissorTest}else S.copy(k).multiplyScalar(M).floor(),_.copy(D).multiplyScalar(M).floor(),C=I;if(W.bindFramebuffer(36160,i)&&H.drawBuffers&&n&&W.drawBuffers(e,i),W.viewport(S),W.scissor(_),W.setScissorTest(C),s){let n=q.get(e.texture);de.framebufferTexture2D(36160,36064,34069+t,n.__webglTexture,r)}else if(a){let n=q.get(e.texture),i=t||0;de.framebufferTextureLayer(36160,36064,n.__webglTexture,r||0,i)}w=-1},this.readRenderTargetPixels=function(e,t,r,n,i,s,a){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let o=q.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(o=o[a]),o){W.bindFramebuffer(36160,o);try{let a=e.texture,o=a.format,l=a.type;if(o!==dN&&ce.convert(o)!==de.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");let c=l===uN&&(V.has("EXT_color_buffer_half_float")||H.isWebGL2&&V.has("EXT_color_buffer_float"));if(l!==oN&&ce.convert(l)!==de.getParameter(35738)&&(l!==cN||!(H.isWebGL2||V.has("OES_texture_float")||V.has("WEBGL_color_buffer_float")))&&!c)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-n&&r>=0&&r<=e.height-i&&de.readPixels(t,r,n,i,ce.convert(o),ce.convert(l),s)}finally{let e=null!==b?q.get(b).__webglFramebuffer:null;W.bindFramebuffer(36160,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,r,n,i,s,a){if(!e||!e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let o=q.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(o=o[a]),o){let a=e.texture,l=a.format,c=a.type;if(t>=0&&t<=e.width-n&&r>=0&&r<=e.height-i){W.bindFramebuffer(de.FRAMEBUFFER,o);let e=de.createBuffer();de.bindBuffer(de.PIXEL_PACK_BUFFER,e),de.bufferData(de.PIXEL_PACK_BUFFER,s.byteLength,de.STREAM_READ),de.readPixels(t,r,n,i,ce.convert(l),ce.convert(c),0);let a=null!==b?q.get(b).__webglFramebuffer:null;W.bindFramebuffer(de.FRAMEBUFFER,a);let u=de.fenceSync(de.SYNC_GPU_COMMANDS_COMPLETE,0);return de.flush(),await function(e,t,r){return new Promise((function(n,i){setTimeout((function s(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:i();break;case e.TIMEOUT_EXPIRED:setTimeout(s,r);break;default:n()}}),r)}))}(de,u,4),de.bindBuffer(de.PIXEL_PACK_BUFFER,e),de.getBufferSubData(de.PIXEL_PACK_BUFFER,0,s),de.deleteBuffer(e),de.deleteSync(u),s}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=Math.pow(2,-r),i=Math.floor(t.image.width*n),s=Math.floor(t.image.height*n);X.setTexture2D(t,0),de.copyTexSubImage2D(3553,r,0,0,e.x,e.y,i,s),W.unbindTexture()},this.copyTextureToTexture=function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t.image.width,s=t.image.height,a=ce.convert(r.format),o=ce.convert(r.type);X.setTexture2D(r,0),de.pixelStorei(37440,r.flipY),de.pixelStorei(37441,r.premultiplyAlpha),de.pixelStorei(3317,r.unpackAlignment),t.isDataTexture?de.texSubImage2D(3553,n,e.x,e.y,i,s,a,o,t.image.data):t.isCompressedTexture?de.compressedTexSubImage2D(3553,n,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,a,t.mipmaps[0].data):de.texSubImage2D(3553,n,e.x,e.y,a,o,t.image),0===n&&r.generateMipmaps&&de.generateMipmap(3553),W.unbindTexture()},this.copyTextureToTexture3D=function(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(m.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");let s,a=e.max.x-e.min.x+1,o=e.max.y-e.min.y+1,l=e.max.z-e.min.z+1,c=ce.convert(n.format),u=ce.convert(n.type);if(n.isData3DTexture)X.setTexture3D(n,0),s=32879;else{if(!n.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");X.setTexture2DArray(n,0),s=35866}de.pixelStorei(37440,n.flipY),de.pixelStorei(37441,n.premultiplyAlpha),de.pixelStorei(3317,n.unpackAlignment);let h=de.getParameter(3314),d=de.getParameter(32878),f=de.getParameter(3316),p=de.getParameter(3315),g=de.getParameter(32877),v=r.isCompressedTexture?r.mipmaps[0]:r.image;de.pixelStorei(3314,v.width),de.pixelStorei(32878,v.height),de.pixelStorei(3316,e.min.x),de.pixelStorei(3315,e.min.y),de.pixelStorei(32877,e.min.z),r.isDataTexture||r.isData3DTexture?de.texSubImage3D(s,i,t.x,t.y,t.z,a,o,l,c,u,v.data):r.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),de.compressedTexSubImage3D(s,i,t.x,t.y,t.z,a,o,l,c,v.data)):de.texSubImage3D(s,i,t.x,t.y,t.z,a,o,l,c,u,v),de.pixelStorei(3314,h),de.pixelStorei(32878,d),de.pixelStorei(3316,f),de.pixelStorei(3315,p),de.pixelStorei(32877,g),0===i&&n.generateMipmaps&&de.generateMipmap(s),W.unbindTexture()},this.initRenderTarget=function(e){void 0===q.get(e).__webglFramebuffer&&X.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?X.setTextureCube(e,0):e.isData3DTexture?X.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?X.setTexture2DArray(e,0):X.setTexture2D(e,0),W.unbindTexture()},this.resetState=function(){v=0,y=0,b=null,W.reset(),ue.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}(class extends gV{}).prototype.isWebGL1Renderer=!0;var vV=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;this.isFog=!0,this.name="",this.color=new vB(e),this.near=t,this.far=r}clone(){return new vV(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},yV=class extends kz{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}},bV=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=NN,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=WN()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let n=0,i=this.stride;n<i;n++)this.array[e+n]=t.array[r+n];return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=WN()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=WN()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},wV=new PB,xV=class{constructor(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)wV.fromBufferAttribute(this,t),wV.applyMatrix4(e),this.setXYZ(t,wV.x,wV.y,wV.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)wV.fromBufferAttribute(this,t),wV.applyNormalMatrix(e),this.setXYZ(t,wV.x,wV.y,wV.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)wV.fromBufferAttribute(this,t),wV.transformDirection(e),this.setXYZ(t,wV.x,wV.y,wV.z);return this}setX(e,t){return this.normalized&&(t=JN(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=JN(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=JN(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=JN(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ZN(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ZN(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ZN(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ZN(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=JN(t,this.array),r=JN(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=JN(t,this.array),r=JN(r,this.array),n=JN(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this}setXYZW(e,t,r,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=JN(t,this.array),r=JN(r,this.array),n=JN(n,this.array),i=JN(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=i,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let t=0;t<this.count;t++){let r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return new Xz(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new xV(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let t=0;t<this.count;t++){let r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},SV=class extends kz{constructor(){super(),this.isBone=!0,this.type="Bone"}},_V=class extends _B{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(null,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:tN,arguments.length>9&&void 0!==arguments[9]?arguments[9]:tN,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>10?arguments[10]:void 0,arguments.length>11?arguments[11]:void 0),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},CV=new sz,EV=new sz,AV=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.uuid=WN(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new sz)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let t=new sz;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){let e=this.bones,t=this.boneInverses,r=this.boneMatrices,n=this.boneTexture;for(let i=0,s=e.length;i<s;i++){let n=e[i]?e[i].matrixWorld:EV;CV.multiplyMatrices(n,t[i]),CV.toArray(r,16*i)}null!==n&&(n.needsUpdate=!0)}clone(){return new AV(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=KN(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let r=new _V(t,e,e,dN,cN);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){let r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,n=e.bones.length;r<n;r++){let n=e.bones[r],i=t[n];void 0===i&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),i=new SV),this.bones.push(i),this.boneInverses.push((new sz).fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,r=this.boneInverses;for(let n=0,i=t.length;n<i;n++){let i=t[n];e.bones.push(i.uuid);let s=r[n];e.boneInverses.push(s.toArray())}return e}},MV=class extends Xz{constructor(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},TV=new sz,PV=new sz,kV=[],DV=new sz,IV=new yF,OV=class extends yF{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new MV(new Float32Array(16*r),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1;for(let n=0;n<r;n++)this.setMatrixAt(n,DV)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){let r=this.matrixWorld,n=this.count;if(IV.geometry=this.geometry,IV.material=this.material,void 0!==IV.material)for(let i=0;i<n;i++){this.getMatrixAt(i,TV),PV.multiplyMatrices(r,TV),IV.matrixWorld=PV,IV.raycast(e,kV);for(let e=0,r=kV.length;e<r;e++){let r=kV[e];r.instanceId=i,r.object=this,t.push(r)}kV.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new MV(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}},RV=class extends Hz{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new vB(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},LV=new PB,NV=new PB,BV=new sz,zV=new iz,FV=new QB,jV=class extends kz{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new iF,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new RV;super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(null===e.index){let t=e.attributes.position,r=[0];for(let e=1,n=t.count;e<n;e++)LV.fromBufferAttribute(t,e-1),NV.fromBufferAttribute(t,e),r[e]=r[e-1],r[e]+=LV.distanceTo(NV);e.setAttribute("lineDistance",new Qz(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let r=this.geometry,n=this.matrixWorld,i=e.params.Line.threshold,s=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),FV.copy(r.boundingSphere),FV.applyMatrix4(n),FV.radius+=i,!1===e.ray.intersectsSphere(FV))return;BV.copy(n).invert(),zV.copy(e.ray).applyMatrix4(BV);let a=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=new PB,c=new PB,u=new PB,h=new PB,d=this.isLineSegments?2:1,f=r.index,p=r.attributes.position;if(null!==f){for(let r=Math.max(0,s.start),n=Math.min(f.count,s.start+s.count)-1;r<n;r+=d){let n=f.getX(r),i=f.getX(r+1);if(l.fromBufferAttribute(p,n),c.fromBufferAttribute(p,i),zV.distanceSqToSegment(l,c,h,u)>o)continue;h.applyMatrix4(this.matrixWorld);let s=e.ray.origin.distanceTo(h);s<e.near||s>e.far||t.push({distance:s,point:u.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}else{for(let r=Math.max(0,s.start),n=Math.min(p.count,s.start+s.count)-1;r<n;r+=d){if(l.fromBufferAttribute(p,r),c.fromBufferAttribute(p,r+1),zV.distanceSqToSegment(l,c,h,u)>o)continue;h.applyMatrix4(this.matrixWorld);let n=e.ray.origin.distanceTo(h);n<e.near||n>e.far||t.push({distance:n,point:u.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){let t=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}},UV=new PB,VV=new PB,HV=class extends jV{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(null===e.index){let t=e.attributes.position,r=[];for(let e=0,n=t.count;e<n;e+=2)UV.fromBufferAttribute(t,e),VV.fromBufferAttribute(t,e+1),r[e]=0===e?0:r[e-1],r[e+1]=r[e]+UV.distanceTo(VV);e.setAttribute("lineDistance",new Qz(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},WV=class extends _B{constructor(e,t,r,n,i,s,a,o,l){super(e,t,r,n,i,s,a,o,l),this.isVideoTexture=!0,this.minFilter=void 0!==s?s:iN,this.magFilter=void 0!==i?i:iN,this.generateMipmaps=!1;let c=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){c.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},GV=class extends _B{constructor(e,t,r,n,i,s,a,o,l){super(e,t,r,n,i,s,a,o,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},qV=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t,r=[],n=this.getPoint(0),i=0;r.push(0);for(let s=1;s<=e;s++)t=this.getPoint(s/e),i+=t.distanceTo(n),r.push(i),n=t;return this.cacheArcLengths=r,r}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r,n=this.getLengths(),i=0,s=n.length;r=t||e*n[s-1];let a,o=0,l=s-1;for(;o<=l;)if(i=Math.floor(o+(l-o)/2),a=n[i]-r,a<0)o=i+1;else{if(!(a>0)){l=i;break}l=i-1}if(i=l,n[i]===r)return i/(s-1);let c=n[i];return(i+(r-c)/(n[i+1]-c))/(s-1)}getTangent(e,t){let r=e-1e-4,n=e+1e-4;r<0&&(r=0),n>1&&(n=1);let i=this.getPoint(r),s=this.getPoint(n),a=t||(i.isVector2?new eB:new PB);return a.copy(s).sub(i).normalize(),a}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new PB,n=[],i=[],s=[],a=new PB,o=new sz;for(let d=0;d<=e;d++){let t=d/e;n[d]=this.getTangentAt(t,new PB)}i[0]=new PB,s[0]=new PB;let l=Number.MAX_VALUE,c=Math.abs(n[0].x),u=Math.abs(n[0].y),h=Math.abs(n[0].z);c<=l&&(l=c,r.set(1,0,0)),u<=l&&(l=u,r.set(0,1,0)),h<=l&&r.set(0,0,1),a.crossVectors(n[0],r).normalize(),i[0].crossVectors(n[0],a),s[0].crossVectors(n[0],i[0]);for(let d=1;d<=e;d++){if(i[d]=i[d-1].clone(),s[d]=s[d-1].clone(),a.crossVectors(n[d-1],n[d]),a.length()>Number.EPSILON){a.normalize();let e=Math.acos(GN(n[d-1].dot(n[d]),-1,1));i[d].applyMatrix4(o.makeRotationAxis(a,e))}s[d].crossVectors(n[d],i[d])}if(!0===t){let t=Math.acos(GN(i[0].dot(i[e]),-1,1));t/=e,n[0].dot(a.crossVectors(i[0],i[e]))>0&&(t=-t);for(let r=1;r<=e;r++)i[r].applyMatrix4(o.makeRotationAxis(n[r],t*r)),s[r].crossVectors(n[r],i[r])}return{tangents:n,normals:i,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},XV=class extends qV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=n,this.aStartAngle=i,this.aEndAngle=s,this.aClockwise=a,this.aRotation=o}getPoint(e,t){let r=t||new eB,n=2*Math.PI,i=this.aEndAngle-this.aStartAngle,s=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=s?0:n),!0===this.aClockwise&&!s&&(i===n?i=-n:i-=n);let a=this.aStartAngle+e*i,o=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){let e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),r=o-this.aX,n=l-this.aY;o=r*e-n*t+this.aX,l=r*t+n*e+this.aY}return r.set(o,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}};function YV(){let e=0,t=0,r=0,n=0;function i(i,s,a,o){e=i,t=a,r=-3*i+3*s-2*a-o,n=2*i-2*s+a+o}return{initCatmullRom:function(e,t,r,n,s){i(t,r,s*(r-e),s*(n-t))},initNonuniformCatmullRom:function(e,t,r,n,s,a,o){let l=(t-e)/s-(r-e)/(s+a)+(r-t)/a,c=(r-t)/a-(n-t)/(a+o)+(n-r)/o;l*=a,c*=a,i(t,r,l,c)},calc:function(i){let s=i*i;return e+t*i+r*s+n*(s*i)}}}var KV=new PB,QV=new YV,ZV=new YV,JV=new YV;function $V(e,t,r,n,i){let s=.5*(n-t),a=.5*(i-r),o=e*e;return(2*r-2*n+s+a)*(e*o)+(-3*r+3*n-2*s-a)*o+s*e+r}function eH(e,t,r,n){return function(e,t){let r=1-e;return r*r*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,r)+function(e,t){return e*e*t}(e,n)}function tH(e,t,r,n,i){return function(e,t){let r=1-e;return r*r*r*t}(e,t)+function(e,t){let r=1-e;return 3*r*r*e*t}(e,r)+function(e,t){return 3*(1-e)*e*e*t}(e,n)+function(e,t){return e*e*e*t}(e,i)}var rH=class extends qV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new eB,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new eB,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new eB,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new eB;super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=n}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new eB,r=this.v0,n=this.v1,i=this.v2,s=this.v3;return t.set(tH(e,r.x,n.x,i.x,s.x),tH(e,r.y,n.y,i.y,s.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},nH=class extends qV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new PB,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PB,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new PB,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new PB;super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=n}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PB,r=this.v0,n=this.v1,i=this.v2,s=this.v3;return t.set(tH(e,r.x,n.x,i.x,s.x),tH(e,r.y,n.y,i.y,s.y),tH(e,r.z,n.z,i.z,s.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},iH=class extends qV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new eB,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new eB;super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new eB;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){let r=t||new eB;return r.copy(this.v2).sub(this.v1).normalize(),r}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},sH=class extends qV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new PB,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PB;super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PB;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},aH=class extends qV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new eB,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new eB,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new eB;super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new eB,r=this.v0,n=this.v1,i=this.v2;return t.set(eH(e,r.x,n.x,i.x),eH(e,r.y,n.y,i.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},oH=class extends qV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new eB,r=this.points,n=(r.length-1)*e,i=Math.floor(n),s=n-i,a=r[0===i?i:i-1],o=r[i],l=r[i>r.length-2?r.length-1:i+1],c=r[i>r.length-3?r.length-1:i+2];return t.set($V(s,a.x,o.x,l.x,c.x),$V(s,a.y,o.y,l.y,c.y)),t}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push((new eB).fromArray(r))}return this}},lH=Object.freeze({__proto__:null,ArcCurve:class extends XV{constructor(e,t,r,n,i,s){super(e,t,r,r,n,i,s),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class extends qV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=n}getPoint(e){let t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PB,i=this.points,s=i.length,a=(s-(this.closed?0:1))*e,o=Math.floor(a),l=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:0===l&&o===s-1&&(o=s-2,l=1),this.closed||o>0?t=i[(o-1)%s]:(KV.subVectors(i[0],i[1]).add(i[0]),t=KV);let c=i[o%s],u=i[(o+1)%s];if(this.closed||o+2<s?r=i[(o+2)%s]:(KV.subVectors(i[s-1],i[s-2]).add(i[s-1]),r=KV),"centripetal"===this.curveType||"chordal"===this.curveType){let e="chordal"===this.curveType?.5:.25,n=Math.pow(t.distanceToSquared(c),e),i=Math.pow(c.distanceToSquared(u),e),s=Math.pow(u.distanceToSquared(r),e);i<1e-4&&(i=1),n<1e-4&&(n=i),s<1e-4&&(s=i),QV.initNonuniformCatmullRom(t.x,c.x,u.x,r.x,n,i,s),ZV.initNonuniformCatmullRom(t.y,c.y,u.y,r.y,n,i,s),JV.initNonuniformCatmullRom(t.z,c.z,u.z,r.z,n,i,s)}else"catmullrom"===this.curveType&&(QV.initCatmullRom(t.x,c.x,u.x,r.x,this.tension),ZV.initCatmullRom(t.y,c.y,u.y,r.y,this.tension),JV.initCatmullRom(t.z,c.z,u.z,r.z,this.tension));return n.set(QV.calc(l),ZV.calc(l),JV.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push((new PB).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},CubicBezierCurve:rH,CubicBezierCurve3:nH,EllipseCurve:XV,LineCurve:iH,LineCurve3:sH,QuadraticBezierCurve:aH,QuadraticBezierCurve3:class extends qV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new PB,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PB,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new PB;super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PB,r=this.v0,n=this.v1,i=this.v2;return t.set(eH(e,r.x,n.x,i.x),eH(e,r.y,n.y,i.y),eH(e,r.z,n.z,i.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},SplineCurve:oH}),cH=class extends qV{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new iH(t,e))}getPoint(e,t){let r=e*this.getLength(),n=this.getCurveLengths(),i=0;for(;i<n.length;){if(n[i]>=r){let e=n[i]-r,s=this.curves[i],a=s.getLength(),o=0===a?0:1-e/a;return s.getPointAt(o,t)}i++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,n=this.curves.length;r<n;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,r=[];for(let n=0,i=this.curves;n<i.length;n++){let s=i[n],a=s.isEllipseCurve?2*t:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?t*s.points.length:t,o=s.getPoints(a);for(let t=0;t<o.length;t++){let n=o[t];e&&e.equals(n)||(r.push(n),e=n)}}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let r=e.curves[t];this.curves.push((new lH[r.type]).fromJSON(r))}return this}},uH=class extends cH{constructor(e){super(),this.type="Path",this.currentPoint=new eB,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new iH(this.currentPoint.clone(),new eB(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,n){let i=new aH(this.currentPoint.clone(),new eB(e,t),new eB(r,n));return this.curves.push(i),this.currentPoint.set(r,n),this}bezierCurveTo(e,t,r,n,i,s){let a=new rH(this.currentPoint.clone(),new eB(e,t),new eB(r,n),new eB(i,s));return this.curves.push(a),this.currentPoint.set(i,s),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),r=new oH(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,n,i,s){let a=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+a,t+o,r,n,i,s),this}absarc(e,t,r,n,i,s){return this.absellipse(e,t,r,r,n,i,s),this}ellipse(e,t,r,n,i,s,a,o){let l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,r,n,i,s,a,o),this}absellipse(e,t,r,n,i,s,a,o){let l=new XV(e,t,r,n,i,s,a,o);if(this.curves.length>0){let e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);let c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},hH=class extends iF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new eB(0,-.5),new eB(.5,0),new eB(0,.5)],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},t=Math.floor(t),n=GN(n,0,2*Math.PI);let i=[],s=[],a=[],o=[],l=[],c=1/t,u=new PB,h=new eB,d=new PB,f=new PB,p=new PB,m=0,g=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=1*g,d.y=-m,d.z=0*g,p.copy(d),d.normalize(),o.push(d.x,d.y,d.z);break;case e.length-1:o.push(p.x,p.y,p.z);break;default:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=1*g,d.y=-m,d.z=0*g,f.copy(d),d.x+=p.x,d.y+=p.y,d.z+=p.z,d.normalize(),o.push(d.x,d.y,d.z),p.copy(f)}for(let v=0;v<=t;v++){let i=r+v*c*n,d=Math.sin(i),f=Math.cos(i);for(let r=0;r<=e.length-1;r++){u.x=e[r].x*d,u.y=e[r].y,u.z=e[r].x*f,s.push(u.x,u.y,u.z),h.x=v/t,h.y=r/(e.length-1),a.push(h.x,h.y);let n=o[3*r+0]*d,i=o[3*r+1],c=o[3*r+0]*f;l.push(n,i,c)}}for(let v=0;v<t;v++)for(let t=0;t<e.length-1;t++){let r=t+v*e.length,n=r,s=r+e.length,a=r+e.length+1,o=r+1;i.push(n,s,o),i.push(a,o,s)}this.setIndex(i),this.setAttribute("position",new Qz(s,3)),this.setAttribute("uv",new Qz(a,2)),this.setAttribute("normal",new Qz(l,3))}static fromJSON(e){return new hH(e.points,e.segments,e.phiStart,e.phiLength)}},dH=class extends iF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:s,thetaStart:a,thetaLength:o};let l=this;n=Math.floor(n),i=Math.floor(i);let c=[],u=[],h=[],d=[],f=0,p=[],m=r/2,g=0;function v(r){let i=f,s=new eB,p=new PB,v=0,y=!0===r?e:t,b=!0===r?1:-1;for(let e=1;e<=n;e++)u.push(0,m*b,0),h.push(0,b,0),d.push(.5,.5),f++;let w=f;for(let e=0;e<=n;e++){let t=e/n*o+a,r=Math.cos(t),i=Math.sin(t);p.x=y*i,p.y=m*b,p.z=y*r,u.push(p.x,p.y,p.z),h.push(0,b,0),s.x=.5*r+.5,s.y=.5*i*b+.5,d.push(s.x,s.y),f++}for(let e=0;e<n;e++){let t=i+e,n=w+e;!0===r?c.push(n,n+1,t):c.push(n+1,n,t),v+=3}l.addGroup(g,v,!0===r?1:2),g+=v}(function(){let s=new PB,v=new PB,y=0,b=(t-e)/r;for(let l=0;l<=i;l++){let c=[],g=l/i,y=g*(t-e)+e;for(let e=0;e<=n;e++){let t=e/n,i=t*o+a,l=Math.sin(i),p=Math.cos(i);v.x=y*l,v.y=-g*r+m,v.z=y*p,u.push(v.x,v.y,v.z),s.set(l,b,p).normalize(),h.push(s.x,s.y,s.z),d.push(t,1-g),c.push(f++)}p.push(c)}for(let e=0;e<n;e++)for(let t=0;t<i;t++){let r=p[t][e],n=p[t+1][e],i=p[t+1][e+1],s=p[t][e+1];c.push(r,n,s),c.push(n,i,s),y+=6}l.addGroup(g,y,0),g+=y})(),!1===s&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(c),this.setAttribute("position",new Qz(u,3)),this.setAttribute("normal",new Qz(h,3)),this.setAttribute("uv",new Qz(d,2))}static fromJSON(e){return new dH(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},fH=class extends dH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;super(0,e,t,r,n,i,s,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:s,thetaLength:a}}static fromJSON(e){return new fH(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},pH=class extends iF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n};let i=[],s=[];function a(e,t,r,n){let i=n+1,s=[];for(let a=0;a<=i;a++){s[a]=[];let n=e.clone().lerp(r,a/i),o=t.clone().lerp(r,a/i),l=i-a;for(let e=0;e<=l;e++)s[a][e]=0===e&&a===i?n:n.clone().lerp(o,e/l)}for(let a=0;a<i;a++)for(let e=0;e<2*(i-a)-1;e++){let t=Math.floor(e/2);e%2===0?(o(s[a][t+1]),o(s[a+1][t]),o(s[a][t])):(o(s[a][t+1]),o(s[a+1][t+1]),o(s[a+1][t]))}}function o(e){i.push(e.x,e.y,e.z)}function l(t,r){let n=3*t;r.x=e[n+0],r.y=e[n+1],r.z=e[n+2]}function c(e,t,r,n){n<0&&1===e.x&&(s[t]=e.x-1),0===r.x&&0===r.z&&(s[t]=n/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}function h(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}(function(e){let r=new PB,n=new PB,i=new PB;for(let s=0;s<t.length;s+=3)l(t[s+0],r),l(t[s+1],n),l(t[s+2],i),a(r,n,i,e)})(n),function(e){let t=new PB;for(let r=0;r<i.length;r+=3)t.x=i[r+0],t.y=i[r+1],t.z=i[r+2],t.normalize().multiplyScalar(e),i[r+0]=t.x,i[r+1]=t.y,i[r+2]=t.z}(r),function(){let e=new PB;for(let t=0;t<i.length;t+=3){e.x=i[t+0],e.y=i[t+1],e.z=i[t+2];let r=u(e)/2/Math.PI+.5,n=h(e)/Math.PI+.5;s.push(r,1-n)}(function(){let e=new PB,t=new PB,r=new PB,n=new PB,a=new eB,o=new eB,l=new eB;for(let h=0,d=0;h<i.length;h+=9,d+=6){e.set(i[h+0],i[h+1],i[h+2]),t.set(i[h+3],i[h+4],i[h+5]),r.set(i[h+6],i[h+7],i[h+8]),a.set(s[d+0],s[d+1]),o.set(s[d+2],s[d+3]),l.set(s[d+4],s[d+5]),n.copy(e).add(t).add(r).divideScalar(3);let f=u(n);c(a,d+0,e,f),c(o,d+2,t,f),c(l,d+4,r,f)}})(),function(){for(let e=0;e<s.length;e+=6){let t=s[e+0],r=s[e+2],n=s[e+4],i=Math.max(t,r,n),a=Math.min(t,r,n);i>.9&&a<.1&&(t<.2&&(s[e+0]+=1),r<.2&&(s[e+2]+=1),n<.2&&(s[e+4]+=1))}}()}(),this.setAttribute("position",new Qz(i,3)),this.setAttribute("normal",new Qz(i.slice(),3)),this.setAttribute("uv",new Qz(s,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new pH(e.vertices,e.indices,e.radius,e.details)}},mH=class extends pH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(1+Math.sqrt(5))/2,n=1/r;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new mH(e.radius,e.detail)}},gH=class extends uH{constructor(e){super(e),this.uuid=WN(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let r=e.holes[t];this.holes.push((new uH).fromJSON(r))}return this}},vH=function(e,t){let r,n,i,s,a,o,l,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,u=t&&t.length,h=u?t[0]*c:e.length,d=yH(e,0,h,c,!0),f=[];if(!d||d.next===d.prev)return f;if(u&&(d=function(e,t,r,n){let i,s,a,o,l,c=[];for(i=0,s=t.length;i<s;i++)a=t[i]*n,o=i<s-1?t[i+1]*n:e.length,l=yH(e,a,o,n,!1),l===l.next&&(l.steiner=!0),c.push(PH(l));for(c.sort(EH),i=0;i<c.length;i++)r=AH(c[i],r);return r}(e,t,d,c)),e.length>80*c){r=i=e[0],n=s=e[1];for(let t=c;t<h;t+=c)a=e[t],o=e[t+1],a<r&&(r=a),o<n&&(n=o),a>i&&(i=a),o>s&&(s=o);l=Math.max(i-r,s-n),l=0!==l?32767/l:0}return wH(d,f,c,r,n,l,0),f};function yH(e,t,r,n,i){let s,a;if(i===function(e,t,r,n){let i=0;for(let s=t,a=r-n;s<r;s+=n)i+=(e[a]-e[s])*(e[s+1]+e[a+1]),a=s;return i}(e,t,r,n)>0)for(s=t;s<r;s+=n)a=FH(s,e[s],e[s+1],a);else for(s=r-n;s>=t;s-=n)a=FH(s,e[s],e[s+1],a);return a&&OH(a,a.next)&&(jH(a),a=a.next),a}function bH(e,t){if(!e)return e;t||(t=e);let r,n=e;do{if(r=!1,n.steiner||!OH(n,n.next)&&0!==IH(n.prev,n,n.next))n=n.next;else{if(jH(n),n=t=n.prev,n===n.next)break;r=!0}}while(r||n!==t);return t}function wH(e,t,r,n,i,s,a){if(!e)return;!a&&s&&function(e,t,r,n){let i=e;do{0===i.z&&(i.z=TH(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,r,n,i,s,a,o,l,c=1;do{for(r=e,e=null,s=null,a=0;r;){for(a++,n=r,o=0,t=0;t<c&&(o++,n=n.nextZ,n);t++);for(l=c;o>0||l>0&&n;)0!==o&&(0===l||!n||r.z<=n.z)?(i=r,r=r.nextZ,o--):(i=n,n=n.nextZ,l--),s?s.nextZ=i:e=i,i.prevZ=s,s=i;r=n}s.nextZ=null,c*=2}while(a>1)}(i)}(e,n,i,s);let o,l,c=e;for(;e.prev!==e.next;)if(o=e.prev,l=e.next,s?SH(e,n,i,s):xH(e))t.push(o.i/r|0),t.push(e.i/r|0),t.push(l.i/r|0),jH(e),e=l.next,c=l.next;else if((e=l)===c){a?1===a?wH(e=_H(bH(e),t,r),t,r,n,i,s,2):2===a&&CH(e,t,r,n,i,s):wH(bH(e),t,r,n,i,s,1);break}}function xH(e){let t=e.prev,r=e,n=e.next;if(IH(t,r,n)>=0)return!1;let i=t.x,s=r.x,a=n.x,o=t.y,l=r.y,c=n.y,u=i<s?i<a?i:a:s<a?s:a,h=o<l?o<c?o:c:l<c?l:c,d=i>s?i>a?i:a:s>a?s:a,f=o>l?o>c?o:c:l>c?l:c,p=n.next;for(;p!==t;){if(p.x>=u&&p.x<=d&&p.y>=h&&p.y<=f&&kH(i,o,s,l,a,c,p.x,p.y)&&IH(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function SH(e,t,r,n){let i=e.prev,s=e,a=e.next;if(IH(i,s,a)>=0)return!1;let o=i.x,l=s.x,c=a.x,u=i.y,h=s.y,d=a.y,f=o<l?o<c?o:c:l<c?l:c,p=u<h?u<d?u:d:h<d?h:d,m=o>l?o>c?o:c:l>c?l:c,g=u>h?u>d?u:d:h>d?h:d,v=TH(f,p,t,r,n),y=TH(m,g,t,r,n),b=e.prevZ,w=e.nextZ;for(;b&&b.z>=v&&w&&w.z<=y;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==i&&b!==a&&kH(o,u,l,h,c,d,b.x,b.y)&&IH(b.prev,b,b.next)>=0||(b=b.prevZ,w.x>=f&&w.x<=m&&w.y>=p&&w.y<=g&&w!==i&&w!==a&&kH(o,u,l,h,c,d,w.x,w.y)&&IH(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;b&&b.z>=v;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==i&&b!==a&&kH(o,u,l,h,c,d,b.x,b.y)&&IH(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;w&&w.z<=y;){if(w.x>=f&&w.x<=m&&w.y>=p&&w.y<=g&&w!==i&&w!==a&&kH(o,u,l,h,c,d,w.x,w.y)&&IH(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function _H(e,t,r){let n=e;do{let i=n.prev,s=n.next.next;!OH(i,s)&&RH(i,n,n.next,s)&&BH(i,s)&&BH(s,i)&&(t.push(i.i/r|0),t.push(n.i/r|0),t.push(s.i/r|0),jH(n),jH(n.next),n=e=s),n=n.next}while(n!==e);return bH(n)}function CH(e,t,r,n,i,s){let a=e;do{let e=a.next.next;for(;e!==a.prev;){if(a.i!==e.i&&DH(a,e)){let o=zH(a,e);return a=bH(a,a.next),o=bH(o,o.next),wH(a,t,r,n,i,s,0),void wH(o,t,r,n,i,s,0)}e=e.next}a=a.next}while(a!==e)}function EH(e,t){return e.x-t.x}function AH(e,t){let r=function(e,t){let r,n=t,i=-1/0,s=e.x,a=e.y;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){let e=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=s&&e>i&&(i=e,r=n.x<n.next.x?n:n.next,e===s))return r}n=n.next}while(n!==t);if(!r)return null;let o,l=r,c=r.x,u=r.y,h=1/0;n=r;do{s>=n.x&&n.x>=c&&s!==n.x&&kH(a<u?s:i,a,c,u,a<u?i:s,a,n.x,n.y)&&(o=Math.abs(a-n.y)/(s-n.x),BH(n,e)&&(o<h||o===h&&(n.x>r.x||n.x===r.x&&MH(r,n)))&&(r=n,h=o)),n=n.next}while(n!==l);return r}(e,t);if(!r)return t;let n=zH(r,e);return bH(n,n.next),bH(r,r.next)}function MH(e,t){return IH(e.prev,e,t.prev)<0&&IH(t.next,e,e.next)<0}function TH(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function PH(e){let t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function kH(e,t,r,n,i,s,a,o){return(i-a)*(t-o)>=(e-a)*(s-o)&&(e-a)*(n-o)>=(r-a)*(t-o)&&(r-a)*(s-o)>=(i-a)*(n-o)}function DH(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&RH(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(BH(e,t)&&BH(t,e)&&function(e,t){let r=e,n=!1,i=(e.x+t.x)/2,s=(e.y+t.y)/2;do{r.y>s!=r.next.y>s&&r.next.y!==r.y&&i<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(IH(e.prev,e,t.prev)||IH(e,t.prev,t))||OH(e,t)&&IH(e.prev,e,e.next)>0&&IH(t.prev,t,t.next)>0)}function IH(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function OH(e,t){return e.x===t.x&&e.y===t.y}function RH(e,t,r,n){let i=NH(IH(e,t,r)),s=NH(IH(e,t,n)),a=NH(IH(r,n,e)),o=NH(IH(r,n,t));return!!(i!==s&&a!==o||0===i&&LH(e,r,t)||0===s&&LH(e,n,t)||0===a&&LH(r,e,n)||0===o&&LH(r,t,n))}function LH(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function NH(e){return e>0?1:e<0?-1:0}function BH(e,t){return IH(e.prev,e,e.next)<0?IH(e,t,e.next)>=0&&IH(e,e.prev,t)>=0:IH(e,t,e.prev)<0||IH(e,e.next,t)<0}function zH(e,t){let r=new UH(e.i,e.x,e.y),n=new UH(t.i,t.x,t.y),i=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,s.next=n,n.prev=s,n}function FH(e,t,r,n){let i=new UH(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function jH(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function UH(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}var VH=class{static area(e){let t=e.length,r=0;for(let n=t-1,i=0;i<t;n=i++)r+=e[n].x*e[i].y-e[i].x*e[n].y;return.5*r}static isClockWise(e){return VH.area(e)<0}static triangulateShape(e,t){let r=[],n=[],i=[];HH(e),WH(r,e);let s=e.length;t.forEach(HH);for(let o=0;o<t.length;o++)n.push(s),s+=t[o].length,WH(r,t[o]);let a=vH(r,n);for(let o=0;o<a.length;o+=3)i.push(a.slice(o,o+3));return i}};function HH(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function WH(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}var GH=class extends pH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(1+Math.sqrt(5))/2;super([-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new GH(e.radius,e.detail)}},qH=class extends iF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));let o=Math.min(s+a,Math.PI),l=0,c=[],u=new PB,h=new PB,d=[],f=[],p=[],m=[];for(let g=0;g<=r;g++){let d=[],v=g/r,y=0;0==g&&0==s?y=.5/t:g==r&&o==Math.PI&&(y=-.5/t);for(let r=0;r<=t;r++){let o=r/t;u.x=-e*Math.cos(n+o*i)*Math.sin(s+v*a),u.y=e*Math.cos(s+v*a),u.z=e*Math.sin(n+o*i)*Math.sin(s+v*a),f.push(u.x,u.y,u.z),h.copy(u).normalize(),p.push(h.x,h.y,h.z),m.push(o+y,1-v),d.push(l++)}c.push(d)}for(let g=0;g<r;g++)for(let e=0;e<t;e++){let t=c[g][e+1],n=c[g][e],i=c[g+1][e],a=c[g+1][e+1];(0!==g||s>0)&&d.push(t,n,a),(g!==r-1||o<Math.PI)&&d.push(n,i,a)}this.setIndex(d),this.setAttribute("position",new Qz(f,3)),this.setAttribute("normal",new Qz(p,3)),this.setAttribute("uv",new Qz(m,2))}static fromJSON(e){return new qH(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},XH=class extends iF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:48,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},r=Math.floor(r),n=Math.floor(n);let s=[],a=[],o=[],l=[],c=new PB,u=new PB,h=new PB;for(let d=0;d<=r;d++)for(let s=0;s<=n;s++){let f=s/n*i,p=d/r*Math.PI*2;u.x=(e+t*Math.cos(p))*Math.cos(f),u.y=(e+t*Math.cos(p))*Math.sin(f),u.z=t*Math.sin(p),a.push(u.x,u.y,u.z),c.x=e*Math.cos(f),c.y=e*Math.sin(f),h.subVectors(u,c).normalize(),o.push(h.x,h.y,h.z),l.push(s/n),l.push(d/r)}for(let d=1;d<=r;d++)for(let e=1;e<=n;e++){let t=(n+1)*d+e-1,r=(n+1)*(d-1)+e-1,i=(n+1)*(d-1)+e,a=(n+1)*d+e;s.push(t,r,a),s.push(r,i,a)}this.setIndex(s),this.setAttribute("position",new Qz(a,3)),this.setAttribute("normal",new Qz(o,3)),this.setAttribute("uv",new Qz(l,2))}static fromJSON(e){return new XH(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}},YH=class extends iF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:s},r=Math.floor(r),n=Math.floor(n);let a=[],o=[],l=[],c=[],u=new PB,h=new PB,d=new PB,f=new PB,p=new PB,m=new PB,g=new PB;for(let y=0;y<=r;++y){let a=y/r*i*Math.PI*2;v(a,i,s,e,d),v(a+.01,i,s,e,f),m.subVectors(f,d),g.addVectors(f,d),p.crossVectors(m,g),g.crossVectors(p,m),p.normalize(),g.normalize();for(let e=0;e<=n;++e){let i=e/n*Math.PI*2,s=-t*Math.cos(i),a=t*Math.sin(i);u.x=d.x+(s*g.x+a*p.x),u.y=d.y+(s*g.y+a*p.y),u.z=d.z+(s*g.z+a*p.z),o.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(y/r),c.push(e/n)}}for(let y=1;y<=r;y++)for(let e=1;e<=n;e++){let t=(n+1)*(y-1)+(e-1),r=(n+1)*y+(e-1),i=(n+1)*y+e,s=(n+1)*(y-1)+e;a.push(t,r,s),a.push(r,i,s)}function v(e,t,r,n,i){let s=Math.cos(e),a=Math.sin(e),o=r/t*e,l=Math.cos(o);i.x=n*(2+l)*.5*s,i.y=n*(2+l)*a*.5,i.z=n*Math.sin(o)*.5}this.setIndex(a),this.setAttribute("position",new Qz(o,3)),this.setAttribute("normal",new Qz(l,3)),this.setAttribute("uv",new Qz(c,2))}static fromJSON(e){return new YH(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}},KH=class extends EF{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}};function QH(e,t,r){return JH(e)?new e.constructor(e.subarray(t,void 0!==r?r:e.length)):e.slice(t,r)}function ZH(e,t,r){return!e||!r&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function JH(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function $H(e){let t=e.length,r=new Array(t);for(let n=0;n!==t;++n)r[n]=n;return r.sort((function(t,r){return e[t]-e[r]})),r}function eW(e,t,r){let n=e.length,i=new e.constructor(n);for(let s=0,a=0;a!==n;++s){let n=r[s]*t;for(let r=0;r!==t;++r)i[a++]=e[n+r]}return i}function tW(e,t,r,n){let i=1,s=e[0];for(;void 0!==s&&void 0===s[n];)s=e[i++];if(void 0===s)return;let a=s[n];if(void 0!==a)if(Array.isArray(a))do{a=s[n],void 0!==a&&(t.push(s.time),r.push.apply(r,a)),s=e[i++]}while(void 0!==s);else if(void 0!==a.toArray)do{a=s[n],void 0!==a&&(t.push(s.time),a.toArray(r,r.length)),s=e[i++]}while(void 0!==s);else do{a=s[n],void 0!==a&&(t.push(s.time),r.push(a)),s=e[i++]}while(void 0!==s)}var rW=class{constructor(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,r=this._cachedIndex,n=t[r],i=t[r-1];e:{t:{let s;r:{n:if(!(e<n)){for(let s=r+2;;){if(void 0===n){if(e<i)break n;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===s)break;if(i=n,n=t[++r],e<n)break t}s=t.length;break r}if(e>=i)break e;{let a=t[1];e<a&&(r=2,i=a);for(let s=r-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(r===s)break;if(n=i,i=t[--r-1],e>=i)break t}s=r,r=0}}for(;r<s;){let n=r+s>>>1;e<t[n]?s=n:r=n+1}if(n=t[r],i=t[r-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===n)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n;for(let s=0;s!==n;++s)t[s]=r[i+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},nW=class extends rW{constructor(e,t,r,n){super(e,t,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:AN,endingEnd:AN}}intervalChanged_(e,t,r){let n=this.parameterPositions,i=e-2,s=e+1,a=n[i],o=n[s];if(void 0===a)switch(this.getSettings_().endingStart){case MN:i=e,a=2*t-r;break;case TN:i=n.length-2,a=t+n[i]-n[i+1];break;default:i=e,a=r}if(void 0===o)switch(this.getSettings_().endingEnd){case MN:s=e,o=2*r-t;break;case TN:s=1,o=r+n[1]-n[0];break;default:s=e-1,o=t}let l=.5*(r-t),c=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(o-r),this._offsetPrev=i*c,this._offsetNext=s*c}interpolate_(e,t,r,n){let i=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(r-t)/(n-t),p=f*f,m=p*f,g=-h*m+2*h*p-h*f,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,b=d*m-d*p;for(let w=0;w!==a;++w)i[w]=g*s[c+w]+v*s[l+w]+y*s[o+w]+b*s[u+w];return i}},iW=class extends rW{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e,t,r,n){let i=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=(r-t)/(n-t),u=1-c;for(let h=0;h!==a;++h)i[h]=s[l+h]*u+s[o+h]*c;return i}},sW=class extends rW{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e){return this.copySampleValue_(e-1)}},aW=class{constructor(e,t,r,n){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ZH(t,this.TimeBufferType),this.values=ZH(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){let t,r=e.constructor;if(r.toJSON!==this.toJSON)t=r.toJSON(e);else{t={name:e.name,times:ZH(e.times,Array),values:ZH(e.values,Array)};let r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}InterpolantFactoryMethodDiscrete(e){return new sW(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new iW(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new nW(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case _N:t=this.InterpolantFactoryMethodDiscrete;break;case CN:t=this.InterpolantFactoryMethodLinear;break;case EN:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){let t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return _N;case this.InterpolantFactoryMethodLinear:return CN;case this.InterpolantFactoryMethodSmooth:return EN}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]+=e}return this}scale(e){if(1!==e){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]*=e}return this}trim(e,t){let r=this.times,n=r.length,i=0,s=n-1;for(;i!==n&&r[i]<e;)++i;for(;-1!==s&&r[s]>t;)--s;if(++s,0!==i||s!==n){i>=s&&(s=Math.max(s,1),i=s-1);let e=this.getValueSize();this.times=QH(r,i,s),this.values=QH(this.values,i*e,s*e)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,n=this.values,i=r.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==i;a++){let t=r[a];if("number"==typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,t),e=!1;break}if(null!==s&&s>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,t,s),e=!1;break}s=t}if(void 0!==n&&JH(n))for(let a=0,o=n.length;a!==o;++a){let t=n[a];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,t),e=!1;break}}return e}optimize(){let e=QH(this.times),t=QH(this.values),r=this.getValueSize(),n=this.getInterpolation()===EN,i=e.length-1,s=1;for(let a=1;a<i;++a){let i=!1,o=e[a];if(o!==e[a+1]&&(1!==a||o!==e[0]))if(n)i=!0;else{let e=a*r,n=e-r,s=e+r;for(let a=0;a!==r;++a){let r=t[e+a];if(r!==t[n+a]||r!==t[s+a]){i=!0;break}}}if(i){if(a!==s){e[s]=e[a];let n=a*r,i=s*r;for(let e=0;e!==r;++e)t[i+e]=t[n+e]}++s}}if(i>0){e[s]=e[i];for(let e=i*r,n=s*r,a=0;a!==r;++a)t[n+a]=t[e+a];++s}return s!==e.length?(this.times=QH(e,0,s),this.values=QH(t,0,s*r)):(this.times=e,this.values=t),this}clone(){let e=QH(this.times,0),t=QH(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}};aW.prototype.TimeBufferType=Float32Array,aW.prototype.ValueBufferType=Float32Array,aW.prototype.DefaultInterpolation=CN;var oW=class extends aW{};oW.prototype.ValueTypeName="bool",oW.prototype.ValueBufferType=Array,oW.prototype.DefaultInterpolation=_N,oW.prototype.InterpolantFactoryMethodLinear=void 0,oW.prototype.InterpolantFactoryMethodSmooth=void 0;var lW=class extends aW{};lW.prototype.ValueTypeName="color";var cW=class extends aW{};cW.prototype.ValueTypeName="number";var uW=class extends rW{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e,t,r,n){let i=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(r-t)/(n-t),l=e*a;for(let c=l+a;l!==c;l+=4)TB.slerpFlat(i,0,s,l-a,s,l,o);return i}},hW=class extends aW{InterpolantFactoryMethodLinear(e){return new uW(this.times,this.values,this.getValueSize(),e)}};hW.prototype.ValueTypeName="quaternion",hW.prototype.DefaultInterpolation=CN,hW.prototype.InterpolantFactoryMethodSmooth=void 0;var dW=class extends aW{};dW.prototype.ValueTypeName="string",dW.prototype.ValueBufferType=Array,dW.prototype.DefaultInterpolation=_N,dW.prototype.InterpolantFactoryMethodLinear=void 0,dW.prototype.InterpolantFactoryMethodSmooth=void 0;var fW=class extends aW{};fW.prototype.ValueTypeName="vector";var pW=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:PN;this.name=e,this.tracks=r,this.duration=t,this.blendMode=n,this.uuid=WN(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],r=e.tracks,n=1/(e.fps||1);for(let s=0,a=r.length;s!==a;++s)t.push(mW(r[s]).scale(n));let i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){let t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let i=0,s=r.length;i!==s;++i)t.push(aW.toJSON(r[i]));return n}static CreateFromMorphTargetSequence(e,t,r,n){let i=t.length,s=[];for(let a=0;a<i;a++){let e=[],o=[];e.push((a+i-1)%i,a,(a+1)%i),o.push(0,1,0);let l=$H(e);e=eW(e,1,l),o=eW(o,1,l),!n&&0===e[0]&&(e.push(i),o.push(o[0])),s.push(new cW(".morphTargetInfluences["+t[a].name+"]",e,o).scale(1/r))}return new this(e,-1,s)}static findByName(e,t){let r=e;if(!Array.isArray(e)){let t=e;r=t.geometry&&t.geometry.animations||t.animations}for(let n=0;n<r.length;n++)if(r[n].name===t)return r[n];return null}static CreateClipsFromMorphTargetSequences(e,t,r){let n={},i=/^([\w-]*?)([\d]+)$/;for(let a=0,o=e.length;a<o;a++){let t=e[a],r=t.name.match(i);if(r&&r.length>1){let e=r[1],i=n[e];i||(n[e]=i=[]),i.push(t)}}let s=[];for(let a in n)s.push(this.CreateFromMorphTargetSequence(a,n[a],t,r));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=function(e,t,r,n,i){if(0!==r.length){let s=[],a=[];tW(r,s,a,n),0!==s.length&&i.push(new e(t,s,a))}},n=[],i=e.name||"default",s=e.fps||30,a=e.blendMode,o=e.length||-1,l=e.hierarchy||[];for(let c=0;c<l.length;c++){let e=l[c].keys;if(e&&0!==e.length)if(e[0].morphTargets){let t,r={};for(t=0;t<e.length;t++)if(e[t].morphTargets)for(let n=0;n<e[t].morphTargets.length;n++)r[e[t].morphTargets[n]]=-1;for(let i in r){let r=[],s=[];for(let n=0;n!==e[t].morphTargets.length;++n){let n=e[t];r.push(n.time),s.push(n.morphTarget===i?1:0)}n.push(new cW(".morphTargetInfluence["+i+"]",r,s))}o=r.length*s}else{let i=".bones["+t[c].name+"]";r(fW,i+".position",e,"pos",n),r(hW,i+".quaternion",e,"rot",n),r(fW,i+".scale",e,"scl",n)}}return 0===n.length?null:new this(i,o,n,a)}resetDuration(){let e=0;for(let t=0,r=this.tracks.length;t!==r;++t){let r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function mW(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return cW;case"vector":case"vector2":case"vector3":case"vector4":return fW;case"color":return lW;case"quaternion":return hW;case"bool":case"boolean":return oW;case"string":return dW}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){let t=[],r=[];tW(e.keys,t,r,"value"),e.times=t,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var gW={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},vW=class{constructor(e,t,r){let n,i=this,s=!1,a=0,o=0,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(e){o++,!1===s&&void 0!==i.onStart&&i.onStart(e,a,o),s=!0},this.itemEnd=function(e){a++,void 0!==i.onProgress&&i.onProgress(e,a,o),a===o&&(s=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return n?n(e):e},this.setURLModifier=function(e){return n=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){let t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,r=l.length;t<r;t+=2){let r=l[t],n=l[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return n}return null}}},yW=new vW,bW=class{constructor(e){this.manager=void 0!==e?e:yW,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let r=this;return new Promise((function(n,i){r.load(e,n,t,i)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},wW={},xW=class extends Error{constructor(e,t){super(e),this.response=t}},SW=class extends bW{constructor(e){super(e)}load(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let i=gW.get(e);if(void 0!==i)return this.manager.itemStart(e),setTimeout((()=>{t&&t(i),this.manager.itemEnd(e)}),0),i;if(void 0!==wW[e])return void wW[e].push({onLoad:t,onProgress:r,onError:n});wW[e]=[],wW[e].push({onLoad:t,onProgress:r,onError:n});let s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,o=this.responseType;fetch(s).then((t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===t.body||void 0===t.body.getReader)return t;let r=wW[e],n=t.body.getReader(),i=t.headers.get("Content-Length")||t.headers.get("X-File-Size"),s=i?parseInt(i):0,a=0!==s,o=0,l=new ReadableStream({start(e){!function t(){n.read().then((n=>{let{done:i,value:l}=n;if(i)e.close();else{o+=l.byteLength;let n=new ProgressEvent("progress",{lengthComputable:a,loaded:o,total:s});for(let e=0,t=r.length;e<t;e++){let t=r[e];t.onProgress&&t.onProgress(n)}e.enqueue(l),t()}}))}()}});return new Response(l)}throw new xW('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)})).then((e=>{switch(o){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,a)));case"json":return e.json();default:if(void 0===a)return e.text();{let t=/charset="?([^;"\s]*)"?/i.exec(a),r=t&&t[1]?t[1].toLowerCase():void 0,n=new TextDecoder(r);return e.arrayBuffer().then((e=>n.decode(e)))}}})).then((t=>{gW.add(e,t);let r=wW[e];delete wW[e];for(let e=0,n=r.length;e<n;e++){let n=r[e];n.onLoad&&n.onLoad(t)}})).catch((t=>{let r=wW[e];if(void 0===r)throw this.manager.itemError(e),t;delete wW[e];for(let e=0,n=r.length;e<n;e++){let n=r[e];n.onError&&n.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},_W=class extends bW{constructor(e){super(e)}load(e,t,r,n){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let i=this,s=gW.get(e);if(void 0!==s)return i.manager.itemStart(e),setTimeout((function(){t&&t(s),i.manager.itemEnd(e)}),0),s;let a=aB("img");function o(){c(),gW.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){c(),n&&n(t),i.manager.itemError(e),i.manager.itemEnd(e)}function c(){a.removeEventListener("load",o,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",o,!1),a.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(e),a.src=e,a}},CW=class extends bW{constructor(e){super(e)}load(e,t,r,n){let i=new _B,s=new _W(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,(function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)}),r,n),i}},EW=class extends kz{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.isLight=!0,this.type="Light",this.color=new vB(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}},AW=class extends EW{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(kz.DEFAULT_UP),this.updateMatrix(),this.groundColor=new vB(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},MW=new sz,TW=new PB,PW=new PB,kW=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new eB(512,512),this.map=null,this.mapPass=null,this.matrix=new sz,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new zF,this._frameExtents=new eB(1,1),this._viewportCount=1,this._viewports=[new CB(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,r=this.matrix;TW.setFromMatrixPosition(e.matrixWorld),t.position.copy(TW),PW.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(PW),t.updateMatrixWorld(),MW.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(MW),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(MW)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){let e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},DW=class extends kW{constructor(){super(new MF(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,r=2*HN*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;(r!==t.fov||n!==t.aspect||i!==t.far)&&(t.fov=r,t.aspect=n,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},IW=class extends EW{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2;super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(kz.DEFAULT_UP),this.updateMatrix(),this.target=new kz,this.distance=r,this.angle=n,this.penumbra=i,this.decay=s,this.map=null,this.shadow=new DW}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},OW=new sz,RW=new PB,LW=new PB,NW=class extends kW{constructor(){super(new MF(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new eB(4,2),this._viewportCount=6,this._viewports=[new CB(2,1,1,1),new CB(0,1,1,1),new CB(3,1,1,1),new CB(1,1,1,1),new CB(3,0,1,1),new CB(1,0,1,1)],this._cubeDirections=[new PB(1,0,0),new PB(-1,0,0),new PB(0,0,1),new PB(0,0,-1),new PB(0,1,0),new PB(0,-1,0)],this._cubeUps=[new PB(0,1,0),new PB(0,1,0),new PB(0,1,0),new PB(0,1,0),new PB(0,0,1),new PB(0,0,-1)]}updateMatrices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.camera,n=this.matrix,i=e.distance||r.far;i!==r.far&&(r.far=i,r.updateProjectionMatrix()),RW.setFromMatrixPosition(e.matrixWorld),r.position.copy(RW),LW.copy(r.position),LW.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(LW),r.updateMatrixWorld(),n.makeTranslation(-RW.x,-RW.y,-RW.z),OW.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(OW)}},BW=class extends EW{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=n,this.shadow=new NW}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},zW=class extends kW{constructor(){super(new JF(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},FW=class extends EW{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(kz.DEFAULT_UP),this.updateMatrix(),this.target=new kz,this.shadow=new zW}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},jW=class extends iF{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},UW=class extends bW{constructor(e){super(e)}load(e,t,r,n){let i=this,s=new SW(i.manager);s.setPath(i.path),s.setRequestHeader(i.requestHeader),s.setWithCredentials(i.withCredentials),s.load(e,(function(r){try{t(i.parse(JSON.parse(r)))}catch(s){n?n(s):console.error(s),i.manager.itemError(e)}}),r,n)}parse(e){let t={},r={};function n(e,n){if(void 0!==t[n])return t[n];let i=e.interleavedBuffers[n],s=function(e,t){if(void 0!==r[t])return r[t];let n=e.arrayBuffers[t],i=new Uint32Array(n).buffer;return r[t]=i,i}(e,i.buffer),a=sB(i.type,s),o=new bV(a,i.stride);return o.uuid=i.uuid,t[n]=o,o}let i=e.isInstancedBufferGeometry?new jW:new iF,s=e.data.index;if(void 0!==s){let e=sB(s.type,s.array);i.setIndex(new Xz(e,1))}let a=e.data.attributes;for(let u in a){let t,r=a[u];if(r.isInterleavedBufferAttribute){let i=n(e.data,r.data);t=new xV(i,r.itemSize,r.offset,r.normalized)}else{let e=sB(r.type,r.array);t=new(r.isInstancedBufferAttribute?MV:Xz)(e,r.itemSize,r.normalized)}void 0!==r.name&&(t.name=r.name),void 0!==r.usage&&t.setUsage(r.usage),void 0!==r.updateRange&&(t.updateRange.offset=r.updateRange.offset,t.updateRange.count=r.updateRange.count),i.setAttribute(u,t)}let o=e.data.morphAttributes;if(o)for(let u in o){let t=o[u],r=[];for(let i=0,s=t.length;i<s;i++){let s,a=t[i];if(a.isInterleavedBufferAttribute){let t=n(e.data,a.data);s=new xV(t,a.itemSize,a.offset,a.normalized)}else{let e=sB(a.type,a.array);s=new Xz(e,a.itemSize,a.normalized)}void 0!==a.name&&(s.name=a.name),r.push(s)}i.morphAttributes[u]=r}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);let l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let u=0,h=l.length;u!==h;++u){let e=l[u];i.addGroup(e.start,e.count,e.materialIndex)}let c=e.data.boundingSphere;if(void 0!==c){let e=new PB;void 0!==c.center&&e.fromArray(c.center),i.boundingSphere=new QB(e,c.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}},VW=class{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=HW(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=HW();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function HW(){return(typeof performance>"u"?Date:performance).now()}var WW=class{constructor(e,t,r){let n,i,s;switch(this.binding=e,this.valueSize=r,t){case"quaternion":n=this._slerp,i=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":n=this._select,i=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:n=this._lerp,i=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=i,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let r=this.buffer,n=this.valueSize,i=e*n+n,s=this.cumulativeWeight;if(0===s){for(let e=0;e!==n;++e)r[i+e]=r[e];s=t}else{s+=t;let e=t/s;this._mixBufferRegion(r,i,0,e,n)}this.cumulativeWeight=s}accumulateAdditive(e){let t=this.buffer,r=this.valueSize,n=r*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,n,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,r=this.buffer,n=e*t+t,i=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){let e=t*this._origIndex;this._mixBufferRegion(r,n,e,1-i,t)}s>0&&this._mixBufferRegionAdditive(r,n,this._addIndex*t,1,t);for(let o=t,l=t+t;o!==l;++o)if(r[o]!==r[o+t]){a.setValue(r,n);break}}saveOriginalState(){let e=this.binding,t=this.buffer,r=this.valueSize,n=r*this._origIndex;e.getValue(t,n);for(let i=r,s=n;i!==s;++i)t[i]=t[n+i%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,n,i){if(n>=.5)for(let s=0;s!==i;++s)e[t+s]=e[r+s]}_slerp(e,t,r,n){TB.slerpFlat(e,t,e,t,e,r,n)}_slerpAdditive(e,t,r,n,i){let s=this._workIndex*i;TB.multiplyQuaternionsFlat(e,s,e,t,e,r),TB.slerpFlat(e,t,e,t,e,s,n)}_lerp(e,t,r,n,i){let s=1-n;for(let a=0;a!==i;++a){let i=t+a;e[i]=e[i]*s+e[r+a]*n}}_lerpAdditive(e,t,r,n,i){for(let s=0;s!==i;++s){let i=t+s;e[i]=e[i]+e[r+s]*n}}},GW="\\[\\]\\.:\\/",qW=new RegExp("["+GW+"]","g"),XW="[^"+GW+"]",YW="[^"+GW.replace("\\.","")+"]",KW=/((?:WC+[\/:])*)/.source.replace("WC",XW),QW=/(WCOD+)?/.source.replace("WCOD",YW),ZW=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",XW),JW=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",XW),$W=new RegExp("^"+KW+QW+ZW+JW+"$"),eG=["material","materials","bones","map"],tG=class{constructor(e,t,r){this.path=t,this.parsedPath=r||tG.parseTrackName(t),this.node=tG.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new tG.Composite(e,t,r):new tG(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(qW,"")}static parseTrackName(e){let t=$W.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){let e=r.nodeName.substring(n+1);-1!==eG.indexOf(e)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=e)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(void 0!==r)return r}if(e.children){let r=function(e){for(let n=0;n<e.length;n++){let i=e[n];if(i.name===t||i.uuid===t)return i;let s=r(i.children);if(s)return s}return null},n=r(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)e[t++]=r[n]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,i=t.propertyIndex;if(e||(e=tG.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let n=t.objectIndex;switch(r){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===n){n=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[r]}if(void 0!==n){if(void 0===e[n])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[n]}}let s=e[n];if(void 0===s){let r=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+r+"."+n+" but it wasn't found.",e)}let a=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};tG.Composite=class{constructor(e,t,r){let n=r||tG.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}getValue(e,t){this.bind();let r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(e,t)}setValue(e,t){let r=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}},tG.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},tG.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},tG.prototype.GetterByBindingType=[tG.prototype._getValue_direct,tG.prototype._getValue_array,tG.prototype._getValue_arrayElement,tG.prototype._getValue_toArray],tG.prototype.SetterByBindingTypeAndVersioning=[[tG.prototype._setValue_direct,tG.prototype._setValue_direct_setNeedsUpdate,tG.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[tG.prototype._setValue_array,tG.prototype._setValue_array_setNeedsUpdate,tG.prototype._setValue_array_setMatrixWorldNeedsUpdate],[tG.prototype._setValue_arrayElement,tG.prototype._setValue_arrayElement_setNeedsUpdate,tG.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[tG.prototype._setValue_fromArray,tG.prototype._setValue_fromArray_setNeedsUpdate,tG.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var rG=class{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.blendMode;this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=n;let i=t.tracks,s=i.length,a=new Array(s),o={endingStart:AN,endingEnd:AN};for(let l=0;l!==s;++l){let e=i[l].createInterpolant(null);a[l]=e,e.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){let r=this._clip.duration,n=e._clip.duration,i=n/r,s=r/n;e.warp(1,i,t),this.warp(s,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){let e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){let n=this._mixer,i=n.time,s=this.timeScale,a=this._timeScaleInterpolant;null===a&&(a=n._lendControlInterpolant(),this._timeScaleInterpolant=a);let o=a.parameterPositions,l=a.sampleValues;return o[0]=i,o[1]=i+r,l[0]=e/s,l[1]=t/s,this}stopWarping(){let e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,n){if(!this.enabled)return void this._updateWeight(e);let i=this._startTime;if(null!==i){let n=(e-i)*r;n<0||0===r?t=0:(this._startTime=null,t=r*n)}t*=this._updateTimeScale(e);let s=this._updateTime(t),a=this._updateWeight(e);if(a>0){let e=this._interpolants,t=this._propertyBindings;if(2501===this.blendMode)for(let r=0,n=e.length;r!==n;++r)e[r].evaluate(s),t[r].accumulateAdditive(a);else for(let r=0,i=e.length;r!==i;++r)e[r].evaluate(s),t[r].accumulate(n,a)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let r=this._weightInterpolant;if(null!==r){let n=r.evaluate(e)[0];t*=n,e>r.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let r=this._timeScaleInterpolant;if(null!==r){t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,r=this.loop,n=this.time+e,i=this._loopCount,s=r===SN;if(0===e)return-1===i?n:s&&1===(1&i)?t-n:n;if(2200===r){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=t)n=t;else{if(!(n<0)){this.time=n;break e}n=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),n>=t||n<0){let r=Math.floor(n/t);n-=t*r,i+=Math.abs(r);let a=this.repetitions-i;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=e>0?t:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===a){let t=e<0;this._setEndings(t,!t,s)}else this._setEndings(!1,!1,s);this._loopCount=i,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:r})}}else this.time=n;if(s&&1===(1&i))return t-n}return n}_setEndings(e,t,r){let n=this._interpolantSettings;r?(n.endingStart=MN,n.endingEnd=MN):(n.endingStart=e?this.zeroSlopeAtStart?MN:AN:TN,n.endingEnd=t?this.zeroSlopeAtEnd?MN:AN:TN)}_scheduleFading(e,t,r){let n=this._mixer,i=n.time,s=this._weightInterpolant;null===s&&(s=n._lendControlInterpolant(),this._weightInterpolant=s);let a=s.parameterPositions,o=s.sampleValues;return a[0]=i,o[0]=t,a[1]=i+e,o[1]=r,this}},nG=new Float32Array(1),iG=class extends FN{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let r=e._localRoot||this._root,n=e._clip.tracks,i=n.length,s=e._propertyBindings,a=e._interpolants,o=r.uuid,l=this._bindingsByRootAndName,c=l[o];void 0===c&&(c={},l[o]=c);for(let u=0;u!==i;++u){let e=n[u],i=e.name,l=c[i];if(void 0!==l)++l.referenceCount,s[u]=l;else{if(l=s[u],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,o,i));continue}let n=t&&t._propertyBindings[u].binding.parsedPath;l=new WW(tG.create(r,i,n),e.ValueTypeName,e.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,o,i),s[u]=l}a[u].resultBuffer=l.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){let t=(e._localRoot||this._root).uuid,r=e._clip.uuid,n=this._actionsByClip[r];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,r,t)}let t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){let r=t[e];0===r.useCount++&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){let r=t[e];0===--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,r){let n=this._actions,i=this._actionsByClip,s=i[t];if(void 0===s)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=s;else{let t=s.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=n.length,n.push(e),s.actionByRoot[r]=e}_removeInactiveAction(e){let t=this._actions,r=t[t.length-1],n=e._cacheIndex;r._cacheIndex=n,t[n]=r,t.pop(),e._cacheIndex=null;let i=e._clip.uuid,s=this._actionsByClip,a=s[i],o=a.knownActions,l=o[o.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,o[c]=l,o.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===o.length&&delete s[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let r=0,n=t.length;r!==n;++r){let e=t[r];0===--e.referenceCount&&this._removeInactiveBinding(e)}}_lendAction(e){let t=this._actions,r=e._cacheIndex,n=this._nActiveActions++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_takeBackAction(e){let t=this._actions,r=e._cacheIndex,n=--this._nActiveActions,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_addInactiveBinding(e,t,r){let n=this._bindingsByRootAndName,i=this._bindings,s=n[t];void 0===s&&(s={},n[t]=s),s[r]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){let t=this._bindings,r=e.binding,n=r.rootNode.uuid,i=r.path,s=this._bindingsByRootAndName,a=s[n],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete a[i],0===Object.keys(a).length&&delete s[n]}_lendBinding(e){let t=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_takeBackBinding(e){let t=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return void 0===r&&(r=new iW(new Float32Array(2),new Float32Array(2),1,nG),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){let t=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,i=t[n];e.__cacheIndex=n,t[n]=e,i.__cacheIndex=r,t[r]=i}clipAction(e,t,r){let n=t||this._root,i=n.uuid,s="string"==typeof e?pW.findByName(n,e):e,a=null!==s?s.uuid:e,o=this._actionsByClip[a],l=null;if(void 0===r&&(r=null!==s?s.blendMode:PN),void 0!==o){let e=o.actionByRoot[i];if(void 0!==e&&e.blendMode===r)return e;l=o.knownActions[0],null===s&&(s=l._clip)}if(null===s)return null;let c=new rG(this,s,t,r);return this._bindAction(c,l),this._addInactiveAction(c,a,i),c}existingAction(e,t){let r=t||this._root,n=r.uuid,i="string"==typeof e?pW.findByName(r,e):e,s=i?i.uuid:e,a=this._actionsByClip[s];return void 0!==a&&a.actionByRoot[n]||null}stopAllAction(){let e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;let t=this._actions,r=this._nActiveActions,n=this.time+=e,i=Math.sign(e),s=this._accuIndex^=1;for(let l=0;l!==r;++l)t[l]._update(n,e,i,s);let a=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)a[l].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,r=e.uuid,n=this._actionsByClip,i=n[r];if(void 0!==i){let e=i.knownActions;for(let r=0,n=e.length;r!==n;++r){let n=e[r];this._deactivateAction(n);let i=n._cacheIndex,s=t[t.length-1];n._cacheIndex=null,n._byClipCacheIndex=null,s._cacheIndex=i,t[i]=s,t.pop(),this._removeInactiveBindingsForAction(n)}delete n[r]}}uncacheRoot(e){let t=e.uuid,r=this._actionsByClip;for(let i in r){let e=r[i].actionByRoot[t];void 0!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}let n=this._bindingsByRootAndName[t];if(void 0!==n)for(let i in n){let e=n[i];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(e,t){let r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}},sG=class{constructor(e){this.value=e}clone(){return new sG(void 0===this.value.clone?this.value:this.value.clone())}},aG=class{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new iz(e,t),this.near=r,this.far=n,this.camera=null,this.layers=new gz,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return lG(e,this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),t.sort(oG),t}intersectObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let n=0,i=e.length;n<i;n++)lG(e[n],this,r,t);return r.sort(oG),r}};function oG(e,t){return e.distance-t.distance}function lG(e,t,r,n){if(e.layers.test(t.layers)&&e.raycast(t,r),!0===n){let n=e.children;for(let e=0,i=n.length;e<i;e++)lG(n[e],t,r,!0)}}var cG=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(GN(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}},uG=new eB,hG=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new eB(1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new eB(-1/0,-1/0);this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=uG.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return uG.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},dG=new PB,fG=new PB,pG=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new PB,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PB;this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){dG.subVectors(e,this.start),fG.subVectors(this.end,this.start);let r=fG.dot(fG),n=fG.dot(dG)/r;return t&&(n=GN(n,0,1)),n}closestPointToPoint(e,t,r){let n=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(n).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}},mG=new PB,gG=class extends kz{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let r=new iF,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,a=1,o=32;s<o;s++,a++){let e=s/o*Math.PI*2,t=a/o*Math.PI*2;n.push(Math.cos(e),Math.sin(e),1,Math.cos(t),Math.sin(t),1)}r.setAttribute("position",new Qz(n,3));let i=new RV({fog:!1,toneMapped:!1});this.cone=new HV(r,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),mG.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(mG),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},vG=class extends yF{constructor(e,t,r){super(new qH(t,4,2),new Wz({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},yG=new PB,bG=new PB,wG=new PB,xG=class extends kz{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",void 0===t&&(t=1);let n=new iF;n.setAttribute("position",new Qz([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let i=new RV({fog:!1,toneMapped:!1});this.lightPlane=new jV(n,i),this.add(this.lightPlane),n=new iF,n.setAttribute("position",new Qz([0,0,0,0,0,1],3)),this.targetLine=new jV(n,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),yG.setFromMatrixPosition(this.light.matrixWorld),bG.setFromMatrixPosition(this.light.target.matrixWorld),wG.subVectors(bG,yG),this.lightPlane.lookAt(bG),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(bG),this.targetLine.scale.z=wG.length()}},SG=new PB,_G=new AF,CG=class extends HV{constructor(e){let t=new iF,r=new RV({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],i=[],s={};function a(e,t){o(e),o(t)}function o(e){n.push(0,0,0),i.push(0,0,0),void 0===s[e]&&(s[e]=[]),s[e].push(n.length/3-1)}a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4"),t.setAttribute("position",new Qz(n,3)),t.setAttribute("color",new Qz(i,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();let l=new vB(16755200),c=new vB(16711680),u=new vB(43775),h=new vB(16777215),d=new vB(3355443);this.setColors(l,c,u,h,d)}setColors(e,t,r,n,i){let s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,r.r,r.g,r.b),s.setXYZ(33,r.r,r.g,r.b),s.setXYZ(34,r.r,r.g,r.b),s.setXYZ(35,r.r,r.g,r.b),s.setXYZ(36,r.r,r.g,r.b),s.setXYZ(37,r.r,r.g,r.b),s.setXYZ(38,n.r,n.g,n.b),s.setXYZ(39,n.r,n.g,n.b),s.setXYZ(40,i.r,i.g,i.b),s.setXYZ(41,i.r,i.g,i.b),s.setXYZ(42,i.r,i.g,i.b),s.setXYZ(43,i.r,i.g,i.b),s.setXYZ(44,i.r,i.g,i.b),s.setXYZ(45,i.r,i.g,i.b),s.setXYZ(46,i.r,i.g,i.b),s.setXYZ(47,i.r,i.g,i.b),s.setXYZ(48,i.r,i.g,i.b),s.setXYZ(49,i.r,i.g,i.b),s.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap;_G.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),EG("c",t,e,_G,0,0,-1),EG("t",t,e,_G,0,0,1),EG("n1",t,e,_G,-1,-1,-1),EG("n2",t,e,_G,1,-1,-1),EG("n3",t,e,_G,-1,1,-1),EG("n4",t,e,_G,1,1,-1),EG("f1",t,e,_G,-1,-1,1),EG("f2",t,e,_G,1,-1,1),EG("f3",t,e,_G,-1,1,1),EG("f4",t,e,_G,1,1,1),EG("u1",t,e,_G,.7,1.1,-1),EG("u2",t,e,_G,-.7,1.1,-1),EG("u3",t,e,_G,0,2,-1),EG("cf1",t,e,_G,-1,0,1),EG("cf2",t,e,_G,1,0,1),EG("cf3",t,e,_G,0,-1,1),EG("cf4",t,e,_G,0,1,1),EG("cn1",t,e,_G,-1,0,-1),EG("cn2",t,e,_G,1,0,-1),EG("cn3",t,e,_G,0,-1,-1),EG("cn4",t,e,_G,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function EG(e,t,r,n,i,s,a){SG.set(i,s,a).unproject(n);let o=t[e];if(void 0!==o){let e=r.getAttribute("position");for(let t=0,r=o.length;t<r;t++)e.setXYZ(o[t],SG.x,SG.y,SG.z)}}var AG=class extends HV{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960,r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new iF;n.setIndex(new Xz(r,1)),n.setAttribute("position",new Qz([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(n,new RV({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},MG=class extends HV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new iF;r.setAttribute("position",new Qz(t,3)),r.setAttribute("color",new Qz([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(r,new RV({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,r){let n=new vB,i=this.geometry.attributes.color.array;return n.set(e),n.toArray(i,0),n.toArray(i,3),n.set(t),n.toArray(i,6),n.toArray(i,9),n.set(r),n.toArray(i,12),n.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},TG=function(){let e=new ArrayBuffer(4),t=new Float32Array(e),r=new Uint32Array(e),n=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){let e=l-127;e<-27?(n[l]=0,n[256|l]=32768,i[l]=24,i[256|l]=24):e<-14?(n[l]=1024>>-e-14,n[256|l]=1024>>-e-14|32768,i[l]=-e-1,i[256|l]=-e-1):e<=15?(n[l]=e+15<<10,n[256|l]=e+15<<10|32768,i[l]=13,i[256|l]=13):e<128?(n[l]=31744,n[256|l]=64512,i[l]=24,i[256|l]=24):(n[l]=31744,n[256|l]=64512,i[l]=13,i[256|l]=13)}let s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let e=l<<13,t=0;for(;0===(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,s[l]=e|t}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(o[l]=1024);return{floatView:t,uint32View:r,baseTable:n,shiftTable:i,mantissaTable:s,exponentTable:a,offsetTable:o}}();var PG=Object.freeze({__proto__:null,fromHalfFloat:function(e){let t=e>>10;return TG.uint32View[0]=TG.mantissaTable[TG.offsetTable[t]+(1023&e)]+TG.exponentTable[t],TG.floatView[0]},toHalfFloat:function(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=GN(e,-65504,65504),TG.floatView[0]=e;let t=TG.uint32View[0],r=t>>23&511;return TG.baseTable[r]+((8388607&t)>>TG.shiftTable[r])}});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ML}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ML);var kG=".",DG=Symbol("target"),IG=Symbol("unsubscribe");function OG(e){return e instanceof Date||e instanceof Set||e instanceof Map||e instanceof WeakSet||e instanceof WeakMap||ArrayBuffer.isView(e)}var RG=Array.isArray;function LG(e){return"symbol"==typeof e}var NG={after:(e,t)=>RG(e)?e.slice(t.length):""===t?e:e.slice(t.length+1),concat:(e,t)=>RG(e)?(e=[...e],t&&e.push(t),e):t&&void 0!==t.toString?(""!==e&&(e+=kG),LG(t)?e+t.toString():e+t):e,initial:e=>{if(RG(e))return e.slice(0,-1);if(""===e)return e;let t=e.lastIndexOf(kG);return-1===t?"":e.slice(0,t)},last:e=>{if(RG(e))return e[e.length-1]||"";if(""===e)return e;let t=e.lastIndexOf(kG);return-1===t?e:e.slice(t+1)},walk:(e,t)=>{if(RG(e))for(let r of e)t(r);else if(""!==e){let r=0,n=e.indexOf(kG);if(-1===n)t(e);else for(;r<e.length;)-1===n&&(n=e.length),t(e.slice(r,n)),r=n+1,n=e.indexOf(kG,r)}},get(e,t){return this.walk(t,(t=>{e&&(e=e[t])})),e}},BG=NG;function zG(e,t,r){return e.isUnsubscribed||t.ignoreSymbols&&LG(r)||t.ignoreUnderscores&&"_"===r.charAt(0)||"ignoreKeys"in t&&t.ignoreKeys.includes(r)}var FG=class{constructor(e){this._equals=e,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return void 0===this._descriptorCache&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(e){let t=this._getDescriptorCache(),r=t.get(e);return void 0===r&&(r={},t.set(e,r)),r}_getOwnPropertyDescriptor(e,t){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(e,t);let r=this._getProperties(e),n=r[t];return void 0===n&&(n=Reflect.getOwnPropertyDescriptor(e,t),r[t]=n),n}getProxy(e,t,r,n){if(this.isUnsubscribed)return e;let i=e[n],s=i||e;this._pathCache.set(s,t);let a=this._proxyCache.get(s);return void 0===a&&(a=void 0===i?new Proxy(e,r):e,this._proxyCache.set(s,a)),a}getPath(e){return this.isUnsubscribed?void 0:this._pathCache.get(e)}isDetached(e,t){return!Object.is(e,BG.get(t,this.getPath(e)))}defineProperty(e,t,r){return!!Reflect.defineProperty(e,t,r)&&(this.isUnsubscribed||(this._getProperties(e)[t]=r),!0)}setProperty(e,t,r,n,i){if(!this._equals(i,r)||!(t in e)){let i=this._getOwnPropertyDescriptor(e,t);return void 0!==i&&"set"in i?Reflect.set(e,t,r,n):Reflect.set(e,t,r)}return!0}deleteProperty(e,t,r){if(Reflect.deleteProperty(e,t)){if(!this.isUnsubscribed){let n=this._getDescriptorCache().get(e);n&&(delete n[t],this._pathCache.delete(r))}return!0}return!1}isSameDescriptor(e,t,r){let n=this._getOwnPropertyDescriptor(t,r);return void 0!==e&&void 0!==n&&Object.is(e.value,n.value)&&(e.writable||!1)===(n.writable||!1)&&(e.enumerable||!1)===(n.enumerable||!1)&&(e.configurable||!1)===(n.configurable||!1)&&e.get===n.get&&e.set===n.set}isGetInvariant(e,t){let r=this._getOwnPropertyDescriptor(e,t);return void 0!==r&&!0!==r.configurable&&!0!==r.writable}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function jG(e){return"[object Object]"===toString.call(e)}function UG(){return!0}function VG(e,t){return e.length!==t.length||e.some(((e,r)=>t[r]!==e))}var HG=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),WG=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),GG={push:UG,pop:UG,shift:UG,unshift:UG,copyWithin:VG,reverse:VG,sort:VG,splice:VG,flat:VG,fill:VG},qG=new Set([...HG,...WG,...Object.keys(GG)]);function XG(e,t){if(e.size!==t.size)return!0;for(let r of e)if(!t.has(r))return!0;return!1}var YG=["keys","values","entries"],KG=new Set(["has","toString"]),QG={add:XG,clear:XG,delete:XG,forEach:XG},ZG=new Set([...KG,...Object.keys(QG),...YG]);function JG(e,t){if(e.size!==t.size)return!0;let r;for(let[n,i]of e)if(r=t.get(n),r!==i||void 0===r&&!t.has(n))return!0;return!1}var $G=new Set([...KG,"get"]),eq={set:JG,clear:JG,delete:JG,forEach:JG},tq=new Set([...$G,...Object.keys(eq),...YG]),rq=class{constructor(e,t,r,n){this._path=t,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=n,this._changes=n?[]:null,this.clone=void 0===t?e:this._shallowClone(e)}static isHandledMethod(e){return HG.has(e)}_shallowClone(e){let t=e;if(jG(e))t=u({},e);else if(RG(e))t=[...e];else if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set([...e].map((e=>this._shallowClone(e))));else if(e instanceof Map){t=new Map;for(let[r,n]of e.entries())t.set(r,this._shallowClone(n))}return this._clonedCache.add(t),t}preferredThisArg(e,t,r,n){return e?(RG(n)?this._onIsChanged=GG[t]:n instanceof Set?this._onIsChanged=QG[t]:n instanceof Map&&(this._onIsChanged=eq[t]),n):r}update(e,t,r){let n=BG.after(e,this._path);if("length"!==t){let e=this.clone;BG.walk(n,(t=>{e&&e[t]&&(this._clonedCache.has(e[t])||(e[t]=this._shallowClone(e[t])),e=e[t])})),this._hasOnValidate&&this._changes.push({path:n,property:t,previous:r}),e&&e[t]&&(e[t]=r)}this._isChanged=!0}undo(e){let t;for(let r=this._changes.length-1;-1!==r;r--)t=this._changes[r],BG.get(e,t.path)[t.property]=t.previous}isChanged(e){return void 0===this._onIsChanged?this._isChanged:this._onIsChanged(this.clone,e)}},nq=class extends rq{static isHandledMethod(e){return qG.has(e)}},iq=class extends rq{undo(e){e.setTime(this.clone.getTime())}isChanged(e,t){return!t(this.clone.valueOf(),e.valueOf())}},sq=class extends rq{static isHandledMethod(e){return ZG.has(e)}undo(e){for(let t of this.clone)e.add(t);for(let t of e)this.clone.has(t)||e.delete(t)}},aq=class extends rq{static isHandledMethod(e){return tq.has(e)}undo(e){for(let[t,r]of this.clone.entries())e.set(t,r);for(let t of e.keys())this.clone.has(t)||e.delete(t)}},oq=class extends rq{constructor(e,t,r,n){super(void 0,t,r,n),this._arg1=r[0],this._weakValue=e.has(this._arg1)}isChanged(e){return this._weakValue!==e.has(this._arg1)}undo(e){this._weakValue&&!e.has(this._arg1)?e.add(this._arg1):e.delete(this._arg1)}},lq=class extends rq{constructor(e,t,r,n){super(void 0,t,r,n),this._weakKey=r[0],this._weakHas=e.has(this._weakKey),this._weakValue=e.get(this._weakKey)}isChanged(e){return this._weakValue!==e.get(this._weakKey)}undo(e){let t=e.has(this._weakKey);this._weakHas&&!t?e.set(this._weakKey,this._weakValue):!this._weakHas&&t?e.delete(this._weakKey):this._weakValue!==e.get(this._weakKey)&&e.set(this._weakKey,this._weakValue)}},cq=class{constructor(e){this._stack=[],this._hasOnValidate=e}static isHandledType(e){return jG(e)||RG(e)||OG(e)}static isHandledMethod(e,t){return jG(e)?rq.isHandledMethod(t):RG(e)?nq.isHandledMethod(t):e instanceof Set?sq.isHandledMethod(t):e instanceof Map?aq.isHandledMethod(t):OG(e)}get isCloning(){return this._stack.length>0}start(e,t,r){let n=rq;RG(e)?n=nq:e instanceof Date?n=iq:e instanceof Set?n=sq:e instanceof Map?n=aq:e instanceof WeakSet?n=oq:e instanceof WeakMap&&(n=lq),this._stack.push(new n(e,t,r,this._hasOnValidate))}update(e,t,r){this._stack[this._stack.length-1].update(e,t,r)}preferredThisArg(e,t,r){let{name:n}=e,i=cq.isHandledMethod(r,n);return this._stack[this._stack.length-1].preferredThisArg(i,n,t,r)}isChanged(e,t,r){return this._stack[this._stack.length-1].isChanged(e,t,r)}undo(e){void 0!==this._previousClone&&this._previousClone.undo(e)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},uq={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},hq=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r=u(u({},uq),r);let n=Symbol("ProxyTarget"),{equals:i,isShallow:s,ignoreDetached:a,details:o}=r,l=new FG(i),c="function"==typeof r.onValidate,h=new cq(c),d=(e,t,n,i,s)=>!c||h.isCloning||!0===r.onValidate(BG.concat(l.getPath(e),t),n,i,s),f=(t,n,i,s)=>{!zG(l,r,n)&&(!a||!l.isDetached(t,e))&&p(l.getPath(t),n,i,s)},p=(e,r,n,i,s)=>{h.isCloning?h.update(e,r,i):t(BG.concat(e,r),n,i,s)},m=e=>e&&(e[n]||e),g=(t,i,o,c)=>function(e){return("object"==typeof e?null===e:"function"!=typeof e)||e instanceof RegExp}(t)||"constructor"===o||s&&!cq.isHandledMethod(i,o)||zG(l,r,o)||l.isGetInvariant(i,o)||a&&l.isDetached(i,e)?t:(void 0===c&&(c=l.getPath(i)),l.getProxy(t,BG.concat(c,o),v,n)),v={get(e,t,r){if(LG(t)){if(t===n||t===DG)return e;if(t===IG&&!l.isUnsubscribed&&0===l.getPath(e).length)return l.unsubscribe(),e}let i=OG(e)?Reflect.get(e,t):Reflect.get(e,t,r);return g(i,e,t)},set(e,t,r,s){r=m(r);let a=e[n]||e,o=a[t];if(i(o,r)&&t in e)return!0;let c=d(e,t,r,o);return c&&l.setProperty(a,t,r,s,o)?(f(e,t,e[t],o),!0):!c},defineProperty(e,t,r){if(!l.isSameDescriptor(r,e,t)){let n=e[t];d(e,t,r.value,n)&&l.defineProperty(e,t,r,n)&&f(e,t,r.value,n)}return!0},deleteProperty(e,t){if(!Reflect.has(e,t))return!0;let r=Reflect.get(e,t),n=d(e,t,void 0,r);return n&&l.deleteProperty(e,t,r)?(f(e,t,void 0,r),!0):!n},apply(t,r,s){let a=r[n]||r;if(l.isUnsubscribed)return Reflect.apply(t,a,s);if((!1===o||!0!==o&&!o.includes(t.name))&&cq.isHandledType(a)){let n=BG.initial(l.getPath(t)),o=cq.isHandledMethod(a,t.name);h.start(a,n,s);let c=Reflect.apply(t,h.preferredThisArg(t,r,a),o?s.map((e=>m(e))):s),u=h.isChanged(a,i),f=h.stop();if(cq.isHandledType(c)&&o&&(r instanceof Map&&"get"===t.name&&(n=BG.concat(n,s[0])),c=l.getProxy(c,n,v)),u){let r={name:t.name,args:s,result:c},i=h.isCloning?BG.initial(n):n,o=h.isCloning?BG.last(n):"";d(BG.get(e,i),o,a,f,r)?p(i,o,a,f,r):h.undo(a)}return(r instanceof Map||r instanceof Set)&&function(e){return"object"==typeof e&&"function"==typeof e.next}(c)?function(e,t,r,n,i){let s=e.next;if("entries"===t.name)e.next=function(){let e=s.call(this);return!1===e.done&&(e.value[0]=i(e.value[0],t,e.value[0],n),e.value[1]=i(e.value[1],t,e.value[0],n)),e};else if("values"===t.name){let a=r[DG].keys();e.next=function(){let e=s.call(this);return!1===e.done&&(e.value=i(e.value,t,a.next().value,n)),e}}else e.next=function(){let e=s.call(this);return!1===e.done&&(e.value=i(e.value,t,e.value,n)),e};return e}(c,t,r,n,g):c}return Reflect.apply(t,r,s)}},y=l.getProxy(e,r.pathAsArray?[]:"",v);return t=t.bind(y),c&&(r.onValidate=r.onValidate.bind(y)),y};hq.target=e=>e&&e[DG]||e,hq.unsubscribe=e=>e[IG]||e;var dq=hq,fq="object"==typeof global&&global&&global.Object===Object&&global,pq="object"==typeof self&&self&&self.Object===Object&&self,mq=fq||pq||Function("return this")(),gq=mq.Symbol,vq=Object.prototype,yq=vq.hasOwnProperty,bq=vq.toString,wq=gq?gq.toStringTag:void 0;var xq=function(e){var t=yq.call(e,wq),r=e[wq];try{e[wq]=void 0;var n=!0}catch(s){}var i=bq.call(e);return n&&(t?e[wq]=r:delete e[wq]),i},Sq=Object.prototype.toString;var _q=function(e){return Sq.call(e)},Cq=gq?gq.toStringTag:void 0;var Eq=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Cq&&Cq in Object(e)?xq(e):_q(e)};var Aq=function(e){return null!=e&&"object"==typeof e};var Mq=function(e){return"symbol"==typeof e||Aq(e)&&"[object Symbol]"==Eq(e)};var Tq=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i},Pq=Array.isArray,kq=1/0,Dq=gq?gq.prototype:void 0,Iq=Dq?Dq.toString:void 0;var Oq=function e(t){if("string"==typeof t)return t;if(Pq(t))return Tq(t,e)+"";if(Mq(t))return Iq?Iq.call(t):"";var r=t+"";return"0"==r&&1/t==-kq?"-0":r},Rq=/\s/;var Lq=function(e){for(var t=e.length;t--&&Rq.test(e.charAt(t)););return t},Nq=/^\s+/;var Bq=function(e){return e&&e.slice(0,Lq(e)+1).replace(Nq,"")};var zq=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Fq=/^[-+]0x[0-9a-f]+$/i,jq=/^0b[01]+$/i,Uq=/^0o[0-7]+$/i,Vq=parseInt;var Hq=function(e){if("number"==typeof e)return e;if(Mq(e))return NaN;if(zq(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=zq(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Bq(e);var r=jq.test(e);return r||Uq.test(e)?Vq(e.slice(2),r?2:8):Fq.test(e)?NaN:+e};var Wq=function(e){return e};var Gq=function(e){if(!zq(e))return!1;var t=Eq(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},qq=mq["__core-js_shared__"],Xq=function(){var e=/[^.]+$/.exec(qq&&qq.keys&&qq.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var Yq=function(e){return!!Xq&&Xq in e},Kq=Function.prototype.toString;var Qq=function(e){if(null!=e){try{return Kq.call(e)}catch(t){}try{return e+""}catch(r){}}return""},Zq=/^\[object .+?Constructor\]$/,Jq=Function.prototype,$q=Object.prototype,eX=Jq.toString,tX=$q.hasOwnProperty,rX=RegExp("^"+eX.call(tX).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var nX=function(e){return!(!zq(e)||Yq(e))&&(Gq(e)?rX:Zq).test(Qq(e))};var iX=function(e,t){return null===e||void 0===e?void 0:e[t]};var sX=function(e,t){var r=iX(e,t);return nX(r)?r:void 0},aX=sX(mq,"WeakMap"),oX=Object.create,lX=function(){function e(){}return function(t){if(!zq(t))return{};if(oX)return oX(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),cX=lX;var uX=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)};var hX=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t},dX=Date.now;var fX=function(e){var t=0,r=0;return function(){var n=dX(),i=16-(n-r);if(r=n,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}};var pX=function(e){return function(){return e}},mX=function(){try{var e=sX(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),gX=mX,vX=gX?function(e,t){return gX(e,"toString",{configurable:!0,enumerable:!1,value:pX(t),writable:!0})}:Wq,yX=fX(vX);var bX=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e},wX=/^(?:0|[1-9]\d*)$/;var xX=function(e,t){var r,n=typeof e;return!!(t=null!==(r=t)&&void 0!==r?r:9007199254740991)&&("number"==n||"symbol"!=n&&wX.test(e))&&e>-1&&e%1==0&&e<t};var SX=function(e,t,r){"__proto__"==t&&gX?gX(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r};var _X=function(e,t){return e===t||e!==e&&t!==t},CX=Object.prototype.hasOwnProperty;var EX=function(e,t,r){var n=e[t];(!CX.call(e,t)||!_X(n,r)||void 0===r&&!(t in e))&&SX(e,t,r)};var AX=function(e,t,r,n){var i=!r;r||(r={});for(var s=-1,a=t.length;++s<a;){var o=t[s],l=n?n(r[o],e[o],o,r,e):void 0;void 0===l&&(l=e[o]),i?SX(r,o,l):EX(r,o,l)}return r},MX=Math.max;var TX=function(e,t,r){return t=MX(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,s=MX(n.length-t,0),a=Array(s);++i<s;)a[i]=n[t+i];i=-1;for(var o=Array(t+1);++i<t;)o[i]=n[i];return o[t]=r(a),uX(e,this,o)}};var PX=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var kX=function(e){return null!=e&&PX(e.length)&&!Gq(e)},DX=Object.prototype;var IX=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||DX)};var OX=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var RX=function(e){return Aq(e)&&"[object Arguments]"==Eq(e)},LX=Object.prototype,NX=LX.hasOwnProperty,BX=LX.propertyIsEnumerable,zX=RX(function(){return arguments}())?RX:function(e){return Aq(e)&&NX.call(e,"callee")&&!BX.call(e,"callee")},FX=zX;var jX=function(){return!1},UX="object"==typeof exports&&exports&&!exports.nodeType&&exports,VX=UX&&"object"==typeof module&&module&&!module.nodeType&&module,HX=VX&&VX.exports===UX?mq.Buffer:void 0,WX=(HX?HX.isBuffer:void 0)||jX,GX={};GX["[object Float32Array]"]=GX["[object Float64Array]"]=GX["[object Int8Array]"]=GX["[object Int16Array]"]=GX["[object Int32Array]"]=GX["[object Uint8Array]"]=GX["[object Uint8ClampedArray]"]=GX["[object Uint16Array]"]=GX["[object Uint32Array]"]=!0,GX["[object Arguments]"]=GX["[object Array]"]=GX["[object ArrayBuffer]"]=GX["[object Boolean]"]=GX["[object DataView]"]=GX["[object Date]"]=GX["[object Error]"]=GX["[object Function]"]=GX["[object Map]"]=GX["[object Number]"]=GX["[object Object]"]=GX["[object RegExp]"]=GX["[object Set]"]=GX["[object String]"]=GX["[object WeakMap]"]=!1;var qX=function(e){return Aq(e)&&PX(e.length)&&!!GX[Eq(e)]};var XX=function(e){return function(t){return e(t)}},YX="object"==typeof exports&&exports&&!exports.nodeType&&exports,KX=YX&&"object"==typeof module&&module&&!module.nodeType&&module,QX=KX&&KX.exports===YX&&fq.process,ZX=function(){try{return KX&&KX.require&&KX.require("util").types||QX&&QX.binding&&QX.binding("util")}catch(e){}}(),JX=ZX&&ZX.isTypedArray,$X=JX?XX(JX):qX,eY=Object.prototype.hasOwnProperty;var tY=function(e,t){var r=Pq(e),n=!r&&FX(e),i=!r&&!n&&WX(e),s=!r&&!n&&!i&&$X(e),a=r||n||i||s,o=a?OX(e.length,String):[],l=o.length;for(var c in e)(t||eY.call(e,c))&&(!a||!("length"==c||i&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||xX(c,l)))&&o.push(c);return o};var rY=function(e,t){return function(r){return e(t(r))}},nY=rY(Object.keys,Object),iY=Object.prototype.hasOwnProperty;var sY=function(e){if(!IX(e))return nY(e);var t=[];for(var r in Object(e))iY.call(e,r)&&"constructor"!=r&&t.push(r);return t};var aY=function(e){return kX(e)?tY(e):sY(e)};var oY=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},lY=Object.prototype.hasOwnProperty;var cY=function(e){if(!zq(e))return oY(e);var t=IX(e),r=[];for(var n in e)"constructor"==n&&(t||!lY.call(e,n))||r.push(n);return r};var uY=function(e){return kX(e)?tY(e,!0):cY(e)},hY=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,dY=/^\w*$/;var fY=function(e,t){if(Pq(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Mq(e))||(dY.test(e)||!hY.test(e)||null!=t&&e in Object(t))},pY=sX(Object,"create");var mY=function(){this.__data__=pY?pY(null):{},this.size=0};var gY=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},vY=Object.prototype.hasOwnProperty;var yY=function(e){var t=this.__data__;if(pY){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return vY.call(t,e)?t[e]:void 0},bY=Object.prototype.hasOwnProperty;var wY=function(e){var t=this.__data__;return pY?void 0!==t[e]:bY.call(t,e)};var xY=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=pY&&void 0===t?"__lodash_hash_undefined__":t,this};function SY(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}SY.prototype.clear=mY,SY.prototype.delete=gY,SY.prototype.get=yY,SY.prototype.has=wY,SY.prototype.set=xY;var _Y=SY;var CY=function(){this.__data__=[],this.size=0};var EY=function(e,t){for(var r=e.length;r--;)if(_X(e[r][0],t))return r;return-1},AY=Array.prototype.splice;var MY=function(e){var t=this.__data__,r=EY(t,e);return!(r<0)&&(r==t.length-1?t.pop():AY.call(t,r,1),--this.size,!0)};var TY=function(e){var t=this.__data__,r=EY(t,e);return r<0?void 0:t[r][1]};var PY=function(e){return EY(this.__data__,e)>-1};var kY=function(e,t){var r=this.__data__,n=EY(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function DY(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}DY.prototype.clear=CY,DY.prototype.delete=MY,DY.prototype.get=TY,DY.prototype.has=PY,DY.prototype.set=kY;var IY=DY,OY=sX(mq,"Map");var RY=function(){this.size=0,this.__data__={hash:new _Y,map:new(OY||IY),string:new _Y}};var LY=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var NY=function(e,t){var r=e.__data__;return LY(t)?r["string"==typeof t?"string":"hash"]:r.map};var BY=function(e){var t=NY(this,e).delete(e);return this.size-=t?1:0,t};var zY=function(e){return NY(this,e).get(e)};var FY=function(e){return NY(this,e).has(e)};var jY=function(e,t){var r=NY(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function UY(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}UY.prototype.clear=RY,UY.prototype.delete=BY,UY.prototype.get=zY,UY.prototype.has=FY,UY.prototype.set=jY;var VY=UY;function HY(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var a=e.apply(this,n);return r.cache=s.set(i,a)||s,a};return r.cache=new(HY.Cache||VY),r}HY.Cache=VY;var WY=HY;var GY=function(e){var t=WY(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t},qY=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,XY=/\\(\\)?/g,YY=GY((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(qY,(function(e,r,n,i){t.push(n?i.replace(XY,"$1"):r||e)})),t})),KY=YY;var QY=function(e){return null==e?"":Oq(e)};var ZY=function(e,t){return Pq(e)?e:fY(e,t)?[e]:KY(QY(e))},JY=1/0;var $Y=function(e){if("string"==typeof e||Mq(e))return e;var t=e+"";return"0"==t&&1/e==-JY?"-0":t};var eK=function(e,t){for(var r=0,n=(t=ZY(t,e)).length;null!=e&&r<n;)e=e[$Y(t[r++])];return r&&r==n?e:void 0};var tK=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e},rK=gq?gq.isConcatSpreadable:void 0;var nK=function(e){return Pq(e)||FX(e)||!!(rK&&e&&e[rK])};var iK=function e(t,r,n,i,s){var a=-1,o=t.length;for(n||(n=nK),s||(s=[]);++a<o;){var l=t[a];r>0&&n(l)?r>1?e(l,r-1,n,i,s):tK(s,l):i||(s[s.length]=l)}return s};var sK=function(e){return(null==e?0:e.length)?iK(e,1):[]};var aK=function(e){return yX(TX(e,void 0,sK),e+"")},oK=rY(Object.getPrototypeOf,Object),lK=Function.prototype,cK=Object.prototype,uK=lK.toString,hK=cK.hasOwnProperty,dK=uK.call(Object);var fK=function(e){if(!Aq(e)||"[object Object]"!=Eq(e))return!1;var t=oK(e);if(null===t)return!0;var r=hK.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&uK.call(r)==dK};var pK=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(i);++n<i;)s[n]=e[n+t];return s};var mK=function(){this.__data__=new IY,this.size=0};var gK=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var vK=function(e){return this.__data__.get(e)};var yK=function(e){return this.__data__.has(e)};var bK=function(e,t){var r=this.__data__;if(r instanceof IY){var n=r.__data__;if(!OY||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new VY(n)}return r.set(e,t),this.size=r.size,this};function wK(e){var t=this.__data__=new IY(e);this.size=t.size}wK.prototype.clear=mK,wK.prototype.delete=gK,wK.prototype.get=vK,wK.prototype.has=yK,wK.prototype.set=bK;var xK=wK;var SK=function(e,t){return e&&AX(t,aY(t),e)};var _K=function(e,t){return e&&AX(t,uY(t),e)},CK="object"==typeof exports&&exports&&!exports.nodeType&&exports,EK=CK&&"object"==typeof module&&module&&!module.nodeType&&module,AK=EK&&EK.exports===CK?mq.Buffer:void 0,MK=AK?AK.allocUnsafe:void 0;var TK=function(e,t){if(t)return e.slice();var r=e.length,n=MK?MK(r):new e.constructor(r);return e.copy(n),n};var PK=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,s=[];++r<n;){var a=e[r];t(a,r,e)&&(s[i++]=a)}return s};var kK=function(){return[]},DK=Object.prototype.propertyIsEnumerable,IK=Object.getOwnPropertySymbols,OK=IK?function(e){return null==e?[]:(e=Object(e),PK(IK(e),(function(t){return DK.call(e,t)})))}:kK,RK=OK;var LK=function(e,t){return AX(e,RK(e),t)},NK=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)tK(t,RK(e)),e=oK(e);return t}:kK,BK=NK;var zK=function(e,t){return AX(e,BK(e),t)};var FK=function(e,t,r){var n=t(e);return Pq(e)?n:tK(n,r(e))};var jK=function(e){return FK(e,aY,RK)};var UK=function(e){return FK(e,uY,BK)},VK=sX(mq,"DataView"),HK=sX(mq,"Promise"),WK=sX(mq,"Set"),GK="[object Map]",qK="[object Promise]",XK="[object Set]",YK="[object WeakMap]",KK="[object DataView]",QK=Qq(VK),ZK=Qq(OY),JK=Qq(HK),$K=Qq(WK),eQ=Qq(aX),tQ=Eq;(VK&&tQ(new VK(new ArrayBuffer(1)))!=KK||OY&&tQ(new OY)!=GK||HK&&tQ(HK.resolve())!=qK||WK&&tQ(new WK)!=XK||aX&&tQ(new aX)!=YK)&&(tQ=function(e){var t=Eq(e),r="[object Object]"==t?e.constructor:void 0,n=r?Qq(r):"";if(n)switch(n){case QK:return KK;case ZK:return GK;case JK:return qK;case $K:return XK;case eQ:return YK}return t});var rQ=tQ,nQ=Object.prototype.hasOwnProperty;var iQ=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&nQ.call(e,"index")&&(r.index=e.index,r.input=e.input),r},sQ=mq.Uint8Array;var aQ=function(e){var t=new e.constructor(e.byteLength);return new sQ(t).set(new sQ(e)),t};var oQ=function(e,t){var r=t?aQ(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)},lQ=/\w*$/;var cQ=function(e){var t=new e.constructor(e.source,lQ.exec(e));return t.lastIndex=e.lastIndex,t},uQ=gq?gq.prototype:void 0,hQ=uQ?uQ.valueOf:void 0;var dQ=function(e){return hQ?Object(hQ.call(e)):{}};var fQ=function(e,t){var r=t?aQ(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)};var pQ=function(e,t,r){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return aQ(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return oQ(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return fQ(e,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return cQ(e);case"[object Symbol]":return dQ(e)}};var mQ=function(e){return"function"!=typeof e.constructor||IX(e)?{}:cX(oK(e))};var gQ=function(e){return Aq(e)&&"[object Map]"==rQ(e)},vQ=ZX&&ZX.isMap,yQ=vQ?XX(vQ):gQ;var bQ=function(e){return Aq(e)&&"[object Set]"==rQ(e)},wQ=ZX&&ZX.isSet,xQ=wQ?XX(wQ):bQ,SQ="[object Arguments]",_Q="[object Function]",CQ="[object Object]",EQ={};EQ[SQ]=EQ["[object Array]"]=EQ["[object ArrayBuffer]"]=EQ["[object DataView]"]=EQ["[object Boolean]"]=EQ["[object Date]"]=EQ["[object Float32Array]"]=EQ["[object Float64Array]"]=EQ["[object Int8Array]"]=EQ["[object Int16Array]"]=EQ["[object Int32Array]"]=EQ["[object Map]"]=EQ["[object Number]"]=EQ[CQ]=EQ["[object RegExp]"]=EQ["[object Set]"]=EQ["[object String]"]=EQ["[object Symbol]"]=EQ["[object Uint8Array]"]=EQ["[object Uint8ClampedArray]"]=EQ["[object Uint16Array]"]=EQ["[object Uint32Array]"]=!0,EQ["[object Error]"]=EQ[_Q]=EQ["[object WeakMap]"]=!1;var AQ=function e(t,r,n,i,s,a){var o,l=1&r,c=2&r,u=4&r;if(n&&(o=s?n(t,i,s,a):n(t)),void 0!==o)return o;if(!zq(t))return t;var h=Pq(t);if(h){if(o=iQ(t),!l)return hX(t,o)}else{var d=rQ(t),f=d==_Q||"[object GeneratorFunction]"==d;if(WX(t))return TK(t,l);if(d==CQ||d==SQ||f&&!s){if(o=c||f?{}:mQ(t),!l)return c?zK(t,_K(o,t)):LK(t,SK(o,t))}else{if(!EQ[d])return s?t:{};o=pQ(t,d,l)}}a||(a=new xK);var p=a.get(t);if(p)return p;a.set(t,o),xQ(t)?t.forEach((function(i){o.add(e(i,r,n,i,t,a))})):yQ(t)&&t.forEach((function(i,s){o.set(s,e(i,r,n,s,t,a))}));var m=h?void 0:(u?c?UK:jK:c?uY:aY)(t);return bX(m||t,(function(i,s){m&&(i=t[s=i]),EX(o,s,e(i,r,n,s,t,a))})),o};var MQ=function(e){return AQ(e,5)};var TQ=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var PQ=function(e){return this.__data__.has(e)};function kQ(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new VY;++t<r;)this.add(e[t])}kQ.prototype.add=kQ.prototype.push=TQ,kQ.prototype.has=PQ;var DQ=kQ;var IQ=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var OQ=function(e,t){return e.has(t)};var RQ=function(e,t,r,n,i,s){var a=1&r,o=e.length,l=t.length;if(o!=l&&!(a&&l>o))return!1;var c=s.get(e),u=s.get(t);if(c&&u)return c==t&&u==e;var h=-1,d=!0,f=2&r?new DQ:void 0;for(s.set(e,t),s.set(t,e);++h<o;){var p=e[h],m=t[h];if(n)var g=a?n(m,p,h,t,e,s):n(p,m,h,e,t,s);if(void 0!==g){if(g)continue;d=!1;break}if(f){if(!IQ(t,(function(e,t){if(!OQ(f,t)&&(p===e||i(p,e,r,n,s)))return f.push(t)}))){d=!1;break}}else if(p!==m&&!i(p,m,r,n,s)){d=!1;break}}return s.delete(e),s.delete(t),d};var LQ=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r};var NQ=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r},BQ=gq?gq.prototype:void 0,zQ=BQ?BQ.valueOf:void 0;var FQ=function(e,t,r,n,i,s,a){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!s(new sQ(e),new sQ(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return _X(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var o=LQ;case"[object Set]":var l=1&n;if(o||(o=NQ),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;n|=2,a.set(e,t);var u=RQ(o(e),o(t),n,i,s,a);return a.delete(e),u;case"[object Symbol]":if(zQ)return zQ.call(e)==zQ.call(t)}return!1},jQ=Object.prototype.hasOwnProperty;var UQ=function(e,t,r,n,i,s){var a=1&r,o=jK(e),l=o.length;if(l!=jK(t).length&&!a)return!1;for(var c=l;c--;){var u=o[c];if(!(a?u in t:jQ.call(t,u)))return!1}var h=s.get(e),d=s.get(t);if(h&&d)return h==t&&d==e;var f=!0;s.set(e,t),s.set(t,e);for(var p=a;++c<l;){var m=e[u=o[c]],g=t[u];if(n)var v=a?n(g,m,u,t,e,s):n(m,g,u,e,t,s);if(!(void 0===v?m===g||i(m,g,r,n,s):v)){f=!1;break}p||(p="constructor"==u)}if(f&&!p){var y=e.constructor,b=t.constructor;y!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(f=!1)}return s.delete(e),s.delete(t),f},VQ="[object Arguments]",HQ="[object Array]",WQ="[object Object]",GQ=Object.prototype.hasOwnProperty;var qQ=function(e,t,r,n,i,s){var a=Pq(e),o=Pq(t),l=a?HQ:rQ(e),c=o?HQ:rQ(t),u=(l=l==VQ?WQ:l)==WQ,h=(c=c==VQ?WQ:c)==WQ,d=l==c;if(d&&WX(e)){if(!WX(t))return!1;a=!0,u=!1}if(d&&!u)return s||(s=new xK),a||$X(e)?RQ(e,t,r,n,i,s):FQ(e,t,l,r,n,i,s);if(!(1&r)){var f=u&&GQ.call(e,"__wrapped__"),p=h&&GQ.call(t,"__wrapped__");if(f||p){var m=f?e.value():e,g=p?t.value():t;return s||(s=new xK),i(m,g,r,n,s)}}return!!d&&(s||(s=new xK),UQ(e,t,r,n,i,s))};var XQ=function e(t,r,n,i,s){return t===r||(null==t||null==r||!Aq(t)&&!Aq(r)?t!==t&&r!==r:qQ(t,r,n,i,e,s))};var YQ=function(e,t){return null!=e&&t in Object(e)};var KQ=function(e,t,r){for(var n=-1,i=(t=ZY(t,e)).length,s=!1;++n<i;){var a=$Y(t[n]);if(!(s=null!=e&&r(e,a)))break;e=e[a]}return s||++n!=i?s:!!(i=null==e?0:e.length)&&PX(i)&&xX(a,i)&&(Pq(e)||FX(e))};var QQ=function(e,t){return null!=e&&KQ(e,t,YQ)},ZQ=function(){return mq.Date.now()},JQ=Math.max,$Q=Math.min;var eZ=function(e,t,r){var n,i,s,a,o,l,c=0,u=!1,h=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var r=n,s=i;return n=i=void 0,c=t,a=e.apply(s,r)}function p(e){var r=e-l;return void 0===l||r>=t||r<0||h&&e-c>=s}function m(){var e=ZQ();if(p(e))return g(e);o=setTimeout(m,function(e){var r=t-(e-l);return h?$Q(r,s-(e-c)):r}(e))}function g(e){return o=void 0,d&&n?f(e):(n=i=void 0,a)}function v(){var e=ZQ(),r=p(e);if(n=arguments,i=this,l=e,r){if(void 0===o)return function(e){return c=e,o=setTimeout(m,t),u?f(e):a}(l);if(h)return clearTimeout(o),o=setTimeout(m,t),f(l)}return void 0===o&&(o=setTimeout(m,t)),a}return t=Hq(t)||0,zq(r)&&(u=!!r.leading,s=(h="maxWait"in r)?JQ(Hq(r.maxWait)||0,t):s,d="trailing"in r?!!r.trailing:d),v.cancel=function(){void 0!==o&&clearTimeout(o),c=0,n=l=i=o=void 0},v.flush=function(){return void 0===o?a:g(ZQ())},v};var tZ=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};var rZ=function(e,t){return e>t};var nZ=function(e,t){return t.length<2?e:eK(e,pK(t,0,-1))};var iZ=function(e,t){return XQ(e,t)};var sZ=function(e,t,r){for(var n=-1,i=e.length;++n<i;){var s=e[n],a=t(s);if(null!=a&&(void 0===o?a===a&&!Mq(a):r(a,o)))var o=a,l=s}return l};var aZ=function(e){return e&&e.length?sZ(e,Wq,rZ):void 0};var oZ=function(e,t){return t=ZY(t,e),null==(e=nZ(e,t))||delete e[$Y(tZ(t))]};var lZ=function(e){return fK(e)?void 0:e},cZ=aK((function(e,t){var r={};if(null==e)return r;var n=!1;t=Tq(t,(function(t){return t=ZY(t,e),n||(n=t.length>1),t})),AX(e,UK(e),r),n&&(r=AQ(r,7,lZ));for(var i=t.length;i--;)oZ(r,t[i]);return r})),uZ=cZ;var hZ=function(e,t,r,n){if(!zq(e))return e;for(var i=-1,s=(t=ZY(t,e)).length,a=s-1,o=e;null!=o&&++i<s;){var l=$Y(t[i]),c=r;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(i!=a){var u=o[l];void 0===(c=n?n(u,l,o):void 0)&&(c=zq(u)?u:xX(t[i+1])?[]:{})}EX(o,l,c),o=o[l]}return e};var dZ=function(e,t,r){for(var n=-1,i=t.length,s={};++n<i;){var a=t[n],o=eK(e,a);r(o,a)&&hZ(s,ZY(a,e),o)}return s};var fZ=function(e,t){return dZ(e,t,(function(t,r){return QQ(e,r)}))},pZ=aK((function(e,t){return null==e?{}:fZ(e,t)})),mZ=pZ;var gZ=function(e,t,r){var n=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return zq(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),eZ(e,t,{leading:n,maxWait:t,trailing:i})};function vZ(e){for(let t of Object.keys(e))void 0===e[t]&&delete e[t];return e}function yZ(e,t){return Object.setPrototypeOf(e,t),e}var bZ=!(typeof window>"u")&&window.navigator.userAgent.toLowerCase().includes(" electron/"),wZ=(bZ&&(()=>{var e;if(typeof window>"u")return;let t=new URLSearchParams(window.location.search).get("desktop-app-version");t?window.localStorage.setItem("desktop-app-version",t):e=window.localStorage.getItem("desktop-app-version")})(),!(typeof window>"u")&&window.navigator.platform.toUpperCase().includes("MAC")),xZ=!(typeof window>"u")&&(/iPad|iPhone|iPod/.test(window.navigator.userAgent)||wZ&&"ontouchend"in document),SZ=!(typeof window>"u")&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,_Z=!(typeof window>"u")&&("ontouchstart"in window||navigator.maxTouchPoints>0),CZ=(()=>{if(typeof window>"u")return!1;let e=navigator.userAgent,t=navigator.vendor;return/Safari/i.test(e)&&/Apple Computer/.test(t)})(),EZ=Number((()=>{if(typeof window>"u")return null;let e=navigator.userAgent.match(/Version\/(\d+\.\d)/);return e&&e[1]})());function AZ(e){return Array.isArray(e)?e:[e]}function MZ(e,t){let r=0;for(;r<e.length&&r<t.length;){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1;r+=1}return r!==t.length?-1:r!==e.length?1:0}function TZ(e){return wZ?e.metaKey:e.ctrlKey}var PZ=[],kZ={},DZ={},IZ={};function OZ(e){PZ.includes(e)||PZ.push(e)}function RZ(e){delete kZ[e.pointerId];for(let t=0;t<PZ.length;t++)if(PZ[t].pointerId===e.pointerId){PZ.splice(t,1);break}}function LZ(e){if("touch"!==e.pointerType)return;let t=kZ[e.pointerId];void 0===t&&(t={x:0,y:0},kZ[e.pointerId]=t),t.x=e.pageX,t.y=e.pageY}function NZ(e){let t=e.pointerId===PZ[0].pointerId?PZ[1]:PZ[0];return kZ[t.pointerId]}function BZ(e){DZ[e.key]=!0,IZ[e.key]=void 0===IZ[e.key]?1:IZ[e.key]+1}function zZ(e){if(wZ&&DZ.Meta)for(let t in DZ)DZ[t]=!1;else DZ[e.key]=!1;IZ={}}var FZ,jZ,UZ=new Promise((e=>{FZ=e}));function VZ(){if(jZ)return jZ;return jZ=async function(){let e=r.e(208).then(r.bind(r,208)),[t,n]=await Promise.all([e,fetch("".concat("https://unpkg.com/@splinetool/navmesh-wasm@1.9.59/build","/navmesh.wasm")).then((e=>e.arrayBuffer()))]),i=t.default,s=await i({wasmBinary:n});FZ(s)}()}var HZ,WZ,GZ=new Promise((e=>{HZ=e}));function qZ(){if(WZ)return WZ;return WZ=async function(){let e=await r.e(293).then(r.bind(r,293));await e.init(),HZ(e)}()}var XZ=class{modifyById(e,t){let r=this;if(void 0===r[e])throw new Error("not expected");{let n=u(u({},r),{},{[e]:t});return Object.setPrototypeOf(n,XZ.prototype),n}}add(e,t){var r,n;return null!==(r=null===(n=this.runOp({type:1,id:e,data:t}))||void 0===n?void 0:n.data)&&void 0!==r?r:this}runOp(e){let t=this;if(1===e.type){let r,n=t[e.id];r=void 0===n?{type:2,id:e.id}:{type:1,id:e.id,data:n};let{id:i,data:s}=e,a=u(u({},t),{},{[i]:s});return Object.setPrototypeOf(a,XZ.prototype),{data:a,actual:e,reverse:r}}if(2===e.type){let{id:r}=e,n=t[r];if(void 0===n)return null;{let i=u({},t);return Object.setPrototypeOf(i,XZ.prototype),delete i[r],{data:i,actual:e,reverse:{type:1,id:r,data:n}}}}return null}};function YZ(e){if(void 0!==e.deepFreeze)return void e.deepFreeze(e);let t=Object.getOwnPropertyNames(e);for(let r of t){let t=e[r];t&&"object"==typeof t&&YZ(t)}return Object.freeze(e)}var KZ=class extends Error{};function QZ(e){let t=u({},e);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}function ZZ(e,t,r){if(void 0===e?void 0===t?(e=0,t=10):e=t-10:void 0===t&&(t=e+10),e>t){let r=e;e=t,t=r}let n=[],i=1/(r+1);for(let s=0;s<r;s++){let r=e+(t-e)*(s+.75+.5*Math.random())*i;n.push(r)}return n}function JZ(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array}function $Z(e,t){for(let r of e)!0!==t(r.id,r.data)&&$Z(r.children,t)}function eJ(e,t){if(!0!==t(e.id,e.data))for(let r of e.children)eJ(r,t)}var tJ,rJ=class extends Array{constructor(){super(...arguments),Object.setPrototypeOf(this,rJ.prototype)}deepFreeze(){let e=0;for(;e<this.length;)YZ(this[e]),e++}fillCaches0(e,t){this.objCaches.set(e.id,e),this.parentCaches.set(e.id,t);for(let r of e.children)this.fillCaches0(r,e.id)}fillCaches(){if(void 0===this.objCaches){this.objCaches=new Map,this.parentCaches=new Map;for(let e of this)this.fillCaches0(e,null)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(0!==e.length)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}nonExistOrDescendantOf(e,t){if(!this.has(e))return!0;for(;e;){let r=this.parent(e);if(r===t)return!0;e=r}return!1}rootAcestor(e){for(;e;){let t=this.parent(e);if(!t)return e;e=t}return e}isDescendantOf(e,t){for(;e;){let r=this.parent(e);if(r===t)return!0;e=r}return!1}data(e){var t;return null===(t=this.get(e))||void 0===t?void 0:t.data}has(e){return void 0!==this.childrenOf(e)}get(e){return this.fillCaches(),this.objCaches.get(e)}childrenOf(e){var t;return null===e?this:null===(t=this.get(e))||void 0===t?void 0:t.children}traverseFrom(e,t){if(null===e)this.traverse(t);else{let r=this.get(e);r&&eJ(r,t)}}traverse(e){$Z(this,e)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(e){return this.fillCaches(),this.parentCaches.get(e)}childrenArray(e){return null===e?this:this.get(e).children}modifyById(e,t){if(void 0===this.get(e))throw new Error("not expected");{let r=this.parent(e),n=this.childrenArray(r),i=n.findIndex((t=>t.id===e));if(i<0)throw new Error("not expected");let s=n[i];return n=[...n],n[i]=u(u({},s),{},{data:t}),this.modifyArrayBy(r,n)}}modifyArrayBy(e,t){let r=e,n=t;for(;null!==r;){let e=n,t=r;if(r=this.parent(r),void 0===r)throw new Error;n=this.childrenArray(r);let i=n.findIndex((e=>e.id===t));if(i<0)throw new Error;n=[...n],n[i]=u(u({},n[i]),{},{children:e})}Object.setPrototypeOf(n,rJ.prototype);let i=n;return i.fillCaches(),i}runOp(e){switch(e.type){case 7:return this.addOp(e);case 8:return this.deleteOp(e);case 9:return this.moveOp(e)}return null}checkDuplicatedIdRec(e){let{id:t,children:r}=e;if(void 0!==this.get(t))return!0;for(let n of r)if(this.checkDuplicatedIdRec(n))return!0;return!1}addOp(e){let{parent:t,fi:r,id:n,data:i,children:s}=e;if(null!==t&&void 0===this.get(t))return null;if(this.checkDuplicatedIdRec(e))return null;{let a=t,o=this.childrenArray(a),l={fi:r,id:n,data:i,children:s};return o=[...o,l],o.sort(((e,t)=>e.fi-t.fi)),e.localIndex=o.indexOf(l),{data:this.modifyArrayBy(a,o),actual:e,reverse:{type:8,id:n}}}}deleteOp(e){let{id:t}=e;if(null===this.get(t))return null;{let r=this.parent(t);if(void 0===r)return null;let n=this.childrenArray(r),i=n.findIndex((e=>e.id===t));e.localIndex=i,n=[...n];let s=n.splice(i,1)[0];return{data:this.modifyArrayBy(r,n),actual:e,reverse:u(u({type:7},s),{},{parent:r})}}}moveOp(e){let{parent:t,fi:r,id:n}=e;if(null!==t&&void 0===this.get(t))return this.deleteOp({type:8,id:n});if(null!==t){let e=t;for(;null!==e;){if(void 0===e)throw new Error;if(e===n)throw new KZ("cyclic tree");e=this.parent(e)}}let i=this.parent(n);if(void 0===i)return null;let s=i,a=this.childrenArray(i),o=a.findIndex((e=>e.id===n));a=[...a];let l=a.splice(o,1)[0],c=this.modifyArrayBy(i,a);i=t,a=c.childrenArray(i);let h=l.fi;return l=u(u({},l),{},{fi:r}),a=[...a,l],a.sort(((e,t)=>e.fi-t.fi)),e.localIndex=a.indexOf(l),c=c.modifyArrayBy(i,a),{data:c,actual:e,reverse:{type:9,parent:s,fi:h,id:n}}}previous(e,t){if(null===t){let t=this.childrenArray(e);return 0===t.length?null:t[t.length-1].id}let r=null;for(let n of this.childrenArray(e)){if(n.id===t)return r;r=n.id}return null}traverseSortNext(e){let t=this.parent(e);if(void 0!==t){let r=this.childrenArray(t),n=r.findIndex((t=>t.id===e))+1;if(n<r.length)return r[n].id;if(t)return this.traverseSortNext(t)}}sortNext(e){let t=this.childrenArray(e);return t.length>0?t[0].id:this.traverseSortNext(e)}traverseSortPrevious(e){let t=this.childrenArray(e);return t.length>0?this.traverseSortPrevious(t[t.length-1].id):e}sortPrevious(e){let t=this.parent(e);if(void 0!==t){let r=this.childrenArray(t),n=r.findIndex((t=>t.id===e))-1;return n>=0?this.traverseSortPrevious(r[n].id):t}}getAllSorted(e){let t=[];for(let r of e){let e=this.getWithSortKey(r.id);void 0!==e&&t.push(u(u({},r),e))}t.sort(((e,t)=>function(e,t){let r=0;for(;r<e.length&&r<t.length;){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1;r+=1}return r!==t.length?-1:r!==e.length?1:0}(e.sortKey,t.sortKey)));for(let r of t)delete r.sortKey;return t}getWithSortKey(e){var t=e;let r=[],n=this.get(t),i=n;if(void 0!==n){for(;t;)r.splice(0,0,n.fi),null!==(t=this.parent(t))&&(n=this.get(t));return u(u({},i),{},{sortKey:r})}}insertBeforeHelper(e,t,r){return this.insertAfterHelper(e,this.previous(e,t),r)}insertAfterHelper(e,t,r){let n=this.childrenArray(e);if(null===t){if(0===n.length)return ZZ(0,r,r);{let e=n[0].fi;return ZZ(e-r,e,r)}}{let i=this.get(t);if(void 0===i||this.parent(t)!==e)throw new Error("illegal args");let s=n.find((e=>e.fi>i.fi));if(void 0===s){let e=n[n.length-1].fi;return ZZ(e,e+r,r)}return ZZ(i.fi,s.fi,r)}}};(tJ||(tJ={})).runOp=function(e,t){if(0!==t.type)return null;if(Array.isArray(e)){let r=t.props,n={},i=[...e],s=!1;if(r)for(let e of Object.keys(r)){let t=parseInt(e);if(isNaN(t))throw new Error("wrong index");n[e]=i[t],i[t]=r[e],s=!0}return s?{data:i,actual:t,reverse:{type:0,props:n}}:null}{let r=t.props,n={},i=u({},e),s=!1;if(r)for(let e of Object.keys(r)){n[e]=i[e];let t=r[e];void 0===t?delete i[e]:i[e]=t,s=!0}return s?{data:i,actual:t,reverse:{type:0,props:n}}:null}};var nJ=class extends Array{constructor(){super(...arguments),Object.setPrototypeOf(this,nJ.prototype)}deepFreeze(){let e=0;for(;e<this.length;)YZ(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(void 0===this.objCaches){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(0!==e.length)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){var t;return null===(t=this.get(e))||void 0===t?void 0:t.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,t){if(void 0===this.get(e))throw new Error("not expected");{let r=this,n=r.findIndex((t=>t.id===e));if(n<0)throw new Error("not expected");let i=r[n];return r=[...r],r[n]=u(u({},i),{},{data:t}),this.modifyArrayBy(r)}}modifyArrayBy(e){Object.setPrototypeOf(e,nJ.prototype);let t=e;return typeof process<"u"||t.fillCaches(),t}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}return null}addOp(e){let{fi:t,id:r,data:n}=e,i=this,s={fi:t,id:r,data:n};return i=[...i,s],i.sort(((e,t)=>e.fi-t.fi)),e.localIndex=i.indexOf(s),{data:this.modifyArrayBy(i),actual:e,reverse:{type:5,id:r}}}deleteOp(e){let{id:t}=e,r=this,n=r.findIndex((e=>e.id===t));if(-1===n)return null;e.localIndex=n,r=[...r];let i=r.splice(n,1)[0];return{data:this.modifyArrayBy(r),actual:e,reverse:u({type:4},i)}}moveOp(e){let{fi:t,id:r}=e,n=this;n=[...n];let i=n.findIndex((e=>e.id===r));if(-1===i)return null;let s=n[i].fi,a=u(u({},n[i]),{},{fi:t});return n[i]=a,n.sort(((e,t)=>e.fi-t.fi)),e.localIndex=n.indexOf(a),{data:this.modifyArrayBy(n),actual:e,reverse:{type:6,fi:s,id:r}}}previous(e){if(null===e)return 0===this.length?null:this[this.length-1].id;let t=null;for(let r of this){if(r.id===e)return t;t=r.id}return null}insertBeforeHelper(e,t){return this.insertAfterHelper(this.previous(e),t)}insertAfterHelper(e,t){let r=this;if(null===e){if(0===r.length)return ZZ(0,t,t);{let e=r[0].fi;return ZZ(e-t,e,t)}}{let n=this.get(e);if(void 0===n)throw new Error("illegal args");let i=r.find((e=>e.fi>n.fi));if(void 0===i){let e=r[r.length-1].fi;return ZZ(e,e+t,t)}return ZZ(n.fi,i.fi,t)}}};function iJ(e){return e&&"object"==typeof e&&e instanceof cJ}var sJ,aJ,oJ,lJ,cJ=class{unusedFunOverridesTable(e){}runOp(e){let t=[],r=this,n=0,i={};for(;n<e.path.length;){if(t.push(r),r=void 0===r?void 0:r[e.path[n]],void 0!==r&&!iJ(r))return null;n+=1}r=r?QZ(r):new cJ;for(let[s,a]of Object.entries(e.props)){let e=r[s];i[s]=e,void 0===a?delete r[s]:r[s]=a}for(;n>0;){if(0===Object.keys(r).length){let i=t[n-1];i&&(r=QZ(i),delete r[e.path[n-1]])}else{let i=t[n-1];if(i){let t=QZ(i);t[e.path[n-1]]=r,r=t}else{let t=new cJ;t[e.path[n-1]]=r,r=t}}n-=1}return{data:Object.setPrototypeOf(r,cJ.prototype),actual:e,reverse:u(u({},e),{},{props:i})}}};function uJ(e,t){if(void 0===t)return;let r=!1,n=e.map((e=>{let n=e.id,i=hJ(e.data,t[n]);if(r=r||void 0!==i,void 0===i&&(i=e.data),e.children){let s=uJ(e.children,t);return void 0!==s?r=!0:s=e.children,u(u({},e),{},{id:n,data:i,children:s})}return u(u({},e),{},{id:n,data:i})}));return r?n:void 0}function hJ(e,t){if(!iJ(t))return t;if(e instanceof rJ){let r=uJ(e,t);return void 0!==r&&Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r}if(e instanceof nJ)return function(e,t){if(void 0===t)return;let r=!1,n=e.map((e=>{let n=e.id,i=hJ(e.data,t[n]);return r=r||void 0!==i,void 0===i&&(i=e.data),u(u({},e),{},{id:n,data:i})}));return r?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}(e,t);if(Array.isArray(e)){let r=!1,n=e.map(((e,n)=>{let i=hJ(e,t[n]);return r=r||void 0!==i,void 0===i&&(i=e),i}));return r?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}if(e instanceof cJ)return dJ(e,t);if(e&&"object"==typeof e){let r={},n=!1;for(let[i,s]of Object.entries(e)){let e=hJ(s,t[i]);n=n||void 0!==e,void 0===e&&(e=s),r[i]=e}return n?(Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r):void 0}}function dJ(e,t){if(void 0===e)return t;if(void 0===t)return e;if(!iJ(t))return t;if(!iJ(e))return sJ.apply(e,t);let r=new Set;for(let i of Object.keys(e))r.add(i);for(let i of Object.keys(t))r.add(i);let n=new cJ;for(let i of r){let r=dJ(void 0===e?void 0:e[i],void 0===t?void 0:t[i]);n[i]=r}return n}function fJ(e,t){var r;let n={cur:[],result:[],len:0};return[e=null!==(r=vJ(e,t,n))&&void 0!==r?r:e,n.result]}function pJ(e,t){return null===e?null:(e.cur[e.len]=t,e.len+=1,e)}function mJ(e){e&&(e.len-=1)}function gJ(e,t,r){let n=!1,i=e.map((e=>{let i=e.id,s=t[i];if(void 0!==s&&"string"==typeof s&&(n=!0,i=s,null!==r))throw new Error("not supported");let a=vJ(e.data,t,pJ(r,i));mJ(r),n=n||void 0!==a,void 0===a&&(a=e.data);let o=gJ(e.children,t,r);return void 0!==o?n=!0:o=e.children,u(u({},e),{},{id:i,data:a,children:o})}));if(n)return i}function vJ(e,t,r){if(e instanceof rJ){let n=gJ(e,t,r);return void 0!==n&&Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}if(e instanceof nJ)return function(e,t,r){let n=!1,i=e.map((e=>{let i=e.id,s=t[i];if(void 0!==s&&"string"==typeof s&&(n=!0,i=s,null!==r))throw new Error("not supported");let a=vJ(e.data,t,pJ(r,i));return mJ(r),n=n||void 0!==a,void 0===a&&(a=e.data),u(u({},e),{},{id:i,data:a})}));if(n)return Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}(e,t,r);if(Array.isArray(e)){let n=!1,i=e.map(((e,i)=>{let s=vJ(e,t,pJ(r,i));return mJ(r),n=n||void 0!==s,void 0===s&&(s=e),s}));return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}if(e&&"object"==typeof e&&!JZ(e)){let n={},i=!1;for(let[s,a]of Object.entries(e))if("name"!==s&&"variableId"!==s){let e=t[s];if("string"==typeof e){if(null!==r)throw new Error("not supported");i=!0,s=e}let o=vJ(a,t,pJ(r,s));mJ(r),i=i||void 0!==o,void 0===o&&(o=a),n[s]=o}else n[s]=a;return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}if("string"==typeof e){let n=t[e];return void 0!==n&&function(e){if(null===e)return null;e.result.push(e.cur.slice(0,e.len))}(r),n}}(e=>{e.apply=function(e,t){var r;return null!==(r=hJ(e,t))&&void 0!==r?r:e},e.merge=function(e,t){return dJ(e,t)},e.filterOp=function(e,t){let r=0,n=t.path,i=e;for(;r<n.length&&void 0!==i;){if(i=kJ.zoomOnce(i,n[r]),void 0===i)return t;if(!iJ(i))return;r+=1}if(void 0===i)return t;if(iJ(i)){if(0===t.type){let e=u({},t.props);for(let t of Object.keys(i))delete e[t];return u(u({},t),{},{props:e})}if(1===t.type||4===t.type||7===t.type){let e=uJ([t],i);return e?(console.log(e),e):t}return t}}})(sJ||(sJ={})),(e=>{e.replaceProps=function(e,t){let r=kJ.zoom(t,e.path);if("object"==typeof r){let t={};for(let n of Object.keys(e.props))t[n]=r[n];return u(u({},e),{},{props:t})}return u(u({},e),{},{props:{}})}})(aJ||(aJ={})),(e=>{function t(e,t){let r=t.path;for(var n=[];;){let a;if(e instanceof cJ&&0===t.type&&(a=e.runOp(u(u({},t),{},{path:r.slice(n.length)})),null===a&&(a=void 0)),void 0===a&&n.length===r.length&&(a=e instanceof rJ||e instanceof nJ||e instanceof XZ?e.runOp(t):tJ.runOp(e,t)),void 0!==a){if(null!==a){let e=a.data;for(let t=n.length-1;t>=0;t--){let i=r[t],s=n[t];if(s instanceof rJ){if("number"==typeof i)throw new Error("illegal arg");e=s.modifyById(i,e)}else if(s instanceof nJ){if("number"==typeof i)throw new Error("illegal arg");e=s.modifyById(i,e)}else if(s instanceof XZ){if("number"==typeof i)throw new Error("illegal arg");e=s.modifyById(i,e)}else if(s instanceof cJ){let t=u(u({},s),{},{[i]:e});e=Object.setPrototypeOf(t,cJ.prototype)}else{if("object"!=typeof s)return null;if(Array.isArray(s)){if("string"==typeof i&&(i=parseInt(i),isNaN(i)))throw new Error("Invalid path");let t=e;e=[...s],e[i]=t}else e=u(u({},s),{},{[i]:e})}}return{data:e,actual:u(u({},a.actual),{},{path:r}),reverse:u(u({},a.reverse),{},{path:r})}}return null}let o,l=r[n.length];if(e instanceof rJ){var i;if("number"==typeof l)throw new Error("");o=null===(i=e.get(l))||void 0===i?void 0:i.data}else if(e instanceof nJ){var s;if("number"==typeof l)throw new Error("");o=null===(s=e.get(l))||void 0===s?void 0:s.data}else null!==e&&(o=e[l]);if(void 0===o)return null;n.push(e),e=o}}function r(e,t){for(let r=0;r<e.length&&r<t.length;r++)if(e[r]!==t[r])return!0;return!1}function n(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}e.drop=function(e,t){return u(u({},e),{},{path:e.path.slice(t)})},e.applySimple=function(e,r){var n,i;return null!==(n=null===(i=t(e,r))||void 0===i?void 0:i.data)&&void 0!==n?n:e},e.apply=t,e.pathDisjoint=r,e.pathEq=n,e.commutative=function(e,t){return r(e.path,t.path)},e.subsumed=function(e,t){return!(0!==e.type||0!==t.type||!n(e.path,t.path))&&Object.keys(e.props).every((e=>void 0!==t.props[e]))}})(oJ||(oJ={})),(e=>{function t(e,t){var r=e;let n=[],i=[];for(let a of t)try{if(3===a.type||5===a.type&&"variables"===a.path[a.path.length-1]){let e,t,s;if(3===a.type?(e=kJ.zoom(r,[...a.path,a.id]),s=oJ.apply(r,u(u({},a),{},{type:2}))):(e=kJ.zoom(r,[...a.path,a.id,"value"]),s=oJ.apply(r,a)),null!==s){r=s.data;let[o,l]=fJ(r,{[a.id]:e});r=o;for(let s=0;s<l.length;s++){let o=l[s],c=o.pop();if("number"==typeof c){let n=[c];for(let e=s+1;e<l.length;e++){let t=l[e],r=t[t.length-1];if("number"!=typeof r||!kJ.equal(o,t.slice(0,t.length-1)))break;n.push(r),l.splice(e,1)}let i=kJ.zoom(r,o);t=i.map(((e,t)=>n.includes(t)?a.id:e)),e=i,c=o.pop()}else{if("alphaOverride"===c||"alpha"===c){e/=100;let t=e,n=kJ.zoom(r,o.slice(0,o.length-2)),i=n.layers.map((e=>e.id===o[o.length-1]?u(u({},e),{},{data:u(u({},e.data),{},{[c]:t})}):e));Object.setPrototypeOf(i,Object.getPrototypeOf(n.layers)),n.layers=i}t=a.id}n.push({type:0,path:o,props:{[c]:e}}),i.push({type:0,path:o,props:{[c]:t}})}i.push(s.reverse),n.push(s.actual)}}else{let e=oJ.apply(r,a);null!==e&&(n.push(e.actual),r=e.data,i.push(e.reverse))}}catch(s){if(s instanceof KZ)return null;throw s}return{data:r,actual:n,reverse:i.reverse()}}e.empty=function(){return[]},e.removePrefix=function(e,t){let r=[];for(let n of e){let[e,...i]=n.path;e===t&&r.push(u(u({},n),{},{path:i}))}return r},e.addPrefix=function(e,t){return e.map((e=>u(u({},e),{},{path:[t,...e.path]})))},e.concat=function(e,t){return[...e,...t]},e.compress=function(e,t){return[...e.filter((e=>!t.some((t=>oJ.subsumed(e,t))))),...t]},e.commutative=function(e,t){return e.every((e=>t.every((t=>oJ.commutative(e,t)))))},e.applyAll=function(e,r){for(let n of r){let r=t(e,n);null!==r&&(e=r.data)}return e},e.apply=t})(lJ||(lJ={}));var yJ=Symbol(),bJ=Symbol(),wJ=Symbol(),xJ=class{reportOp(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=this;if(null===t)return;n._current=t.data;let i=r;for(;!(n instanceof DJ);){let e=n._path,t=n._current;if(""!==e&&i.splice(0,0,e),n=n._parent,null===n)return;n.update(e,t)}n.push(i,e,t.actual,t.reverse)}deleteChildren(e){if(this._children){let t=this._children[e];if(t){let r=t[wJ];r&&r(),delete this._children[e]}}}},SJ=class extends xJ{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){if(Array.isArray(this._current)){if("string"==typeof e&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid path");this._current=[...this._current],this._current[e]=t}else this._current=u(u({},this._current),{},{[e]:t})}runOp(e){this.reportOp(e,tJ.runOp(this._current,e),e.path)}},_J=class extends xJ{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){this._current=u(u({},this._current),{},{[e]:t}),Object.setPrototypeOf(this._current,XZ.prototype)}runOp(e){this.reportOp(e,this._current.runOp(e))}},CJ={get(e,t){if(t===wJ)return()=>{e._parent=null};if(t===yJ)return e._current;if(t===bJ)return e;let{_current:r,_children:n}=e;if("push"===t&&Array.isArray(r))throw new Error("not supported to expand array");let i=void 0===n?void 0:n[t];if(void 0!==i)return i;let s=r[t],a=IJ(e,t,s);return a!==s?(void 0===n&&(n={},e._children=n),n[t]=a,a):s},has:(e,t)=>t in e._current,ownKeys:e=>Reflect.ownKeys(e._current),defineProperty(){throw Error("not supported")},getPrototypeOf:e=>Object.getPrototypeOf(e._current),setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(e,t){let r=e._current,n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:!0,enumerable:n.enumerable,value:r[t]}}},EJ=u(u({},CJ),{},{set(e,t,r){var n;let i={type:0,props:{[t]:null!==(n=LJ(r))&&void 0!==n?n:r}};return e.deleteChildren(t),e.runOp(i),!0},deleteProperty(e,t){let r={type:0,props:{[t]:void 0}};return e.deleteChildren(t),e.runOp(r),!0}}),AJ=u(u({},CJ),{},{set(e,t,r){return void 0===r?this.deleteProperty(e,t):(e.deleteChildren(t),e.runOp({type:1,id:t,data:r})),!0},deleteProperty:(e,t)=>(e.runOp({type:2,id:t}),!0)}),MJ=class extends xJ{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[wJ]=()=>{this._parent=null}}unproxy(){return this._current}update(e,t){this._current=this._current.modifyById(e,t)}runOp(e){this.reportOp(e,this._current.runOp(e))}randomId(){return this._current.randomId()}isDescendantOf(e,t){return this._current.isDescendantOf(e,t)}childrenOf(e){return this._current.childrenOf(e)}traverse(e){return this._current.traverse(e)}get(e){return this._current.get(e)}parent(e){return this._current.parent(e)}traverse(e){this._current.traverse(((t,r)=>{e(t,this.data(t))}))}data(e){var t;let{_current:r,_children:n}=this,i=void 0===n?void 0:n[e];if(void 0!==i)return i;let s=null===(t=r.get(e))||void 0===t?void 0:t.data,a=IJ(this,e,s);return a!==s?(void 0===n&&(n={},this._children=n),n[e]=a,a):s}add(e,t,r,n,i){this.runOp({type:7,parent:e,fi:t,id:r,data:n,children:i})}move(e,t,r){this.runOp({type:9,parent:e,fi:t,id:r})}insertAfter(e,t,r){let n=this._current.insertAfterHelper(e,t,r.length);for(let i=0;i<r.length;i++){let t=r[i];this.add(e,n[i],t.id,t.data,t.children)}}insertBefore(e,t,r){let n=this._current.insertBeforeHelper(e,t,r.length);for(let i=0;i<r.length;i++){let t=r[i];this.add(e,n[i],t.id,t.data,t.children)}}moveAfter(e,t,r){let n=this._current.insertAfterHelper(e,t,r.length);for(let i=0;i<r.length;i++){let t=r[i];this.move(e,n[i],t)}}moveBefore(e,t,r){let n=this._current.insertBeforeHelper(e,t,r.length);for(let i=0;i<r.length;i++){let t=r[i];this.move(e,n[i],t)}}delete(e){this.deleteChildren(e),this.runOp({type:8,id:e})}sortNext(e){return this._current.sortNext(e)}sortPrevious(e){return this._current.sortPrevious(e)}getAllSorted(e){return this._current.getAllSorted(e)}},TJ=class extends xJ{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[wJ]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(e){let t=this.length;for(let r=0;r<t;r++){let t=this._current[r].id,n=this._current[r].fi;e(this.data(this._current[r].id),t,n)}}find(e){let t=this.length;for(let r=0;r<t;r++){let t=this._current[r].id;if(e(this.data(t),t))return this.get(t)}}update(e,t){this._current=this._current.modifyById(e,t)}randomId(){return this._current.randomId()}get(e){return u(u({},this._current.get(e)),{},{data:this.data(e)})}data(e){var t;let{_current:r,_children:n}=this,i=void 0===n?void 0:n[e];if(void 0!==i)return i;let s=null===(t=r.get(e))||void 0===t?void 0:t.data,a=IJ(this,e,s);return a!==s?(void 0===n&&(n={},this._children=n),n[e]=a,a):s}runOp(e){this.reportOp(e,this._current.runOp(e))}add(e,t,r){this.runOp({type:4,fi:e,id:t,data:r})}move(e,t){this.runOp({type:6,fi:e,id:t})}insertAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let n=0;n<t.length;n++){let e=t[n];this.add(r[n],e.id,e.data)}}insertBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let n=0;n<t.length;n++){let e=t[n];this.add(r[n],e.id,e.data)}}moveAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let n=0;n<t.length;n++){let e=t[n];this.move(r[n],e)}}moveBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let n=0;n<t.length;n++){let e=t[n];this.move(r[n],e)}}delete(e){this.deleteChildren(e),this.runOp({type:5,id:e})}};function PJ(e,t,r){if(e.length>0){let n=e[e.length-1];if(0===n.type&&0===t.type&&kJ.equal(n.path,r))return void Object.assign(n.props,t.props)}e.push(u(u({},t),{},{path:r}))}var kJ,DJ=class extends xJ{constructor(e){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=e}update(e,t){if(""!==e)throw new Error("");this._current=t}push(e,t,r,n){PJ(this.ts,t,e),PJ(this.actual,r,e),PJ(this.reverse,n,e)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function IJ(e,t,r){return r instanceof rJ?new MJ(e,t,r):r instanceof nJ?new TJ(e,t,r):r instanceof XZ?new Proxy(new _J(e,t,r),AJ):null!==r&&"object"==typeof r?JZ(r)?r:new Proxy(new SJ(e,t,r),EJ):r}function OJ(e){let t=new DJ(e);return[IJ(t,"",e),t]}function RJ(e,t){let[r,n]=OJ(e);return t(r),n.result()}function LJ(e){return e instanceof MJ||e instanceof TJ?e._current:null!==e&&"object"==typeof e?e[yJ]:e}function NJ(e,t){let r=[];if(!(t.length<=e.length))return null;for(var n=0;n<t.length;){if("*"===t[n])r.push(e[n]);else if(e[n]!==t[n])return null;n+=1}return r}(e=>{function t(e,t){return(e instanceof rJ||e instanceof MJ)&&"string"==typeof t||(e instanceof nJ||e instanceof TJ)&&"string"==typeof t?e.data(t):"number"==typeof t&&Array.isArray(e)||"string"==typeof t&&"object"==typeof e&&null!==e?e[t]:void 0}function r(e,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(;n<r.length&&void 0!==e;)e=t(e,r[n]),n+=1;return e}e.equal=function(e,t){if(t.length!==e.length)return!1;for(var r=0;r<e.length;){if(e[r]!==t[r])return!1;r+=1}return!0},e.removeOverridden=function(e,t,n){let i=r(n,e);if(void 0!==i&&"object"==typeof i&&null!==i){let e=u({},t);return Object.keys(i).forEach((t=>{delete e[t]})),e}return t},e.zoomOnce=t,e.zoom=r})(kJ||(kJ={}));var BJ,zJ=class{},FJ=class extends zJ{constructor(e){super(),this.id=e}},jJ=class extends zJ{constructor(e){super(),this.data=e}};try{BJ=new TextDecoder}catch(Cme){}var UJ,VJ,HJ,WJ,GJ,qJ,XJ,YJ=0,KJ=[],QJ=KJ,ZJ=0,JJ={},$J=0,e$=0,t$=[],r$={useRecords:!1,mapsAsObjects:!0},n$=class{},i$=new n$;i$.name="MessagePack 0xC1";var s$=!1,a$=class{constructor(e){e&&(!1===e.useRecords&&void 0===e.mapsAsObjects&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,t){if(UJ)return D$((()=>(I$(),this?this.unpack(e,t):a$.prototype.unpack.call(r$,e,t))));VJ=t>-1?t:e.length,YJ=0,ZJ=0,e$=0,WJ=null,QJ=KJ,GJ=null,UJ=e;try{XJ=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(ca){throw UJ=null,e instanceof Uint8Array?ca:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&"object"==typeof e?e.constructor.name:typeof e))}if(this instanceof a$){if(JJ=this,this.structures)return HJ=this.structures,o$();(!HJ||HJ.length>0)&&(HJ=[])}else JJ=r$,(!HJ||HJ.length>0)&&(HJ=[]);return o$()}unpackMultiple(e,t){let r,n=0;try{s$=!0;let i=e.length,s=this?this.unpack(e,i):L$.unpack(e,i);if(!t){for(r=[s];YJ<i;)n=YJ,r.push(o$());return r}for(t(s);YJ<i;)if(n=YJ,!1===t(o$()))return}catch(Q0){throw Q0.lastPosition=n,Q0.values=r,Q0}finally{s$=!1,I$()}}_mergeStructures(e,t){for(let r=0,n=(e=e||[]).length;r<n;r++){let t=e[r];t&&(t.isShared=!0,r>=32&&(t.highByte=r-32>>5))}e.sharedLength=e.length;for(let r in t||[])if(r>=0){let n=e[r],i=t[r];i&&(n&&((e.restoreStructures||(e.restoreStructures=[]))[r]=n),e[r]=i)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function o$(){try{if(!JJ.trusted&&!s$){let e=HJ.sharedLength||0;e<HJ.length&&(HJ.length=e)}let e=c$();if(YJ==VJ)HJ.restoreStructures&&l$(),HJ=null,UJ=null,qJ&&(qJ=null);else{if(YJ>VJ){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}if(!s$)throw new Error("Data read, but end of buffer not reached")}return e}catch(Q5){throw HJ.restoreStructures&&l$(),I$(),(Q5 instanceof RangeError||Q5.message.startsWith("Unexpected end of buffer"))&&(Q5.incomplete=!0),Q5}}function l$(){for(let e in HJ.restoreStructures)HJ[e]=HJ.restoreStructures[e];HJ.restoreStructures=null}function c$(){let e=UJ[YJ++];if(e<160){if(e<128){if(e<64)return e;{let t=HJ[63&e]||JJ.getStructures&&f$()[63&e];return t?(t.read||(t.read=h$(t,63&e)),t.read()):e}}if(e<144){if(e-=128,JJ.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[M$()]=c$();return t}{let t=new Map;for(let r=0;r<e;r++)t.set(c$(),c$());return t}}{e-=144;let t=new Array(e);for(let r=0;r<e;r++)t[r]=c$();return t}}if(e<192){let t=e-160;if(e$>=YJ)return WJ.slice(YJ-$J,(YJ+=t)-$J);if(0==e$&&VJ<140){let e=t<16?_$(t):S$(t);if(null!=e)return e}return p$(t)}{let t;switch(e){case 192:return null;case 193:return GJ?(t=c$(),t>0?GJ[1].slice(GJ.position1,GJ.position1+=t):GJ[0].slice(GJ.position0,GJ.position0-=t)):i$;case 194:return!1;case 195:return!0;case 196:return C$(UJ[YJ++]);case 197:return t=XJ.getUint16(YJ),YJ+=2,C$(t);case 198:return t=XJ.getUint32(YJ),YJ+=4,C$(t);case 199:return E$(UJ[YJ++]);case 200:return t=XJ.getUint16(YJ),YJ+=2,E$(t);case 201:return t=XJ.getUint32(YJ),YJ+=4,E$(t);case 202:if(t=XJ.getFloat32(YJ),JJ.useFloat32>2){let e=O$[(127&UJ[YJ])<<1|UJ[YJ+1]>>7];return YJ+=4,(e*t+(t>0?.5:-.5)|0)/e}return YJ+=4,t;case 203:return t=XJ.getFloat64(YJ),YJ+=8,t;case 204:return UJ[YJ++];case 205:return t=XJ.getUint16(YJ),YJ+=2,t;case 206:return t=XJ.getUint32(YJ),YJ+=4,t;case 207:return JJ.int64AsNumber?(t=4294967296*XJ.getUint32(YJ),t+=XJ.getUint32(YJ+4)):t=XJ.getBigUint64(YJ),YJ+=8,t;case 208:return XJ.getInt8(YJ++);case 209:return t=XJ.getInt16(YJ),YJ+=2,t;case 210:return t=XJ.getInt32(YJ),YJ+=4,t;case 211:return JJ.int64AsNumber?(t=4294967296*XJ.getInt32(YJ),t+=XJ.getUint32(YJ+4)):t=XJ.getBigInt64(YJ),YJ+=8,t;case 212:if(t=UJ[YJ++],114==t)return T$(63&UJ[YJ++]);{let e=t$[t];if(e)return e.read?(YJ++,e.read(c$())):e.noBuffer?(YJ++,e()):e(UJ.subarray(YJ,++YJ));throw new Error("Unknown extension "+t)}case 213:return t=UJ[YJ],114==t?(YJ++,T$(63&UJ[YJ++],UJ[YJ++])):E$(2);case 214:return E$(4);case 215:return E$(8);case 216:return E$(16);case 217:return t=UJ[YJ++],e$>=YJ?WJ.slice(YJ-$J,(YJ+=t)-$J):m$(t);case 218:return t=XJ.getUint16(YJ),e$>=(YJ+=2)?WJ.slice(YJ-$J,(YJ+=t)-$J):g$(t);case 219:return t=XJ.getUint32(YJ),e$>=(YJ+=4)?WJ.slice(YJ-$J,(YJ+=t)-$J):v$(t);case 220:return t=XJ.getUint16(YJ),YJ+=2,b$(t);case 221:return t=XJ.getUint32(YJ),YJ+=4,b$(t);case 222:return t=XJ.getUint16(YJ),YJ+=2,w$(t);case 223:return t=XJ.getUint32(YJ),YJ+=4,w$(t);default:if(e>=224)return e-256;if(void 0===e){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}throw new Error("Unknown MessagePack token "+e)}}}var u$=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function h$(e,t){function r(){if(r.count++>2){let r=e.read=new Function("r","return function(){return {"+e.map((e=>u$.test(e)?e+":r()":"["+JSON.stringify(e)+"]:r()")).join(",")+"}}")(c$);return 0===e.highByte&&(e.read=d$(t,e.read)),r()}let n={};for(let t=0,r=e.length;t<r;t++){n[e[t]]=c$()}return n}return r.count=0,0===e.highByte?d$(t,r):r}var d$=(e,t)=>function(){let r=UJ[YJ++];if(0===r)return t();let n=e<32?-(e+(r<<5)):e+(r<<5),i=HJ[n]||f$()[n];if(!i)throw new Error("Record id is not defined for "+n);return i.read||(i.read=h$(i,e)),i.read()};function f$(){let e=D$((()=>(UJ=null,JJ.getStructures())));return HJ=JJ._mergeStructures(e,HJ)}var p$=y$,m$=y$,g$=y$,v$=y$;function y$(e){let t;if(e<16&&(t=_$(e)))return t;if(e>64&&BJ)return BJ.decode(UJ.subarray(YJ,YJ+=e));let r=YJ+e,n=[];for(t="";YJ<r;){let e=UJ[YJ++];if(0===(128&e))n.push(e);else if(192===(224&e)){let t=63&UJ[YJ++];n.push((31&e)<<6|t)}else if(224===(240&e)){let t=63&UJ[YJ++],r=63&UJ[YJ++];n.push((31&e)<<12|t<<6|r)}else if(240===(248&e)){let t=(7&e)<<18|(63&UJ[YJ++])<<12|(63&UJ[YJ++])<<6|63&UJ[YJ++];t>65535&&(t-=65536,n.push(t>>>10&1023|55296),t=56320|1023&t),n.push(t)}else n.push(e);n.length>=4096&&(t+=x$.apply(String,n),n.length=0)}return n.length>0&&(t+=x$.apply(String,n)),t}function b$(e){let t=new Array(e);for(let r=0;r<e;r++)t[r]=c$();return t}function w$(e){if(JJ.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[M$()]=c$();return t}{let t=new Map;for(let r=0;r<e;r++)t.set(c$(),c$());return t}}var x$=String.fromCharCode;function S$(e){let t=YJ,r=new Array(e);for(let n=0;n<e;n++){let e=UJ[YJ++];if((128&e)>0)return void(YJ=t);r[n]=e}return x$.apply(String,r)}function _$(e){if(e<4){if(e<2){if(0===e)return"";{let e=UJ[YJ++];return(128&e)>1?void(YJ-=1):x$(e)}}{let t=UJ[YJ++],r=UJ[YJ++];if((128&t)>0||(128&r)>0)return void(YJ-=2);if(e<3)return x$(t,r);let n=UJ[YJ++];return(128&n)>0?void(YJ-=3):x$(t,r,n)}}{let t=UJ[YJ++],r=UJ[YJ++],n=UJ[YJ++],i=UJ[YJ++];if((128&t)>0||(128&r)>0||(128&n)>0||(128&i)>0)return void(YJ-=4);if(e<6){if(4===e)return x$(t,r,n,i);{let e=UJ[YJ++];return(128&e)>0?void(YJ-=5):x$(t,r,n,i,e)}}if(e<8){let s=UJ[YJ++],a=UJ[YJ++];if((128&s)>0||(128&a)>0)return void(YJ-=6);if(e<7)return x$(t,r,n,i,s,a);let o=UJ[YJ++];return(128&o)>0?void(YJ-=7):x$(t,r,n,i,s,a,o)}{let s=UJ[YJ++],a=UJ[YJ++],o=UJ[YJ++],l=UJ[YJ++];if((128&s)>0||(128&a)>0||(128&o)>0||(128&l)>0)return void(YJ-=8);if(e<10){if(8===e)return x$(t,r,n,i,s,a,o,l);{let e=UJ[YJ++];return(128&e)>0?void(YJ-=9):x$(t,r,n,i,s,a,o,l,e)}}if(e<12){let c=UJ[YJ++],u=UJ[YJ++];if((128&c)>0||(128&u)>0)return void(YJ-=10);if(e<11)return x$(t,r,n,i,s,a,o,l,c,u);let h=UJ[YJ++];return(128&h)>0?void(YJ-=11):x$(t,r,n,i,s,a,o,l,c,u,h)}{let c=UJ[YJ++],u=UJ[YJ++],h=UJ[YJ++],d=UJ[YJ++];if((128&c)>0||(128&u)>0||(128&h)>0||(128&d)>0)return void(YJ-=12);if(e<14){if(12===e)return x$(t,r,n,i,s,a,o,l,c,u,h,d);{let e=UJ[YJ++];return(128&e)>0?void(YJ-=13):x$(t,r,n,i,s,a,o,l,c,u,h,d,e)}}{let f=UJ[YJ++],p=UJ[YJ++];if((128&f)>0||(128&p)>0)return void(YJ-=14);if(e<15)return x$(t,r,n,i,s,a,o,l,c,u,h,d,f,p);let m=UJ[YJ++];return(128&m)>0?void(YJ-=15):x$(t,r,n,i,s,a,o,l,c,u,h,d,f,p,m)}}}}}function C$(e){return JJ.copyBuffers?Uint8Array.prototype.slice.call(UJ,YJ,YJ+=e):UJ.subarray(YJ,YJ+=e)}function E$(e){let t=UJ[YJ++];if(t$[t])return t$[t](UJ.subarray(YJ,YJ+=e));throw new Error("Unknown extension type "+t)}var A$=new Array(4096);function M$(){let e=UJ[YJ++];if(!(e>=160&&e<192))return YJ--,c$();if(e-=160,e$>=YJ)return WJ.slice(YJ-$J,(YJ+=e)-$J);if(!(0==e$&&VJ<180))return p$(e);let t,r=4095&(e<<5^(e>1?XJ.getUint16(YJ):e>0?UJ[YJ]:0)),n=A$[r],i=YJ,s=YJ+e-3,a=0;if(n&&n.bytes==e){for(;i<s;){if(t=XJ.getUint32(i),t!=n[a++]){i=1879048192;break}i+=4}for(s+=3;i<s;)if(t=UJ[i++],t!=n[a++]){i=1879048192;break}if(i===s)return YJ=i,n.string;s-=3,i=YJ}for(n=[],A$[r]=n,n.bytes=e;i<s;)t=XJ.getUint32(i),n.push(t),i+=4;for(s+=3;i<s;)t=UJ[i++],n.push(t);let o=e<16?_$(e):S$(e);return n.string=null!=o?o:p$(e)}var T$=(e,t)=>{var r=c$();let n=e;void 0!==t&&(e=e<32?-((t<<5)+e):(t<<5)+e,r.highByte=t);let i=HJ[e];return i&&i.isShared&&((HJ.restoreStructures||(HJ.restoreStructures=[]))[e]=i),HJ[e]=r,r.read=h$(r,n),r.read()},P$="object"==typeof self?self:global;t$[0]=()=>{},t$[0].noBuffer=!0,t$[101]=()=>{let e=c$();return(P$[e[0]]||Error)(e[1])},t$[105]=e=>{let t=XJ.getUint32(YJ-4);qJ||(qJ=new Map);let r,n=UJ[YJ];r=n>=144&&n<160||220==n||221==n?[]:{};let i={target:r};qJ.set(t,i);let s=c$();return i.used?Object.assign(r,s):(i.target=s,s)},t$[112]=e=>{let t=XJ.getUint32(YJ-4),r=qJ.get(t);return r.used=!0,r.target},t$[115]=()=>new Set(c$());var k$=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map((e=>e+"Array"));function D$(e){let t=VJ,r=YJ,n=ZJ,i=$J,s=e$,a=WJ,o=QJ,l=qJ,c=GJ,u=new Uint8Array(UJ.slice(0,VJ)),h=HJ,d=HJ.slice(0,HJ.length),f=JJ,p=s$,m=e();return VJ=t,YJ=r,ZJ=n,$J=i,e$=s,WJ=a,QJ=o,qJ=l,GJ=c,UJ=u,s$=p,(HJ=h).splice(0,HJ.length,...d),JJ=f,XJ=new DataView(UJ.buffer,UJ.byteOffset,UJ.byteLength),m}function I$(){UJ=null,qJ=null,HJ=null}t$[116]=e=>{let t=e[0],r=k$[t];if(!r)throw new Error("Could not find typed array for code "+t);return new P$[r](Uint8Array.prototype.slice.call(e,1).buffer)},t$[120]=()=>{let e=c$();return new RegExp(e[0],e[1])},t$[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],r=YJ;YJ+=t-4,(GJ=[c$(),c$()]).position0=0,GJ.position1=0;let n=YJ;YJ=r;try{return c$()}finally{YJ=n}},t$[255]=e=>4==e.length?new Date(1e3*(16777216*e[0]+(e[1]<<16)+(e[2]<<8)+e[3])):8==e.length?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+1e3*(4294967296*(3&e[3])+16777216*e[4]+(e[5]<<16)+(e[6]<<8)+e[7])):12==e.length?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+1e3*((128&e[4]?-281474976710656:0)+1099511627776*e[6]+4294967296*e[7]+16777216*e[8]+(e[9]<<16)+(e[10]<<8)+e[11])):new Date("invalid");var O$=new Array(147);for(let r=0;r<256;r++)O$[r]=+("1e"+Math.floor(45.15-.30103*r));var R$,L$=new a$({useRecords:!1}),N$=(L$.unpack,L$.unpackMultiple,L$.unpack,new Float32Array(1));new Uint8Array(N$.buffer,0,4);try{R$=new TextEncoder}catch(Eme){}var B$,z$,F$,j$,U$,V$=typeof Buffer<"u",H$=V$?Buffer.allocUnsafeSlow:Uint8Array,W$=V$?Buffer:Uint8Array,G$=V$?4294967296:2144337920,q$=0,X$=null,Y$=/[\u0080-\uFFFF]/,K$=Symbol("record-id"),Q$=class extends a${constructor(e){super(e),this.offset=0;let t,r,n,i,s,a=0,o=W$.prototype.utf8Write?function(e,t,r){return F$.utf8Write(e,t,r)}:!(!R$||!R$.encodeInto)&&function(e,t){return R$.encodeInto(e,F$.subarray(t)).written},l=this;e||(e={});let c=e&&e.sequential,u=e.structures||e.saveStructures,h=e.maxSharedStructures;if(null==h&&(h=u?32:0),h>8160)throw new Error("Maximum maxSharedStructure is 8160");let d=e.maxOwnStructures;null==d&&(d=u?32:64),c&&!e.saveStructures&&(this.structures=[]);let f=h>32||d+h>64,p=h+64,m=h+d+64;if(m>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],v=0,y=0;this.pack=this.encode=function(e,o){if(F$||(F$=new H$(8192),j$=new DataView(F$.buffer,0,8192),q$=0),(U$=F$.length-10)-q$<2048?(F$=new H$(F$.length),j$=new DataView(F$.buffer,0,F$.length),U$=F$.length-10,q$=0):q$=q$+7&2147483640,t=q$,s=l.structuredClone?new Map:null,l.bundleStrings?(X$=["",""],F$[q$++]=214,F$[q$++]=98,X$.position=q$-t,q$+=4):X$=null,r=l.structures,r){r.uninitialized&&(r=l._mergeStructures(l.getStructures()));let e=r.sharedLength||0;if(e>h)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+r.sharedLength);if(!r.transitions){r.transitions=Object.create(null);for(let t=0;t<e;t++){let e=r[t];if(!e)continue;let n,i=r.transitions;for(let t=0,r=e.length;t<r;t++){let r=e[t];n=i[r],n||(n=i[r]=Object.create(null)),i=n}i[K$]=t+64}a=e}c||(r.nextId=e+64)}n&&(n=!1),i=r||[];try{if(b(e),X$){j$.setUint32(X$.position+t,q$-X$.position-t);let e=X$;X$=null,b(e[0]),b(e[1])}if(l.offset=q$,s&&s.idsToInsert){(q$+=6*s.idsToInsert.length)>U$&&x(q$),l.offset=q$;let e=function(e,t){let r,n=6*t.length,i=e.length-n;for(t.sort(((e,t)=>e.offset>t.offset?1:-1));r=t.pop();){let t=r.offset,s=r.id;e.copyWithin(t+n,t,i),n-=6;let a=t+n;e[a++]=214,e[a++]=105,e[a++]=s>>24,e[a++]=s>>16&255,e[a++]=s>>8&255,e[a++]=255&s,i=t}return e}(F$.subarray(t,q$),s.idsToInsert);return s=null,e}return o&c0?(F$.start=t,F$.end=q$,F$):F$.subarray(t,q$)}finally{if(r){if(y<10&&y++,v>1e4)r.transitions=null,y=0,v=0,g.length>0&&(g=[]);else if(g.length>0&&!c){for(let e=0,t=g.length;e<t;e++)g[e][K$]=0;g=[]}if(n&&l.saveStructures){let n=r.sharedLength||h;r.length>n&&(r=r.slice(0,n));let i=F$.subarray(t,q$);return!1===l.saveStructures(r,a)?(l._mergeStructures(l.getStructures()),l.pack(e)):(a=n,i)}}o&u0&&(q$=t)}};let b=e=>{q$>U$&&(F$=x(q$));var r,n=typeof e;if("string"===n){let t,n=e.length;if(X$&&n>=8&&n<4096){let t=Y$.test(e);return X$[t?0:1]+=e,F$[q$++]=193,void b(t?-n:n)}t=n<32?1:n<256?2:n<65536?3:5;let i=3*n;if(q$+i>U$&&(F$=x(q$+i)),n<64||!o){let i,s,a,o=q$+t;for(i=0;i<n;i++)s=e.charCodeAt(i),s<128?F$[o++]=s:s<2048?(F$[o++]=s>>6|192,F$[o++]=63&s|128):55296===(64512&s)&&56320===(64512&(a=e.charCodeAt(i+1)))?(s=65536+((1023&s)<<10)+(1023&a),i++,F$[o++]=s>>18|240,F$[o++]=s>>12&63|128,F$[o++]=s>>6&63|128,F$[o++]=63&s|128):(F$[o++]=s>>12|224,F$[o++]=s>>6&63|128,F$[o++]=63&s|128);r=o-q$-t}else r=o(e,q$+t,i);r<32?F$[q$++]=160|r:r<256?(t<2&&F$.copyWithin(q$+2,q$+1,q$+1+r),F$[q$++]=217,F$[q$++]=r):r<65536?(t<3&&F$.copyWithin(q$+3,q$+2,q$+2+r),F$[q$++]=218,F$[q$++]=r>>8,F$[q$++]=255&r):(t<5&&F$.copyWithin(q$+5,q$+3,q$+3+r),F$[q$++]=219,j$.setUint32(q$,r),q$+=4),q$+=r}else if("number"===n)if(e>>>0===e)e<64?F$[q$++]=e:e<256?(F$[q$++]=204,F$[q$++]=e):e<65536?(F$[q$++]=205,F$[q$++]=e>>8,F$[q$++]=255&e):(F$[q$++]=206,j$.setUint32(q$,e),q$+=4);else if((e|0)===e)e>=-32?F$[q$++]=256+e:e>=-128?(F$[q$++]=208,F$[q$++]=e+256):e>=-32768?(F$[q$++]=209,j$.setInt16(q$,e),q$+=2):(F$[q$++]=210,j$.setInt32(q$,e),q$+=4);else{let t;if((t=this.useFloat32)>0&&e<4294967296&&e>=-2147483648){let r;if(F$[q$++]=202,j$.setFloat32(q$,e),t<4||((r=e*O$[(127&F$[q$])<<1|F$[q$+1]>>7])|0)===r)return void(q$+=4);q$--}F$[q$++]=203,j$.setFloat64(q$,e),q$+=8}else if("object"===n)if(e){if(s){let r=s.get(e);if(r){if(!r.id){let e=s.idsToInsert||(s.idsToInsert=[]);r.id=e.push(r)}return F$[q$++]=214,F$[q$++]=112,j$.setUint32(q$,r.id),void(q$+=4)}s.set(e,{offset:q$-t})}let n=e.constructor;if(n===Object)w(e,!0);else if(n===Array){(r=e.length)<16?F$[q$++]=144|r:r<65536?(F$[q$++]=220,F$[q$++]=r>>8,F$[q$++]=255&r):(F$[q$++]=221,j$.setUint32(q$,r),q$+=4);for(let t=0;t<r;t++)b(e[t])}else if(n===Map){(r=e.size)<16?F$[q$++]=128|r:r<65536?(F$[q$++]=222,F$[q$++]=r>>8,F$[q$++]=255&r):(F$[q$++]=223,j$.setUint32(q$,r),q$+=4);for(let[t,r]of e)b(t),b(r)}else{for(let t=0,r=B$.length;t<r;t++){if(e instanceof z$[t]){let r=B$[t];if(r.write)return r.type&&(F$[q$++]=212,F$[q$++]=r.type,F$[q$++]=0),void b(r.write.call(this,e));let n,i=F$,s=j$,a=q$;F$=null;try{n=r.pack.call(this,e,(e=>(F$=i,i=null,(q$+=e)>U$&&x(q$),{target:F$,targetView:j$,position:q$-e})),b)}finally{i&&(j$=s,q$=a,U$=(F$=i).length-10)}return void(n&&(n.length+q$>U$&&x(n.length+q$),q$=$$(n,F$,q$,r.type)))}}w(e,!e.hasOwnProperty)}}else F$[q$++]=192;else if("boolean"===n)F$[q$++]=e?195:194;else if("bigint"===n){if(e<BigInt(1)<<BigInt(63)&&e>=-(BigInt(1)<<BigInt(63)))F$[q$++]=211,j$.setBigInt64(q$,e);else if(e<BigInt(1)<<BigInt(64)&&e>0)F$[q$++]=207,j$.setBigUint64(q$,e);else{if(!this.largeBigIntToFloat)throw new RangeError(e+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");F$[q$++]=203,j$.setFloat64(q$,Number(e))}q$+=8}else if("undefined"===n)this.encodeUndefinedAsNil?F$[q$++]=192:(F$[q$++]=212,F$[q$++]=0,F$[q$++]=0);else{if("function"!==n)throw new Error("Unknown type: "+n);b(this.writeFunction&&this.writeFunction())}},w=!1===this.useRecords?this.variableMapSize?e=>{let t,r=Object.keys(e),n=r.length;n<16?F$[q$++]=128|n:n<65536?(F$[q$++]=222,F$[q$++]=n>>8,F$[q$++]=255&n):(F$[q$++]=223,j$.setUint32(q$,n),q$+=4);for(let i=0;i<n;i++)b(t=r[i]),b(e[t])}:(e,r)=>{F$[q$++]=222;let n=q$-t;q$+=2;let i=0;for(let t in e)(r||e.hasOwnProperty(t))&&(b(t),b(e[t]),i++);F$[n+++t]=i>>8,F$[n+t]=255&i}:e=>{let t,r=Object.keys(e),s=i.transitions||(i.transitions=Object.create(null)),a=0;for(let n=0,i=r.length;n<i;n++){let e=r[n];t=s[e],t||(t=s[e]=Object.create(null),a++),s=t}let o=s[K$];if(o)o>=96&&f?(F$[q$++]=96+(31&(o-=96)),F$[q$++]=o>>5):F$[q$++]=o;else{o=i.nextId,o||(o=64),o<p&&this.shouldShareStructure&&!this.shouldShareStructure(r)?(o=i.nextOwnId,o<m||(o=p),i.nextOwnId=o+1):(o>=m&&(o=p),i.nextId=o+1);let e=r.highByte=o>=96&&f?o-96>>5:-1;s[K$]=o,i[o-64]=r,o<p?(r.isShared=!0,i.sharedLength=o-63,n=!0,e>=0?(F$[q$++]=96+(31&o),F$[q$++]=e):F$[q$++]=o):(e>=0?(F$[q$++]=213,F$[q$++]=114,F$[q$++]=96+(31&o),F$[q$++]=e):(F$[q$++]=212,F$[q$++]=114,F$[q$++]=o),a&&(v+=y*a),g.length>=d&&(g.shift()[K$]=0),g.push(s),b(r))}for(let n=0,i=r.length;n<i;n++)b(e[r[n]])},x=e=>{let r;if(e>16777216){if(e-t>G$)throw new Error("Packed buffer would be larger than maximum buffer size");r=Math.min(G$,4096*Math.round(Math.max((e-t)*(e>67108864?1.25:2),4194304)/4096))}else r=1+(Math.max(e-t<<2,F$.length-1)>>12)<<12;let n=new H$(r);return j$=new DataView(n.buffer,0,r),F$.copy?F$.copy(n,0,t,e):n.set(F$.slice(t,e)),q$-=t,t=0,U$=n.length-10,F$=n}}useBuffer(e){F$=e,j$=new DataView(F$.buffer,F$.byteOffset,F$.byteLength),q$=0}};function Z$(e,t,r,n){let i=e.byteLength;if(i+1<256){var{target:s,position:a}=r(4+i);s[a++]=199,s[a++]=i+1}else if(i+1<65536){var{target:s,position:a}=r(5+i);s[a++]=200,s[a++]=i+1>>8,s[a++]=i+1&255}else{var{target:s,position:a,targetView:o}=r(7+i);s[a++]=201,o.setUint32(a,i+1),a+=4}s[a++]=116,s[a++]=t,s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a)}function J$(e,t){let r=e.byteLength;var n,i;if(r<256){var{target:n,position:i}=t(r+2);n[i++]=196,n[i++]=r}else if(r<65536){var{target:n,position:i}=t(r+3);n[i++]=197,n[i++]=r>>8,n[i++]=255&r}else{var{target:n,position:i,targetView:s}=t(r+5);n[i++]=198,s.setUint32(i,r),i+=4}n.set(e,i)}function $$(e,t,r,n){let i=e.length;switch(i){case 1:t[r++]=212;break;case 2:t[r++]=213;break;case 4:t[r++]=214;break;case 8:t[r++]=215;break;case 16:t[r++]=216;break;default:i<256?(t[r++]=199,t[r++]=i):i<65536?(t[r++]=200,t[r++]=i>>8,t[r++]=255&i):(t[r++]=201,t[r++]=i>>24,t[r++]=i>>16&255,t[r++]=i>>8&255,t[r++]=255&i)}return t[r++]=n,t.set(e,r),r+=i}function e0(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");z$.unshift(e.Class),B$.unshift(e)}!function(e){e.unpack?t$[e.type]=e.unpack:t$[e.type]=e}(e)}z$=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,n$],B$=[{pack(e,t,r){let n=e.getTime()/1e3;if((this.useTimestamp32||0===e.getMilliseconds())&&n>=0&&n<4294967296){let{target:e,targetView:r,position:i}=t(6);e[i++]=214,e[i++]=255,r.setUint32(i,n)}else if(n>0&&n<17179869184){let{target:r,targetView:i,position:s}=t(10);r[s++]=215,r[s++]=255,i.setUint32(s,4e6*e.getMilliseconds()+(n/1e3/4294967296|0)),i.setUint32(s+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return t(0),r(this.onInvalidDate());let{target:e,targetView:n,position:i}=t(3);e[i++]=212,e[i++]=255,e[i++]=255}else{let{target:r,targetView:i,position:s}=t(15);r[s++]=199,r[s++]=12,r[s++]=255,i.setUint32(s,1e6*e.getMilliseconds()),i.setBigInt64(s+4,BigInt(Math.floor(n)))}}},{pack(e,t,r){let n=Array.from(e),{target:i,position:s}=t(this.structuredClone?3:0);this.structuredClone&&(i[s++]=212,i[s++]=115,i[s++]=0),r(n)}},{pack(e,t,r){let{target:n,position:i}=t(this.structuredClone?3:0);this.structuredClone&&(n[i++]=212,n[i++]=101,n[i++]=0),r([e.name,e.message])}},{pack(e,t,r){let{target:n,position:i}=t(this.structuredClone?3:0);this.structuredClone&&(n[i++]=212,n[i++]=120,n[i++]=0),r([e.source,e.flags])}},{pack(e,t){this.structuredClone?Z$(e,16,t):J$(V$?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let r=e.constructor;r!==W$&&this.structuredClone?Z$(e,k$.indexOf(r.name),t):J$(e,t)}},{pack(e,t){let{target:r,position:n}=t(1);r[n]=193}}];var t0,r0,n0,i0=new Q$({useRecords:!1}),{NEVER:s0,ALWAYS:a0,DECIMAL_ROUND:o0,DECIMAL_FIT:l0}=(i0.pack,i0.pack,{NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4}),c0=512,u0=1024,h0=new Q$({structuredClone:!0});function d0(e){if(JZ(e))return e;if(Array.isArray(e))return e.map(d0);if("object"==typeof e&&null!==e){let t={};for(let r of Object.keys(e).sort())t[r]=d0(e[r]);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}return e}function f0(e){return"MouseDown"===e||"MouseUp"===e||"KeyDown"===e||"KeyUp"===e||"Collision"===e||"Trigger"===e}e0({Class:XZ.prototype.constructor,type:1,write:e=>u({},e),read:e=>(Object.setPrototypeOf(e,XZ.prototype),e)}),e0({Class:nJ.prototype.constructor,type:2,write:e=>[...e],read:e=>(Object.setPrototypeOf(e,nJ.prototype),e)}),e0({Class:rJ.prototype.constructor,type:3,write:e=>[...e],read:e=>(Object.setPrototypeOf(e,rJ.prototype),e)}),e0({Class:FJ.prototype.constructor,type:4,write:e=>e.id,read:e=>new FJ(e)}),e0({Class:jJ.prototype.constructor,type:5,write:e=>e.data,read:e=>new jJ(e)}),e0({Class:cJ.prototype.constructor,type:6,write:e=>u({},e),read:e=>(Object.setPrototypeOf(e,cJ.prototype),e)}),(e=>{function t(e){return h0.pack(e)}e.serialize=t,e.deserialize=function(e){return h0.unpack(e)},e.checksum=function(e){return function(e){var t=0;if(0===e.length)return t;for(let r=0;r<e.length;r++)t=(t<<5)-t+e[r],t|=0;return t}(t(d0(e))).toString()}})(t0||(t0={})),(n0=r0||(r0={})).toEventUIType=function(e){return"Conditional"===e.type?"Distance"===e.condition.type?"Distance":"StateChange":e.type},n0.fromEventUIType=function(e){return"Distance"===e||"StateChange"===e?"Conditional":e};var p0,m0,g0,v0,y0,b0,w0,x0,S0,_0,C0,E0,A0,M0,T0,P0,k0,D0,I0,O0,R0={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Particles","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseHover:["Transition","Animation","Particles","Create","Destroy","SwitchCamera","SceneTransition","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Scroll:["Transition","Animation","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Start:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Conditional:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MousePress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyPress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],GameControl:["Transition","Animation","Audio","Particles","Create","Conditional"],Collision:["Transition","Animation","Audio","Particles","Video","Create","Destroy","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Trigger:["Transition","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Resize:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],VariableChange:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],API:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],WEBHOOK:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],AIAssistantListener:["SetVariable"],AIAssistantTrigger:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"]};(e=>{e.is=function(e){return"MouseDown"===e.type||"MouseUp"===e.type||"MousePress"===e.type||"KeyDown"===e.type||"KeyUp"===e.type||"KeyPress"===e.type},e.defaultData=function(e){return"MouseDown"===e||"MouseUp"===e||"MousePress"===e?{type:e,mode:"Object",disabled:!1,actions:new nJ}:{type:e,disabled:!1,key:void 0,actions:new nJ}}})(p0||(p0={})),(e=>{e.propertyDefaultData=function(e){return{type:"Property",value:[null!==e&&void 0!==e?e:null,"position","x"]}},e.valueDefaultData={type:"Literal",value:0}})(m0||(m0={})),(e=>{e.comparisonDefaultData=function(e){return{type:"Comparison",operator:"==",lOperand:m0.propertyDefaultData(e),rOperand:u({},m0.valueDefaultData)}},e.distanceDefaultData=function(e){return{type:"Distance",toObject:null!==e&&void 0!==e?e:null,fromObject:null!==e&&void 0!==e?e:null,distance:200}},e.stateDefaultData=function(e,t){return{type:"State",object:null!==e&&void 0!==e?e:null,state:null!==t&&void 0!==t?t:null}}})(g0||(g0={})),(e=>{e.isConditionalSubActions=function(e){return void 0!==e.find((e=>"ifActions"===e||"elseActions"===e))}})(v0||(v0={})),(e=>{e.is=function(e){return"Conditional"===e.type},e.defaultData=function(e){return{type:"Conditional",disabled:!1,inActions:new nJ,outActions:new nJ,condition:g0.distanceDefaultData(e)}}})(y0||(y0={})),(e=>{e.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new nJ,drop:new nJ}}})(b0||(b0={})),(e=>{e.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new nJ}})(w0||(w0={})),(e=>{e.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5}})(x0||(x0={})),(e=>{e.is=function(e){return"MouseHover"===e.type},e.defaultData=function(){return{type:"MouseHover",disabled:!1,actions:new nJ}}})(S0||(S0={})),(e=>{e.is=function(e){return"Scroll"===e.type},e.defaultData=function(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new nJ}}})(_0||(_0={})),(e=>{e.is=function(e){return"Start"===e.type},e.defaultData=function(){return{type:"Start",disabled:!1,actions:new nJ}}})(C0||(C0={})),(e=>{e.is=function(e){return"Collision"===e.type},e.defaultData=function(){return{type:"Collision",disabled:!1,target:"character",actions:new nJ}}})(E0||(E0={})),(e=>{e.is=function(e){return"Trigger"===e.type},e.defaultData=function(e,t){return{type:"Trigger",disabled:!1,target:"all",triggeringObjects:[],actions:new nJ,triggerZone:"box",position:t.toArray(),rotation:[0,0,0],size:e.toArray(),radius:e.length()/2,helperVisible:!0}}})(A0||(A0={})),(T0=M0||(M0={})).defaultSizes={mobile:[480,480],tablet:[768,768],desktop:[1200,1200],custom:[769,1200]},T0.is=function(e){return"Resize"===e.type},T0.sizeToDevice=function(e){return"string"==typeof e?e:"custom"},T0.deviceToSize=function(e){return"string"==typeof e?[...T0.defaultSizes[e]]:[...e]},T0.defaultData=function(){let e={size:"mobile",operator:"<",actions:new nJ},t={size:"tablet",operator:"<",actions:new nJ},r={size:[...T0.defaultSizes.custom],operator:"<>",actions:new nJ},n=new nJ;return n.push({id:$N.generateUUID(),fi:0,data:e},{id:$N.generateUUID(),fi:1,data:t},{id:$N.generateUUID(),fi:2,data:r}),{type:"Resize",disabled:!1,orientation:"horizontal",breakpoints:n}},T0.defaultBreakpointData=function(){return{size:[...T0.defaultSizes.custom],operator:"<>",actions:new nJ}},(e=>{e.propertyPaths={Position:["position"],"Position X":["position","x"],"Position Y":["position","y"],"Position Z":["position","z"],Rotation:["rotation"],"Rotation X":["rotation","x"],"Rotation Y":["rotation","y"],"Rotation Z":["rotation","z"],Scale:["scale"],"Scale X":["scale","x"],"Scale Y":["scale","y"],"Scale Z":["scale","z"],Width:["width"],Height:["height"],Depth:["depth"],"Mouse Position X":["mouse","x"],"Mouse Position Y":["mouse","y"],"Mouse Pressed":["mouse","pressed"],"Screen Width":["mouse","width"],"Screen Height":["mouse","height"],"Hit Position X":["raycast","x"],"Hit Position Y":["raycast","y"],"Hit Position Z":["raycast","z"],"Hit Object Position X":["raycast","objX"],"Hit Object Position Y":["raycast","objY"],"Hit Object Position Z":["raycast","objZ"]},e.is=function(e){return"VariableChange"===e.type},e.defaultData=function(){return{disabled:!1,type:"VariableChange",actions:new nJ,variableId:"",objectId:null,property:"Position X"}}})(P0||(P0={})),(e=>{e.is=function(e){return"API"===e.type},e.defaultData=function(){return{disabled:!1,type:"API",successActions:new nJ,errorActions:new nJ,userAPIId:""}}})(k0||(k0={})),(e=>{e.is=function(e){return"WEBHOOK"===e.type},e.defaultData=function(){return{disabled:!1,type:"WEBHOOK",actions:new nJ,userWebhookId:""}}})(D0||(D0={})),(e=>{e.is=function(e){return"AIAssistantListener"===e.type},e.defaultData=function(){return{disabled:!1,type:"AIAssistantListener",actions:new nJ,analysis:"average",analysisRange:[0,71],analysisSingle:0}}})(I0||(I0={})),(e=>{e.is=function(e){return"AIAssistantTrigger"===e.type},e.defaultData=function(){return{disabled:!1,description:"",type:"AIAssistantTrigger",actions:new nJ}}})(O0||(O0={}));var L0,N0,B0,z0,F0,j0,U0,V0,H0,W0,G0,q0,X0,Y0,K0,Q0,Z0,J0,$0,e1,t1="personal camera",r1="a218fcc3-276b-49b9-b485-49037fd14f5f",n1=5526619;function i1(e){return"string"==typeof e&&36===e.length&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)}(e=>{function t(e,t){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}function r(e,r){return Math.sqrt(t(e,r))}function n(t,r,n){let i=e.sub(r,t),s=e.sub(n,t),a=e.dot(i,s)/e.dot(i,i),o=e.scalarMultiply(i,a);return e.add(t,o)}e.isEqual=function(e,t){return e[0]===t[0]&&e[1]===t[1]},e.lerp=function(e,t,r){return[e[0]+(t[0]-e[0])*r,e[1]+(t[1]-e[1])*r]},e.add=function(e,t){return[e[0]+t[0],e[1]+t[1]]},e.sub=function(e,t){return[e[0]-t[0],e[1]-t[1]]},e.multiply=function(e,t){return[e[0]*t[0],e[1]*t[1]]},e.divide=function(e,t){return[e[0]/t[0],e[1]/t[1]]},e.distanceSquared=t,e.distance=r,e.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},e.scalarMultiply=function(e,t){return[e[0]*t,e[1]*t]},e.projectionOnto=n,e.projectionOntoDistance=function(e,t,i){return r(e,n(e,t,i))},e.center=function(e,t){return[.5*(e[0]+t[0]),.5*(e[1]+t[1])]}})(L0||(L0={})),(B0=N0||(N0={})).isEqual=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},B0.add=function(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]},B0.sub=function(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]},B0.div=function(e,t){return[e[0]/t[0],e[1]/t[1],e[2]/t[2]]},B0.mul=function(e,t){return[e[0]*t[0],e[1]*t[1],e[2]*t[2]]},B0.dist=function(e,t){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])},B0.lerp=function(e,t,r){return[e[0]+(t[0]-e[0])*r,e[1]+(t[1]-e[1])*r,e[2]+(t[2]-e[2])*r]},(e=>{e.isEqual=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},e.lerp=function(e,t,r){return[e[0]+(t[0]-e[0])*r,e[1]+(t[1]-e[1])*r,e[2]+(t[2]-e[2])*r,e[3]+(t[3]-e[3])*r]}})(z0||(z0={})),(e=>{let t=180/Math.PI,r=Math.PI/180;function n(e){return"number"==typeof e?e*t:e}function i(e){return"number"==typeof e?e*r:e}e.radToDeg=function(e){return[n(e[0]),n(e[1]),n(e[2])]},e.degToRad=function(e){return[i(e[0]),i(e[1]),i(e[2])]}})(F0||(F0={})),(U0=j0||(j0={})).identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],U0.isEqual=function(e,t){for(let r=0;r<16;r++)if(e[r]!==t[r])return!1;return!0},U0.simplify=function(e){return null!==e&&void 0!==e?e:U0.identity},U0.applyMatrix4=function(e,t){let r=t.slice(0);for(var n=0,i=t.length;n<i;n+=3){let i=e[3]*t[n]+e[7]*t[n+1]+e[11]*t[n+2]+e[15];r[n]=(e[0]*t[n]+e[4]*t[n+1]+e[8]*t[n+2]+e[12])/i,r[n+1]=(e[1]*t[n]+e[5]*t[n+1]+e[9]*t[n+2]+e[13])/i,r[n+2]=(e[2]*t[n]+e[6]*t[n+1]+e[10]*t[n+2]+e[14])/i}return r},(H0=V0||(V0={})).isRGB=function(e){return"object"==typeof e&&"number"==typeof e.r&&"number"==typeof e.g&&"number"==typeof e.b},H0.white={r:1,g:1,b:1},H0.red={r:1,g:0,b:0},H0.black={r:0,g:0,b:0},H0.toRgb255a1=function(e){return{r:Math.round(255*e.r),g:Math.round(255*e.g),b:Math.round(255*e.b),a:1}},H0.clone=function(e){return{r:e.r,g:e.g,b:e.b}},H0.fromHex=function(e){return{r:((e=Math.floor(e))>>16&255)/255,g:(e>>8&255)/255,b:(255&e)/255}},H0.toHex=function(e){return 65536*Math.round(255*e.r)+256*Math.round(255*e.g)+Math.round(255*e.b)},H0.equals=function(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b},H0.equalsFixed=function(e,t){return e.r.toFixed(2)===t.r.toFixed(2)&&e.g.toFixed(2)===t.g.toFixed(2)&&e.b.toFixed(2)===t.b.toFixed(2)},H0.lerp=function(e,t,r){return{r:e.r+(t.r-e.r)*r,g:e.g+(t.g-e.g)*r,b:e.b+(t.b-e.b)*r}},(G0=W0||(W0={})).white=u(u({},V0.white),{},{a:1}),G0.transparent=u(u({},V0.white),{},{a:0}),G0.from0to1=function(e){return{r:e[0],g:e[1],b:e[2],a:e[3]}},G0.fromHexAndA=function(e,t){return u(u({},V0.fromHex(e)),{},{a:t})},G0.toRgb255a1=function(e){return{r:Math.round(255*e.r),g:Math.round(255*e.g),b:Math.round(255*e.b),a:e.a}},G0.equals=function(e,t){return V0.equals(e,t)&&e.a===t.a},G0.equalsFixed=function(e,t){return V0.equalsFixed(e,t)&&e.a.toFixed(2)===t.a.toFixed(2)},G0.lerp=function(e,t,r){return{r:e.r+(t.r-e.r)*r,g:e.g+(t.g-e.g)*r,b:e.b+(t.b-e.b)*r,a:e.a+(t.a-e.a)*r}},G0.toStyle=function(){let{r:e,g:t,b:r,a:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G0.white;return"rgba(".concat(255*e,", ").concat(255*t,", ").concat(255*r,", ").concat(n,")")},(e=>{e.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]}})(q0||(q0={})),(e=>{e.defaultData={mass:1,stiffness:80,damping:10,velocity:0}})(X0||(X0={})),(e=>{e.defaultData={control1:[.5,0],control2:[.5,1]}})(Y0||(Y0={})),(Q0=K0||(K0={})).linear=[0,0,1,1],Q0.ease=[.25,.1,.25,1],Q0.easeIn=[.42,0,1,1],Q0.easeOut=[0,0,.58,1],Q0.easeInOut=[.42,0,.58,1],(e=>{e.all=["PerspectiveCamera","OrthographicCamera"],e.is=function(t){return e.all.includes(t)}})(Z0||(Z0={})),(e=>{e.DefaultUp=[0,1,0],e.DefaultTargetOffset=1e3,e.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:e.DefaultUp,isUpVectorFlipped:!1,targetOffset:e.DefaultTargetOffset},e.getZoom=function(e){var t,r,n,i;return"PerspectiveCamera"===e.type?null!==(t=null===(r=e.perspective)||void 0===r?void 0:r.zoom)&&void 0!==t?t:1:null!==(n=null===(i=e.orthographic)||void 0===i?void 0:i.zoom)&&void 0!==n?n:1}})(J0||(J0={})),(e=>{e.defaultData=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:2*Math.max(e[0],e[1]),start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[e[0]+e[0]*t,0,0]},grid:{count:[2,2,2],size:e.map((e=>e*(1+t))),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}},e.merge=function(e,t){let r=u({},e);if(g1.forEach((n=>{var i;Object.assign(r,{[n]:null!==(i=t[n])&&void 0!==i?i:e[n]})})),r.radial=u({},e.radial),t.radial){let n=e.radial,i=t.radial;v1.forEach((e=>{var t;Object.assign(r.radial,{[e]:null!==(t=i[e])&&void 0!==t?t:n[e]})}))}if(r.linear=u({},e.linear),t.linear){let n=e.linear,i=t.linear;y1.forEach((e=>{var t;Object.assign(r.linear,{[e]:null!==(t=i[e])&&void 0!==t?t:n[e]})}))}if(r.grid=u({},e.grid),t.grid){let n=e.grid,i=t.grid;b1.forEach((e=>{var t;Object.assign(r.grid,{[e]:null!==(t=i[e])&&void 0!==t?t:n[e]})}))}if(r.toObject=u({},e.toObject),t.toObject){let n=e.toObject,i=t.toObject;w1.forEach((e=>{var t;Object.assign(r.toObject,{[e]:null!==(t=i[e])&&void 0!==t?t:n[e]})}))}if(r.randomnessObject=u({},e.randomnessObject),t.randomnessObject){let n=e.randomnessObject,i=t.randomnessObject;x1.forEach((e=>{var t;Object.assign(r.randomnessObject,{[e]:null!==(t=i[e])&&void 0!==t?t:n[e]})}))}return r}})($0||($0={})),(e=>{e.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let t=["radial","linear","grid","toObject","randomnessObject"];e.toOps=function(e,r){let n=[];void 0!==e.count&&n.push({type:0,path:r,props:{count:e.count}});for(let i of t){let t=e[i];t&&Object.keys(t).length>0&&n.push({type:0,path:[...r,i],props:t})}return n}})(e1||(e1={}));var s1,a1,o1,l1,c1,u1,h1,d1,f1,p1,m1,g1=["count"],v1=["radius","start","end","position","scale","rotation"],y1=["position","scale","rotation"],b1=["count","size"],w1=["count","position","scale","rotation"],x1=["strength","scale","rotation","position","movement","seed","freqScale"];(e=>{e.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"],e.is=function(t){return e.all.includes(t)}})(s1||(s1={})),(e=>{e.defaultData=function(e){return function(e){if("PointLight"===e)return{type:e,color:W0.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if("SpotLight"===e)return{type:e,color:W0.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if("DirectionalLight"===e)return{type:e,color:W0.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}(e)}})(a1||(a1={})),(e=>{e.defaultShapeData={type:"PlaneEmitterShape",size:[100,100,100]},e.defaultCollisionData={colliderEntityId:null,collisionBounce:.75},e.defaultData=u({renderMaterial:{type:"particleMaterial",color:{r:1,g:.2,b:.545,a:1},color2:{r:.945,g:.714,b:.184,a:1},coloring:"gradient",ease:"linearFadeOut",easeSize:"linearFadeOut",transparent:!0,size:[40,40],texture:"pt_default_particle",spriteRotation:[0,0]},birthRatePerSec:50,gravity:1,noiseStrength:0,noiseScale:0,noiseSeed:1,noiseType:"curl",randomRotation:0,randomScale:.2,randomMass:.5,rootObjectType:"instancedMesh",life:1,direction:[0,0,0],directionMode:"axis",speed:10,shape:e.defaultShapeData,autoPlay:!0,emitTimeDelay:0,emitTimeCycle:"infinity",emitTimeDuration:1},e.defaultCollisionData)})(o1||(o1={})),(e=>{e.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]}})(l1||(l1={})),(e=>{e.defaultData={castShadow:!0,receiveShadow:!0},e.equals=function(e,t){return e.castShadow===t.castShadow&&e.receiveShadow===t.receiveShadow}})(c1||(c1={})),(e=>{e.defaultData={flatShading:!1,wireframe:!1,side:0},e.equals=function(e,t){return e.flatShading===t.flatShading&&e.side===t.side&&e.wireframe===t.wireframe}})(u1||(u1={})),(e=>{e.defaultData=u(u({},u1.defaultData),c1.defaultData)})(h1||(h1={})),(e=>{e.getMaterialData=function(e,t){let r=[];if("material"in e){var n,i;let s="string"==typeof e.material?null!==(n=t.materials[e.material])&&void 0!==n?n:null===(i=t.lib.materials[e.material])||void 0===i?void 0:i.asset:e.material;s&&r.push(s)}else if("materials"in e)for(let o of e.materials){var s,a;let e="string"==typeof o?null!==(s=t.materials[o])&&void 0!==s?s:null===(a=t.lib.materials[o])||void 0===a?void 0:a.asset:o;e&&r.push(e)}return r}})(d1||(d1={})),(e=>{e.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},e.maxSize=3e7})(f1||(f1={})),(e=>{e.is=function(e){return"texture"===e||"video"===e||"color"===e||"depth"===e||"normal"===e||"gradient"===e||"noise"===e||"fresnel"===e||"rainbow"===e||"toon"===e||"outline"===e||"particle"===e||"transmission"===e||"matcap"===e||"displace"===e||"pattern"===e||"light"===e}})(p1||(p1={})),(e=>{e.is=function(e){return"phong"===e||"toon"===e||"lambert"===e||"physical"===e}})(m1||(m1={}));var S1,_1,C1,E1,A1=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],M1=["wrapping","image","video","name","minFilter","magFilter"];(e=>{e.patch=function(e,t){let{texture:r}=t,n=s(t,sL);if(Object.assign(e,n),r){let t=e.texture;t&&Object.assign(t,r)}},e.defaultData=function(e,t){return"light"===e&&t?function(e){let t={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(e){case"phong":return u(u({},t),{},{category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6});case"toon":return u(u({},t),{},{category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1});case"lambert":return u(u({},t),{},{category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0});case"physical":return u(u({},t),{},{category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0})}}(t):function(e){let t={alpha:1,mode:0,isMask:!1,visible:!0};switch(e){case"texture":return u(u({},t),{},{type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1});case"video":return u(u({},t),{},{type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:f1.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1});case"color":return u(u({},t),{},{type:"color",color:V0.fromHex(n1)});case"depth":return u(u({},t),{},{type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200});case"normal":return u(u({},t),{},{type:"normal",cnormal:[1,1,1]});case"gradient":return u(u({},t),{},{type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]});case"noise":return u(u({},t),{},{type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:u(u({},V0.fromHex(6710886)),{},{a:1}),colorB:u(u({},V0.fromHex(6710886)),{},{a:1}),colorC:u(u({},V0.fromHex(16777215)),{},{a:1}),colorD:u(u({},V0.fromHex(16777215)),{},{a:1}),distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1});case"fresnel":return u(u({},t),{},{type:"fresnel",color:W0.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1});case"rainbow":return u(u({},t),{},{type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]});case"toon":return u(u({},t),{},{type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:W0.fromHexAndA(0,0),offset:[0,0,0]});case"outline":return u(u({},t),{},{type:"outline",outlineColor:W0.fromHexAndA(0,1),contourColor:W0.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0});case"matcap":return u(u({},t),{},{type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006}});case"transmission":return u(u({},t),{},{type:"transmission",thickness:10,ior:1.5,roughness:1});case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return u(u({},t),{},{type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:u(u({},V0.fromHex(0)),{},{a:1}),colorB:u(u({},V0.fromHex(16777215)),{},{a:1}),frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6})}}(e)}})(S1||(S1={})),(e=>{function t(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"layer1",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"layer2",n=new nJ;return n.push({fi:0,data:S1.defaultData("light",e),id:t}),n.push({fi:1,data:S1.defaultData("color"),id:r}),{layers:n}}e.isMergable=function(e){return!e.layers.some((e=>"texture"===e.data.type&&0!==e.data.projection||"depth"===e.data.type&&!e.data.isWorldSpace||"noise"===e.data.type||"displace"===e.data.type))},e.getHash=function(e){let t="";return e.layers.forEach((e=>{Object.entries(e.data).forEach((e=>{let[r,n]=e;t+="".concat(r).concat(n),Array.isArray(n)?n.forEach((e=>t+="".concat(e))):"object"==typeof n?Object.values(n).forEach((e=>{t+="".concat("number"==typeof e?e.toFixed(4):e)})):t+="".concat(n)}))})),t},e.defaultEmptyData=function(){return{layers:new nJ}},e.defaultData=function(){return t("phong",arguments.length>0&&void 0!==arguments[0]?arguments[0]:"layer1",arguments.length>1&&void 0!==arguments[1]?arguments[1]:"layer2")},e.withName=function(e,t){return u(u({},e),{},{name:t})},e.defaultTwoLayerData=t,e.defaultUIObjectMaterial=function(e){let t=S1.defaultData("texture");e&&Object.assign(t.texture,{image:e});let r=new nJ;return r.push({fi:0,data:t,id:"layer1"}),r.push({fi:1,data:u(u({},S1.defaultData("transmission")),{},{alpha:1}),id:"layer2"}),r.push({fi:2,data:u(u({},S1.defaultData("light","lambert")),{},{alpha:0}),id:"layer3"}),{layers:r}},e.defaultTwoLayerTextureData=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"phong",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"layer1",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"layer2",i=S1.defaultData("texture");Object.assign(i.texture,{image:e});let s=new nJ;return s.push({fi:0,data:i,id:r}),s.push({fi:1,data:S1.defaultData("light",t),id:n}),{layers:s}},e.defaultTwoLayerVideoTextureData=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"phong",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"layer1",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"layer2",i=S1.defaultData("video");Object.assign(i.texture,{video:e});let s=new nJ;return s.push({fi:0,data:i,id:r}),s.push({fi:1,data:S1.defaultData("light",t),id:n}),{layers:s}}})(_1||(_1={})),(e=>{e.defaultData=function(){return{points:new nJ,roundness:0,shapeHoles:[],isClosed:!1}}})(C1||(C1={})),(e=>{e.defaultData=function(){return{points:new nJ,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}})(E1||(E1={}));var T1,P1={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0};(e=>{e.merge=function(e,t){let r=u({},e);return R1.forEach((n=>{var i;Object.assign(r,{[n]:null!==(i=t[n])&&void 0!==i?i:e[n]})})),r}})(T1||(T1={}));var k1,D1,I1,O1={shape:P1,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},R1=["depth","offset","angle","twist","startScale","endScale"];(e=>{e.is2DParametricMesh=function(e){return"PolygonGeometry"===e||"RectangleGeometry"===e||"StarGeometry"===e||"TriangleGeometry"===e||"EllipseGeometry"===e||"UIGeometry"===e},e.isParametricMesh=function(e){return"PolygonGeometry"===e||"PolygonGeometry"===e||"RectangleGeometry"===e||"StarGeometry"===e||"TriangleGeometry"===e||"EllipseGeometry"===e||"PathGeometry"===e||"VectorGeometry"===e||"ConeGeometry"===e||"CubeGeometry"===e||"CylinderGeometry"===e||"DodecahedronGeometry"===e||"HelixGeometry"===e||"IcosahedronGeometry"===e||"LatheGeometry"===e||"PyramidGeometry"===e||"SphereGeometry"===e||"PlaneGeometry"===e||"BackdropGeometry"===e||"TorusGeometry"===e||"TorusKnotGeometry"===e||"BooleanGeometry"===e||"TextGeometry"===e||"InputGeometry"===e}})(k1||(k1={})),(e=>{e.merge=function(e,t){let r=u({},e);return Object.assign(r,t),"PathGeometry"===r.type&&"extrusion"in t&&t.extrusion&&(r.extrusion=u({},e.extrusion),Object.assign(r.extrusion,T1.merge(r.extrusion,t.extrusion))),r}})(D1||(D1={})),(e=>{e.defaultData=function(t){if("RectangleGeometry"===t)return{width:320,height:320,type:t,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if("UIGeometry"===t)return{type:t,frame:"",cornerRadius:[0,0,0,0],cornerType:0,width:1,height:1};if("PathGeometry"===t)return{type:t,width:1,height:1,depth:1,path:E1.defaultData(),extrusion:O1};if("VectorGeometry"===t)return{width:1,height:1,type:t,subdivisions:12,shape:C1.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if("BooleanGeometry"===t)return{type:t,operation:2,width:0,height:0,depth:0,phongAngle:35};if("ShapeBlendGeometry"===t)return{type:t,width:0,height:0,depth:0,resolutionLevel:6,blendRange:100,useChildrenColors:!1};if("TextGeometry"===t)return{type:t,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:{textValue:""},textTransform:1,font:"Roboto_regular",editable:!1,extrudeBevelSize:0,extrudeBevelSegments:1};if("InputGeometry"===t)return u(u({},e.defaultData("TextGeometry")),{},{type:t,editable:!0});if("SphereGeometry"===t)return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180};throw new Error("not implemented")}})(I1||(I1={}));var L1,N1,B1,z1,F1,j1,U1,V1,H1,W1,G1,q1,X1,Y1,K1,Q1,Z1,J1,$1,e2,t2,r2,n2,i2,s2,a2,o2,l2,c2,u2,h2,d2,f2,p2,m2,g2,v2,y2,b2,w2,x2,S2,_2=["width","height","depth"];function C2(e){e.layers.forEach((e=>{if("depth"===e.type&&void 0!==e.colorA){let t=e.colorA,r=e.colorB,n=[[t.r,t.g,t.b,t.a],[r.r,r.g,r.b,r.a]],i=[0,1];for(let e=2;e<10;e++)n.push(n[1]),i.push(1);let s=u(u({},mZ(LJ(e),"type","visible","isVector","isWorldSpace","origin","alpha","mode")),{},{near:Math.max(0,e.near),far:Math.max(0,e.far),colors:n,steps:i,num:2,direction:[1,0,0],smooth:!1,gradientType:1});Object.assign(e,s)}else if("depth"===e.type&&1===e.gradientType&&(e.near<0||e.far<0)){let t=u(u({},LJ(e)),{},{near:Math.max(e.near,0),far:Math.max(e.far,0)});Object.assign(e,t)}}))}function E2(e,t){Object.values(e.shared.materials).forEach((e=>t(e)))}function A2(e,t){e.scene.objects.traverse(((e,r)=>{"materials"in r?r.materials.forEach(((e,n)=>{void 0===e&&(r.materials[n]=_1.defaultData(),e=r.materials[n]),"string"!=typeof e&&t(e)})):"material"in r?"string"!=typeof r.material&&(void 0===r.material&&(r.material=_1.defaultData()),t(r.material)):"Mesh"===r.type&&(void 0===r.material&&(r.material=_1.defaultData()),t(r.material)),"overrides"in r&&Object.values(r.overrides).forEach((e=>{e.material&&"string"!=typeof e.material&&Object.getPrototypeOf(e.material)!==cJ.prototype&&t(e.material)}))}))}function M2(e){void 0===e.layers&&Object.assign(e,_1.defaultTwoLayerData("lambert"))}function T2(e){!e.layers||e.layers.forEach((e=>{if("depth"===e.type&&10===e.colors.length){let t=[...e.colors];t.push(e.colors[9]);let r=[...e.steps];r.push(e.steps[9]);let n=u(u({},LJ(e)),{},{colors:t,steps:r});Object.assign(e,n)}}))}function P2(e){e.scene.objects.traverse(((e,t)=>{"materials"in t?t.materials.forEach((e=>{"string"!=typeof e&&T2(e)})):"material"in t&&"string"!=typeof t.material&&T2(t.material)})),Object.values(e.shared.materials).forEach((e=>T2(e)))}function k2(e){e.layers&&e.layers.forEach((e=>{"depth"===e.type&&void 0!==e.num&&(e.colors=e.colors.slice(0,e.num),e.steps=e.steps.slice(0,e.num),delete e.num)}))}function D2(e){e.layers&&e.layers.forEach((e=>{(function(e){return"displace"!==e.type})(e)&&void 0===e.isMask&&(e.isMask=!1),("texture"===e.type||"video"===e.type)&&void 0===e.blending&&(e.blending=0),("noise"===e.type||"displace"===e.type&&"noise"===e.displacementType)&&(void 0===e.voronoiStyle&&(e.voronoiStyle=0),void 0===e.highCut&&(e.highCut=1),void 0===e.lowCut&&(e.lowCut=0),void 0===e.smoothness&&(e.smoothness=.3),void 0===e.seed&&(e.seed=0),void 0===e.quality&&(e.quality=1))}))}function I2(e){var t;let r=null===(t=e.layers.find((e=>"light"===e.type)))||void 0===t?void 0:t.data;if("basic"===(null===r||void 0===r?void 0:r.category)){let e=S1.defaultData("light","phong"),t=r;Object.assign(t,e),t.visible=!1}}function O2(e){E2(e,I2),A2(e,I2)}function R2(e){e.layers.forEach((e=>{"light"===e.type&&"toon"!==e.category&&void 0===e.occlusion&&(e.occlusion=!0)}))}function L2(e){e.layers&&e.layers.forEach((e=>{"light"===e.type&&void 0===e.bumpMapIntensity&&(e.bumpMapIntensity=5)}))}function N2(e,t){if(t<1&&(A2(e,C2),E2(e,C2),e.schema=1),t<2&&(function(e){Object.assign(e.scene.publish,{orbitControls:u(u({},s2.defaultData),LJ(e.scene.publish.orbitControls))})}(e),e.schema=2),t<3&&(function(e){function t(e){if(e.layers)for(let t of Object.values(e.layers))if(t)for(let[e,r]of Object.entries(t))if((A1.includes(e)||"boolean"==typeof r)&&delete t[e],"texture"===e)for(let[t,n]of Object.entries(r))(M1.includes(t)||"boolean"==typeof n)&&delete r[t]}e.scene.objects.traverse(((e,r)=>{r.states.forEach((e=>{let r=e;r.material?t(r.material):r.materials&&r.materials.forEach((e=>{t(e)}))}))}))}(e),e.schema=3),t<4&&(function(e){e.scene.publish.withBackground=!0}(e),e.schema=4),t<5&&(function(e){e.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}(e),e.schema=5),t<6&&(function(e){e.scene.objects.traverse(((e,t)=>{let r=t.cloner;r&&(r.radial.scale=r.radial.scale.map((e=>e+1)),r.linear.scale=r.linear.scale.map((e=>e+1)))}))}(e),e.schema=6),t<7&&(function(e){e.scene.objects.traverse(((e,t)=>{let r=t.geometry;r&&("DodecahedronGeometry"===r.type||"IcosahedronGeometry"===r.type)&&(r.detail=Math.round(r.detail))}))}(e),e.schema=7),t<8&&(e.schema=8),t<9&&(P2(e),e.schema=9),t<10&&(function(e){e.scene.objects.traverse(((e,t)=>{"Mesh"===t.type&&("BooleanGeometry"===t.geometry.type||"SubdivGeometry"===t.geometry.type)&&(t.geometry.phongAngle=35)}))}(e),e.schema=10),t<11&&(function(e){e.scene.environment.ambientLight.softShadows=!1,e.scene.environment.ambientLight.softShadowQuality="low",e.scene.objects.traverse(((e,t)=>{("DirectionalLight"===t.type||"SpotLight"===t.type)&&(t.shadowResolution=1024,t.shadowRadius=1,t.depth=1e5)})),e.shared.penumbraSize=new Array(5).fill(.5)}(e),e.schema=11),t<12&&(P2(e),e.schema=12),t<13&&(function(e){e.shared.audios=yZ({},XZ.prototype)}(e),e.schema=13),t<14&&(function(e){let t=e.shared.materials;Object.entries(t).forEach((e=>{let[r,n]=e;if(!n.layers){let e={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(t,{[r]:e})}}))}(e),e.schema=14),t<15&&(function(e){Object.entries(LJ(e.shared.images)).filter((e=>!1===e[1].asset)).map((e=>e[0])).forEach((t=>{delete e.shared.images[t]})),Object.entries(LJ(e.shared.audios)).filter((e=>!1===e[1].asset)).map((e=>e[0])).forEach((t=>{delete e.shared.audios[t]}))}(e),e.schema=15),t<16&&(function(e){e.scene.publish.settings.web.preload=!1}(e),e.schema=16),t<17&&(A2(e,k2),E2(e,k2),e.schema=17),t<18&&(A2(e,M2),E2(e,M2),e.schema=18),t<19&&(function(e){Object.assign(e.scene.publish.settings,{video:u(u({},a2.defaultData.settings.video),LJ(e.scene.publish.settings.video))})}(e),e.schema=19),t<20&&(function(e){e.shared.fonts=yZ({},XZ.prototype)}(e),function(e){let t=[];e.scene.objects.traverse(((r,n)=>{let i=n;if("TextFrame"===i.type){let n=_1.defaultTwoLayerData("phong"),s="string"==typeof i.color?e.shared.colors[i.color]:i.color;n.layers[1].data.color={r:s.r,g:s.g,b:s.b},n.layers[1].data.alpha=i.alpha;let a=function(e){return e.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")}(i.font);void 0===e.shared.fonts[a]&&(e.shared.fonts[a]={name:a});let o=u(u(u({name:i.name},q1.defaultData),Z1.defaultData),{},{flatShading:!1,wireframe:!1,geometry:u(u({},I1.defaultData("TextGeometry")),{},{width:i.width,height:i.height,font:a,depth:0,horizontalAlign:i.horizontalAlign,verticalAlign:i.verticalAlign,fontSize:1.40625*i.fontSize,lineHeight:i.lineHeight/1.40625,letterSpacing:i.letterSpacing-1,text:i.text,textTransform:i.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1}),material:n,states:LJ(i.states),events:LJ(i.events),visible:i.visible,raycastLock:i.raycastLock,position:i.position,rotation:i.rotation,scale:i.scale,hiddenMatrix:i.hiddenMatrix}),l=LJ(e.scene.objects).parent(r);e.scene.objects.insertAfter(null!==l&&void 0!==l?l:null,r,[{id:r+"new",data:o,children:[]}]),t.push(r)}})),t.forEach((t=>{e.scene.objects.delete(t)}))}(e),e.schema=20),t<21&&(function(e){let t={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};e.scene.objects.traverse(((e,r)=>{r.events.forEach((e=>{if(t[Number(e.type)])if(Object.assign(e,{type:t[Number(e.type)]}),"Audio"===e.type&&"audioEvent"in e&&(Object.assign(e,{playAudio:e.audioEvent}),delete e.audioEvent),"GameControl"===e.type)Object.assign(e,{gameActions:{idle:new nJ,move:new nJ,jump:new nJ}});else{let t=new nJ;Object.assign(e,{actions:t}),("MouseDown"===e.type||"MouseUp"===e.type||"KeyDown"===e.type||"KeyUp"===e.type)&&"url"in e&&t.push({fi:0,id:$N.generateUUID(),data:{type:"Link",url:e.url,delay:0}}),"targets"in e&&(e.targets.forEach(((e,r,n)=>{let i={easing:e.easing,duration:e.duration};6===e.easing?Object.assign(i,mZ(e,"mass","stiffness","damping","velocity")):5===e.easing&&Object.assign(i,{control1:u({},e.control1),control2:u({},e.control2)});let s={repeat:e.repeat?-1:0,delay:e.delay,delayDirection:e.delayDirection,direction:e.cycle&&e.rewind?"pingpong-rewind":e.cycle?"pingpong":"normal"},a=u(u({state:e.state},s),i),o={allowSlerp:!0,type:"Transition",object:e.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new nJ({fi:0,id:$N.generateUUID(),data:{state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4}},{fi:1,id:$N.generateUUID(),data:a})};t.push({fi:n,id:r,data:o})})),delete e.targets)}}))}))}(e),function(e){e.scene.objects.traverse(((e,t)=>{function r(e,r){let n=new nJ,i=[];if(t.events.forEach(((e,t,s)=>{if("Audio"===e.type&&e.trigger===r){let r;i.push(t),"play"===e.interaction?r=u(u({},mZ(e,"interaction","audio","delay","volume","loop")),{},{triggerAfter:"after"in e?e.after:void 0,toggle:"after"in e?e.toggle:void 0,type:"Audio"}):("pause"===e.interaction||"stop"===e.interaction)&&(r=u(u({},mZ(e,"interaction","delay","object","playAudio")),{},{type:"Audio"})),r&&n.push({fi:s,id:t,data:r})}})),i.forEach((e=>t.events.delete(e))),n.length){var s;let r=null===(s=t.events.find((t=>t.type===e)))||void 0===s?void 0:s.data;r?"actions"in r&&r.actions.insertBefore(null,n):t.events.insertBefore(null,[{id:$N.generateUUID(),data:{type:e,actions:n}}])}}r("Start","start"),r("MouseDown","mouseDown"),r("MouseUp","mouseUp"),r("KeyDown","keyDown"),r("KeyUp","keyUp")}))}(e),e.schema=21),t<22&&(O2(e),e.schema=22),t<23&&(function(e){e.scene.objects.traverse(((e,t)=>{"Mesh"===t.type&&"SubdivGeometry"===t.geometry.type&&(t.geometry.scaleBaked||(t.geometry.scaleBaked=[1,1,1]))}))}(e),e.schema=23),t<24&&(function(e){e.scene.objects.traverse(((e,t)=>{("Empty"===t.type||"Mesh"===t.type)&&t.cloner&&!t.cloner.randomnessObject&&!t.cloner.toObject&&!t.cloner.randomness&&(t.cloner=u(u({},t.cloner),{},{toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}))}))}(e),e.schema=24),(t<25||void 0===e.shared.videos)&&(function(e){e.shared.videos=yZ({},XZ.prototype)}(e),t<25&&(e.schema=25)),t<26&&(function(e){e.scene.objects.traverse(((t,r)=>{let n=e.scene.objects.unproxy().parent(t);if(n){let t=LJ(e.scene.objects.data(n));t&&"Mesh"===t.type&&"BooleanGeometry"===t.geometry.type&&"Mesh"===r.type&&(r.visible=!0!==LJ(r).booleanExclude)}}))}(e),e.schema=26),t<27&&(function(e){e.scene.objects.traverse(((e,t)=>{if("Mesh"===t.type){let e=t;"NonParametricGeometry"===t.geometry.type?void 0!==e.material&&delete e.material:void 0!==e.materials&&delete e.materials}}))}(e),e.schema=27),t<28&&(O2(e),e.schema=28),t<29&&(function(e){function t(e){Object.setPrototypeOf(e,cJ.prototype),e.texture&&Object.setPrototypeOf(e.texture,cJ.prototype)}function r(e){Object.setPrototypeOf(e,cJ.prototype);for(let r in e)t(e[r])}e.scene.objects.traverse(((e,t)=>{t.states.forEach((e=>{let t=e;if(t.material){let e=LJ(t.material).layers;r(e),t.material.layers=e}if(t.materials)for(let n=0;n<t.materials.length;n++){let e=t.materials[n],i=LJ(e).layers;r(i),e.layers=i}}))}))}(e),e.schema=29),t<30&&(function(e){e.scene.objects.traverse(((e,t)=>{"Mesh"===t.type&&"NonParametricGeometry"===t.geometry.type&&!("material"in t)&&!("materials"in t)&&(t.material=_1.defaultTwoLayerData("phong"))}))}(e),e.schema=30),t<31&&(function(e){void 0===e.scene.publish.orbitControls.autoZoom&&(e.scene.publish.orbitControls.autoZoom=!1),e.scene.objects.traverse(((e,t)=>{("OrthographicCamera"===t.type||"PerspectiveCamera"===t.type)&&(void 0===t.orthographic.autoZoom&&(t.orthographic.autoZoom=!1),void 0===t.orthographic.autoZoomFrustumSize&&(t.orthographic.autoZoomFrustumSize=790))}))}(e),e.schema=31),t<33&&(function(e){e.scene.objects.traverse(((e,t)=>{void 0===t.pathSnapping&&(t.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),void 0===t.pathSnapping.offset&&(t.pathSnapping.offset=0)}))}(e),e.schema=33),t<34&&(function(e){void 0===e.scene.publish.mouseEventTarget&&(e.scene.publish.mouseEventTarget="canvas"),void 0===e.scene.publish.settings.web.hint&&(e.scene.publish.settings.web.hint=!1)}(e),e.schema=34),t<35&&(function(e){let{video:t}=e.scene.publish.settings;"gif"===t.format&&t.fps>48&&(t.fps=15)}(e),e.schema=35),t<36&&(function(e){e.scene.objects.traverse(((e,t)=>{t.events.forEach((e=>{"GameControl"===e.type&&(e.resetYPosition=Math.abs(e.resetYPosition-t.position[1]))}))}))}(e),e.schema=36),t<37&&(function(e){let t=e.scene.environment.usePhysics;e.scene.objects.traverse(((e,r)=>{t&&null===r.physics?r.collision=!1:r.collision="visibility"}))}(e),e.schema=37),t<38&&(A2(e,D2),E2(e,D2),e.schema=38),t<39&&(function(e){e.scene.objects.traverse(((e,t)=>{t.events.forEach((e=>{"GameControl"===e.type&&(e.navmesh=S2.defaultDataThirdPerson.navmesh)}))}))}(e),e.schema=39),t<40&&(function(e){e.scene.styles||(e.scene.styles=c2.defaultData())}(e),e.schema=40),t<41&&(function(e){void 0===e.scene.environment.ambientLight.occlusion&&(e.scene.environment.ambientLight.occlusion=!1),void 0===e.scene.environment.ambientLight.aoFullRes&&(e.scene.environment.ambientLight.aoFullRes=!1),void 0===e.scene.environment.ambientLight.radius&&(e.scene.environment.ambientLight.radius=256),void 0===e.scene.environment.ambientLight.bias&&(e.scene.environment.ambientLight.bias=.5),void 0===e.scene.environment.ambientLight.aoColor&&(e.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),A2(e,R2),E2(e,R2)}(e),e.schema=41),t<42&&(function(e){e.scene.objects.traverse(((e,t)=>{t.events.forEach((e=>{"GameControl"===e.type&&Object.assign(e.gameActions,{run:new nJ})}))}))}(e),e.schema=42),t<43&&(function(e){e.scene.objects.traverse(((e,t)=>{t.events.forEach((e=>{"GameControl"===e.type&&(e.keyAssignments=[...e.keyAssignments,["run","\u21e7"],["none","Ctrl"]])}))}))}(e),e.schema=43),t<99){var r;A2(e,L2),E2(e,L2),null===e.scene.publish.playCamera&&(e.scene.publish.playCamera=t1);let t=LJ(e.scene.objects),n=e.scene.objects;e.scene.publish.playPage=r1,n.insertBefore(null,null,[{id:r1,data:u(u({},r2.defaultData),{},{backgroundColor:e.scene.backgroundColor,fog:e.scene.fog,postprocessing:e.scene.postprocessing,ao:mZ(e.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:e.scene.publish.playCamera,gameControlObject:e.scene.publish.gameControlObject},shadow:mZ(e.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:u(u({},j1.defaultData),mZ(e.scene.environment,"usePhysics","gravity")),camera:null!==(r=LJ(e.scene.ownerCamera))&&void 0!==r?r:r2.defaultData.camera,name:"Scene"}),children:[]}]);for(let e of t)e.id!==h2.TRASH_CAN_ID&&n.move(r1,e.fi,e.id);let i=0,s=0;e.shared.penumbraSize&&e.scene.objects.traverse(((t,r)=>{var n;"DirectionalLight"===r.type?(r.penumbraSize=e.shared.penumbraSize[Math.min(i,2)],i+=1):"SpotLight"===r.type&&(r.penumbraSize=e.shared.penumbraSize[3+Math.min(s,1)],s+=1),(void 0===r.physics||null===r.physics)&&"Instance"!==r.type&&(r.physics={},Object.assign(r.physics,l1.defaultData)),void 0!==r.physics&&null!==r.physics&&(r.physics.enabled=null!==(n=r.collision)&&void 0!==n?n:"visibility",delete r.collision)})),e.schema=99}}function B2(e){e.layers&&e.layers.forEach((e=>{"light"===e.type&&void 0===e.alphaOverride&&(e.alphaOverride=1)}))}(e=>{e.defaultData={enabled:!1,useBackgroundColor:!1,color:V0.white,near:.1,far:2e3}})(L1||(L1={})),(e=>{let t={opacity:1,blendFunction:13,enabled:!1};e.defaultData={enabled:!1,pixelation:u(u({},t),{},{blendFunction:16,granularity:15}),bloom:u(u({},t),{},{blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3}),chromaticAberration:u(u({},t),{},{offset:[2,2]}),vignette:u(u({},t),{},{darkness:1,offset:0}),hueSaturation:u(u({},t),{},{hue:3,saturation:0}),brightnessContrast:u(u({},t),{},{brightness:.25,contrast:0}),depthOfField:u(u({},t),{},{focusDistance:100,focalLength:20,bokehScale:5}),noise:u(u({},t),{},{blendFunction:16})}})(N1||(N1={})),(e=>{e.defaultData={softShadowQuality:"low"}})(B1||(B1={})),(e=>{e.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75}})(z1||(z1={})),(e=>{e.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}}})(F1||(F1={})),(e=>{e.defaultData={usePhysics:!1,gravity:-10}})(j1||(j1={})),(e=>{e.defaultData={playCamera:t1,gameControlObject:null}})(U1||(U1={})),(e=>{e.defaultData={backgroundColor:W0.fromHexAndA(2960946,1),postprocessing:N1.defaultData,fog:L1.defaultData,globalPhysics:j1.defaultData,ambient:z1.defaultData,ao:F1.defaultData,shadow:B1.defaultData,publish:U1.defaultData}})(V1||(V1={})),(e=>{e.defaultData={colliderType:"box",size:[100,100,100],colliderHelperVisible:!0,forceType:"collider",forceRange:"global",forceIntensity:.5,forceDambing:.95}})(H1||(H1={})),(e=>{e.isComponentRelated=function(e){return"Component"===e||"Instance"===e},e.isEmptyOrComponent=function(e){return"Empty"===e||"Instance"===e}})(W1||(W1={})),(e=>{e.identity=u(u({},q0.identity),{},{hiddenMatrix:j0.identity}),e.fromObject=function(e){return{position:e.position,rotation:e.rotation,scale:e.scale,hiddenMatrix:e.hiddenMatrix}},e.merge=function(e,t){return{position:(null===t||void 0===t?void 0:t.position)||e.position,rotation:(null===t||void 0===t?void 0:t.rotation)||e.rotation,scale:(null===t||void 0===t?void 0:t.scale)||e.scale,hiddenMatrix:(null===t||void 0===t?void 0:t.hiddenMatrix)||e.hiddenMatrix}},e.diff=function(e,t){return vZ({position:N0.isEqual(e.position,t.position)?void 0:t.position,rotation:N0.isEqual(e.rotation,t.rotation)?void 0:t.rotation,scale:N0.isEqual(e.scale,t.scale)?null:t.scale,hiddenMatrix:j0.isEqual(e.hiddenMatrix,t.hiddenMatrix)?void 0:t.hiddenMatrix})}})(G1||(G1={})),(e=>{e.defaultData=u(u({states:new nJ,events:new nJ,visible:!0,raycastLock:!1,physics:l1.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"}},G1.identity),{},{cloner:null})})(q1||(q1={})),(e=>{e.defaultData=u({type:"Empty"},q1.defaultData)})(X1||(X1={})),(e=>{e.defaultData=u(u({type:"ParticleCollider"},H1.defaultData),q1.defaultData)})(Y1||(Y1={})),(e=>{e.defaultData=u({type:"Component"},q1.defaultData)})(K1||(K1={})),(e=>{e.defaultData=u(u({type:"Particle"},q1.defaultData),o1.defaultData)})(Q1||(Q1={})),(e=>{e.defaultData=u(u({type:"Mesh"},q1.defaultData),h1.defaultData)})(Z1||(Z1={})),(e=>{e.defaultData=u(u(u({},q1.defaultData),G1.identity),{},{position:[0,0,J0.DefaultTargetOffset]},J0.defaultData)})(J1||(J1={})),(e=>{e.defaultData=function(e){return u(u({},q1.defaultData),a1.defaultData(e))},e.defaultDirectionalLightData=u(u({},e.defaultData("DirectionalLight")),{},{position:[200,300,300],name:"Directional Light",intensity:.7})})($1||($1={})),(e=>{function t(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(;r<t.length;){let n=e?e[t[r]]:void 0;if(t.length===r+1)return n;if(!n)return;e=n.descendants,r+=1}}e.resolveWithDes=t,e.resolve=function(e,r){let n=t(e,r,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0);if(n){let e=Object.keys(n);if(1===e.length&&"descendants"===e[0])return}return n}})(e2||(e2={})),(e=>{function t(e,t){return u(u(u({},q1.defaultData),t),{},{component:e,overrides:new cJ,physics:void 0,events:void 0,type:"Instance"})}e.rootOverrideProps=["physics","events"],e.compositeNonOptionalOverrideProps=["geometry"],e.compositeEntireOverrideOverrideProps=["material"],e.ofComponent=t,e.fromComponentData=function(e){let r=G1.fromObject(e.data);return t(e.id,r)}})(t2||(t2={})),(e=>{e.defaultData=u(u(u({type:"Page"},q1.defaultData),{},{physics:u(u({},l1.defaultData),{},{fusedBody:!1})},V1.defaultData),{},{camera:J1.defaultData}),e.isUIPage=function(e){return void 0!==e.uiScene}})(r2||(r2={})),(e=>{e.defaultCamera=u({position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:j0.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:l1.defaultData,states:new nJ,events:new nJ,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0}},J0.defaultData),e.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},e.defaultMeshObject=u(u(u({name:"Rectangle"},q1.defaultData),Z1.defaultData),{},{geometry:I1.defaultData("RectangleGeometry"),material:_1.defaultTwoLayerData("phong","layer1","layer2")}),e.defaultBooleanObject=u(u(u({name:"Boolean"},q1.defaultData),Z1.defaultData),{},{geometry:I1.defaultData("BooleanGeometry"),material:_1.defaultTwoLayerData("phong","layer1","layer2")}),e.defaultShapeBlendObject=u(u(u({name:"Shape Blend"},q1.defaultData),Z1.defaultData),{},{geometry:I1.defaultData("ShapeBlendGeometry"),material:_1.defaultTwoLayerData("phong","layer1","layer2")}),e.defaultTextObject=u(u(u({name:"Text"},q1.defaultData),Z1.defaultData),{},{geometry:I1.defaultData("TextGeometry"),material:_1.defaultTwoLayerData("phong","layer1","layer2")}),e.defaultInputObject=u(u(u({name:"Input"},q1.defaultData),Z1.defaultData),{},{geometry:I1.defaultData("InputGeometry"),material:_1.defaultTwoLayerData("phong","layer1","layer2")})})(n2||(n2={})),(e=>{e.newEmpty=function(e,t){let r={name:t};return"Mesh"===e.type?(r.geometry={},"material"in e&&(r.material={layers:new cJ}),"materials"in e&&(r.materials=e.materials.map((e=>({layers:new cJ}))))):Z0.is(e.type)&&(r.perspective={},r.orthographic={}),r},e.toOps=function(e,t){let r,n=[],i={orthographic:0,perspective:0,geometry:0};function a(e,t){for(let[r,i]of Object.entries(t.layers)){let{texture:t}=i,a=s(i,aL);if(void 0!==t&&Object.keys(t).length>0){let i={path:[...e,"layers",r,"texture"],props:t,type:0};n.push(i)}if(Object.keys(a).length>0){let t={path:[...e,"layers",r],props:a,type:0};n.push(t)}}}for(let[s,o]of Object.entries(t))if("name"!==s)if("cloner"===s)n.push(...e1.toOps(o,["cloner"]));else if("pathSnapping"===s)n.push({path:[s],props:{slide:o.slide,offset:o.offset},type:0});else if("material"===s)a(["material"],o);else if("materials"===s)for(let[e,t]of Object.entries(o))a(["materials",e],t);else if(0===i[s]){if("geometry"===s&&void 0!==o.extrusion){let e={path:[s,"extrusion"],props:o.extrusion,type:0};n.push(e),o=u({},o),delete o.extrusion}if(Object.keys(o).length>0){let e={path:[s],props:o,type:0};n.push(e)}}else void 0===r&&(r={path:[],props:{},type:0},n.push(r)),r.props[s]=o;return n},e.patch=function(e,t){var r,n,i,s,a,o,l,c;if(void 0===t)return e;let h=u({},e);if(Object.assign(h,G1.merge(h,t)),Object.assign(h,{pathSnapping:Object.assign({},h.pathSnapping,{slide:null!==(r=null!==(n=null===(i=t.pathSnapping)||void 0===i?void 0:i.slide)&&void 0!==n?n:null===(s=h.pathSnapping)||void 0===s?void 0:s.slide)&&void 0!==r?r:0,offset:null!==(a=null!==(o=null===(l=t.pathSnapping)||void 0===l?void 0:l.offset)&&void 0!==o?o:null===(c=h.pathSnapping)||void 0===c?void 0:c.offset)&&void 0!==a?a:0})}),Z0.is(e.type)){var d,f;h.orthographic=u({},h.orthographic),h.perspective=u({},h.perspective);let e=t;void 0!==(null===(d=e.orthographic)||void 0===d?void 0:d.zoom)&&(h.orthographic.zoom=e.orthographic.zoom),void 0!==(null===(f=e.perspective)||void 0===f?void 0:f.zoom)&&(h.perspective.zoom=e.perspective.zoom),void 0!==e.isUpVectorFlipped&&(h.isUpVectorFlipped=e.isUpVectorFlipped),void 0!==e.targetOffset&&(h.targetOffset=e.targetOffset)}else if("Mesh"===e.type)"geometry"in t&&Object.assign(h,{geometry:D1.merge(h.geometry,t.geometry)}),(t.material||t.materials)&&(h=function(e,t){if(void 0===t)return e;let r=u({},e);return"material"in r&&"material"in t&&t.material&&(r.material=RJ(r.material,(e=>{if("string"!=typeof e)for(let[r,n]of Object.entries(t.material.layers)){let t=e.layers.data(r);t&&S1.patch(t,n)}})).data),r.materials&&t.materials&&(r.materials=RJ(r.materials,(e=>{for(let i=0;i<r.materials.length;i++){let r=t.materials[i];if("string"!=typeof r)for(let[t,s]of Object.entries(r.layers)){var n;let r=null===(n=e[i])||void 0===n||null===(n=n.layers)||void 0===n?void 0:n.data(t);r&&S1.patch(r,s)}}})).data),r}(h,t)),h.cloner&&"cloner"in t&&Object.assign(h,{cloner:$0.merge(h.cloner,t.cloner)});else if("Empty"===e.type)h.cloner&&"cloner"in t&&Object.assign(h,{cloner:$0.merge(h.cloner,t.cloner)});else if(s1.is(e.type)){let e=t;void 0!==e.intensity&&(h.intensity=e.intensity),void 0!==e.color&&("string"==typeof e.color?h.color=e.color:h.color=V0.clone(e.color))}return h}})(i2||(i2={})),(e=>{e.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,hoverRotateDamping:.125,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0}})(s2||(s2={})),(e=>{e.defaultData={orbitControls:s2.defaultData,playPage:r1,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map(((e,t)=>{let r=0,n=0;return t<5?n=-30:t<10&&(n=30),0===t||10===t||5===t?r=30:(4===t||11===t||9===t)&&(r=-30),[120,[r,n],"show"]})),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1,imageQuality:70}},stopRaycast:!0,hdTransmission:!1}})(a2||(a2={})),(e=>{e.defaultData={id:"basic",label:"Basic",style:"None",prompt:""}})(o2||(o2={})),(e=>{e.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0}})(l2||(l2={})),(e=>{e.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:u({},o2.defaultData),isRandomSeed:!0,seed:e.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:l2.defaultData}),e.generateSeed=()=>Math.round(1e5*Math.random())})(c2||(c2={})),(e=>{e.physicsEnabled=function(e){return void 0!==e.find((e=>"Page"===e.data.type&&e.data.globalPhysics.usePhysics))},e.traverseModuleInstances=function(e,t,r){e.scene.objects.traverseFrom(t,((t,n)=>{if("Instance"===n.type){var i;let s=null===(i=U2.getComponentData(e,n.component))||void 0===i?void 0:i.data;s&&r(t,n,s.events)}else r(t,n,n.events)}))}})(u2||(u2={})),(e=>{function t(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],i=n2.defaultMeshObject;t&&(n.push(u({},e.defaultLight)),n.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:i,children:[]})),n.push(...r);let s=new rJ;return s.push({fi:1,id:r1,data:u(u({},r2.defaultData),{},{name:"Scene 1"}),children:n}),s}function r(t){return u(u({},e.defaultData),{},{objects:yZ(t,rJ.prototype)})}e.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222",e.defaultLight={fi:-1,data:$1.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]},e.createDefaultObjectTreeWithPage=t,e.defaultData={objects:t(),publish:a2.defaultData,styles:c2.defaultData()},e.emptyDataWithoutPage=function(){return{objects:new rJ,publish:a2.defaultData,styles:c2.defaultData()}},e.emptyDataWithPage=function(){return{objects:t(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]),publish:a2.defaultData,styles:c2.defaultData()}},e.emptyData=function(){return{objects:new rJ,publish:u({},a2.defaultData),styles:c2.defaultData()}},e.withObjs=r,e.withObj=function(e,t){return r([{id:e,data:t,children:[],fi:0}])}})(h2||(h2={})),(e=>{e.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}}})(d2||(d2={})),(e=>{e.defaultData=e=>({url:e,name:"New Webhook",parametersSchemas:new nJ}),e.defaultParameterValueByType=e=>"number"===e?0:"boolean"!==e&&""})(f2||(f2={})),(e=>{e.defaultData=function(e){return{url:e,method:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",name:"New API",headers:new nJ,queries:new nJ,autoStart:!0}}})(p2||(p2={})),(e=>{function t(e){return void 0!==e.textValue}function r(e){return"boolean"==typeof e}e.isTextValue=t,e.isNumber=function(e){return"number"==typeof e},e.isBoolean=r,e.typeOfVariable=function(e){return t(e)?"string":r(e)?"boolean":"number"},e.getDisplayedValue=function(t){var r;return e.isTextValue(t)?Array.isArray(t.textValue)?t.textValue.map((e=>{var r;return e.toString().padStart(null!==(r=t.padding)&&void 0!==r?r:2,"0")})).join(null!==(r=t.deliminator)&&void 0!==r?r:":")+(void 0!==t.suffix?" "+t.suffix:""):t.textValue.toString():e.isBoolean(t)?t?"True":"False":e.isNumber(t)?parseFloat(t.toFixed(3)).toString():t.toString()}})(m2||(m2={})),(e=>{e.all=["images","videos","colors","audios","particles","fonts","materials","variables"]})(g2||(g2={})),(e=>{e.all=[...g2.all,"components"]})(v2||(v2={})),(e=>{e.defaultData=function(){return{images:new XZ,videos:new XZ,colors:new XZ,audios:new XZ,particles:new XZ,fonts:new XZ,materials:new XZ,components:new XZ,variables:new XZ,userAPIs:new XZ,userWebhooks:new XZ}}})(y2||(y2={})),(e=>{e.defaultData=function(){return{images:new XZ,videos:new XZ,colors:new XZ,audios:new XZ,particles:new XZ,fonts:new XZ,materials:new XZ,components:new XZ,variables:new XZ,userAPIs:new XZ,userWebhooks:new XZ}}})(b2||(b2={})),(e=>{e.defaultColors=function(){let e={"89b10010-844c-11ec-a8a3-0242ac120002":{r:.5,g:.5,b:.5,a:1,name:"Default Color"}};return yZ(e,XZ.prototype)},e.defaultImages=function(){return yZ({},XZ.prototype)},e.emptyData=function(){return{catelogs:new XZ,materials:new XZ,images:new XZ,videos:new XZ,colors:new XZ,audios:new XZ,particles:new XZ,fonts:new XZ,variables:new nJ,userAPIs:new XZ,userWebhooks:new XZ,lib:b2.defaultData()}},e.defaultVariables=function(e){switch(e){case"number":return{value:0,name:"Number"};case"boolean":return{value:!1,name:"Boolean"};case"string":return{value:{textValue:"String value"},name:"String"};case"time":let t=[0,0,0];return{name:"Time",value:{textValue:t,deliminator:":",padding:2,suffix:"AM"},dynamicVariableType:"time",format:"HH:mm:ss",format12h24h:"12ampm",timeZone:null,hasEnd:!1,endValue:{textValue:t,deliminator:":",padding:2,suffix:"AM"},autoStart:!0,repeat:!1};case"counter":return{name:"Counter",value:0,dynamicVariableType:"counter",updateInterval:1e3,increment:1,autoStart:!0,hasEnd:!0,endValue:60,repeat:!0,randomStart:!1,range:[0,100],decimals:0};case"random":return{name:"Random",value:0,dynamicVariableType:"random",updateInterval:1e3,increment:1,autoStart:!0,isStatic:!1,hasEnd:!0,endValue:60,repeat:!0,min:0,max:100,decimals:0};default:console.error("Unknown variable type",e)}},e.getFormattedTimerTime=function(e,t){if("HH:mm:ss"===t.format){let t=Math.floor(e/3600),r=Math.floor((e-3600*t)/60);return{textValue:[t,r,Math.round(e-3600*t-60*r)]}}if("mm:ss"===t.format){let t=Math.floor(e/60);return{textValue:[t,Math.round(e-60*t)]}}return e="number"===t.format?Math.round(e):Math.round(1e3*e)/1e3}})(w2||(w2={})),(e=>{e.list=["idle","move","jump","run"]})(x2||(x2={})),(e=>{e.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},e.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","\u25b2"],["rotPosY","\u25c0"],["rotNegX","\u25bc"],["rotNegY","\u25b6"],["jump","Space"],["run","\u21e7"],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:e.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new nJ,move:new nJ,jump:new nJ,run:new nJ},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:W0.fromHexAndA(3728051,1)}}})(S2||(S2={}));var z2=180/Math.PI;function F2(e){e.rotation=e.rotation.slice(0,3).map((e=>e*z2))}function j2(e){var t,r,n;F2(e),"Page"===e.type&&F2(e.camera),null===(t=e.states)||void 0===t||t.forEach((e=>{void 0===e.rotation||null===e.rotation||(e.rotation=e.rotation.slice(0,3).map((e=>e*z2)))}));let i=e.geometry;i&&"SphereGeometry"===i.type&&(i.thetaLength=(null!==(r=i.thetaLength)&&void 0!==r?r:180)*z2),i&&"TorusGeometry"===i.type&&(i.arc=i.arc*z2),i&&"PathGeometry"===i.type&&(i.extrusion.angle*=z2,i.extrusion.twist*=z2),"Mesh"===e.type&&"TextGeometry"===e.geometry.type&&(e.geometry.text={textValue:e.geometry.text}),Array.isArray(LJ(e.events))&&(null===(n=e.events)||void 0===n||n.forEach((e=>{("MouseDown"===e.type||"MouseUp"===e.type||"MousePress"===e.type||"KeyDown"===e.type||"KeyUp"===e.type||"KeyPress"===e.type||"Collision"===e.type||"Trigger"===e.type)&&(e.runMode=e.toggle?"Toggle":"Repeat")})))}var U2,V2,H2,W2,G2,q2,X2,Y2,K2,Q2,Z2,J2,$2,e3,t3,r3,n3,i3,s3,a3,o3=115;function l3(e,t){t(e.data);for(let r of e.children)l3(r,t)}function c3(e){var t;let r=null!==(t=e.schema)&&void 0!==t?t:104;r!==o3&&r<105&&(l3(e.asset,j2),e.schema=105)}function u3(e){var t;let r=null!==(t=e.schema)&&void 0!==t?t:0;if(r!==o3){console.warn("updating from ",r,"to ",o3),N2(e,r),r<100&&(void 0===e.scene.publish.joystickSizeAndXYOffset&&(e.scene.publish.joystickSizeAndXYOffset=a2.defaultData.joystickSizeAndXYOffset),e.schema=100),r<101&&(A2(e,B2),E2(e,B2),e.schema=101),r<102&&(function(e){e.scene.objects.traverse(((e,t)=>{let r=t.geometry;r&&"PathGeometry"===r.type&&(r.extrusion.capType="flat",r.extrusion.bevel=50,r.extrusion.bevelSides=6,"Custom"===r.extrusion.shape.type&&(r.extrusion.shape.shapeQuality="low"))}))}(e),e.schema=102),r<104&&(e.shared.catelogs=new XZ,e.shared.lib=b2.defaultData(),e.schema=104),r<105&&(function(e){e.shared.variables=yZ({},XZ.prototype)}(e),e.scene.objects.traverse(((e,t)=>{j2(t)})),e.schema=105);for(let t of Object.values(e.shared.lib.components))c3(t);r<106&&(function(e){let t=LJ(e.shared.variables);e.shared.variables=yZ(Object.entries(null!==t&&void 0!==t?t:{}).map(((e,t)=>{let[r,n]=e;return{fi:t,id:r,data:n}})),nJ.prototype)}(e),e.schema=106),r<107&&(e.shared.lib.variables=b2.defaultData().variables,e.schema=107),r<109&&(function(e){e.shared.particles=yZ({},XZ.prototype),e.shared.lib&&(e.shared.lib.particles=b2.defaultData().particles)}(e),e.schema=109),r<110&&(function(e){e.scene.objects.traverse(((e,t)=>{"Particle"===t.type&&"number"==typeof t.renderMaterial.size&&Object.assign(t.renderMaterial,{size:[t.renderMaterial.size,t.renderMaterial.size]})}))}(e),e.schema=110),r<111&&(e.scene.objects.traverse(((e,t)=>{!function(e){var t;Array.isArray(LJ(e.events))&&(null===(t=e.events)||void 0===t||t.forEach((e=>{"disabled"in e||(e.disabled=!1),("MouseDown"===e.type||"MouseUp"===e.type||"MousePress"===e.type)&&(e.mode=e.mode||"Object")})))}(t)})),e.schema=111),r<112&&(function(e){e.scene.objects.traverse(((e,t)=>{"Page"===t.type&&(t.postprocessing.depthOfField.focusDistance=100,t.postprocessing.depthOfField.focalLength=20,t.postprocessing.depthOfField.bokehScale=5)}))}(e),e.schema=112),r<113&&(function(e){e.scene.objects.traverse(((e,t)=>{var r;!1!==Array.isArray(LJ(t.events))&&(null===(r=t.events)||void 0===r||r.forEach((e=>{var t,r,n,i,s,a,o,l,c;let u=e.runMode;"MouseDown"===e.type||"MouseUp"===e.type||"KeyDown"===e.type||"KeyUp"===e.type||"Collision"===e.type||"Trigger"===e.type?null===(t=e.actions)||void 0===t||t.forEach((e=>{"Transition"===e.type&&(e.runMode=null!==u&&void 0!==u?u:"Repeat"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle"===u?"Toggle":"Normal")})):"MouseHover"===e.type||"MousePress"===e.type||"KeyPress"===e.type?null===(r=e.actions)||void 0===r||r.forEach((e=>{("Transition"===e.type||"Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle")})):"GameControl"===e.type?(delete e.actions,Object.keys(e.gameActions).forEach((t=>{var r;null===(r=e.gameActions[t])||void 0===r||r.forEach((e=>{"Transition"===e.type&&(e.runMode="Repeat"),"Animation"===e.type&&(e.runMode="Normal")}))}))):"DragDrop"===e.type?(delete e.actions,null!==(n=e.dragDropActions)&&void 0!==n&&null!==(n=n.drag)&&void 0!==n&&n.forEach((e=>{("Transition"===e.type||"Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle")})),null===(i=e.dragDropActions)||void 0===i||null===(i=i.drop)||void 0===i||i.forEach((e=>{("Transition"===e.type||"Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle")}))):"Resize"===e.type?(delete e.actions,null===(s=e.breakpoints)||void 0===s||s.forEach((e=>{var t;null===(t=e.actions)||void 0===t||t.forEach((e=>{("Transition"===e.type||"Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle")}))}))):"Start"===e.type?null===(a=e.actions)||void 0===a||a.forEach((e=>{"Transition"===e.type&&(e.runMode="Once"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Normal")})):"VariableChange"===e.type||"Scroll"===e.type?null===(o=e.actions)||void 0===o||o.forEach((e=>{"Transition"===e.type&&(e.runMode="Repeat"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Normal")})):"Conditional"===e.type&&(delete e.actions,null!==(l=e.inActions)&&void 0!==l&&l.forEach((e=>{"Transition"===e.type&&(e.runMode="Repeat"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Normal")})),null===(c=e.outActions)||void 0===c||c.forEach((e=>{"Transition"===e.type&&(e.runMode="Repeat"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Normal")})))})))}))}(e),e.schema=113),r<114&&(void 0===e.scene.publish.settings.web.imageQuality&&(e.scene.publish.settings.web.imageQuality=70),e.schema=114),r<115&&(function(e){e.shared.userAPIs=yZ({},XZ.prototype),e.shared.userWebhooks=yZ({},XZ.prototype),e.shared.lib&&(e.shared.lib.userAPIs=b2.defaultData().userAPIs,e.shared.lib.userWebhooks=b2.defaultData().userWebhooks)}(e),e.schema=115)}}function h3(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=null!==e[0].index,n=new Set(Object.keys(e[0].attributes)),i=new Set(Object.keys(e[0].morphAttributes)),s={},a={},o=e[0].morphTargetsRelative,l=new iF,c=0;for(let u=0;u<e.length;++u){let h=e[u],d=0;if(r!==(null!==h.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let e in h.attributes){if(!n.has(e))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+e+'" attribute exists among all geometries, or in none of them.'),null;void 0===s[e]&&(s[e]=[]),s[e].push(h.attributes[e]),d++}if(d!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(o!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let e in h.morphAttributes){if(!i.has(e))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===a[e]&&(a[e]=[]),a[e].push(h.morphAttributes[e])}if(t){let e;if(r)e=h.index.count;else{if(void 0===h.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;e=h.attributes.position.count}l.addGroup(c,e,u),c+=e}}if(r){let t=0,r=[];for(let n=0;n<e.length;++n){let i=e[n].index;for(let e=0;e<i.count;++e)r.push(i.getX(e)+t);t+=e[n].attributes.position.count}l.setIndex(r)}for(let u in s){let e=d3(s[u]);if(!e)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" attribute."),null;l.setAttribute(u,e)}for(let u in a){let e=a[u][0].length;if(0===e)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[u]=[];for(let t=0;t<e;++t){let e=[];for(let n=0;n<a[u].length;++n)e.push(a[u][n][t]);let r=d3(e);if(!r)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" morphAttribute."),null;l.morphAttributes[u].push(r)}}return l}function d3(e){let t,r,n,i=0;for(let o=0;o<e.length;++o){let s=e[o];if(s.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===t&&(t=s.array.constructor),t!==s.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===r&&(r=s.itemSize),r!==s.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===n&&(n=s.normalized),n!==s.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;i+=s.array.length}let s=new t(i),a=0;for(let o=0;o<e.length;++o)s.set(e[o].array,a),a+=e[o].array.length;return new Xz(s,r,n)}(e=>{e.defaultData={schema:o3,scene:h2.defaultData,frames:(new XZ).add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",d2.defaultData),shared:u(u({},w2.emptyData()),{},{colors:w2.defaultColors()})},e.emptyDataForImports=function(){let e=h2.emptyDataWithPage();return{schema:o3,scene:e,frames:(new XZ).add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",d2.defaultData),shared:u(u({},w2.emptyData()),{},{colors:w2.defaultColors(),images:w2.defaultImages()})}},e.emptyData=function(){return{schema:o3,scene:h2.emptyDataWithPage(),frames:(new XZ).add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",d2.defaultData),shared:w2.emptyData()}},e.clipboard2dData=function(){return{schema:o3,scene:h2.emptyData(),frames:new XZ,shared:w2.emptyData()}},e.collabHelper=u(u({},lJ),{},{updateSchema(e){var t,r;return(null!==(t=e.schema)&&void 0!==t?t:0)<o3?RJ(e,u3):(null!==(r=e.schema)&&void 0!==r?r:0)-o3}}),e.updateSchemaDirectly=function(t){let r=e.collabHelper.updateSchema(t);return"number"==typeof r?0===r?t:null:r.data},e.withoutLib=function(e){return u(u({},e),{},{shared:u(u({},e.shared),{},{lib:b2.defaultData()})})},e.getComponentData=function(e,t){let r=e.scene.objects.get(t);if(r&&"Component"===r.data.type)return r;{let r=e.shared.lib.components[t];if(r)return r.asset}},e.hasSensitiveData=function(e){let t=Object.values(e.shared.userAPIs);for(let r of t){let e=r.headers;for(let t of e)if("authorization"===t.data.key.toLowerCase()&&""!==t.data.value)return!0}return!1}})(U2||(U2={})),(e=>{e.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"}})(V2||(V2={})),(e=>{e.is=function(e){return!0}})(H2||(H2={})),(e=>{e.defaultData={position:[0,0],scale:[1,1],rotation:0,shear:[0,0]},e.merge=function(e,t){var r,n,i,s;return{position:null!==(r=null===t||void 0===t?void 0:t.position)&&void 0!==r?r:e.position,rotation:null!==(n=null===t||void 0===t?void 0:t.rotation)&&void 0!==n?n:e.rotation,scale:null!==(i=null===t||void 0===t?void 0:t.scale)&&void 0!==i?i:e.scale,shear:null!==(s=null===t||void 0===t?void 0:t.shear)&&void 0!==s?s:e.shear}},e.diff=function(e,t){return vZ({position:L0.isEqual(e.position,t.position)?void 0:t.position,rotation:e.rotation===t.rotation?void 0:t.rotation,scale:L0.isEqual(e.scale,t.scale)?void 0:t.scale,shear:e.shear&&t.shear&&L0.isEqual(e.shear,t.shear)?void 0:t.shear})}})(W2||(W2={})),(e=>{e.defaultData={horizontalConstraint:0,verticalConstraint:0}})(G2||(G2={})),(e=>{e.defaultData={direction:"row",wrap:"unwrap",align:"top-left",gap:10,rowGap:10,autoGap:!1,autoRowGap:!1,leftPadding:8,rightPadding:8,topPadding:8,bottomPadding:8}})(q2||(q2={})),(e=>{e.defaultData={opacity:1,fill:{color:W0.fromHexAndA(n1,1),enabled:!0},stroke:{color:W0.from0to1([0,0,0,1]),thickness:1,enabled:!1,mode:"inside"},layerBlur:{radius:2,enabled:!1},backgroundBlur:{radius:2,enabled:!1},dropShadow:{offset:[10,10],blurRadius:10,color:W0.from0to1([0,0,0,1]),enabled:!1,spread:0},innerShadow:{offset:[10,10],blurRadius:10,color:W0.from0to1([0,0,0,1]),enabled:!1,spread:0}}})(X2||(X2={})),(e=>{e.newEmpty=function(e,t){return{name:t}},e.patch=function(e,t){if(void 0===t)return e;let r=u({},e);return Object.assign(r,W2.merge(r,t)),r=function(e,t){if(void 0===t)return e;let r=u({},e),n=["width","height","cornerRadius"];for(let i of n)i in r&&i in t&&void 0!==t[i]&&Object.assign(r,{[i]:t[i]});return r}(r,t),r=function(e,t){if(void 0===t)return e;let r=u({},e);return"fill"in r&&"fill"in t&&void 0!==t.fill&&Object.assign(r,{fill:u(u({},r.fill),t.fill)}),"stroke"in r&&"stroke"in t&&void 0!==t.stroke&&Object.assign(r,{stroke:u(u({},r.stroke),t.stroke)}),"layerBlur"in r&&"layerBlur"in t&&void 0!==t.layerBlur&&Object.assign(r,{layerBlur:u(u({},r.layerBlur),t.layerBlur)}),"backgroundBlur"in r&&"backgroundBlur"in t&&void 0!==t.backgroundBlur&&Object.assign(r,{backgroundBlur:u(u({},r.backgroundBlur),t.backgroundBlur)}),"dropShadow"in r&&"dropShadow"in t&&void 0!==t.dropShadow&&Object.assign(r,{dropShadow:u(u({},r.dropShadow),t.dropShadow)}),"innerShadow"in r&&"innerShadow"in t&&void 0!==t.innerShadow&&Object.assign(r,{innerShadow:u(u({},r.innerShadow),t.innerShadow)}),r}(r,t),r},e.toOps=function(e,t){let r,n=[];for(let[i,s]of Object.entries(t))"name"!==i&&(void 0===r&&(r={path:[],props:{},type:0},n.push(r)),r.props[i]=s);return n}})(Y2||(Y2={})),(e=>{e.defaultData=u(u(u({},W2.defaultData),G2.defaultData),{},{states:new nJ,events:new nJ,visible:!0,raycastLock:!1})})(K2||(K2={})),(e=>{e.defaultData=u(u({},K2.defaultData),X2.defaultData)})(Q2||(Q2={})),(e=>{e.defaultData={cornerRadius:[0,0,0,0]}})(Z2||(Z2={})),(e=>{e.defaultData=u(u({},Q2.defaultData),{},{type:"ellipse2d",width:100,height:100,name:"Ellipse"})})(J2||(J2={})),(e=>{e.defaultData=u(u(u({},Q2.defaultData),Z2.defaultData),{},{type:"rectangle2d",width:100,height:100,name:"Rectangle"})})($2||($2={})),(e=>{e.defaultData=u(u({},Q2.defaultData),{},{type:"text2d",width:100,height:100,fontSize:12,lineHeight:1.2,letterSpacing:0,text:{textValue:"Hello world"},horizontalAlign:1,verticalAlign:1,textTransform:1,font:"Roboto_regular",name:"Text"})})(e3||(e3={})),(e=>{e.defaultData=u(u({},Q2.defaultData),{},{type:"path2d",path:"",name:"Path"})})(t3||(t3={})),(e=>{e.is=function(e){return"ellipse2d"===e.type||"rectangle2d"===e.type||"text2d"===e.type||"vector2d"===e.type||"path2d"===e.type}})(r3||(r3={})),(e=>{e.defaultData=u(u({},K2.defaultData),{},{name:"Group",type:"group2d"})})(n3||(n3={})),(e=>{e.defaultData=()=>u(u(u(u({},K2.defaultData),Z2.defaultData),X2.defaultData),{},{name:"Frame",type:"frame2d",clipped:!0,width:200,height:200,fill:{color:W0.fromHexAndA(4737101,1),enabled:!0},stroke:{color:W0.fromHexAndA(0,1),thickness:1,enabled:!1,mode:"inside"},backgroundBlur:{radius:2,enabled:!1},layerBlur:{radius:2,enabled:!1}})})(i3||(i3={})),(e=>{e.defaultData=function(e){switch(e){case"rectangle2d":case"vector2d":return u({},$2.defaultData);case"ellipse2d":return u({},J2.defaultData);case"text2d":return u({},e3.defaultData);case"path2d":return u({},t3.defaultData);case"frame2d":return u({},i3.defaultData());case"group2d":return u({},n3.defaultData)}},e.getPivot=function(e){return"width"in e&&"height"in e?["number"==typeof e.width?.5*e.width:0,"number"==typeof e.height?.5*e.height:0]:[0,0]},e.isResizeable=function(e){return"rectangle2d"===e.type||"ellipse2d"===e.type||"text2d"===e.type||"frame2d"===e.type},e.isAutoLayoutable=function(e){return"frame2d"===e.type&&void 0!==e.autoLayout},e.hasCorners=function(e){return"rectangle2d"===e.type||"frame2d"===e.type}})(s3||(s3={})),(e=>{e.defaultData={name:"UI",type:"scene2d",objects:new rJ},e.emptyData=function(){return{type:"scene2d",objects:new rJ}}})(a3||(a3={}));var f3=Math.pow(2,-24),p3=class{constructor(){}};function m3(e,t,r){return r.min.x=t[e],r.min.y=t[e+1],r.min.z=t[e+2],r.max.x=t[e+3],r.max.y=t[e+4],r.max.z=t[e+5],r}function g3(e){let t=-1,r=-1/0;for(let n=0;n<3;n++){let i=e[n+3]-e[n];i>r&&(r=i,t=n)}return t}function v3(e,t){t.set(e)}function y3(e,t,r){let n,i;for(let s=0;s<3;s++){let a=s+3;n=e[s],i=t[s],r[s]=n<i?n:i,n=e[a],i=t[a],r[a]=n>i?n:i}}function b3(e,t,r){for(let n=0;n<3;n++){let i=t[e+2*n],s=t[e+2*n+1],a=i-s,o=i+s;a<r[n]&&(r[n]=a),o>r[n+3]&&(r[n+3]=o)}}function w3(e){let t=e[3]-e[0],r=e[4]-e[1],n=e[5]-e[2];return 2*(t*r+r*n+n*t)}function x3(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,u=-1/0,h=1/0,d=1/0,f=1/0,p=-1/0,m=-1/0,g=-1/0,v=null!==i;for(let y=6*t,b=6*(t+r);y<b;y+=6){let t=e[y+0],r=e[y+1],n=t-r,i=t+r;n<s&&(s=n),i>l&&(l=i),v&&t<h&&(h=t),v&&t>p&&(p=t);let b=e[y+2],w=e[y+3],x=b-w,S=b+w;x<a&&(a=x),S>c&&(c=S),v&&b<d&&(d=b),v&&b>m&&(m=b);let _=e[y+4],C=e[y+5],E=_-C,A=_+C;E<o&&(o=E),A>u&&(u=A),v&&_<f&&(f=_),v&&_>g&&(g=_)}n[0]=s,n[1]=a,n[2]=o,n[3]=l,n[4]=c,n[5]=u,v&&(i[0]=h,i[1]=d,i[2]=f,i[3]=p,i[4]=m,i[5]=g)}var S3=32,_3=(e,t)=>e.candidate-t.candidate,C3=new Array(S3).fill().map((()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0}))),E3=new Float32Array(6);function A3(e,t){function r(e){d&&d(e/f)}function n(t,i,d){let f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,m=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!p&&m>=l&&(p=!0,c&&(console.warn("MeshBVH: Max depth of ".concat(l," reached when generating BVH. Consider increasing maxDepth.")),console.warn(e))),d<=u||m>=l)return r(i+d),t.offset=i,t.count=d,t;let g=function(e,t,r,n,i,s){let a=-1,o=0;if(0===s)a=g3(t),-1!==a&&(o=(t[a]+t[a+3])/2);else if(1===s)a=g3(e),-1!==a&&(o=function(e,t,r,n){let i=0;for(let s=t,a=t+r;s<a;s++)i+=e[6*s+2*n];return i/r}(r,n,i,a));else if(2===s){let s=w3(e),l=1.25*i,c=6*n,u=6*(n+i);for(let e=0;e<3;e++){let n=t[e],h=(t[e+3]-n)/S3;if(i<8){let t=[...C3];t.length=i;let n=0;for(let i=c;i<u;i+=6,n++){let s=t[n];s.candidate=r[i+2*e],s.count=0;let{bounds:a,leftCacheBounds:o,rightCacheBounds:l}=s;for(let e=0;e<3;e++)l[e]=1/0,l[e+3]=-1/0,o[e]=1/0,o[e+3]=-1/0,a[e]=1/0,a[e+3]=-1/0;b3(i,r,a)}t.sort(_3);let h=i;for(let e=0;e<h;e++){let r=t[e];for(;e+1<h&&t[e+1].candidate===r.candidate;)t.splice(e+1,1),h--}for(let i=c;i<u;i+=6){let n=r[i+2*e];for(let e=0;e<h;e++){let s=t[e];n>=s.candidate?b3(i,r,s.rightCacheBounds):(b3(i,r,s.leftCacheBounds),s.count++)}}for(let r=0;r<h;r++){let n=t[r],c=n.count,u=i-n.count,h=n.leftCacheBounds,d=n.rightCacheBounds,f=0;0!==c&&(f=w3(h)/s);let p=0;0!==u&&(p=w3(d)/s);let m=1+1.25*(f*c+p*u);m<l&&(a=e,l=m,o=n.candidate)}}else{for(let e=0;e<S3;e++){let t=C3[e];t.count=0,t.candidate=n+h+e*h;let r=t.bounds;for(let e=0;e<3;e++)r[e]=1/0,r[e+3]=-1/0}for(let i=c;i<u;i+=6){let t=~~((r[i+2*e]-n)/h);t>=S3&&(t=31);let s=C3[t];s.count++,b3(i,r,s.bounds)}let t=C3[31];v3(t.bounds,t.rightCacheBounds);for(let e=30;e>=0;e--){let t=C3[e],r=C3[e+1];y3(t.bounds,r.rightCacheBounds,t.rightCacheBounds)}let d=0;for(let r=0;r<31;r++){let t=C3[r],n=t.count,c=t.bounds,u=C3[r+1].rightCacheBounds;0!==n&&(0===d?v3(c,E3):y3(c,E3,E3)),d+=n;let h=0,f=0;0!==d&&(h=w3(E3)/s);let p=i-d;0!==p&&(f=w3(u)/s);let m=1+1.25*(h*d+f*p);m<l&&(a=e,l=m,o=t.candidate)}}}}else console.warn("MeshBVH: Invalid build strategy value ".concat(s," used."));return{axis:a,pos:o}}(t.boundingData,f,a,i,d,h);if(-1===g.axis)return r(i+d),t.offset=i,t.count=d,t;let v=function(e,t,r,n,i){let s=r,a=r+n-1,o=i.pos,l=2*i.axis;for(;;){for(;s<=a&&t[6*s+l]<o;)s++;for(;s<=a&&t[6*a+l]>=o;)a--;if(!(s<a))return s;for(let r=0;r<3;r++){let n=e[3*s+r];e[3*s+r]=e[3*a+r],e[3*a+r]=n;let i=t[6*s+2*r+0];t[6*s+2*r+0]=t[6*a+2*r+0],t[6*a+2*r+0]=i;let o=t[6*s+2*r+1];t[6*s+2*r+1]=t[6*a+2*r+1],t[6*a+2*r+1]=o}s++,a--}}(o,a,i,d,g);if(v===i||v===i+d)r(i+d),t.offset=i,t.count=d;else{t.splitAxis=g.axis;let e=new p3,r=i,o=v-i;t.left=e,e.boundingData=new Float32Array(6),x3(a,r,o,e.boundingData,s),n(e,r,o,s,m+1);let l=new p3,c=v,u=d-o;t.right=l,l.boundingData=new Float32Array(6),x3(a,c,u,l.boundingData,s),n(l,c,u,s,m+1)}return t}!function(e,t){if(!e.index){let r,n=e.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;r=n>65535?new Uint32Array(new i(4*n)):new Uint16Array(new i(2*n)),e.setIndex(new Xz(r,1));for(let e=0;e<n;e++)r[e]=e}}(e,t);let i=new Float32Array(6),s=new Float32Array(6),a=function(e,t){let r=e.attributes.position,n=e.index.array,i=n.length/3,s=new Float32Array(6*i),a=r.normalized,o=r.array,l=r.offset||0,c=3;r.isInterleavedBufferAttribute&&(c=r.data.stride);let u=["getX","getY","getZ"];for(let h=0;h<i;h++){let e,i,d,f=3*h,p=6*h;a?(e=n[f+0],i=n[f+1],d=n[f+2]):(e=n[f+0]*c+l,i=n[f+1]*c+l,d=n[f+2]*c+l);for(let n=0;n<3;n++){let l,c,h;a?(l=r[u[n]](e),c=r[u[n]](i),h=r[u[n]](d)):(l=o[e+n],c=o[i+n],h=o[d+n]);let f=l;c<f&&(f=c),h<f&&(f=h);let m=l;c>m&&(m=c),h>m&&(m=h);let g=(m-f)/2,v=2*n;s[p+v+0]=f+g,s[p+v+1]=g+(Math.abs(f)+g)*f3,f<t[n]&&(t[n]=f),m>t[n+3]&&(t[n+3]=m)}}return s}(e,i),o=e.index.array,l=t.maxDepth,c=t.verbose,u=t.maxLeafTris,h=t.strategy,d=t.onProgress,f=e.index.count/3,p=!1,m=[],g=function(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];let t=[],r=new Set;for(let i of e.groups)r.add(i.start),r.add(i.start+i.count);let n=Array.from(r.values()).sort(((e,t)=>e-t));for(let i=0;i<n.length-1;i++){let e=n[i],r=n[i+1];t.push({offset:e/3,count:(r-e)/3})}return t}(e);if(1===g.length){let e=g[0],t=new p3;t.boundingData=i,function(e,t,r,n){let i=1/0,s=1/0,a=1/0,o=-1/0,l=-1/0,c=-1/0;for(let u=6*t,h=6*(t+r);u<h;u+=6){let t=e[u+0];t<i&&(i=t),t>o&&(o=t);let r=e[u+2];r<s&&(s=r),r>l&&(l=r);let n=e[u+4];n<a&&(a=n),n>c&&(c=n)}n[0]=i,n[1]=s,n[2]=a,n[3]=o,n[4]=l,n[5]=c}(a,e.offset,e.count,s),n(t,e.offset,e.count,s),m.push(t)}else for(let v of g){let e=new p3;e.boundingData=new Float32Array(6),x3(a,v.offset,v.count,e.boundingData,s),n(e,v.offset,v.count,s),m.push(e)}return m}var M3=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let r=1/0,n=-1/0;for(let i=0,s=e.length;i<s;i++){let s=e[i][t];r=s<r?s:r,n=s>n?s:n}this.min=r,this.max=n}setFromPoints(e,t){let r=1/0,n=-1/0;for(let i=0,s=t.length;i<s;i++){let s=t[i],a=e.dot(s);r=a<r?a:r,n=a>n?a:n}this.min=r,this.max=n}isSeparated(e){return this.min>e.max||e.min>this.max}};M3.prototype.setFromBox=function(){let e=new PB;return function(t,r){let n=r.min,i=r.max,s=1/0,a=-1/0;for(let o=0;o<=1;o++)for(let r=0;r<=1;r++)for(let l=0;l<=1;l++){e.x=n.x*o+i.x*(1-o),e.y=n.y*r+i.y*(1-r),e.z=n.z*l+i.z*(1-l);let c=t.dot(e);s=Math.min(c,s),a=Math.max(c,a)}this.min=s,this.max=a}}();!function(){let e=new M3}();var T3=function(){let e=new PB,t=new PB,r=new PB;return function(n,i,s){let a=n.start,o=e,l=i.start,c=t;r.subVectors(a,l),e.subVectors(n.end,n.start),t.subVectors(i.end,i.start);let u,h,d=r.dot(c),f=c.dot(o),p=c.dot(c),m=r.dot(o),g=o.dot(o)*p-f*f;u=0!==g?(d*f-m*p)/g:0,h=(d+u*f)/p,s.x=u,s.y=h}}(),P3=function(){let e=new eB,t=new PB,r=new PB;return function(n,i,s,a){T3(n,i,e);let o=e.x,l=e.y;if(o>=0&&o<=1&&l>=0&&l<=1)return n.at(o,s),void i.at(l,a);if(o>=0&&o<=1)return l<0?i.at(0,a):i.at(1,a),void n.closestPointToPoint(a,!0,s);if(l>=0&&l<=1)return o<0?n.at(0,s):n.at(1,s),void i.closestPointToPoint(s,!0,a);{let e,c;e=o<0?n.start:n.end,c=l<0?i.start:i.end;let u=t,h=r;return n.closestPointToPoint(c,!0,t),i.closestPointToPoint(e,!0,r),u.distanceToSquared(c)<=h.distanceToSquared(e)?(s.copy(u),void a.copy(c)):(s.copy(e),void a.copy(h))}}}(),k3=function(){let e=new PB,t=new PB,r=new LF,n=new pG;return function(i,s){let{radius:a,center:o}=i,{a:l,b:c,c:u}=s;if(n.start=l,n.end=c,n.closestPointToPoint(o,!0,e).distanceTo(o)<=a||(n.start=l,n.end=u,n.closestPointToPoint(o,!0,e).distanceTo(o)<=a)||(n.start=c,n.end=u,n.closestPointToPoint(o,!0,e).distanceTo(o)<=a))return!0;let h=s.getPlane(r);if(Math.abs(h.distanceToPoint(o))<=a){let e=h.projectPoint(o,t);if(s.containsPoint(e))return!0}return!1}}();function D3(e){return Math.abs(e)<1e-15}var I3=class extends Uz{constructor(){super(...arguments),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map((()=>new PB)),this.satBounds=new Array(4).fill().map((()=>new M3)),this.points=[this.a,this.b,this.c],this.sphere=new QB,this.plane=new LF,this.needsUpdate=!0}intersectsSphere(e){return k3(e,this)}update(){let e=this.a,t=this.b,r=this.c,n=this.points,i=this.satAxes,s=this.satBounds,a=i[0],o=s[0];this.getNormal(a),o.setFromPoints(a,n);let l=i[1],c=s[1];l.subVectors(e,t),c.setFromPoints(l,n);let u=i[2],h=s[2];u.subVectors(t,r),h.setFromPoints(u,n);let d=i[3],f=s[3];d.subVectors(r,e),f.setFromPoints(d,n),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}};I3.prototype.closestPointToSegment=function(){let e=new PB,t=new PB,r=new pG;return function(n){let i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,{start:o,end:l}=n,c=this.points,u=1/0;for(let h=0;h<3;h++){let o=(h+1)%3;r.start.copy(c[h]),r.end.copy(c[o]),P3(r,n,e,t),i=e.distanceToSquared(t),i<u&&(u=i,s&&s.copy(e),a&&a.copy(t))}return this.closestPointToPoint(o,e),i=o.distanceToSquared(e),i<u&&(u=i,s&&s.copy(e),a&&a.copy(o)),this.closestPointToPoint(l,e),i=l.distanceToSquared(e),i<u&&(u=i,s&&s.copy(e),a&&a.copy(l)),Math.sqrt(u)}}(),I3.prototype.intersectsTriangle=function(){let e=new I3,t=new Array(3),r=new Array(3),n=new M3,i=new M3,s=new PB,a=new PB,o=new PB,l=new PB,c=new pG,u=new pG,h=new pG;return function(d){let f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,p=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.needsUpdate&&this.update(),d.isExtendedTriangle?d.needsUpdate&&d.update():(e.copy(d),e.update(),d=e);let m=this.plane,g=d.plane;if(Math.abs(m.normal.dot(g.normal))>1-1e-10){let e=this.satBounds,a=this.satAxes;r[0]=d.a,r[1]=d.b,r[2]=d.c;for(let t=0;t<4;t++){let i=e[t],s=a[t];if(n.setFromPoints(s,r),i.isSeparated(n))return!1}let o=d.satBounds,l=d.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let r=0;r<4;r++){let e=o[r],i=l[r];if(n.setFromPoints(i,t),e.isSeparated(n))return!1}for(let c=0;c<4;c++){let e=a[c];for(let a=0;a<4;a++){let o=l[a];if(s.crossVectors(e,o),n.setFromPoints(s,t),i.setFromPoints(s,r),n.isSeparated(i))return!1}}return f&&(p||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),f.start.set(0,0,0),f.end.set(0,0,0)),!0}{let e=this.points,t=!1,r=0;for(let o=0;o<3;o++){let n=e[o],i=e[(o+1)%3];c.start.copy(n),c.end.copy(i),c.delta(a);let s=t?u.start:u.end,l=D3(g.distanceToPoint(n));if(D3(g.normal.dot(a))&&l){u.copy(c),r=2;break}if((g.intersectLine(c,s)||l)&&!D3(s.distanceTo(i))){if(r++,t)break;t=!0}}if(1===r&&d.containsPoint(u.end))return f&&(f.start.copy(u.end),f.end.copy(u.end)),!0;if(2!==r)return!1;let n=d.points,i=!1,s=0;for(let a=0;a<3;a++){let e=n[a],t=n[(a+1)%3];c.start.copy(e),c.end.copy(t),c.delta(o);let r=i?h.start:h.end,l=D3(m.distanceToPoint(e));if(D3(m.normal.dot(o))&&l){h.copy(c),s=2;break}if((m.intersectLine(c,r)||l)&&!D3(r.distanceTo(t))){if(s++,i)break;i=!0}}if(1===s&&this.containsPoint(h.end))return f&&(f.start.copy(h.end),f.end.copy(h.end)),!0;if(2!==s)return!1;if(u.delta(a),h.delta(o),a.dot(o)<0){let e=h.start;h.start=h.end,h.end=e}let p=u.start.dot(a),v=u.end.dot(a),y=h.start.dot(a),b=h.end.dot(a);return(p===b||y===v||v<y!==p<b)&&(f&&(l.subVectors(u.start,h.start),l.dot(a)>0?f.start.copy(u.start):f.start.copy(h.start),l.subVectors(u.end,h.end),l.dot(a)<0?f.end.copy(u.end):f.end.copy(h.end)),!0)}}}(),I3.prototype.distanceToPoint=function(){let e=new PB;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),I3.prototype.distanceToTriangle=function(){let e=new PB,t=new PB,r=["a","b","c"],n=new pG,i=new pG;return function(s){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=a||o?n:null;if(this.intersectsTriangle(s,l))return(a||o)&&(a&&l.getCenter(a),o&&l.getCenter(o)),0;let c=1/0;for(let t=0;t<3;t++){let n,i=r[t],l=s[i];this.closestPointToPoint(l,e),n=l.distanceToSquared(e),n<c&&(c=n,a&&a.copy(e),o&&o.copy(l));let u=this[i];s.closestPointToPoint(u,e),n=u.distanceToSquared(e),n<c&&(c=n,a&&a.copy(u),o&&o.copy(e))}for(let u=0;u<3;u++){let l=r[u],h=r[(u+1)%3];n.set(this[l],this[h]);for(let u=0;u<3;u++){let l=r[u],h=r[(u+1)%3];i.set(s[l],s[h]),P3(n,i,e,t);let d=e.distanceToSquared(t);d<c&&(c=d,a&&a.copy(e),o&&o.copy(t))}}return Math.sqrt(c)}}();var O3=class{constructor(e,t,r){this.isOrientedBox=!0,this.min=new PB,this.max=new PB,this.matrix=new sz,this.invMatrix=new sz,this.points=new Array(8).fill().map((()=>new PB)),this.satAxes=new Array(3).fill().map((()=>new PB)),this.satBounds=new Array(3).fill().map((()=>new M3)),this.alignedSatBounds=new Array(3).fill().map((()=>new M3)),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),r&&this.matrix.copy(r)}set(e,t,r){this.min.copy(e),this.max.copy(t),this.matrix.copy(r),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}};O3.prototype.update=function(){let e=this.matrix,t=this.min,r=this.max,n=this.points;for(let l=0;l<=1;l++)for(let i=0;i<=1;i++)for(let s=0;s<=1;s++){let a=n[1*l|2*i|4*s];a.x=l?r.x:t.x,a.y=i?r.y:t.y,a.z=s?r.z:t.z,a.applyMatrix4(e)}let i=this.satBounds,s=this.satAxes,a=n[0];for(let l=0;l<3;l++){let e=s[l],t=i[l],r=n[1<<l];e.subVectors(a,r),t.setFromPoints(e,n)}let o=this.alignedSatBounds;o[0].setFromPointsField(n,"x"),o[1].setFromPointsField(n,"y"),o[2].setFromPointsField(n,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},O3.prototype.intersectsBox=function(){let e=new M3;return function(t){this.needsUpdate&&this.update();let r=t.min,n=t.max,i=this.satBounds,s=this.satAxes,a=this.alignedSatBounds;if(e.min=r.x,e.max=n.x,a[0].isSeparated(e)||(e.min=r.y,e.max=n.y,a[1].isSeparated(e))||(e.min=r.z,e.max=n.z,a[2].isSeparated(e)))return!1;for(let o=0;o<3;o++){let r=s[o],n=i[o];if(e.setFromBox(r,t),n.isSeparated(e))return!1}return!0}}(),O3.prototype.intersectsTriangle=function(){let e=new I3,t=new Array(3),r=new M3,n=new M3,i=new PB;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(e.copy(s),e.update(),s=e);let a=this.satBounds,o=this.satAxes;t[0]=s.a,t[1]=s.b,t[2]=s.c;for(let e=0;e<3;e++){let n=a[e],i=o[e];if(r.setFromPoints(i,t),n.isSeparated(r))return!1}let l=s.satBounds,c=s.satAxes,u=this.points;for(let e=0;e<3;e++){let t=l[e],n=c[e];if(r.setFromPoints(n,u),t.isSeparated(r))return!1}for(let e=0;e<3;e++){let s=o[e];for(let e=0;e<4;e++){let a=c[e];if(i.crossVectors(s,a),r.setFromPoints(i,t),n.setFromPoints(i,u),r.isSeparated(n))return!1}}return!0}}(),O3.prototype.closestPointToPoint=function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t},O3.prototype.distanceToPoint=function(){let e=new PB;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),O3.prototype.distanceToBox=function(){let e=["x","y","z"],t=new Array(12).fill().map((()=>new pG)),r=new Array(12).fill().map((()=>new pG)),n=new PB,i=new PB;return function(s){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(o||l)&&(s.getCenter(i),this.closestPointToPoint(i,n),s.closestPointToPoint(n,i),o&&o.copy(n),l&&l.copy(i)),0;let c=a*a,u=s.min,h=s.max,d=this.points,f=1/0;for(let e=0;e<8;e++){let t=d[e];i.copy(t).clamp(u,h);let r=t.distanceToSquared(i);if(r<f&&(f=r,o&&o.copy(t),l&&l.copy(i),r<c))return Math.sqrt(r)}let p=0;for(let n=0;n<3;n++)for(let i=0;i<=1;i++)for(let s=0;s<=1;s++){let a=(n+1)%3,o=(n+2)%3,l=1<<n|i<<a|s<<o,c=d[i<<a|s<<o],f=d[l];t[p].set(c,f);let m=e[n],g=e[a],v=e[o],y=r[p],b=y.start,w=y.end;b[m]=u[m],b[g]=i?u[g]:h[g],b[v]=s?u[v]:h[g],w[m]=h[m],w[g]=i?u[g]:h[g],w[v]=s?u[v]:h[g],p++}for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)for(let r=0;r<=1;r++){i.x=e?h.x:u.x,i.y=t?h.y:u.y,i.z=r?h.z:u.z,this.closestPointToPoint(i,n);let s=i.distanceToSquared(n);if(s<f&&(f=s,o&&o.copy(n),l&&l.copy(i),s<c))return Math.sqrt(s)}for(let e=0;e<12;e++){let s=t[e];for(let e=0;e<12;e++){let t=r[e];P3(s,t,n,i);let a=n.distanceToSquared(i);if(a<f&&(f=a,o&&o.copy(n),l&&l.copy(i),a<c))return Math.sqrt(a)}}return Math.sqrt(f)}}();var R3=new PB,L3=new PB,N3=new PB,B3=new eB,z3=new eB,F3=new eB,j3=new PB,U3=new PB,V3=new PB,H3=new PB;function W3(e,t,r,n,i){let s=3*n,a=e.index.getX(s),o=e.index.getX(s+1),l=e.index.getX(s+2),{position:c,normal:u,uv:h,uv1:d}=e.attributes,f=function(e,t,r,n,i,s,a,o,l){R3.fromBufferAttribute(t,s),L3.fromBufferAttribute(t,a),N3.fromBufferAttribute(t,o);let c=function(e,t,r,n,i,s){let a;return a=1===s?e.intersectTriangle(n,r,t,!0,i):e.intersectTriangle(t,r,n,2!==s,i),null===a?null:{distance:e.origin.distanceTo(i),point:i.clone()}}(e,R3,L3,N3,H3,l);if(c){n&&(B3.fromBufferAttribute(n,s),z3.fromBufferAttribute(n,a),F3.fromBufferAttribute(n,o),c.uv=Uz.getInterpolation(H3,R3,L3,N3,B3,z3,F3,new eB)),i&&(B3.fromBufferAttribute(i,s),z3.fromBufferAttribute(i,a),F3.fromBufferAttribute(i,o),c.uv1=Uz.getInterpolation(H3,R3,L3,N3,B3,z3,F3,new eB)),r&&(j3.fromBufferAttribute(r,s),U3.fromBufferAttribute(r,a),V3.fromBufferAttribute(r,o),c.normal=Uz.getInterpolation(H3,R3,L3,N3,j3,U3,V3,new PB),c.normal.dot(e.direction)>0&&c.normal.multiplyScalar(-1));let t={a:s,b:a,c:o,normal:new PB,materialIndex:0};Uz.getNormal(R3,L3,N3,t.normal),c.face=t,c.faceIndex=s}return c}(r,c,u,h,d,a,o,l,t);return f?(f.faceIndex=n,i&&i.push(f),f):null}function G3(e,t,r,n){let i=e.a,s=e.b,a=e.c,o=t,l=t+1,c=t+2;r&&(o=r.getX(t),l=r.getX(t+1),c=r.getX(t+2)),i.x=n.getX(o),i.y=n.getY(o),i.z=n.getZ(o),s.x=n.getX(l),s.y=n.getY(l),s.z=n.getZ(l),a.x=n.getX(c),a.y=n.getY(c),a.z=n.getZ(c)}function q3(e,t,r,n,i,s,a){let o=r.index,l=r.attributes.position;for(let c=e,u=t+e;c<u;c++)if(G3(a,3*c,o,l),a.needsUpdate=!0,n(a,c,i,s))return!0;return!1}var X3=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return 0===e.length?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}};function Y3(e,t){return 65535===t[e+15]}function K3(e,t){return t[e+6]}function Q3(e,t){return t[e+14]}function Z3(e){return e+8}function J3(e,t){return t[e+6]}var $3=new IB,e4=new PB,t4=["x","y","z"];function r4(e,t,r,n,i){let s=2*e,a=l4,o=c4,l=u4;if(Y3(s,o)){!function(e,t,r,n,i,s){for(let a=n,o=n+i;a<o;a++)W3(e,t,r,a,s)}(t,r,n,K3(e,l),Q3(s,o),i)}else{let s=Z3(e);a4(s,a,n,e4)&&r4(s,t,r,n,i);let o=J3(e,l);a4(o,a,n,e4)&&r4(o,t,r,n,i)}}function n4(e,t,r,n){let i=2*e,s=l4,a=c4,o=u4;if(Y3(i,a)){return function(e,t,r,n,i){let s=1/0,a=null;for(let o=n,l=n+i;o<l;o++){let n=W3(e,t,r,o);n&&n.distance<s&&(a=n,s=n.distance)}return a}(t,r,n,K3(e,o),Q3(i,a))}{let i,a,l=function(e,t){return t[e+7]}(e,o),c=t4[l],u=n.direction[c]>=0;u?(i=Z3(e),a=J3(e,o)):(i=J3(e,o),a=Z3(e));let h=a4(i,s,n,e4)?n4(i,t,r,n):null;if(h){let e=h.point[c];if(u?e<=s[a+l]:e>=s[a+l+3])return h}let d=a4(a,s,n,e4)?n4(a,t,r,n):null;return h&&d?h.distance<=d.distance?h:d:h||d||null}}var i4=function(){let e,t,r=[],n=new X3((()=>new IB));return function(){e=n.getPrimitive(),t=n.getPrimitive(),r.push(e,t);let s=i(...arguments);n.releasePrimitive(e),n.releasePrimitive(t),r.pop(),r.pop();let a=r.length;return a>0&&(t=r[a-1],e=r[a-2]),s};function i(r,n,s,a){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;function u(e){let t=2*e,r=c4,n=u4;for(;!Y3(t,r);)t=2*(e=Z3(e));return K3(e,n)}function h(e){let t=2*e,r=c4,n=u4;for(;!Y3(t,r);)t=2*(e=J3(e,n));return K3(e,n)+Q3(t,r)}let d=2*r,f=l4,p=c4,m=u4;if(Y3(d,p)){let t=K3(r,m),n=Q3(d,p);return m3(r,f,e),a(t,n,!1,c,l+r,e)}{let d,g,v,y,b=Z3(r),w=J3(r,m),x=b,S=w;if(o&&(v=e,y=t,m3(x,f,v),m3(S,f,y),d=o(v),g=o(y),g<d)){x=w,S=b;let e=d;d=g,g=e,v=y}v||(v=e,m3(x,f,v));let _,C=s(v,Y3(2*x,p),d,c+1,l+x);if(2===C){let e=u(x);_=a(e,h(x)-e,!0,c+1,l+x,v)}else _=C&&i(x,n,s,a,o,l,c+1);if(_)return!0;y=t,m3(S,f,y);let E,A=s(y,Y3(2*S,p),g,c+1,l+S);if(2===A){let e=u(S);E=a(e,h(S)-e,!0,c+1,l+S,y)}else E=A&&i(S,n,s,a,o,l,c+1);return!!E}}}(),s4=function(){let e=new I3,t=new I3,r=new sz,n=new O3,i=new O3;return function s(a,o,l,c){let u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,h=2*a,d=l4,f=c4,p=u4;if(null===u&&(l.boundingBox||l.computeBoundingBox(),n.set(l.boundingBox.min,l.boundingBox.max,c),u=n),!Y3(h,f)){let e=a+8,t=p[a+6];return m3(e,d,$3),!!(u.intersectsBox($3)&&s(e,o,l,c,u)||(m3(t,d,$3),u.intersectsBox($3)&&s(t,o,l,c,u)))}{let n=o,s=n.index,u=n.attributes.position,m=l.index,g=l.attributes.position,v=K3(a,p),y=Q3(h,f);if(r.copy(c).invert(),l.boundsTree)return m3(a,d,i),i.matrix.copy(r),i.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:e=>i.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(c),e.b.applyMatrix4(c),e.c.applyMatrix4(c),e.needsUpdate=!0;for(let r=3*v,n=3*(y+v);r<n;r+=3)if(G3(t,r,s,u),t.needsUpdate=!0,e.intersectsTriangle(t))return!0;return!1}});for(let i=3*v,a=y+3*v;i<a;i+=3){G3(e,i,s,u),e.a.applyMatrix4(r),e.b.applyMatrix4(r),e.c.applyMatrix4(r),e.needsUpdate=!0;for(let r=0,n=m.count;r<n;r+=3)if(G3(t,r,m,g),t.needsUpdate=!0,e.intersectsTriangle(t))return!0}}}}();function a4(e,t,r,n){return m3(e,t,$3),r.intersectBox($3,n)}var o4,l4,c4,u4,h4=[];function d4(e){o4&&h4.push(o4),o4=e,l4=new Float32Array(e),c4=new Uint16Array(e),u4=new Uint32Array(e)}function f4(){o4=null,l4=null,c4=null,u4=null,h4.length&&d4(h4.pop())}var p4=Symbol("skip tree generation"),m4=new IB,g4=new IB,v4=new sz,y4=new O3,b4=new O3,w4=new PB,x4=new PB,S4=new PB,_4=new PB,C4=new PB,E4=new IB,A4=new X3((()=>new I3)),M4=class{static serialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),M4.serialize(arguments[0],{cloneBuffers:void 0===arguments[2]||arguments[2]});t=u({cloneBuffers:!0},t);let r,n=e.geometry,i=e._roots,s=n.getIndex();return r=t.cloneBuffers?{roots:i.map((e=>e.slice())),index:s.array.slice()}:{roots:i,index:s.array},r}static deserialize(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("boolean"==typeof r)return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),M4.deserialize(arguments[0],arguments[1],{setIndex:void 0===arguments[2]||arguments[2]});r=u({setIndex:!0},r);let{index:n,roots:i}=e,s=new M4(t,u(u({},r),{},{[p4]:!0}));if(s._roots=i,r.setIndex){let r=t.getIndex();if(null===r){let r=new Xz(e.index,1,!1);t.setIndex(r)}else r.array!==n&&(r.array.set(n),r.needsUpdate=!0)}return s}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.isBufferGeometry)throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.");if(t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[p4]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[p4]||(this._roots=function(e,t){let r,n,i,s=A3(e,t),a=[],o=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let u=0;u<s.length;u++){let e=s[u],t=new o(32*l(e));r=new Float32Array(t),n=new Uint32Array(t),i=new Uint16Array(t),c(0,e),a.push(t)}return a;function l(e){return e.count?1:1+l(e.left)+l(e.right)}function c(e,t){let s=e/4,a=e/2,o=!!t.count,l=t.boundingData;for(let n=0;n<6;n++)r[s+n]=l[n];if(o){let r=t.offset,o=t.count;return n[s+6]=r,i[a+14]=o,i[a+15]=65535,e+32}{let r,i=t.left,a=t.right,o=t.splitAxis;if(r=c(e+32,i),r/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return n[s+6]=r/4,r=c(r,a),n[s+7]=o,r}}}(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new IB))),this.geometry=e}refit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&Array.isArray(e)&&(e=new Set(e));let t,r,n,i,s=this.geometry,a=s.index.array,o=s.attributes.position,l=0,c=this._roots;for(let h=0,d=c.length;h<d;h++)t=c[h],r=new Uint32Array(t),n=new Uint16Array(t),i=new Float32Array(t),u(0,l),l+=t.byteLength;function u(t,s){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=2*t;if(65535===n[c+15]){let e=r[t+6],s=1/0,l=1/0,u=1/0,h=-1/0,d=-1/0,f=-1/0;for(let t=3*e,r=3*(e+n[c+14]);t<r;t++){let e=a[t],r=o.getX(e),n=o.getY(e),i=o.getZ(e);r<s&&(s=r),r>h&&(h=r),n<l&&(l=n),n>d&&(d=n),i<u&&(u=i),i>f&&(f=i)}return(i[t+0]!==s||i[t+1]!==l||i[t+2]!==u||i[t+3]!==h||i[t+4]!==d||i[t+5]!==f)&&(i[t+0]=s,i[t+1]=l,i[t+2]=u,i[t+3]=h,i[t+4]=d,i[t+5]=f,!0)}{let n=t+8,a=r[t+6],o=n+s,c=a+s,h=l,d=!1,f=!1;e?h||(d=e.has(o),f=e.has(c),h=!d&&!f):(d=!0,f=!0);let p=h||f,m=!1;(h||d)&&(m=u(n,s,h));let g=!1;p&&(g=u(a,s,h));let v=m||g;if(v)for(let e=0;e<3;e++){let r=n+e,s=a+e,o=i[r],l=i[r+3],c=i[s],u=i[s+3];i[t+e]=o<c?o:c,i[t+e+3]=l>u?l:u}return v}}}traverse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this._roots[t],n=new Uint32Array(r),i=new Uint16Array(r);!function t(s){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=2*s,l=65535===i[o+15];if(l){let t=n[s+6],c=i[o+14];e(a,l,new Float32Array(r,4*s,6),t,c)}else{let i=s+8,o=n[s+6],c=n[s+7];e(a,l,new Float32Array(r,4*s,6),c)||(t(i,a+1),t(o,a+1))}}(0)}raycast(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this._roots,n=this.geometry,i=[],s=t.isMaterial,a=Array.isArray(t),o=n.groups,l=s?t.side:t;for(let c=0,u=r.length;c<u;c++){let s=a?t[o[c].materialIndex].side:l,u=i.length;if(d4(r[c]),r4(0,n,s,e,i),f4(),a){let e=o[c].materialIndex;for(let t=u,r=i.length;t<r;t++)i[t].face.materialIndex=e}}return i}raycastFirst(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this._roots,n=this.geometry,i=t.isMaterial,s=Array.isArray(t),a=null,o=n.groups,l=i?t.side:t;for(let c=0,u=r.length;c<u;c++){let i=s?t[o[c].materialIndex].side:l;d4(r[c]);let u=n4(0,n,i,e);f4(),null!=u&&(null==a||u.distance<a.distance)&&(a=u,s&&(u.face.materialIndex=o[c].materialIndex))}return a}intersectsGeometry(e,t){let r=this.geometry,n=!1;for(let i of this._roots)if(d4(i),n=s4(0,r,e,t),f4(),n)break;return n}shapecast(e,t,r){let n=this.geometry;if(e instanceof Function){if(t){let e=t;t=(t,r,n,i)=>{let s=3*r;return e(t,s,s+1,s+2,n,i)}}e={boundsTraverseOrder:r,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let i=A4.getPrimitive(),{boundsTraverseOrder:s,intersectsBounds:a,intersectsRange:o,intersectsTriangle:l}=e;if(o&&l){let e=o;o=(t,r,s,a,o)=>!!e(t,r,s,a,o)||q3(t,r,n,l,s,a,i)}else o||(o=l?(e,t,r,s)=>q3(e,t,n,l,r,s,i):(e,t,r)=>r);let c=!1,u=0;for(let h of this._roots){if(d4(h),c=i4(0,n,a,o,s,u),f4(),c)break;u+=h.byteLength}return A4.releasePrimitive(i),c}bvhcast(e,t,r){let{intersectsRanges:n,intersectsTriangles:i}=r,s=this.geometry.index,a=this.geometry.attributes.position,o=e.geometry.index,l=e.geometry.attributes.position;v4.copy(t).invert();let c=A4.getPrimitive(),u=A4.getPrimitive();if(i){let e=function(e,r,n,h,d,f,p,m){for(let g=n,v=n+h;g<v;g++){G3(u,3*g,o,l),u.a.applyMatrix4(t),u.b.applyMatrix4(t),u.c.applyMatrix4(t),u.needsUpdate=!0;for(let t=e,n=e+r;t<n;t++)if(G3(c,3*t,s,a),c.needsUpdate=!0,i(c,u,t,g,d,f,p,m))return!0}return!1};if(n){let t=n;n=function(r,n,i,s,a,o,l,c){return!!t(r,n,i,s,a,o,l,c)||e(r,n,i,s,a,o,l,c)}}else n=e}e.getBoundingBox(g4),g4.applyMatrix4(t);let h=this.shapecast({intersectsBounds:e=>g4.intersectsBox(e),intersectsRange:(t,r,i,s,a,o)=>(m4.copy(o),m4.applyMatrix4(v4),e.shapecast({intersectsBounds:e=>m4.intersectsBox(e),intersectsRange:(e,i,o,l,c)=>n(t,r,e,i,s,a,l,c)}))});return A4.releasePrimitive(c),A4.releasePrimitive(u),h}intersectsBox(e,t){return y4.set(e.min,e.max,t),y4.needsUpdate=!0,this.shapecast({intersectsBounds:e=>y4.intersectsBox(e),intersectsTriangle:e=>y4.intersectsTriangle(e)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0;e.boundingBox||e.computeBoundingBox(),y4.set(e.boundingBox.min,e.boundingBox.max,t),y4.needsUpdate=!0;let a=this.geometry,o=a.attributes.position,l=a.index,c=e.attributes.position,u=e.index,h=A4.getPrimitive(),d=A4.getPrimitive(),f=x4,p=S4,m=null,g=null;n&&(m=_4,g=C4);let v=1/0,y=null,b=null;return v4.copy(t).invert(),b4.matrix.copy(v4),this.shapecast({boundsTraverseOrder:e=>y4.distanceToBox(e),intersectsBounds:(e,t,r)=>r<v&&r<s&&(t&&(b4.min.copy(e.min),b4.max.copy(e.max),b4.needsUpdate=!0),!0),intersectsRange:(r,n)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:e=>b4.distanceToBox(e),intersectsBounds:(e,t,r)=>r<v&&r<s,intersectsRange:(e,s)=>{for(let a=3*e,w=3*(e+s);a<w;a+=3){G3(d,a,u,c),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let e=3*r,t=3*(r+n);e<t;e+=3){G3(h,e,l,o),h.needsUpdate=!0;let t=h.distanceToTriangle(d,f,m);if(t<v&&(p.copy(f),g&&g.copy(m),v=t,y=e/3,b=a/3),t<i)return!0}}}});for(let e=0,s=u?u.count:c.count;e<s;e+=3){G3(d,e,u,c),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let t=3*r,s=3*(r+n);t<s;t+=3){G3(h,t,l,o),h.needsUpdate=!0;let r=h.distanceToTriangle(d,f,m);if(r<v&&(p.copy(f),g&&g.copy(m),v=r,y=t/3,b=e/3),r<i)return!0}}}}),A4.releasePrimitive(h),A4.releasePrimitive(d),v===1/0?null:(r.point?r.point.copy(p):r.point=p.clone(),r.distance=v,r.faceIndex=y,n&&(n.point?n.point.copy(g):n.point=g.clone(),n.point.applyMatrix4(v4),p.applyMatrix4(v4),n.distance=p.sub(n.point).length(),n.faceIndex=b),r)}closestPointToPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=r*r,s=n*n,a=1/0,o=null;if(this.shapecast({boundsTraverseOrder:t=>(w4.copy(e).clamp(t.min,t.max),w4.distanceToSquared(e)),intersectsBounds:(e,t,r)=>r<a&&r<s,intersectsTriangle:(t,r)=>{t.closestPointToPoint(e,w4);let n=e.distanceToSquared(w4);return n<a&&(x4.copy(w4),a=n,o=r),n<i}}),a===1/0)return null;let l=Math.sqrt(a);return t.point?t.point.copy(x4):t.point=x4.clone(),t.distance=l,t.faceIndex=o,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach((t=>{m3(0,new Float32Array(t),E4),e.union(E4)})),e}},T4=yL(wL()),P4=.5*(Math.sqrt(3)-1),k4=(3-Math.sqrt(3))/6,D4=1/3,I4=1/6,O4=(Math.sqrt(5),Math.sqrt(5),e=>0|Math.floor(e)),R4=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),L4=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function N4(e){let t=new Uint8Array(512);for(let r=0;r<256;r++)t[r]=r;for(let r=0;r<255;r++){let n=r+~~(e()*(256-r)),i=t[r];t[r]=t[n],t[n]=i}for(let r=256;r<512;r++)t[r]=t[r-256];return t}var B4,z4=new Uz,F4=class{constructor(e){this.weightAttribute=null;let t=e.geometry;if(!t.isBufferGeometry||3!==t.attributes.position.itemSize)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let e=this.positionAttribute,t=new Float32Array(e.count/3);for(let n=0;n<e.count;n+=3){let r=1;z4.a.fromBufferAttribute(e,n),z4.b.fromBufferAttribute(e,n+1),z4.c.fromBufferAttribute(e,n+2),r*=z4.getArea(),t[n/3]=r}this.distribution=new Float32Array(e.count/3);let r=0;for(let n=0;n<t.length;n++)r+=t[n],this.distribution[n]=r;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t){if(this.distribution){let r=this.distribution[this.distribution.length-1],n=this.binarySearch(this.randomFunction()*r);return this.sampleFace(n,e,t)}}binarySearch(e){if(!this.distribution)return 0;let t=this.distribution,r=0,n=t.length-1,i=-1;for(;r<=n;){let s=Math.ceil((r+n)/2);if(0===s||t[s-1]<=e&&t[s]>e){i=s;break}e<t[s]?n=s-1:r=s+1}return i}sampleFace(e,t,r){let n=this.randomFunction(),i=this.randomFunction();return n+i>1&&(n=1-n,i=1-i),z4.a.fromBufferAttribute(this.positionAttribute,3*e),z4.b.fromBufferAttribute(this.positionAttribute,3*e+1),z4.c.fromBufferAttribute(this.positionAttribute,3*e+2),t.set(0,0,0).addScaledVector(z4.a,n).addScaledVector(z4.b,i).addScaledVector(z4.c,1-(n+i)),z4.getNormal(r),this}},j4=yL(xL()),U4=new sz,V4=new sz,H4=new sz;(e=>{e.is=function(e){return e&&e.__isSPEObject}})(B4||(B4={}));var W4,G4=e=>class extends e{constructor(){super(...arguments),this.previousModelViewMatrix=new sz,this.copyPreviousMatrix=!0,this.hiddenMatrix=new sz,this.matrixWorldRigid=new sz,this.shearScale=new sz,this.shearScaleInv=new sz}get __isSPEObject(){return!0}isDescendantOf(e){e instanceof kz&&(e=e.uuid);let t=this;for(;t.parent;){if(t.parent.uuid===e)return!0;t=t.parent}return!1}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);for(let t of this.children)t.updateMatrixWorld(e)}updateWorldMatrix(e,t){let r=this.parent;if(e&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),t)for(let n of this.children)n.updateWorldMatrix(!1,!0)}traverseChildren(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let r of this.children)B4.is(r)&&r.traverseObject(e,t+1)}traverseObject(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!0!==e(this,t))for(let r of this.children)B4.is(r)&&r.traverseObject(e,t+1)}updateMatrixWorldSVD(){let e=this.matrixWorld.elements,t=[[e[0],e[4],e[8]],[e[1],e[5],e[9]],[e[2],e[6],e[10]]],{u:r,v:n,q:i}=(0,j4.SVD)(t),s=U4.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),a=V4.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),o=H4.copy(a).transpose();this.shearScale.makeScale(i[0],i[1],i[2]).multiply(o).premultiply(a),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(s,o).copyPosition(this.matrixWorld),i.every((e=>Math.abs(i[0]-e)<.01))?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(e,t){this.updateWorldMatrix(!0,!1);let r=(new sz).copy(this.matrixWorld).invert();return null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),r.multiply(e.parent.matrixWorld)),"hiddenMatrix"in e&&e.hiddenMatrix instanceof sz?e.hiddenMatrix.premultiply(r):e.applyMatrix4(r),e.updateWorldMatrix(!1,!1),this.add(e),void 0!==t&&(this.children.pop(),this.children.splice(t,0,e)),this}copy(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return super.copy(e,t),this.hasNonUniformScale=e.hasNonUniformScale,this}onAfterRender(e,t,r,n,i,s){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},q4=class extends(G4(kz)){},X4=class extends q4{constructor(e){super(),this.object=e,this.matrixAutoUpdate=!1,this.hasNonUniformScale=e.hasNonUniformScale}raycast(e,t){}expand(){let e=0,t=this.object.entityChildren(e);for(;t;){var r;let n=this.children[e];(null===(r=n)||void 0===r?void 0:r.object)!==t&&(n&&this.remove(n),n=new X4(t),this.add(n),this.children.splice(e,0,this.children.pop()),n.matrixWorldNeedsUpdate=!0,n.matrixAutoUpdate=!1,n.matrix=t.matrix,n.hiddenMatrix=t.hiddenMatrix),n.expand(),e+=1,t=this.object.entityChildren(e)}for(;this.children.length>e;)this.remove(this.children[e])}get visible(){var e;return void 0!==this.playModeVisible?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&!0===(null===(e=this.object.dataPatched.cloner)||void 0===e?void 0:e.hideBase)}set visible(e){}get castShadow(){return this.object.castShadow}set castShadow(e){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(e){}get isMesh(){return"Mesh"===this.object.type}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(e){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},Y4=new PB,K4=new PB,Q4=new sz,Z4=[new PB(-1,1,1),new PB(-1,-1,1),new PB(1,-1,1),new PB(1,1,1),new PB(-1,1,-1),new PB(-1,-1,-1),new PB(1,-1,-1),new PB(1,1,-1)],J4=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],$4=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],e5=(e,t,r)=>{e.updateEntityBoxSize(Y4,K4),Q4.copy(t).multiply(e.matrixWorld),0===K4.x&&0===K4.y&&0===K4.z?r.push(new PB(Y4.x,Y4.y,Y4.z).applyMatrix4(Q4)):Z4.forEach((e=>{r.push(e.clone().multiply(K4).add(Y4).applyMatrix4(Q4))}))},t5=class extends IB{constructor(){super(...arguments),this.matrix=new sz,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(e){return super.copy(e),this.matrix.copy(e.matrix),this.vertices=e.vertices.map((e=>e.clone())),this.faces=e.faces.map((e=>e.clone())),this.edges=e.edges.map((e=>e.clone())),this.centerEdges=e.centerEdges.map((e=>e.clone())),this}setFromObjectSize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,t),this.makeEmpty(),this.matrix.copy(e.matrixWorld);let r=(new sz).copy(e.matrixWorld).invert();return this.expandByObjectSize(e,r,t)}expandByObjectSize(e,t){let r=[];return!0===(arguments.length>2&&void 0!==arguments[2]&&arguments[2])?e.traverseEntity((e=>{if(e.visible||e.cloner&&e.data.visible){if(!("geometry"in e))return void r.push(new PB);e5(e,t,r)}})):e5(e,t,r),this.setFromPoints(r)}getCenter(e){return(e=super.getCenter(e)).applyMatrix4(this.matrix),e}getPositionToCenter(e){return(e=super.getCenter(e)).applyMatrix4(Q4.copy(this.matrix).setPosition(0,0,0)),e}computeVertices(){this.getSize(K4).multiplyScalar(.5),this.getCenter(Y4),Q4.copy(this.matrix).setPosition(Y4),this.vertices=Z4.map((e=>e.clone().multiply(K4).applyMatrix4(Q4)))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=J4.map((e=>{let[t,r]=e;return new pG(this.vertices[t],this.vertices[r])})),this.centerEdges=this.edges.map((e=>e.getCenter(new PB)))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=$4.map((e=>{let[t,r]=e;return this.vertices[t].clone().add(this.vertices[r]).multiplyScalar(.5)}))}},r5={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},n5=class extends cH{constructor(){super()}getPoints(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,r=[],n=this.getCurveLengths(),i=n[n.length-1]/n.length;for(let s=0,a=this.curves;s<a.length;s++){let o=a[s],l=0===s?n[s]:n[s]-n[s-1],c=Math.ceil(t*l/i),u=o.getPoints(c);for(let t=0;t<u.length;t++){let n=u[t];e&&e.equals(n)||(r.push(n),e=n)}}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r}},i5=.001;function s5(e,t,r){return t.clone().sub(e).cross(t.clone().sub(r)).length()<=i5}function a5(e,t){let r=new PB(...e.position),n=new PB(...e.controlNext.position),i=new PB(...t.controlPrevious.position),s=new PB(...t.position);return s5(r,n,s)&&s5(r,i,s)}function o5(e){let t=e.points.map((e=>new PB(...e.data.position))),r=[e.points[0]],n=new PB(...r[0].data.position);for(let u=0;u<e.points.length-1;u++)s5(n,t[u],t[u+1])||(r.push(e.points[u]),n=t[u]);r.push(e.points[e.points.length-1]);let i=e.isClosed,s=r.length-(i?0:1),a=r.length,o=[];for(let h=0;h<a;h++){let t=r[h].data,n=new PB(...t.position),s=new PB(...t.controlPrevious.position),l=new PB(...t.controlNext.position),c={position:n,baseRoundness:t.roundness,controlPrevious:s,controlNext:l};if(0===t.roundness||!e.isClosed&&(0===h||h===a-1)){o[h]=u(u({},c),{},{removedLength:0});continue}let d=i&&h==a-1?0:h+1,f=r[i&&0==h?a-1:h-1].data,p=r[d].data,m=new PB(...f.position),g=new PB(...p.position),v=m.clone().sub(n).normalize(),y=g.clone().sub(n).normalize();Object.assign(c,{prevDir:v,nextDir:y});let b=a5(f,t),w=a5(t,p);if(b&&w){let e=v.clone().add(y).normalize(),r=e.clone().cross(v).length()/v.dot(e);o[h]=u(u({},c),{},{tan:r,removedLength:t.roundness/r})}else o[h]=u(u({},c),{},{removedLength:0})}for(let u=0;u<s;u++){let e=i&&u===a-1?0:u+1,t=o[u],r=o[e];if(0!==t.removedLength||0!==r.removedLength){let e=t.position.distanceTo(r.position);t.removedLength=Math.min(t.removedLength,e/2),r.removedLength=Math.min(r.removedLength,e/2)}}let l=[];for(let u=0;u<s;u++){let e=u,t=i&&u===a-1?0:u+1,n=o[e],s=o[t],c=null;if(a5(r[e].data,r[t].data)){let e=n.position.clone(),t=s.position.clone();(0!==n.removedLength||0!==s.removedLength)&&(n.nextDir&&e.add(n.nextDir.clone().setLength(n.removedLength)),s.prevDir&&t.add(s.prevDir.clone().setLength(s.removedLength))),e.distanceTo(t)>i5&&(c=new nH(e,e.clone().lerp(t,.3),t.clone().lerp(e,.3),t))}else n.position.distanceTo(s.position)>i5&&(c=new nH(n.position,n.controlNext,s.controlPrevious,s.position));l[2*u+1]=c}for(let u=0;u<a;u++){let e=o[u];if(0===e.removedLength){l[2*u]=null;continue}let t=e.position,r=e.prevDir.clone().multiplyScalar(e.removedLength).add(t),n=e.nextDir.clone().multiplyScalar(e.removedLength).add(t),i=e.tan*e.removedLength,s=e.prevDir.clone().add(e.nextDir).normalize(),a=r.clone().lerp(n,.5),c=r.distanceTo(n)/2,h=s.clone().multiplyScalar(Math.sqrt(Math.pow(i,2)-Math.pow(c,2))).add(a),d=s.clone().multiplyScalar(-i).add(h),f=t.distanceTo(d)/t.distanceTo(a),p=e.prevDir.clone().multiplyScalar(f*t.distanceTo(r)).add(t),m=p.clone().lerp(d,2),g=r.clone().lerp(p,4/3),v=n.clone().lerp(m,4/3);l[2*u]=new nH(r,g,v,n)}let c=new n5;return l.forEach((e=>{e&&c.add(e)})),c}(e=>{e.is=function(e){return e&&e.__isEntity}})(W4||(W4={}));var l5=e=>W4.is(e),c5={type:"completeState",isfromEntity:!0},u5=["x","y","z"],h5=new PB,d5=(new PB).set(0,1,0),f5=e=>class extends(G4(e)){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.destroyedInAction=!1,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new t5,this._recursiveBBox=new t5,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(e){let t=this.children[e];if(W4.is(t))return t}entityChildrenCount(){let e=this.children.length;for(;e--;)if(W4.is(this.children[e]))return e+1;return 0}get isConcreteEntity(){return"string"==typeof this.identity}get isVirtualEntity(){return"string"!=typeof this.identity}get isInstanceRoot(){return this.isConcreteEntity&&"Instance"===this.data.type}nearestInstanceSelfOrParent(){let e=this;for(;"Instance"!==e.data.type;){let t=e.parent;if(!W4.is(t))return;e=t}return e}forInstancesRec(e){this.instances.forEach((t=>{t.disposed||e(t),t.forInstancesRec(e)}))}super_Entity(e,t){"string"==typeof e&&(this.uuid=e),this.identity=e,this.data=t,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0!==this.data.states.length||r){for(let e of this.data.states)i2.toOps(this.data,e.data).forEach((e=>{let r=aJ.replaceProps(e,this.data);this.dataPatched=this.data,this.updateByPatchedOp(r,this.data,t)}));if(null!==e){let r=this.data.states.data(e);r&&(this.dataPatched=i2.patch(this.data,r),i2.toOps(this.data,r).forEach((e=>{this.updateByPatchedOp(e,this.dataPatched,t)})))}r&&this.updateTransformState(this.dataPatched,t),this.stateSelection=e,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(e,t){e.setScalar(0),t.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors((e=>{l5(e)&&e.resetBBoxNeedsUpdateSelf()})),this.traverseEntity((e=>{e.resetBBoxNeedsUpdateSelf()}))}find(e){let t;return this.traverseEntity((r=>{r.uuid===e&&(t=r)})),t}traverseSortNextHelper(){let e=this.parent;if(e){let t=e.children,r=t.indexOf(this)+1;if(W4.is(t[r]))return t[r];if(W4.is(e))return e.traverseSortNextHelper()}}sortNext(){let e=this.children;return this.children.length>0&&W4.is(this.children[0])?e[0]:this.traverseSortNextHelper()}goUp(e){let t=this;for(;e>0&&null!==t;)t=t.parent,e-=1;return t}hasAnccestorOrSelf(e){return this===e||this.hasAnccestor(e)}hasAnccestor(e){let t=this.parent;for(;t;){if(e===t)return!0;t=t.parent}return!1}countToAccestor(e){let t=0,r=this;for(;r!==e;){if(null===r)return-1;r=r.parent,t+=1}return t}forEachEntity(e){for(let t of this.children)l5(t)&&e(t)}traverseEntityAncestors(e){this.traverseAncestors((t=>{W4.is(t)&&e(t)}))}traverseConcreteEntity(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!0!==e(this,t))for(let r of this.children)l5(r)&&r.isConcreteEntity&&r.traverseEntity(e,t+1)}traverseEntity(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!0!==e(this,t))for(let r of this.children)l5(r)&&r.traverseEntity(e,t+1)}traverseVisibleEntity(e){e(this);for(let t of this.children)l5(t)&&t.visible&&t.traverseVisibleEntity(e)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}updateMatrixWorld(e){super.updateMatrixWorld(e),this.dispatchEvent({type:"updateMatrixWorld"})}copy(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return super.copy(e,t),this.dataPatched=e.dataPatched,this.raycastLock=e.raycastLock,this.scaleLock=e.scaleLock,this.hiddenMatrix.copy(e.hiddenMatrix),this}hasEntityChild(){return this.children.some((e=>l5(e)))}isAncestorOf(e){if(this.uuid===e)return!1;let t=!1;return this.traverseEntity((r=>{r.uuid===e&&(t=!0)})),t}toObjectTransformState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.updateWorldMatrix(!0,!1);let t={position:this.position.toArray(),rotation:[this.rotation.x*$N.RAD2DEG,this.rotation.y*$N.RAD2DEG,this.rotation.z*$N.RAD2DEG],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return uZ(t,e)}getTransformValues(e,t,r){return t[e].map(((t,n)=>{var i;return null!==(i=null===r||void 0===r?void 0:r.shared.getVariable(t,[this.uuid,e,u5[n]]))&&void 0!==i?i:t}))}updateTransformState(e,t){var r;let n=!1;return e.position&&(this.position.fromArray(this.getTransformValues("position",e,t)),n=!0),e.rotation&&(h5.fromArray(this.getTransformValues("rotation",e,t)).multiplyScalar($N.DEG2RAD),this.rotation.setFromVector3(h5),n=!0),e.scale&&(this.scale.fromArray(this.getTransformValues("scale",e,t)),n=!0),void 0!==e.hiddenMatrix&&(n=!0,this.hiddenMatrix.fromArray(null!==(r=e.hiddenMatrix)&&void 0!==r?r:j0.identity)),n&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors((e=>{e.invalidateClonerTransform(this)}))),e.position&&e.rotation&&e.scale&&void 0!==e.hiddenMatrix&&this.updateWorldMatrix(!1,!0),n}onVariableUpdate(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.resetBBoxNeedsUpdate():(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors((e=>{e.invalidateClonerTransform(this)})))}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let e of this.children)W4.is(e)&&e.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach((e=>{W4.is(e)&&e.disposeRecursively()}))}toState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=u({name:this.name,visible:this.visible,raycastLock:this.raycastLock},this.toObjectTransformState(e));return uZ(t,e)}updateByObjUpdateOp(e,t){void 0!==e&&this.updateByOp({type:0,props:e,path:[]},u(u({},this.data),e),t,!1)}updateByOp(e,t,r,n){let i=this.data;this.data=t;let a=e,o=NJ(e.path,["states","*"]);if(null!==o){if(0===e.type){let[t]=o;if((null===this||void 0===this?void 0:this.stateSelection)===t){let t=u({},e.props);if(delete t.name,Object.values(e.props).some((e=>void 0===e))){let r=this.data;if(void 0!==r){let n=kJ.zoom(r,e.path.slice(2));if(n)for(let r in e.props)void 0===e.props[r]&&r in n&&(t[r]=n[r])}}a=u(u({},e),{},{props:t,path:e.path.slice(2)})}}}else if(0===e.type){let t=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(void 0!==t){if(void 0!==e.props.name&&t.name){let{name:e}=t;t=s(t,oL)}if(void 0!==e.props.material&&"material"in t){let{material:e}=t;t=s(t,lL)}let r=kJ.removeOverridden(e.path,e.props,t);a=u(u({},e),{},{props:r})}}if(this.updateByPatchedOpBase(a,i2.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),r),NJ(e.path,["overrides"])){let n=[],i=[...e.path];for(n.push(i[1]),i.splice(0,2);i.length>0&&"descendants"===i[0];)n.push(i[1]),i.splice(0,2);if(void 0===n[n.length-1]){if(0===e.type)for(let t of Object.keys(e.props)){n[n.length-1]=t;let i=r.scene.findInstance([this.uuid,...n]);i&&(i.overrideData=e.props[t],i.updateState(sJ.apply(i.component.data,i.overrideData),r))}}else{let s=r.scene.findInstance([this.uuid,...n]);if(s){let a=kJ.zoom(s.component.data,i);if(0===(e=u(u({},e),{},{path:i})).type){let t=e.props;if(a)for(let[r,n]of Object.entries(e.props))void 0===n&&(t===e.props&&(t=u({},e.props)),t[r]=a[r]);e=u(u({},e),{},{props:t})}s.overrideData=e2.resolve(t.overrides,n),s.updateByOp(e,oJ.applySimple(s.data,e),r,!1)}}}else if(this.instances.length>0){let n;if(0===e.path.length&&0===e.type){let t;for(let r of t2.rootOverrideProps)r in e.props&&(void 0===t&&(t={}),t[r]=e.props[r]);t&&(n=u(u({},e),{},{props:t}))}else for(let t of t2.rootOverrideProps)if(NJ(e.path,[t])){n=e;break}void 0!==n&&this.instances.forEach((e=>{if(e.isInstanceRoot){let t=sJ.filterOp(e.overrideData,n);t&&e.updateByOp(t,oJ.applySimple(e.data,t),r,!0)}})),this.instances.forEach((n=>{if(!n.isInstanceRoot){let s=sJ.filterOp(n.overrideData,e);if(s){let a;a=i===n.data&&e===s?t:oJ.applySimple(n.data,s),n.updateByOp(s,a,r,!0)}}}))}}updateByPatchedOpBase(e,t,r){if(this.dataPatched=t,0===e.path.length&&0===e.type)void 0!==e.props.type&&!Z0.is(e.props.type)&&r5.changeEntityProptotype(this,t,r);else if(1===e.path.length&&"geometry"===e.path[0]&&0===e.type&&"type"in e.props){r5.changeEntityProptotype(this,t,r);for(let e of this.children)W4.is(e)&&e.updateVisible(r.scene)}this.updateByPatchedOp(e,t,r)}updateByPatchedOp(e,t,r){if(0===e.path.length&&0===e.type?this.updateState(e.props,r):0===e.type&&("resolutionLevel"in e.props||"useChildrenColors"in e.props)&&this.updateState(t,r),"morphTargetInfluences"===e.path[0]&&0===e.type){var n;let i=null===(n=t.morphTargetInfluences.get(e.path[1]))||void 0===n?void 0:n.data.name;i&&this.updateMorphInfluences(i,r.shared.getVariable(e.props.value,[this.uuid,"morphTargetInfluences",i]))}if(null!==NJ(e.path,["pathSnapping"])&&this.updatePathSnapping(t.pathSnapping),null!==NJ(e.path,["cloner"])){let n=oJ.drop(e,1);0===n.path.length&&0===n.type&&!0===n.props.disabled?this.setFromClonerState(null,r):this.cloner?this.cloner.updateState(t.cloner,r.scene):(this.setFromClonerState(t.cloner,r),this.expandCloner(r.scene)),this.updateVisible(r.scene)}}updatePathSnapping(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dataPatched.pathSnapping;this._updatedPathSnapping=e,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(e){var t,r,n,i,s,a,o,l,c,h,d;let f=null!==(t=null===(r=this._updatedPathSnapping)||void 0===r?void 0:r.pathId)&&void 0!==t?t:this.dataPatched.pathSnapping.pathId,p=null!==(n=null!==(i=null===(s=this._updatedPathSnapping)||void 0===s?void 0:s.slide)&&void 0!==i?i:this.dataPatched.pathSnapping.slide)&&void 0!==n?n:0,m=null!==(a=null!==(o=null===(l=this._updatedPathSnapping)||void 0===l?void 0:l.offset)&&void 0!==o?o:this.dataPatched.pathSnapping.offset)&&void 0!==a?a:0,g=null!==(c=null===(h=this._updatedPathSnapping)||void 0===h?void 0:h.orientation)&&void 0!==c?c:this.dataPatched.pathSnapping.orientation;if(null===f)return;let v=e.find(f);if(!v||!1===this._needApplyPathSnapping)return;this._needApplyPathSnapping=!1;let y=v.data;if(y.geometry.path.points.length<=1)return;let b=o5(y.geometry.path),w=(p+m)%1;p+m===1&&0===w&&(w=1);let x=null;try{x=b.curves.length?b.getPointAt(w):null}catch(E){}if(null===x)return;let S=this.parent?null===(d=this.parent)||void 0===d?void 0:d.matrixWorld:new sz;v.updateMatrixWorld();let _=(new sz).multiplyMatrices(S.clone().invert(),v.matrixWorld);x.applyMatrix4(_);let C={position:x.toArray(),rotation:y.rotation};if("tangential"===g){let e=(new sz).extractRotation(v.matrixWorld),t=b.getTangentAt(w).applyMatrix4(e).add(x),r=(new sz).lookAt(x,t,d5),n=h5.setFromEuler((new mz).setFromRotationMatrix(r)).multiplyScalar($N.RAD2DEG);C=u(u({},C),{},{rotation:n.toArray()})}this.updateTransformState(C),this.traverseEntity((e=>{e._cameraType&&e.dispatchEvent(c5)}))}updateVisible(e){var t,r;if(this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||null!==(t=this.dataPatched.cloner.disabled)&&void 0!==t&&t||!0!==(null===(r=this.dataPatched.cloner)||void 0===r?void 0:r.hideBase)),!e)return;let n=!1;this.traverseEntity((e=>{if("Splat"===e.data.type)return n=!0,!0})),n&&e.reloadSplats()}updateState_Entity(e,t){void 0!==e.name&&(this.name=e.name),void 0!==e.raycastLock&&(this.raycastLock=e.raycastLock),void 0!==e.visible&&(this.updateVisible(null===t||void 0===t?void 0:t.scene),this.resetBBoxNeedsUpdate()),t&&"cloner"in e&&void 0!==e.cloner&&(this.setFromClonerState(e.cloner,t),this.updateVisible(t.scene)),this.updateTransformState(e,t)}get attachedSurfaceCloners(){return this.children.filter((e=>e instanceof r5.Cloner&&"toObject"===e.parameters.type))}setFromClonerState(e,t){this.disposed||(null===e||e.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):void 0===this.cloner?(this.cloner=new r5.Cloner(this,e),t.scene.addPendingExpandCloner(this)):this.cloner.updateState(e,t.scene))}expandCloner(e){!this.disposed&&this.cloner&&this.cloner.expandClones(e)}invalidateClonerTransform(e){this.cloner&&this.cloner.invalidateTransform(e)}requestRender(){this.dispatchEvent({type:"requestRender"})}},p5=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i,s,a,o,l;let c=null===(r=e.parameters)||void 0===r?void 0:r.radiusTop,u=null===(n=e.parameters)||void 0===n?void 0:n.radiusBottom,h=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},e.parameters);h.thetaLength=$N.clamp(h.thetaLength,0,360);let d=h.width/2,f=null!==(s=h.radiusTop)&&void 0!==s?s:d,p=null!==(a=h.radiusBottom)&&void 0!==a?a:d;if(f===p?(f=d,p=d):f>p?(f=d,p=p*d/f):(f=f*d/p,p=d),h.shapeBlendNode){f=null!==c&&void 0!==c?c:d,p=null!==u&&void 0!==u?u:d;let e=2*Math.max(f,p);h.width=e,h.depth=e}return{parameters:Object.assign(h,{width:Math.abs(h.width),height:Math.abs(null!==(o=h.height)&&void 0!==o?o:h.width),depth:Math.abs(null!==(l=h.depth)&&void 0!==l?l:h.width),radiusTop:f,radiusBottom:p})}}static build(e){let t,{width:r,depth:n,height:i,radialSegments:s,heightSegments:a,openEnded:o,thetaStart:l,thetaLength:c,radiusTop:h,radiusBottom:d,cornerRadius:f,cornerSegments:p,hollow:m}=e.parameters;return 0===c?(t=new iF,t.setAttribute("position",new Qz([],3))):t=f||m?new v5(h,d,i,s,a,o,l,c*Math.PI/180,f,f,p,m):new dH(h,d,i,s,a,o,l,c*Math.PI/180),t.scale(1,1,n/r),Object.assign(t,{userData:u(u({},e),{},{type:"CylinderGeometry"})})}};function m5(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function g5(e){return new eB(e.y,-e.x)}var v5=class extends iF{constructor(e,t,r,n,i,s,a,o,l,c,u,h){let d=arguments.length>12&&void 0!==arguments[12]&&arguments[12];super(),this.type="RoundedCylinderBufferGeometry",e=void 0!==e?e:1,t=void 0!==t?t:1,r=r||1,n=Math.floor(n)||8,i=Math.floor(i)||1,s=void 0!==s&&s,a=void 0!==a?a:0,o=void 0!==o?o:2*Math.PI,s&&(l=0,c=0);let f=[],p=[],m=[],g=[],v=0,y=r/2,b=new PB,w=new PB;d&&0==e&&(e=l),d&&0==t&&(t=c);let x=new eB(e,y),S=new eB(t,-y),_=null,C=null,E=null,A=null,M=x.clone().sub(S),T=0,P=0,k=0;h>0&&(T=Math.min(e,t)*(1-h),P=e-T,k=t-T);let D=x.clone();D.x-=T;let I=Math.PI-M.angle(),O=M.angle(),R=Math.tan(O/2),L=Math.tan(I/2),N=R+L,B=h?N:L,z=h?N:R;if(l=Math.min(l,(e-P)/B,M.length()/N),c=Math.min(c,(t-k)/z,M.length()/N),l>0){let e=l/R;_=x.clone().sub(new eB(e,l)),h&&(E=_.clone(),E.x-=T-N*l),x.sub(M.clone().setLength(e))}if(c>0){let e=c/L;C=S.clone().sub(new eB(e,-c)),S.add(M.clone().setLength(e)),h&&(A=C.clone(),A.x-=T-N*c,D.sub(M.clone().setLength(e)))}M=x.clone().sub(S);let F=M.length()<.5,j=[];for(let W=0;W<=n;W++){let u=[],d=W/n,f=d*o+a,y=new eB(Math.sin(f),Math.cos(f));if(A&&C?(U(u,d,y,I,c,A,-1,!0),U(u,d,y,O,c,C,-1,!1)):C?(V(u,y,C.x,0,-1),U(u,d,y,O,c,C,-1,!1)):s||V(u,y,t,k,-1),m5(g5(M).normalize(),y,b),!F)for(let e=0;e<=i;e++){let t=e/i;m5(M.clone().multiplyScalar(t).add(S),y,w),p.push(w.x,w.y,w.z),m.push(b.x,b.y,b.z),g.push(d,.5+w.y/r),u.push(v++)}if(E&&_?(U(u,d,y,I,l,_,1,!1),U(u,d,y,O,l,E,1,!0)):_?(U(u,d,y,I,l,_,1,!1),V(u,y,_.x,0,1)):s||V(u,y,e,P,1),h&&!F){m5(g5(M).multiplyScalar(-1).normalize(),y,b);for(let e=0;e<=i;e++){let t=e/i;m5(M.clone().multiplyScalar(-t).add(D),y,w),p.push(w.x,w.y,w.z),m.push(b.x,b.y,b.z),g.push(d,.5+w.y/r),u.push(v++)}}h&&!s&&u.push(u[0]),j.push(u)}for(let W=0;W<j.length-1;W++)for(let e=0;e<j[0].length-1;e++){if(s&&h&&e==i)continue;let t=j[W][e],r=j[W+1][e],n=j[W+1][e+1],a=j[W][e+1],o=p[3*n+0],l=p[3*n+2];f.push(t,r,a),(0!=o||0!=l)&&f.push(r,n,a)}function U(e,t,n,i,s,a,o,l){for(let c=0;c<u+1;c++){let h=c/u,d=o<0?h:1-h;l&&(d-=1),d*=i;let f=new eB(Math.sin(d),Math.cos(d)*o);m5(f.clone().multiplyScalar(s).add(a),n,w),p.push(w.x,w.y,w.z),m5(f,n,b),m.push(b.x,b.y,b.z),g.push(t,.5+w.y/r),e.push(v++)}}function V(e,t,r,n,i){let s=new PB,a=new eB,o=[r,n];i<0&&o.reverse();for(let l of o)a.set(l,y*i),m5(a,t,s),p.push(s.x,s.y,s.z),m.push(0,i,0),g.push(.5,.5),e.push(v++)}function H(r,n,i){let s=new eB(Math.sin(i),Math.cos(i)),a=new eB(-Math.cos(i),Math.sin(i)),o=new PB,l=r<0?(e,t,r)=>f.push(e,t,r):(e,t,r)=>f.push(e,r,t);m5(new eB((e+t+P+k)/4,0),s,o),p.push(o.x,o.y,o.z),m.push(a.x,0,a.y),g.push(.5,.5);let c=v++;for(let e of n){let t=p.slice(3*e,3*e+3);p.push(...t),m.push(a.x,0,a.y);let r=g.slice(2*e,2*e+2);g.push(...r),v++}for(let e=c+1;e<v-1;e++)l(c,e,e+1);l(c,v-1,c+1)}o<2*Math.PI&&(H(-1,j[0],a),H(1,j[j.length-1],a+o)),this.setIndex(f),this.setAttribute("position",new Qz(p,3)),this.setAttribute("normal",new Qz(m,3)),this.setAttribute("uv",new Qz(g,2))}},y5=Math.PI/2,b5=class extends iF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:4;super(),this.type="BoxGeometry",n=Math.floor(n),i=Math.floor(i),s=Math.floor(s),o=Math.floor(o),a=Math.min(a,e/2,t/2,r/2);let l=[],c=[],u=[],h=[],d=0;function f(e,t,r,n,i,s,o,f,p,m){let g=(s-2*a)/p,v=(o-2*a)/m,y=s/2-a,b=o/2-a,w=f/2,x=p+1,S=m+1,_=0,C=new PB;for(let a=0;a<S;a++){let s=a*v-b;for(let o=0;o<x;o++){let l=o*g-y;C[e]=l*n,C[t]=s*i,C[r]=w,c.push(C.x,C.y,C.z),C[e]=0,C[t]=0,C[r]=f>0?1:-1,u.push(C.x,C.y,C.z),h.push(o/p),h.push(1-a/m),_+=1}}for(let a=0;a<m;a++)for(let e=0;e<p;e++){let t=d+e+x*a,r=d+e+x*(a+1),n=d+(e+1)+x*(a+1),i=d+(e+1)+x*a;l.push(t,r,i),l.push(r,n,i)}d+=_}function p(e,t,r,n,i,s,f,p,m,g){let v=(f-2*a)/g,y=f/2-a,b=p/2-a,w=m/2,x=g+1,S=0,_=new PB,C=new PB;for(let l=0;l<o+1;l++){let d=l/o*y5,f=Math.sin(d)*a,p=(1-Math.cos(d))*a,m=Math.sin(d),E=Math.cos(d);_[t]=(b+f)*i,_[r]=(w-p)*s,C[e]=0,C[t]=m*Math.sign(_[t]),C[r]=E*Math.sign(_[r]);for(let t=0;t<x;t++){let r=t*v-y;_[e]=r*n,c.push(_.x,_.y,_.z),u.push(C.x,C.y,C.z),h.push(t/g),h.push(0),S+=1}}for(let a=0;a<o;a++)for(let e=0;e<g;e++){let t=d+e+x*a,r=d+e+x*(a+1),n=d+(e+1)+x*(a+1),i=d+(e+1)+x*a;l.push(t,r,i),l.push(r,n,i)}d+=S}function m(n,i,s){let f=new PB,p=new PB(e/2,t/2,r/2);p.subScalar(a);let m=[],g=n*i*s>0?(e,t,r)=>l.push(e,t,r):(e,t,r)=>l.push(e,r,t);for(let e=0;e<=o;e++){let t=[],r=y5*(1-e/o),l=Math.cos(r),g=Math.sin(r),v=0;for(let o=0;o<=e;o++){let r=Math.cos(v),o=Math.sin(v);f.x=l*r,f.y=g,f.z=l*o;let m=p.clone().addScaledVector(f,a);c.push(n*m.x,i*m.y,s*m.z),u.push(n*f.x,i*f.y,s*f.z),h.push(0,0),t.push(d++),v+=y5/e}m.push(t)}let v=m.length-1;for(let e=0;e<v;e++){let t=m[e],r=m[e+1],n=t.length-1;g(t[0],r[1],r[0]);for(let e=1;e<=n;e++)g(t[e-1],t[e],r[e]),g(t[e],r[e+1],r[e])}}f("z","y","x",-1,-1,r,t,e,s,i),f("z","y","x",1,-1,r,t,-e,s,i),f("x","z","y",1,1,e,r,t,n,s),f("x","z","y",1,-1,e,r,-t,n,s),f("x","y","z",1,-1,e,t,r,n,i),f("x","y","z",-1,-1,e,t,-r,n,i),a>0&&(p("z","y","x",-1,-1,1,r,t,e,s),p("z","y","x",1,-1,-1,r,t,e,s),p("z","y","x",-1,1,-1,r,t,e,s),p("z","y","x",1,1,1,r,t,e,s),p("x","y","z",-1,-1,-1,e,t,r,n),p("x","y","z",1,-1,1,e,t,r,n),p("x","y","z",-1,1,1,e,t,r,n),p("x","y","z",1,1,-1,e,t,r,n),p("y","x","z",-1,-1,1,t,e,r,i),p("y","x","z",1,-1,-1,t,e,r,i),p("y","x","z",1,1,1,t,e,r,i),p("y","x","z",-1,1,-1,t,e,r,i),m(1,1,1),m(-1,1,1),m(1,-1,1),m(-1,-1,1),m(1,1,-1),m(-1,1,-1),m(1,-1,-1),m(-1,-1,-1)),this.setIndex(l),this.setAttribute("position",new Qz(c,3)),this.setAttribute("normal",new Qz(u,3)),this.setAttribute("uv",new Qz(h,2))}},w5=class extends iF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4;super(),this.type="PolyhedronGeometryRound";let a=[],o=[],l=[];return function(){i=Math.min(.99999,i),0==i&&(s=0);let o={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[r],c=new PB,u=c.clone(),h=new Uz,d=i*n,f=n-d,p=s+1,m=new PB,g=(e,t)=>m.subVectors(e,t).normalize(),v=(e,t)=>Array(e).fill(void 0).map(t),y=v(e.length/3,((t,r)=>(new PB).fromArray(e,3*r).setLength(n))),b=[],w=1e6;for(let e=0;e<y.length;e++){let r,n,i,s=y[e],a=[],o=1e10,l=-1;for(;-1!=(l=t.indexOf(e,l+1));){let e=l-l%3;r=t[e+(l+1)%3],n=t[e+(l+2)%3],i=s.distanceToSquared(y[r]),o=Math.min(o,i),a.push([r,n,i])}o+=1e-6;let c=[],u=0,h=a.length;for(let t=0;t<h;t++){var x;[r,n,i]=a[u];let t=1==(null===(x=b[r])||void 0===x?void 0:x.includes(e));i<=o&&c.push(r+ +t*w),u=a.findIndex((e=>e[0]==n))}b.push(c)}let S=[];{let e,t,r=0,n=0,i=3==o;for(let a=0;a<=s;a++){e=a*(a+1)/2,t=(a+1)*(a+2)/2;for(let o=0;o<s-a;o++)[r,n]=[e+o+a+2,t+o+a+3],S.push(e,t,...i?[n,e]:[r,t],n,r),[e,t]=[r,n];S.push(e,t,e+s+2)}}let _=c.clone(),C=c.clone(),E=c.clone(),A=c.clone(),M=c.clone(),T=[],P=v(y.length,(()=>v(o,(()=>c.clone()))));for(let e=0;e<y.length;e++){c.copy(y[e]).normalize(),_.copy(c).multiplyScalar(f);let t=b[e];for(let s=0;s<t.length;s++){let r=t[s],n=t[(s+1)%o];h.setFromPointsAndIndices(y,e,r%w,n%w),h.b.sub(h.a).setLength(1e10).add(h.a),h.c.sub(h.a).setLength(1e10).add(h.a),h.closestPointToPoint(_,P[e][s])}let r=[],n=[],i=[],v=new PB;0==s&&[...P[e]].reduce(((e,t)=>e.add(t)),v).multiplyScalar(1/o);for(let a=0;a<o;a++){let t=[],l=(a-1+o)%o,h=P[e][l],y=P[e][a];c.copy(h).sub(_),u.copy(y).sub(_);let b=_.angleTo(c),w=c.angleTo(u),x=Math.cos(b)*d;0==s?C.copy(v):C.copy(_).setLength(f+x),n.push(x);let S=[C,h,y];for(let e=0;e<2;e++){let n=S[e],i=S[e+1];A.subVectors(n,_),M.subVectors(i,_),E.crossVectors(A,M).normalize();for(let s=0;s<p;s++){let i=[b,w][e]*s/p;c.copy(A).applyAxisAngle(E,i).add(_),r.push(c.clone()),e&&(g(c,_),t.push([0==s?n:c.clone(),m.clone()]))}e&&(g(i,_),t.push([i,m.clone()]))}i.push(t)}T.push(i);let x=2*p,k=2;for(let e=0;e<o;e++){let t=x*e,i=x*((e+1)%o),s=[r[t]];for(let a=1;a<p;a++){A=r[t+a],M=r[i+a],s.push(A);for(let t=1,r=a-k+1;t<=r;t++)c.lerpVectors(A,M,t/(r+1)),c.sub(_).setLength(n[e]).add(_),s.push(c.clone());s.push(M)}for(let e=0;e<p;e++)s.push(r[e+p+t]);s.push(r[i+p]);let u=S.map((e=>s[e]));a.push(...u.map((e=>[e.x,e.y,e.z])).flat()),l.push(...u.map((e=>(g(e,_),[m.x,m.y,m.z]))).flat())}}let k=[];for(let e=0;e<b.length;e++)for(let t=0;t<o;t++){let r=b[e][t];if(r<w){let n=b[r].findIndex((t=>t%w==e)),i=T[e][t],s=T[r][n];for(let e=0;e<p;e++){let t=i[e],r=s[p-e],n=i[e+1];[t,r,n,n,r,s[p-(e+1)]].forEach((e=>{a.push(e[0].x,e[0].y,e[0].z),l.push(e[1].x,e[1].y,e[1].z)}))}k.push(i[0][0],s[p][0],i[p][0],s[0][0])}}for(;k.length;){let e,t,r,n;[e,t]=k.splice(0,2);let i=[e];for(;e!=t;)i.push(t),r=k.indexOf(t),n=r%2,t=k.splice(r-n,2)[1-n];m.subVectors(i[0],i[1]).cross(c.subVectors(i[0],i[2])).normalize();let s=m.dot(i[0])<0;s&&m.negate();for(let o=1;o<=i.length-2;o++)[i[o+ +s],i[o+1-+s],i[0]].forEach((e=>{a.push(e.x,e.y,e.z),l.push(m.x,m.y,m.z)}))}}(),function(){let e=new PB;for(let f=0;f<a.length;f+=3){e.x=a[f+0],e.y=a[f+1],e.z=a[f+2];let t=h(e)/2/Math.PI+.5,r=d(e)/Math.PI+.5;o.push(t,1-r)}let t=new PB,r=new PB,n=new PB,i=new PB,s=new eB,l=new eB,c=new eB,u=(e,t,r,n)=>{n<0&&1===e.x&&(o[t]=e.x-1),0===r.x&&0===r.z&&(o[t]=n/2/Math.PI+.5)};for(let f=0,p=0;f<a.length;f+=9,p+=6){t.set(a[f+0],a[f+1],a[f+2]),r.set(a[f+3],a[f+4],a[f+5]),n.set(a[f+6],a[f+7],a[f+8]),s.set(o[p+0],o[p+1]),l.set(o[p+2],o[p+3]),c.set(o[p+4],o[p+5]),i.copy(t).add(r).add(n).divideScalar(3);let e=h(i);u(s,p+0,t,e),u(l,p+2,r,e),u(c,p+4,n,e)}for(let a=0;a<o.length;a+=6){let e=o[a+0],t=o[a+2],r=o[a+4],n=Math.max(e,t,r),i=Math.min(e,t,r);n>.9&&i<.1&&(e<.2&&(o[a+0]+=1),t<.2&&(o[a+2]+=1),r<.2&&(o[a+4]+=1))}function h(e){return Math.atan2(e.z,-e.x)}function d(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}}(),this.setAttribute("position",new Qz(a,3)),this.setAttribute("normal",new Qz(l,3)),void this.setAttribute("uv",new Qz(o,2))}static fromJSON(e){return new w5(e.vertices,e.indices,e.radius,e.corner,e.cornerSides)}},x5=class extends w5{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=(1+Math.sqrt(5))/2,i=1/n,s="DodecahedronGeometry";super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],s,e,t,r),this.type=s}static fromJSON(e){return new x5(e.radius,e.corner,e.cornerSides)}},S5=1e-12,_5=class{constructor(e){this.position=new eB,this.startPosition=new eB,this.uuid=$N.generateUUID(),this.position=e.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(e){this.position.copy(this.startPosition).add(e)}copy(e){return this.position.copy(e.position),this.startPosition.copy(e.startPosition),this}clone(){return new _5(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},C5=class extends _5{constructor(e){super(e.position),this.parent=e}copy(e){return super.copy(e),this}clone(){return new C5(this.parent).copy(this)}},E5=class extends _5{constructor(e,t){super(t),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=e,this.controls.push(new C5(this),new C5(this))}static create(e,t){let r=new E5(e,new eB(...t.position));return r.controls[0].position.set(...t.controlPrevious.position),r.controls[1].position.set(...t.controlNext.position),r.roundness=t.roundness,r.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored,r}getOppositeControl(e){let t=this.controls.indexOf(e);return 0===t?this.controls[1]:1===t?this.controls[0]:null}applyOffsetToControls(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;for(let r=0,n=this.controls.length;r<n;r++){let n=this.controls[r];this.position.distanceTo(n.position)<=t?n.position.copy(this.position):n.applyOffset(e)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(e){return super.copy(e),this.controls[0].copy(e.controls[0]),this.controls[1].copy(e.controls[1]),this.roundness=e.roundness,this.uuid=e.uuid,this}clone(){return new E5(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var e,t;return[null===(e=this.curveBefore)||void 0===e?void 0:e.getTangentAt(1),null===(t=this.curveAfter)||void 0===t?void 0:t.getTangentAt(0)]}computeNormals(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new eB,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new eB,[r,n]=this.computeTangents();return r&&n&&(A5(r,e),A5(n,t)),[e,t]}computeTangent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new eB,[t,r]=this.computeTangents();return t&&r&&e.copy(t).add(r).normalize(),e}computeNormal(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new eB,[t,r]=this.computeNormals();return e.copy(t).add(r).normalize(),e}};function A5(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new eB,r=e.length();return t.set(-e.y/r,e.x/r)}var M5=new eB,T5=new eB,P5=new eB,k5=new eB,D5=new eB,I5=new eB,O5=new PB,R5=new PB;function L5(e){let t=new eB;t.addVectors(e.v0,M5.subVectors(e.v1,e.v0).multiplyScalar(2/3));let r=new eB;return r.addVectors(e.v2,T5.subVectors(e.v1,e.v2).multiplyScalar(2/3)),new rH(e.v0,t,r,e.v2)}function N5(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON;return Math.abs(e-t)<r}function B5(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON;return e.distanceTo(t)<r}function z5(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON;return e.distanceTo(t)<r}function F5(e,t,r){let n=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),i=Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2)),s=Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2));return Math.acos((i*i+n*n-s*s)/(2*i*n))}function j5(e,t,r){return q5(e,t)&&q5(t,r)&&U5(e.position,t.position,r.position)}function U5(e,t,r){return 0===M5.copy(t).sub(e).cross(T5.copy(r).sub(e))}function V5(e,t,r,n,i){let s=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),a=(e.y+t.y)/2,o=(e.x+t.x)/2,l=Math.sqrt(Math.pow(r,2)-Math.pow(s/2,2))*(e.y-t.y)/s,c=Math.sqrt(Math.pow(r,2)-Math.pow(s/2,2))*(t.x-e.x)/s;return n.set(o+l,a+c),i.set(o-l,a-c),[n,i]}function H5(e,t,r){return e.distanceTo(r)<t.distanceTo(r)?t:e}function W5(e,t,r,n,i,s){let a,o=t.x-e.x,l=t.y-e.y,c=r.x-e.x,u=r.y-e.y,h=Math.sqrt((o+c)*(o+c)+(l+u)*(l+u));return F5(t,e,r)>Math.PI&&(h*=-1),a=N5(u,l)?(l+u)*(n/h-.5)*8/3/(o-c):(o+c)*(n/h-.5)*8/3/(u-l),i.set(t.x-a*l,t.y+a*o),s.set(r.x+a*u,r.y-a*c),[i,s]}function G5(e,t){return e.position.equals(e.controls[1].position)&&t.position.equals(t.controls[0].position)}function q5(e,t){return U5(e.position,e.controls[1].position,t.position)&&U5(e.position,t.controls[0].position,t.position)}function X5(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[];for(let i=0,s=e.length;i<s;i++){let s=e[i],a=0;if(r&&void 0!==s.roundedCurveCorner){let e=.5*Y5(s.roundedCurveCorner,t);i>0&&(n[i-1]+=e),a+=e}void 0!==s.curveAfter&&(a+=Y5(s.curveAfter,t)),n.push(a)}return e.length>0&&r&&void 0!==e[0].roundedCurveCorner&&(n[e.length-1]+=.5*Y5(e[0].roundedCurveCorner,t)),n}function Y5(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return e&&e instanceof XV?2*t:e&&(e instanceof iH||e instanceof sH)?1:e&&e instanceof oH?t*e.points.length:t}var K5,Q5,Z5,J5=new eB,$5=new eB,e6=new eB,t6=new eB,r6=new eB,n6=new eB,i6=class extends gH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;super(),this.points=[],this.shapeHoles=[],this.plane=new LF(new PB(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this.isText=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=$N.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=e,this._height=t}static createFromState(e,t,r){let n=new i6;return n.isClosed=e.isClosed,n.points=e.points.map((e=>E5.create(e.id,e.data))),"number"==typeof e.roundness&&(n.roundness=e.roundness),n.shapeHoles=e.shapeHoles.map((e=>i6.createFromState(e))),void 0!==t&&void 0!==r&&n.applySize(t,r),n.update(),n}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(e){if(this._roundness!==e){this._roundness=e;for(let t=0,r=this.points.length;t<r;t++)this.points[t].roundness=e;this.needsUpdate=!0}}getPointsIndexesByIds(e){return e.map((e=>this.getPointIndexById(e))).filter((e=>e>=0))}getPointIndexById(e){let t=this.points.length,r=this.points.findIndex((t=>t.uuid===e));if(r<0){let r=t;for(let t=0,n=this.shapeHoles.length;t<n;t++){let n=this.shapeHoles[t],i=n.points.length,s=n.getPointIndexById(e);if(!(s<0))return s+r;r+=i}}return r}getLineIndexById(e){return this.getPointIndexById(e)}getBezierPoint(e){if(e<=this.points.length-1)return this.points[e];if(this.shapeHoles.length>0){let t=this.points.length;for(let r=0,n=this.shapeHoles.length;r<n;r++){let n=this.shapeHoles[r],i=e-t;if(i<=n.points.length-1)return n.points[i];t+=n.points.length}}throw new Error("This shape does not have a point for this index: "+e)}getBezierPointIndex(e){let t=this.points.indexOf(e);if(t>=0)return t;if(t=this.points.length,this.shapeHoles.length>0)for(let r=0,n=this.shapeHoles.length;r<n;r++){let n=this.shapeHoles[r],i=n.points.indexOf(e);if(i>=0)return t+i;t+=n.points.length}return-1}getAllPoints(){let e=[].concat(...this.shapeHoles.map((e=>e.points)));return[...this.points,...e]}applySize(e,t){0===e&&(e=.001),0===t&&(t=.001),this._width=e,this._height=t}applyScale(e,t){let r=J5.set(e,t);for(let n=0,i=this.points.length;n<i;n++){let e=this.points[n];e.position.multiply(r),e.controls[0].position.multiply(r),e.controls[1].position.multiply(r)}for(let n=0,i=this.shapeHoles.length;n<i;n++)this.shapeHoles[n].applyScale(e,t);this._update()}createPoint(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$N.generateUUID();t=e instanceof eB?e:new eB(e,r);let i=new E5(n,t);return i.roundness=this.roundness,i}addPoint(e){this.points.push(e),this.needsUpdate=!0}addPointAt(e,t){this.points.splice(t,0,e),this.needsUpdate=!0}getPointByUuid(e){for(let t=0,r=this.points.length;t<r;t++){let r=this.points[t];if(r.uuid===e)return r}for(let t=0,r=this.shapeHoles.length;t<r;t++){let r=this.shapeHoles[t].getPointByUuid(e);if(r)return r}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(e){let t=this.points.indexOf(e);t>=0&&this.points.splice(t,1),this.needsUpdate=!0}removePointById(e){let t=this.points.find((t=>t.uuid===e));t&&this.removePoint(t)}update(){for(let e=0,t=this.shapeHoles.length;e<t;e++)this.shapeHoles[e].update();this._update()}extractShapePointsToBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.subdivision=t,void 0===this.curveDivisions&&this.computeCurveDivisions(t);let n=r?this.roundedCurveDivisions:this.curveDivisions;return function(e,t){let r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=R5.set(0,0,0),a=0,o=[];for(let l=0;l<t.length;l++){let i=t[l],c=M5,u=Y5(i,n);o.push(u);for(let t=0;t<=u;t++)if(i instanceof rH||i instanceof aH||i instanceof iH){if(i.getPoint(t/u,c),s.set(c.x,c.y,0),void 0!==r&&z5(r,s))continue;void 0===r&&(r=O5),r.copy(s),e.setXYZ(a,s.x,s.y,s.z),a++}}i&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++)}(e,r?this.roundedCurves:this.curves,t,this.autoClose),n.reduce(((e,t)=>e+t),0)+1}computeCurveDivisions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;return this.curveDivisions=X5(this.points,e,!1),this.roundedCurveDivisions=X5(this.points,e,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12;return 2*function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=R5.set(0,0,0),a=0,o=[];for(let c=0;c<t.length;c++){if(!1===r[c])continue;let i,u=t[c],h=M5,d=Y5(u,n);o.push(d);for(let t=0;t<=d;t++)if(u instanceof rH||u instanceof aH||u instanceof iH){var l;if(u.getPoint(t/d,h),s.set(h.x,h.y,0),null!==(l=i)&&void 0!==l&&l.equals(s))continue;void 0===i?i=O5:(e.setXYZ(a,i.x,i.y,i.z),a++,e.setXYZ(a,s.x,s.y,s.z),a++),i.copy(s)}}return i&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),o}(e,this.curves,t,r,this.autoClose).reduce(((e,t)=>e+t),0)}extractShapePointsToFlatArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return this.subdivision=t,void 0===this.curveDivisions&&this.computeCurveDivisions(t),function(e,t){let r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=0;for(let a=0;a<t.length;a++){let i=t[a],o=Y5(i,n),l=M5;for(let t=0;t<=o;t++)if(i instanceof rH||i instanceof aH||i instanceof iH){if(i.getPoint(t/o,l),void 0!==r&&B5(r,l,S5))continue;void 0===r&&(r=T5),r.copy(l),e.push(l.x,l.y),s++}}return N5(e[0],e[e.length-2],S5)&&N5(e[1],e[e.length-1],S5)&&(e.pop(),e.pop()),i&&s>1&&!(N5(e[s-1],e[1],S5)&&N5(e[s-2],e[0],S5))&&(e.push(e[0],e[1]),s++),e}(e,this.roundedCurves,t,this.autoClose)}getCurveIndexFromVertexId(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=0;void 0===this.curveDivisions&&this.computeCurveDivisions(this.subdivision);let n=t?this.roundedCurveDivisions:this.curveDivisions,i=0;t&&void 0!==this.points[0].roundedCurveCorner&&(i=.5*Y5(this.points[0].roundedCurveCorner,this.subdivision));let s=e-i;s<0&&(s+=n.reduce(((e,t)=>e+t),0));for(let a=0,o=n.length;a<o;a++){let e=n[a];if(s<r+e)return[a,(s-r+1)/e];r+=e}return[0,1]}getCurveT(e,t,r){let n=this.points[e],i=this.points[e>=this.points.length-1?0:e+1],s=this.curveDivisions,a=s[e];if(G5(n,i)){let e=n.position.distanceTo(i.position);return n.position.distanceTo(J5.set(r.x,r.y))/e}let o=0;for(let l=0;l<e;l++)o+=s[l];return(t-o)/a}dispose(){}_applyCurveForPoint(e,t){G5(t,e)?this.lineTo(e.position.x,e.position.y):this.bezierCurveTo(t.controls[1].position.x,t.controls[1].position.y,e.controls[0].position.x,e.controls[0].position.y,e.position.x,e.position.y);let r=this.curves[this.curves.length-1];e.curveBefore=r,t.curveAfter=r;let n=r.clone();e.roundedCurveBefore=n,t.roundedCurveAfter=n,e.roundedCurveCorner=void 0,this.roundedCurves.push(n)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let n=0,i=this.points.length;n<i;n++){let e=this.points[n];if(0===n)this.moveTo(e.position.x,e.position.y);else{let t=this.points[n-1];this._applyCurveForPoint(e,t)}}let e=this.getLastPoint();if(null!==e&&void 0!==e&&e.curveAfter&&(e.curveAfter=void 0),this.isClosed){let e=this.points[0],t=this.points[this.points.length-1];this._applyCurveForPoint(e,t)}if(this.points.length>2){let e=0;for(let n=0,i=this.points.length;n<i;n++){var t,r;let i=this.points[n],s=null!==(t=this.points[n-1])&&void 0!==t?t:this.points[this.points.length-1],a=null!==(r=this.points[n+1])&&void 0!==r?r:this.points[0],o=i.roundness,l=s&&a&&j5(s,i,a);if(!i.controlsMoved()&&o>0&&!l){let t=i.curveBefore,r=i.curveAfter;if(void 0===t||void 0===r)continue;let s,a=i.roundedCurveBefore,l=i.roundedCurveAfter,c=t.getLength(),u=r.getLength(),h=Math.min(o,.499*c),d=Math.min(o,.499*u),f=Math.min(h,d),p=1-f/c,m=f/u,g=t.getPointAt(p,J5),v=r.getPointAt(m,$5);if(this._subSplitCurve(t,a,p,g,void 0),this._subSplitCurve(r,l,m,void 0,v),this.useCubicForRoundedCorners){let e=F5(g,i.position,v)/2,t=Math.tan(e)*g.distanceTo(i.position),[r,n]=V5(g,v,t,e6,t6),a=H5(r,n,i.position),[o,l]=W5(a,g,v,t,r6,n6);s=new rH(g.clone(),o.clone(),l.clone(),v.clone())}else s=new aH(g.clone(),i.position.clone(),v.clone());i.roundedCurveCorner=s,this.roundedCurves.splice(n+e,0,s),e++}}}}_subSplitCurve(e,t,r,n,i){if(!(e instanceof iH)){let s=e,a=t,o=s.getUtoTmapping(r,0),l=function(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,s=M5.subVectors(t,e).multiplyScalar(i).add(e),a=T5.subVectors(r,t).multiplyScalar(i).add(t),o=P5.subVectors(n,r).multiplyScalar(i).add(r),l=s,c=k5.subVectors(a,s).multiplyScalar(i).add(s),u=D5.subVectors(o,a).multiplyScalar(i).add(a),h=o,d=I5.subVectors(u,c).multiplyScalar(i).add(c);return[e.x,e.y,l.x,l.y,c.x,c.y,d.x,d.y,u.x,u.y,h.x,h.y,n.x,n.y]}(s.v0,s.v1,s.v2,s.v3,o);return void 0!==n&&(a.v0.set(l[0],l[1]),a.v1.set(l[2],l[3]),a.v2.set(l[4],l[5]),a.v3.set(l[6],l[7])),void 0!==i&&(a.v0.set(l[6],l[7]),a.v1.set(l[8],l[9]),a.v2.set(l[10],l[11]),a.v3.set(l[12],l[13])),a}return void 0!==n&&t.v2.copy(n),void 0!==i&&t.v1.copy(i),t}clone(){let e=new i6(this._width,this._height);return e.points=this.points.map((e=>e.clone())),e.isClosed=this.isClosed,e.roundness=this.roundness,e.isMesh2D=this.isMesh2D,e.shapeHoles=this.shapeHoles.map((e=>e.clone())),e}toJSON(){return{points:this.points.reduce(((e,t)=>e.concat(t.toJSON())),[]),shapeHoles:this.shapeHoles.map((e=>e.toJSON())),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(e){var t;this.points=[],this.pointIDs=0;let r=e.points.length/7;for(let n=0;n<r;n++){let t=7*n,r=e.points[t+0],i=e.points[t+1],s=e.points[t+2],a=e.points[t+3],o=e.points[t+4],l=e.points[t+5],c=e.points[t+6],u=new E5($N.generateUUID(),new eB(r,i));u.controls[0].position.set(s,a),u.controls[1].position.set(o,l),u.roundness=c,this.points.push(u)}return this.shapeHoles=null!==(t=e.shapeHoles)&&void 0!==t&&t.length?e.shapeHoles.map((e=>{let t=new i6;return t.fromJSON(e),t})):[],this.isClosed=e.isClosed,this._roundness=e.roundness,this._update(),this}fromShape(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isText=t;let r=(e,t)=>{t instanceof rH&&t.v3.equals(e.position)&&e.controls[0].position.copy(t.v2)};return this.points=(e=>{let t,n,i=[];for(t=0,n=e.length;t<n;t++)e[t]instanceof aH&&(e[t]=L5(e[t]));for(t=0,n=e.length;t<n;t++){let n,s=e[t],a=t>0?e[t-1]:null;s instanceof rH?(n=this.createPoint(s.v0),n.controls[1].position.copy(s.v1)):s instanceof iH&&(n=this.createPoint(s.v1)),void 0!==n&&(null!==a&&r(n,a),i.push(n))}let s=e[e.length-1],a=!1;return s instanceof rH?s.v3.equals(i[0].position)&&(i[0].controls[0].position.copy(s.v2),a=!0):s instanceof iH&&s.v2.equals(i[0].position)&&(a=!0),this.isClosed=a,i})(e.curves),e instanceof gH&&(this.shapeHoles=e.holes.map((e=>{let t=new i6;return t.fromShape(e),t}))),this.update(),this}updatePoint(e,t){let r=this.getPointByUuid(e);r&&(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.roundness&&(r.roundness=t.roundness),void 0!==t.areControlsDirectionsMirrored&&(r.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(e,t){var r;let n=null===(r=this.getPointByUuid(e))||void 0===r?void 0:r.controls[0];n&&(t.position&&n.position.fromArray(t.position),this.needsUpdate=!0)}updateNextControl(e,t){var r;let n=null===(r=this.getPointByUuid(e))||void 0===r?void 0:r.controls[1];n&&(t.position&&n.position.fromArray(t.position),this.needsUpdate=!0)}},s6=2*Math.PI;function a6(e,t,r,n,i){let{x:s,y:a}=e;return{x:s*t+n,y:a*r+i}}function o6(e,t){let r=1.5707963267948966===t?.551915024494:-1.5707963267948966===t?-.551915024494:1.3333333333333333*Math.tan(t/4),n=Math.cos(e),i=Math.sin(e),s=Math.cos(e+t),a=Math.sin(e+t);return[{x:n-i*r,y:i+n*r},{x:s+a*r,y:a-s*r},{x:s,y:a}]}function l6(e,t,r,n){let i=e*n-t*r<0?-1:1,s=Math.min(1,Math.max(-1,e*r+t*n));return i*Math.acos(s)}function c6(e){let{px:t,py:r,cx:n,cy:i,rx:s,ry:a,largeArcFlag:o,sweepFlag:l}=e,c=[];if(0===s||0===a)return[];let u=(t-n)/2,h=(r-i)/2;if(0===u&&0===h)return[];s=Math.abs(s),a=Math.abs(a);let d=Math.pow(u,2)/Math.pow(s,2)+Math.pow(h,2)/Math.pow(a,2);d>1&&(s*=Math.sqrt(d),a*=Math.sqrt(d));let f=function(e,t,r,n,i,s,a,o,l,c){let u=Math.pow(i,2),h=Math.pow(s,2),d=Math.pow(a,2),f=Math.pow(o,2),p=u*h-u*f-h*d;p<0&&(p=0),p/=u*f+h*d,p=Math.sqrt(p)*(l===c?-1:1);let m=p*i/s*o,g=p*-s/i*a,v=m+(e+r)/2,y=g+(t+n)/2,b=(a-m)/i,w=(o-g)/s,x=(-a-m)/i,S=(-o-g)/s,_=l6(1,0,b,w),C=l6(b,w,x,S);return!c&&C>0&&(C-=s6),c&&C<0&&(C+=s6),{centerx:v,centery:y,ang1:_,ang2:C}}(t,r,n,i,s,a,u,h,o,l),{ang1:p,ang2:m}=f,{centerx:g,centery:v}=f,y=Math.abs(m)/(s6/4);Math.abs(1-y)<1e-7&&(y=1);let b=Math.max(Math.ceil(y),1);m/=b;for(let w=0;w<b;w++)c.push(o6(p,m)),p+=m;return c.map((e=>{let{x:t,y:r}=a6(e[0],s,a,g,v),{x:n,y:i}=a6(e[1],s,a,g,v),{x:o,y:l}=a6(e[2],s,a,g,v);return{x1:t,y1:r,x2:n,y2:i,x:o,y:l}}))}function u6(e,t){if(!e)throw t||"Assertion Failed!"}(Q5=K5||(K5={}))[Q5.ODD=0]="ODD",Q5[Q5.NONZERO=1]="NONZERO",Q5[Q5.POSITIVE=2]="POSITIVE",Q5[Q5.NEGATIVE=3]="NEGATIVE",Q5[Q5.ABS_GEQ_TWO=4]="ABS_GEQ_TWO",function(e){e[e.POLYGONS=0]="POLYGONS",e[e.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",e[e.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"}(Z5||(Z5={}));var h6=function(){function e(){}return e.vertEq=function(e,t){return e.s===t.s&&e.t===t.t},e.vertLeq=function(e,t){return e.s<t.s||e.s===t.s&&e.t<=t.t},e.transLeq=function(e,t){return e.t<t.t||e.t===t.t&&e.s<=t.s},e.edgeGoesLeft=function(t){return e.vertLeq(t.Dst,t.Org)},e.edgeGoesRight=function(t){return e.vertLeq(t.Org,t.Dst)},e.vertL1dist=function(e,t){return Math.abs(e.s-t.s)+Math.abs(e.t-t.t)},e.edgeEval=function(t,r,n){u6(e.vertLeq(t,r)&&e.vertLeq(r,n));var i=r.s-t.s,s=n.s-r.s;return i+s>0?i<s?r.t-t.t+(t.t-n.t)*(i/(i+s)):r.t-n.t+(n.t-t.t)*(s/(i+s)):0},e.edgeSign=function(t,r,n){u6(e.vertLeq(t,r)&&e.vertLeq(r,n));var i=r.s-t.s,s=n.s-r.s;return i+s>0?(r.t-n.t)*i+(r.t-t.t)*s:0},e.transEval=function(t,r,n){u6(e.transLeq(t,r)&&e.transLeq(r,n));var i=r.t-t.t,s=n.t-r.t;return i+s>0?i<s?r.s-t.s+(t.s-n.s)*(i/(i+s)):r.s-n.s+(n.s-t.s)*(s/(i+s)):0},e.transSign=function(t,r,n){u6(e.transLeq(t,r)&&e.transLeq(r,n));var i=r.t-t.t,s=n.t-r.t;return i+s>0?(r.s-n.s)*i+(r.s-t.s)*s:0},e.vertCCW=function(e,t,r){return e.s*(t.t-r.t)+t.s*(r.t-e.t)+r.s*(e.t-t.t)>=0},e.interpolate=function(e,t,r,n){return(e=e<0?0:e)<=(r=r<0?0:r)?0===r?(t+n)/2:t+e/(e+r)*(n-t):n+r/(e+r)*(t-n)},e.intersect=function(t,r,n,i,s){var a,o,l;e.vertLeq(t,r)||(l=t,t=r,r=l),e.vertLeq(n,i)||(l=n,n=i,i=l),e.vertLeq(t,n)||(l=t,t=n,n=l,l=r,r=i,i=l),e.vertLeq(n,r)?e.vertLeq(r,i)?((a=e.edgeEval(t,n,r))+(o=e.edgeEval(n,r,i))<0&&(a=-a,o=-o),s.s=e.interpolate(a,n.s,o,r.s)):((a=e.edgeSign(t,n,r))+(o=-e.edgeSign(t,i,r))<0&&(a=-a,o=-o),s.s=e.interpolate(a,n.s,o,i.s)):s.s=(n.s+r.s)/2,e.transLeq(t,r)||(l=t,t=r,r=l),e.transLeq(n,i)||(l=n,n=i,i=l),e.transLeq(t,n)||(l=t,t=n,n=l,l=r,r=i,i=l),e.transLeq(n,r)?e.transLeq(r,i)?((a=e.transEval(t,n,r))+(o=e.transEval(n,r,i))<0&&(a=-a,o=-o),s.t=e.interpolate(a,n.t,o,r.t)):((a=e.transSign(t,n,r))+(o=-e.transSign(t,i,r))<0&&(a=-a,o=-o),s.t=e.interpolate(a,n.t,o,i.t)):s.t=(n.t+r.t)/2},e}(),d6=function(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1},f6=function(){function e(e){this.side=e,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(e.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(e){this.Sym.Lface=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(e){this.Sym.Org=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(e){this.Sym.Lnext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(e){this.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(e){this.Lnext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(e){this.Sym.Onext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(e){this.Sym.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(e){this.Sym.Lnext.Sym=e},enumerable:!0,configurable:!0}),e}(),p6=function(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0},m6=function(){function e(){var e=new p6,t=new d6,r=new f6(0),n=new f6(1);e.next=e.prev=e,e.anEdge=null,t.next=t.prev=t,r.next=r,r.Sym=n,n.next=n,n.Sym=r,this.vHead=e,this.fHead=t,this.eHead=r,this.eHeadSym=n}return e.prototype.makeEdge_=function(e){var t=new f6(0),r=new f6(1);e.Sym.side<e.side&&(e=e.Sym);var n=e.Sym.next;return r.next=n,n.Sym.next=t,t.next=e,e.Sym.next=r,t.Sym=r,t.Onext=t,t.Lnext=r,t.Org=null,t.Lface=null,t.winding=0,t.activeRegion=null,r.Sym=t,r.Onext=r,r.Lnext=t,r.Org=null,r.Lface=null,r.winding=0,r.activeRegion=null,t},e.prototype.splice_=function(e,t){var r=e.Onext,n=t.Onext;r.Sym.Lnext=t,n.Sym.Lnext=e,e.Onext=n,t.Onext=r},e.prototype.makeVertex_=function(e,t,r){var n=e;u6(n,"Vertex can't be null!");var i=r.prev;n.prev=i,i.next=n,n.next=r,r.prev=n,n.anEdge=t;var s=t;do{s.Org=n,s=s.Onext}while(s!==t)},e.prototype.makeFace_=function(e,t,r){var n=e;u6(n,"Face can't be null");var i=r.prev;n.prev=i,i.next=n,n.next=r,r.prev=n,n.anEdge=t,n.trail=null,n.marked=!1,n.inside=r.inside;var s=t;do{s.Lface=n,s=s.Lnext}while(s!==t)},e.prototype.killEdge_=function(e){e.Sym.side<e.side&&(e=e.Sym);var t=e.next,r=e.Sym.next;t.Sym.next=r,r.Sym.next=t},e.prototype.killVertex_=function(e,t){var r=e.anEdge,n=r;do{n.Org=t,n=n.Onext}while(n!==r);var i=e.prev,s=e.next;s.prev=i,i.next=s},e.prototype.killFace_=function(e,t){var r=e.anEdge,n=r;do{n.Lface=t,n=n.Lnext}while(n!==r);var i=e.prev,s=e.next;s.prev=i,i.next=s},e.prototype.makeEdge=function(){var e=new p6,t=new p6,r=new d6,n=this.makeEdge_(this.eHead);return this.makeVertex_(e,n,this.vHead),this.makeVertex_(t,n.Sym,this.vHead),this.makeFace_(r,n,this.fHead),n},e.prototype.splice=function(e,t){var r=!1,n=!1;if(e!==t){if(t.Org!==e.Org&&(n=!0,this.killVertex_(t.Org,e.Org)),t.Lface!==e.Lface&&(r=!0,this.killFace_(t.Lface,e.Lface)),this.splice_(t,e),!n){var i=new p6;this.makeVertex_(i,t,e.Org),e.Org.anEdge=e}if(!r){var s=new d6;this.makeFace_(s,t,e.Lface),e.Lface.anEdge=e}}},e.prototype.delete=function(e){var t=e.Sym,r=!1;if(e.Lface!==e.Rface&&(r=!0,this.killFace_(e.Lface,e.Rface)),e.Onext===e)this.killVertex_(e.Org,null);else if(e.Rface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev),!r){var n=new d6;this.makeFace_(n,e,e.Lface)}t.Onext===t?(this.killVertex_(t.Org,null),this.killFace_(t.Lface,null)):(e.Lface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev)),this.killEdge_(e)},e.prototype.addEdgeVertex=function(e){var t=this.makeEdge_(e),r=t.Sym;this.splice_(t,e.Lnext),t.Org=e.Dst;var n=new p6;return this.makeVertex_(n,r,t.Org),t.Lface=r.Lface=e.Lface,t},e.prototype.splitEdge=function(e){var t=this.addEdgeVertex(e).Sym;return this.splice_(e.Sym,e.Sym.Oprev),this.splice_(e.Sym,t),e.Dst=t.Org,t.Dst.anEdge=t.Sym,t.Rface=e.Rface,t.winding=e.winding,t.Sym.winding=e.Sym.winding,t.idx=e.idx,t.Sym.idx=e.Sym.idx,t},e.prototype.connect=function(e,t){var r=!1,n=this.makeEdge_(e),i=n.Sym;if(t.Lface!==e.Lface&&(r=!0,this.killFace_(t.Lface,e.Lface)),this.splice_(n,e.Lnext),this.splice_(i,t),n.Org=e.Dst,i.Org=t.Org,n.Lface=i.Lface=e.Lface,e.Lface.anEdge=i,!r){var s=new d6;this.makeFace_(s,n,e.Lface)}return n},e.prototype.zapFace=function(e){var t,r,n,i,s,a=e.anEdge;r=a.Lnext;do{r=(t=r).Lnext,t.Lface=null,null===t.Rface&&(t.Onext===t?this.killVertex_(t.Org,null):(t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev)),(n=t.Sym).Onext===n?this.killVertex_(n.Org,null):(n.Org.anEdge=n.Onext,this.splice_(n,n.Oprev)),this.killEdge_(t))}while(t!=a);i=e.prev,(s=e.next).prev=i,i.next=s},e.prototype.countFaceVerts_=function(e){var t=e.anEdge,r=0;do{r++,t=t.Lnext}while(t!==e.anEdge);return r},e.prototype.mergeConvexFaces=function(e){var t,r,n,i,s;for(t=this.fHead.next;t!==this.fHead;t=t.next)if(t.inside)for(s=(r=t.anEdge).Org;n=r.Lnext,(i=r.Sym)&&i.Lface&&i.Lface.inside&&(this.countFaceVerts_(t)+this.countFaceVerts_(i.Lface)-2<=e&&h6.vertCCW(r.Lprev.Org,r.Org,i.Lnext.Lnext.Org)&&h6.vertCCW(i.Lprev.Org,i.Org,r.Lnext.Lnext.Org)&&(n=i.Lnext,this.delete(i),r=null,i=null)),!r||r.Lnext.Org!==s;)r=n;return!0},e.prototype.check=function(){var e,t,r,n,i,s,a=this.fHead,o=this.vHead,l=this.eHead;for(t=a,t=a;(e=t.next)!==a;t=e){u6(e.prev===t),i=e.anEdge;do{u6(i.Sym!==i),u6(i.Sym.Sym===i),u6(i.Lnext.Onext.Sym===i),u6(i.Onext.Sym.Lnext===i),u6(i.Lface===e),i=i.Lnext}while(i!==e.anEdge)}for(u6(e.prev===t&&null===e.anEdge),n=o,n=o;(r=n.next)!==o;n=r){u6(r.prev===n),i=r.anEdge;do{u6(i.Sym!==i),u6(i.Sym.Sym===i),u6(i.Lnext.Onext.Sym===i),u6(i.Onext.Sym.Lnext===i),u6(i.Org===r),i=i.Onext}while(i!==r.anEdge)}for(u6(r.prev===n&&null===r.anEdge),s=l,s=l;(i=s.next)!==l;s=i)u6(i.Sym.next===s.Sym),u6(i.Sym!==i),u6(i.Sym.Sym===i),u6(null!==i.Org),u6(null!==i.Dst),u6(i.Lnext.Onext.Sym===i),u6(i.Onext.Sym.Lnext===i);u6(i.Sym.next===s.Sym&&i.Sym===this.eHeadSym&&i.Sym.Sym===i&&null===i.Org&&null===i.Dst&&null===i.Lface&&null===i.Rface)},e}(),g6=function(){this.handle=null},v6=function(){this.key=null,this.node=0},y6=function(){function e(e,t){this.leq=t,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=e,this.nodes=[],this.handles=[];for(var r=0;r<e+1;r++)this.nodes[r]=new g6,this.handles[r]=new v6;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return e.prototype.floatDown_=function(e){var t,r,n,i=this.nodes,s=this.handles;for(t=i[e].handle;;){if((n=e<<1)<this.size&&this.leq(s[i[n+1].handle].key,s[i[n].handle].key)&&++n,u6(n<=this.max),r=i[n].handle,n>this.size||this.leq(s[t].key,s[r].key)){i[e].handle=t,s[t].node=e;break}i[e].handle=r,s[r].node=e,e=n}},e.prototype.floatUp_=function(e){var t,r,n,i=this.nodes,s=this.handles;for(t=i[e].handle;;){if(r=i[n=e>>1].handle,0===n||this.leq(s[r].key,s[t].key)){i[e].handle=t,s[t].node=e;break}i[e].handle=r,s[r].node=e,e=n}},e.prototype.init=function(){for(var e=this.size;e>=1;--e)this.floatDown_(e);this.initialized=!0},e.prototype.min=function(){return this.handles[this.nodes[1].handle].key},e.prototype.insert=function(e){var t,r;if(2*(t=++this.size)>this.max){var n,i;for(this.max*=2,i=this.nodes.length,this.nodes.length=this.max+1,n=i;n<this.nodes.length;n++)this.nodes[n]=new g6;for(i=this.handles.length,this.handles.length=this.max+1,n=i;n<this.handles.length;n++)this.handles[n]=new v6}return 0===this.freeList?r=t:(r=this.freeList,this.freeList=this.handles[r].node),this.nodes[t].handle=r,this.handles[r].node=t,this.handles[r].key=e,this.initialized&&this.floatUp_(t),r},e.prototype.extractMin=function(){var e=this.nodes,t=this.handles,r=e[1].handle,n=t[r].key;return this.size>0&&(e[1].handle=e[this.size].handle,t[e[1].handle].node=1,t[r].key=null,t[r].node=this.freeList,this.freeList=r,--this.size,this.size>0&&this.floatDown_(1)),n},e.prototype.delete=function(e){var t,r=this.nodes,n=this.handles;u6(e>=1&&e<=this.max&&null!==n[e].key),r[t=n[e].node].handle=r[this.size].handle,n[r[t].handle].node=t,--this.size,t<=this.size&&(t<=1||this.leq(n[r[t>>1].handle].key,n[r[t].handle].key)?this.floatDown_(t):this.floatUp_(t)),n[e].key=null,n[e].node=this.freeList,this.freeList=e},e}(),b6=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},w6=function(){this.key=null,this.next=null,this.prev=null},x6=function(){function e(e,t){this.frame=e,this.leq=t,this.head=new w6,this.head.next=this.head,this.head.prev=this.head}return e.prototype.min=function(){return this.head.next},e.prototype.max=function(){return this.head.prev},e.prototype.insert=function(e){return this.insertBefore(this.head,e)},e.prototype.search=function(e){var t=this.head;do{t=t.next}while(null!==t.key&&!this.leq(this.frame,e,t.key));return t},e.prototype.insertBefore=function(e,t){do{e=e.prev}while(null!==e.key&&!this.leq(this.frame,e.key,t));var r=new w6;return r.key=t,r.next=e.next,e.next.prev=r,r.prev=e,e.next=r,r},e.prototype.delete=function(e){e.next.prev=e.prev,e.prev.next=e.next},e}(),S6=function(){function e(){}return e.regionBelow=function(e){return e.nodeUp.prev.key},e.regionAbove=function(e){return e.nodeUp.next.key},e.debugEvent=function(e){},e.addWinding=function(e,t){e.winding+=t.winding,e.Sym.winding+=t.Sym.winding},e.edgeLeq=function(e,t,r){var n=e.event,i=t.eUp,s=r.eUp;return i.Dst===n?s.Dst===n?h6.vertLeq(i.Org,s.Org)?h6.edgeSign(s.Dst,i.Org,s.Org)<=0:h6.edgeSign(i.Dst,s.Org,i.Org)>=0:h6.edgeSign(s.Dst,n,s.Org)<=0:s.Dst===n?h6.edgeSign(i.Dst,n,i.Org)>=0:h6.edgeEval(i.Dst,n,i.Org)>=h6.edgeEval(s.Dst,n,s.Org)},e.deleteRegion=function(e,t){t.fixUpperEdge&&u6(0===t.eUp.winding),t.eUp.activeRegion=null,e.dict.delete(t.nodeUp)},e.fixUpperEdge=function(e,t,r){u6(t.fixUpperEdge),e.mesh.delete(t.eUp),t.fixUpperEdge=!1,t.eUp=r,r.activeRegion=t},e.topLeftRegion=function(t,r){var n,i=r.eUp.Org;do{r=e.regionAbove(r)}while(r.eUp.Org===i);if(r.fixUpperEdge){if(null===(n=t.mesh.connect(e.regionBelow(r).eUp.Sym,r.eUp.Lnext)))return null;e.fixUpperEdge(t,r,n),r=e.regionAbove(r)}return r},e.topRightRegion=function(t){var r=t.eUp.Dst;do{t=e.regionAbove(t)}while(t.eUp.Dst===r);return t},e.addRegionBelow=function(e,t,r){var n=new b6;return n.eUp=r,n.nodeUp=e.dict.insertBefore(t.nodeUp,n),n.fixUpperEdge=!1,n.sentinel=!1,n.dirty=!1,r.activeRegion=n,n},e.isWindingInside=function(e,t){switch(e.windingRule){case K5.ODD:return 0!==(1&t);case K5.NONZERO:return 0!==t;case K5.POSITIVE:return t>0;case K5.NEGATIVE:return t<0;case K5.ABS_GEQ_TWO:return t>=2||t<=-2}throw new Error("Invalid winding rulle")},e.computeWinding=function(t,r){r.windingNumber=e.regionAbove(r).windingNumber+r.eUp.winding,r.inside=e.isWindingInside(t,r.windingNumber)},e.finishRegion=function(t,r){var n=r.eUp,i=n.Lface;i.inside=r.inside,i.anEdge=n,e.deleteRegion(t,r)},e.finishLeftRegions=function(t,r,n){for(var i,s=null,a=r,o=r.eUp;a!==n;){if(a.fixUpperEdge=!1,(i=(s=e.regionBelow(a)).eUp).Org!=o.Org){if(!s.fixUpperEdge){e.finishRegion(t,a);break}i=t.mesh.connect(o.Lprev,i.Sym),e.fixUpperEdge(t,s,i)}o.Onext!==i&&(t.mesh.splice(i.Oprev,i),t.mesh.splice(o,i)),e.finishRegion(t,a),o=s.eUp,a=s}return o},e.addRightEdges=function(t,r,n,i,s,a){var o,l,c,u,h=!0;c=n;do{u6(h6.vertLeq(c.Org,c.Dst)),e.addRegionBelow(t,r,c.Sym),c=c.Onext}while(c!==i);for(null===s&&(s=e.regionBelow(r).eUp.Rprev),l=r,u=s;(c=(o=e.regionBelow(l)).eUp.Sym).Org===u.Org;)c.Onext!==u&&(t.mesh.splice(c.Oprev,c),t.mesh.splice(u.Oprev,c)),o.windingNumber=l.windingNumber-c.winding,o.inside=e.isWindingInside(t,o.windingNumber),l.dirty=!0,!h&&e.checkForRightSplice(t,l)&&(e.addWinding(c,u),e.deleteRegion(t,l),t.mesh.delete(u)),h=!1,l=o,u=c;l.dirty=!0,u6(l.windingNumber-c.winding===o.windingNumber),a&&e.walkDirtyRegions(t,l)},e.spliceMergeVertices=function(e,t,r){e.mesh.splice(t,r)},e.vertexWeights=function(e,t,r){var n=h6.vertL1dist(t,e),i=h6.vertL1dist(r,e),s=.5*i/(n+i),a=.5*n/(n+i);e.coords[0]+=s*t.coords[0]+a*r.coords[0],e.coords[1]+=s*t.coords[1]+a*r.coords[1],e.coords[2]+=s*t.coords[2]+a*r.coords[2]},e.getIntersectData=function(t,r,n,i,s,a){r.coords[0]=r.coords[1]=r.coords[2]=0,r.idx=-1,e.vertexWeights(r,n,i),e.vertexWeights(r,s,a)},e.checkForRightSplice=function(t,r){var n=e.regionBelow(r),i=r.eUp,s=n.eUp;if(h6.vertLeq(i.Org,s.Org)){if(h6.edgeSign(s.Dst,i.Org,s.Org)>0)return!1;h6.vertEq(i.Org,s.Org)?i.Org!==s.Org&&(t.pq.delete(i.Org.pqHandle),e.spliceMergeVertices(t,s.Oprev,i)):(t.mesh.splitEdge(s.Sym),t.mesh.splice(i,s.Oprev),r.dirty=n.dirty=!0)}else{if(h6.edgeSign(i.Dst,s.Org,i.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(i.Sym),t.mesh.splice(s.Oprev,i)}return!0},e.checkForLeftSplice=function(t,r){var n,i=e.regionBelow(r),s=r.eUp,a=i.eUp;if(u6(!h6.vertEq(s.Dst,a.Dst)),h6.vertLeq(s.Dst,a.Dst)){if(h6.edgeSign(s.Dst,a.Dst,s.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,n=t.mesh.splitEdge(s),t.mesh.splice(a.Sym,n),n.Lface.inside=r.inside}else{if(h6.edgeSign(a.Dst,s.Dst,a.Org)>0)return!1;r.dirty=i.dirty=!0,n=t.mesh.splitEdge(a),t.mesh.splice(s.Lnext,a.Sym),n.Rface.inside=r.inside}return!0},e.checkForIntersect=function(t,r){var n,i,s=e.regionBelow(r),a=r.eUp,o=s.eUp,l=a.Org,c=o.Org,u=a.Dst,h=o.Dst,d=new p6;if(u6(!h6.vertEq(h,u)),u6(h6.edgeSign(u,t.event,l)<=0),u6(h6.edgeSign(h,t.event,c)>=0),u6(l!==t.event&&c!==t.event),u6(!r.fixUpperEdge&&!s.fixUpperEdge),l===c||Math.min(l.t,u.t)>Math.max(c.t,h.t))return!1;if(h6.vertLeq(l,c)){if(h6.edgeSign(h,l,c)>0)return!1}else if(h6.edgeSign(u,c,l)<0)return!1;return e.debugEvent(t),h6.intersect(u,l,h,c,d),u6(Math.min(l.t,u.t)<=d.t),u6(d.t<=Math.max(c.t,h.t)),u6(Math.min(h.s,u.s)<=d.s),u6(d.s<=Math.max(c.s,l.s)),h6.vertLeq(d,t.event)&&(d.s=t.event.s,d.t=t.event.t),n=h6.vertLeq(l,c)?l:c,h6.vertLeq(n,d)&&(d.s=n.s,d.t=n.t),h6.vertEq(d,l)||h6.vertEq(d,c)?(e.checkForRightSplice(t,r),!1):!h6.vertEq(u,t.event)&&h6.edgeSign(u,t.event,d)>=0||!h6.vertEq(h,t.event)&&h6.edgeSign(h,t.event,d)<=0?h===t.event?(t.mesh.splitEdge(a.Sym),t.mesh.splice(o.Sym,a),r=e.topLeftRegion(t,r),a=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),s),e.addRightEdges(t,r,a.Oprev,a,a,!0),!0):u===t.event?(t.mesh.splitEdge(o.Sym),t.mesh.splice(a.Lnext,o.Oprev),s=r,r=e.topRightRegion(r),i=e.regionBelow(r).eUp.Rprev,s.eUp=o.Oprev,o=e.finishLeftRegions(t,s,null),e.addRightEdges(t,r,o.Onext,a.Rprev,i,!0),!0):(h6.edgeSign(u,t.event,d)>=0&&(e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(a.Sym),a.Org.s=t.event.s,a.Org.t=t.event.t),h6.edgeSign(h,t.event,d)<=0&&(r.dirty=s.dirty=!0,t.mesh.splitEdge(o.Sym),o.Org.s=t.event.s,o.Org.t=t.event.t),!1):(t.mesh.splitEdge(a.Sym),t.mesh.splitEdge(o.Sym),t.mesh.splice(o.Oprev,a),a.Org.s=d.s,a.Org.t=d.t,a.Org.pqHandle=t.pq.insert(a.Org),e.getIntersectData(t,a.Org,l,u,c,h),e.regionAbove(r).dirty=r.dirty=s.dirty=!0,!1)},e.walkDirtyRegions=function(t,r){for(var n,i,s=e.regionBelow(r);;){for(;s.dirty;)r=s,s=e.regionBelow(s);if(!r.dirty&&(s=r,null===(r=e.regionAbove(r))||!r.dirty))return;if(r.dirty=!1,n=r.eUp,i=s.eUp,n.Dst!==i.Dst&&e.checkForLeftSplice(t,r)&&(s.fixUpperEdge?(e.deleteRegion(t,s),t.mesh.delete(i),i=(s=e.regionBelow(r)).eUp):r.fixUpperEdge&&(e.deleteRegion(t,r),t.mesh.delete(n),n=(r=e.regionAbove(s)).eUp)),n.Org!==i.Org)if(n.Dst===i.Dst||r.fixUpperEdge||s.fixUpperEdge||n.Dst!==t.event&&i.Dst!==t.event)e.checkForRightSplice(t,r);else if(e.checkForIntersect(t,r))return;n.Org===i.Org&&n.Dst===i.Dst&&(e.addWinding(i,n),e.deleteRegion(t,r),t.mesh.delete(n),r=e.regionAbove(s))}},e.connectRightVertex=function(t,r,n){var i,s=n.Onext,a=e.regionBelow(r),o=r.eUp,l=a.eUp,c=!1;o.Dst!==l.Dst&&e.checkForIntersect(t,r),h6.vertEq(o.Org,t.event)&&(t.mesh.splice(s.Oprev,o),r=e.topLeftRegion(t,r),s=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),a),c=!0),h6.vertEq(l.Org,t.event)&&(t.mesh.splice(n,l.Oprev),n=e.finishLeftRegions(t,a,null),c=!0),c?e.addRightEdges(t,r,n.Onext,s,s,!0):(i=h6.vertLeq(l.Org,o.Org)?l.Oprev:o,i=t.mesh.connect(n.Lprev,i),e.addRightEdges(t,r,i,i.Onext,i.Onext,!1),i.Sym.activeRegion.fixUpperEdge=!0,e.walkDirtyRegions(t,r))},e.connectLeftDegenerate=function(t,r,n){var i,s,a,o,l;return i=r.eUp,h6.vertEq(i.Org,n)?(u6(!1),void e.spliceMergeVertices(t,i,n.anEdge)):h6.vertEq(i.Dst,n)?(u6(!1),r=e.topRightRegion(r),s=o=(a=(l=e.regionBelow(r)).eUp.Sym).Onext,l.fixUpperEdge&&(u6(s!==a),e.deleteRegion(t,l),t.mesh.delete(a),a=s.Oprev),t.mesh.splice(n.anEdge,a),h6.edgeGoesLeft(s)||(s=null),void e.addRightEdges(t,r,a.Onext,o,s,!0)):(t.mesh.splitEdge(i.Sym),r.fixUpperEdge&&(t.mesh.delete(i.Onext),r.fixUpperEdge=!1),t.mesh.splice(n.anEdge,i),void e.sweepEvent(t,n))},e.connectLeftVertex=function(t,r){var n,i,s,a,o,l,c=new b6;if(c.eUp=r.anEdge.Sym,n=t.dict.search(c).key,i=e.regionBelow(n)){if(a=n.eUp,o=i.eUp,0===h6.edgeSign(a.Dst,r,a.Org))return void e.connectLeftDegenerate(t,n,r);if(s=h6.vertLeq(o.Dst,a.Dst)?n:i,n.inside||s.fixUpperEdge){if(s===n)l=t.mesh.connect(r.anEdge.Sym,a.Lnext);else l=t.mesh.connect(o.Dnext,r.anEdge).Sym;s.fixUpperEdge?e.fixUpperEdge(t,s,l):e.computeWinding(t,e.addRegionBelow(t,n,l)),e.sweepEvent(t,r)}else e.addRightEdges(t,n,r.anEdge,r.anEdge,null,!0)}},e.sweepEvent=function(t,r){t.event=r,e.debugEvent(t);for(var n=r.anEdge;null===n.activeRegion;)if((n=n.Onext)===r.anEdge)return void e.connectLeftVertex(t,r);var i=e.topLeftRegion(t,n.activeRegion);u6(null!==i);var s=e.regionBelow(i),a=s.eUp,o=e.finishLeftRegions(t,s,null);o.Onext===a?e.connectRightVertex(t,i,o):e.addRightEdges(t,i,o.Onext,a,a,!0)},e.addSentinel=function(e,t,r,n){var i=new b6,s=e.mesh.makeEdge();s.Org.s=r,s.Org.t=n,s.Dst.s=t,s.Dst.t=n,e.event=s.Dst,i.eUp=s,i.windingNumber=0,i.inside=!1,i.fixUpperEdge=!1,i.sentinel=!0,i.dirty=!1,i.nodeUp=e.dict.insert(i)},e.initEdgeDict=function(t){t.dict=new x6(t,e.edgeLeq);var r=t.bmax[0]-t.bmin[0],n=t.bmax[1]-t.bmin[1],i=t.bmin[0]-r,s=t.bmax[0]+r,a=t.bmin[1]-n,o=t.bmax[1]+n;e.addSentinel(t,i,s,a),e.addSentinel(t,i,s,o)},e.doneEdgeDict=function(t){for(var r,n=0;null!==(r=t.dict.min().key);)r.sentinel||(u6(r.fixUpperEdge),u6(1===++n)),u6(0===r.windingNumber),e.deleteRegion(t,r)},e.removeDegenerateEdges=function(t){var r,n,i,s=t.mesh.eHead;for(r=s.next;r!==s;r=n)n=r.next,i=r.Lnext,h6.vertEq(r.Org,r.Dst)&&r.Lnext.Lnext!==r&&(e.spliceMergeVertices(t,i,r),t.mesh.delete(r),i=(r=i).Lnext),i.Lnext===r&&(i!==r&&((i===n||i===n.Sym)&&(n=n.next),t.mesh.delete(i)),(r===n||r===n.Sym)&&(n=n.next),t.mesh.delete(r))},e.initPriorityQ=function(e){var t,r,n,i=0;for(r=(n=e.mesh.vHead).next;r!==n;r=r.next)i++;for(i+=8,t=e.pq=new y6(i,h6.vertLeq),r=(n=e.mesh.vHead).next;r!==n;r=r.next)r.pqHandle=t.insert(r);return r===n&&(t.init(),!0)},e.donePriorityQ=function(e){e.pq=null},e.removeDegenerateFaces=function(t,r){var n,i,s;for(n=r.fHead.next;n!==r.fHead;n=i)i=n.next,u6((s=n.anEdge).Lnext!==s),s.Lnext.Lnext===s&&(e.addWinding(s.Onext,s),t.mesh.delete(s));return!0},e.computeInterior=function(t,r){var n,i;if(void 0===r&&(r=!0),e.removeDegenerateEdges(t),!e.initPriorityQ(t))return!1;for(e.initEdgeDict(t);null!==(n=t.pq.extractMin());){for(;null!==(i=t.pq.min())&&h6.vertEq(i,n);)i=t.pq.extractMin(),e.spliceMergeVertices(t,n.anEdge,i.anEdge);e.sweepEvent(t,n)}return t.event=t.dict.min().key.eUp.Org,e.debugEvent(t),e.doneEdgeDict(t),e.donePriorityQ(t),!!e.removeDegenerateFaces(t,t.mesh)&&(r&&t.mesh.check(),!0)},e}(),_6=function(){function e(){this.mesh=new m6,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=K5.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return e.prototype.dot_=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.prototype.normalize_=function(e){var t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(!t)throw"Zero-size vector!";t=Math.sqrt(t),e[0]/=t,e[1]/=t,e[2]/=t},e.prototype.longAxis_=function(e){var t=0;return Math.abs(e[1])>Math.abs(e[0])&&(t=1),Math.abs(e[2])>Math.abs(e[t])&&(t=2),t},e.prototype.computeNormal_=function(e){var t,r,n,i,s,a,o=[0,0,0],l=[0,0,0],c=[0,0,0],u=[0,0,0],h=[0,0,0],d=[null,null,null],f=[null,null,null],p=this.mesh.vHead;t=p.next;for(var m=0;m<3;++m)i=t.coords[m],l[m]=i,f[m]=t,o[m]=i,d[m]=t;for(t=p.next;t!==p;t=t.next)for(var g=0;g<3;++g)(i=t.coords[g])<l[g]&&(l[g]=i,f[g]=t),i>o[g]&&(o[g]=i,d[g]=t);var v=0;if(o[1]-l[1]>o[0]-l[0]&&(v=1),o[2]-l[2]>o[v]-l[v]&&(v=2),l[v]>=o[v])return e[0]=0,e[1]=0,void(e[2]=1);for(a=0,r=f[v],n=d[v],c[0]=r.coords[0]-n.coords[0],c[1]=r.coords[1]-n.coords[1],c[2]=r.coords[2]-n.coords[2],t=p.next;t!==p;t=t.next)u[0]=t.coords[0]-n.coords[0],u[1]=t.coords[1]-n.coords[1],u[2]=t.coords[2]-n.coords[2],h[0]=c[1]*u[2]-c[2]*u[1],h[1]=c[2]*u[0]-c[0]*u[2],h[2]=c[0]*u[1]-c[1]*u[0],(s=h[0]*h[0]+h[1]*h[1]+h[2]*h[2])>a&&(a=s,e[0]=h[0],e[1]=h[1],e[2]=h[2]);a<=0&&(e[0]=e[1]=e[2]=0,e[this.longAxis_(c)]=1)},e.prototype.checkOrientation_=function(){for(var e,t,r=this.mesh.fHead,n=this.mesh.vHead,i=0,s=r.next;s!==r;s=s.next)if(!((t=s.anEdge).winding<=0))do{i+=(t.Org.s-t.Dst.s)*(t.Org.t+t.Dst.t),t=t.Lnext}while(t!==s.anEdge);if(i<0){for(e=n.next;e!==n;e=e.next)e.t=-e.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},e.prototype.projectPolygon_=function(){var e,t,r=this.mesh.vHead,n=[0,0,0],i=!1;n[0]=this.normal[0],n[1]=this.normal[1],n[2]=this.normal[2],!n[0]&&!n[1]&&!n[2]&&(this.computeNormal_(n),i=!0),e=this.sUnit,t=this.tUnit;var s=this.longAxis_(n);e[s]=0,e[(s+1)%3]=1,e[(s+2)%3]=0,t[s]=0,t[(s+1)%3]=0,t[(s+2)%3]=n[s]>0?1:-1;for(var a=r.next;a!==r;a=a.next)a.s=this.dot_(a.coords,e),a.t=this.dot_(a.coords,t);i&&this.checkOrientation_();for(var o=!0,l=r.next;l!==r;l=l.next)o?(this.bmin[0]=this.bmax[0]=l.s,this.bmin[1]=this.bmax[1]=l.t,o=!1):(l.s<this.bmin[0]&&(this.bmin[0]=l.s),l.s>this.bmax[0]&&(this.bmax[0]=l.s),l.t<this.bmin[1]&&(this.bmin[1]=l.t),l.t>this.bmax[1]&&(this.bmax[1]=l.t))},e.prototype.addWinding_=function(e,t){e.winding+=t.winding,e.Sym.winding+=t.Sym.winding},e.prototype.tessellateMonoRegion_=function(e,t){var r,n;if((r=t.anEdge).Lnext===r||r.Lnext.Lnext===r)throw"Mono region invalid";for(;h6.vertLeq(r.Dst,r.Org);r=r.Lprev);for(;h6.vertLeq(r.Org,r.Dst);r=r.Lnext);n=r.Lprev;for(;r.Lnext!==n;)if(h6.vertLeq(r.Dst,n.Org)){for(;n.Lnext!==r&&(h6.edgeGoesLeft(n.Lnext)||h6.edgeSign(n.Org,n.Dst,n.Lnext.Dst)<=0);)n=e.connect(n.Lnext,n).Sym;n=n.Lprev}else{for(;n.Lnext!==r&&(h6.edgeGoesRight(r.Lprev)||h6.edgeSign(r.Dst,r.Org,r.Lprev.Org)>=0);)r=e.connect(r,r.Lprev).Sym;r=r.Lnext}if(n.Lnext===r)throw"Mono region invalid";for(;n.Lnext.Lnext!==r;)n=e.connect(n.Lnext,n).Sym;return!0},e.prototype.tessellateInterior_=function(e){for(var t,r=e.fHead.next;r!==e.fHead;r=t)if(t=r.next,r.inside&&!this.tessellateMonoRegion_(e,r))return!1;return!0},e.prototype.discardExterior_=function(e){for(var t,r=e.fHead.next;r!==e.fHead;r=t)t=r.next,r.inside||e.zapFace(r)},e.prototype.setWindingNumber_=function(e,t,r){for(var n,i=e.eHead.next;i!==e.eHead;i=n)n=i.next,i.Rface.inside!==i.Lface.inside?i.winding=i.Lface.inside?t:-t:r?e.delete(i):i.winding=0},e.prototype.getNeighbourFace_=function(e){return e.Rface&&e.Rface.inside?e.Rface.n:-1},e.prototype.outputPolymesh_=function(e,t,r,n){var i,s,a=0,o=0;r>3&&e.mergeConvexFaces(r);for(var l=e.vHead.next;l!==e.vHead;l=l.next)l.n=-1;for(var c=e.fHead.next;c!==e.fHead;c=c.next)if(c.n=-1,c.inside){i=c.anEdge,s=0;do{-1===(l=i.Org).n&&(l.n=o,o++),s++,i=i.Lnext}while(i!==c.anEdge);if(s>r)throw"Face vertex greater that support polygon";c.n=a,++a}this.elementCount=a,t===Z5.CONNECTED_POLYGONS&&(a*=2),this.elements=[],this.elements.length=a*r,this.vertexCount=o,this.vertices=[],this.vertices.length=o*n,this.vertexIndices=[],this.vertexIndices.length=o;for(l=e.vHead.next;l!==e.vHead;l=l.next)if(-1!==l.n){var u=l.n*n;this.vertices[u+0]=l.coords[0],this.vertices[u+1]=l.coords[1],n>2&&(this.vertices[u+2]=l.coords[2]),this.vertexIndices[l.n]=l.idx}var h=0;for(c=e.fHead.next;c!==e.fHead;c=c.next)if(c.inside){i=c.anEdge,s=0;do{l=i.Org;this.elements[h++]=l.n,s++,i=i.Lnext}while(i!==c.anEdge);for(var d=s;d<r;++d)this.elements[h++]=-1;if(t===Z5.CONNECTED_POLYGONS){i=c.anEdge;do{this.elements[h++]=this.getNeighbourFace_(i),i=i.Lnext}while(i!==c.anEdge);for(var f=s;f<r;++f)this.elements[h++]=-1}}},e.prototype.outputContours_=function(e,t){var r,n,i=0,s=0;this.vertexCount=0,this.elementCount=0;for(var a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){n=r=a.anEdge;do{this.vertexCount++,r=r.Lnext}while(r!==n);this.elementCount++}this.elements=[],this.elements.length=2*this.elementCount,this.vertices=[],this.vertices.length=this.vertexCount*t,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var o=0,l=0,c=0;i=0;for(a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){s=0,n=r=a.anEdge;do{this.vertices[o++]=r.Org.coords[0],this.vertices[o++]=r.Org.coords[1],t>2&&(this.vertices[o++]=r.Org.coords[2]),this.vertexIndices[l++]=this.vertexIdCallback?this.vertexIdCallback(r):r.Org.idx,s++,r=r.Lnext}while(r!==n);this.elements[c++]=i,this.elements[c++]=s,i+=s}},e.prototype.addContour=function(e,t){null===this.mesh&&(this.mesh=new m6),e<2&&(e=2),e>3&&(e=3);for(var r=null,n=0;n<t.length;n+=e)null===r?(r=this.mesh.makeEdge(),this.mesh.splice(r,r.Sym)):(this.mesh.splitEdge(r),r=r.Lnext),r.Org.coords[0]=t[n+0],r.Org.coords[1]=t[n+1],r.Org.coords[2]=e>2?t[n+2]:0,r.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(r),r.winding=1,r.Sym.winding=-1},e.prototype.tesselate=function(e,t,r,n,i,s){if(void 0===e&&(e=K5.ODD),void 0===t&&(t=Z5.POLYGONS),void 0===s&&(s=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,i&&(this.normal[0]=i[0],this.normal[1]=i[1],this.normal[2]=i[2]),this.windingRule=e,n<2&&(n=2),n>3&&(n=3),!this.mesh)return!1;this.projectPolygon_(),S6.computeInterior(this,s);var a=this.mesh;return t===Z5.BOUNDARY_CONTOURS?this.setWindingNumber_(a,1,!0):this.tessellateInterior_(a),s&&a.check(),t===Z5.BOUNDARY_CONTOURS?this.outputContours_(a,n):this.outputPolymesh_(a,t,r,n),!0},e}();function C6(e){var t=e.windingRule,r=void 0===t?K5.ODD:t,n=e.elementType,i=void 0===n?Z5.POLYGONS:n,s=e.polySize,a=void 0===s?3:s,o=e.vertexSize,l=void 0===o?2:o,c=e.normal,u=void 0===c?[0,0,1]:c,h=e.contours,d=void 0===h?[]:h,f=e.strict,p=void 0===f||f,m=e.debug,g=void 0!==m&&m;if(!d&&p)throw new Error("Contours can't be empty");if(d){var v=new _6;e.edgeCreateCallback&&(v.edgeCreateCallback=e.edgeCreateCallback),e.vertexIdCallback&&(v.vertexIdCallback=e.vertexIdCallback);for(var y=0;y<d.length;y++)v.addContour(l||2,d[y]);return v.tesselate(r,i,a,l,u,p),{vertices:v.vertices,vertexIndices:v.vertexIndices,vertexCount:v.vertexCount,elements:v.elements,elementCount:v.elementCount,mesh:g?v.mesh:void 0}}}K5.ODD,K5.NONZERO,K5.POSITIVE,K5.NEGATIVE,K5.ABS_GEQ_TWO,Z5.POLYGONS,Z5.CONNECTED_POLYGONS,Z5.BOUNDARY_CONTOURS;var E6=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.capacity=e,this.size=0,this.debug=t,this.debug&&console.log("allocating with cap ".concat(e));let r=e*E6.eSize;this.buffer=new ArrayBuffer(r);let n=Float32Array.BYTES_PER_ELEMENT,i=0;this.positions=new Float32Array(this.buffer,i*n,3*e),i+=3*e,this.normals=new Float32Array(this.buffer,i*n,3*e),i+=3*e,this.uvs=new Float32Array(this.buffer,i*n,2*e)}realloc(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e<this.size)throw Error("cannot shrink buffer");if(e<=this.capacity&&!t)return;this.debug&&console.log("resizing from ".concat(this.capacity," \u2192 ").concat(e));let r=e*E6.eSize,n=new ArrayBuffer(r),i=Float32Array.BYTES_PER_ELEMENT,s=0,a=new Float32Array(n,s*i,3*e);s+=3*e;let o=new Float32Array(n,s*i,3*e);s+=3*e;let l=new Float32Array(n,s*i,2*e);t?(a.set(this.positions.subarray(0,3*this.size)),o.set(this.normals.subarray(0,3*this.size)),l.set(this.uvs.subarray(0,2*this.size))):(a.set(this.positions),o.set(this.normals),l.set(this.uvs)),this.buffer=n,this.positions=a,this.normals=o,this.uvs=l,this.capacity=e}get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.size+e;if(t>this.capacity){let e=this.capacity;for(;t>e;)e*=2;this.realloc(e)}let r=this.size;return this.size=t,r}reserve(e){let t=this.size+e;t>this.capacity&&this.realloc(t)}shrink(){this.debug&&console.log("shrinking ".concat(this.capacity," \u2192 ").concat(this.size)),this.realloc(this.size,!0)}},A6=E6;A6.eSize=8*Float32Array.BYTES_PER_ELEMENT;var M6=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t)=>e<t?-1:e>t?1:0;if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;let e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:t,compare:r}=this,n=t[e];for(;e>0;){let i=e-1>>1,s=t[i];if(r(n,s)>=0)break;t[e]=s,e=i}t[e]=n}_down(e){let{data:t,compare:r}=this,n=this.length>>1,i=t[e];for(;e<n;){let n=1+(e<<1),s=n+1;if(s<this.length&&r(t[s],t[n])<0&&(n=s),r(t[n],i)>=0)break;t[e]=t[n],e=n}t[e]=i}};function T6(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=1/0,s=1/0,a=-1/0,o=-1/0;for(let[y,b]of e[0])y<i&&(i=y),b<s&&(s=b),y>a&&(a=y),b>o&&(o=b);let l=a-i,c=o-s,u=Math.max(r,Math.min(l,c));if(u===r){let e=[i,s];return e.distance=0,e.distance}let h=new M6([],((e,t)=>t.max-e.max)),d=function(e){let t=0,r=0,n=0,i=e[0];for(let a=0,o=i.length,l=o-1;a<o;l=a++){let e=i[a],s=i[l],o=e[0]*s[1]-s[0]*e[1];r+=(e[0]+s[0])*o,n+=(e[1]+s[1])*o,t+=3*o}let s=new P6(r/t,n/t,0,e);return 0===t||s.d<0?new P6(i[0][0],i[0][1],0,e):s}(e),f=new P6(i+l/2,s+c/2,0,e);f.d>d.d&&(d=f);let p=2;function m(i,s,a){let o=new P6(i,s,a,e);if(p++,o.max>d.d+r&&h.push(o),o.d>d.d&&(d=o,n&&console.log("found best ".concat(Math.round(1e4*o.d)/1e4," after ").concat(p," probes")),d.d>t))return t}let g=u/2;for(let y=i;y<a;y+=u)for(let e=s;e<o;e+=u)m(y+g,e+g,g);for(;h.length;){let{max:e,x:t,y:n,h:i}=h.pop();if(e-d.d<=r)break;g=i/2,m(t-g,n-g,g),m(t+g,n-g,g),m(t-g,n+g,g),m(t+g,n+g,g)}n&&console.log("num probes: ".concat(p,"\nbest distance: ").concat(d.d));let v=[d.x,d.y];return v.distance=d.d,v.distance}function P6(e,t,r,n){this.x=e,this.y=t,this.h=r,this.d=function(e,t,r){let n=!1,i=1/0;for(let s of r)for(let r=0,a=s.length,o=a-1;r<a;o=r++){let a=s[r],l=s[o];a[1]>t!=l[1]>t&&e<(l[0]-a[0])*(t-a[1])/(l[1]-a[1])+a[0]&&(n=!n),i=Math.min(i,k6(e,t,a,l))}return 0===i?0:(n?1:-1)*Math.sqrt(i)}(e,t,n),this.max=this.d+this.h*Math.SQRT2}function k6(e,t,r,n){let i=r[0],s=r[1],a=n[0]-i,o=n[1]-s;if(0!==a||0!==o){let r=((e-i)*a+(t-s)*o)/(a*a+o*o);r>1?(i=n[0],s=n[1]):r>0&&(i+=a*r,s+=o*r)}return a=e-i,o=t-s,a*a+o*o}var D6={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},I6={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},O6={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},R6=(e,t)=>r=>{let[n,i]=r;return i<n&&(i+=t),(e>=n?e:e+t)<=i},L6=class extends iF{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:K5.ODD,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];super(),this.forPathBevel=a,this.type="ShapeGeometry",this.vertexCache={},this._shape=e,this._depth=t,this._curveSegments=n,this._bevelSegmentsInput=i;let o,l,c,u=this._shape.extractShapePointsToFlatArray([],n),h=this._shape.shapeHoles.map((e=>{let t=e.extractShapePointsToFlatArray([],n),r=[];for(let n=t.length-1;n>=1;n-=2){let e=t[n-1],i=t[n-0];r.push(e,i)}return r})),d=[],f=[];for(let T=0;T<u.length;T+=2)f.push([u[T],u[T+1]]);d.push(f);for(let T=0;T<h.length;T++){let e=h[T],t=[];for(let r=0;r<e.length;r+=2)t.push([e[r],e[r+1]]);d.push(t)}o=e.isText?.1*(new hG).setFromPoints(e.points.map((e=>e.position))).getSize(new eB).length():0===d[0].length?r:r>0?T6(d,r):1e-5,r<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(r,o,t/2),this._bevelSegments=Math.floor(i));try{l=C6({windingRule:s,elementType:Z5.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[u]})}catch(E){l=D6}try{c=C6({windingRule:K5.ODD,elementType:Z5.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...h]})}catch(A){c=I6}if(!l)throw new Error("error generating geometry");let p=l.elementCount;if(c){l.elementCount+=c.elementCount;for(let e=0;e<c.elements.length;e++){let t=c.elements[e],r=e%2===0?l.vertexCount:0;l.elements.push(t+r)}for(let e=0;e<c.vertexIndices.length;e++){let t=c.vertexIndices[e],r=l.vertexCount;l.vertexIndices.push(t+r)}for(let e=0;e<c.vertices.length;e++){let t=c.vertices[e];l.vertices.push(t)}}let m=1/0,g=-1/0,v=1/0,y=-1/0;for(let T=0,P=l.vertexCount;T<P;T++){let e=2*T,t=l.vertices[e+0],r=l.vertices[e+1];t<m&&(m=t),t>g&&(g=t),r<v&&(v=r),r>y&&(y=r)}this._minX=m,this._minY=v,this._width=g-m,this._height=y-v,this._buffer=new A6(this._computeBufferEstimatedSize(l));let b=[],w=[];for(let T=l.elementCount-1;T>=0;T--){let e=T>=p,t=2*T,r=l.elements[t+0],i=l.elements[t+1],s=r+i,c={start:r,count:i,normals:[],continuous:[],concave:[]},u=r,d=s-1,f=r+1,m=this._shape.roundedCurves.length;do{let t=u-r,n=l.vertices[2*d+0],a=l.vertices[2*d+1],o=l.vertices[2*u+0],h=l.vertices[2*u+1],p=l.vertices[2*f+0],g=l.vertices[2*f+1],v=o-n,y=h-a,b=Math.sqrt(v*v+y*y);v/=b,y/=b;let w=o-p,x=h-g,S=Math.sqrt(w*w+x*x);w/=S,x/=S,c.normals[2*t+0]=-x,c.normals[2*t+1]=w,c.concave[t]=v*x-y*w>0;let _=l.vertexIndices[u];if(Array.isArray(_))c.continuous[t]=!1;else{let[e,r]=this._shape.getCurveIndexFromVertexId(_-1,!0);if(r>0&&r<1)c.continuous[t]=!0;else{let n=1===r?e+1:e-1;n=(n+m)%m;let i=1===r?0:1,s=this._shape.roundedCurves[e].getTangent(r),a=this._shape.roundedCurves[n].getTangent(i);c.continuous[t]=s.dot(a)>.95}}e&&(c.normals[2*t+0]*=-1,c.normals[2*t+1]*=-1),[d,u,f]=[u,f,f+1],f>=s&&(f-=i)}while(f!==r+1);let g=[];g.push({bevelI:0,angle:0,size:0,boundary:{vertices:l.vertices.slice(2*r,2*s),vertexCount:i,vertexIndices:new Array(i).fill(!0).map(((e,t)=>[t,t])),elements:[0,i],elementCount:1,mesh:null},reverseMap:[],insetPoints:l.vertices.slice(2*r,2*s)});let v=0;for(let a=1;a<=this._bevelSegments;a++){let t=a/this._bevelSegments*Math.PI/2,r=(1-Math.cos(t))*this._bevel,s=[],o=[],u=[],h=[],d=0;for(let a=0;a<i;a++){let t=2*a,f=(a-1+i)%i*2,p=l.vertices[2*c.start+t+0],m=l.vertices[2*c.start+t+1],g=-c.normals[f+0]*r,v=-c.normals[f+1]*r,y=-c.normals[t+0]*r,b=-c.normals[t+1]*r;if(c.concave[a]||!c.concave[a]&&e){let t=Math.atan2(v,g),i=Math.atan2(b,y);i>t&&(i-=2*Math.PI);let o=i-t;if(c.continuous[a]||e){let n=t+o/2,i=Math.cos(n)*r,l=Math.sin(n)*r;s[2*d+0]=p+i*(e?-1:1),s[2*d+1]=m+l*(e?-1:1),h[d]=a,d++}else{let e=Math.max(1,Math.floor(n/4*Math.abs(o)/Math.PI));for(let n=0;n<=e;n++){let i=t+o*(n/e),l=Math.cos(i)*r,c=Math.sin(i)*r;s[2*d+0]=p+l,s[2*d+1]=m+c,h[d]=a,d++}}}else s[2*d+0]=p+g,s[2*d+1]=m+v,h[d]=a,o[a]=d,d++,s[2*d+0]=p,s[2*d+1]=m,h[d]=a,d++,s[2*d+0]=p+y,s[2*d+1]=m+b,h[d]=a,u[a]=d,d++}let f=C6({windingRule:K5.POSITIVE,elementType:Z5.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[s],edgeCreateCallback:e=>{let t=e.Org.idx,r=h[t],n=h[(t+1)%h.length];e.idx=[r,n],e.Sym.idx=[n,r]},vertexIdCallback:e=>{let t=e.Lprev.idx;return[t?t[1]:0,e.idx?e.idx[0]:0]}});if(!f)throw console.log("Error"),new Error("error generating bevel geometry for ".concat(a,"'th loop"));if(!f.vertexCount){let e=(a-1)/this._bevelSegments*Math.PI/2;v=(1-Math.sin(e))*this._bevel;break}for(let e=0;e<f.vertexIndices.length;e++){let[t,r]=f.vertexIndices[e];if(t===r)continue;let n=r;r<t&&(n+=i);for(let s=t;s<n;s++){let n=s%i,a=(s+1)%i;if(!c.continuous[n]||!c.continuous[a]){f.vertexIndices[e]=[t,n],f.vertexIndices.splice(e+1,0,[a,r]),f.vertices.splice(2*(e+1),0,f.vertices[2*e],f.vertices[2*e+1]);break}}}g.push({bevelI:a,angle:t,size:r,boundary:f,reverseMap:h,insetPoints:s})}let y=(e,t,r)=>{let n=0,i=e.boundary.vertexIndices.length;for(;n<i&&r(e.boundary.vertexIndices[t]);)t=(t+1)%i,n++;return n},x=b.length;for(let n=1;n<g.length;n++){let e=g[n-1],t=g[n],r=e.boundary.vertexIndices.length,s=t.boundary.vertexIndices.length;if(!r||!s)break;let o=c.concave.length,l=0,u=R6(l,i);for(;!e.boundary.vertexIndices.filter(u).length||!t.boundary.vertexIndices.filter(u).length;)l++,u=R6(l,i);let h=e.boundary.vertexIndices.findIndex(u),d=t.boundary.vertexIndices.findIndex(u);do{h=(h+1)%r}while(u(e.boundary.vertexIndices[h]));do{d=(d+1)%s}while(u(t.boundary.vertexIndices[d]));l=(l+1)%i;let f,p,m=l,v=0,w=this._buildBevelVert(c,e,(h-1+r)%r,void 0,v),x=this._buildBevelVert(c,t,(d-1+s)%s,void 0,v),S=!1;do{v=(l||o)/o,u=R6(l,i);let n=y(e,h,u),m=y(t,d,u),g=S;if(S=!1,n&&!m){for(let t=0;t<n;t++)f=this._buildBevelVert(c,e,(h+t)%r,t/(n-1),v),b.push(w.topN,f.topP,x.topN),!1===a&&b.push(f.bottomP,w.bottomN,x.bottomN),w=f;S=!0}else if(!n&&m)for(let e=0;e<m;e++)p=this._buildBevelVert(c,t,(d+e)%s,e/(m-1),v),b.push(x.topN,w.topP,p.topP),!1===a&&b.push(w.bottomP,x.bottomN,p.bottomP),x=p;else if(n&&m)if(f=this._buildBevelVert(c,e,h,0,v),p=this._buildBevelVert(c,t,d,0,v),g?(b.push(w.topN,p.topP,x.topN),b.push(w.topN,f.topP,p.topP),!1===a&&(b.push(p.bottomP,w.bottomN,x.bottomN),b.push(p.bottomP,f.bottomP,w.bottomN))):(b.push(x.topN,w.topN,f.topP),b.push(x.topN,f.topP,p.topP),!1===a&&(b.push(f.bottomP,w.bottomN,x.bottomN),b.push(f.bottomP,x.bottomN,p.bottomP))),w=f,x=p,n===m)for(let i=1;i<n;i++)f=this._buildBevelVert(c,e,(h+i)%r,i/(n-1),v),p=this._buildBevelVert(c,t,(d+i)%s,i/(m-1),v),b.push(w.topN,f.topP,x.topN),b.push(x.topN,f.topP,p.topP),!1===a&&(b.push(f.bottomP,w.bottomN,x.bottomN),b.push(f.bottomP,x.bottomN,p.bottomP)),w=f,x=p;else if(n>m){let i=n/m,o=0;for(let l=1;l<n;l++)f=this._buildBevelVert(c,e,(h+l)%r,l/(n-1),v),b.push(w.topN,f.topP,x.topN),!1===a&&b.push(f.bottomP,w.bottomN,x.bottomN),w=f,l>(o+1)*i&&(o++,p=this._buildBevelVert(c,t,(d+o)%s,o/(m-1),v),b.push(x.topN,f.topP,p.topP),!1===a&&b.push(f.bottomP,x.bottomN,p.bottomP),x=p)}else{let i=m/n,o=0;for(let l=1;l<m;l++)p=this._buildBevelVert(c,t,(d+l)%s,l/(m-1),v),b.push(x.topN,f.topP,p.topP),!1===a&&b.push(f.bottomP,x.bottomN,p.bottomP),x=p,l>(o+1)*i&&(o++,f=this._buildBevelVert(c,e,(h+o)%r,o/(n-1),v),b.push(w.topN,f.topP,x.topN),!1===a&&b.push(f.bottomP,w.bottomN,x.bottomN),w=f)}h=(h+n)%r,d=(d+m)%s,l=(l+1)%o}while(l!==m)}if(!1===a&&this._depth>2*this._bevel&&this._buildWall(g,c,b),e){let e=[];for(let t=b.length-1;t>=x+2;t-=3){let r=b[t-2],n=b[t-1],i=b[t-0];e.push(i,n,r)}b.splice(x,b.length-x,...e)}if(e){let e=[];for(let t=g[g.length-1].boundary.vertices.length-1;t>=1;t-=2){let r=g[g.length-1].boundary.vertices[t-1],n=g[g.length-1].boundary.vertices[t-0];e.push(r,n)}w.push(e)}if(!e){let e,t=g[g.length-1];try{e=C6({windingRule:g.length>1?K5.POSITIVE:K5.ODD,elementType:Z5.POLYGONS,vertexSize:2,strict:!0,contours:[t.insetPoints,...w]})}catch(M){e=O6}if(!e)throw new Error("Error generating geometry for surface");0===h.length&&this._bevel<o&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let r=0;r<3*e.elementCount;r+=3){let t=this._buildSurfaceVert(e,e.elements[r+0],v),n=this._buildSurfaceVert(e,e.elements[r+1],v),i=this._buildSurfaceVert(e,e.elements[r+2],v);b.push(t.top,n.top,i.top),!1===a&&b.push(i.bottom,n.bottom,t.bottom)}}this.vertexCache={}}this._buffer.shrink();let x=new Xz(Uint32Array.from(b),1),S=new Xz(this._buffer.positions,3),_=new Xz(this._buffer.normals,3),C=new Xz(this._buffer.uvs,2);S.needsUpdate=!0,_.needsUpdate=!0,C.needsUpdate=!0,x.needsUpdate=!0,this.setAttribute("position",S),this.setAttribute("normal",_),this.setAttribute("uv",C),this.setIndex(x)}_computeBufferEstimatedSize(e){return 2*e.vertexCount*(2+this._bevelSegments)}_buildWall(e,t,r){let n=e[0];for(let i=0,s=n.boundary.vertexCount;i<s;i++){let e=this._buildBevelVert(t,n,i),a=this._buildBevelVert(t,n,(i+1)%s);r.push(a.topP,e.topN,e.bottomN),r.push(a.topP,e.bottomN,a.bottomP)}}_buildSurfaceVert(e,t,r){let n=t.toString();if(n in this.vertexCache)return this.vertexCache[n];let i=e.vertices[2*t+0],s=e.vertices[2*t+1],a=(i-this._minX)/this._width,o=(s-this._minY)/this._height;this.forPathBevel&&(o=1);let l=this._buffer.get(this.forPathBevel?1:2),c=3*l,u=2*l,h={top:l+0,bottom:l+1};return this._buffer.positions[c+0]=i,this._buffer.positions[c+1]=s,this._buffer.positions[c+2]=this.forPathBevel?this._bevel:this._depth-r,this._buffer.normals[c+0]=0,this._buffer.normals[c+1]=0,this._buffer.normals[c+2]=1,this._buffer.uvs[u+0]=a,this._buffer.uvs[u+1]=o,!1===this.forPathBevel&&(this._buffer.positions[c+3]=i,this._buffer.positions[c+4]=s,this._buffer.positions[c+5]=r,this._buffer.normals[c+3]=0,this._buffer.normals[c+4]=0,this._buffer.normals[c+5]=-1,this._buffer.uvs[u+2]=a,this._buffer.uvs[u+3]=o),this.vertexCache[n]=h,h}_buildBevelVert(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4?arguments[4]:void 0,s="".concat(t.bevelI,":").concat(r);if(s in this.vertexCache&&0!==i&&1!==i&&(!i||i===this.vertexCache[s].pathBevelUCoord))return this.vertexCache[s];let a,o,l,c,[u,h]=t.boundary.vertexIndices[r];u!==h?(o=u,a=h,c=!1,l=e.continuous[o]&&e.continuous[a]):(a=u,o=(a-1+e.count)%e.count,c=e.concave[a]&&t.bevelI>0,l=e.continuous[a]||c);let d=Math.cos(t.angle),f=Math.sin(t.angle),p=2*r,m=2*a,g=2*o,v=t.boundary.vertices[p+0],y=t.boundary.vertices[p+1],b=(1-f)*this._bevel,w=(v-this._minX)/this._width,x=(y-this._minY)/this._height;this.forPathBevel&&(void 0!==i&&(w=i),x=1);let S=e.normals[m+0],_=e.normals[m+1],C=e.normals[g+0],E=e.normals[g+1];if(c){S+=(C-S)*(1-n),_+=(E-_)*(1-n);let e=Math.sqrt(S*S+_*_);S/=e,_/=e}let A=this.forPathBevel?this._buffer.get(l?1:2):this._buffer.get(l?2:4),M=3*A,T=2*A,P={i:r,fi:a,topP:A+0,topN:A+0,bottomP:A+1,bottomN:A+1,pathBevelUCoord:i};return this._buffer.positions[M+0]=v,this._buffer.positions[M+1]=y,this._buffer.positions[M+2]=(this.forPathBevel?this._bevel:this._depth)-b,this._buffer.normals[M+0]=S*d,this._buffer.normals[M+1]=_*d,this._buffer.normals[M+2]=f,this._buffer.uvs[T+0]=w,this._buffer.uvs[T+1]=x,!1===this.forPathBevel&&(this._buffer.positions[M+3]=v,this._buffer.positions[M+4]=y,this._buffer.positions[M+5]=b,this._buffer.normals[M+3]=S*d,this._buffer.normals[M+4]=_*d,this._buffer.normals[M+5]=-f,this._buffer.uvs[T+2]=x,this._buffer.uvs[T+3]=w),l||(this.forPathBevel?(A+=1,M+=3,T+=2):(A+=2,M+=6,T+=4),P.topP=A+0,P.bottomP=A+1,this._buffer.positions[M+0]=v,this._buffer.positions[M+1]=y,this._buffer.positions[M+2]=(this.forPathBevel?this._bevel:this._depth)-b,this._buffer.normals[M+0]=C*d,this._buffer.normals[M+1]=E*d,this._buffer.normals[M+2]=f,this._buffer.uvs[T+0]=w,this._buffer.uvs[T+1]=x,!1===this.forPathBevel&&(this._buffer.positions[M+3]=v,this._buffer.positions[M+4]=y,this._buffer.positions[M+5]=b,this._buffer.normals[M+3]=C*d,this._buffer.normals[M+4]=E*d,this._buffer.normals[M+5]=-f,this._buffer.uvs[T+2]=x,this._buffer.uvs[T+3]=w)),this.vertexCache[s]=P,P}clone(){let e=new L6(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=MQ(this.userData),e}},N6=class extends iF{constructor(e){var t,r,n,i,s,a;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.type="ShapeGeometry",this.windingRule=K5.ODD,this.elementType=Z5.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=e,this._curveSegments=o,this._triangulationOptions=Object.assign({windingRule:K5.ODD,elementType:Z5.POLYGONS,polySize:3,vertexSize:2,strict:!0},l);let c,u,h,d=this._shape.extractShapePointsToFlatArray([],this._curveSegments),f=this._shape.shapeHoles.map((e=>e.extractShapePointsToFlatArray([],this._curveSegments))),p=!0,m=!0;for(let b=0,w=d.length/2;b<w;b++){let e=2*b,t=d[e+0],r=d[e+1];if(void 0!==u&&t!==u&&(p=!1),void 0!==h&&r!==h&&(m=!1),u=t,h=r,!p&&!m)break}if(!p&&!m)try{c=C6({contours:[d,...f],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch(y){c=D6}let g=null!==(t=null===(r=c)||void 0===r?void 0:r.vertexCount)&&void 0!==t?t:1,v=null!==(n=null===(i=c)||void 0===i?void 0:i.elementCount)&&void 0!==n?n:1;if(this._positionAttribute=new Xz(new Float32Array(3*g),3),this._normalAttribute=new Xz(new Float32Array(3*g),3),this._uvAttribute=new Xz(new Float32Array(2*g),2),this._indexAttribute=new Xz(new Uint32Array(3*v),1),c){let e=1/0,t=-1/0,r=1/0,n=-1/0;for(let a=0,o=g;a<o;a++){let i=2*a,s=c.vertices[i+0],o=c.vertices[i+1];s<e&&(e=s),s>t&&(t=s),o<r&&(r=o),o>n&&(n=o)}let i=t-e,s=n-r;for(let a=0,o=g;a<o;a++){let t=2*a,n=c.vertices[t+0],o=c.vertices[t+1],l=(n-e)/i,u=(o-r)/s;this._positionAttribute.setXYZ(a,n,o,0),this._normalAttribute.setXYZ(a,0,0,1),this._uvAttribute.setXY(a,l,u)}for(let a=0,o=v;a<o;a++){let e=3*a,t=c.elements[e+0],r=c.elements[e+1],n=c.elements[e+2];this._indexAttribute.setX(e+0,t),this._indexAttribute.setX(e+1,r),this._indexAttribute.setX(e+2,n)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,3*(null!==(s=null===(a=c)||void 0===a?void 0:a.elementCount)&&void 0!==s?s:1))}clone(){let e=new N6(this._shape,this._curveSegments);return e.userData=MQ(this.userData),e}},B6=class extends L6{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,arguments.length>5&&void 0!==arguments[5]?arguments[5]:K5.ODD),this.type="ShapeGeometry"}_computeBufferEstimatedSize(e){return 2*e.vertexCount*(2+this._bevelSegments)}_buildWall(e,t,r){let n=e[0];for(let i=0,s=n.boundary.vertexCount;i<s;i++){let e=this._buildBevelVert(t,n,i),a=this._buildBevelVert(t,n,(i+1)%s);r.push(a.topP,e.topN,e.bottomN),r.push(a.topP,e.bottomN,a.bottomP)}}clone(){let e=new B6(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=MQ(this.userData),e}},z6=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i,s,a,o,l,c,u;let h=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:K5.ODD},e.parameters),d=Math.abs(h.width),f=Math.abs(null!==(n=h.height)&&void 0!==n?n:h.width),p=Math.abs(null!==(i=h.depth)&&void 0!==i?i:0),m=null!==(s=e.shape)&&void 0!==s?s:null===t||void 0===t?void 0:t.shape,g=null!==(a=null===(o=m)||void 0===o?void 0:o.roundness)&&void 0!==a?a:h.roundness;void 0!==m&&(m instanceof i6?(m.width!==d||m.height!==f)&&m.applySize(d,f):m=new i6(d,f).fromJSON(m),void 0!==(null===(l=e.parameters)||void 0===l?void 0:l.roundness)&&(null===(c=e.parameters)||void 0===c?void 0:c.roundness)>0&&m.update());let v=null!==(u=m)&&void 0!==u?u:new i6(d,f);return{parameters:Object.assign(h,{width:d,height:f,depth:p,roundness:g}),shape:v}}static build(e){let t,{depth:r,extrudeBevelSize:n,extrudeBevelSegments:i,subdivisions:s,roundness:a,windingRule:o}=e.parameters;return e.shape.roundness=a,t=r<=0?new N6(e.shape,s,{windingRule:o}):new B6(e.shape,r,n,s,i,o),Object.assign(t,{userData:u(u({},e),{},{type:"VectorGeometry"})})}},F6=2*Math.PI,j6=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i;let s=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return s.angle=$N.clamp(s.angle,0,360),{shape:e.shape&&e.shape instanceof i6?e.shape:new i6,parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(n=s.height)&&void 0!==n?n:s.width),depth:Math.abs(null!==(i=s.depth)&&void 0!==i?i:0)})}}static build(e){let t,{width:r,height:n,spikes:i,angle:s,innerRadius:a,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}=e.parameters,h=e.shape,d=function(e,t,r,n,i,s){if(n>=F6)return i>30||i%4===0?(function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=.5522847498,o=t*a,l=r*a;e.addPoint(H6(i-t,s,i-t,s-l,i-t,s+l)),e.addPoint(H6(i,s+r,i-o,s+r,i+o,s+r)),e.addPoint(H6(i+t,s,i+t,s+l,i+t,s-l)),e.addPoint(H6(i,s-r,i+o,s-r,i-o,s-r)),n>0&&G6(e,t,r,n)}(e,t,r,s),Math.round(i/4)):U6(e,n,i,t,r,s);n=Math.max(n,.001);let a={x:0,y:r},o=n+.5*Math.PI,l={x:Math.cos(o)*t,y:Math.sin(o)*r},c=c6({px:a.x,py:a.y,cx:l.x,cy:l.y,rx:t,ry:r,largeArcFlag:n>Math.PI,sweepFlag:!0});return i>30||i%c.length===0?function(e,t,r,n,i,s,a,o){let l=Math.round(i/n.length);e.addPoint(V6(t,r));for(let c=0,u=n.length;c<u;c++){let t=n[c],r=e.points[c],i=V6(t.x,t.y);r.controls[1].position.set(t.x1,t.y1),i.controls[0].position.set(t.x2,t.y2),e.addPoint(i)}return o>0?W6(e,s,a,o):e.addPoint(V6(0,0)),l}(e,a.x,a.y,c,i,t,r,s):U6(e,n,i,t,r,s)}(h,.5*r,.5*n,s*Math.PI/180,i,a);return h.isClosed=!0,h.update(),0===s?(t=new iF,t.setAttribute("position",new Qz([],3))):t=z6.create({shape:h,parameters:{subdivisions:d,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}}),Object.assign(t,{userData:u(u({},e),{},{type:"EllipseGeometry"})})}};function U6(e,t,r,n,i,s){let a=-t/r;for(let o=0;o<=r;o++){let t=a*o,r=Math.sin(t)*n,s=Math.cos(t)*i;e.addPoint(V6(r,s))}return t<F6?s>0?W6(e,n,i,s):e.addPoint(V6(0,0)):(e.removePoint(e.points[e.points.length-1]),s>0&&G6(e,n,i,s)),1}function V6(e,t){return new E5($N.generateUUID(),new eB(e,t))}function H6(e,t,r,n,i,s){let a=V6(e,t);return a.controls[0].position.set(r,n),a.controls[1].position.set(i,s),a}function W6(e,t,r,n){q6(e,t,r,n).forEach((t=>e.addPoint(t)))}function G6(e,t,r,n){let i=q6(e,t,r,n),s=new i6;i.forEach((e=>s.addPoint(e))),s.isClosed=!0,e.shapeHoles.push(s)}function q6(e,t,r,n){let i=n*t/100,s=i*(Math.abs(r)/Math.abs(t)),a=new eB(i/t,s/r),o=e.points.map((e=>{let t=e.clone();return t.uuid=$N.generateUUID(),t})).reverse();return o.forEach((e=>{e.position.multiply(a);let t=e.controls[0].position.clone().multiply(a),r=e.controls[1].position.clone().multiply(a);e.controls[0].position.copy(r),e.controls[1].position.copy(t)})),o}var X6=new Kz([0,0,0],1),Y6=class extends iF{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,a=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,o=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,l=arguments.length>11&&void 0!==arguments[11]?arguments[11]:1;if(super(),0===n)return;let c=e&&1===n;c&&(l=0),o>100&&(o=100),0===o&&(l=0);let u,h,d,f,p,m,g,v,y=()=>new PB,b=new PB,w=y(),x=y(),S=y(),_=y(),C=y(),E=y(),A=y(),M=y(),T=y(),P=y(),k=y(),D=t-2*s+.001,I=D/n,O=Math.ceil(i*n),R=O+1,L=D/O,N=-D/2,B=a+1,z=2*Math.PI/a,F=Math.PI/2/l,j=Math.min((1-o/100)*s,s-.01),U=s-j,V=0,H=2*l+2,W=B*H/2,G=W+B*R,q=Math.max(0,B*(R+H)),[X,Y,K]=[3,3,2].map((e=>Array(q*e).fill(0))),Q=[],Z=r-s;function J(t,r){let n=Math.PI/2;m=r*L,v=2*Math.PI*(m%I)/I+n,m+=N,g=Math.sin(v)*Z,p=Math.cos(v)*Z,e?t.set(p,g,m):t.set(p,m,g)}J(b,-1e-10),J(w,0),_.copy(b),J(b,1);let $=b.distanceTo(w),ee=c?0:U+j,te=$*O+2*ee,re=j,ne=te-ee;for(let oe=0;oe<=O;oe++){J(x,oe),k.subVectors(x,_).normalize(),_.copy(x),T.copy(x).setComponent(+e+1,0).normalize(),P.crossVectors(k,T).normalize();let t=0===oe,r=oe===O,n=t?3*Math.PI/2:F,i=t?re:ne,o=t?B:G,u=t?0:q-B,h=k.clone().multiplyScalar(t?-U:U).add(x),d=k.clone().multiplyScalar(t?-1:1).normalize();for(let e=0;e<B;e++){let f=e*z;if(C.addVectors(b.copy(T).multiplyScalar(s*Math.cos(f)),w.copy(P).multiplyScalar(s*Math.sin(f))),E.copy(C).normalize(),t||r){c||(V=u+e,[0,1,2].forEach((e=>{X[3*V+e]=h.getComponent(e),Y[3*V+e]=d.getComponent(e)})),K[2*V]=+r,K[2*V+1]=e/a),w.copy(E).multiplyScalar(j),S.addVectors(x,w);for(let r=0;r<l;r++){let s=r*F+n;A.addVectors(b.copy(k).multiplyScalar(U*Math.sin(s)),w.copy(E).multiplyScalar(U*Math.cos(s))),M.copy(A).normalize(),w.addVectors(S,A),A.normalize(),V=o+r*B+e,[0,1,2].forEach((e=>{X[3*V+e]=w.getComponent(e),Y[3*V+e]=M.getComponent(e)}));let l=+t+Math.sin(s);K[2*V]=(i+U*l)/te,K[2*V+1]=e/a}}w.addVectors(x,C),V=W+oe*B+e,[0,1,2].forEach((e=>{X[3*V+e]=w.getComponent(e),Y[3*V+e]=E.getComponent(e)})),K[2*V]=(ee+oe*$)/te,K[2*V+1]=e/a}}let ie=R+2*l+2,[se,ae]=[+c,ie-1];for(let oe=se;oe<=ae-1;oe++){let e=c&&oe===ae-1;for(let t=0;t<B-1;t++)u=oe*B+t,h=u+1,d=(e?t:u)+B,f=(e?t+1:h)+B,0===oe?Q.push(h,f,d):oe===ie-2?Q.push(u,h,d):Q.push(u,h,d,h,f,d)}this.setIndex(Q),this.setAttribute("position",new Qz(X,3)),this.setAttribute("normal",new Qz(Y,3)),this.setAttribute("uv",new Qz(K,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let e,t,r,n,i=this.userData.parameters,s=Math.ceil(i.tubularSegments),a=i.radialSegments+1,o=Array.from(this.getIndex().array),l=6*(s-1)*i.radialSegments,c=s,u=c===s;for(let h=0;h<i.radialSegments;h++)e=c*a+h,t=e+1,r=(u?h:e)+a,n=(u?h+1:t)+a,o[l++]=e,o[l++]=t,o[l++]=r,o[l++]=t,o[l++]=n,o[l++]=r;return o.length=l,X6.array=o,X6.count=o.length,X6}},K6=class extends w5{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=(1+Math.sqrt(5))/2,i="IcosahedronGeometry";super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],i,e,t,r),this.type=i}static fromJSON(e){return new K6(e.radius,e.corner,e.cornerSides)}},Q6=new sz,Z6=new kz,J6=new PB,$6=class extends FN{constructor(){super(),this.uuid=$N.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(e){let t=(new tB).getNormalMatrix(e);for(let r=0,n=this.vertices.length;r<n;r++)this.vertices[r].applyMatrix4(e);for(let r=0,n=this.faces.length;r<n;r++){let e=this.faces[r];e.normal.applyMatrix3(t).normalize();for(let r=0,n=e.vertexNormals.length;r<n;r++)e.vertexNormals[r].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(e){return Q6.makeRotationX(e),this.applyMatrix4(Q6),this}rotateY(e){return Q6.makeRotationY(e),this.applyMatrix4(Q6),this}rotateZ(e){return Q6.makeRotationZ(e),this.applyMatrix4(Q6),this}translate(e,t,r){return Q6.makeTranslation(e,t,r),this.applyMatrix4(Q6),this}scale(e,t,r){return Q6.makeScale(e,t,r),this.applyMatrix4(Q6),this}lookAt(e){return Z6.lookAt(e),Z6.updateMatrix(),this.applyMatrix4(Z6.matrix),this}fromBufferGeometry(e){let t=this,r=null!==e.index?e.index:void 0,n=e.attributes;if(void 0===n.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let i=n.position,s=n.normal,a=n.color,o=n.uv,l=n.uv2;void 0!==l&&(this.faceVertexUvs[1]=[]);for(let h=0;h<i.count;h++)t.vertices.push((new PB).fromBufferAttribute(i,h)),void 0!==a&&t.colors.push((new vB).fromBufferAttribute(a,h));function c(e,r,n,i){let c=void 0===a?[]:[t.colors[e].clone(),t.colors[r].clone(),t.colors[n].clone()],u=void 0===s?[]:[(new PB).fromBufferAttribute(s,e),(new PB).fromBufferAttribute(s,r),(new PB).fromBufferAttribute(s,n)],h=new t8(e,r,n,u,c,i);t.faces.push(h),void 0!==o&&t.faceVertexUvs[0].push([(new eB).fromBufferAttribute(o,e),(new eB).fromBufferAttribute(o,r),(new eB).fromBufferAttribute(o,n)]),void 0!==l&&t.faceVertexUvs[1].push([(new eB).fromBufferAttribute(l,e),(new eB).fromBufferAttribute(l,r),(new eB).fromBufferAttribute(l,n)])}let u=e.groups;if(u.length>0)for(let h=0;h<u.length;h++){let e=u[h],t=e.start;for(let n=t,i=t+e.count;n<i;n+=3)void 0!==r?c(r.getX(n),r.getX(n+1),r.getX(n+2),e.materialIndex):c(n,n+1,n+2,e.materialIndex)}else if(void 0!==r)for(let h=0;h<r.count;h+=3)c(r.getX(h),r.getX(h+1),r.getX(h+2));else for(let h=0;h<i.count;h+=3)c(h,h+1,h+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(J6).negate(),this.translate(J6.x,J6.y,J6.z),this}normalize(){this.computeBoundingSphere();let e=this.boundingSphere.center,t=this.boundingSphere.radius,r=0===t?1:1/t,n=new sz;return n.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix4(n),this}computeFaceNormals(){let e=new PB,t=new PB;for(let r=0,n=this.faces.length;r<n;r++){let n=this.faces[r],i=this.vertices[n.a],s=this.vertices[n.b],a=this.vertices[n.c];e.subVectors(a,s),t.subVectors(i,s),e.cross(t),e.normalize(),n.normal.copy(e)}}computeVertexNormals(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=new Array(this.vertices.length);for(let r=0,n=this.vertices.length;r<n;r++)t[r]=new PB;if(e){let e=new PB,r=new PB;for(let n=0,i=this.faces.length;n<i;n++){let i=this.faces[n],s=this.vertices[i.a],a=this.vertices[i.b],o=this.vertices[i.c];e.subVectors(o,a),r.subVectors(s,a),e.cross(r),t[i.a].add(e),t[i.b].add(e),t[i.c].add(e)}}else{this.computeFaceNormals();for(let e=0,r=this.faces.length;e<r;e++){let r=this.faces[e];t[r.a].add(r.normal),t[r.b].add(r.normal),t[r.c].add(r.normal)}}for(let r=0,n=this.vertices.length;r<n;r++)t[r].normalize();for(let r=0,n=this.faces.length;r<n;r++){let e=this.faces[r],n=e.vertexNormals;3===n.length?(n[0].copy(t[e.a]),n[1].copy(t[e.b]),n[2].copy(t[e.c])):(n[0]=t[e.a].clone(),n[1]=t[e.b].clone(),n[2]=t[e.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){let t=this.faces[e],r=t.vertexNormals;3===r.length?(r[0].copy(t.normal),r[1].copy(t.normal),r[2].copy(t.normal)):(r[0]=t.normal.clone(),r[1]=t.normal.clone(),r[2]=t.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let t=0,r=this.faces.length;t<r;t++){let e=this.faces[t];e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]);for(let t=0,r=e.vertexNormals.length;t<r;t++)e.__originalVertexNormals[t]?e.__originalVertexNormals[t].copy(e.vertexNormals[t]):e.__originalVertexNormals[t]=e.vertexNormals[t].clone()}let e=new $6;e.faces=this.faces;for(let t=0,r=this.morphTargets.length;t<r;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];let e=this.morphNormals[t].faceNormals,r=this.morphNormals[t].vertexNormals;for(let t=0,n=this.faces.length;t<n;t++){let t=new PB,n={a:new PB,b:new PB,c:new PB};e.push(t),r.push(n)}}let r=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let e=0,t=this.faces.length;e<t;e++){let t=this.faces[e],n=r.faceNormals[e],i=r.vertexNormals[e];n.copy(t.normal),i.a.copy(t.vertexNormals[0]),i.b.copy(t.vertexNormals[1]),i.c.copy(t.vertexNormals[2])}}for(let t=0,r=this.faces.length;t<r;t++){let e=this.faces[t];e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals}}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new IB),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new QB),this.boundingSphere.setFromPoints(this.vertices)}merge(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e||!e.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);let n,i=this.vertices.length,s=this.vertices,a=e.vertices,o=this.faces,l=e.faces,c=this.colors,u=e.colors;void 0!==t&&(n=(new tB).getNormalMatrix(t));for(let h=0,d=a.length;h<d;h++){let e=a[h].clone();void 0!==t&&e.applyMatrix4(t),s.push(e)}for(let h=0,d=u.length;h<d;h++)c.push(u[h].clone());for(let h=0,d=l.length;h<d;h++){let e,t,s=l[h],a=s.vertexNormals,c=s.vertexColors,u=new t8(s.a+i,s.b+i,s.c+i);u.normal.copy(s.normal),void 0!==n&&u.normal.applyMatrix3(n).normalize();for(let r=0,i=a.length;r<i;r++)e=a[r].clone(),void 0!==n&&e.applyMatrix3(n).normalize(),u.vertexNormals.push(e);u.color.copy(s.color);for(let r=0,n=c.length;r<n;r++)t=c[r],u.vertexColors.push(t.clone());u.materialIndex=s.materialIndex+r,o.push(u)}for(let h=0,d=e.faceVertexUvs.length;h<d;h++){let t=e.faceVertexUvs[h];void 0===this.faceVertexUvs[h]&&(this.faceVertexUvs[h]=[]);for(let e=0,r=t.length;e<r;e++){let r=t[e],n=[];for(let e=0,t=r.length;e<t;e++)n.push(r[e].clone());this.faceVertexUvs[h].push(n)}}}mergeMesh(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)}mergeVertices(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,t={},r=[],n=[],i=Math.pow(10,e);for(let o=0,l=this.vertices.length;o<l;o++){let e=this.vertices[o],s=Math.round(e.x*i)+"_"+Math.round(e.y*i)+"_"+Math.round(e.z*i);void 0===t[s]?(t[s]=o,r.push(this.vertices[o]),n[o]=r.length-1):n[o]=n[t[s]]}let s=[];for(let o=0,l=this.faces.length;o<l;o++){let e=this.faces[o];e.a=n[e.a],e.b=n[e.b],e.c=n[e.c];let t=[e.a,e.b,e.c];for(let r=0;r<3;r++)if(t[r]===t[(r+1)%3]){s.push(o);break}}for(let o=s.length-1;o>=0;o--){let e=s[o];this.faces.splice(e,1);for(let t=0,r=this.faceVertexUvs.length;t<r;t++)this.faceVertexUvs[t].splice(e,1)}let a=this.vertices.length-r.length;return this.vertices=r,a}setFromPoints(e){this.vertices=[];for(let t=0,r=e.length;t<r;t++){let r=e[t];this.vertices.push(new PB(r.x,r.y,r.z||0))}return this}sortFacesByMaterialIndex(){let e=this.faces,t=e.length;for(let a=0;a<t;a++)e[a]._id=a;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));let r,n,i=this.faceVertexUvs[0],s=this.faceVertexUvs[1];i&&i.length===t&&(r=[]),s&&s.length===t&&(n=[]);for(let a=0;a<t;a++){let t=e[a]._id;r&&r.push(i[t]),n&&n.push(s[t])}r&&(this.faceVertexUvs[0]=r),n&&(this.faceVertexUvs[1]=n)}toJSON(){let e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){let t=this.parameters;for(let r in t)void 0!==t[r]&&(e[r]=t[r]);return e}let t=[];for(let f=0;f<this.vertices.length;f++){let e=this.vertices[f];t.push(e.x,e.y,e.z)}let r=[],n=[],i={},s=[],a={},o=[],l={};for(let f=0;f<this.faces.length;f++){let e=this.faces[f],t=!0,n=!1,i=void 0!==this.faceVertexUvs[0][f],s=e.normal.length()>0,a=e.vertexNormals.length>0,o=1!==e.color.r||1!==e.color.g||1!==e.color.b,l=e.vertexColors.length>0,p=0;if(p=c(p,0,0),p=c(p,1,t),p=c(p,2,n),p=c(p,3,i),p=c(p,4,s),p=c(p,5,a),p=c(p,6,o),p=c(p,7,l),r.push(p),r.push(e.a,e.b,e.c),r.push(e.materialIndex),i){let e=this.faceVertexUvs[0][f];r.push(d(e[0]),d(e[1]),d(e[2]))}if(s&&r.push(u(e.normal)),a){let t=e.vertexNormals;r.push(u(t[0]),u(t[1]),u(t[2]))}if(o&&r.push(h(e.color)),l){let t=e.vertexColors;r.push(h(t[0]),h(t[1]),h(t[2]))}}function c(e,t,r){return r?e|1<<t:e&~(1<<t)}function u(e){let t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==i[t]||(i[t]=n.length/3,n.push(e.x,e.y,e.z)),i[t]}function h(e){let t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==a[t]||(a[t]=s.length,s.push(e.getHex())),a[t]}function d(e){let t=e.x.toString()+e.y.toString();return void 0!==l[t]||(l[t]=o.length/2,o.push(e.x,e.y)),l[t]}return e.data={},e.data.vertices=t,e.data.normals=n,s.length>0&&(e.data.colors=s),o.length>0&&(e.data.uvs=[o]),e.data.faces=r,e}clone(){return(new $6).copy(this)}copy(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;let t=e.vertices;for(let h=0,d=t.length;h<d;h++)this.vertices.push(t[h].clone());let r=e.colors;for(let h=0,d=r.length;h<d;h++)this.colors.push(r[h].clone());let n=e.faces;for(let h=0,d=n.length;h<d;h++)this.faces.push(n[h].clone());for(let h=0,d=e.faceVertexUvs.length;h<d;h++){let t=e.faceVertexUvs[h];void 0===this.faceVertexUvs[h]&&(this.faceVertexUvs[h]=[]);for(let e=0,r=t.length;e<r;e++){let r=t[e],n=[];for(let e=0,t=r.length;e<t;e++){let t=r[e];n.push(t.clone())}this.faceVertexUvs[h].push(n)}}let i=e.morphTargets;for(let h=0,d=i.length;h<d;h++){let e={};if(e.name=i[h].name,void 0!==i[h].vertices){e.vertices=[];for(let t=0,r=i[h].vertices.length;t<r;t++)e.vertices.push(i[h].vertices[t].clone())}if(void 0!==i[h].normals){e.normals=[];for(let t=0,r=i[h].normals.length;t<r;t++)e.normals.push(i[h].normals[t].clone())}this.morphTargets.push(e)}let s=e.morphNormals;for(let h=0,d=s.length;h<d;h++){let e={};if(void 0!==s[h].vertexNormals){e.vertexNormals=[];for(let t=0,r=s[h].vertexNormals.length;t<r;t++){let r=s[h].vertexNormals[t],n={};n.a=r.a.clone(),n.b=r.b.clone(),n.c=r.c.clone(),e.vertexNormals.push(n)}}if(void 0!==s[h].faceNormals){e.faceNormals=[];for(let t=0,r=s[h].faceNormals.length;t<r;t++)e.faceNormals.push(s[h].faceNormals[t].clone())}this.morphNormals.push(e)}let a=e.skinWeights;for(let h=0,d=a.length;h<d;h++)this.skinWeights.push(a[h].clone());let o=e.skinIndices;for(let h=0,d=o.length;h<d;h++)this.skinIndices.push(o[h].clone());let l=e.lineDistances;for(let h=0,d=l.length;h<d;h++)this.lineDistances.push(l[h]);let c=e.boundingBox;null!==c&&(this.boundingBox=c.clone());let u=e.boundingSphere;return null!==u&&(this.boundingSphere=u.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}toBufferGeometry(){let e=(new e8).fromGeometry(this),t=new iF,r=new Float32Array(3*e.vertices.length);if(t.setAttribute("position",s8.call(new Xz(r,3),e.vertices)),e.normals.length>0){let r=new Float32Array(3*e.normals.length);t.setAttribute("normal",s8.call(new Xz(r,3),e.normals))}if(e.colors.length>0){let r=new Float32Array(3*e.colors.length);t.setAttribute("color",n8.call(new Xz(r,3),e.colors))}if(e.uvs.length>0){let r=new Float32Array(2*e.uvs.length);t.setAttribute("uv",i8.call(new Xz(r,2),e.uvs))}if(e.uvs2.length>0){let r=new Float32Array(2*e.uvs2.length);t.setAttribute("uv2",i8.call(new Xz(r,2),e.uvs2))}t.groups=e.groups;for(let n in e.morphTargets){let r=[],i=e.morphTargets[n];for(let e=0,t=i.length;e<t;e++){let t=i[e],n=new Qz(3*t.data.length,3);n.name=t.name,r.push(s8.call(n,t.data))}t.morphAttributes[n]=r}if(e.skinIndices.length>0){let r=new Qz(4*e.skinIndices.length,4);t.setAttribute("skinIndex",a8.call(r,e.skinIndices))}if(e.skinWeights.length>0){let r=new Qz(4*e.skinWeights.length,4);t.setAttribute("skinWeight",a8.call(r,e.skinWeights))}return null!==e.boundingSphere&&(t.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(t.boundingBox=e.boundingBox.clone()),t}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(e){let t=new iF,r=e.geometry;if(e.isPoints||e.isLine){let e=new Qz(3*r.vertices.length,3),n=new Qz(3*r.colors.length,3);if(t.setAttribute("position",s8.call(e,r.vertices)),t.setAttribute("color",n8.call(n,r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length){let e=new Qz(r.lineDistances.length,1);t.setAttribute("lineDistance",r8.call(e,r.lineDistances))}null!==r.boundingSphere&&(t.boundingSphere=r.boundingSphere.clone()),null!==r.boundingBox&&(t.boundingBox=r.boundingBox.clone())}else e.isMesh&&(t=r.toBufferGeometry());return t}};$6.prototype.isGeometry=!0;var e8=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){let t,r,n,i=[],s=e.faces;for(r=0;r<s.length;r++){let e=s[r];e.materialIndex!==n&&(n=e.materialIndex,void 0!==t&&(t.count=3*r-t.start,i.push(t)),t={start:3*r,materialIndex:n})}void 0!==t&&(t.count=3*r-t.start,i.push(t)),this.groups=i}fromGeometry(e){let t,r=e.faces,n=e.vertices,i=e.faceVertexUvs,s=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,o=e.morphTargets,l=o.length;if(l>0){t=[];for(let e=0;e<l;e++)t[e]={name:o[e].name,data:[]};this.morphTargets.position=t}let c,u=e.morphNormals,h=u.length;if(h>0){c=[];for(let e=0;e<h;e++)c[e]={name:u[e].name,data:[]};this.morphTargets.normal=c}let d=e.skinIndices,f=e.skinWeights,p=d.length===n.length,m=f.length===n.length;n.length>0&&0===r.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let g=0;g<r.length;g++){let e=r[g];this.vertices.push(n[e.a],n[e.b],n[e.c]);let v=e.vertexNormals;if(3===v.length)this.normals.push(v[0],v[1],v[2]);else{let t=e.normal;this.normals.push(t,t,t)}let y=e.vertexColors;if(3===y.length)this.colors.push(y[0],y[1],y[2]);else{let t=e.color;this.colors.push(t,t,t)}if(!0===s){let e=i[0][g];void 0!==e?this.uvs.push(e[0],e[1],e[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",g),this.uvs.push(new eB,new eB,new eB))}if(!0===a){let e=i[1][g];void 0!==e?this.uvs2.push(e[0],e[1],e[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",g),this.uvs2.push(new eB,new eB,new eB))}for(let r=0;r<l;r++){let n=o[r].vertices;t[r].data.push(n[e.a],n[e.b],n[e.c])}for(let t=0;t<h;t++){let e=u[t].vertexNormals[g];c[t].data.push(e.a,e.b,e.c)}p&&this.skinIndices.push(d[e.a],d[e.b],d[e.c]),m&&this.skinWeights.push(f[e.a],f[e.b],f[e.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}},t8=class{constructor(e,t,r,n,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;this.a=e,this.b=t,this.c=r,this.normal=n&&n.isVector3?n:new PB,this.vertexNormals=Array.isArray(n)?n:[],this.color=i&&i.isColor?i:new vB,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=s}clone(){return(new this.constructor).copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}};function r8(e){return this.array.set(e),this}function n8(e){let t=this.array,r=0;for(let n=0,i=e.length;n<i;n++){let i=e[n];void 0===i&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),i=new vB),t[r++]=i.r,t[r++]=i.g,t[r++]=i.b}return this}function i8(e){let t=this.array,r=0;for(let n=0,i=e.length;n<i;n++){let i=e[n];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),i=new eB),t[r++]=i.x,t[r++]=i.y}return this}function s8(e){let t=this.array,r=0;for(let n=0,i=e.length;n<i;n++){let i=e[n];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),i=new PB),t[r++]=i.x,t[r++]=i.y,t[r++]=i.z}return this}function a8(e){let t=this.array,r=0;for(let n=0,i=e.length;n<i;n++){let i=e[n];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),i=new CB),t[r++]=i.x,t[r++]=i.y,t[r++]=i.z,t[r++]=i.w}return this}var o8=["a","b","c"];function l8(e,t){switch(t){case"c":return e.c;case"b":return e.b;default:return e.a}}function c8(e,t,r){let n=Math.min(e,t)+"_"+Math.max(e,t);return r.get(n)}function u8(e,t,r,n,i,s){let a,o=Math.min(e,t),l=Math.max(e,t),c=o+"_"+l;if(n.has(c))a=n.get(c);else{a={a:r[o],b:r[l],newEdge:null,faces:[]},n.set(c,a)}a.faces.push(i),s[e].edges.push(a),s[t].edges.push(a)}function h8(e,t,r,n,i){e.push(new t8(t,r,n,void 0,void 0,i))}function d8(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function f8(e,t,r,n){e.push([t.clone(),r.clone(),n.clone()])}var p8=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.subdivisions=e}modify(e){(e=e instanceof iF?(new $6).fromBufferGeometry(e):e.clone()).mergeVertices();let t=this.subdivisions;for(;t-- >0;)this._smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e}_smooth(e){let t,r,n,i,s,a=new PB,o=e.vertices,l=e.faces,c=e.faceVertexUvs[0],u=void 0!==c&&c.length>0,h=[],d=new Map;!function(e,t,r,n){let i,s,a;for(i=0,s=e.length;i<s;i++)r[i]={edges:[]};for(i=0,s=t.length;i<s;i++)a=t[i],u8(a.a,a.b,e,n,a,r),u8(a.b,a.c,e,n,a,r),u8(a.c,a.a,e,n,a,r)}(o,l,h,d);let f,p,m,g,v,y,b,w=[];for(let H of Array.from(d.keys())){for(p=d.get(H),m=new PB,v=3/8,y=1/8,b=p.faces.length,2!=b&&(v=.5,y=0),m.addVectors(p.a,p.b).multiplyScalar(v),a.set(0,0,0),i=0;i<b;i++){for(g=p.faces[i],s=0;s<3&&(f=o[l8(g,o8[s])],f===p.a||f===p.b);s++);f&&a.add(f)}a.multiplyScalar(y),m.add(a),p.newEdge=w.length,w.push(m)}let x,S,_,C,E,A,M,T=[];for(r=0,n=o.length;r<n;r++){for(A=o[r],E=h[r].edges,t=E.length,3==t?x=3/16:t>3&&(x=3/(8*t)),S=1-t*Number(x),_=x,t<=2&&(2==t&&(S=3/4,_=1/8)),M=A.clone().multiplyScalar(S),a.set(0,0,0),i=0;i<t;i++)C=E[i],f=C.a!==A?C.a:C.b,a.add(f);a.multiplyScalar(Number(_)),M.add(a),T.push(M)}let P,k,D,I,O,R,L,N=T.concat(w),B=T.length,z=[],F=[],j=new eB,U=new eB,V=new eB;for(r=0,n=l.length;r<n;r++)g=l[r],P=Number(c8(g.a,g.b,d).newEdge)+B,k=Number(c8(g.b,g.c,d).newEdge)+B,D=Number(c8(g.c,g.a,d).newEdge)+B,h8(z,P,k,D,g.materialIndex),h8(z,g.a,P,D,g.materialIndex),h8(z,g.b,k,P,g.materialIndex),h8(z,g.c,D,k,g.materialIndex),u&&(I=c[r],O=I[0],R=I[1],L=I[2],j.set(d8(O.x,R.x),d8(O.y,R.y)),U.set(d8(R.x,L.x),d8(R.y,L.y)),V.set(d8(O.x,L.x),d8(O.y,L.y)),f8(F,j,U,V),f8(F,O,j,V),f8(F,R,U,j),f8(F,L,V,U));e.vertices=N,e.faces=z,u&&(e.faceVertexUvs[0]=F)}},m8=new PB,g8=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i;let s=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters);return{shape:e.shape&&e.shape instanceof i6?e.shape:new i6,parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(n=s.height)&&void 0!==n?n:s.width),depth:Math.abs(null!==(i=s.depth)&&void 0!==i?i:0)})}}static build(e){let{width:t,height:r,spikes:n,cornerRadius:i,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}=e.parameters,l=e.shape,c=.5*t,h=.5*r,d=2*Math.PI/n;for(let u=0;u<n;u++){let e=d*u,t=0+Math.sin(e)*c,r=0+Math.cos(e)*h;l.addPoint(l.createPoint(t,r))}l.isClosed=!0;for(let u=0,p=l.points.length;u<p;u++)l.points[u].roundness=i;l.roundness=i,l.update();let f=z6.create({shape:l,parameters:{roundness:i,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}});return Object.assign(f,{userData:u(u({},e),{},{type:"PolygonGeometry"})})}};function v8(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function y8(e,t,r,n,i,s){let a=t.clone().sub(e),o=r.clone().sub(e),l=a.angleTo(o);if(a.normalize(),o.normalize(),n===i){let t=a.add(o).normalize();s.copy(e).addScaledVector(t,n/Math.sin(l/2))}else{let t=a.angleTo(o);s.copy(e),s.addScaledVector(a,i/Math.sin(t)),s.addScaledVector(o,n/Math.sin(t))}}function b8(e,t,r){let n=e.clone().sub(t),i=r.clone().sub(t);return n.projectOnVector(i),n.add(t)}var w8=class extends iF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:4;super(),r=Math.floor(Math.max(3,r)),n=Math.floor(n),a=Math.floor(a);let o,l=[],c=[],u=[],h=[],d=0,f=t/2,p=Math.PI/r,m=e*Math.cos(Math.PI/r),g=2*Math.PI/r,v=(r-2)*Math.PI/r,y=Math.PI-v,b=new PB(0,-f,0),w=new PB(0,f,0),x=new eB(e,-f),S=new eB(m,-f),_=new eB(0,w.y).sub(S),C=new eB(0,w.y).sub(x),E=new eB(_.y,-_.x).normalize(),A=new eB(C.y,-C.x).normalize(),M=e*Math.cos(Math.PI/r)*Math.tan((Math.PI-_.angle())/2)-1e-8;s=Math.min(s,M);{let e=new PB(E.x,E.y,0),t=new PB(Math.cos(g)*e.x,e.y,Math.sin(g)*e.x);o=e.angleTo(t)}let T=s/Math.tan((Math.PI-_.angle())/2),P=s/Math.tan((Math.PI-o)/2),k=new PB;if(!i){c.push(b.x,b.y,b.z),u.push(0,-1,0),h.push(0,0);let e=d++,t=[],n=x.clone(),i=T/Math.cos(Math.PI/r);n.x-=i;for(let s=0;s<r;s++){let e=s/r*Math.PI*2+p;v8(n,new eB(Math.sin(e),Math.cos(e)),k),c.push(k.x,k.y,k.z),u.push(0,-1,0),h.push(0,0),t.push(d++)}for(let r=0;r<t.length;r++)l.push(t[r],e,t[(r+1)%t.length])}let D=[];{let e=new PB,t=new PB,n=new PB,i=new PB,f=new PB,m=new PB;for(let g=0;g<r;g++){let v=g/r*Math.PI*2+p,y=(g+.5)/r*Math.PI*2+p,S=(g+1)/r*Math.PI*2+p,C=new eB(Math.sin(v),Math.cos(v)),M=new eB(Math.sin(y),Math.cos(y)),k=new eB(Math.sin(S),Math.cos(S));v8(x,C,t),v8(x,k,n),v8(E,M,e),y8(w,t,n,P,P,i),c.push(i.x,i.y,i.z),y8(t,w,n,P,T,f),c.push(f.x,f.y,f.z),y8(n,t,w,T,P,m),c.push(m.x,m.y,m.z),u.push(e.x,e.y,e.z),u.push(e.x,e.y,e.z),u.push(e.x,e.y,e.z),h.push(0,0),h.push(0,0),h.push(0,0);let R=d++,L=d++,N=d++;if(l.push(R,L,N),s>0){{let e=t.clone().add(n).multiplyScalar(.5),r=w.clone().sub(e).normalize(),i=b.clone().sub(e).normalize().add(r).normalize().multiplyScalar(-1);I(e,m.clone().sub(f),i,_.angle())}let p,g;{let e=new PB;v8(A,k,e);let t=m.clone().add(i).multiplyScalar(.5);t=b8(t,n,w);let r=m.clone().sub(i);[p,g]=I(t,r,e,o,i.y)}{let e=p,t=e.clone().setY(0).normalize(),r=new PB(0,-1,0),n=t.clone().cross(r);O(e,t,r,n)}D.concat(g);{let t=_.angle(),n=Math.PI-t,i=w.clone();i.y-=s/Math.sin(t-Math.PI/2);let o=new PB,f=[];for(let l=0;l<a;l++){let t=[],p=Math.PI/2-n*l/a,m=Math.cos(p),g=Math.sin(p),v=y;for(let n=0;n<=l;n++){let n=Math.cos(v),a=Math.sin(v);e.x=m*a,e.y=g,e.z=m*n,o.copy(i).addScaledVector(e,s),c.push(o.x,o.y,o.z),u.push(e.x,e.y,e.z),h.push(0,0),t.push(d++),v+=2*Math.PI/l/r}f.push(t)}g.reverse(),f.push(g);let p=f.length-1;for(let e=0;e<p;e++){let t=f[e],r=f[e+1],n=t.length-1;l.push(r[1],t[0],r[0]);for(let e=1;e<=n;e++)l.push(t[e],t[e-1],r[e]),l.push(r[e+1],t[e],r[e])}}}}}function I(e,t,r,n,i){let o=-n/2,f=(Math.PI-n)/2,p=t.clone().normalize().cross(r);e.addScaledVector(r,-s/Math.sin(f));let m=new PB,g=new PB,v=d,y=[];for(let l=0;l<=a;l++){let f=o+l/a*n;g.set(0,0,0),g.addScaledVector(p,Math.sin(f)),g.addScaledVector(r,Math.cos(f));for(let r=0;r<=1;r++){let n=r/1-.5;if(m.copy(e),m.addScaledVector(t,n),m.addScaledVector(g,s),null!=i){let e=Math.max(0,m.y-i);m.addScaledVector(t,-e/t.y)}c.push(m.x,m.y,m.z),u.push(g.x,g.y,g.z),h.push(0,0),0===r&&y.push(d),d++}}for(let s=0;s<a;s++)for(let e=0;e<1;e++){let t=v+e+2*s,r=t+2,n=r+1,i=t+1;l.push(t,r,i),l.push(r,n,i)}return[e.clone().addScaledVector(t,.5),y]}function O(e,t,r,n){let i=Math.PI/2,o=C.angle()-i,f=[],p=new PB,m=new PB;for(let l=0;l<=a;l++){let g=[],v=l/a;for(let a=0;a<=l;a++){let f=((l?a/l:0)-.5)*y,b=Math.cos(f),w=Math.sin(f),x=(i+Math.atan(Math.tan(o)*b))*v,S=Math.cos(x),_=Math.sin(x);p.set(0,0,0),p.addScaledVector(t,_*b),p.addScaledVector(r,S),p.addScaledVector(n,_*w),m.copy(e).addScaledVector(p,s),c.push(m.x,m.y,m.z),u.push(p.x,p.y,p.z),h.push(0,0),g.push(d++)}f.push(g)}let g=f.length-1;for(let s=0;s<g;s++){let e=f[s],t=f[s+1],r=e.length-1;l.push(e[0],t[1],t[0]);for(let n=1;n<=r;n++)l.push(e[n-1],e[n],t[n]),l.push(e[n],t[n+1],t[n])}}this.setIndex(l),this.setAttribute("position",new Qz(c,3)),this.setAttribute("normal",new Qz(u,3)),this.setAttribute("uv",new Qz(h,2))}},x8=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i,s;let a=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters),o=Object.assign(null!==(n=null===t||void 0===t?void 0:t.ui)&&void 0!==n?n:{enabledIndieCorners:!1},e.ui);return{shape:e.shape&&e.shape instanceof i6?e.shape:new i6,parameters:Object.assign(a,{width:Math.abs(a.width),height:Math.abs(null!==(i=a.height)&&void 0!==i?i:a.width),depth:Math.abs(null!==(s=a.depth)&&void 0!==s?s:0)}),ui:o}}static build(e){let t=e.shape,{width:r,height:n,cornerRadius:i,cornerType:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,c={x:.5*r,y:.5*n},h={x:-c.x,y:-c.y},d={x:c.x,y:c.y};function f(e,t,i){return t>r&&i>n?Math.min(e*r/t,e*n/i):t>r?e*r/t:i>n?e*n/i:e}let p=[];p[0]=0===i[0]?0:f(i[0],i[0]+i[3],i[0]+i[1]),p[1]=0===i[1]?0:f(i[1],i[1]+i[2],i[1]+i[0]),p[2]=0===i[2]?0:f(i[2],i[2]+i[1],i[2]+i[3]),p[3]=0===i[3]?0:f(i[3],i[3]+i[0],i[3]+i[2]);let m=h.x,g=d.x,v=d.y,y=h.y;t.addPoint(t.createPoint(m,v)),t.addPoint(t.createPoint(g,v)),t.addPoint(t.createPoint(g,y)),t.addPoint(t.createPoint(m,y)),t.isClosed=!0;let b=!0;for(let u=0,x=t.points.length;u<x;u++)t.points[u].roundness=p[u],u>0&&p[u]!==p[u-1]&&(b=!1);b&&(t.roundness=p[0]),t.useCubicForRoundedCorners=1!==s,t.update();let w=z6.create({shape:t,parameters:{depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}});return Object.assign(w,{userData:u(u({},e),{},{type:"RectangleGeometry"})})}},S8=class extends iF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:90,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:24;super(),this.type="BackdropGeometry";let a=[],o=[],l=[],c=.001;0==i&&(s=1),s=Math.max(1,Math.floor(s)),i=Math.min(i,100),n=Math.min(180-c,n),n*=Math.PI/180;let u=[],h=Math.PI/2,d=function(){return new PB(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)},f=d(),p=d(),[m,g,v]=[t/2,e/2,r/2],y=-g,b=+g,[w,x,S]=[d(y,-m,+v),d(y,-m,-v),d(y,+m,-v)],_=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Math.sin(e-Math.PI/(+t+1))},C=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Math.cos(e-Math.PI/(+t+1))};S.y=Math.sin(n)*t-m;let E=Math.cos(n)*t-v,A=w.z-c;n<=h?(S.z=Math.min(E,A),S.z==A&&(S.y-=(E-A)/Math.tan(h-n))):x.z=Math.min(x.z-E-v,w.z-c),f.subVectors(w,x),p.subVectors(S,x);let M=Math.min(f.length(),p.length())*i/100,T=M*Math.tan(n/2),P=M/Math.cos(n/2),k=f.clone().normalize().add(p.normalize()).setLength(P).add(x);f.set(0,_(n,!0),C(n,!0)),u.push([S,f.clone()]);let D=(Math.PI-n)/s;for(let V=0;V<=s;V++){let e=h+n+V*D;f.set(0,Math.sin(e)*T,Math.cos(e)*T),f.add(k),p.set(0,_(e),C(e)),u.push([f.clone(),p.clone()])}u.push([w,d(0,1,0)]);let I=Math.sin(D/2)*T*2,O=u.length-1,R=u[0][0].distanceTo(u[1][0]),L=R+I*s+u[O-1][0].distanceTo(u[O][0]);u[0].push(1);for(let V=0;V<=s;V++)u[V+1].push(1-(R+V*I)/L);u[O].push(0);let N,B,z,[F,j,U]=u[0];for(let V=1;V<u.length;V++)[N,B,z]=u[V],a.push(y,F.y,F.z,y,N.y,N.z,b,F.y,F.z,b,F.y,F.z,y,N.y,N.z,b,N.y,N.z),o.push(0,j.y,j.z,0,B.y,B.z,0,j.y,j.z,0,j.y,j.z,0,B.y,B.z,0,B.y,B.z),l.push(0,U,0,z,1,U,1,U,0,z,1,z),[F,j,U]=[N,B,z];this.setAttribute("position",new Qz(a,3)),this.setAttribute("normal",new Qz(o,3)),this.setAttribute("uv",new Qz(l,2))}},_8=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i;let s=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof i6?e.shape:new i6,parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(n=s.height)&&void 0!==n?n:s.width),depth:Math.abs(null!==(i=s.depth)&&void 0!==i?i:0)})}}static build(e){let{width:t,height:r,innerRadiusPercent:n,spikes:i,cornerRadius:s,angle:a,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}=e.parameters,h=e.shape,d=.5*t,f=.5*r,p=a*Math.PI/360/i,m=Math.PI/2*3*-1,g=d*n/100,v=f*n/100;if(3===i&&50===n){p=2*Math.PI/i;for(let e=0;e<i;e++){let t=p*e,r=0+Math.sin(t)*d,n=0+Math.cos(t)*f;h.addPoint(h.createPoint(r,n))}}else for(let u=0;u<i;u++){let e=0+Math.cos(m)*d,t=0+Math.sin(m)*f;h.addPoint(h.createPoint(e,t)),m+=p,e=0+Math.cos(m)*g,t=0+Math.sin(m)*v,h.addPoint(h.createPoint(e,t)),m+=p}h.isClosed=!0;for(let u=0,b=h.points.length;u<b;u++)h.points[u].roundness=s;h.roundness=s,h.update();let y=z6.create({shape:h,parameters:{roundness:s,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}});return Object.assign(y,{userData:u(u({},e),{},{type:"StarGeometry"})})}};var C8={parseRgba:function(e){return/^(rgba)?\(\s*(\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(e.toLowerCase())},hsvToRgb:function(e,t,r){let n,i,s,a=Math.floor(6*e),o=6*e-a,l=r*(1-t),c=r*(1-o*t),u=r*(1-(1-o)*t);switch(a%6){case 0:n=r,i=u,s=l;break;case 1:n=c,i=r,s=l;break;case 2:n=l,i=r,s=u;break;case 3:n=l,i=c,s=r;break;case 4:n=u,i=l,s=r;break;default:n=r,i=l,s=c}return{r:255*n,g:255*i,b:255*s}},rgbToHsv:function(e,t,r){e/=255,t/=255,r/=255;let n,i=Math.max(e,t,r),s=Math.min(e,t,r),a=i,o=i-s,l=0==i?0:o/i;if(i==s)n=0;else{switch(i){case e:n=(t-r)/o+(t<r?6:0);break;case t:n=(r-e)/o+2;break;default:n=(e-t)/o+4}n/=6}return{h:n,s:l,v:a}},hexToRgb:function(e){return{r:(e=Math.floor(e))>>16&255,g:e>>8&255,b:255&e}},rgbToHex:function(e,t,r){return(e<<16)+(t<<8)+r},rgbToHexString:function(e,t,r){return"#"+[e=Math.round(e),t=Math.round(t),r=Math.round(r)].map((e=>e.toString(16).padStart(2,"0"))).join("").toUpperCase()},hexStringToRgb:function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((e,t,r,n)=>String(t+t+r+r+n+n)));let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}},E8=class{static get version(){return"1.3.8"}static toString(){return"JavaScript Expression Parser (JSEP) v"+E8.version}static addUnaryOp(e){return E8.max_unop_len=Math.max(e.length,E8.max_unop_len),E8.unary_ops[e]=1,E8}static addBinaryOp(e,t,r){return E8.max_binop_len=Math.max(e.length,E8.max_binop_len),E8.binary_ops[e]=t,r?E8.right_associative.add(e):E8.right_associative.delete(e),E8}static addIdentifierChar(e){return E8.additional_identifier_chars.add(e),E8}static addLiteral(e,t){return E8.literals[e]=t,E8}static removeUnaryOp(e){return delete E8.unary_ops[e],e.length===E8.max_unop_len&&(E8.max_unop_len=E8.getMaxKeyLen(E8.unary_ops)),E8}static removeAllUnaryOps(){return E8.unary_ops={},E8.max_unop_len=0,E8}static removeIdentifierChar(e){return E8.additional_identifier_chars.delete(e),E8}static removeBinaryOp(e){return delete E8.binary_ops[e],e.length===E8.max_binop_len&&(E8.max_binop_len=E8.getMaxKeyLen(E8.binary_ops)),E8.right_associative.delete(e),E8}static removeAllBinaryOps(){return E8.binary_ops={},E8.max_binop_len=0,E8}static removeLiteral(e){return delete E8.literals[e],E8}static removeAllLiterals(){return E8.literals={},E8}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(e){this.expr=e,this.index=0}static parse(e){return new E8(e).parse()}static getMaxKeyLen(e){return Math.max(0,...Object.keys(e).map((e=>e.length)))}static isDecimalDigit(e){return e>=48&&e<=57}static binaryPrecedence(e){return E8.binary_ops[e]||0}static isIdentifierStart(e){return e>=65&&e<=90||e>=97&&e<=122||e>=128&&!E8.binary_ops[String.fromCharCode(e)]||E8.additional_identifier_chars.has(String.fromCharCode(e))}static isIdentifierPart(e){return E8.isIdentifierStart(e)||E8.isDecimalDigit(e)}throwError(e){let t=new Error(e+" at character "+this.index);throw t.index=this.index,t.description=e,t}runHook(e,t){if(E8.hooks[e]){let r={context:this,node:t};return E8.hooks.run(e,r),r.node}return t}searchHook(e){if(E8.hooks[e]){let t={context:this};return E8.hooks[e].find((function(e){return e.call(t.context,t),t.node})),t.node}}gobbleSpaces(){let e=this.code;for(;e===E8.SPACE_CODE||e===E8.TAB_CODE||e===E8.LF_CODE||e===E8.CR_CODE;)e=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");let e=this.gobbleExpressions(),t=1===e.length?e[0]:{type:E8.COMPOUND,body:e};return this.runHook("after-all",t)}gobbleExpressions(e){let t,r,n=[];for(;this.index<this.expr.length;)if(t=this.code,t===E8.SEMCOL_CODE||t===E8.COMMA_CODE)this.index++;else if(r=this.gobbleExpression())n.push(r);else if(this.index<this.expr.length){if(t===e)break;this.throwError('Unexpected "'+this.char+'"')}return n}gobbleExpression(){let e=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",e)}gobbleBinaryOp(){this.gobbleSpaces();let e=this.expr.substr(this.index,E8.max_binop_len),t=e.length;for(;t>0;){if(E8.binary_ops.hasOwnProperty(e)&&(!E8.isIdentifierStart(this.code)||this.index+e.length<this.expr.length&&!E8.isIdentifierPart(this.expr.charCodeAt(this.index+e.length))))return this.index+=t,e;e=e.substr(0,--t)}return!1}gobbleBinaryExpression(){let e,t,r,n,i,s,a,o,l;if(s=this.gobbleToken(),!s||(t=this.gobbleBinaryOp(),!t))return s;for(i={value:t,prec:E8.binaryPrecedence(t),right_a:E8.right_associative.has(t)},a=this.gobbleToken(),a||this.throwError("Expected expression after "+t),n=[s,i,a];t=this.gobbleBinaryOp();){if(r=E8.binaryPrecedence(t),0===r){this.index-=t.length;break}i={value:t,prec:r,right_a:E8.right_associative.has(t)},l=t;let o=e=>i.right_a&&e.right_a?r>e.prec:r<=e.prec;for(;n.length>2&&o(n[n.length-2]);)a=n.pop(),t=n.pop().value,s=n.pop(),e={type:E8.BINARY_EXP,operator:t,left:s,right:a},n.push(e);e=this.gobbleToken(),e||this.throwError("Expected expression after "+l),n.push(i,e)}for(o=n.length-1,e=n[o];o>1;)e={type:E8.BINARY_EXP,operator:n[o-1].value,left:n[o-2],right:e},o-=2;return e}gobbleToken(){let e,t,r,n;if(this.gobbleSpaces(),n=this.searchHook("gobble-token"),n)return this.runHook("after-token",n);if(e=this.code,E8.isDecimalDigit(e)||e===E8.PERIOD_CODE)return this.gobbleNumericLiteral();if(e===E8.SQUOTE_CODE||e===E8.DQUOTE_CODE)n=this.gobbleStringLiteral();else if(e===E8.OBRACK_CODE)n=this.gobbleArray();else{for(t=this.expr.substr(this.index,E8.max_unop_len),r=t.length;r>0;){if(E8.unary_ops.hasOwnProperty(t)&&(!E8.isIdentifierStart(this.code)||this.index+t.length<this.expr.length&&!E8.isIdentifierPart(this.expr.charCodeAt(this.index+t.length)))){this.index+=r;let e=this.gobbleToken();return e||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:E8.UNARY_EXP,operator:t,argument:e,prefix:!0})}t=t.substr(0,--r)}E8.isIdentifierStart(e)?(n=this.gobbleIdentifier(),E8.literals.hasOwnProperty(n.name)?n={type:E8.LITERAL,value:E8.literals[n.name],raw:n.name}:n.name===E8.this_str&&(n={type:E8.THIS_EXP})):e===E8.OPAREN_CODE&&(n=this.gobbleGroup())}return n?(n=this.gobbleTokenProperty(n),this.runHook("after-token",n)):this.runHook("after-token",!1)}gobbleTokenProperty(e){this.gobbleSpaces();let t=this.code;for(;t===E8.PERIOD_CODE||t===E8.OBRACK_CODE||t===E8.OPAREN_CODE||t===E8.QUMARK_CODE;){let r;if(t===E8.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==E8.PERIOD_CODE)break;r=!0,this.index+=2,this.gobbleSpaces(),t=this.code}this.index++,t===E8.OBRACK_CODE?(e={type:E8.MEMBER_EXP,computed:!0,object:e,property:this.gobbleExpression()},this.gobbleSpaces(),t=this.code,t!==E8.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):t===E8.OPAREN_CODE?e={type:E8.CALL_EXP,arguments:this.gobbleArguments(E8.CPAREN_CODE),callee:e}:(t===E8.PERIOD_CODE||r)&&(r&&this.index--,this.gobbleSpaces(),e={type:E8.MEMBER_EXP,computed:!1,object:e,property:this.gobbleIdentifier()}),r&&(e.optional=!0),this.gobbleSpaces(),t=this.code}return e}gobbleNumericLiteral(){let e,t,r="";for(;E8.isDecimalDigit(this.code);)r+=this.expr.charAt(this.index++);if(this.code===E8.PERIOD_CODE)for(r+=this.expr.charAt(this.index++);E8.isDecimalDigit(this.code);)r+=this.expr.charAt(this.index++);if(e=this.char,"e"===e||"E"===e){for(r+=this.expr.charAt(this.index++),e=this.char,("+"===e||"-"===e)&&(r+=this.expr.charAt(this.index++));E8.isDecimalDigit(this.code);)r+=this.expr.charAt(this.index++);E8.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+r+this.char+")")}return t=this.code,E8.isIdentifierStart(t)?this.throwError("Variable names cannot start with a number ("+r+this.char+")"):(t===E8.PERIOD_CODE||1===r.length&&r.charCodeAt(0)===E8.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:E8.LITERAL,value:parseFloat(r),raw:r}}gobbleStringLiteral(){let e="",t=this.index,r=this.expr.charAt(this.index++),n=!1;for(;this.index<this.expr.length;){let t=this.expr.charAt(this.index++);if(t===r){n=!0;break}if("\\"===t)switch(t=this.expr.charAt(this.index++),t){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+=t}else e+=t}return n||this.throwError('Unclosed quote after "'+e+'"'),{type:E8.LITERAL,value:e,raw:this.expr.substring(t,this.index)}}gobbleIdentifier(){let e=this.code,t=this.index;for(E8.isIdentifierStart(e)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(e=this.code,E8.isIdentifierPart(e));)this.index++;return{type:E8.IDENTIFIER,name:this.expr.slice(t,this.index)}}gobbleArguments(e){let t=[],r=!1,n=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let i=this.code;if(i===e){r=!0,this.index++,e===E8.CPAREN_CODE&&n&&n>=t.length&&this.throwError("Unexpected token "+String.fromCharCode(e));break}if(i===E8.COMMA_CODE){if(this.index++,n++,n!==t.length)if(e===E8.CPAREN_CODE)this.throwError("Unexpected token ,");else if(e===E8.CBRACK_CODE)for(let e=t.length;e<n;e++)t.push(null)}else if(t.length!==n&&0!==n)this.throwError("Expected comma");else{let e=this.gobbleExpression();(!e||e.type===E8.COMPOUND)&&this.throwError("Expected comma"),t.push(e)}}return r||this.throwError("Expected "+String.fromCharCode(e)),t}gobbleGroup(){this.index++;let e=this.gobbleExpressions(E8.CPAREN_CODE);if(this.code===E8.CPAREN_CODE)return this.index++,1===e.length?e[0]:!!e.length&&{type:E8.SEQUENCE_EXP,expressions:e};this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:E8.ARRAY_EXP,elements:this.gobbleArguments(E8.CBRACK_CODE)}}},A8=new class{add(e,t,r){if("string"!=typeof arguments[0])for(let n in arguments[0])this.add(n,arguments[0][n],arguments[1]);else(Array.isArray(e)?e:[e]).forEach((function(e){this[e]=this[e]||[],t&&this[e][r?"unshift":"push"](t)}),this)}run(e,t){this[e]=this[e]||[],this[e].forEach((function(e){e.call(t&&t.context?t.context:t,t)}))}};Object.assign(E8,{hooks:A8,plugins:new class{constructor(e){this.jsep=e,this.registered={}}register(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach((e=>{if("object"!=typeof e||!e.name||!e.init)throw new Error("Invalid JSEP plugin format");this.registered[e.name]||(e.init(this.jsep),this.registered[e.name]=e)}))}}(E8),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},right_associative:new Set,additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"}),E8.max_unop_len=E8.getMaxKeyLen(E8.unary_ops),E8.max_binop_len=E8.getMaxKeyLen(E8.binary_ops);var M8=e=>new E8(e).parse();Object.getOwnPropertyNames(E8).forEach((e=>{void 0===M8[e]&&"prototype"!==e&&(M8[e]=E8[e])})),M8.Jsep=E8;var T8={name:"ternary",init(e){e.hooks.add("after-expression",(function(t){if(t.node&&this.code===e.QUMARK_CODE){this.index++;let r=t.node,n=this.gobbleExpression();if(n||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===e.COLON_CODE){this.index++;let i=this.gobbleExpression();if(i||this.throwError("Expected expression"),t.node={type:"ConditionalExpression",test:r,consequent:n,alternate:i},r.operator&&e.binary_ops[r.operator]<=.9){let n=r;for(;n.right.operator&&e.binary_ops[n.right.operator]<=.9;)n=n.right;t.node.test=n.right,n.right=t.node,t.node=r}}else this.throwError("Expected :")}}))}};function P8(e){return{all:e=e||new Map,on:function(t,r){var n=e.get(t);n?n.push(r):e.set(t,[r])},off:function(t,r){var n=e.get(t);n&&(r?n.splice(n.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var n=e.get(t);n&&n.slice().map((function(e){e(r)})),(n=e.get("*"))&&n.slice().map((function(e){e(t,r)}))}}}M8.plugins.register(T8);var k8=class{constructor(e,t,r){var n;this.id=e,this.userAPI=t,this.result=void 0,this.error="null",this.isPrefetched=!1,this.isLoading=!1,this.isLoaded=!1,this.prefetchPromise=new Promise((e=>e())),this.emitter=P8(),this._innerCallUserAPI=async e=>{this.emitter.emit("start",{userAPIId:this.id}),this.isLoading=!0,this.isLoading=!1;try{this.result=await async function(e,t){var r,n,i,s,a;let o,l,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new AbortController,u=e.url,h=null!==(r=null===(n=e.proxy)||void 0===n?void 0:n.enabled)&&void 0!==r&&r;if("OpenAI"===(null===(i=e.integration)||void 0===i?void 0:i.type)){let r=O8(""===e.integration.prompt?[]:JSON.parse(e.integration.prompt),t),n=""===e.integration.behavior?[]:O8(JSON.parse(e.integration.behavior),t);l='{\n\t\t"model": "'.concat(e.integration.model,'",\n\t\t"messages": [').concat(e.integration.useBehavior?'\n\t\t{\n\t\t\t"role": "system",\n\t\t\t"content": "'.concat(n,'"\n\t\t},'):"",'\n\t\t{\n\t\t\t"role": "user",\n\t\t\t"content": "').concat(r,'"\n\t\t}\n\t\t]\n\t}')}if(h){let r;u="".concat("https://apis.spline.design/","file/").concat(e.proxy.fileId,"/external-api/request?uuidexternalapi=").concat(e.proxy.proxyId),void 0!==l?r=l:"POST"===e.method&&e.body&&(r=O8(JSON.parse(e.body),t)),void 0!==r&&(u+="&data=".concat(encodeURIComponent(r.replace(/(\r\n|\n|\r|\t)/gm,""))))}else"OpenAI"===(null===(s=e.integration)||void 0===s?void 0:s.type)?o=l:"POST"===e.method&&e.body&&(o=O8(JSON.parse(e.body),t));let d=await fetch(u,{method:h?"GET":e.method,headers:h?void 0:D8(e),signal:c.signal,body:o});if(!d.ok)throw new Error("status:"+d.status+"_:_"+d.statusText);if("OpenAI"===(null===(a=e.integration)||void 0===a?void 0:a.type)){let e=await d.json();return h&&(e=e.response),{content:e.choices[0].message.content}}{let e=await d.json();return h&&(e=e.response),e}}(this.userAPI,e),this.error="null",this.emitter.emit("success",{userAPIId:this.id})}catch(t){var r,n;let i=null!==(r=null===(n=t.message)||void 0===n||null===(n=n.split("_:_"))||void 0===n||null===(n=n[0])||void 0===n?void 0:n.replace("status:",""))&&void 0!==r?r:"null";this.error=i,this.result=null,this.emitter.emit("error",{userAPIId:this.id})}this.isLoading=!1,this.isPrefetched=!0,this.isLoaded=!0},"OpenAI"===(null===t||void 0===t||null===(n=t.integration)||void 0===n?void 0:n.type)?this.result={content:""}:"GET"===t.method&&""!==t.url&&(this.prefetchPromise=this.prefetch(r)),this._debouncedCallUserAPI=this._innerCallUserAPI,this._updateDebouncedCallUserAPI(),this._debouncedPrefetch=eZ(this.prefetch,1e3,{trailing:!0})}_updateDebouncedCallUserAPI(){this._debouncedCallUserAPI=void 0!==this.userAPI.debounce&&this.userAPI.debounce>0?eZ(this._innerCallUserAPI,this.userAPI.debounce,{leading:!0,trailing:!0}):this._innerCallUserAPI}async prefetch(e){await this.callUserAPI(e)}async callUserAPI(e){await this._debouncedCallUserAPI(e)}update(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.userAPI=e,this._updateDebouncedCallUserAPI(),""!==this.userAPI.url&&"GET"===this.userAPI.method&&r&&this._debouncedPrefetch(t)}retrieveValue(e){if(this.result)try{return kJ.zoom(this.result,e)}catch(n0){console.error(n0)}}retrieveZoomedKeyValues(e){if(this.result){let t=e&&e.length?kJ.zoom(this.result,e):this.result;if(function(e){return"object"==typeof e&&null!==e}(t))return Object.entries(t);if(function(e){return Array.isArray(e)}(t))return t.map(((e,t)=>[t.toString(),e]));throw function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(t)?new Error("This path points to a value, use retrieveValue() instead. "+(null===e||void 0===e?void 0:e.join("."))):new Error("Path error"+(null===e||void 0===e?void 0:e.join(".")))}}dispose(){}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}get autostart(){return this.userAPI.autoStart}};function D8(e){let t=new Headers;return e.headers.forEach((e=>{""!==e.data.key&&t.append(e.data.key,e.data.value)})),t}var I8=(e,t)=>{if("string"==typeof e){let r=t.getVariable(e);if(r)return I8(r,t)}return m2.isBoolean(e)?m2.getDisplayedValue(e).toLowerCase():m2.getDisplayedValue(e)},O8=(e,t)=>e.map(((e,r)=>{if("text"in e)return e.text;if("type"in e){if("paragraph"===e.type)return(r>0?"\n":"")+O8(e.children,t);if("variable"===e.type){let r=t.getVariable(e.variableId);if(void 0!==r)return I8(r,t)}}return""})).join(""),R8=["+","-","*","/","(",")","==","!=",">","<",">=","<=","and","or","!","%","^",","],L8=["0","1","2","3","4","5","6","7","8","9","."],N8=["sin","cos","tan","asin","acos","atan","atan2","sqrt","abs","log","exp","floor","ceil","round","min","max","random"];function B8(e){return"string"==typeof e&&(!isNaN(e)&&!isNaN(parseFloat(e)))}function z8(e,t){let r,n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"number",s="";for(let o=0;o<e.length;o++){let r=e[o];if("objType"in r&&"api"===r.objType){let e=JSON.parse(r.id),n=e[0],i=t.getUserAPI(n);if(void 0!==i&&i instanceof k8){let t=i.retrieveValue(e.slice(1));void 0!==t&&(s+=t)}}else if("objType"in r&&"webhook"===r.objType){let e=JSON.parse(r.id),[n,i]=e,a=t.getUserWebhook(n);if(void 0!==a){let e=a.getParameterValue(i);void 0!==e&&(s+=e)}}else if("objType"in r&&"aiAssistant"===r.objType){var a;let e=t.openAIRealtime;if("objId"in r&&void 0!==r.objId){let n;if(t.scene.data.objects.traverse(((e,t)=>{var i;let s=null===(i=t.events)||void 0===i?void 0:i.find((e=>e.id===r.objId));s&&(n=s)})),void 0!==n&&"AIAssistantListener"===n.data.type){let t=null===e||void 0===e?void 0:e.computeAnalysisForListenerEvent(n.data);if(void 0!==t){s+=t;continue}}}s+=null!==(a=null===e||void 0===e?void 0:e.voice)&&void 0!==a?a:0}else if("id"in r){let n=e[o-1];if(o>0&&"id"in n)return void console.error("Two variables in a row",e);let a=t.getVariable(r.id),l=m2.getDisplayedValue(a);"number"===i&&m2.isTextValue(a)&&Array.isArray(a.textValue)&&1===a.textValue.length?l=parseFloat(l).toString():"boolean"===i&&m2.isBoolean(a)?l=a?"true":"false":"boolean"===i&&m2.isTextValue(a)&&!Array.isArray(a.textValue)&&(l='"'+l+'"'),s+=l}else"string"!==i?"and"!==r.name?"or"!==r.name?"True"!==r.name?"False"!==r.name?"boolean"!==i||B8(r.name)||L8.includes(r.name)||R8.includes(r.name)||N8.includes(r.name.replace(/\($/g,""))?s+=r.name:s+='"'+r.name+'"':s+="false":s+="true":s+="||":s+="&&":('"'!==r.name&&("+"!==r.name||r.escaped)&&(s+=r.name),"+"===r.name&&!r.escaped&&"\\"===s[s.length-1]&&(s=s.slice(0,-1)+r.name))}if("string"===i)return s;if(0===e.length){if("number"===i)return 0;if("boolean"===i)return!1}try{r=M8(s)}catch(T0){return void console.error(s,T0)}try{n=F8(r)}catch(T0){console.error(s,r,T0)}return n}function F8(e){switch(e.type){case"BinaryExpression":switch(e.operator){case"==":return Number(F8(e.left)===F8(e.right));case"!=":return Number(F8(e.left)!==F8(e.right));case">":return Number(F8(e.left)>F8(e.right));case">=":return Number(F8(e.left)>=F8(e.right));case"<":return Number(F8(e.left)<F8(e.right));case"<=":return Number(F8(e.left)<=F8(e.right));case"+":return F8(e.left)+F8(e.right);case"-":return F8(e.left)-F8(e.right);case"*":return F8(e.left)*F8(e.right);case"/":return F8(e.left)/F8(e.right);case"%":return F8(e.left)%F8(e.right);case"&&":return F8(e.left)&&F8(e.right);case"||":return F8(e.left)||F8(e.right);case"^":return Math.pow(F8(e.left),F8(e.right));default:throw new Error("Unknown operator: "+e.operator)}case"UnaryExpression":switch(e.operator){case"-":return-F8(e.argument);case"!":return Number(!F8(e.argument));default:throw new Error("Unknown operator: "+e.operator)}case"Identifier":throw new Error("Unknown identifier: "+e.name);case"Literal":return e.value;case"CallExpression":if("Identifier"===e.callee.type){if("random"===e.callee.name){let t=0,r=1;if(e.arguments.length>=1)try{t=F8(e.arguments[0])}catch(ca){console.warn(ca)}if(e.arguments.length>=2)try{r=F8(e.arguments[1])}catch(ca){console.warn(ca)}return t=Math.min(r,t),r=Math.max(r,t),t+Math.random()*(r-t)}return Math[e.callee.name].apply(null,e.arguments.map(F8))}throw new Error("Unknown node");default:throw new Error("Unknown node type: "+e.type)}}M8.addBinaryOp("^",11,!0);var j8=new sz,U8=new sz;var V8=class extends iF{constructor(e){super(),this.type="PathExtrusionGeometry",this.inputs=e,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&1===this.inputs.parameters.extrusion.depth}_isOpenEnded(){let e=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&1===e.depth)||!function(e,t){let r=2*Math.PI;return(e%r+r)%r===(t%r+r)%r}(e.twist,0)||e.startScale!==e.endScale}build(){let e=this._extractPathPoints();if(e.length<2)return;let t=this._computeBasisMatrices(e),{depth:r,offset:n}=this.inputs.parameters.extrusion;r=Math.max(0,Math.min(r,1)),n=Math.max(0,Math.min(n,1));let i=this.inputs.path.isClosed?e.length:e.length-1,s=Math.floor(n*i),a=this.inputs.path.isClosed?Math.ceil((r+n)*i):Math.ceil(Math.min(1,r+n)*i),o=Math.min(Math.max(2,a-s+1),i+2),l=[],c=[];for(let R=0;R<o;R++){let r=this.inputs.path.isClosed?(R+s)%e.length:Math.min(R+s,e.length-1);l.push(e[r].clone()),c.push(t[r].clone())}let u=(e,t,r)=>{l[e]=l[e].clone().lerp(l[t],r),c[e]=function(e,t,r){let n=[new PB,new PB,new PB],i=[new PB,new PB,new PB];return e.extractBasis(n[0],n[1],n[2]),t.extractBasis(i[0],i[1],i[2]),n.forEach(((e,t)=>{let n=i[t],s=$N.lerp(e.length(),n.length(),r);e.lerp(n,r).setLength(s)})),(new sz).makeBasis(n[0],n[1],n[2])}(c[e],c[t],r)},h=0,d=n*i%1;(!this.inputs.path.isClosed||r<=1)&&(d||0===n)&&(h=d,u(0,1,h));let f=0,p=(n+r)*i%1;if((this.inputs.path.isClosed&&r<=1||!this.inputs.path.isClosed&&n+r<1)&&p&&(f=p,u(l.length-1,l.length-2,1-f)),0===r){let e=l.length-1;l[e].copy(l[0]),c[e].copy(c[0])}this._applyPathModifiers(c,h,f);let{bevel:m,bevelSides:g}=this.inputs.parameters.extrusion,v=m>0?this.inputs.parameters.extrusion.capType:"flat",y=5;"Custom"===this.inputs.parameters.extrusion.shape.type&&(y="low"===this.inputs.parameters.extrusion.shape.shapeQuality?5:12);let b,{regions:w,infos:x,vertices:S}=this._computeShapePoints(y),_=0;"round"===v&&(b=new L6(this.inputs.shapeData,2*m,m,y,g,void 0,!0),_=b.getAttribute("position").count);let C=0,E=0;x.sort(((e,t)=>e.start-t.start)),x.forEach((e=>{e.verticesStart=C,e.verticesCount=e.continuous.reduce(((e,t,r)=>e+(0!==r&&t?1:2)),0),E+=e.verticesCount,C=E}));let A,M=E*o,T=0;if(this._isOpenEnded()&&"flat"===v){try{A=C6({windingRule:K5.ODD,elementType:Z5.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:w})}catch(O){A=O6}T=A.vertexCount}let P=M+2*T+2*_,k=M+2*T,D={positions:new Float32Array(3*P),normals:new Float32Array(3*P),uvs:new Float32Array(2*P)},I=[];if(x.forEach((e=>{this._extrudeRegion(e,S,c,l,D,I,this._isGeometryClosed()&&!this._isOpenEnded())})),A&&(this._closeEnd(A,M,I,D,c[0],l[0],!1),this._closeEnd(A,M+T,I,D,c[c.length-1],l[l.length-1],!0)),b){D.positions.set(b.getAttribute("position").array,3*k),D.normals.set(b.getAttribute("normal").array,3*k),D.uvs.set(b.getAttribute("uv").array,2*k);for(let n=k;n<k+_;n++)D.uvs[2*n+1]=1e-4;let e=I.length;I.push(...b.getIndex().array.map((e=>e+k))),k+=_,D.positions.set(b.getAttribute("position").array,3*k),D.normals.set(b.getAttribute("normal").array,3*k),D.uvs.set(b.getAttribute("uv").array,2*k);let t=I.length;I.push(...b.getIndex().array.map((e=>e+k))),this.setAttribute("position",new Xz(D.positions,3)),this.setAttribute("normal",new Xz(D.normals,3)),this.setAttribute("uv",new Xz(D.uvs,2)),this.setIndex(I);let r=j8;r.copy(c[c.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(r,k,P),r.copy(c[0]).setPosition(l[0]).multiply(U8.makeScale(1,1,-1)),this.applyMatrix4OnRange(r,k-_,k),this.reverseIndicesOnRange(e,t)}else this.setAttribute("position",new Xz(D.positions,3)),this.setAttribute("normal",new Xz(D.normals,3)),this.setAttribute("uv",new Xz(D.uvs,2)),this.setIndex(I)}_extractPathPoints(){let e=o5(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(e.length<2)return[];let t=[e[0]];return e.forEach((e=>{t[t.length-1].distanceToSquared(e)>.001&&t.push(e)})),this.inputs.path.isClosed&&t[t.length-1].distanceTo(t[0])<.001&&t.pop(),t}_computeBasisMatrices(e){let t=[],r=e.length,n=this.inputs.path.isClosed,i=new PB,s=new PB,a=new PB,o=new PB,l=new PB(0,1,0);for(let p=0;p<r;p++){let c,u,h=e[p];c=0===p?n?e[e.length-2]:h.clone().multiplyScalar(2).sub(e[1]):e[p-1],u=p===r-1?n?e[1]:h.clone().multiplyScalar(2).sub(e[p-1]):e[p+1];let d=h.clone().sub(c).normalize(),f=u.clone().sub(h).normalize(),m=d.clone().add(f).normalize();a.copy(m),0===p&&(m.equals(l)||m.clone().negate().equals(l))&&l.set(0,0,1);let g=l.clone().cross(m).normalize(),v=m.clone().cross(g).normalize();l.copy(v),o.copy(g),0===p&&(i.copy(v),s.copy(m));let y=(new sz).makeBasis(g,v,m);t.push(y)}let c=n?s:a,u=n?i:new PB(0,1,0),h=c.clone().cross(o).normalize(),d=Math.acos(u.dot(h));if(isNaN(d))return t;let f=u.clone().cross(h);c.dot(f)>0&&(d*=-1);for(let p=1;p<t.length;p++){let e=(new sz).makeRotationZ(d*p/t.length);t[p].multiply(e)}return t}_applyPathModifiers(e,t,r){let n=e.length,{angle:i,twist:s,startScale:a,endScale:o}=this.inputs.parameters.extrusion,l=new sz,c=new sz;return e.forEach(((e,u)=>{let h=0===u?0:u===n-1?1:(u-t)/(n-(0===r?0:1)-(t+(1-r)));l.makeRotationZ($N.lerp(i,i+s,h)*$N.DEG2RAD);let d=$N.lerp(a,o,h);c.makeScale(d,d,d),e.multiply(l).multiply(c)})),e}_computeShapePoints(){let e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:K5.ODD,i=this.inputs.shapeData,s=i.extractShapePointsToFlatArray([],r),a=i.shapeHoles.map((e=>{let t=e.extractShapePointsToFlatArray([],r),n=[];for(let r=t.length-1;r>=1;r-=2){let e=t[r-1],i=t[r-0];n.push(e,i)}return n}));try{e=C6({windingRule:n,elementType:Z5.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[s]})}catch(f){e=D6}try{t=C6({windingRule:K5.ODD,elementType:Z5.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...a]})}catch(p){t=I6}if(!e)throw new Error("error generating geometry");let o=e.elementCount;if(t){e.elementCount+=t.elementCount;for(let r=0;r<t.elements.length;r++){let n=t.elements[r],i=r%2===0?e.vertexCount:0;e.elements.push(n+i)}for(let r=0;r<t.vertexIndices.length;r++){let n=t.vertexIndices[r],i=e.vertexCount;e.vertexIndices.push(n+i)}for(let r=0;r<t.vertices.length;r++){let n=t.vertices[r];e.vertices.push(n)}}let l=1/0,c=-1/0,u=1/0,h=-1/0;for(let m=0,g=e.vertexCount;m<g;m++){let t=2*m,r=e.vertices[t+0],n=e.vertices[t+1];r<l&&(l=r),r>c&&(c=r),n<u&&(u=n),n>h&&(h=n)}let d=[];for(let m=e.elementCount-1;m>=0;m--){let t=m>=o,r=2*m,n=e.elements[r+0],s=e.elements[r+1],a=n+s,l={start:n,count:s,normals:[],isHole:t,continuous:[],verticesStart:0,verticesCount:0};d.push(l);let c=n,u=a-1,h=n+1,f=i.roundedCurves.length;do{let r=c-n,o=e.vertices[2*u+0],d=e.vertices[2*u+1],p=e.vertices[2*c+0],m=e.vertices[2*c+1],g=e.vertices[2*h+0],v=e.vertices[2*h+1],y=p-o,b=m-d,w=Math.sqrt(y*y+b*b);y/=w,b/=w;let x=p-g,S=m-v,_=Math.sqrt(x*x+S*S);x/=_,S/=_,l.normals[2*r+0]=-S,l.normals[2*r+1]=x;let C=e.vertexIndices[c];if(Array.isArray(C))l.continuous[r]=!1;else{let[e,t]=i.getCurveIndexFromVertexId(C-1,!0);if(t>0&&t<1)l.continuous[r]=!0;else{let n=1===t?e+1:e-1;n=(n+f)%f;let s=1===t?0:1,a=i.roundedCurves[e].getTangent(t),o=i.roundedCurves[n].getTangent(s);l.continuous[r]=a.dot(o)>.95}}t&&(l.normals[2*r+0]*=-1,l.normals[2*r+1]*=-1),[u,c,h]=[c,h,h+1],h>=a&&(h-=s)}while(h!==n+1)}return{regions:[s,...a],infos:d,vertices:e.vertices}}_insertVertex(e,t,r,n,i){let s=2*t,a=3*t;e.positions[a+0]=r.x,e.positions[a+1]=r.y,e.positions[a+2]=r.z,e.normals[a+0]=n.x,e.normals[a+1]=n.y,e.normals[a+2]=n.z,e.uvs[s+0]=i.x,e.uvs[s+1]=i.y}_extrudeRegion(e,t,r,n,i,s,a){let o=new PB,l=new PB,c=new PB,u=new PB,h=new eB;r.forEach(((s,a)=>{let d=n[a],f=e.verticesStart*r.length+e.verticesCount*a;for(let n=0;n<e.count;n++){let p=2*(e.start+n);if(o.set(t[p+0],t[p+1],0),c.copy(o).applyMatrix4(s).add(d),e.continuous[n])u.set(e.normals[2*n+0],e.normals[2*n+1],0);else{let r=0===n?2*(e.start+e.count-1):p-2;l.set(t[r+0],t[r+1],0),u.copy(o).sub(l),u.set(-u.y,u.x,0),e.isHole||u.negate()}if(u.applyMatrix4(s).normalize(),h.set(0===n?1:n/e.count,a/(r.length-1)),this._insertVertex(i,f,c,u,h),f++,!e.continuous[n]||0===n){if(0===n)u.set(e.normals[2*n+0],e.normals[2*n+1],0),h.set(0,a/(r.length-1));else{let r=n===e.count-1?2*e.start:p+2;l.set(t[r+0],t[r+1],0),u.copy(l).sub(o),u.set(-u.y,u.x,0),e.isHole||u.negate()}u.applyMatrix4(s).normalize(),this._insertVertex(i,f,c,u,h),f++}}}));let d=r.length-1;for(let f=0;f<d;f++){let t=e.verticesStart*r.length+e.verticesCount*f,n=e.verticesStart*r.length+e.verticesCount*(f+1),i=0;for(let r=0;r<e.count;r++){(!e.continuous[r]||0===r)&&i++;let a=r===e.count-1?0:i+1,o=t+i,l=t+a,c=n+a,u=n+i;e.isHole?s.push(o,c,l,o,u,c):s.push(o,l,c,o,c,u),i++}}}_closeEnd(e,t,r,n,i,s,a){let o=e.vertexCount,l=new PB(0,0,a?-1:1).applyMatrix4(i),c=new PB,u=new eB;for(let d=0;d<o;d++){let r=2*d;c.set(e.vertices[r+0],e.vertices[r+1],0).applyMatrix4(i).add(s),this._insertVertex(n,t+d,c,l,u)}let h=e.elements;for(let d=0;d<e.elementCount;d++){let e=3*d,n=h[e+0]+t,i=h[e+(a?1:2)]+t,s=h[e+(a?2:1)]+t;r.push(n,i,s)}}applyMatrix4OnRange(e,t,r){let n,i,s,a,o=e.elements,l=(new tB).getNormalMatrix(e).elements,c=this.attributes.position,u=this.attributes.normal;if(!c||!u)return;let h=c.array,d=u.array,f=c.itemSize;for(let p=t*f,m=r*f;p<m;p+=f)n=h[p+0],i=h[p+1],s=h[p+2],a=1/(o[3]*n+o[7]*i+o[11]*s+o[15]),h[p+0]=(o[0]*n+o[4]*i+o[8]*s+o[12])*a,h[p+1]=(o[1]*n+o[5]*i+o[9]*s+o[13])*a,h[p+2]=(o[2]*n+o[6]*i+o[10]*s+o[14])*a,n=d[p+0],i=d[p+1],s=d[p+2],d[p+0]=l[0]*n+l[3]*i+l[6]*s,d[p+1]=l[1]*n+l[4]*i+l[7]*s,d[p+2]=l[2]*n+l[5]*i+l[8]*s;c.needsUpdate=!0,u.needsUpdate=!0}reverseIndicesOnRange(e,t){let r=this.index;if(r){for(let n=e;n<t;n+=3){let e=r.getX(n),t=r.getX(n+1),i=r.getX(n+2);r.setXYZ(n,i,t,e)}r.needsUpdate=!0}}};function H8(){let e=new iF;return e.setAttribute("position",new Xz(new Float32Array([]),3)),e.setIndex(new Xz(new Uint16Array([]),1)),e}var W8=H8().attributes,G8=class extends iF{constructor(e,t){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,W8),this.userData={parameters:e,type:"TextGeometry"};let r=t.getFont(e.font);null!==r&&void 0!==r&&r.isLoaded?(this.font=r,this.update(e)):this.updateFont(e.font,t).then((()=>{this.update(e),null===t||void 0===t||t.requestRender()}))}async updateFont(e,t){let r=t.getFont(e);r&&(this.font=r,await r.loadingPromise)}update(e){let t=this.font;if(this.userData={parameters:e,type:"TextGeometry"},null===t||void 0===t||!t.isLoaded)return void console.warn("Cannot update text because its font is not loaded");let{width:r,height:n,depth:i,extrudeBevelSize:s,extrudeBevelSegments:a,text:o,textTransform:l}=e,c=m2.getDisplayedValue(o),u=function(e,t,r){let n=[""],i="";for(let s of r)i+=s," "===s||"\n"===s?(n[n.length-1]+=i,i="","\n"===s&&n.push("")):t.getTextWidth(n[n.length-1]+i,e)>e.width&&(n[n.length-1].length&&n.push(""),t.getTextWidth(n[n.length-1]+i,e)>e.width&&(1===i.length?(n[n.length-1]+=i,i=""):(n[n.length-1]+=i.slice(0,-1),i=i[i.length-1],n.push(""))));return n[n.length-1]+=i,n}(e,t,2===l?c.toUpperCase():3===l?c.toLowerCase():c),{shapes:h,charWidths:d,charCoords:f}=t.generateShapes(u,e),p=.5*("number"==typeof r?r:1),m=.5*("number"==typeof n?n:1),g=h.map((e=>(new i6).fromShape(e,!0)));this.vectorShapes=g;let v=g.map((e=>z6.create({shape:e,parameters:{depth:i,extrudeBevelSegments:a,extrudeBevelSize:s,windingRule:i<=0?K5.NONZERO:K5.ODD,subdivisions:this.isLowResolution&&i>0?1:12}}))),y=v.length?h3(v):H8();y.translate(-p,m,0),this.dispose(),this.wrappedText=u,this.charCoords=f,this.charWidths=d,this.deleteAttribute("extrudeNormal"),Object.entries(y.attributes).forEach((e=>{let[t,r]=e;this.setAttribute(t,r)})),this.setIndex(y.index),this.computeBoundingSphere()}clone(){let e=yZ(new iF,G8.prototype);return e.copy(this),console.log("CloneGeometry",this,e),e}copy(e){return Object.entries(e.attributes).forEach((e=>{let[t,r]=e;this.setAttribute(t,r)})),this.setIndex(e.index),this.userData={parameters:u({},e.userData.parameters),type:"TextGeometry"},this}async setText(e){this.font&&await this.font.loadingPromise,await this.update(u(u({},this.userData.parameters),{},{text:{textValue:e}}))}get text(){var e;return null!==(e=this.userData.parameters.text)&&void 0!==e?e:""}};var q8,X8,Y8=new Promise((e=>{q8=e})),K8=!1;function Q8(){if(!K8)return X8||(X8=async function(){let e=r.e(917).then(r.bind(r,298)),[t,n]=await Promise.all([e,fetch("".concat("https://unpkg.com/@splinetool/modelling-wasm@1.9.59/build","/process.wasm")).then((e=>e.arrayBuffer()))]),i=t.default,s=await i({wasmBinary:n});q8(s),K8=!0}(),X8)}var Z8=["font"];function J8(e,t,r,n){let i,s,a;"PathGeometry"===e.type?(s=JSON.parse(JSON.stringify(e)),a=[[],["extrusion"]]):(s=u({},e),a=[[]]);for(let u of a){let e=s;for(let t of u)e=e[t];for(i in e){let r=e[i];i1(r)&&!Z8.includes(i)&&(e[i]=t.getVariable(r,[n.uuid,"geometry",...u,i]),i1(e[i])&&(e[i]=1))}}let o,l={parameters:s,type:s.type};if("PathGeometry"===s.type)l.path=s.path;else if("VectorGeometry"===s.type){let e=i6.createFromState(s.shape,s.width,s.height);l.shape=e}else if("NonParametricGeometry"===s.type){var c;if(s.data.groups&&null!==(c=s.data.groups)&&void 0!==c&&c.forEach((e=>{var t;return e.materialIndex=Math.max(null!==(t=e.materialIndex)&&void 0!==t?t:0,0)})),l.geometry=(new UW).parse(s),0===l.geometry.groups.length){var h,d;let e=l.geometry;e.addGroup(0,Math.max(null!==(h=null===(d=e.getIndex())||void 0===d?void 0:d.count)&&void 0!==h?h:0,e.getAttribute("position").count),0)}}else{if("SubdivGeometry"===s.type){let t=new o9(s,r);return t.data=e,t}if("TextGeometry"===s.type)return new G8(s,t);if("InputGeometry"===s.type)return new G8(s,t);if("UIGeometry"===s.type)return x8.create({parameters:{width:s.width,height:s.height,cornerRadius:s.cornerRadius,cornerType:s.cornerType}})}try{o=D9(l)}catch(G0){console.error(G0)}if(!o){let e=i6.createFromState(C1.defaultData(),100,100);l.shape=e,o=D9(l)}return o}var $8=new sz;function e9(e,t,r,n){let i,s,a,o=e.position.array,l=e.normal.array,c=$8.makeScale(t,r,n).invert().elements;for(var u=0,h=o.length;u<h;u+=3)o[u]*=t,o[u+1]*=r,o[u+2]*=n,i=l[u],s=l[u+1],a=l[u+2],l[u]=c[0]*i+c[4]*s+c[8]*a,l[u+1]=c[1]*i+c[5]*s+c[9]*a,l[u+2]=c[2]*i+c[6]*s+c[10]*a;e.position.needsUpdate=!0,e.normal.needsUpdate=!0}var t9,r9=new IB,n9=new PB;Y8.then((e=>{t9=e}));var i9=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),s9=new Uint32Array([0,1,2,3]),a9=new Uint8Array([4]),o9=class extends iF{constructor(e,t){super(),this.data=e,this.flatShading=t,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(e,t){this.freeSubdivPointer();let r=this.data.scaleBaked,n=N0.div(t,r);this.subdividedGeometry&&e9(this.subdividedGeometry.attributes,...n),this.originalGeometry&&e9(this.originalGeometry.attributes,...n),this.data=e;let i=this.userData.parameters;this.userData.parameters={width:i.width*n[0],height:i.height*n[1],depth:i.depth*n[2]},this.originalGeometry.boundingSphere.center.multiply(n9.fromArray(n));let s=n9.set(i.width,i.height,i.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return 0===this.subdivPointer&&this.rebuild(),this.subdivPointer}rebuild(){var e,t;let r,n,i;try{({originalGeometry:r,subdividedGeometry:n,subdivPointer:i}=o9.build(this.data,void 0,!this.flatShading,void 0))}catch(a){r=new wF(100,100,100),i=0}this.subdivPointer=i,this.originalGeometry=r,this.subdividedGeometry=null!==(e=n)&&void 0!==e?e:void 0;let s=null!==(t=this.subdividedGeometry)&&void 0!==t?t:this.originalGeometry;Object.assign(this,s),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(o9.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let e=this.originalGeometry;null===e.boundingSphere&&(e.boundingSphere=new QB,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,r=e.boundingSphere.center;r9.setFromBufferAttribute(t),r9.getCenter(r),e.boundingSphere.radius=r.distanceTo(r9.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),r9.getSize(n9);let n={width:n9.x,height:n9.y,depth:n9.z};return this.userData.parameters=n,n}static build(e,t,r,n){var i;let s,a,o,l=null!==(i=null===e||void 0===e?void 0:e.phongAngle)&&void 0!==i?i:35;!1===r&&(l=-1),t&&(t9.free_bvh(t),t9.free_subdivision_surface(t));try{s=o9.allocate(e,n)}catch(c){console.error(c,e),s=o9.allocate({positionWASM:i9,indexWASM:s9,verticesPerFaceWASM:a9},n)}if(t9.set_destination_refinement_level(s,0),a=o9.buildLevel(s,!0,l),e.subdivisions>0)try{t9.set_destination_refinement_level(s,e.subdivisions),o=o9.buildLevel(s,!1,l)}catch(u){try{t9.set_destination_refinement_level(s,e.subdivisions-1),o=o9.buildLevel(s,!1,l)}catch(h){o=null}}else o=null;return{subdivPointer:s,originalGeometry:a,subdividedGeometry:o}}static primitiveToQuads(e,t,r){e.widthSegments>16&&(e.widthSegments=16),e.heightSegments>16&&(e.heightSegments=16),e.depthSegments>16&&(e.depthSegments=16),e.radialSegments>16&&(e.radialSegments=16),"DodecahedronGeometry"===e.type&&(e.detail=0);let n,i,s,a,o,l,c=void 0!==e.shape||void 0!==e.path?t.geometry:J8(e,r,!1);if(n="TorusGeometry"===e.type&&e.arc===2*Math.PI?c.getClosedTorusIndicesForBooleanOrSubdiv():c.getIndex(),({positions:i,triIndices:o}=c9(c.getAttribute("position"),n)),"CylinderGeometry"===e.type&&0===e.cornerRadius&&0===e.hollow&&!1===e.openEnded){let t=e.radialSegments*e.heightSegments*3*2;l=[t,t+3*e.radialSegments]}return({indices:s,verticesPerFace:a}=p9(i,o,c,l)),{positions:i,indices:s,verticesPerFace:a}}static allocate(e,t){var r;let n,i,s,a=[],o=[];e.positionWASM&&e.positionWASM.length>0?(n=e.positionWASM,i=e.indexWASM,s=e.verticesPerFaceWASM):(n=i9,i=s9,s=a9);let l,c=n.length,u=i.length,h=s.length,d=n.length+a.length+o.length,f=i.length+s.length,p=d*Float32Array.BYTES_PER_ELEMENT+f*Uint32Array.BYTES_PER_ELEMENT,m=d*Float32Array.BYTES_PER_ELEMENT,g=(Uint32Array.BYTES_PER_ELEMENT,t9._malloc(p)),v=new Float32Array(t9.HEAPF32.buffer,g,d),y=new Uint32Array(t9.HEAPU32.buffer,g+m,f);v.set(n,0),v.set(a,n.length),v.set(o,n.length+a.length),y.set(i,0),y.set(s,i.length),null!==e&&void 0!==e&&null!==(r=e.scaleBaked)&&void 0!==r&&r.some((e=>1!==e))&&(l=(new sz).makeScale(...e.scaleBaked)),t&&(l?l.premultiply(t):l=t);let b=l?t9.alloc_subdivision_surface2(g,c,g+m,u,g+m+i.length*Uint32Array.BYTES_PER_ELEMENT,h,l.elements):t9.alloc_subdivision_surface(g,c,g+m,u,g+m+i.length*Uint32Array.BYTES_PER_ELEMENT,h);return t9._free(g),b}static buildLevel(e,t,r,n,i){let s=i?t9.get_mesh_data2(e,t?t9.Level.CONTROL:t9.Level.REFINED,r,i.elements):t9.get_mesh_data(e,t?t9.Level.CONTROL:t9.Level.REFINED,r),a=t9.HEAPU32.subarray(s>>2,8+(s>>2)),o=a.subarray(4,8),l=0,c=t9.HEAPU32[a[l]>>2],u=t9.HEAPF32.subarray(c>>2,(c>>2)+o[l]);l++;let h=t9.HEAPU32[a[l]>>2],d=t9.HEAPF32.subarray(h>>2,(h>>2)+o[l]);l++;let f=t9.HEAPU32[a[l]>>2],p=t9.HEAPU32.subarray(f>>2,(f>>2)+o[l]);l++;let m=t9.HEAPU32[a[l]>>2],g=t9.HEAPU32.subarray(m>>2,(m>>2)+o[l]);if(l++,void 0===n){let e=new iF;if(e.setIndex(new Kz(g,1)),e.setAttribute("position",new Qz(u,3)),e.setAttribute("normal",new Qz(d,3)),t){e.setAttribute("faceMap",new Kz(p,1));let t=new Float32Array(d.length/3*4).fill(0);e.setAttribute("color",new Xz(t,4))}return t9.free_mesh_data(s),e.userData.type="SubdivGeometry",e}n.getAttribute("position").copyArray(u),n.getAttribute("normal").copyArray(d),n.attributes.position.needsUpdate=!0,n.attributes.normal.needsUpdate=!0,t9.free_mesh_data(s)}static freeSubdivPointer(e){t9.free_bvh(e),t9.free_subdivision_surface(e)}static buildControlCageWireframe(e,t,r){let n=t9.get_wireframe_data_for_base_level(e),i=t9.HEAPU32.subarray(n>>2,4+(n>>2)),s=i.subarray(2,4),a=0,o=t9.HEAPU32[i[a]>>2],l=t9.HEAPF32.subarray(o>>2,(o>>2)+s[a]);a++;let c=t9.HEAPU32[i[a]>>2],u=t9.HEAPU32.subarray(c>>2,(c>>2)+s[a]);if(void 0===t){let e=new iF;e.setAttribute("position",new Qz(l,3));let t=new Float32Array(l.length);for(let n=0,i=l.length;n<i;)t[n++]=r.r,t[n++]=r.g,t[n++]=r.b;return e.setAttribute("color",new Xz(t,3)),e.setIndex(new Kz(u,1)),t9.free_wireframe_data_for_base_level(n),e}t.getAttribute("position").copyArray(l),t.attributes.position.needsUpdate=!0,t9.free_wireframe_data_for_base_level(n)}static updateCollabMesh(e,t,r){let n=0===t;n||t9.set_destination_refinement_level(e,t);let i=r?t9.get_topological_data2(e,n?t9.Level.CONTROL:t9.Level.REFINED,r.elements):t9.get_topological_data(e,n?t9.Level.CONTROL:t9.Level.REFINED),s=t9.HEAPU32.subarray(i>>2,6+(i>>2)),a=s.subarray(3,6),o=0,l=t9.HEAPU32[s[o]>>2],c=new Float32Array(t9.HEAPF32.subarray(l>>2,(l>>2)+a[o]));o++;let u=t9.HEAPU32[s[o]>>2],h=new Uint32Array(t9.HEAPU32.subarray(u>>2,(u>>2)+a[o]));o++;let d=t9.HEAPU32[s[o]>>2],f=new Uint8Array(t9.HEAPU32.subarray(d>>2,(d>>2)+a[o]));return t9.free_topological_data(i),{positions:c,indices:h,verticesPerFace:f}}},l9=["getX","getY","getZ"];function c9(e,t){let r={},n=t?t.count:e.count,i=0,s=[],a=[];for(let l=0;l<n;l++){let n=t?t.getX(l):l,o="";for(let t=0;t<3;t++)o+="".concat(~~(1e4*e[l9[t]](n)),",");if(o in r)s.push(r[o]);else{for(let t=0;t<3;t++)a.push(e[l9[t]](n));r[o]=i,s.push(i),i++}}let o=[];for(let l=0;l<s.length;l+=3)s[l]===s[l+1]||s[l]===s[l+2]||s[l+1]===s[l+2]||o.push(s[l],s[l+1],s[l+2]);return{positions:a,triIndices:o}}var u9=new PB,h9=new PB,d9=new PB,f9=new PB;function p9(e,t,r,n){let i=[],s=[];if(void 0!==r.userData.shape&&0===r.userData.parameters.depth&&0===r.userData.shape.shapeHoles.length){let t=r.userData.shape.extractShapePointsToFlatArray([]),n=r.userData.parameters.spikes;if("EllipseGeometry"===r.userData.type&&n<=24&&n%4===0&&r.userData.parameters.angle>=360){let e=t.length/2/n;t=t.filter(((t,r)=>Math.floor(r/2)%e===0))}let a=0;for(let e=0;e<t.length;e+=2)a+=(t[e]-t[(0===e?t.length:e)-2])*(t[e+1]+t[(0===e?t.length:e)-1]);e.length=0;let o=0;if(a<0)for(let r=0;r<t.length;r+=2)e.push(t[r],t[r+1],0),i.push(o++);else for(let r=t.length-2;r>=0;r-=2)e.push(t[r],t[r+1],0),i.push(o++);return s.push(o),{indices:i,verticesPerFace:s}}let a=new Float32Array([r.userData.parameters.depth])[0],o=0;for(;o<t.length;){if(r.useNgonForTopBottomFaceDuringBake){let r=0;if((e[3*t[o]+2]===a||0===e[3*t[o]+2])&&r++,(e[3*t[o+1]+2]===a||0===e[3*t[o+1]+2])&&r++,(e[3*t[o+2]+2]===a||0===e[3*t[o+2]+2])&&r++,3===r)break}if(t[o+1]===t[o+3]&&t[o+2]===t[o+5]||t[o+0]===t[o+3]&&t[o+2]===t[o+4]){u9.set(e[3*t[o]],e[3*t[o]+1],e[3*t[o]+2]),h9.set(e[3*t[o+1]],e[3*t[o+1]+1],e[3*t[o+1]+2]),d9.set(e[3*t[o+4]],e[3*t[o+4]+1],e[3*t[o+4]+2]),f9.set(e[3*t[o+5]],e[3*t[o+5]+1],e[3*t[o+5]+2]),h9.sub(u9).normalize(),d9.sub(u9).normalize(),f9.sub(u9).normalize();let r=h9.cross(d9).dot(f9);Math.abs(r)>.005||n&&n.some(((e,t)=>t%2!==1&&(o>=n[t]&&o<n[t+1])))?(i.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3):(i.push(t[o],t[o+1],t[o+4],t[o+5]),s.push(4),o+=6)}else i.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3}if(r.useNgonForTopBottomFaceDuringBake){let t=[],n=[],o=0;for(let r=0,i=0;r<e.length;r+=3,i++)0===e[r+2]&&(t.push(i),o++),e[r+2]===a&&n.push(i);if(0===r.userData.parameters.extrudeBevelSize){let e=n[0];n[0]=n[1],n[1]=e}t.reverse(),i.push(...t,...n),s.push(o,o)}return{indices:i,verticesPerFace:s}}var m9={};((e,t)=>{for(var r in t)dL(e,r,{get:t[r],enumerable:!0})})(m9,{calcBoolean:()=>E9,calcBooleanTopological:()=>C9,freeMeshSet:()=>P9,getMeshSet:()=>A9,hasOpenEdges:()=>M9,transformMeshSet:()=>T9});var g9,v9,y9,b9,w9=new Promise((e=>{g9=e}));function x9(){if(v9)return v9;return v9=async function(){let e=r.e(516).then(r.bind(r,516)),[t,n]=await Promise.all([e,fetch("".concat("https://unpkg.com/@splinetool/boolean-wasm@1.9.59/build","/boolean.wasm")).then((e=>e.arrayBuffer()))]),i=t.default,s=await i({wasmBinary:n});g9(s)}(),v9}function S9(e){let t=e.length,r=t*Uint32Array.BYTES_PER_ELEMENT,n=t*Float32Array.BYTES_PER_ELEMENT,i=Number.isInteger(e[0])?r:n,s=y9._malloc(i);return(Number.isInteger(e[0])?new Uint32Array(y9.HEAPU32.buffer,s,t):new Float32Array(y9.HEAPF32.buffer,s,t)).set(e,0),s}function _9(e){switch(e){case 0:return y9.OP.UNION;case 1:return y9.OP.INTERSECTION;case 2:return y9.OP.A_MINUS_B;default:throw new Error("Unknown boolean operation "+e)}}function C9(e,t){void 0===b9&&(b9=y9.init_csg());let r=S9(e),n=y9.csg_calc_topological(b9,r,e.length,_9(t));y9._free(r);let i=y9.HEAPU32.subarray(n>>2,6+(n>>2)),s=i.subarray(3,6),a=0,o=y9.HEAPU32[i[a]>>2],l=new Float32Array(y9.HEAPF32.subarray(o>>2,(o>>2)+s[a]));a++;let c=y9.HEAPU32[i[a]>>2],u=new Uint32Array(y9.HEAPU32.subarray(c>>2,(c>>2)+s[a]));a++;let h=y9.HEAPU32[i[a]>>2],d=new Uint8Array(y9.HEAPU32.subarray(h>>2,(h>>2)+s[a]));return y9.free_mesh_data(n),{positions:l,indices:u,verticesPerFace:d}}function E9(e,t,r,n){void 0===b9&&(b9=y9.init_csg());let i=S9(e),s=y9.csg_calc(b9,i,e.length,n,_9(t));y9._free(i);let a=y9.HEAPU32.subarray(s>>2,5+(s>>2)),o=a.subarray(2,5),l=0,c=y9.HEAPU32[a[l]>>2],u=y9.HEAPF32.subarray(c>>2,(c>>2)+o[l]);l++;let h=y9.HEAPU32[a[l]>>2],d=y9.HEAPF32.subarray(h>>2,(h>>2)+o[l]);l++;let f=o[l];r.setAttribute("position",new Qz(u,3)),r.setAttribute("normal",new Qz(d,3));let p=y9.HEAPF32.subarray(5+(s>>2),5+(s>>2)+6);return null===r.boundingSphere&&(r.boundingSphere=new QB),r.boundingSphere.center.set(p[0],p[1],p[2]),r.boundingSphere.radius=(p[3]**2+p[4]**2+p[5]**2)**.5,r.userData.parameters={width:2*p[3],height:2*p[4],depth:2*p[5]},y9.free_mesh_data(s),f}function A9(e,t,r){if(void 0===y9)return-1;let n,i,s;if(t&&void 0!==e.userData.positions){let t=e.userData;s=t.verticesPerFace.length,n=t.positions,i=Array(t.verticesPerFace.reduce(((e,t)=>e+t),0)+s);for(let e=0,r=0,n=0;e<t.verticesPerFace.length;e++){i[n++]=t.verticesPerFace[e];for(let s=0;s<t.verticesPerFace[e];s++)i[n++]=t.indices[r++]}}else({positions:n,faceIndices:i,nFaces:s}=function(e,t,r){let n,i;i="TorusGeometry"===e.userData.parameters.type&&e.userData.parameters.arc===2*Math.PI?e.getClosedTorusIndicesForBooleanOrSubdiv():e.getIndex();let s,{positions:a,triIndices:o}=c9(e.getAttribute("position"),i);if(t&&r){let{indices:t,verticesPerFace:r}=p9(a,o,e);s=r.length,n=[];for(let e=0,i=0;e<s;e++){n.push(r[e]);for(let s=0;s<r[e];s++)n.push(t[i++])}}else{let e=o.length;n=Array(e+e/3),s=0;for(let t=0,r=0;r<n.length;)n[r++]=3,s++,n[r++]=o[t++],n[r++]=o[t++],n[r++]=o[t++]}return{positions:a,faceIndices:n,nFaces:s}}(e,t,r));let a=n.length,o=i.length,l=n.length,c=i.length,u=l*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,h=l*Float32Array.BYTES_PER_ELEMENT,d=(Uint32Array.BYTES_PER_ELEMENT,y9._malloc(u)),f=new Float32Array(y9.HEAPF32.buffer,d,l),p=new Uint32Array(y9.HEAPU32.buffer,d+h,c);f.set(n,0),p.set(i,0);let m=y9.get_csg_mesh(d,a,d+h,o,s);return y9._free(d),m}function M9(e){return y9.has_open_edges(e)}function T9(e,t){y9.transform_csg_mesh(e,t.elements)}function P9(e){y9.free_csg_mesh(e)}w9.then((e=>y9=e));var k9={ConeGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i;let s=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},e.parameters);return s.thetaLength=$N.clamp(s.thetaLength,0,360),{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(n=s.height)&&void 0!==n?n:s.width),depth:Math.abs(null!==(i=s.depth)&&void 0!==i?i:s.width)})}}static build(e){let t,{width:r,depth:n,height:i,radialSegments:s,heightSegments:a,openEnded:o,thetaStart:l,thetaLength:c,cornerRadiusTop:h,cornerRadiusBottom:d,cornerSegments:f}=e.parameters;return 0===c?(t=new iF,t.setAttribute("position",new Qz([],3))):t=h>0||d>0||c<360?new v5(0,r/2,i,s,a,o,l,c*Math.PI/180,h,d,f,0,!0):new fH(r/2,i,s,a,o),t.scale(1,1,n/r),Object.assign(t,{userData:u(u({},e),{},{type:"ConeGeometry"})})}},CubeGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i;let s=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(n=s.height)&&void 0!==n?n:s.width),depth:Math.abs(null!==(i=s.depth)&&void 0!==i?i:s.width)})}}static build(e){let t,{width:r,height:n,depth:i,widthSegments:s,heightSegments:a,depthSegments:o,cornerRadius:l,cornerSegments:c}=e.parameters;return t=0===l?new wF(r,n,i,s,a,o):new b5(r,n,i,s,a,o,l,c),Object.assign(t,{userData:u(u({},e),{},{type:"CubeGeometry"})})}},CylinderGeometry:p5,DodecahedronGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i;let s=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(n=s.height)&&void 0!==n?n:s.width),depth:Math.abs(null!==(i=s.depth)&&void 0!==i?i:s.width)})}}static build(e){let{width:t,height:r,depth:n,detail:i,corner:s,cornerSides:a}=e.parameters,o=0===i&&0!==s?new x5(.5*t,s,a):new mH(.5*t,i);return o.scale(1,r/t,n/t),Object.assign(o,{userData:u(u({},e),{},{type:"DodecahedronGeometry"})})}},EllipseGeometry:j6,HelixGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i;let s=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},e.parameters),a=Math.abs(s.width),o=Math.abs(null!==(n=s.height)&&void 0!==n?n:a),l=Math.abs(null!==(i=s.depth)&&void 0!==i?i:a),c=Math.abs(Math.min(a,l))/2;return{parameters:Object.assign(s,{width:a,height:o,depth:l,radius:c,segments:Math.round(s.segments),pathSegments:Math.round(s.pathSegments),cornerSegments:Math.round(s.cornerSegments)})}}static build(e){let{width:t,height:r,depth:n,radius:i,revolutions:s,segments:a,pathRadius:o,pathType:l,pathSegments:c,cornerRadius:h,cornerSegments:d}=e.parameters,f=new Y6(!1,t,r,n,i,s,a,o,l,c,h,d);return Object.assign(f,{userData:u(u({},e),{},{type:"HelixGeometry"})})}},IcosahedronGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i;let s=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(n=s.height)&&void 0!==n?n:s.width),depth:Math.abs(null!==(i=s.depth)&&void 0!==i?i:s.width)})}}static build(e){let{width:t,height:r,depth:n,detail:i,corner:s,cornerSides:a}=e.parameters,o=0===i&&0!==s?new K6(.5*t,s,a):new GH(.5*t,i);return o.scale(1,r/t,n/t),Object.assign(o,{userData:u(u({},e),{},{type:"IcosahedronGeometry"})})}},LatheGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i,s,a;(null!==(r=null===(n=e.parameters)||void 0===n?void 0:n.points)&&void 0!==r?r:[]).forEach((e=>{Array.isArray(e)&&(e.x=e[0],e.y=e[1])}));let o=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},e.parameters);return{parameters:Object.assign(o,{width:Math.abs(o.width),height:Math.abs(null!==(s=o.height)&&void 0!==s?s:o.width),depth:Math.abs(null!==(a=o.depth)&&void 0!==a?a:o.width)})}}static build(e){let{points:t,segments:r,verticalSegments:n}=e.parameters,i=new gH;i.moveTo(t[0].x,t[0].y),i.bezierCurveTo(t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y);let s=new hH(i.extractPoints(n).shape,r);return s.rotateZ(Math.PI),Object.assign(s,{userData:u(u({},e),{},{type:"LatheGeometry"})})}},NonParametricGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n;let i,s=null!==(r=null!==(n=e.geometry)&&void 0!==n?n:null===t||void 0===t?void 0:t.geometry)&&void 0!==r?r:(new iF).copy(new wF(100,100,100));void 0===t?(s.computeBoundingBox(),s.boundingBox.getSize(m8),i={width:m8.x,height:m8.y,depth:m8.z,subdivisions:0}):i=t.parameters;let a=u(u({},i),e.parameters);return{parameters:{width:Math.abs(a.width),height:Math.abs(a.height),depth:Math.abs(a.depth),subdivisions:Math.abs(a.subdivisions)},geometry:s}}static build(e){var t;let{width:r,height:n,depth:i,subdivisions:s}=e.parameters,a=null!==(t=e.geometry)&&void 0!==t?t:(new iF).copy(new wF(100,100,100)),o=a.userData.parameters;void 0===o?(a.computeBoundingBox(),a.boundingBox.getSize(m8)):m8.set(o.width,o.height,o.depth),(r!==m8.x||n!==m8.y||i!==m8.z)&&a.scale(0===m8.x?1:r/m8.x,0===m8.y?1:n/m8.y,0===m8.z?1:i/m8.z);let l=a.originalGeometry;try{s>0?(void 0===l||(null===o||void 0===o?void 0:o.subdivisions)!==s)&&(void 0===l&&(l=a),a=new p8(s).modify(l).toBufferGeometry()):(void 0!==l&&(a=l),l=void 0,void 0===a.getAttribute("normal")&&a.computeVertexNormals())}catch(c){void 0!==l&&(a=l),l=void 0,void 0===a.getAttribute("normal")&&a.computeVertexNormals()}return void 0!==l&&Object.assign(a,{originalGeometry:l}),delete e.geometry,Object.assign(a,{userData:u(u({},e),{},{type:"NonParametricGeometry"})})}static loadFromUrl(e,t,r){new UW(r).load(e,(e=>{let r=this.normalizeInputs({geometry:e});e.boundingBox.getSize(m8);let n=100/m8.x;Object.assign(r.parameters,{width:100,height:m8.y*n,depth:m8.z*n}),t(this.build(r))}))}},PolygonGeometry:g8,PyramidGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i;let s=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(n=s.height)&&void 0!==n?n:s.width),depth:Math.abs(null!==(i=s.depth)&&void 0!==i?i:s.width)})}}static build(e){let{width:t,height:r,depth:n,radialSegments:i,heightSegments:s,openEnded:a,cornerRadius:o,cornerSegments:l}=e.parameters,c=new w8(.5*t,r,i,s,a,o,l);return c.scale(1,1,n/t),Object.assign(c,{userData:u(u({},e),{},{type:"PyramidGeometry"})})}},RectangleGeometry:x8,SphereGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i;let s=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180},e.parameters);return s.thetaLength=$N.clamp(s.thetaLength,0,180),{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(n=s.height)&&void 0!==n?n:s.width),depth:Math.abs(null!==(i=s.depth)&&void 0!==i?i:s.width)})}}static build(e){let t,{width:r=100,height:n=r,depth:i=r,widthSegments:s=64,heightSegments:a=64,phiStart:o,phiLength:l,thetaStart:c,thetaLength:h}=e.parameters;return 0===h?(t=new iF,t.setAttribute("position",new Qz([],3))):t=new qH(.5*r,s,a,o,l,c,h*$N.DEG2RAD),t.scale(1,n/r,i/r),Object.assign(t,{userData:u(u({},e),{},{type:"SphereGeometry"})})}},PlaneGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n;let i=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,depth:0,widthSegments:8,heightSegments:8},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(null!==(n=i.height)&&void 0!==n?n:i.width),depth:0})}}static build(e){let{width:t=100,height:r=t,widthSegments:n=8,heightSegments:i=8}=e.parameters,s=new UF(t,r,n,i);return s.scale(1,1,1),Object.assign(s,{userData:u(u({},e),{},{type:"PlaneGeometry"})})}},BackdropGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i;let s=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,angle:90,cornerRadius:24,cornerSegments:8},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(n=s.height)&&void 0!==n?n:s.width),depth:Math.abs(null!==(i=s.depth)&&void 0!==i?i:s.width)})}}static build(e){let{width:t,height:r,depth:n,angle:i,cornerRadius:s,cornerSegments:a}=e.parameters,o=new S8(t,r,n,i,s,a);return Object.assign(o,{userData:u(u({},e),{},{type:"BackdropGeometry"})})}},StarGeometry:_8,TextFrameGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i;let s=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,depth:0},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(n=s.height)&&void 0!==n?n:s.width),depth:Math.abs(null!==(i=s.depth)&&void 0!==i?i:0)})}}static build(e){let{width:t,height:r}=e.parameters,n=new UF(t,r);return Object.assign(n,{userData:u(u({},e),{},{type:"TextFrameGeometry"})})}},TorusGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i;let s=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,radialSegments:32,tubularSegments:64,arc:360,cornerRadius:30,cornerSegments:8},e.parameters),a=Math.abs(s.width),o=Math.abs(null!==(n=s.height)&&void 0!==n?n:s.width);s.shapeBlendNode&&(o=a);let l=Math.round(Math.abs(null!==(i=s.depth)&&void 0!==i?i:.25*s.width));return{parameters:Object.assign(s,{width:a,height:o,depth:l})}}static build(e){let{width:t,height:r,depth:n,radialSegments:i,tubularSegments:s,arc:a,cornerRadius:o,cornerSegments:l}=e.parameters,c=function(e,t,r,n,i,s,a,o,l,c,u){[t,r]=[r,t],a=t/2;let h=$N.clamp(i/360,0,1);if(0===h){let e=new iF;return e.setAttribute("position",new Qz([],3)),e}return 1===h&&(c=0),new Y6(!0,e,t,r,n,h,s,a,o,l,c,u)}(t,r,n,.5*t,a,s,0,0,i,o,l);return c.scale(1,r/t,1),Object.assign(c,{userData:u(u({},e),{},{type:"TorusGeometry"})})}},TorusKnotGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i,s;let a=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},e.parameters);return{parameters:Object.assign(a,{width:Math.abs(a.width),height:Math.abs(null!==(n=a.height)&&void 0!==n?n:a.width),depth:Math.abs(null!==(i=a.depth)&&void 0!==i?i:a.width),tube:null!==(s=a.tube)&&void 0!==s?s:.125*a.width})}}static build(e){let{width:t,tube:r,tubularSegments:n,radialSegments:i,p:s,q:a}=e.parameters,o=.5*t;o!==r&&(o-=r);let l=new YH(o,r,n,i,s,a);return Object.assign(l,{userData:u(u({},e),{},{type:"TorusKnotGeometry"})})}},TriangleGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i;let s=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},e.parameters);return{shape:e.shape&&e.shape instanceof i6?e.shape:new i6,parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(n=s.height)&&void 0!==n?n:s.width*(s.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(null!==(i=s.depth)&&void 0!==i?i:0)})}}static build(e){let{width:t=100,height:r,cornerRadius:n,depth:i,extrudeBevelSize:s,extrudeBevelSegments:a,isRect:o}=e.parameters,l=e.shape,c=.5*t,h=.5*r;o?(l.addPoint(l.createPoint(-c,h)),l.addPoint(l.createPoint(c,-h)),l.addPoint(l.createPoint(-c,-h))):(l.addPoint(l.createPoint(0,h)),l.addPoint(l.createPoint(c,-h)),l.addPoint(l.createPoint(-c,-h))),l.isClosed=!0;for(let u=0,f=l.points.length;u<f;u++)l.points[u].roundness=n;l.roundness=n,l.update();let d=z6.create({shape:l,parameters:{roundness:n,depth:i,extrudeBevelSize:s,extrudeBevelSegments:a}});return Object.assign(d,{userData:u(u({},e),{},{type:"TriangleGeometry"})})}},PathGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r,n,i,s,a;let o=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters),l=Math.abs(o.width),c=Math.abs(null!==(n=o.height)&&void 0!==n?n:o.width),h=Math.abs(null!==(i=o.depth)&&void 0!==i?i:0),d=null!==(s=null===t||void 0===t?void 0:t.shapeData)&&void 0!==s?s:j6.create({parameters:P1}).userData.shape;return{path:null!==(a=e.path)&&void 0!==a?a:E1.defaultData(),parameters:Object.assign(o,{width:l,height:c,depth:h,extrusion:u(u({},O1),o.extrusion)}),shapeData:d}}static build(e){if(e.path.points.length>=2){let t=new V8(e);return Object.assign(t,{userData:u(u({},e),{},{type:"PathGeometry"})})}return Object.assign(new iF,{userData:u(u({},e),{},{type:"PathGeometry"})})}},VectorGeometry:z6},D9=e=>k9[e.type].create(e);function I9(e){return null!==e&&"booleanOp"in e}var O9=class extends(f5(yF)){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new sz}updateVisible(e){super.updateVisible(e),this.visible=!I9(this.parent)&&this.visible,I9(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){-1!==this.booleanMeshSetAddress&&(m9.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.booleanWasTransformed=!0:this.freeBooleanPointer(),I9(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let e of this.children)e instanceof O9&&(e.freeBooleanPointer(),I9(e)&&e.invalidateUpstreamBooleanData())}updateTransformState(e,t){let r=super.updateTransformState(e,t);return r&&I9(this.parent)&&this.invalidateDownstreamBooleanData(!0),r}onVariableUpdate(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super.onVariableUpdate(e),I9(this.parent)&&this.invalidateDownstreamBooleanData(!0)}},R9=new IB;function L9(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.count,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,u=-1/0;for(let h=t;h<r;h++){let t=e.getX(h),r=e.getY(h),n=e.getZ(h);t<s&&(s=t),r<a&&(a=r),n<o&&(o=n),t>l&&(l=t),r>c&&(c=r),n>u&&(u=n)}R9.min.set(s,a,o),R9.max.set(l,c,u),R9.getCenter(n),R9.getSize(i).multiplyScalar(.5)}var N9=new iF,B9=new Wz,z9=class extends O9{constructor(e,t){super(N9,B9),this.super_Entity(e,t)}updateState(e,t){this.updateState_Entity(e,t)}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");void 0!==r?L9(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},F9=class{constructor(e){if(this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},null===F9.uuidContext)throw new Error("plz startContext");F9.uuidContext===F9.globalContext?this.uuid="_gid"+F9.uuidContext.nodeContextUuid++:this.uuid="_uid"+F9.uuidContext.nodeContextUuid++,this.type=e,this.name=""}static startContext(e){null===this.uuidContext||this.uuidContext===F9.globalContext?this.uuidContext=e:console.error("Can't start context twice")}static endContext(e){this.uuidContext!==e&&console.error("Can't end context twice"),this.uuidContext=null}analyze(e,t){var r;t=null!==(r=t)&&void 0!==r?r:{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1}analyzeAndFlow(e,t,r){var n;return r=null!==(n=r)&&void 0!==n?n:{},this.analyze(e,r),this.flow(e,t,r)}flow(e,t,r){var n;r=null!==(n=r)&&void 0!==n?n:{},e.addFlow(r.slot,r.cache,r.context);let i={result:this.build(e,t),code:e.clearNodeCode(),extra:e.context.extra};return e.removeFlow(),i}build(e,t,r){var n;t=null!==(n=t)&&void 0!==n?n:this.getType(e,t);let i=e.getNodeData(null!==r&&void 0!==r?r:this);return e.analyzing&&this.appendDepsNode(e,i,t),-1===e.nodes.indexOf(this)&&e.nodes.push(this),void 0!==this.updateFrame&&-1===e.updaters.indexOf(this)&&e.updaters.push(this),this.generate(e,t,r)}updateFrame(e){}generateReadonly(e,t,r,n,i,s){return""}generate(e,t,r,n,i){return""}parse(e,t,r,n){}appendDepsNode(e,t,r){t.deps=(t.deps||0)+1;let n=e.getTypeLength(r);(n>(t.outputMax||0)||this.getType(e,r))&&(t.outputMax=n,t.output=r)}setName(e){this.name=e}getName(){return this.name}getType(e,t){return"sampler2D"===t||"samplerCube"===t?t:this.type}},j9=F9;j9.globalContext={nodeContextUuid:0},j9.uuidContext=F9.globalContext;var U9=class{constructor(e){var t;e=null!==(t=e)&&void 0!==t?t:{},this.name=e.name,this.type=e.type,this.node=e.node,this.size=e.size,this.needsUpdate=e.needsUpdate}get value(){return this.node.value}set value(e){this.node.value=e}},V9=new class{constructor(){this.nodes={},this.keywords={}}add(e){this.nodes[e.name]=e}addKeyword(e,t,r){r=void 0===r||r,this.keywords[e]={callback:t,cache:r}}remove(e){delete this.nodes[e.name]}removeKeyword(e){delete this.keywords[e]}get(e){return this.nodes[e]}getKeyword(e,t){return this.keywords[e].callback(t)}getKeywordData(e){return this.keywords[e]}contains(e){return void 0!==this.nodes[e]}containsKeyword(e){return void 0!==this.keywords[e]}},H9=class extends j9{constructor(e,t){var r;super(e),this.scope="",t=null!==(r=t)&&void 0!==r?r:{},this.shared=void 0===t.shared||t.shared,this.unique=void 0!==t.unique&&t.unique}build(e,t,r,n){var i;if(t=null!==(i=t)&&void 0!==i?i:this.getType(e),this.getShared(e,t)){var s;let i=this.getUnique(e,t);i&&void 0===this.uuid&&(this.uuid=$N.generateUUID()),r=e.getUUID(null!==(s=r)&&void 0!==s?s:this.getUUID(),!i);let a=e.getNodeData(r),o=a.output||this.getType(e);if(e.analyzing)return(a.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,a,t),this.generate(e,t,r)):super.build(e,t,r);if(i)return a.name=a.name||super.build(e,t,r),a.name;if(!this.getLabel()&&(!this.getShared(e,o)||e.context.ignoreCache||1===a.deps))return super.build(e,t,r);r=this.getUUID(!1);let l=this.getTemp(e,r);if(l)return e.format(l,o,t);{l=super.generate(e,t,r,a.output,n);let i=this.generate(e,o,r);return e.addNodeCode(l+" = "+i+";"),e.format(l,o,t)}}return super.build(e,t,r)}getShared(e,t){return"sampler2D"!==t&&"samplerCube"!==t&&this.shared}getUnique(e,t){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let t=this.uuid;return"string"==typeof this.scope&&(t=this.scope+"-"+t),t}getTemp(e,t){t=t||this.uuid;let r=e.getVars()[t];return r?r.name:void 0}generate(e,t,r,n,i){var s;return this.getShared(e,t)||console.error("TempNode is not shared"),r=null!==(s=r)&&void 0!==s?s:this.uuid,e.getTempVar(r,null!==n&&void 0!==n?n:this.getType(e),i,this.getLabel()).name}},W9=class extends H9{constructor(e,t){var r;(t=null!==(r=t)&&void 0!==r?r:{}).shared=void 0!==t.shared&&t.shared,super(e,t),this.readonly=!1}setReadonly(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(e,t,r,n,i,s){var a,o;r=e.getUUID(null!==(a=r)&&void 0!==a?a:this.getUUID()),n=null!==(o=n)&&void 0!==o?o:this.getType(e);let l=e.getNodeData(r);return this.getReadonly()&&void 0!==this.generateReadonly?this.generateReadonly(e,t,r,n,i,s):e.isShader("vertex")?(l.vertex||(l.vertex=e.createVertexUniform(n,this,i,s,this.getLabel())),e.format(l.vertex.name,n,t)):(l.fragment||(l.fragment=e.createFragmentUniform(n,this,i,s,this.getLabel())),e.format(l.fragment.name,n,t))}},G9=class extends W9{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;super("v2"),this.nodeType="Vector2",this.value=e instanceof eB?e:new eB(e,t)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}generateReadonly(e,t,r,n,i,s){return e.format("vec2("+this.value.x+", "+this.value.y+")",n,t)}},q9=class extends W9{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;super("v3"),this.nodeType="Vector3",this.value=e instanceof PB?e:new PB(e,t,r)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}get z(){return this.value.z}set z(e){this.value.z=e}generateReadonly(e,t,r,n,i,s){return e.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",n,t)}},X9=class extends vB{constructor(e,t,r,n){super(e,t,r),this.isColorA=!0,this.a=n}setRGBA(e,t,r,n){super.setRGB(e,t,r),this.a=n}copy(e){return super.copy(e),this.a="a"in e?e.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}equals(e){return super.equals(e)&&this.a===e.a}setStyle(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"srgb";if("transparent"===e)return this.setRGBA(0,0,0,0),this;if(t=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(e)){let n,i=t[1],s=t[2];switch(i){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a="rgba"===i?parseFloat(n[4]):1,super.setStyle(e,r);break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a="hsla"===i?parseFloat(n[4]):1,super.setStyle(e,r)}}return super.setStyle(e,r)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(e){this.r=e}set y(e){this.g=e}set z(e){this.b=e}set w(e){this.a=e}},Y9=class extends W9{constructor(e){super("v4"),this.nodeType="Vector4",this.value=e instanceof X9?e:new X9(e.r,e.g,e.b,e.a)}generateReadonly(e,t,r,n,i,s){return e.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",n,t)}},K9=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,Q9=/[a-z_0-9]+/gi,Z9=class extends H9{constructor(e,t,r,n,i){super(i),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=void 0===i,this.isInterface=!1,this.parse(e,t,r,n)}getShared(e,t){return!this.isMethod}getType(e){return e.getTypeByFormat(this.type)}getInputByName(e){if(this.inputs){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}}getIncludeByName(e){if(this.includes){let t=this.includes.length;for(;t--;)if(this.includes[t].name===e)return this.includes[t]}}generate(e,t,r,n,i){let s,a=0,o=this.src;if(this.includes)for(let c=0;c<this.includes.length;c++)e.include(this.includes[c],this);for(let c in this.extensions)e.extensions[c]=!0;let l=[];for(;s=Q9.exec(this.src);)l.push(s);for(let c=0;c<l.length;c++){let t=l[c],r=t[0],n=!this.isMethod||!this.getInputByName(r),i=r;if(this.keywords[r]||this.useKeywords&&n&&V9.containsKeyword(r)){let t=this.keywords[r];if(!t){let n=V9.getKeywordData(r);n.cache&&(t=e.keywords[r]),t=t||V9.getKeyword(r,e),n.cache&&(e.keywords[r]=t)}i=t.build(e)}r!==i&&"."!==o[t.index+a-1]&&(o=o.substring(0,t.index+a)+i+o.substring(t.index+r.length+a),a+=i.length-r.length),void 0===this.getIncludeByName(i)&&V9.contains(i)&&e.include(V9.get(i))}return"source"===t?o:this.isMethod?(this.isInterface||e.include(this,void 0,o),this.name):e.format("( "+o+" )",this.getType(e),t)}parse(e,t,r,n){if(this.src=e||"",this.includes=null!==t&&void 0!==t?t:[],this.extensions=null!==r&&void 0!==r?r:{},this.keywords=null!==n&&void 0!==n?n:{},this.isMethod){let e=K9.exec(this.src);if(this.inputs=[],e&&4==e.length){this.type=e[1],this.name=e[2];let t=e[3].match(Q9);if(t){let e=0;for(;e<t.length;){let r,n=t[e++];"in"===n||"out"===n||"inout"===n?r=t[e++]:(r=n,n="");let i=t[e++];this.inputs.push({name:i,type:r,qualifier:n})}}this.isInterface=-1===this.src.indexOf("{")}else this.type="",this.name=""}}},J9=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,$9=class extends H9{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(e||$9.PI,void 0,void 0,void 0,t)}getType(e){return e.getTypeByFormat(this.type)}parse(e,t,r,n,i){this.src=e||"";let s,a,o="",l=J9.exec(e);this.useDefine=null!==i&&void 0!==i?i:"#"===this.src.charAt(0),l&&l.length>1?(a=l[1],s=l[2],o=l[3]):(s=this.src,a="f"),this.name=s,this.type=a,this.value=o}build(e,t){if("source"===t){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return e.include(this),e.format(this.name,this.getType(e),t)}generate(e,t,r,n,i){return e.format(this.name,this.getType(e),t)}},e7=$9;e7.PI="PI",e7.PI2="PI2",e7.RECIPROCAL_PI="RECIPROCAL_PI",e7.RECIPROCAL_PI2="RECIPROCAL_PI2",e7.LOG2="LOG2",e7.EPSILON="EPSILON";var t7=new RegExp("^structs*([a-z_0-9]+)s*{s*((.|\n)*?)}","gim"),r7=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),n7=class extends H9{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(e)}getType(e){return e.getTypeByFormat(this.name)}getInputByName(e){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}generate(e,t,r,n,i){return"source"===t?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)}parse(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.src=e,this.inputs=[];let t=t7.exec(e);if(t){let e,r=t[2];for(;e=r7.exec(r);)this.inputs.push({type:e[1],name:e[2]});this.name=t[1]}else this.name="";this.type=this.name}},i7=class extends H9{constructor(e){super("v2",{shared:!1}),this.nodeType="UV",this.index=null!==e&&void 0!==e?e:0}generate(e,t){e.requires.uv[this.index]=!0;let r=this.index>0?this.index+1:"",n=e.isShader("vertex")?"uv"+r:"vUv"+r;return e.format(n,this.getType(e),t)}};V9.addKeyword("uv",(function(){return new i7})),V9.addKeyword("uv2",(function(){return new i7(1)}));var s7=class extends H9{constructor(e,t){super("v4"),this.nodeType="ColorSpace",this.input=e,this.method=null!==t&&void 0!==t?t:s7.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(e){switch(e){case kN:return["Linear"];case DN:return["sRGB"];default:return[]}}generate(e,t){var r;let n=this.input.build(e,"v4"),i=this.getType(e),s=s7.Nodes[this.method],a=e.include(s);if(a===s7.LINEAR_TO_LINEAR)return e.format(n,i,t);if(2===(null===(r=s.inputs)||void 0===r?void 0:r.length)){let r=this.factor.build(e,"f");return e.format(a+"( "+n+", "+r+" )",i,t)}return e.format(a+"( "+n+" )",i,t)}fromEncoding(e){let t=s7.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]}fromDecoding(e){let t=s7.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]}},a7=s7;a7.Nodes={LinearToLinear:new Z9(["vec4 LinearToLinear( in vec4 value ) {","\treturn value;","}"].join("\n")),sRGBToLinear:new Z9(["vec4 sRGBToLinear( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join("\n")),LinearTosRGB:new Z9(["vec4 LinearTosRGB( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join("\n"))},a7.LINEAR_TO_LINEAR="LinearToLinear",a7.SRGB_TO_LINEAR="sRGBToLinear",a7.LINEAR_TO_SRGB="LinearTosRGB";var o7=class extends Z9{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",arguments.length>4?arguments[4]:void 0,arguments.length>3?arguments[3]:void 0,arguments.length>2?arguments[2]:void 0,arguments.length>1?arguments[1]:void 0),this.nodeType="Expression"}},l7=class extends W9{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new _B,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;super("v4",{shared:!0}),this.nodeType="Texture",this.value=e,this.uv=null!==t&&void 0!==t?t:new i7,this.bias=r,this.project=void 0!==n&&n}getTexture(e,t){return super.generate(e,t,this.value.uuid,"t")}generate(e,t){var r;if("sampler2D"===t)return this.getTexture(e,t);let n,i,s=this.getTexture(e,t),a=this.uv.build(e,this.project?"v4":"v2"),o=this.bias?this.bias.build(e,"f"):void 0;void 0===o&&e.context.bias&&(o=e.context.bias.setTexture(this).build(e,"f")),n=this.project?"texture2DProj":o?"tex2DBias":"tex2D",i=o?n+"( "+s+", "+a+", "+o+" )":n+"( "+s+", "+a+" )";let l={include:e.isShader("vertex"),ignoreCache:!0},c=this.getType(e);return e.addContext(l),this.colorSpace=null!==(r=this.colorSpace)&&void 0!==r?r:new a7(new o7("",c)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(i),i=this.colorSpace.build(e,c),e.removeContext(),e.format(i,c,t)}},c7=class extends W9{constructor(e){super("f"),this.nodeType="Float",this.value=null!==e&&void 0!==e?e:0}generateReadonly(e,t,r,n,i,s){return e.format(this.value+(this.value%1?"":".0"),n,t)}},u7=class extends H9{constructor(e,t){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=e,this.inputs=null!==t&&void 0!==t?t:[]}getFunction(){return this.value}getType(e){return this.value.getType(e)}generate(e,t,r,n,i){n=this.getType(e);let s=this.value,a=s.build(e,t)+"( ",o=[];if(s.inputs){for(let t=0;t<s.inputs.length;t++){let r=s.inputs[t],n=this.inputs[t]||this.inputs[r.name];o.push(n.build(e,e.getTypeByFormat(r.type)))}a+=o.join(", ")+" )"}return e.format(a,n,t)}},h7=class extends H9{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h7.ADD;super(),this.nodeType="Operator",this.type=e.type,this.a=e,this.b=t,this.op=r}getType(e){let t=this.a.getType(e),r=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(r)>e.getTypeLength(t)?r:t}generate(e,t){let r=this.getType(e);this.type=r;let n=this.a.build(e,r),i=this.b.build(e,r);return e.format("( "+n+" "+this.op+" "+i+" )",r,t)}},d7=h7;d7.ADD="+",d7.SUB="-",d7.MUL="*",d7.DIV="/";var f7=class extends H9{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f7.ABS,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;super(),this.nodeType="Math",this.a=e,"string"!=typeof t?this.b=t:n=t,"string"!=typeof r?this.c=r:n=r,this.method=n,this.hashProperties=["method"]}getNumInputs(e){switch(this.method){case f7.MIX:case f7.CLAMP:case f7.REFRACT:case f7.SMOOTHSTEP:case f7.FACEFORWARD:return 3;case f7.MIN:case f7.MAX:case f7.MOD:case f7.STEP:case f7.REFLECT:case f7.DISTANCE:case f7.DOT:case f7.CROSS:case f7.POW:return 2;default:return 1}}getInputType(e){let t=e.getTypeLength(this.a.getType(e)),r=this.b?e.getTypeLength(this.b.getType(e)):0,n=this.c?e.getTypeLength(this.c.getType(e)):0;return t>r&&t>n?this.a.getType(e):r>n?this.b.getType(e):this.c.getType(e)}getType(e){switch(this.method){case f7.LENGTH:case f7.DISTANCE:case f7.DOT:return"f";case f7.CROSS:return"v3"}return this.getInputType(e)}generate(e,t){let r,n,i,s=this.a?e.getTypeLength(this.a.getType(e)):0,a=this.b?e.getTypeLength(this.b.getType(e)):0,o=this.c?e.getTypeLength(this.c.getType(e)):0,l=this.getInputType(e),c=this.getType(e);switch(this.type=c,this.method){case f7.NEGATE:return e.format("( -"+this.a.build(e,l)+" )",l,t);case f7.INVERT:return e.format("( 1.0 - "+this.a.build(e,l)+" )",l,t);case f7.CROSS:r=this.a.build(e,"v3"),n=this.b.build(e,"v3");break;case f7.STEP:r=this.a.build(e,1===s?"f":l),n=this.b.build(e,l);break;case f7.MIN:case f7.MAX:case f7.MOD:r=this.a.build(e,l),n=this.b.build(e,1===a?"f":l);break;case f7.REFRACT:r=this.a.build(e,l),n=this.b.build(e,l),i=this.c.build(e,"f");break;case f7.MIX:r=this.a.build(e,l),n=this.b.build(e,l),i=this.c.build(e,1===o?"f":l);break;default:r=this.a.build(e,l),this.b&&(n=this.b.build(e,l)),this.c&&(i=this.c.build(e,l))}let u=[];u.push(r),n&&u.push(n),i&&u.push(i);let h=this.getNumInputs(e);if(u.length!==h)throw Error('Arguments not match used in "'.concat(this.method,'". Require ').concat(h,", currently ").concat(u.length,"."));return e.format(this.method+"( "+u.join(", ")+" )",c,t)}},p7=f7;p7.RAD="radians",p7.DEG="degrees",p7.EXP="exp",p7.EXP2="exp2",p7.LOG="log",p7.LOG2="log2",p7.SQRT="sqrt",p7.INV_SQRT="inversesqrt",p7.FLOOR="floor",p7.CEIL="ceil",p7.NORMALIZE="normalize",p7.FRACT="fract",p7.SATURATE="saturate",p7.SIN="sin",p7.COS="cos",p7.TAN="tan",p7.ASIN="asin",p7.ACOS="acos",p7.ARCTAN="atan",p7.ABS="abs",p7.SIGN="sign",p7.LENGTH="length",p7.NEGATE="negate",p7.INVERT="invert",p7.MIN="min",p7.MAX="max",p7.MOD="mod",p7.STEP="step",p7.REFLECT="reflect",p7.DISTANCE="distance",p7.DOT="dot",p7.CROSS="cross",p7.POW="pow",p7.MIX="mix",p7.CLAMP="clamp",p7.REFRACT="refract",p7.SMOOTHSTEP="smoothstep",p7.FACEFORWARD="faceforward";var m7=class extends H9{constructor(e,t,r){super("v4"),this.nodeType="TextureCubeUV",this.value=e,this.uv=t,this.bias=r}bilinearCubeUV(e,t,r,n){var i,s,a,o;let l=new u7(m7.Nodes.bilinearCubeUV,[t,r,n]);this.colorSpaceTL=null!==(i=this.colorSpaceTL)&&void 0!==i?i:new a7(new o7("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(l.build(e)+".tl"),this.colorSpaceTR=null!==(s=this.colorSpaceTR)&&void 0!==s?s:new a7(new o7("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(l.build(e)+".tr"),this.colorSpaceBL=null!==(a=this.colorSpaceBL)&&void 0!==a?a:new a7(new o7("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(l.build(e)+".bl"),this.colorSpaceBR=null!==(o=this.colorSpaceBR)&&void 0!==o?o:new a7(new o7("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(l.build(e)+".br");let c={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(c),this.colorSpaceTLExp=new o7(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new o7(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new o7(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new o7(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();let u=new o7("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return u.keywords.cubeUV_TL=this.colorSpaceTLExp,u.keywords.cubeUV_TR=this.colorSpaceTRExp,u.keywords.cubeUV_BL=this.colorSpaceBLExp,u.keywords.cubeUV_BR=this.colorSpaceBRExp,u.keywords.cubeUV=l,u}generate(e,t){if(e.isShader("fragment")){let r=this.uv,n=this.bias||e.context.roughness,i=new u7(m7.Nodes.roughnessToMip,[n]),s=new p7(i,m7.Nodes.m0,m7.Nodes.cubeUV_maxMipLevel,p7.CLAMP),a=new p7(s,p7.FLOOR),o=new p7(s,p7.FRACT),l=this.bilinearCubeUV(e,this.value,r,a),c=this.bilinearCubeUV(e,this.value,r,new d7(a,new c7(1).setReadonly(!0),d7.ADD)),u=new p7(l,c,o,p7.MIX);return e.format(u.build(e),"v4",t)}return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)}},g7=m7;g7.Nodes=function(){let e=new n7("struct TextureCubeUVData {\n\t\t\tvec4 tl;\n\t\t\tvec4 tr;\n\t\t\tvec4 br;\n\t\t\tvec4 bl;\n\t\t\tvec2 f;\n\t\t}"),t=new e7("float cubeUV_maxMipLevel 8.0",!0),r=new e7("float cubeUV_minMipLevel 4.0",!0),n=new e7("float cubeUV_maxTileSize 256.0",!0),i=new e7("float cubeUV_minTileSize 16.0",!0),s=new Z9("float getFace(vec3 direction) {\n\t\t\t\tvec3 absDirection = abs(direction);\n\t\t\t\tfloat face = -1.0;\n\t\t\t\tif (absDirection.x > absDirection.z) {\n\t\t\t\t\tif (absDirection.x > absDirection.y)\n\t\t\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t} else {\n\t\t\t\t\tif (absDirection.z > absDirection.y)\n\t\t\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t}\n\t\t\t\treturn face;\n\t\t}");s.useKeywords=!1;let a=new Z9("vec2 getUV(vec3 direction, float face) {\n\t\t\t\tvec2 uv;\n\t\t\t\tif (face == 0.0) {\n\t\t\t\t\tuv = vec2(direction.z, direction.y) / abs(direction.x); // pos x\n\t\t\t\t} else if (face == 1.0) {\n\t\t\t\t\tuv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y\n\t\t\t\t} else if (face == 2.0) {\n\t\t\t\t\tuv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z\n\t\t\t\t} else if (face == 3.0) {\n\t\t\t\t\tuv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x\n\t\t\t\t} else if (face == 4.0) {\n\t\t\t\t\tuv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y\n\t\t\t\t} else {\n\t\t\t\t\tuv = vec2(direction.x, direction.y) / abs(direction.z); // neg z\n\t\t\t\t}\n\t\t\t\treturn 0.5 * (uv + 1.0);\n\t\t}");a.useKeywords=!1;let o=new Z9("TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n\t\t\tfloat face = getFace(direction);\n\t\t\tfloat filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n\t\t\tmipInt = max(mipInt, cubeUV_minMipLevel);\n\t\t\tfloat faceSize = exp2(mipInt);\n\t\t\tfloat texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n\t\t\tvec2 uv = getUV(direction, face) * (faceSize - 1.0);\n\t\t\tvec2 f = fract(uv);\n\t\t\tuv += 0.5 - f;\n\t\t\tif (face > 2.0) {\n\t\t\t\tuv.y += faceSize;\n\t\t\t\tface -= 3.0;\n\t\t\t}\n\t\t\tuv.x += face * faceSize;\n\t\t\tif(mipInt < cubeUV_maxMipLevel){\n\t\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t\t}\n\t\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\t\tuv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n\t\t\tuv *= texelSize;\n\t\t\tvec4 tl = texture2D(envMap, uv);\n\t\t\tuv.x += texelSize;\n\t\t\tvec4 tr = texture2D(envMap, uv);\n\t\t\tuv.y += texelSize;\n\t\t\tvec4 br = texture2D(envMap, uv);\n\t\t\tuv.x -= texelSize;\n\t\t\tvec4 bl = texture2D(envMap, uv);\n\t\t\treturn TextureCubeUVData( tl, tr, br, bl, f );\n\t\t}",[e,s,a,t,r,n,i]);o.useKeywords=!1;let l=new e7("float r0 1.0",!0),c=new e7("float v0 0.339",!0),u=new e7("float m0 -2.0",!0),h=new e7("float r1 0.8",!0),d=new e7("float v1 0.276",!0),f=new e7("float m1 -1.0",!0),p=new e7("float r4 0.4",!0),m=new e7("float v4 0.046",!0),g=new e7("float m4 2.0",!0),v=new e7("float r5 0.305",!0),y=new e7("float v5 0.016",!0),b=new e7("float m5 3.0",!0),w=new e7("float r6 0.21",!0),x=new e7("float v6 0.0038",!0),S=new e7("float m6 4.0",!0);return{bilinearCubeUV:o,roughnessToMip:new Z9("float roughnessToMip(float roughness) {\n\t\t\tfloat mip = 0.0;\n\t\t\tif (roughness >= r1) {\n\t\t\t\tmip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n\t\t\t} else if (roughness >= r4) {\n\t\t\t\tmip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n\t\t\t} else if (roughness >= r5) {\n\t\t\t\tmip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n\t\t\t} else if (roughness >= r6) {\n\t\t\t\tmip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n\t\t\t} else {\n\t\t\t\tmip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25\n\t\t\t}\n\t\t\treturn mip;\n\t\t}",[l,c,u,h,d,f,p,m,g,v,y,b,w,x,S]),m0:u,cubeUV_maxMipLevel:t}}();var v7=class extends H9{constructor(e){super("v3"),this.nodeType="Normal",this.scope=null!==e&&void 0!==e?e:v7.VIEW}getShared(){return this.scope===v7.WORLD}build(e,t,r,n){let i=e.context[this.scope+"Normal"];return i?i.build(e,t,r,n):super.build(e,t,r)}generate(e,t,r,n,i){let s;switch(this.scope){case v7.VIEW:s=e.isShader("vertex")?"transformedNormal":"geometryNormal";break;case v7.LOCAL:e.isShader("vertex")?s="objectNormal":(e.requires.normal=!0,s="vObjectNormal");break;case v7.WORLD:e.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,s="vWNormal")}return e.format(s,this.getType(e),t)}},y7=v7;y7.LOCAL="local",y7.WORLD="world",y7.VIEW="view",y7.NORMAL="normal",V9.addKeyword("viewNormal",(function(){return new y7(y7.VIEW)})),V9.addKeyword("localNormal",(function(){return new y7(y7.NORMAL)})),V9.addKeyword("worldNormal",(function(){return new y7(y7.WORLD)}));var b7=class extends H9{constructor(e){super("v3"),this.nodeType="Position",this.scope=null!==e&&void 0!==e?e:b7.LOCAL}getType(){return this.scope===b7.PROJECTION?"v4":this.type}getShader(){switch(this.scope){case b7.LOCAL:case b7.WORLD:return!1}return!0}generate(e,t,r,n,i){let s;switch(this.scope){case b7.LOCAL:e.isShader("vertex")?s="transformed":(e.requires.position=!0,s="vPosition");break;case b7.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,s="vWPosition";break;case b7.VIEW:s=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case b7.PROJECTION:s=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )"}return e.format(s,this.getType(),t)}},w7=b7;w7.LOCAL="local",w7.WORLD="world",w7.VIEW="view",w7.PROJECTION="projection",V9.addKeyword("position",(function(){return new w7})),V9.addKeyword("worldPosition",(function(){return new w7(w7.WORLD)})),V9.addKeyword("viewPosition",(function(){return new w7(w7.VIEW)}));var x7=class extends H9{constructor(e){super("v3"),this.nodeType="Reflect",this.scope=null!==e&&void 0!==e?e:x7.CUBE}getUnique(e){return!e.context.viewNormal}getType(){return this.scope===x7.SPHERE?"v2":this.type}generate(e,t){let r=this.getUnique(e);if(e.isShader("fragment")){let n;switch(this.scope){case x7.VECTOR:{let t=new y7(y7.VIEW),i=e.context.roughness,s=t.build(e,"v3"),a=new w7(w7.VIEW).build(e,"v3"),o=i?i.build(e,"f"):void 0,l="reflect( -normalize( ".concat(a," ), ").concat(s," )");o&&(l="normalize( mix( ".concat(l,", ").concat(s,", ").concat(o," * ").concat(o," ) )"));let c="inverseTransformDirection( ".concat(l,", viewMatrix )");r?(e.addNodeCode("vec3 reflectVec = ".concat(c,";")),n="reflectVec"):n=c;break}case x7.CUBE:{let t=new x7(x7.VECTOR).build(e,"v3"),i="vec3( -"+t+".x, "+t+".yz )";r?(e.addNodeCode("vec3 reflectCubeVec = ".concat(i,";")),n="reflectCubeVec"):n=i;break}case x7.SPHERE:{let t="normalize( ( viewMatrix * vec4( "+new x7(x7.VECTOR).build(e,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";r?(e.addNodeCode("vec2 reflectSphereVec = ".concat(t,";")),n="reflectSphereVec"):n=t;break}}return e.format(n,this.getType(),t)}return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)}},S7=x7;S7.CUBE="cube",S7.SPHERE="sphere",S7.VECTOR="vector";var _7=class extends H9{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new l7,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;super("v4"),this.nodeType="TextureCube",this.value=e,this.radianceNode=new g7(this.value,null!==t&&void 0!==t?t:new S7(S7.VECTOR),r),this.irradianceNode=new g7(this.value,new y7(y7.WORLD),new c7(1).setReadonly(!0))}generate(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),("irradiance"===e.slot?this.irradianceNode:this.radianceNode).build(e,t)):(console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t))}},C7=class extends W9{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new kF,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=e,this.uv=null!==t&&void 0!==t?t:new S7,this.bias=r}getTexture(e,t){return super.generate(e,t,this.value.uuid,"tc")}generate(e,t){var r,n;if("samplerCube"===t)return this.getTexture(e,t);let i,s=this.getTexture(e,t),a=null===(r=this.uv)||void 0===r?void 0:r.build(e,"v3"),o=this.bias?this.bias.build(e,"f"):void 0;void 0===o&&e.context.bias&&(o=e.context.bias.setTexture(this).build(e,"f")),i=o?"texCubeBias( "+s+", "+a+", "+o+" )":"texCube( "+s+", "+a+" )";let l={include:e.isShader("vertex"),ignoreCache:!0},c=this.getType(e);return e.addContext(l),this.colorSpace=null!==(n=this.colorSpace)&&void 0!==n?n:new a7(new o7("",c)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(i),i=this.colorSpace.build(e,c),e.removeContext(),e.format(i,c,t)}},E7=["x","y","z","w"],A7=["float","vec2","vec3","vec4"],M7={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},T7={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},P7=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function e(e,t){return e.deps.length-t.deps.length}return function(t,r){let n=this.getIncludes(t,r);if(!n)return"";let i="";n=n.sort(e);for(let e=0;e<n.length;e++)n[e].src&&(i+=n[e].src+"\n");return i}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCube(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif","\n\t\t\t// NOTE: Include Spline's blending modes. This could be part of BlendNode\n\t\t\t#define SPE_BLENDING_NORMAL 0\n\t\t\t#define SPE_BLENDING_MULTIPLY 1\n\t\t\t#define SPE_BLENDING_SCREEN 2\n\t\t\t#define SPE_BLENDING_OVERLAY 3\n\n\t\t\tvec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\treturn mix( a, b, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\treturn mix( a, a * b, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\tvec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );\n\t\t\t\treturn mix( a, tmp, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\tvec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );\n\t\t\t\treturn clamp( mix( a, tmp, alpha ), 0.0, 1.0 );\n\t\t\t}\n\n\t\t\tvec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {\n\t\t\t\tif ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );\n\t\t\t\treturn vec3( 1.0 );\n\t\t\t}\n\t\t\t","#include <packing>","#include <common>"].join("\n"),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join("\n"),fragment:["float accumAlpha = 0.0;","void accumulateAlpha(float alpha) {\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * alpha;\n\t\t\t\t}",""].join("\n")},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(e,t){this.addVertexParsCode("\nuniform int frameIndex;\nuniform vec2 resolution;\nuniform mat4 previousModelViewMatrix;\nuniform mat4 previousProjectionMatrix;\n\nvarying vec4 vCurrentPosition;\nvarying vec4 vPreviousPosition;\n"),this.addFragmentParsCode("\nlayout(location = 1) out vec4 gVelocity;\n\nuniform int frameIndex;\nuniform vec2 resolution;\n\nvarying vec4 vCurrentPosition;\nvarying vec4 vPreviousPosition;\n\nconst vec2 haltonSequence[16] = vec2[16](\nvec2( 0.000000,-0.333334),\nvec2(-0.500000, 0.333334),\nvec2( 0.500000,-0.777778),\nvec2(-0.750000,-0.111112),\nvec2( 0.250000, 0.555556),\nvec2(-0.250000,-0.555556),\nvec2( 0.750000, 0.111112),\nvec2(-0.875000, 0.777778),\nvec2(0.125000, -0.925926),\nvec2(-0.375000, -0.259260),\nvec2(0.625000, 0.407408),\nvec2(-0.625000, -0.703704),\nvec2(0.375000, -0.037038),\nvec2(-0.125000, 0.629630),\nvec2(0.875000, -0.481482),\nvec2(-0.937500, 0.185186));\n\nvec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {\n  const float goldenAngle = 2.399963f; // radians\n  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));\n  float theta = float(sampleIndex) * goldenAngle + angle;\n  float sine = sin(theta);\n  float cosine = cos(theta);\n  return vec2(cosine, sine) * r;\n}\n\n// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso\nfloat getNoiseInterleavedGradient(vec2 screenPos) {\n    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);\n    return fract(magic.z * fract(dot(screenPos, magic.xy)));\n}\n\n"),this.buildShader("vertex",e),this.buildShader("fragment",t);for(let r=0;r<this.requires.uv.length;r++)if(this.requires.uv[r]){let e=r>0?r+1:"";this.addVaryCode("varying vec2 vUv"+e+";"),r>0&&this.addVertexParsCode("attribute vec2 uv"+e+";"),this.addVertexFinalCode("vUv"+e+" = uv"+e+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("\n\t\t\t\t#ifndef SHAPEBLEND \n\t\t\t\t\tvObjectNormal = normal;\n\t\t\t\t#else\n\t\t\t\t\tvObjectNormal = objectNormal;\n\t\t\t\t#endif\n\t\t\t")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode("\n// TODO: This could be generated CPU side and passed to the shader every frame\nconst vec2 haltonSequence[16] = vec2[16](\nvec2( 0.000000,-0.333334),\nvec2(-0.500000, 0.333334),\nvec2( 0.500000,-0.777778),\nvec2(-0.750000,-0.111112),\nvec2( 0.250000, 0.555556),\nvec2(-0.250000,-0.555556),\nvec2( 0.750000, 0.111112),\nvec2(-0.875000, 0.777778),\nvec2(0.125000, -0.925926),\nvec2(-0.375000, -0.259260),\nvec2(0.625000, 0.407408),\nvec2(-0.625000, -0.703704),\nvec2(0.375000, -0.037038),\nvec2(-0.125000, 0.629630),\nvec2(0.875000, -0.481482),\nvec2(-0.937500, 0.185186));\n\n// TODO: Pass correct view size\nvec2 offset = haltonSequence[frameIndex];\noffset.x /= resolution.x;\noffset.y /= resolution.y;\n\nvec4 currentPosition = gl_Position;\nvec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);\n\n// We want to calculate the velocity with unjittered positions\n// so that things that are not moving get a velocity = 0\nvCurrentPosition = currentPosition;\nvPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);\n#ifdef OUTLINE_COMPENSATION\nvPreviousPosition.xy += OUTLINE_COMPENSATION;\n#endif\ngl_Position = currentPositionJittered;\n\n"),this.addFragmentFinalCode("\nvec2 oldPos = vPreviousPosition.xy;\n    oldPos /= vPreviousPosition.w;\n    oldPos.xy = (oldPos.xy+1.)/2.0;\n\nvec2 newPos = vCurrentPosition.xy;\n    newPos /= vCurrentPosition.w;\n    newPos.xy = (newPos.xy+1.)/2.0;\n\nvec2 velocity = (newPos - oldPos);\n\n// Discard fully transparent pixels \nif (gl_FragColor.a <= 0.0) discard;\n\ngVelocity = vec4(velocity, 0.0, 1.0);\n")),this}buildShader(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")}setMaterial(e,t){return this.defines={},this}addFlow(e,t,r){return this.addSlot(e).addCache(t).addContext(r)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(e){return this.cache=null!==e&&void 0!==e?e:"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(e){return this.slot=e||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(e,t){void 0===this.fragmentVariables[e]&&(this.addFragmentCode("".concat(t," ").concat(e,";")),this.fragmentVariables[e]="")}addFragmentParsVariable(e,t){void 0===this.fragmentParsVariables[e]&&(this.addFragmentParsCode("".concat(t," ").concat(e,";")),this.fragmentParsVariables[e]="")}addVertexParsVariable(e,t){void 0===this.vertexParsVariables[e]&&(this.addVertexParsCode("".concat(t," ").concat(e,";")),this.vertexParsVariables[e]="")}addVertexCode(e){this.addCode(e,"vertex")}addFragmentCode(e){this.addCode(e,"fragment")}addCode(e,t){this.code[null!==t&&void 0!==t?t:this.shader]+=e+"\n"}addVertexNodeCode(e){this.addNodeCode(e,"vertex")}addFragmentNodeCode(e){this.addNodeCode(e,"fragment")}addNodeCode(e,t){this.nodeCode[null!==t&&void 0!==t?t:this.shader]+=e+"\n"}clearNodeCode(e){var t;e=null!==(t=e)&&void 0!==t?t:this.shader;let r=this.nodeCode[e];return this.nodeCode[e]="",r}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(e){this.addFinalCode(e,"vertex")}addFragmentFinalCode(e){this.addFinalCode(e,"fragment")}addFinalCode(e,t){this.finalCode[null!==t&&void 0!==t?t:this.shader]+=e+"\n"}addVertexParsCode(e){this.addParsCode(e,"vertex")}addFragmentParsCode(e){this.addParsCode(e,"fragment")}addParsCode(e,t){this.parsCode[null!==t&&void 0!==t?t:this.shader]+=e+"\n"}addVaryCode(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)}isCache(e){return-1!==this.caches.indexOf(e)}isSlot(e){return-1!==this.slots.indexOf(e)}define(e,t){this.defines[e]=void 0===t?1:t}require(e){this.requires[e]=!0}isDefined(e){return void 0!==this.defines[e]}getVar(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"varying",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"V",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",a=this.getVars(n),o=a[e];if(!o){let n=a.length;o={name:r||"node"+i+n+(s?"_"+s:""),type:t},a.push(o),a[e]=o}return o}getTempVar(e,t,r,n){return this.getVar(e,t,r,this.shader,"T",n)}getAttribute(e,t){if(!this.attributes[e]){let r=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(r.name+" = "+e+";"),this.attributes[e]={varying:r,name:e,type:t}}return this.attributes[e]}getCode(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join("\n")}getVarListCode(e,t){var r;t=null!==(r=t)&&void 0!==r?r:"";let n="";for(let i=0,s=e.length;i<s;++i){let r=e[i],s=r.type,a=r.name,o=r.size,l=this.getFormatByType(s);if(void 0===l)throw new Error("Node pars "+l+" not found.");l.includes("[]")?n+=t+" "+l.substring(0,l.length-2)+" "+a+"[".concat(o,"];\n"):n+=t+" "+l+" "+a+";\n"}return n}getVars(e){return this.inputs.vars[null!==e&&void 0!==e?e:this.shader]}getNodeData(e){let t=e instanceof j9?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}}createUniform(e,t,r,n,i,s){if(t.includes("[]")){let a=this.inputs.arrayUniforms,o=a.list.length,l=new U9({type:t,size:r.size,name:n||"nodeUA"+o+(s?"_"+s:""),node:r,needsUpdate:i});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}{let a=this.inputs.uniforms,o=a.list.length,l=new U9({type:t,name:n||"nodeU"+o+(s?"_"+s:""),node:r,needsUpdate:i});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(e,t,r,n,i){return this.createUniform("vertex",e,t,r,n,i)}createFragmentUniform(e,t,r,n,i){return this.createUniform("fragment",e,t,r,n,i)}include(e,t,r){let n;if(e="string"==typeof e?V9.get(e):e,!1===this.context.include)return e.name;e instanceof Z9?n=this.includes.functions:e instanceof e7?n=this.includes.consts:e instanceof n7&&(n=this.includes.structs);let i=n[this.shader]=n[this.shader]||[];if(e){var s;let n=i[e.name];if(n||(n=i[e.name]={node:e,deps:[]},i.push(n),n.src=e.build(this,"source")),e instanceof Z9&&t&&i[t.name]&&-1===i[t.name].deps.indexOf(e)&&(i[t.name].deps.push(e),null!==(s=e.includes)&&void 0!==s&&s.length)){let r=0;do{this.include(e.includes[r++],t)}while(r<e.includes.length)}return r&&(n.src=r),e.name}throw new Error("Include not found.")}colorToVectorProperties(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(e){return e.replace(/c/g,"v3")}getIncludes(e,t){return this.includes[e][t||this.shader]}getConstructorFromLength(e){return A7[e-1]}isTypeMatrix(e){return/^m/.test(e)}getTypeLength(e){return"f"===e?1:parseInt(this.colorToVector(e).substr(1))}getTypeFromLength(e){return 1===e?"f":"v"+e}findNode(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(let n=0;n<arguments.length;n++){let e=t[n];if(null!==e&&void 0!==e&&e.isNode)return e}}resolve(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(let n=0;n<arguments.length;n++){let e=t[n];if(void 0!==e){if(e.isNode)return e;if(e.isTexture)switch(e.mapping){case KL:case QL:return new C7(e);case ZL:return new _7(new l7(e));default:return new l7(e)}else{if(e.isVector2)return new G9(e);if(e.isVector3)return new q9(e);if(e.isVector4)return new Y9(e)}}}}format(e,t,r){switch(this.colorToVector(r+" <- "+t)){case"f <- v2":case"f <- v3":case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":case"i <- v3":case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e}getTypeByFormat(e){return M7[e]||e}getFormatByType(e){return T7[e]||e}getUUID(e,t){return(t=void 0===t||t)&&this.cache&&(e=this.cache+"-"+e),e}getElementByIndex(e){return E7[e]}getIndexByElement(e){return E7.indexOf(e)}isShader(e){return this.shader===e}setShader(e){return this.shader=e,this}mergeDefines(e){for(let t in e)this.defines[t]=e[t];return this.defines}mergeUniform(e){for(let t in e)this.uniforms[t]=e[t];return this.uniforms}getTextureEncodingFromMap(e){let t;return e?e.isTexture&&(t=e.encoding):t=kN,t===kN&&this.context.gamma&&(t=DN),t}},k7=class extends W9{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;super("c"),this.nodeType="Color",this.value=e instanceof X9?e:new X9(e||0,t,r,n)}setRGBA(e){this.value.setRGBA(e.r,e.g,e.b,e.a)}generate(e,t,r,n,i,s){var a,o;r=e.getUUID(null!==(a=r)&&void 0!==a?a:this.getUUID()),n=null!==(o=n)&&void 0!==o?o:this.getType(e);let l=e.getNodeData(r),c=this.getReadonly()&&void 0!==this.generateReadonly;if(this.alpha){let t=this.alpha.build(e,"f");e.addFragmentNodeCode("accumAlpha += ( 1.0 - accumAlpha ) * ".concat(t,";"))}return c?this.generateReadonly(e,t,r,n,i,s):e.isShader("vertex")?(l.vertex||(l.vertex=e.createVertexUniform(n,this,i,s,this.getLabel())),e.format(l.vertex.name,n,t)):(l.fragment||(l.fragment=e.createFragmentUniform(n,this,i,s,this.getLabel())),e.format(l.fragment.name,n,t))}generateReadonly(e,t,r,n,i,s){return e.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",n,t)}},D7=class extends W9{constructor(e){super("i"),this.nodeType="Int",this.value=Math.floor(null!==e&&void 0!==e?e:0)}generateReadonly(e,t,r,n,i,s){return e.format(this.value.toString(),n,t)}},I7=class extends W9{constructor(e){super("b"),this.nodeType="Bool",this.value=null!==e&&void 0!==e&&e}generateReadonly(e,t,r,n){return e.format(this.value?"true":"false",n,t)}},O7=class extends W9{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;super("f[]"),this.nodeType="FloatArray",this.size=e,this.value=Array.isArray(t)?t:"number"==typeof t?new Array(e).fill(t):new Array(e).fill(0)}},R7=class extends W9{},L7=class extends R7{constructor(e){super("v3"),this.image=e,this._value=new PB}get value(){var e,t;return this._value.x=this.image.isVideo?null!==(e=this.image.img.videoWidth)&&void 0!==e?e:0:this.image.img.width,this._value.y=this.image.isVideo?null!==(t=this.image.img.videoHeight)&&void 0!==t?t:0:this.image.img.height,this._value}},N7=class extends R7{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1008,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1006;super("t"),this.image=e,this.wrap=t,this.minFilter=r,this.magFilter=n}get value(){return this.image.getTexture(this.wrap,this.minFilter,this.magFilter)}},B7=class extends W9{constructor(e){super("m3"),this.nodeType="Matrix3",this.value=null!==e&&void 0!==e?e:new tB}generateReadonly(e,t,r,n,i,s){return e.format("mat3("+this.value.elements.join(", ")+")",n,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}},z7=class extends W9{constructor(e){super("m4"),this.nodeType="Matrix4",this.value=null!==e&&void 0!==e?e:new sz}generateReadonly(e,t,r,n,i,s){return e.format("mat4("+this.value.elements.join(", ")+")",n,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}};function F7(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;e.setUvTransform(r[0],r[1],t[0],t[1],0,0,0).premultiply((new tB).makeRotation(n*$N.DEG2RAD))}var j7=class extends B7{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(new tB),this.repeat=e,this.offset=t,this.rotation=r,F7(this.value,e,t,r)}updateMatrix(){F7(this.value,this.repeat,this.offset,this.rotation)}},U7=class extends W9{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;super("v4[]"),this.nodeType="Vector4Array",this.size=e,this.value=Array.isArray(t)?t:t instanceof CB?new Array(e).fill(t):new Array(e).fill(new CB(0))}},V7=class extends H9{constructor(e,t,r,n){super("v3"),this.nodeType="Blend",this.a=e,this.b=t,this.alpha=r,this.mode=n}generate(e,t){if(e.isShader("fragment")){let r=[];return r.push(this.a.build(e,"c")),r.push(this.b.build(e,"c")),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),e.format("spe_blend("+r.join(",")+")",this.getType(e),t)}return console.warn("BlendNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},H7=class extends H9{constructor(e,t){super("v3"),this.nodeType="CustomColor",this.color=e,this.alpha=t,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.isShader("fragment")){let r=e.include(H7.Nodes.customColor);e.addFragmentVariable(this.calpha,"float");let n=[];return n.push(this.color.build(e,"v3")),n.push(this.mask?"luminance(".concat(this.mask.build(e,"v3"),")"):"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(r+"("+n.join(",")+")",this.getType(e),t)}return console.warn("CustomColorNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},W7=H7;W7.Nodes={customColor:new Z9("vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {\n\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\tcalpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha;\n\n\t\t\t\treturn color;\n\t\t\t}")};var G7=class extends H9{constructor(e,t){super("v3"),this.nodeType="CustomNormal",this.cnormal=e,this.alpha=t,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.isShader("fragment")){let r=e.include(G7.Nodes.customNormal);e.addFragmentVariable(this.calpha,"float");let n=[];return n.push(this.cnormal.build(e,"v3")),n.push("normal"),n.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(r+"("+n.join(",")+")",this.getType(e),t)}return console.warn("CustomNormalNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},q7=G7;q7.Nodes={customNormal:new Z9("vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {\n\t\t\t\tvec3 normal = packNormalToRGB( norm ).rgb;\n\t\t\t\tnormal *= step( vec3(0.5), cnormal );\n\n\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * lalpha;\n\n\t\t\t\treturn normal;\n\t\t\t}")};var X7=class extends H9{constructor(e,t,r,n,i,s,a,o,l,c,u,h){super("v3"),this.nodeType="CustomTexture",this.texture=e,this.textureSize=t,this.crop=r,this.projection=n,this.axis=i,this.side=s,this.size=a,this.blending=o,this.mat=l,this.isMask=h,this.alpha=c,this.mode=u,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){e.require("position"),e.require("normal"),e.require("uv"),e.requires.uv=[!0],e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0;let r,n="g".concat(this.uuid.toString().replace(/-/g,""));switch(this.projection.value){case 3:r=e.include(X7.Nodes.cylindrical);break;case 2:r=e.include(X7.Nodes.spherical);break;case 1:let t=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],i=["zy","xz","xy"][this.axis.value],s=new Z9("\n\t\tvec3 ".concat(n,"_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n\t\t\t\tvec2 projected = (1. + (position.").concat(i,")) / 2.;\n\t\t\t\tvec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n\t\t\t\tvec4 tmp = texture2D( tex, uvs );\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\t").concat(2===this.side.value?"":"lalpha *= step(0.0, ".concat(1===this.side.value?"-1.0 * ":"","dot(vObjectNormal, ").concat(t,"));"),"\n\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlalpha *= mask;\n\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}"));r=e.include(s);break;case 4:r=e.include(X7.Nodes.triplanar);break;default:r=e.include(X7.Nodes.uv)}e.addFragmentVariable(this.calpha,"float");let i=[];if(i.push("normal"),i.push(this.texture.generate(e,"t")),i.push(this.textureSize.build(e,"v2")),i.push(this.crop.build(e,"f")),i.push(this.mat.build(e,"mat3")),i.push(this.size.build(e,"v2")),i.push(this.blending.build(e,"f")),i.push(this.isMask.build(e,"b")),i.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),i.push(this.calpha),4===this.projection.value){let t="".concat(n,"_writeUvs"),r=t+"0",s=t+"1",a=t+"2",o="".concat(n,"_triplanarWeights");e.addFragmentVariable(r,"vec2"),e.addFragmentVariable(s,"vec2"),e.addFragmentVariable(a,"vec2"),e.addFragmentVariable(o,"vec3"),i.push(r),i.push(s),i.push(a),i.push(o)}else{let t="".concat(n,"_writeUvs");e.addFragmentVariable(t,"vec2"),i.push(t)}return e.format(r+"("+i.join(",")+")",this.getType(e),t)}},Y7=X7;Y7.Nodes={cylindrical:new Z9("\nvec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n                vec3 posN = normalize(position);\n                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);\n                float scaledHeight = position.y / (size.y * 0.5);\n                float v =  (scaledHeight / 2.) + .5;\n\n                vec2 calculatedUv = vec2(u,v);\n\t\t\t\tvec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n                vec2 df = fwidth(uvs);\n               \tif(df.x > 0.5) df.x = 0.;\n\n\t\t\t\t#ifdef GL_EXT_shader_texture_lod\n                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#else\n                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#endif\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlalpha *= mask;\n\t\t\t\t\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}\n"),spherical:new Z9("\nvec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n                vec3 posN = normalize(vPosition);\n                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);\n                float v = 0.5 + asin(posN.y) / 3.1415;\n\n                vec2 calculatedUv = vec2(u,v);\n\t\t\t\tvec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n                vec2 df = fwidth(uvs);\n               \tif(df.x > 0.5) df.x = 0.;\n\t\t\t\t#ifdef GL_EXT_shader_texture_lod\n                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#else\n                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#endif\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlalpha *= mask;\n\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}\n"),uv:new Z9("vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n\t\t\t\tvec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n\t\t\t\tvec4 tmp = texture2D( tex, uvs );\n\n\t\t\t\tvec3 col = tmp.rgb;\n\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlalpha *= mask;\n\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}"),triplanar:new Z9("vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {\n\t\t\t\tvec3 p = position;\n\t\t\t\tvec2 uv0 = (1.0 + p.xy) / 2.0;     \n\t\t\t\tvec2 uv1 = (1.0 + p.zy) / 2.0;\t\t\n\t\t\t\tvec2 uv2 = (1.0 + p.xz) / 2.0;\t\t\n\t\n\t\t\t\tuv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;\n\t\t\t\tuv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;\n\t\t\t\tuv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;\n\n\t\t\t\t// Range from 3 to 128 seems to be good\n\t\t\t\tfloat exponent = (1.0 - blending) * 125.0 + 3.0;\n\n\t\t\t\tvec3 n = vObjectNormal;\n\t\t\t\tvec3 weights = abs(normalize(n));\n\t\t\t\tweights = pow(weights, vec3(exponent));\n\t\t\t\tweights /= dot(weights, vec3(1.0));\n\n\t\t\t\t// Write out all sets of UVs that we generated\n\t\t\t\twriteUvs0 = uv0;\n\t\t\t\twriteUvs1 = uv1;\n\t\t\t\twriteUvs2 = uv2;\n\t\t\t\twriteWeights = weights;\n\n\t\t\t\t// Derivatives for LOD\n\t\t\t\tvec2 df0 = fwidth(uv0);\n\t\t\t\tvec2 df1 = fwidth(uv1);\n\t\t\t\tvec2 df2 = fwidth(uv2);\n\t\t\t\tif (df0.x > 0.5) df0.x = 0.0;\n\t\t\t\tif (df1.x > 0.5) df1.x = 0.0;\n\t\t\t\tif (df2.x > 0.5) df2.x = 0.0;\n\n\t\t\t\t#ifdef GL_EXT_shader_texture_lod\n                \tvec4 tmp = \n\t\t\t\t\t\ttexture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + \n\t\t\t\t\t\ttexture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + \n\t\t\t\t\t\ttexture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;\n\t\t\t\t#else\n                \tvec4 tmp = \n\t\t\t\t\t\ttextureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + \n\t\t\t\t\t\ttextureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + \n\t\t\t\t\t\ttextureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;\n\t\t\t\t#endif\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\n\t\t\t\t// Apply cropping across all 3 planes\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t\tif ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t\tif ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlalpha *= mask;\n\t\t\t\tcalpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;//n * 0.5 + 0.5;\n\t\t\t}\t\t\t\n\t\t\t")};var K7=class extends H9{constructor(e,t,r,n,i,s,a,o,l,c,u,h){super("v3"),this.nodeType="Depth",this.gradientType=e,this.smooth=t,this.near=r,this.far=n,this.isVector=i,this.isWorldSpace=s,this.origin=a,this.direction=o,this.colors=l,this.steps=c,this.isMask=h,this.alpha=u,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){let r="g".concat(this.uuid.toString().replace(/-/g,"")),n=new Z9("vec3 ".concat(r,"_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[").concat(r,"_MAX_COLORS], float steps[").concat(r,"_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {\n               vec4 color = colors[0];\n               #ifdef ").concat(r,"_IS_VECTOR\n                   #ifdef ").concat(r,"_LINEAR\n                       #ifdef ").concat(r,"_WORLDSPACE\n                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);\n                       #else\n                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);\n                       #endif\n                   #else\n                       #ifdef ").concat(r,"_WORLDSPACE\n                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);\n                       #else\n                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);\n                       #endif\n                   #endif\n               #else\n                   float dist = length(vWPosition - cameraPosition);\n\t\t\t       float depth = ( dist - near ) / ( far - near );\n               #endif\n\n\n              float p;\n              #ifdef ").concat(r,"_SMOOTH\n\t\t\t\tfor ( int i = 1; i < ").concat(r,"_MAX_COLORS; i++ ) {\n\t\t\t\t\t\tp = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );\n\t\t\t\t\t\tcolor = mix(color, colors[i], smoothstep(0.0, 1.0, p));\n\t\t\t\t\t}\n              #else\n                for ( int i = 1; i < ").concat(r,"_MAX_COLORS; i++ ) {\n                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);\n                   color = mix(color, colors[i], p);\n                 }\n              #endif\n\n               float lalpha = alpha * color.a * mask;\n               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\t\t\t   \n               return color.rgb;\n\t\t\t}"),[K7.Nodes.vectorLinearWorldSpaceDepth,K7.Nodes.vectorLinearObjectSpaceDepth,K7.Nodes.vectorSphericalObjectSpaceDepth,K7.Nodes.vectorSphericalWorldSpaceDepth]);if(e.isShader("fragment")){e.define("".concat(r,"_MAX_COLORS"),this.colors.value.length),this.smooth.value&&e.define("".concat(r,"_SMOOTH")),this.isVector.value>.5&&e.define("".concat(r,"_IS_VECTOR")),0===this.gradientType.value&&e.define("".concat(r,"_LINEAR")),this.isWorldSpace.value>.5&&e.define("".concat(r,"_WORLDSPACE")),e.require("worldPosition"),e.addFragmentVariable(this.calpha,"float");let i=e.include(n),s=[];return s.push(this.near.build(e,"f")),s.push(this.far.build(e,"f")),s.push(this.origin.build(e,"v3")),s.push(this.direction.build(e,"v3")),s.push(this.colors.build(e,"v4[]")),s.push(this.steps.build(e,"f[]")),s.push(this.isMask.build(e,"b")),s.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),s.push(this.alpha.build(e,"f")),s.push(this.calpha),e.format(i+"("+s.join(",")+")",this.getType(e),t)}return console.warn("DepthNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Q7=K7;Q7.Nodes={vectorLinearWorldSpaceDepth:new Z9("float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {\n               vec3 n = normalize(direction);\n               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));\n               return ( dist - near ) / ( far - near );\n            }"),vectorLinearObjectSpaceDepth:new Z9("float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {\n               vec3 n = normalize(direction);\n               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));\n               return ( dist - near ) / ( far - near );\n            }"),vectorSphericalWorldSpaceDepth:new Z9("float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {\n               float dist = length(vWPosition - origin);\n               return ( dist - near ) / ( far - near );\n            }"),vectorSphericalObjectSpaceDepth:new Z9("float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {\n               float dist = length(position - origin);\n               return ( dist - near ) / ( far - near );\n            }")};var Z7=class extends H9{constructor(e,t,r,n,i,s,a,o){super("v3"),this.nodeType="Fresnel",this.color=e,this.bias=t,this.scale=r,this.intensity=n,this.factor=i,this.isMask=o,this.alpha=s,this.mode=a,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=new Z9("vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {\n\t\t\t\t\tfloat fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );\n\n\t\t\t\t\tfloat lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;\n\t\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\t\treturn color;\n\t\t\t\t}"),n=e.include(r),i=[];return i.push(this.color.build(e,"c")),i.push(this.bias.build(e,"f")),i.push(this.scale.build(e,"f")),i.push(this.intensity.build(e,"f")),i.push(this.factor.build(e,"f")),i.push(this.isMask.build(e,"b")),i.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),i.push(this.calpha),e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("FresnelNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},J7=class extends H9{constructor(e,t,r,n,i,s,a,o,l){super("v3"),this.nodeType="Gradient",this.gradientType=e,this.smooth=t,this.colors=r,this.steps=n,this.offset=i,this.morph=s,this.angle=a,this.isMask=l,this.alpha=o,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.isShader("fragment")){e.define("GRAD_MAX",10),e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(J7.Nodes.gradient),n=[];return n.push(this.gradientType.build(e,"i")),n.push(this.smooth.build(e,"b")),n.push(this.colors.build(e,"v4[]")),n.push(this.steps.build(e,"f[]")),n.push(this.offset.build(e,"v2")),n.push(this.morph.build(e,"v2")),n.push(this.angle.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(r+"("+n.join(",")+")",this.getType(e),t)}return console.warn("GradientNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},$7=J7;$7.Nodes={gradient:new Z9("vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {\n\t\t\t\tvec4 color = colors[0];\n\t\t\t\tvec2 m = morph / vUv.xy;\n\t\t\t\tvec2 rot = vec2( 0.5 + m.x, m.y );\n\t\t\t\tvec2 dt = vec2(\n\t\t\t\t\tcos( angle ) * rot.x - sin( angle ) * rot.y,\n\t\t\t\t\tsin( angle ) * rot.x + cos( angle ) * rot.y\n\t\t\t\t);\n\t\t\t\tvec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;\n\t\t\t\tfloat t = dot( pt, dt ) / dot( dt, dt );\n\t\t\t\tif ( gradientType == 1 ) {\n\t\t\t\t\tt = distance (\n\t\t\t\t\t\t( vUv + morph ) * 3.0,\n\t\t\t\t\t\t( vUv + offset ) + 1.0\n\t\t\t\t\t) + angle;\n\t\t\t\t} else if ( gradientType == 2 ) {\n\t\t\t\t\tfloat polar = atan(\n\t\t\t\t\t\tvUv.x + morph.x - 0.5 + offset.x,\n\t\t\t\t\t\tvUv.y + morph.y - 0.5 + offset.y\n\t\t\t\t\t) * -1.0;\n\t\t\t\t\tt = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );\n\t\t\t\t}\n\n\t\t\t\tfloat p;\n\t\t\t\tif (smoothed) {\n\t\t\t\t\tfor ( int i = 1; i < GRAD_MAX; i++ ) {\n\t\t\t\t\t\tp = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );\n\t\t\t\t\t\tcolor = mix(color, colors[i], smoothstep(0.0, 1.0, p));\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tfor ( int i = 1; i < GRAD_MAX; i++ ) {\n\t\t\t\t\t\tp = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );\n\t\t\t\t\t\tcolor = mix(color, colors[i], p);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfloat lalpha = alpha * color.a * mask;\n\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\t\t\t\t\n\t\t\t\treturn color.xyz;\n\t\t\t}")};var eee=class extends H9{constructor(e,t,r,n,i){super("v3"),this.nodeType="Matcap",this.texture=e,this.isMask=n,this.alpha=t,this.mode=r,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha"),this.rotation=i}generate(e,t){if(e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=e.include(eee.Nodes.matcap);e.require("normal"),e.requires.normal=!0;let n=[];return n.push(this.texture.generate(e,"t")),n.push("normal"),n.push(this.isMask.build(e,"b")),n.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),n.push(this.rotation.build(e,"f")),e.format(r+"("+n.join(",")+")",this.getType(e),t)}return console.warn("MatcapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},tee=eee;tee.Nodes={matcap:new Z9("vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha, float rotation) {\n\t\t\t\t\tvec3 viewDir = normalize( vViewPosition );\n\t\t\t\t\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\t\t\t\t\tvec3 y = cross( viewDir, x );\n\t\t\t\t\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) );\n\t\t\t\t\tuv = mat2( cos(rotation), sin(rotation), -sin(rotation), cos(rotation) ) * uv;\n\t\t\t\t\tuv = uv * 0.495 + 0.5;\n\t\t\t\t\tvec4 matcapColor = texture2D( matcapTex, uv );\n\n\t\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\t\t\t\t\t\n\t\t\t\t\treturn matcapColor.rgb;\n            \t}")};var ree=function(){let e=new Z9("vec3 random3(vec3 c) {\n\t\t\tfloat j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));\n\t\t\tvec3 r;\n\t\t\tr.z = fract(512.0*j);\n\t\t\tj *= .125;\n\t\t\tr.x = fract(512.0*j);\n\t\t\tj *= .125;\n\t\t\tr.y = fract(512.0*j);\n\t\t\treturn r-0.5;\n\t\t}"),t=new Z9("float simplexFast(vec3 p) {\n\t\t\t vec3 s = floor(p + dot(p, vec3(F3)));\n\t\t\t mediump vec3 x = p - s + dot(s, vec3(G3));\n\t\t\t mediump vec3 hs = s;\n\t\t\t \n\t\t\t mediump vec3 e = step(vec3(0.0), x - x.yzx);\n\t\t\t mediump vec3 i1 = e*(1.0 - e.zxy);\n\t\t\t mediump vec3 i2 = 1.0 - e.zxy*(1.0 - e);\n\t\t\t\t\n\t\t\t mediump vec3 x1 = x - i1 + G3;\n\t\t\t mediump vec3 x2 = x - i2 + 2.0*G3;\n\t\t\t mediump vec3 x3 = x - 1.0 + 3.0*G3;\n\t\t\t \n\t\t\t mediump vec4 w, d;\n\t\t\t \n\t\t\t w.x = dot(x, x);\n\t\t\t w.y = dot(x1, x1);\n\t\t\t w.z = dot(x2, x2);\n\t\t\t w.w = dot(x3, x3);\n\t\t\t \n\t\t\t w = max(0.6 - w, 0.0);\n\t\t\t \n\t\t\t d.x = dot(random3(hs), x);\n\t\t\t d.y = dot(random3(hs + i1), x1);\n\t\t\t d.z = dot(random3(hs + i2), x2);\n\t\t\t d.w = dot(random3(hs + 1.0), x3);\n\t\t\t \n\t\t\t w *= w;\n\t\t\t w *= w;\n\t\t\t d *= w;\n\t\t\t \n\t\t\t return dot(d, vec4(52.0));\n\t\t}",[e]);t.keywords.F3=new e7("float F3 0.3333333"),t.keywords.G3=new e7("float G3 0.1666667");let r=new Z9("float simplexPrecise(vec3 p) {\n\t\t\t vec3 s = floor(p + dot(p, vec3(F3)));\n\t\t\t vec3 x = p - s + dot(s, vec3(G3));\n\t\t\t \n\t\t\t vec3 e = step(vec3(0.0), x - x.yzx);\n\t\t\t vec3 i1 = e*(1.0 - e.zxy);\n\t\t\t vec3 i2 = 1.0 - e.zxy*(1.0 - e);\n\t\t\t\t\n\t\t\t vec3 x1 = x - i1 + G3;\n\t\t\t vec3 x2 = x - i2 + 2.0*G3;\n\t\t\t vec3 x3 = x - 1.0 + 3.0*G3;\n\t\t\t \n\t\t\t vec4 w, d;\n\t\t\t \n\t\t\t w.x = dot(x, x);\n\t\t\t w.y = dot(x1, x1);\n\t\t\t w.z = dot(x2, x2);\n\t\t\t w.w = dot(x3, x3);\n\t\t\t \n\t\t\t w = max(0.6 - w, 0.0);\n\t\t\t \n\t\t\t d.x = dot(random3(s), x);\n\t\t\t d.y = dot(random3(s + i1), x1);\n\t\t\t d.z = dot(random3(s + i2), x2);\n\t\t\t d.w = dot(random3(s + 1.0), x3);\n\t\t\t \n\t\t\t w *= w;\n\t\t\t w *= w;\n\t\t\t d *= w;\n\t\t\t \n\t\t\t return dot(d, vec4(52.0));\n\t\t}",[e]);r.keywords.F3=new e7("float F3 0.3333333"),r.keywords.G3=new e7("float G3 0.1666667");let n=new Z9("float simplexFractal(vec3 m) {\n\t\t\tmat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);\n\t\t\tmat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);\n\t\t\tmat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);\n\t\t\treturn 0.5333333 * simplexFast(m * rot1)\n\t\t\t\t + 0.2666667 * simplexFast(2.0 * m * rot2)\n\t\t\t\t + 0.1333333 * simplexFast(4.0 * m * rot3)\n\t\t\t\t + 0.0666667 * simplexFast(8.0 * m);\n\t\t}",[t]),i=new Z9("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),s=new Z9("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),a=new Z9("float simplexAshima(vec3 v) {\n\t\t  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n\t\t  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\t\t  vec3 i  = floor(v + dot(v, C.yyy) );\n\t\t  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\t\t  vec3 g = step(x0.yzx, x0.xyz);\n\t\t  vec3 l = 1.0 - g;\n\t\t  vec3 i1 = min( g.xyz, l.zxy );\n\t\t  vec3 i2 = max( g.xyz, l.zxy );\n\t\t  vec3 x1 = x0 - i1 + 1.0 * C.xxx;\n\t\t  vec3 x2 = x0 - i2 + 2.0 * C.xxx;\n\t\t  vec3 x3 = x0 - 1. + 3.0 * C.xxx;\n\t\t  i = mod(i, 289.0 ); \n\t\t  vec4 p = permute( permute( permute( \n\t\t\t\t\t i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n\t\t\t\t   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) \n\t\t\t\t   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\t\t  float n_ = 1.0/7.0; // N=7\n\t\t  vec3  ns = n_ * D.wyz - D.xzx;\n\t\t  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)\n\t\t  vec4 x_ = floor(j * ns.z);\n\t\t  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\t\t  vec4 x = x_ *ns.x + ns.yyyy;\n\t\t  vec4 y = y_ *ns.x + ns.yyyy;\n\t\t  vec4 h = 1.0 - abs(x) - abs(y);\n\t\t  vec4 b0 = vec4( x.xy, y.xy );\n\t\t  vec4 b1 = vec4( x.zw, y.zw );\n\t\t  vec4 s0 = floor(b0)*2.0 + 1.0;\n\t\t  vec4 s1 = floor(b1)*2.0 + 1.0;\n\t\t  vec4 sh = -step(h, vec4(0.0));\n\t\t  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n\t\t  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\t\t  vec3 p0 = vec3(a0.xy,h.x);\n\t\t  vec3 p1 = vec3(a0.zw,h.y);\n\t\t  vec3 p2 = vec3(a1.xy,h.z);\n\t\t  vec3 p3 = vec3(a1.zw,h.w);\n\t\t  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n\t\t  p0 *= norm.x;\n\t\t  p1 *= norm.y;\n\t\t  p2 *= norm.z;\n\t\t  p3 *= norm.w;\n\t\t  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n\t\t  m = m * m;\n\t\t  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), \n\t\t\t\t\t\t\t\t\t\tdot(p2,x2), dot(p3,x3) ) );\n\t\t}",[i,s]),o=new Z9("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),l=new Z9("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[o]),c=new Z9("float noise(vec3 p){\n\t\t\tvec3 a = floor(p);\n\t\t\tvec3 d = p - a;\n\t\t\td = d * d * (3.0 - 2.0 * d);\n\t\t\tvec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n\t\t\tvec4 k1 = perm(b.xyxy);\n\t\t\tvec4 k2 = perm(k1.xyxy + b.zzww);\n\t\t\tvec4 c = k2 + a.zzzz;\n\t\t\tvec4 k3 = perm(c);\n\t\t\tvec4 k4 = perm(c + 1.0);\n\t\t\tvec4 o1 = fract(k3 * (1.0 / 41.0));\n\t\t\tvec4 o2 = fract(k4 * (1.0 / 41.0));\n\t\t\tvec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n\t\t\tvec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\t\t\treturn o4.y * d.y + o4.x * (1.0 - d.y);\n\t\t}",[l]),u=new Z9("float fbm(vec3 x) {\n\t\t\tfloat v = 0.0;\n\t\t\tfloat a = 0.5;\n\t\t\tvec3 shift = vec3(100);\n\t\t\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\t\t\tv += a * noise(x);\n\t\t\t\tx = x * 2.0 + shift;\n\t\t\t\ta *= 0.5;\n\t\t\t}\n\t\t\treturn v;\n\t\t}",[c]);u.keywords.NUM_OCTAVES=new e7("int NUM_OCTAVES ".concat(5));let h=new Z9("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),d=new Z9("float perlin(vec3 P){\n\t\t  vec3 Pi0 = floor(P);\n\t\t  vec3 Pi1 = Pi0 + vec3(1.0);\n\t\t  Pi0 = mod(Pi0, 289.0);\n\t\t  Pi1 = mod(Pi1, 289.0);\n\t\t  vec3 Pf0 = fract(P);\n\t\t  vec3 Pf1 = Pf0 - vec3(1.0);\n\t\t  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n\t\t  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n\t\t  vec4 iz0 = Pi0.zzzz;\n\t\t  vec4 iz1 = Pi1.zzzz;\n\t\t  vec4 ixy = permute(permute(ix) + iy);\n\t\t  vec4 ixy0 = permute(ixy + iz0);\n\t\t  vec4 ixy1 = permute(ixy + iz1);\n\t\t  vec4 gx0 = ixy0 / 7.0;\n\t\t  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;\n\t\t  gx0 = fract(gx0);\n\t\t  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n\t\t  vec4 sz0 = step(gz0, vec4(0.0));\n\t\t  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n\t\t  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\t\t  vec4 gx1 = ixy1 / 7.0;\n\t\t  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;\n\t\t  gx1 = fract(gx1);\n\t\t  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n\t\t  vec4 sz1 = step(gz1, vec4(0.0));\n\t\t  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n\t\t  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\t\t  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n\t\t  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n\t\t  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n\t\t  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n\t\t  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n\t\t  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n\t\t  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n\t\t  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\t\t  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n\t\t  g000 *= norm0.x;\n\t\t  g010 *= norm0.y;\n\t\t  g100 *= norm0.z;\n\t\t  g110 *= norm0.w;\n\t\t  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n\t\t  g001 *= norm1.x;\n\t\t  g011 *= norm1.y;\n\t\t  g101 *= norm1.z;\n\t\t  g111 *= norm1.w;\n\t\t  float n000 = dot(g000, Pf0);\n\t\t  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n\t\t  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n\t\t  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n\t\t  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n\t\t  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n\t\t  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n\t\t  float n111 = dot(g111, Pf1);\n\t\t  vec3 fade_xyz = fade(Pf0);\n\t\t  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n\t\t  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n\t\t  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); \n\t\t  return 2.2 * n_xyz;\n\t\t}",[i,s,h]),f=new Z9("float hashwithoutsine13(vec3 p3)\n\t\t{\n\t\t\tp3  = fract(p3 * .1031);\n\t\t\tp3 += dot(p3, p3.yzx + 33.33);\n\t\t\treturn fract((p3.x + p3.y) * p3.z);\n\t\t}"),p=new Z9("vec3 hashwithoutsine33(vec3 p3)\n\t\t{\n\t\t\tp3 = fract(p3 * vec3(.1031, .1030, .0973));\n\t\t\tp3 += dot(p3, p3.yxz+33.33);\n\t\t\treturn fract((p3.xxy + p3.yxx)*p3.zyx);\n\t\t}"),m=new Z9("float metric(in vec3 p)\n\t\t{\n\t\t\t// L2 \n\t\t\treturn length(p);\n\n\t\t\t// Chebyshev \n\t\t\t// vec3 a = abs(p);\n\t\t\t// return max(a.x, max(a.y, a.z));\n\t\t}"),g=new Z9("float smin( float a, float b, float k )\n\t\t{\n\t\t\tfloat h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);\n\t\t\tfloat correction = k * h * (1.0 - h);\n\t\t\treturn mix(b, a, h) - correction;\n\t\t}"),v=new Z9("float smax( float a, float b, float k )\n\t\t{\n\t\t\tfloat h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);\n\t\t\tfloat correction = k * h * (1.0 - h);\n\t\t\treturn mix(a, b, h) + correction;\n\t\t}"),y=new Z9("float remap(float value, float input_min, float input_max, float output_min, float output_max) {\n\t\t\t// Compute width of each interval\n\t\t\tfloat input_width = input_max - input_min;\n\t\t\tfloat output_width = output_max - output_min;\n\t\t\n\t\t\t// Convert input range into a 0-1 range \n\t\t\tfloat scaled = (value - input_min) / input_width;\n\t\t\n\t\t\t// Convert the 0-1 range into a value in output range\n\t\t\treturn output_min + (scaled * output_width);\n\t\t}");return{simplexFast:t,simplexPrecise:r,simplexFractal:n,simplexAshima:a,fbm:u,perlin:d,voronoi:new Z9('float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) \n\t\t{\n\t\t\t// Integer and fractional parts of this point\'s coordinates\n\t\t\tivec3 p = ivec3(floor(x));\n\t\t\tvec3 f = fract(x);\n\n\t\t\t// Different variables that we will use to construct noise:\n\t\t\t//\n\t\t\t// f1: distance to the closest feature point\n\t\t\t// f2: distance to the second closest feature point\n\t\t\t// e: distance to the closest edge (cell boundary)\n\t\t\t//\n\t\t\t// We also compute "smooth" versions of all of the above quantites, essentially\n\t\t\t// replacing "hard" minimums with "smooth" minimums (described by IQ)\n\t\t\tfloat f1_smooth = 8.0;\n\t\t\tfloat f1 = 8.0;\n\t\t\tfloat f2_smooth = 8.0;\n\t\t\tfloat f2 = 8.0;\n\t\t\tfloat e_smooth = 8.0;\n\t\t\tfloat e = 8.0;\n\n\t\t\t// Variables stored from closest cell\n\t\t\tivec3 mb;\n\t\t\tvec3 mr; \n\n\t\t\tint steps = quality;\n\t\t\t\n\t\t\tfor (int x = -steps; x <= steps; x++) \n\t\t\tfor (int y = -steps; y <= steps; y++)\n\t\t\tfor (int z = -steps; z <= steps; z++)\n\t\t\t{\n\t\t\t\tivec3 b = ivec3(x, y, z);\n\t\t\t\tvec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;\n\t\t\t\tfloat d = length(r);\n\t\t\t\t\n\t\t\t\tf1_smooth = smin(d, f1_smooth, smoothness);\n\n\t\t\t\t// Store un-smoothed distances too \n\t\t\t\tif (d < f1) \n\t\t\t\t{\n\t\t\t\t\tf2 = f1;\n\t\t\t\t\tf1 = d;\n\n\t\t\t\t\tmb = ivec3(x, y, z);\n\t\t\t\t\tmr = r;\n\t\t\t\t} \n\t\t\t\telse if (d < f2) \n\t\t\t\t{\n\t\t\t\t\tf2 = d;\n\t\t\t\t}\n\t\t\t}\t\n\t\t\t\n\t\t\t// Second pass for edge distance  \n\t\t\t// skip for styles don\'t need\n\t\t\tif (style != 0 &&  style != 5 && style != 7)\n\t\t\tfor (int x = -steps; x <= steps; x++) \n\t\t\tfor (int y = -steps; y <= steps; y++)\n\t\t\tfor (int z = -steps; z <= steps; z++)\n\t\t\t{\n\t\t\t\t// Start search at the cell that contains the closest point to "x" (found in 1st pass)\n\t\t\t\tivec3 b = mb + ivec3(x, y, z);\n\t\t\t\tvec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;\n\t\t\t\tfloat d1 = dot(0.5 * (mr + r), (r - mr)); \t\t\t\t// IQ normalizes "r - mr" but that breaks things for the smooth version?\n\t\t\t\tfloat d2 = dot(0.5 * (mr + r), normalize(r - mr));\n\n\t\t\t\te_smooth = smin(d1, e_smooth, smoothness);\n\n\t\t\t\te = min(e, d2);\n\n\t\t\t\t// Also compute a smooth version of F2 in this pass\n\t\t\t\t{\n\t\t\t\t\tivec3 b = ivec3(x, y, z);\n\t\t\t\t\tif (b != mb) \n\t\t\t\t\t{\n\t\t\t\t\t\tvec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;\n\t\t\t\t\t\tfloat d = length(r);\n\n\t\t\t\t\t\tf2_smooth = smin(d, f2_smooth, smoothness);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Different visualization modes \n\t\t\tif (style == 0) \n\t\t\t{\n\t\t\t\treturn f1_smooth;\n\t\t\t}\n\t\t\tif (style == 1) \n\t\t\t{\n\t\t\t\treturn f2_smooth;\n\t\t\t}\n\t\t\tif (style == 2) \n\t\t\t{\n\t\t\t\treturn f2_smooth - f1_smooth;\n\t\t\t\t\n\t\t\t\t// "Pebbles" also cool\n\t\t\t\t//return step(0.2, f2_smooth - f1_smooth);\n\t\t\t}\n\t\t\tif (style == 3) \n\t\t\t{\n\t\t\t\t// This one is really good for rock / stone effects\n\t\t\t\tfloat a = f1; \n\t\t\t\tfloat b = f2;\n\t\t\t\tfloat k = 3.0;\n\t\t\t\tfloat h = max(k - abs(a - b), 0.0) / k;\n\t\t\t\tfloat final = min(a, b) - h * h * k * (1.0 / 4.0);\n\t\t\t\treturn final;\n\t\t\t}\n\t\t\tif (style == 4) \n\t\t\t{\n\t\t\t\t// Some random adjustments to make this style stand out more \n\t\t\t\treturn exp(5.0 * e_smooth);\n\t\t\t}\n\t\t\tif (style == 5) \n\t\t\t{\n\t\t\t\treturn pow(f1_smooth, 3.0);\n\t\t\t}\n\t\t\tif (style == 6) \n\t\t\t{\t\t\t\t\n\t\t\t\tconst float eps = 0.0125;\n\n\t\t\t\t// Thicker lines as the user increases the smoothness slider\n\t\t\t\tfloat thickness = smoothness * 0.25 + eps;\n\n\t\t\t\t// Blurrier lines as the user increases the smoothness slider\n\t\t\t\tfloat blur = pow(smoothness, 3.0) * 0.25 + eps;\n\n\t\t\t\treturn smoothstep(\n\t\t\t\t\tthickness - thickness * blur, \n\t\t\t\t\tthickness + thickness * blur, \n\t\t\t\t\te\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (style == 7) \n\t\t\t{\n\t\t\t\treturn hashwithoutsine13(vec3(p + mb) + seed);\n\t\t\t}\n\t\t}\n\t',[f,p,m,g,v,y])}}(),nee=class extends H9{constructor(e,t,r,n,i,s,a,o,l,c,u,h,d,f,p,m,g,v,y){super("v3"),this.nodeType="Noise",this.scale=e,this.size=t,this.move=r,this.fA=n,this.fB=i,this.distortion=s,this.colorA=a,this.colorB=o,this.colorC=l,this.colorD=c,this.noiseType=h,this.voronoiStyle=f,this.highCut=p,this.lowCut=m,this.smoothness=g,this.seed=v,this.quality=y,this.isMask=d,this.alpha=u,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t,r,n,i){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let s=["simplexFast","simplexFractal","simplexAshima","fbm","perlin","voronoi"][this.noiseType.value],a="voronoi"==s?"\n\t\tfloat v = ".concat(s,'(st + move, voronoiStyle, smoothness, seed, quality);\n\n\t\t// Apply clipping to colors\n\t\tv = remap(v, lowCut, highCut, 0.0, 1.0);\n\t\tv = smax(v, 0.0, smoothness * 0.25);\n\t\tv = smin(v, 1.0, smoothness * 0.25);\n\n\t\t// Note that the voronoi mode only uses colors "A" and "C" from the UI \n\t\tvec4 color = mix(colorA, colorC, v); \n\t\t'):"\n\t\tvec3 q = vec3(".concat(s,"(st),\n\t\t\t\t\t   ").concat(s,"(st + vec3(1.0)),\n\t\t\t\t\t   ").concat(s,"(st + vec3(1.0)));\n\t\tvec3 r = vec3(").concat(s,"(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),\n\t\t\t\t\t  ").concat(s,"(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), \n\t\t\t\t\t  ").concat(s,"(st * q));\n\t\tfloat f = ").concat(s,"(st + r);\n\t\tvec4 color;\n\t\tcolor = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));\n\t\tcolor = mix(color, colorC, clamp(length(q), 0.0, 1.0));\n\t\tcolor = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));\n\t\t"),o=new Z9("vec3 ".concat(s,"customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) \n\t\t\t{\n                // Prevent scale of zero \n\t\t\t\tscale = max(abs(scale), 0.001);\n\n\t\t\t\tvec3 st = position / size;\n\t\t\t\tst /= scale;\n\n\t\t\t\t").concat(a,"\n\n\t\t\t\tfloat lalpha = alpha * color.a * mask;\n\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn clamp(color, 0.0, 1.0).rgb;\n\t\t\t}"),[ree.simplexFast,ree.simplexFractal,ree.simplexAshima,ree.fbm,ree.perlin,ree.voronoi]),l=e.include(o),c=[];return c.push(this.scale.build(e,"f")),c.push(this.size.build(e,"v3")),c.push(this.move.build(e,"f")),c.push(this.fA.build(e,"v2")),c.push(this.fB.build(e,"v2")),c.push(this.distortion.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.colorC.build(e,"v4")),c.push(this.colorD.build(e,"v4")),c.push(this.voronoiStyle.build(e,"i")),c.push(this.highCut.build(e,"f")),c.push(this.lowCut.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.seed.build(e,"f")),c.push(this.quality.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}};nee.numOctaves=5;var iee=class extends H9{constructor(e,t,r,n,i,s,a,o,l,c,u,h,d,f,p,m){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=e,this.contourColor=t,this.outlineWidth=r,this.contourWidth=n,this.contourThreshold=i,this.outlineThreshold=s,this.contourFrequency=a,this.outlineSmoothing=o,this.contourDirection=l,this.positionalLines=c,this.compensation=u,this.resolution=h,this.normalMap=d,this.depthMap=f,this.pixelRatio=p,this.alpha=m,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){let r="g".concat(this.uuid.toString().replace(/-/g,""));if(e.require("vWorldViewDir"),e.require("worldNormal"),e.extensions.derivatives=!0,this.compensation.value&&e.define("OUTLINE_COMPENSATION","".concat(r,"_offset")),this.firstTime){let t=this.outlineWidth.build(e,"f"),n=this.resolution.build(e,"v2"),i=this.compensation.build(e,"b"),s=this.pixelRatio.build(e,"f");e.addVertexParsVariable("randomColor","attribute vec3"),e.addVertexParsVariable("extrudeNormal","attribute vec3"),e.addVertexParsVariable(t,"uniform float"),e.addVertexParsVariable(n,"uniform vec2"),e.addVertexParsVariable(i,"uniform bool"),e.addVertexParsVariable(s,"uniform float"),e.addVertexParsVariable("vID","flat out float"),e.addFragmentParsVariable("vID","flat in float"),e.addVertexFinalCode("\n                vID = randomColor.r;\n                vec2 ".concat(r,"_offset = vec2(0.0);\n                if (").concat(i,") {\n                    vec4 ").concat(r,"_clipPosition = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));\n                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the\n                    // normals face the camera directly. So we hackily fix this by offsetting the normal\n                    // by a tiny amount.\n                    vec3 ").concat(r,"_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;\n                    ").concat(r,"_offset = normalize(").concat(r,"_clipNormal.xy) / ").concat(n," * (").concat(t," / 2.0) * ").concat(r,"_clipPosition.w * 2.0 * ").concat(s,";\n                    ").concat(r,"_clipPosition.xy += ").concat(r,"_offset;\n                    // TODO(MAX): To handle multiple outline layers, we only want to extrude\n                    // if this offset is the biggest of all the potential offsets\n                    gl_Position = ").concat(r,"_clipPosition;\n                }\n            "))}if(e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(iee.Nodes.outline),n=[];return n.push(this.outlineColor.build(e,"c")),n.push(this.contourColor.build(e,"c")),n.push(this.outlineWidth.build(e,"f")),n.push(this.contourWidth.build(e,"f")),n.push(this.contourThreshold.build(e,"f")),n.push(this.outlineThreshold.build(e,"f")),n.push(this.contourFrequency.build(e,"f")),n.push(this.outlineSmoothing.build(e,"f")),n.push(this.contourDirection.build(e,"v3")),n.push(this.positionalLines.build(e,"b")),n.push(this.resolution.build(e,"v2")),n.push(this.normalMap.getTexture(e,"t")),n.push(this.depthMap.getTexture(e,"t")),n.push(this.pixelRatio.build(e,"f")),n.push(this.compensation.build(e,"b")),n.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),this.firstTime=!this.firstTime,e.format(r+"("+n.join(",")+")",this.getType(e),t)}return console.warn("OutlineNode is not compatible with "+e.shader+" shader."),""}},see=iee;see.Nodes=function(){let e=new Z9("\nfloat sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)\n{\n    vec2 halton = haltonSequence[frameIndex];\n    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n    float temporalAngle  = temporalOffset * PI2;\n\n    vec2 texelSize = (vec2(1.0) / resolution);\n    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;\n\n    vec2 uvSamples[9];\n    vec4 normalSamples[9];\n\n\tuvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);\n\tuvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);\n\tuvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);\n\tuvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);\n\tuvSamples[4] = uv;\n\tuvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);\n\tuvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);\n\tuvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);\n\tuvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);\n\n\n    normalSamples[0] = texture2D(t, uvSamples[0]);\n    normalSamples[1] = texture2D(t, uvSamples[1]);\n    normalSamples[2] = texture2D(t, uvSamples[2]);\n    normalSamples[3] = texture2D(t, uvSamples[3]);\n    normalSamples[4] = texture2D(t, uvSamples[4]);\n    normalSamples[5] = texture2D(t, uvSamples[5]);\n    normalSamples[6] = texture2D(t, uvSamples[6]);\n    normalSamples[7] = texture2D(t, uvSamples[7]);\n    normalSamples[8] = texture2D(t, uvSamples[8]);\n\n    float depthBias = 0.0001;\n    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!\n    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n\n    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);\n  \tvec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);\n\n    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));\n    return edgeNormal;\n}\n");return{outline:new Z9("vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {\n                vec3 result = outlineColor;\n                float resultAlpha = 0.0;\n\n                vec3 N = normalize(vWNormal);\n                vec2 nuv = (gl_FragCoord.xy / resolution);\n                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);\n                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);\n\n                //resultAlpha = 1.0;\n                //result = vec3(sobelSample);\n\n                float t = 1.0 - contourThreshold;\n                if(positionalLines) {\n                    vec3 NDir = position * contourDirection;\n                    float NT = NDir.x + NDir.y + NDir.z;\n                    float f  = fract(NT * contourFrequency * 0.01);\n                    float df = fwidth(NT * contourFrequency);\n\n                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);\n                    if (g < 1.0 && resultAlpha == 0.0) {\n                        result = contourColor;\n                        resultAlpha = 1.0;\n                    }\n                 }\n                 else {\n                    vec3 NDir = N * contourDirection;\n                    float NT = NDir.x + NDir.y + NDir.z;\n                    float df = fwidth(NT * contourThreshold);\n                    float f = sin(NT * 1.0 * contourFrequency);\n                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);\n\n                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {\n                        result = contourColor;\n                        resultAlpha = 1.0 - g;\n                    }\n                 }\n\n                 float lalpha = alpha * resultAlpha * mask;\n                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;\n\t\t\t\t \n                 return result;\n             }",[e])}}();var aee=class extends H9{constructor(e,t,r,n,i,s,a,o,l,c,u,h,d,f,p,m,g,v){super("v3"),this.nodeType="Pattern",this.style=e,this.projection=t,this.axis=r,this.blending=n,this.offset=i,this.colorA=s,this.colorB=a,this.frequency=o,this.size=l,this.variation=c,this.smoothness=u,this.zigzag=h,this.rotation=d,this.vertical=f,this.horizontal=p,this.sides=m,this.isMask=v,this.alpha=g,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.isShader("fragment")){let r;switch(e.require("position"),e.require("uv"),e.requires.uv=[!0],e.require("normal"),e.requires.normal=!0,e.addFragmentVariable(this.calpha,"float"),this.style.value){case 0:default:r="circle";break;case 1:r="ring";break;case 2:r="polygon";break;case 3:r="xcross";break;case 4:r="diamond";break;case 5:r="checkerboard";break;case 6:r="line";break;case 7:r="wave"}let n="g".concat(this.uuid.toString().replace(/-/g,"")),i=new Z9("float hashwithoutsine12(vec2 p)\n\t\t\t\t{\n\t\t\t\t\tvec3 p3 = fract(vec3(p.xyx) * .1031);\n\t\t\t\t\tp3 += dot(p3, p3.yzx + 33.33);\n\t\t\t\t\treturn fract((p3.x + p3.y) * p3.z);\n\t\t\t\t}"),s=new Z9("vec2 rotate_uv(in vec2 uv, float a, bool repeat) \n\t\t\t\t{\n\t\t\t\t\tconst float mid = 0.5;\n\t\t\t\t\tfloat radians = a * (PI / 180.0);\n\t\t\t\t\tvec2 rotated = vec2(\n\t\t\t\t\t\tcos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,\n\t\t\t\t\t\tcos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid\n\t\t\t\t\t);\n\t\t\t\t\treturn repeat ? fract(rotated): rotated;\n\t\t\t\t}"),a="";if(4===this.projection.value){let e=2===this.style.value?"".concat(r,"(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)"):"".concat(r,"(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)"),t=2===this.style.value?"".concat(r,"(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)"):"".concat(r,"(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)"),n=2===this.style.value?"".concat(r,"(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)"):"".concat(r,"(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)");a="\n\t\t\t\tvec3 p = position;\n\t\t\t\tfloat factor = 0.0125;\n\t\t\t\tvec2 uv0 = fract(p.xy * factor);\n\t\t\t\tvec2 uv1 = fract(p.zy * factor);\n\t\t\t\tvec2 uv2 = fract(p.xz * factor);\n\t\t\t\t\n\t\t\t\tuv0 = rotate_uv(uv0 + offset, rotation, true);\n\t\t\t\tuv1 = rotate_uv(uv1 + offset, rotation, true);\n\t\t\t\tuv2 = rotate_uv(uv2 + offset, rotation, true);\n\t\n\t\t\t\tfloat d0 = ".concat(e,";\n\t\t\t\tfloat d1 = ").concat(t,";\n\t\t\t\tfloat d2 = ").concat(n,";\n\t\t\t\t\n\t\t\t\t// Range from 3 to 128 seems to be good\n\t\t\t\tfloat exponent = (1.0 - blending) * 125.0 + 3.0;\n\n\t\t\t\tvec3 n = vObjectNormal;\n\t\t\t\tvec3 weights = abs(normalize(n));\n\t\t\t\tweights = pow(weights, vec3(exponent));\n\t\t\t\tweights /= dot(weights, vec3(1.0));\n\t\t\t\td0 *= weights.z;\n\t\t\t\td1 *= weights.x;\n\t\t\t\td2 *= weights.y;\n\t\t\t\tfloat draw = d0 + d1 + d2;\n\t\n\t\t\t\tvec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;\n\t\t\t\t")}else{let e=2===this.style.value?"".concat(r,"(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)"):"".concat(r,"(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)"),t="";0===this.axis.value?t="float radius = length(p);\n\t\t\t\t\tfloat theta = atan(p.y, p.z);\n\t\t\t\t\tfloat phi = acos(p.x / radius);":1===this.axis.value?t="float radius = length(p);\n\t\t\t\t\tfloat theta = atan(p.x, p.z);\n\t\t\t\t\tfloat phi = acos(p.y / radius);":(this.axis.value,t="float radius = length(p);\n\t\t\t\t\tfloat theta = atan(p.y, p.x);\n\t\t\t\t\tfloat phi = acos(p.z / radius);");let n="";switch(this.projection.value){case 0:n="custom_uv = vUv.st;";break;case 1:case 3:default:break;case 2:n="\n\t\t\t\t\t\t\tvec3 p = position;\n\t\t\t\t\t\t\t".concat(t,"\n\t\t\t\t\t\t\tcustom_uv = vec2(theta, phi);\n\t\t\t\t\t\t\tcustom_uv /= PI;\n\t\t\t\t\t\t\t")}a="\n\t\t\t\tvec2 custom_uv;\n\t\t\t\t".concat(n,"\n\t\n\t\t\t\tcustom_uv += offset;\n\t\t\t\tcustom_uv = fract(custom_uv);\n\t\t\t\tcustom_uv = rotate_uv(custom_uv, rotation, true);\n\t\n\t\t\t\tfloat draw = ").concat(e,";\n\t\t\t\t")}let o=new Z9("vec3 ".concat(n,"_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {\n\t\t\t\t\tconst float TWO_PI = PI * 2.0;\n\t\t\t\t\tfloat smoothness_remapped = pow(smoothness, 5.0);\t\n\n\t\t\t\t\t").concat(a,"\n\n\t\t\t\t\t// Construct final output color\n\t\t\t\t\tvec4 color = mix(colorA, colorB, draw);\n\t\t\t\t\tcolor.a = clamp(color.a, 0.0, 1.0);\n\n\t\t\t\t\t// Apply cuts\n\t\t\t\t\tcolor.a *= \n\t\t\t\t\t\tstep(vertical.x, custom_uv.y) * \n\t\t\t\t\t\tstep(custom_uv.y, vertical.y);\n\t\t\t\t\tcolor.a *= \n\t\t\t\t\t\tstep(horizontal.x, abs(custom_uv.x)) * \n\t\t\t\t\t\tstep(abs(custom_uv.x), horizontal.y);\n\n\t\t\t\t\t// Accumulate alpha \n\t\t\t\t\tfloat lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;\n\t\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\t\treturn clamp(color, 0.0, 1.0).rgb;\n\t\t\t\t}"),[s,i,aee.DrawFunctions.circle,aee.DrawFunctions.ring,aee.DrawFunctions.polygon,aee.DrawFunctions.cross,aee.DrawFunctions.diamond,aee.DrawFunctions.checkerboard,aee.DrawFunctions.line,aee.DrawFunctions.wave]),l=e.include(o),c=[];return c.push("normal"),c.push(this.blending.build(e,"f")),c.push(this.style.build(e,"i")),c.push(this.offset.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.frequency.build(e,"v2")),c.push(this.size.build(e,"f")),c.push(this.variation.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.zigzag.build(e,"f")),c.push(this.rotation.build(e,"f")),c.push(this.vertical.build(e,"v2")),c.push(this.horizontal.build(e,"v2")),c.push(this.sides.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}return console.warn("PatterNode is not compatible with "+e.shader+" shader."),e.format("vec3(0.0)",this.getType(e),t)}},oee=aee;oee.DrawFunctions=function(){let e=new Z9("float hashwithoutsine12(vec2 p) {\n\t\t\t\tvec3 p3 = fract(vec3(p.xyx) * 0.1031);\n\t\t\t\tp3 += dot(p3, p3.yzx + 33.33);\n\t\t\t\treturn fract((p3.x + p3.y) * p3.z);\n\t\t\t}"),t=new Z9("vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {\n                // Create tiles in UV-space\n                uv *= frequency;\n\n                // Integer coords\n                vec2 i = floor(uv);\n\n                // Offset every other row based on zigzag param, then compute fractional coords\n                float row_offset = mod(i.y, 2.0);\n                uv.x += row_offset * zigzag;\n                vec2 f = fract(uv);\n\n\t\t\t\t// Rotate the tile itself:\n\t\t\t\t// const float mid = 0.5;\n\t\t\t\t// f = vec2(\n\t\t\t\t// \tcos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,\n\t\t\t\t// \tcos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid\n\t\t\t\t// );\n\t\t\t\t// f = fract(f);\n\n                f = f * 2.0 - 1.0;\n\n\t\t\t\t// Recompute integer coords after shifting - then, random value per tile \n\t\t\t\ti = floor(uv);\n\t\t\t\tfloat rand = (hashwithoutsine12(i) * 5.0 + 1.0);\n\t\t\t\tfloat jitter = mix(1.0, rand, variation);\n\t\t\t\tf *= jitter;\n\n                return f;\n            }",[e]);return{tileAndCenter:t,circle:new Z9("float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n                return smoothstep(\n                    -smoothness, \n                     smoothness, \n                     length(f) - size\n                );\n            }",[t]),ring:new Z9("float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n\n\t\t\t\tfloat d = length(f);\n                const float inner_width = 0.5;\n\n                float outer = smoothstep(-smoothness, smoothness, d - size);\n                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);\n\t\t\t\treturn outer + (1.0 - inner);   \n            }",[t]),polygon:new Z9("float sdf_ngon(in vec2 p, in float r, in int n) {\n                float an = (PI * 2.0) / float(n);\n                float he = r * tan(0.5 * an);\n                \n                // Rotate to first sector\n                p = -p.yx; \n                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);\n                vec2  cs = vec2(cos(bn), sin(bn));\n                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;\n            \n                // Side of polygon\n                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);\n            }\n            \n            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));\n            }",[t]),cross:new Z9("float sdf_cross(in vec2 p, in vec2 b, float r ) {\n                p = abs(p); \n\t\t\t\tp = (p.y > p.x) ? p.yx : p.xy;\n                vec2  q = p - b;\n                float k = max(q.y, q.x);\n                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);\n                return sign(k) * length(max(w, 0.0)) + r;\n            }\n            \n            // Avoid namespace conflicts \n            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));\n            }",[t]),diamond:new Z9("float ndot(vec2 a, vec2 b) { \n                return a.x*b.x - a.y*b.y; \n            }\n            \n            float sdf_diamond(in vec2 p, in vec2 b) {\n                p = abs(p);\n                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);\n                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));\n                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);\n            }\n\n            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n\t            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));\n            }",[t]),checkerboard:new Z9("float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                uv *= frequency;\n                vec2 i = floor(uv);\n\n                float offset = mod(i.y, 2.0);\n\n                uv.x += offset + zigzag * offset;\n                float x = floor(uv.x);\n                \n                return mod(x, 2.0);\n            }"),line:new Z9("float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);\n\t\t\t\t\n\t\t\t\t// Different approach for variation param here\n\t\t\t\tfloat row = floor(uv * frequency).y;\n\t\t\t\tfloat rand = hashwithoutsine12(vec2(row));\n\t\t\t\tfloat s = mix(size, size * rand, variation);\n\n\t\t\t\treturn smoothstep(\n\t\t\t\t\ts - smoothness, \n\t\t\t\t\ts + smoothness, \n\t\t\t\t\tabs(f.y)\n\t\t\t\t);\n            }",[t]),wave:new Z9("// Uses bisection \n            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {\n                // Convert all data to a primitive cosine wave\n                p = c * (p - vec2(d, a));\n                \n                const float TWO_PI = PI * 2.0;\n\n                // Reduce to principal half cycle\n                p.x = mod(p.x, TWO_PI); \n                if (p.x > PI) {\n                    p.x = TWO_PI - p.x;\n                }\n            \n                // Find zero of derivative (minimize distance)\n                float xa = 0.0;\n                float xb = TWO_PI;\n\n                // 24 bit precision\n                for (int i = 0; i < 24; i++) {\n                    float x = 0.5 * (xa + xb);\n                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));\n                    if (y < 0.0) xa = x; \n                    else xb = x;\n                }\n                float x = 0.5 * (xa + xb);\n                \n                // Compute distance    \n                vec2 q = vec2(x, b * c * cos(x));\n                return length(p - q) / c;\n            }\n\n            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                float repeat = frequency.x;\n                uv *= repeat;\n                vec2 i = floor(uv);\n                float row_offset = mod(i.y, 2.0);\n                uv.x += row_offset * zigzag;\n                vec2 f = vec2(uv.x, fract(uv.y));\n\n                // Generalized cosine: y(x) = a + b * cos(cx + d)\n                const float amplitude = 0.125;\n                float wave_frequency = frequency.y * 0.1;\n                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);\n\n\t\t\t\t// Different approach for variation param here\n\t\t\t\tfloat rand = hashwithoutsine12(vec2(i.y));\n\t\t\t\tfloat s = mix(size, size * rand, variation);\n\n                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);\n            }")}}();var lee=class extends H9{constructor(e,t,r,n,i,s,a,o){super("v3"),this.nodeType="Rainbow",this.filmThickness=e,this.movement=t,this.wavelengths=r,this.noiseStrength=n,this.noiseScale=i,this.offset=s,this.isMask=o,this.alpha=a,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(lee.Nodes.rainbow),n=[];return n.push(this.filmThickness.build(e,"f")),n.push(this.movement.build(e,"f")),n.push(this.wavelengths.build(e,"v3")),n.push(this.noiseStrength.build(e,"f")),n.push(this.noiseScale.build(e,"f")),n.push(this.offset.build(e,"v3")),n.push(this.isMask.build(e,"b")),n.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(r+"("+n.join(",")+")",this.getType(e),t)}return console.warn("RainbowNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},cee=lee;cee.Nodes=function(){let e=new Z9("vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {\n\t\t\t\tfloat f = 0.0;\n\t\t\t\t\n\t\t\t\tif (noiseStrength != 0.0) {\n\t\t\t\t\tvec3 st = position / noiseScale;\n\t\t\t\t\tfloat noise = simplexFast(1.6 * st + vec3(1.8, 1.5, 1.9) * simplexFast(st) + vec3(1.7, 9.2, 1.0));\n\t\t\t\t\tf = noise * noiseStrength;\n\t\t\t\t}\n\n\t\t\t\tvec3 waves = wavelengths * vec3(1.0, 0.8, 0.6) + 1.0;\n\t\t\t\tfloat angle = dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal));\n\n\t\t\t\tmediump vec3 color = cos((((filmThickness + f) / waves) * angle) + movement);\n\t\t\t\treturn .5 + .5 * color;\n\t\t\t }",[ree.simplexFast]);return{rainbow:new Z9("vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {\n\t\t\t\tmediump vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);\n\n\t\t\t\tfloat rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);\n\n\t\t\t\tfloat lalpha = alpha * rainbowContribution * mask;\n\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn res;\n\t\t\t }",[e])}}();var uee=class extends H9{constructor(e,t,r,n,i,s,a,o,l,c){super("v3"),this.nodeType="Toon",this.positioning=e,this.colors=t,this.steps=r,this.source=n,this.isWorldSpace=i,this.noiseStrength=s,this.noiseScale=a,this.shadowColor=o,this.offset=l,this.alpha=c,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.require("worldNormal"),e.require("worldPosition"),e.isShader("fragment")){e.define("COLORS_MAX",10),e.addFragmentVariable(this.calpha,"float");let r=e.include(uee.Nodes.toon),n=[];return n.push(this.positioning.build(e,"i")),n.push(this.colors.build(e,"v4[]")),n.push(this.steps.build(e,"f[]")),n.push(this.source.build(e,"v3")),n.push(this.isWorldSpace.build(e,"b")),n.push(this.noiseStrength.build(e,"f")),n.push(this.noiseScale.build(e,"f")),n.push(this.shadowColor.build(e,"v4")),n.push(this.offset.build(e,"v3")),n.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(r+"("+n.join(",")+")",this.getType(e),t)}return console.warn("ToonNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},hee=uee;hee.Nodes=function(){let e=new Z9("float rand(float n) {\n\t\t\t\treturn fract(sin(n) * 43758.5453123);\n\t\t\t}"),t=new Z9("float hash1(float p) { \n\t\t\t\tp = fract(p * 0.011); \n\t\t\t\tp *= p + 7.5; \n\t\t\t\tp *= p + p; \n\t\t\t\treturn fract(p); \n\t\t\t}"),r=new Z9("float valueNoise(vec3 x) {\n\t\t\t\tconst vec3 step = vec3(110, 241, 171);\n\t\t\t\n\t\t\t\tvec3 i = floor(x);\n\t\t\t\tvec3 f = fract(x);\n\t\t\t \n\t\t\t\t// For performance, compute the base input to a 1D hash from the integer part of the argument and the \n\t\t\t\t// incremental change to the 1D based on the 3D -> 1D wrapping\n\t\t\t\tfloat n = dot(i, step);\n\t\t\t\n\t\t\t\tvec3 u = f * f * (3.0 - 2.0 * f);\n\t\t\t\treturn mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),\n\t\t\t\t\t\t\t   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),\n\t\t\t\t\t\t   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),\n\t\t\t\t\t\t\t   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);\n\t\t\t}",[t]),n=new Z9("vec3 hash3(vec3 x) {\n\t\t\t\tx = vec3(dot(x,vec3(127.1, 311.7, 74.7)),\n\t\t\t\t\t\t dot(x,vec3(269.5, 183.3, 246.1)),\n\t\t\t\t\t\t dot(x,vec3(113.5, 271.9, 124.6)));\n\t\t\t\n\t\t\t\treturn fract(sin(x)*43758.5453123);\n\t\t\t}"),i=new Z9('vec3 voronoiNoise(in vec3 x)\n\t\t\t{\n\t\t\t\tvec3 p = floor(x);\n\t\t\t\tvec3 f = fract(x);\n\n\t\t\t\tfloat id = 0.0;\n\t\t\t\tvec2 res = vec2(100.0);\n\n\t\t\t\tfor(int k=-1; k<=1; k++)\n\t\t\t\tfor(int j=-1; j<=1; j++)\n\t\t\t\tfor(int i=-1; i<=1; i++)\n\t\t\t\t{\n\t\t\t\t\tvec3 b = vec3(float(i), float(j), float(k));\n\n\t\t\t\t\t// Comment out the "+ hash(p + b);" part below to get "square" cells\n\t\t\t\t\tvec3 r = vec3(b) - f + hash3(p + b);\n\t\t\t\t\tfloat d = dot(r, r);\n\n\t\t\t\t\tif (d < res.x)\n\t\t\t\t\t{\n\t\t\t\t\t\tid = dot(p + b, vec3(1.0, 57.0, 113.0));\n\t\t\t\t\t\tres = vec2(d, res.x);\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\telse if (d < res.y)\n\t\t\t\t\t{\n\t\t\t\t\t\tres.y = d;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn vec3(sqrt(res), abs(id));\n\t\t\t}\n\t\t\t',[n]);return{toon:new Z9('vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {\n\t\t\t\tfloat t = 0.0;\n\t\t\t\tfloat shadow = 1.0;\n\n\t\t\t\tif (positioning == 0) {\n\n\t\t\t\t\t// Can\'t do this mode if lighting is "none"\n\t\t\t\t\t#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))\n\n\t\t\t\t\t\t// Algorithm from Chapter 10 of Graphics Shaders\n\t\t\t\t\t\tconst vec3 weights = vec3(0.2125, 0.7154, 0.0721);\n\t\t\t\t\t\tvec3 lpos;\n\t\t\t\t\t\tvec3 l;\n\t\t\t\t\t\tfloat dproduct;\n\n\t\t\t\t\t\t#if (NUM_POINT_LIGHTS > 0)\n\n\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)\n\t\t\t\t\t\t\t\tPointLightShadow pointLightShadow;\n\t\t\t\t\t\t\t#endif \n\n\t\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\t\tfor (int i = 0; i < NUM_POINT_LIGHTS; i++) {\n\t\t\t\t\t\t\t\t// Light positions are in view-space for some reason?\n\t\t\t\t\t\t\t\tlpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;\n\t\t\t\t\t\t\t\tl = normalize(lpos - worldPosition);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tdproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// TODO: we want to use "intensity" but it isn\'t available in the shader code\n\t\t\t\t\t\t\t\t//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);\n\n\t\t\t\t\t\t\t\tt = max(t, dproduct);\n\n\t\t\t\t\t\t\t\t// Accumulate shadow contribution\n\t\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)\n\t\t\t\t\t\t\t\t\tpointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];\n\t\t\t\t\t\t\t\t\tshadow *= getPointShadow( \n\t\t\t\t\t\t\t\t\t\t\tpointShadowMap[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowMapSize, \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowBias, \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowRadius,\n\t\t\t\t\t\t\t\t\t\t\tvPointShadowCoord[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowCameraNear, \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowCameraFar);\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t#pragma unroll_loop_end\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t#if NUM_DIR_LIGHTS > 0 \n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)\n\t\t\t\t\t\t\t\tDirectionalLightShadow directionalLightShadow;\n\t\t\t\t\t\t\t#endif \n\n\t\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\t\tfor (int i = 0; i < NUM_DIR_LIGHTS; i++) {\n\t\t\t\t\t\t\t\t// Use the direction vector for directional lights instead\n\t\t\t\t\t\t\t\tl = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;\n\t\t\n\t\t\t\t\t\t\t\tdproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;\n\t\t\t\t\t\t\t\tt = max(t, dproduct);\n\n\t\t\t\t\t\t\t\t// Accumulate shadow contribution\n\t\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)\n\t\t\t\t\t\t\t\t\tdirectionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];\n\t\t\t\t\t\t\t\t\tshadow *= getShadow( \n\t\t\t\t\t\t\t\t\t\tUNROLLED_LOOP_INDEX,\n\t\t\t\t\t\t\t\t\t\tdirectionalShadowMap[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\tdirectionalLightShadow.shadowMapSize, \n\t\t\t\t\t\t\t\t\t\tdirectionalLightShadow.shadowBias, \n\t\t\t\t\t\t\t\t\t\tdirectionalLightShadow.shadowRadius, \n\t\t\t\t\t\t\t\t\t\tvDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t#pragma unroll_loop_end\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t#if NUM_SPOT_LIGHTS > 0 \n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)\n\t\t\t\t\t\t\t\tSpotLightShadow spotLightShadow;\n\t\t\t\t\t\t\t#endif \n\n\t\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\t\tfor (int i = 0; i < NUM_SPOT_LIGHTS; i++) {\n\t\t\t\t\t\t\t\tlpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;\n\t\t\t\t\t\t\t\tl = normalize(lpos - worldPosition);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tdproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;\n\t\t\t\t\t\t\t\tt = max(t, dproduct);\n\n\t\t\t\t\t\t\t\t// Accumulate shadow contribution\n\t\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)\n\t\t\t\t\t\t\t\t\tspotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];\n\t\t\t\t\t\t\t\t\tshadow *= getShadow(\n\t\t\t\t\t\t\t\t\t\tUNROLLED_LOOP_INDEX,\n\t\t\t\t\t\t\t\t\t\tspotShadowMap[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\tspotLightShadow.shadowMapSize, \n\t\t\t\t\t\t\t\t\t\tspotLightShadow.shadowBias, \n\t\t\t\t\t\t\t\t\t\tspotLightShadow.shadowRadius, \n\t\t\t\t\t\t\t\t\t\tvSpotLightCoord[UNROLLED_LOOP_INDEX]);\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t#pragma unroll_loop_end\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\tt = clamp(t, 0.0, 1.0);\n\t\t\t\t\n\t\t\t\t\t#endif\n\n\t\t\t\t} else if (positioning == 1) {\n\t\t\t\t\t\n\t\t\t\t\tvec3 origin = mix(position, worldPosition, float(isWorldSpace));\n\t\t\t\t\tvec3 direction = normalize(source - origin);\n\t\t\t\t\tt = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;\t\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvec3 origin = worldPosition;\n\t\t\t\t\tvec3 source = cameraPosition - offset;\n\t\t\t\t\tvec3 direction = normalize(source - origin);\n\t\t\t\t\tt = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;\t\n\t\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\tif (noiseStrength > 0.0) {\n\t\t\t\t\t// Distort with noise\n\t\t\t\t\tvec3 st = position / noiseScale;\n\t\t\t\t\t\n\t\t\t\t\t// Voronoi "smooth" noise\n\t\t\t\t\tfloat noise = 1.0 - voronoiNoise(st).x;\n\n\t\t\t\t\t// Voronoi cellular noise\n\t\t\t\t\t//float noise = 1.0 - rand(voronoiNoise(st).z);\n\n\t\t\t\t\t// Position warp noise\n\t\t\t\t\t// vec3 offset = vec3(\n\t\t\t\t\t// \tsimplexFast(st),\n\t\t\t\t\t// \tsimplexFast(st + vec3(111.1, 143.89, 217.19)),\n\t\t\t\t\t// \tsimplexFast(st + vec3(171.1, 247.89, 117.23))\n\t\t\t\t\t// );\n\t\t\t\t\t// st += offset;\n\t\t\t\t\t// float noise = valueNoise(st);\n\n\t\t\t\t\tt += noise * noiseStrength;\n\t\t\t\t}\n\n\t\t\t\tt = clamp(t, 0.0, 1.0);\n\n\t\t\t\t// Compute ramp color\n\t\t\t\tfloat p;\n\t\t\t\tvec4 color = colors[0];\n\t\t\t\tfor (int i = 1; i < COLORS_MAX; i++) {\n\t\t\t\t\tp = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);\n\t\t\t\t\tcolor = mix(color, colors[i], smoothstep(0.0, 1.0, p));\n\t\t\t\t}\n\n\t\t\t\t// Incorporate custom shadow color\n\t\t\t\tif (positioning == 0) {\n\n\t\t\t\t\tvec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);\n\t\t\t\t\tcolor.rgb = mix(blendedShadow, color.rgb, shadow);\n\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\t// Accumulate alpha as usual\n\t\t\t\tfloat lalpha = alpha * color.a * mask;\n\t\t\t\tcalpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha;\n\n\t\t\t\treturn color.xyz;\n\n            }',[ree.simplexFast,e,r,i])}}();var dee={textureBicubic:new Z9("float w0( float a ) {\n            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n        }\n    \n        float w1( float a ) {\n            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n        }\n    \n        float w2( float a ){\n            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n        }\n    \n        float w3( float a ) {\n            return ( 1.0 / 6.0 ) * ( a * a * a );\n        }\n    \n        // g0 and g1 are the two amplitude functions\n        float g0( float a ) {\n            return w0( a ) + w1( a );\n        }\n    \n        float g1( float a ) {\n            return w2( a ) + w3( a );\n        }\n    \n        // h0 and h1 are the two offset functions\n        float h0( float a ) {\n            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n        }\n    \n        float h1( float a ) {\n            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n        }\n    \n        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n            uv = uv * texelSize.zw + 0.5;\n    \n            vec2 iuv = floor( uv );\n            vec2 fuv = fract( uv );\n    \n            float g0x = g0( fuv.x );\n            float g1x = g1( fuv.x );\n            float h0x = h0( fuv.x );\n            float h1x = h1( fuv.x );\n            float h0y = h0( fuv.y );\n            float h1y = h1( fuv.y );\n    \n            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n    \n            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + \n                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n        }\n\n        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n            vec2 fLodSizeInv = 1.0 / fLodSize;\n            vec2 cLodSizeInv = 1.0 / cLodSize;\n            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n            return mix( fSample, cSample, fract( lod ) );\n        }")};var fee=class extends H9{constructor(e,t,r,n,i,s,a,o){super("v3"),this.nodeType="Transmission",this.thickness=e,this.ior=t,this.roughness=r,this.transmissionSamplerSize=n,this.transmissionSamplerMap=i,this.transmissionDepthMap=s,this.aspectRatio=a,this.alpha=o,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0,e.isShader("fragment")){e.define("NUM_SAMPLES",6),e.define("BLUR_SLOD",Math.pow(2,yee.transmissionLod.value)),e.require("worldPosition"),e.requires.worldNormal=!0,e.requires.modelMatrix=!0,e.requires.projectionMatrix=!0,e.addFragmentVariable(this.calpha,"float");let r=e.include(fee.Nodes.transmission),n=[];return n.push(this.thickness.build(e,"f")),n.push(this.ior.build(e,"f")),n.push(this.roughness.build(e,"f")),n.push(this.transmissionSamplerSize.build(e,"v2")),n.push(this.transmissionSamplerMap.getTexture(e,"t")),n.push(this.transmissionDepthMap.getTexture(e,"t")),n.push(this.aspectRatio.build(e,"v2")),n.push("normal"),n.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(r+"("+n.join(",")+")",this.getType(e),t)}return console.warn("TransmissionNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},pee=fee;pee.Nodes=function(){let e=new Z9("vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {\n                // Slightly modified version of this:\n                // https://www.shadertoy.com/view/ltScRG\n\n\t\t\t\t// Special case for blur == 0.0\n\t\t\t\tif (lod == 0.0) {\n\t\t\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\t\treturn texture2DLodEXT( sp, U, 0.0).rgb;\n\t\t\t\t\t#else\n\t\t\t\t\treturn textureLod( sp, U, 0.0).rgb;\n\t\t\t\t\t#endif\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvec2 texelSize = vec2(1.0) / resolution;\n                vec2 halton = haltonSequence[frameIndex];\n                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n                float temporalAngle  = temporalOffset * PI2;\n\t\t\t\tvec3 res = vec3(0.0);\n                vec2 uv = vec2(0.0);\n                vec2 offset = vec2(0.0);\n                vec2 vogelSample = vec2(0.0);\n                for (int i = 0; i < NUM_SAMPLES; i++) {\n                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;\n                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20\n                    uv = U + offset;\n                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));\n                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {\n                        uv = unrefractedU;\n                        lod = lod > 4.0 ? lod : lod / 2.0;\n                    }\n                    res += textureLod(sp, uv, lod).rgb;\n                }\n                return res / float(NUM_SAMPLES);\n            }"),t=new Z9("vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\t\t        // Direction of refracted light.\n\t\t        vec3 refractionVector = refract( -v,  n, 1.0 / ior );\n\t\t        \n\t\t\t\t// Compute rotation-independant scaling of the model matrix.\n\t\t        vec3 modelScale;\n\t\t        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\t        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\t        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\n\t\t        // The thickness is specified in local space\n\t\t        return normalize( refractionVector ) * thickness * modelScale;\n\t        }"),r=new Z9("float applyIorToRoughness( float roughness, float ior ) {\n\t\t\t\t// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and\n\t\t\t\t// an IOR of 1.5 results in the default amount of microfacet refraction.\n\t\t\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t\t\t}"),n=new Z9('vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {\n\t\t\t\t// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see\n\t\t\t\t// also the code in convertTransmission.ts, which runs during export\n\t\t\t\t#ifdef IS_THREEJS_EXPORT\n\t\t\t\t\tfloat lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);\n\t\t\t\t\treturn textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;\n\t\t\t\t#else\n\t\t\t\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t\t\t\tfloat lod = applyIorToRoughness(roughness, ior);\n\t\t\t\t\treturn blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);\n\t\t\t\t#endif\n\t\t\t}',[dee.textureBicubic,r,e]),i=new Z9("vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\n\t\t\t\t// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\n\t\t\t\tvec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );\n\t\t\t\tvec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;\n\t\t\t\tunrefractedCoords += 1.0;\n\t\t\t\tunrefractedCoords /= 2.0;\n\n\t\t\t\t// Sample framebuffer to get pixel the refracted ray hits.\n\t\t\t\treturn getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );\n    \t\t}",[n,t]);return{transmission:new Z9("vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {\n                vec3 v = vec3(0.);\n                if (isOrthographic) {\n                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n                } else {\n                    v = normalize(vWPosition - cameraPosition);\n                }\n                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );\n                \n\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * alpha;\n\n\t\t\t\treturn transmission;\n            }",[i])}}();var mee=(e=>(e.NOISE="noise",e.MAP="map",e))(mee||{}),gee=class extends H9{constructor(e,t,r,n,i,s,a,o,l,c,u){super("v3"),this.displacementTypeIndex=new D7(0),this.nodeType="VertexDisplacement",this.intensity=e,this.movementOrTexture=t,"map"===Object.values(mee)[this.displacementTypeIndex.value]&&(this.mat=new B7(this.movementOrTexture.value.matrix)),this.cropOrOffset=r,this.scale=c,this.noiseFunctionIndex=u,this.voronoiStyle=n,this.smoothness=i,this.seed=s,this.highCut=a,this.lowCut=o,this.quality=l}generate(e,t){if(e.isShader("vertex")){e.define("USE_LAYER_DISPLACE");let r,n=[];switch(n.push("displaced_position"),n.push("displaced_normal"),Object.values(mee)[this.displacementTypeIndex.value]){case"map":r=e.include(gee.Nodes.map),n.push(this.movementOrTexture.getTexture(e,"t")),n.push("uv"),n.push(this.cropOrOffset.build(e,"f")),this.mat&&n.push(this.mat.build(e,"mat3"));break;case"noise":{let t=["simplexPrecise","simplexFractal","simplexAshima","fbm","perlin","voronoi"][this.noiseFunctionIndex.value],i=new Z9("vec3 orthogonal(vec3 v) {\n\t\t\t\t\t\t\treturn normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));\n\t\t\t\t\t\t}"),s="voronoi"==t?"\n\t\t\t\t\tfloat v = ".concat(t,"((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);\n\t\t\t\t\tv = remap(v, lowCut, highCut, 0.0, 1.0);\n\t\t\t\t\tv = smax(v, 0.0, smoothness * 0.25);\n\t\t\t\t\tv = smin(v, 1.0, smoothness * 0.25);\n\n\t\t\t\t\treturn p + n * v * intensity;\n\t\t\t\t\t"):"\n\t\t\t\t\treturn p + n * ".concat(t,"((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;\n\t\t\t\t\t"),a=new Z9("vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {\n\t\t\t\t\t\t\t".concat(s,"\n\t\t\t\t\t\t}"),[ree.simplexPrecise,ree.simplexFractal,ree.simplexAshima,ree.fbm,ree.perlin,ree.voronoi]),o=new Z9("vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {\n\t\t\t\t\t\t\tvec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);\n\t\t\t\t\t\t\tvec3 tangent1 = orthogonal(normal);\n\t\t\t\t\t\t\tvec3 tangent2 = normalize(cross(normal, tangent1));\n\n                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.\n                            // This caused some small oval/circular visual artifacts in the lighting.\n                            // For now, simply using neighbors further away betters the problem,\n                            // but we should figure out the underlying cause when we have some time.\n                            // Maybe its related to how we calculate the tangent and bitangent?\n\t\t\t\t\t\t\tvec3 nearby1 = position + tangent1;\n\t\t\t\t\t\t\tvec3 nearby2 = position + tangent2;\n\t\t\t\t\t\t\tvec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);\n\t\t\t\t\t\t\tvec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);\n\t\t\t\t\t\t\tdisplaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));\n\t\t\t\t\t\t\treturn displaced_position;\n\t\t\t\t\t\t}",[a,i]);r=e.include(o),n.push(this.scale.build(e,"f")),n.push(this.cropOrOffset.build(e,"v3")),n.push(this.movementOrTexture.build(e,"f")),n.push(this.voronoiStyle.build(e,"i")),n.push(this.smoothness.build(e,"f")),n.push(this.seed.build(e,"f")),n.push(this.highCut.build(e,"f")),n.push(this.lowCut.build(e,"f")),n.push(this.quality.build(e,"i"));break}}return n.push(this.intensity.build(e,"f")),n.push("displaced_normal"),e.format(r+"("+n.join(",")+")",this.getType(e),t)}return console.warn("VertexDisplacementNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},vee=gee;vee.Nodes=function(){let e=new Z9("vec3 orthogonal(vec3 v) {\n\t\t\t\treturn normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));\n\t\t\t}"),t=new Z9("float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {\n\t\t\t\tvec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;\n\t\t\t\tvec4 tmp = texture2D(tex, uvs);\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tif (crop > 0.5) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\treturn 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn col.r;\n\t\t\t}");return{map:new Z9("vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {\n\t\t\t\tvec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;\n\t\t\t\tvec3 tangent1 = normalize(orthogonal(normal));\n\t\t\t\tvec3 tangent2 = normalize(cross(normal, tangent1));\n\t\t\t\tvec3 nearby1 = position + tangent1 * 0.1;\n\t\t\t\tvec3 nearby2 = position + tangent2 * 0.1;\n\t\t\t\tvec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;\n\t\t\t\tvec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;\n\t\t\t\tdisplaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));\n\t\t\t\treturn displaced_position;\n\t\t\t}",[e,t])}}();var yee={normalRenderTarget:new l7,normalRenderTargetDepth:new l7,transmissionRenderTarget:new l7,aspectRatio:new G9,transmissionSize:new G9(2048,2048),transmissionRenderTargetDepth:new l7,aoRenderTarget:new l7,aoEnabled:new I7,pixelRatioNode:new c7(1),resolution:new G9,penumbraSize:new O7(5,.5),frameIndex:new D7(0),transmissionLod:new D7(2)};for(let r of Object.values(yee))r.isRenderGlobal=!0;var bee,wee={skiaWasmUrl:"https://unpkg.com/@splinetool/ui-wasm@1.9.59/build/ui.wasm"},xee=class extends j9{constructor(){super("basic"),this.nodeType="Basic",this.color=new k7(n1),this.shadingAlpha=new c7(1),this.shadingBlend=new D7(0),this.previousModelViewMatrix=new z7,this.previouseProjectionMatrix=new z7}get category(){return"phong"}generate(e){let t;if(e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:yee.frameIndex}),e.mergeUniform({resolution:yee.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(CF.merge([HF.fog])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>"].join("\n"));let n=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = normal;\n\n\t\t\t\t#if defined( USE_LAYER_DISPLACE )\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif /* !USE_LAYER_DISPLACE */\n\t\t\t\t"];r&&n.push(r.code,r.result?"displaced_position = "+r.result+";":""),n.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","\tvNormal = transformedNormal;","#endif"),n.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join("\n")}else{void 0===this.color&&(this.color=new k7(n1)),this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"});let r=this.color.flow(e,"c",{slot:"color"}),n=this.alpha?this.alpha.flow(e,"f"):void 0,i=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,s=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0;e.requires.transparent=void 0!==n,e.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join("\n"));let a=["#include <normal_fragment_begin>",r.code];n&&a.push(n.code,"#ifdef ALPHATEST"," if ( "+n.result+" <= ALPHATEST ) discard;","#endif"),s?a.push(s.code,"vec3 outgoingLight = ".concat(r.result,";"),"vec3 finalColor = spe_blend(outgoingLight, ".concat(s.result,", 1.0, SPE_BLENDING_NORMAL);")):a.push("vec3 finalColor = ".concat(r.result,";"));let o="1.0";this.mask&&(this.mask.analyze(e),o="luminance(".concat(this.mask.flow(e,"v3").result,")")),n?a.push("gl_FragColor = vec4( finalColor, accumAlpha * ".concat(n.result," * ").concat(o," );")):a.push("gl_FragColor = vec4("+r.result+", 1.0 );"),i&&a.push("gl_FragColor.a *= ".concat(i.result,";")),a.push("#include <fog_fragment>","#include <dithering_fragment>"),t=a.join("\n")}return t}},See=class extends j9{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new k7(n1),this.emissive=new k7(0),this.emissiveIntensity=new c7(1),this.previousModelViewMatrix=new z7,this.previouseProjectionMatrix=new z7,this.shadingAlpha=new c7(1),this.shadingBlend=new D7(0),this.occlusion=new I7(!0)}get category(){return"lambert"}build(e){let t;if(e.define("LAMBERT"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:yee.frameIndex}),e.mergeUniform({resolution:yee.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(CF.merge([HF.fog,HF.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","\tvarying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let n=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = objectNormal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];r&&n.push(r.code,r.result?"displaced_position = "+r.result+";":""),n.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("\t#include <project_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\n\t\t\t\t\tvec3 diffuse = vec3( 1.0 );\n\t\t\t\t\tGeometricContext geometry;\n\t\t\t\t\tgeometry.position = mvPosition.xyz;\n\t\t\t\t\tgeometry.normal = normalize( transformedNormal );\n\t\t\t\t\tgeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\n\t\t\t\t"),n.push("\n\t\t\t\t\tGeometricContext backGeometry;\n\t\t\t\t\tbackGeometry.position = geometry.position;\n\t\t\t\t\tbackGeometry.normal = -geometry.normal;\n\t\t\t\t\tbackGeometry.viewDir = geometry.viewDir;\n\t\t\t\t\tvLightFront = vec3( 0.0 );\n\t\t\t\t\tvIndirectFront = vec3( 0.0 );\n\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\tvLightBack = vec3( 0.0 );\n\t\t\t\t\t\tvIndirectBack = vec3( 0.0 );\n\t\t\t\t\t#endif\n\t\t\t\t\tIncidentLight directLight;\n\t\t\t\t\tfloat dotNL;\n\t\t\t\t\tvec3 directLightColor_Diffuse;\n\t\t\t\t\tvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\n\t\t\t\t\tvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\t\t\t\t\t\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_POINT_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_SPOT_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_DIR_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_HEMI_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join("\n")}else{e.mergeUniform({penumbraSize:yee.penumbraSize}),e.mergeUniform({frameIndex:yee.frameIndex}),e.mergeUniform({aoMap:yee.aoRenderTarget}),e.mergeUniform({aoEnabled:yee.aoEnabled}),void 0===this.color&&(this.color=new k7(n1)),this.color.analyze(e,{slot:"color"}),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),n=this.emissive.flow(e,"c",{slot:"emissive"}),i=this.emissiveIntensity.flow(e,"f",{slot:"emissive"}),s=this.occlusion.flow(e,"b",{slot:"occlusion"}),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=void 0!==c,e.addParsCode(["uniform float penumbraSize[".concat(5,"];"),"uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","\tvarying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join("\n"));let h=["#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx, viewdy));\n\t\t\t\tbool isFrontFacing = (dot(normal, faceNormal) >= 0.0);\n\t\t\t\t","#include <clipping_planes_fragment>"];h.push(r.code,"vec3 diffuseColor = "+r.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),c&&h.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),h.push("#ifdef DOUBLE_SIDED","\treflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","\treflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","\treflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","\treflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),n&&h.push(n.code,"reflectedLight.directDiffuse += "+n.result+" * "+i.result+";"),h.push("vec3 ao = aoEnabled && "+s.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let d="1.0";this.mask&&(this.mask.analyze(e),d="luminance(".concat(this.mask.flow(e,"v3").result,")")),h.push("\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ".concat(a.result," * ").concat(d," * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ").concat(a.result," * ").concat(d,", ").concat(o.result," );\n\n\t\t\t\t\toutgoingLight *= ao;\n\t\t\t\t}\n\t\t\t\t")),l&&h.push(l.code,"outgoingLight = spe_blend(outgoingLight, ".concat(l.result,", 1.0, SPE_BLENDING_NORMAL);")),c?h.push("gl_FragColor = vec4( outgoingLight, accumAlpha * ".concat(c.result," );")):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&h.push("gl_FragColor.a *= ".concat(u.result,";")),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join("\n")}return t}},_ee={dHdxy:new Z9("vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {\n\n            // Gradient of UVs w.r.t. X coordinate (in screen-space)\n            vec2 dSTdx = dFdx(bumpMapUv);\n\n            // Gradient of UVs w.r.t. Y coordinate (in screen-space)\n            vec2 dSTdy = dFdy(bumpMapUv);\n            \n            // Forward differencing\n            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);\n            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;\n            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;\n            \n            return vec2( dBx, dBy );\n        }"),perturbNormalArb:new Z9("vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n            vec3 vSigmaX = dFdx( surf_pos.xyz );\n            vec3 vSigmaY = dFdy( surf_pos.xyz );\n            vec3 vN = surf_norm; // normalized\n            \n            vN = normalize(vN);\n\n            vec3 R1 = cross( vSigmaY, vN );\n            vec3 R2 = cross( vN, vSigmaX );\n\n            R1 = normalize(R1);\n            R2 = normalize(R2);\n    \n            float fDet = dot( vSigmaX, R1 ) * faceDirection;\n    \n            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n            return normalize( abs( fDet ) * vN - vGrad );\n        }")},Cee=class extends j9{constructor(){super("phong"),this.nodeType="Phong",this.color=new k7(n1),this.specular=new k7(1118481),this.shininess=new c7(30),this.previousModelViewMatrix=new z7,this.previouseProjectionMatrix=new z7,this.shadingAlpha=new c7(1),this.shadingBlend=new D7(0),this.occlusion=new I7(!0)}get category(){return"phong"}build(e){let t;if(e.define("PHONG"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:yee.frameIndex}),e.mergeUniform({resolution:yee.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(CF.merge([HF.fog,HF.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let n=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = objectNormal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];r&&n.push(r.code,r.result?"displaced_position = "+r.result+";":""),n.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("\t#include <project_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join("\n")}else{e.mergeUniform({penumbraSize:yee.penumbraSize}),e.mergeUniform({frameIndex:yee.frameIndex}),e.mergeUniform({aoMap:yee.aoRenderTarget}),e.mergeUniform({aoEnabled:yee.aoEnabled}),void 0===this.color&&(this.color=new k7(n1)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e);let r=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let n=this.color.flow(e,"c",{slot:"color"}),i=this.specular.flow(e,"c"),s=this.shininess.flow(e,"f"),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=void 0!==c,e.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[".concat(5,"];"),"uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join("\n"));let h=["#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx,viewdy));\n\t\t\t\tif (dot(normal, faceNormal) < 0.0) {\n\t\t\t\t\tnormal *= -1.0;\n\t\t\t\t}\n\t\t\t\t","\tBlinnPhongMaterial material;"];if(this.bumpMap){e.include(_ee.dHdxy),e.include(_ee.perturbNormalArb);let t=this.bumpMap.texture.flow(e,"t"),r=this.bumpMap.flow(e,"v3"),n=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",i="";i=4===this.bumpMap.projection.value?"\n\t\t\t\t\tvec3 bumpNormal = vec3(0.0);\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_triplanarWeights;\n\n\t\t\t\t\t\tvec2 grad0 = dHdxy(").concat(t.result,", uv0, ").concat(n,");\n\t\t\t\t\t\tvec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);\n\n\t\t\t\t\t\tvec2 grad1 = dHdxy(").concat(t.result,", uv1, ").concat(n,");\n\t\t\t\t\t\tvec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);\n\n\t\t\t\t\t\tvec2 grad2 = dHdxy(").concat(t.result,", uv2, ").concat(n,");\n\t\t\t\t\t\tvec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;\n\t\t\t\t\t\tbumpNormal = normalize(bumpNormal);\n\t\t\t\t\t}\n\n\t\t\t\t\tnormal = bumpNormal;\n\t\t\t\t\t"):"\n\t\t\t\t\tvec2 bumpMapCachedUv = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs;\n\t\t\t\t\tvec2 grad = dHdxy(").concat(t.result,", bumpMapCachedUv, ").concat(n,");\n\t\t\t\t\tnormal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );\n\t\t\t\t\t"),h.push("// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t".concat(r.result,";\n\t\t\t\t\t").concat(i,"\n\t\t\t\t\t"))}h.push(n.code,"\tvec3 diffuseColor = "+n.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","\tvec3 totalEmissiveRadiance = emissive;",i.code,"\tvec3 specular = "+i.result+";",s.code,"\tfloat shininess = max( 0.0001, "+s.result+" );","\tfloat specularStrength = 1.0;"),c&&h.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),h.push("material.diffuseColor = diffuseColor;"),h.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h.push("vec3 ao = aoEnabled && "+r.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let d="1.0";this.mask&&(this.mask.analyze(e),d="luminance(".concat(this.mask.flow(e,"v3").result,")")),h.push("\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ".concat(a.result," * ").concat(d," * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ").concat(a.result," * ").concat(d,", ").concat(o.result," );\n\t\t\t\t\t\n\t\t\t\t\toutgoingLight *= ao;\n\t\t\t\t}\n\t\t\t\t")),l&&h.push(l.code,"outgoingLight = spe_blend(outgoingLight, ".concat(l.result,", 1.0, SPE_BLENDING_NORMAL);")),c?h.push("gl_FragColor = vec4( outgoingLight, accumAlpha * ".concat(c.result,");")):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&h.push("gl_FragColor.a *= ".concat(u.result,";")),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join("\n")}return t}},Eee=class extends j9{constructor(){super("standard"),this.nodeType="Standard",this.color=new k7(n1),this.roughness=new c7(.3),this.metalness=new c7(0),this.reflectivity=new c7(.5),this.previousModelViewMatrix=new z7,this.previouseProjectionMatrix=new z7,this.shadingAlpha=new c7(1),this.shadingBlend=new D7(0),this.occlusion=new I7(!0)}get category(){return"physical"}build(e){let t;if(e.define("STANDARD"),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:yee.frameIndex}),e.mergeUniform({resolution:yee.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(CF.merge([HF.fog,HF.lights])),HF.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let n=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = objectNormal;\n\n\t\t\t\t#if defined( USE_LAYER_DISPLACE )\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif /* !USE_LAYER_DISPLACE */\n\t\t\t\t"];r&&n.push(r.code,r.result?"displaced_position = "+r.result+";":""),n.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join("\n")}else{e.mergeUniform({penumbraSize:yee.penumbraSize}),e.mergeUniform({frameIndex:yee.frameIndex}),e.mergeUniform({aoMap:yee.aoRenderTarget}),e.mergeUniform({aoEnabled:yee.aoEnabled});let r={gamma:!0};void 0===this.color&&(this.color=new k7(n1)),this.color.analyze(e,{slot:"color",context:r}),this.roughness.analyze(e),this.metalness.analyze(e);let n=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.reflectivity&&this.reflectivity.analyze(e);let i=this.color.flow(e,"c",{slot:"color",context:r}),s=this.roughness.flow(e,"f"),a=this.metalness.flow(e,"f"),o=this.shadingAlpha.flow(e,"f"),l=this.shadingBlend.flow(e,"i"),c=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,u=this.alpha?this.alpha.flow(e,"f"):void 0,h=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,d=this.reflectivity?this.reflectivity.flow(e,"f"):void 0;e.requires.transparent=void 0!==u,e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[".concat(5,"];"),"uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join("\n"));let f=["#include <clipping_planes_fragment>","\t#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx,viewdy));\n\t\t\t\tif (dot(normal, faceNormal) < 0.0) {\n\t\t\t\t\tnormal *= -1.0;\n\t\t\t\t}\n\t\t\t\t","\tPhysicalMaterial material;","\tmaterial.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){e.include(_ee.dHdxy),e.include(_ee.perturbNormalArb);let t=this.bumpMap.texture.flow(e,"t"),r=this.bumpMap.flow(e,"v3"),n=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",i="";i=4===this.bumpMap.projection.value?"\n\t\t\t\t\tvec3 bumpNormal = vec3(0.0);\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_triplanarWeights;\n\n\t\t\t\t\t\tvec2 grad0 = dHdxy(").concat(t.result,", uv0, ").concat(n,");\n\t\t\t\t\t\tvec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);\n\n\t\t\t\t\t\tvec2 grad1 = dHdxy(").concat(t.result,", uv1, ").concat(n,");\n\t\t\t\t\t\tvec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);\n\n\t\t\t\t\t\tvec2 grad2 = dHdxy(").concat(t.result,", uv2, ").concat(n,");\n\t\t\t\t\t\tvec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;\n\t\t\t\t\t\tbumpNormal = normalize(bumpNormal);\n\t\t\t\t\t}\n\n\t\t\t\t\tnormal = bumpNormal;\n\t\t\t\t\t"):"\n\t\t\t\t\tvec2 bumpMapCachedUv = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs;\n\t\t\t\t\tvec2 grad = dHdxy(").concat(t.result,", bumpMapCachedUv, ").concat(n,");\n\t\t\t\t\tnormal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );\n\t\t\t\t\t"),f.push("// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t".concat(r.result,";\n\t\t\t\t\t").concat(i,"\n\t\t\t\t\t"))}if(f.push(i.code,"\tvec3 diffuseColor = "+i.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",a.code,"\tfloat metalnessFactor = "+a.result+";"),this.roughnessMap){let t=this.roughnessMap.texture.flow(e,"t"),r=this.roughnessMap.flow(e,"v3"),n="";n=4===this.roughnessMap.projection.value?"\n\t\t\t\t\tfloat roughnessChange = 1.0;\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g".concat(this.roughnessMap.uuid.toString().replace(/-/g,""),"_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g").concat(this.roughnessMap.uuid.toString().replace(/-/g,""),"_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g").concat(this.roughnessMap.uuid.toString().replace(/-/g,""),"_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g").concat(this.roughnessMap.uuid.toString().replace(/-/g,""),"_triplanarWeights;\n\n\t\t\t\t\t\tfloat r0 = luminance(texture(").concat(t.result,", uv0).rgb) * roughnessScale;\n\t\t\t\t\t\tfloat r1 = luminance(texture(").concat(t.result,", uv1).rgb) * roughnessScale;\n\t\t\t\t\t\tfloat r2 = luminance(texture(").concat(t.result,", uv2).rgb) * roughnessScale;\n\n\t\t\t\t\t\troughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);\n\t\t\t\t\t}\n\t\t\t\t\tfloat roughnessFactor = roughnessChange * ").concat(s.result,";\n\t\t\t\t\t"):"\n\t\t\t\t\tvec2 roughnessMapCachedUv = g".concat(this.roughnessMap.uuid.toString().replace(/-/g,""),"_writeUvs;\n\n\t\t\t\t\tvec4 vals = texture(").concat(t.result,",  roughnessMapCachedUv);\n\t\t\t\t\tfloat roughnessFactor = luminance(vals.rgb) * ").concat(s.result,";\n\t\t\t\t\t"),f.push("// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t".concat(r.result,";\n\n\t\t\t\t\tconst float roughnessScale = 1.0;\n\n\t\t\t\t\t").concat(n,"\n\t\t\t\t"))}else f.push(s.code,"\tfloat roughnessFactor = "+s.result+";");u&&f.push(u.code,"#ifdef ALPHATEST","\tif ( "+u.result+" <= ALPHATEST ) discard;","#endif"),f.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),f.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),d?f.push(d.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+d.result+" ) ), diffuseColor, metalnessFactor );"):f.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),f.push("#include <lights_fragment_begin>"),f.push("#include <lights_fragment_end>"),f.push("vec3 ao = aoEnabled && "+n.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let p="1.0";this.mask&&(this.mask.analyze(e),p="luminance(".concat(this.mask.flow(e,"v3").result,")")),f.push("\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ".concat(o.result," * ").concat(p," * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ").concat(o.result," * ").concat(p,", ").concat(l.result," );\n\t\t\t\t\t\n\t\t\t\t\toutgoingLight *= ao;\n\t\t\t\t}\n\t\t\t\t")),c&&f.push(c.code,"outgoingLight = spe_blend(outgoingLight, ".concat(c.result,", 1.0, SPE_BLENDING_NORMAL);")),u?f.push("gl_FragColor = vec4( outgoingLight, accumAlpha * ".concat(u.result," );")):f.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h&&f.push("gl_FragColor.a *= ".concat(h.result,";")),f.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=f.join("\n")}return t}},Aee=class extends j9{constructor(){super("toon"),this.nodeType="Toon",this.color=new k7(n1),this.specular=new k7(1118481),this.shininess=new c7(30),this.previousModelViewMatrix=new z7,this.previouseProjectionMatrix=new z7,this.shadingAlpha=new c7(1),this.shadingBlend=new D7(0)}get category(){return"toon"}build(e){let t;if(e.define("TOON"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:yee.frameIndex}),e.mergeUniform({resolution:yee.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(CF.merge([HF.fog,HF.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let n=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = objectNormal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];r&&n.push(r.code,r.result?"displaced_position = "+r.result+";":""),n.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("\t#include <project_vertex>","\t#include <fog_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join("\n")}else{e.mergeUniform({penumbraSize:yee.penumbraSize}),e.mergeUniform({frameIndex:yee.frameIndex}),e.mergeUniform({aoMap:yee.aoRenderTarget}),e.mergeUniform({aoEnabled:yee.aoEnabled}),void 0===this.color&&(this.color=new k7(n1)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),n=this.specular.flow(e,"c"),i=this.shininess.flow(e,"f"),s=this.shadingAlpha.flow(e,"f"),a=this.shadingBlend.flow(e,"i"),o=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=void 0!==l,e.addParsCode(["uniform float penumbraSize[".concat(5,"];"),"uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>","\n\t\t\t\t\tvarying vec3 vViewPosition;\n\t\t\t\t\tstruct ToonMaterial {\n\t\t\t\t\t\tvec3\tdiffuseColor;\n\t\t\t\t\t\tvec3\tspecularColor;\n\t\t\t\t\t\tfloat\tspecularShininess;\n\t\t\t\t\t\tfloat\tspecularStrength;\n\t\t\t\t\t};\n\t\t\t\t\tvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\t\t\t\t\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t\t\t\n\t\t\t\t\t\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\t\t\t\t\t\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n\t\t\t\t\t}\n\t\t\t\t\tvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\t\t\t\t\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\t\t\t\t\t}\n\t\t\t\t\t#define RE_Direct\t\t\t\tRE_Direct_Toon\n\t\t\t\t\t#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n\t\t\t\t\t#define Material_LightProbeLOD( material )\t(0)\n\t\t\t\t\t","#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join("\n"));let u=["#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx,viewdy));\n\t\t\t\tif (dot(normal, faceNormal) < 0.0) {\n\t\t\t\t\tnormal *= -1.0;\n\t\t\t\t}\n\t\t\t\t","\tToonMaterial material;"];if(this.bumpMap){e.include(_ee.dHdxy),e.include(_ee.perturbNormalArb);let t=this.bumpMap.texture.flow(e,"t"),r=this.bumpMap.flow(e,"v3"),n=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",i="";i=4===this.bumpMap.projection.value?"\n\t\t\t\t\tvec3 bumpNormal = vec3(0.0);\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_triplanarWeights;\n\n\t\t\t\t\t\tvec2 grad0 = dHdxy(").concat(t.result,", uv0, ").concat(n,");\n\t\t\t\t\t\tvec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);\n\n\t\t\t\t\t\tvec2 grad1 = dHdxy(").concat(t.result,", uv1, ").concat(n,");\n\t\t\t\t\t\tvec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);\n\n\t\t\t\t\t\tvec2 grad2 = dHdxy(").concat(t.result,", uv2, ").concat(n,");\n\t\t\t\t\t\tvec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;\n\t\t\t\t\t\tbumpNormal = normalize(bumpNormal);\n\t\t\t\t\t}\n\n\t\t\t\t\tnormal = bumpNormal;\n\t\t\t\t\t"):"\n\t\t\t\t\tvec2 bumpMapCachedUv = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs;\n\t\t\t\t\tvec2 grad = dHdxy(").concat(t.result,", bumpMapCachedUv, ").concat(n,");\n\t\t\t\t\tnormal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );\n\t\t\t\t\t"),u.push("// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t".concat(r.result,";\n\t\t\t\t\t").concat(i,"\n\t\t\t\t\t"))}u.push(r.code,"\tvec3 diffuseColor = "+r.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",n.code,"\tvec3 specular = "+n.result+";",i.code,"\tfloat shininess = max( 0.0001, "+i.result+" );","\tfloat specularStrength = 1.0;"),l&&u.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),u.push("material.diffuseColor = diffuseColor;"),u.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),u.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let h="1.0";this.mask&&(this.mask.analyze(e),h="luminance(".concat(this.mask.flow(e,"v3").result,")")),u.push("\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ".concat(s.result," * ").concat(h," * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ").concat(s.result," * ").concat(h,", ").concat(a.result," );\n\t\t\t\t}\n\t\t\t\t")),o&&u.push(o.code,"outgoingLight = spe_blend(outgoingLight, ".concat(o.result,", 1.0, SPE_BLENDING_NORMAL);")),l?u.push("gl_FragColor = vec4( outgoingLight, accumAlpha * ".concat(l.result," );")):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&u.push("gl_FragColor.a *= ".concat(c.result,";")),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=u.join("\n")}return t}},Mee=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4;this.timeout=e,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(){}remove(e){let t=this.cache.get(e);t&&(this.dispose(e,t.data),this.cache.delete(e),t.prev.next=t.next,t.next.prev=t.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout((()=>{this.hasClean=!1,this.log("cleaning");let e=Date.now(),t=this.head.next;for(;t.time<e-this.timeout;)this.dispose(t.src,t.data),this.cache.delete(t.src),t=t.next,t.prev=this.head,this.head.next=t;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")}),this.timeout+1e3))}has(e){var t;return null===(t=this.cache.get(e))||void 0===t?void 0:t.data}load(e){let t=Date.now(),r=this.cache.get(e);return void 0===r?(r={data:this.create(e),src:e,time:t,next:null,prev:null},this.cache.set(e,r)):(r.time=t,r.prev.next=r.next,r.next.prev=r.prev),r.prev=this.tail.prev,r.next=this.tail,this.tail.prev.next=r,this.tail.prev=r,this.scheduleCleanup(),r.data}},Tee=class extends Mee{create(e){return URL.createObjectURL(new Blob([e]))}dispose(e,t){URL.revokeObjectURL(t)}};var Pee=class{constructor(e,t){this.data=e,this.cache=t,this.refCount=0}deref(){this.refCount,this.refCount-=1,0===this.refCount&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount,0}},kee=class{constructor(){this.cache=new Map}remove(e){this.cache.delete(e.data),0}load(e){let t=this.cache.get(e);return void 0===t&&(t=this.create(e),this.cache.set(e,t)),t.refCount+=1,t}},Dee=class extends Pee{constructor(e,t){super(e,t.imageHolderCache),this.data=e,this.shared=t,this.loaded=!1,this.isVideo=!1,this.isBuffer=!1,this._cache={1e3:{},1001:{},1002:{}},this.isVideo="video"===e.type,this.isBuffer=!0===e.isWebGLRenderTarget,this.loadPromise=this.updateSrc(this.isBuffer?e:e.data)}async updateSrc(e){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let t=()=>{this.loaded=!0;for(let e of Object.values(this._cache))for(let t of Object.values(e))for(let e of Object.values(t))e&&(e.image=this.img,e.needsUpdate=!0);this.shared.requestRender()};if(this.isBuffer)this.img=e,this.loaded=!0;else if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,"string"!=typeof e){var r=new FileReader;let t;r.readAsDataURL(new Blob([e],{type:"video/mp4"})),await new Promise((e=>{r.onloadend=r=>{var n;t=null===(n=r.target)||void 0===n?void 0:n.result,e(null)}})),this.img.src=t}else this.img.src=e;this.img.onloadeddata=()=>{t()}}else this.img=new Image,this.img.src=function(e){return"string"==typeof e?e:(bee||(bee=new Tee),bee.load(e))}(e),this.img.onload=t,await new Promise((e=>{this.img.onload=()=>{t(),e(null)}}))}getTexture(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1008,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1006,i=null===(t=this._cache[e])||void 0===t||null===(t=t[r])||void 0===t?void 0:t[n];if(i)return i;{let t;return t=this.isBuffer?this.img.texture:this.isVideo?new WV(this.img,void 0,e,e):new _B(this.img,void 0,e,e,n,r),this.loaded&&(t.needsUpdate=!0),void 0===this._cache[e]&&(this._cache[e]={}),void 0===this._cache[e][r]&&(this._cache[e][r]={}),this._cache[e][r][n]=t,t}}setNeedsUpdate(e){for(let t of Object.values(this._cache))for(let r of Object.values(t))for(let t of Object.values(r))t&&(t.needsUpdate=e)}disposeTextures(){for(let[e,t]of Object.entries(this._cache))for(let[r,n]of Object.entries(t))for(let[t,i]of Object.entries(n))null!==i&&void 0!==i&&i.dispose(),void 0!==this._cache[e]&&void 0!==this._cache[e][r]&&(this._cache[e][r][t]=void 0)}dispose(){super.dispose(),this.disposeTextures()}},Iee=class extends Dee{};function Oee(e,t){var r=function(e){if(!Lee[e]){var t=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:"America/New_York",year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),r="06/25/2014, 00:00:00"===t||"\u200e06\u200e/\u200e25\u200e/\u200e2014\u200e \u200e00\u200e:\u200e00\u200e:\u200e00"===t;Lee[e]=r?new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return Lee[e]}(t);return r.formatToParts?function(e,t){try{for(var r=e.formatToParts(t),n=[],i=0;i<r.length;i++){var s=Ree[r[i].type];s>=0&&(n[s]=parseInt(r[i].value,10))}return n}catch(T0){if(T0 instanceof RangeError)return[NaN];throw T0}}(r,e):function(e,t){var r=e.format(t).replace(/\u200E/g,""),n=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(r);return[n[3],n[1],n[2],n[4],n[5],n[6]]}(r,e)}var Ree={year:0,month:1,day:2,hour:3,minute:4,second:5};var Lee={};function Nee(e,t,r,n,i,s,a){var o=new Date(0);return o.setUTCFullYear(e,t,r),o.setUTCHours(n,i,s,a),o}var Bee=36e5,zee={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-]\d{2}):?(\d{2})$/};function Fee(e,t,r){var n,i,s;if(!e||(n=zee.timezoneZ.exec(e)))return 0;if(n=zee.timezoneHH.exec(e))return Uee(s=parseInt(n[1],10))?-s*Bee:NaN;if(n=zee.timezoneHHMM.exec(e)){s=parseInt(n[1],10);var a=parseInt(n[2],10);return Uee(s,a)?(i=Math.abs(s)*Bee+6e4*a,s>0?-i:i):NaN}if(function(e){if(Vee[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),Vee[e]=!0,!0}catch(t){return!1}}(e)){t=new Date(t||Date.now());var o=r?t:function(e){return Nee(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}(t),l=jee(o,e),c=r?l:function(e,t,r){var n=e.getTime(),i=n-t,s=jee(new Date(i),r);if(t===s)return t;i-=s-t;var a=jee(new Date(i),r);return s===a?s:Math.max(s,a)}(t,l,e);return-c}return NaN}function jee(e,t){var r=Oee(e,t),n=Nee(r[0],r[1]-1,r[2],r[3]%24,r[4],r[5],0).getTime(),i=e.getTime(),s=i%1e3;return n-(i-=s>=0?s:1e3+s)}function Uee(e,t){return-23<=e&&e<=23&&(null==t||0<=t&&t<=59)}var Vee={};var Hee=yL(SL(),1),Wee=yL(_L(),1),Gee=36e5,qee=6e4,Xee={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/};function Yee(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(null===e)return new Date(NaN);var r=t||{},n=null==r.additionalDigits?2:(0,Hee.default)(r.additionalDigits);if(2!==n&&1!==n&&0!==n)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e))return new Date(e.getTime());if("number"==typeof e||"[object Number]"===Object.prototype.toString.call(e))return new Date(e);if("string"!=typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var i=function(e){var t,r={},n=Xee.dateTimePattern.exec(e);if(n?(r.date=n[1],t=n[3]):(n=Xee.datePattern.exec(e),n?(r.date=n[1],t=n[2]):(r.date=null,t=e)),t){var i=Xee.timeZone.exec(t);i?(r.time=t.replace(i[1],""),r.timeZone=i[1].trim()):r.time=t}return r}(e),s=function(e,t){var r,n=Xee.YYY[t],i=Xee.YYYYY[t];if(r=Xee.YYYY.exec(e)||i.exec(e),r){var s=r[1];return{year:parseInt(s,10),restDateString:e.slice(s.length)}}if(r=Xee.YY.exec(e)||n.exec(e),r){var a=r[1];return{year:100*parseInt(a,10),restDateString:e.slice(a.length)}}return{year:null}}(i.date,n),a=s.year,o=function(e,t){if(null===t)return null;var r,n,i,s;if(0===e.length)return n=new Date(0),n.setUTCFullYear(t),n;if(r=Xee.MM.exec(e),r)return n=new Date(0),i=parseInt(r[1],10)-1,$ee(t,i)?(n.setUTCFullYear(t,i),n):new Date(NaN);if(r=Xee.DDD.exec(e),r){n=new Date(0);var a=parseInt(r[1],10);return function(e,t){if(t<1)return!1;var r=Jee(e);return!(r&&t>366||!r&&t>365)}(t,a)?(n.setUTCFullYear(t,0,a),n):new Date(NaN)}if(r=Xee.MMDD.exec(e),r){n=new Date(0),i=parseInt(r[1],10)-1;var o=parseInt(r[2],10);return $ee(t,i,o)?(n.setUTCFullYear(t,i,o),n):new Date(NaN)}if(r=Xee.Www.exec(e),r)return s=parseInt(r[1],10)-1,ete(t,s)?Kee(t,s):new Date(NaN);if(r=Xee.WwwD.exec(e),r){s=parseInt(r[1],10)-1;var l=parseInt(r[2],10)-1;return ete(t,s,l)?Kee(t,s,l):new Date(NaN)}return null}(s.restDateString,a);if(isNaN(o))return new Date(NaN);if(o){var l,c=o.getTime(),u=0;if(i.time&&(u=function(e){var t,r,n;if(t=Xee.HH.exec(e),t)return r=parseFloat(t[1].replace(",",".")),tte(r)?r%24*Gee:NaN;if(t=Xee.HHMM.exec(e),t)return r=parseInt(t[1],10),n=parseFloat(t[2].replace(",",".")),tte(r,n)?r%24*Gee+n*qee:NaN;if(t=Xee.HHMMSS.exec(e),t){r=parseInt(t[1],10),n=parseInt(t[2],10);var i=parseFloat(t[3].replace(",","."));return tte(r,n,i)?r%24*Gee+n*qee+1e3*i:NaN}return null}(i.time),isNaN(u)))return new Date(NaN);if(i.timeZone||r.timeZone){if(l=Fee(i.timeZone||r.timeZone,new Date(c+u)),isNaN(l))return new Date(NaN)}else l=(0,Wee.default)(new Date(c+u)),l=(0,Wee.default)(new Date(c+u+l));return new Date(c+u+l)}return new Date(NaN)}function Kee(e,t,r){t=t||0,r=r||0;var n=new Date(0);n.setUTCFullYear(e,0,4);var i=7*t+r+1-(n.getUTCDay()||7);return n.setUTCDate(n.getUTCDate()+i),n}var Qee=[31,28,31,30,31,30,31,31,30,31,30,31],Zee=[31,29,31,30,31,30,31,31,30,31,30,31];function Jee(e){return e%400===0||e%4===0&&e%100!==0}function $ee(e,t,r){if(t<0||t>11)return!1;if(null!=r){if(r<1)return!1;var n=Jee(e);if(n&&r>Zee[t]||!n&&r>Qee[t])return!1}return!0}function ete(e,t,r){return!(t<0||t>52||null!=r&&(r<0||r>6))}function tte(e,t,r){return!(null!=e&&(e<0||e>=25)||null!=t&&(t<0||t>=60)||null!=r&&(r<0||r>=60))}function rte(e,t){return t.color(e)}function nte(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1?arguments[1]:void 0,r=t.format,n=e.getSeconds(),i=e;t&&null!==t.timeZone&&(i=function(e,t,r){var n=Yee(e,r),i=Fee(t,n,!0),s=new Date(n.getTime()-i),a=new Date(0);return a.setFullYear(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()),a.setHours(s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()),a}(new Date,t.timeZone));let s,a=i.getHours(),o=i.getMinutes();"12ampm"===t.format12h24h&&(s=a>=12?"PM":"AM");let l,c,u=a;switch("24"!==t.format12h24h&&(u=a%12,0===u&&(u=12)),r){case"HH:mm:ss":l=[u,o,n];break;case"HH:mm":l=[u,o];break;case"HH":l=[u],s=void 0;break;case"mm":l=[o],s=void 0;break;case"ss":l=[n],s=void 0;break;case"year":c=i.getFullYear();break;case"month":c=i.getMonth()+1;break;case"dayOfYear":c=Math.floor((i.getTime()-new Date(i.getFullYear(),0,0).getTime())/864e5);break;case"dayOfMonth":c=i.getDate();break;case"secondOfDay":c=60*a*60+60*o+n;break;default:console.error("Unknown time format",r),c=0}return void 0!==l?{textValue:l,suffix:s}:c}function ite(e,t){switch(e.type){case"fresnel":return function(e,t){let{bias:r,scale:n,intensity:i,factor:s,color:a}=e;return u(u({},ste(e,t)),{},{color:rte(a,t),bias:r,scale:n,intensity:i,factor:s})}(e,t);case"gradient":return function(e,t){let{gradientType:r,smooth:n,colors:i,steps:s,angle:a,offset:o,morph:l}=e;return u(u({},ste(e,t)),{},{gradientType:r,smooth:n,colors:i.map((e=>new CB(e[0],e[1],e[2],e[3]))),num:i.length,steps:s,offset:new eB(...o),morph:new eB(...l),angle:a})}(e,t);case"depth":return function(e,t){let{gradientType:r,near:n,far:i,isVector:s,isWorldSpace:a,origin:o,direction:l,colors:c,steps:h,smooth:d}=e;return u(u({},ste(e,t)),{},{gradientType:r,near:n,far:i,isVector:s,isWorldSpace:a,origin:new PB(...o),direction:l?new PB(...l):new PB(1,0,0),colors:c.map((e=>void 0!==e?new CB(e[0],e[1],e[2],e[3]):new CB(0,0,0,0))),steps:h.slice(0,c.length),smooth:d})}(e,t);case"normal":return function(e,t){let{cnormal:r}=e;return u(u({},ste(e,t)),{},{cnormal:new PB(r[0],r[1],r[2])})}(e,t);case"noise":return function(e,t){return u(u({},ste(e,t)),{},{scale:e.scale,move:e.move,fA:new eB(...e.fA),fB:new eB(...e.fB),size:new PB(...e.size),distortion:new eB(...e.distortion),colorA:rte(e.colorA,t),colorB:rte(e.colorB,t),colorC:rte(e.colorC,t),colorD:rte(e.colorD,t),noiseType:e.noiseType,voronoiStyle:e.voronoiStyle,highCut:e.highCut,lowCut:e.lowCut,smoothness:e.smoothness,seed:e.seed,quality:e.quality})}(e,t);case"rainbow":return function(e,t){return u(u({},ste(e,t)),{},{filmThickness:e.filmThickness,movement:e.movement,wavelengths:new PB(...e.wavelengths),noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,offset:new PB(...e.offset)})}(e,t);case"toon":return function(e,t){return u(u({},ste(e,t)),{},{positioning:e.positioning,colors:e.colors.map((e=>new CB(e[0],e[1],e[2],e[3]))),num:e.colors.length,steps:e.steps,source:new PB(...e.source),isWorldSpace:e.isWorldSpace,noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,shadowColor:rte(e.shadowColor,t),offset:new PB(...e.offset)})}(e,t);case"outline":return function(e,t){return u(u({},ste(e,t)),{},{outlineColor:rte(e.outlineColor,t),contourColor:rte(e.contourColor,t),outlineWidth:e.outlineWidth,contourWidth:e.contourWidth,outlineThreshold:e.outlineThreshold,contourThreshold:e.contourThreshold,outlineSmoothing:e.outlineSmoothing,contourFrequency:e.contourFrequency,contourDirection:new PB(...e.contourDirection),positionalLines:e.positionalLines,compensation:e.compensation})}(e,t);case"transmission":return function(e,t){return u(u({},ste(e,t)),{},{thickness:e.thickness,ior:e.ior,roughness:e.roughness})}(e,t);case"color":return function(e,t){return u(u({},ste(e,t)),{},{color:rte(e.color,t)})}(e,t);case"pattern":return function(e,t){return u(u({},ste(e,t)),{},{style:e.style,projection:e.projection,axis:e.axis,blending:e.blending,offset:new eB(...e.offset),colorA:rte(e.colorA,t),colorB:rte(e.colorB,t),frequency:new eB(...e.frequency),size:e.size,variation:e.variation,smoothness:e.smoothness,zigzag:e.zigzag,rotation:e.rotation,vertical:new eB(...e.vertical),horizontal:new eB(...e.horizontal),sides:e.sides})}(e,t)}}function ste(e,t){var r;let{alpha:n,mode:i,isMask:s}=e,a="string"==typeof n?(null!==(r=Number(t.getVariable(n)))&&void 0!==r?r:100)/100:n;return u(u({},function(e){return{type:e.type}}(e)),{},{alpha:a,mode:i,isMask:s})}var ate=class extends X9{},ote={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},lte={depth:["colors"]};function cte(e,t,r){if("isMask"===t)return!0;let n=ote[e.type],i=lte[e.type];if(void 0!==i){let n=e.color;if(i.includes(t)){var s;let e=null===(s=n[t])||void 0===s||null===(s=s.value)||void 0===s?void 0:s.length;if(void 0!==e&&e!==r.length)return!0}}return void 0!==n&&n.includes(t)}function ute(e,t,r){var n;let i=r.uniforms["f".concat(r.id,"_texture")];if(!i)return!1;let s=!1,a=e;if("image"in a){let e=a.image,r=t.image(e),n=i;n.image instanceof Iee||n.image.deref(),n.image=r}if("video"in a){let e=a.video,r=t.video(e),n=i;n.image instanceof Iee||n.image.deref(),n.image=r}if("wrapping"in a){i.wrap=a.wrapping}if("minFilter"in a){i.minFilter=a.minFilter}if("magFilter"in a){i.magFilter=a.magFilter}if("rotation"in a&&r.uniforms["f".concat(r.id,"_rotation")])return r.uniforms["f".concat(r.id,"_rotation")].value=(null!==(n=a.rotation)&&void 0!==n?n:0)*$N.DEG2RAD,s;if("repeat"in a||"offset"in a||"rotation"in a){var o;let e="mat",t=r.uniforms["f".concat(r.id,"_").concat(e)];"repeat"in a&&(t.repeat=a.repeat),"offset"in a&&(t.offset=a.offset),"rotation"in a&&(t.rotation=null!==(o=a.rotation)&&void 0!==o?o:0),t.updateMatrix()}return s}var hte=(e,t,r)=>{var n,i;return null!==(n=Math.max(0,Math.min(1,Number(null!==(i=t.getVariable("number"==typeof e?100*e:e,r))&&void 0!==i?i:100)/100)))&&void 0!==n?n:1},dte=class{constructor(e,t,r,n,i){this.id=e,this.uuid=t,this.data=r,this.uniforms={};for(let s in n)this.uniforms["f".concat(this.id,"_").concat(s)]=n[s];for(let s in r)vte(s,this,r,i)}get type(){return this.data.type}static create(e,t,r,n){if("light"===r.type)return mte.createLightLayer(e,t,r,n);if("texture"===r.type||"video"===r.type){var i,s,a,o,l,c,h,d,f,p;let u="texture"===r.type?null!==(i=n.uiBuffer(r.texture.image))&&void 0!==i?i:n.image(r.texture.image):n.video(r.texture.video),m=new N7(u,r.texture.wrapping,null!==(s=r.texture.minFilter)&&void 0!==s?s:1008,null!==(a=r.texture.magFilter)&&void 0!==a?a:1006),g=new L7(u),v=new j7(r.texture.repeat,r.texture.offset,null!==(o=r.texture.rotation)&&void 0!==o?o:0),y=new c7(r.crop?1:0),b=new D7(null!==(l=r.projection)&&void 0!==l?l:0),w=new D7(null!==(c=["x","y","z"].indexOf(r.axis))&&void 0!==c?c:0),x=new D7(null!==(h=r.side)&&void 0!==h?h:0),S=new G9(r.size?new eB(r.size[0],r.size[1]):new eB(100,100)),_=new c7(null!==(d=r.blending)&&void 0!==d?d:0),C=new c7(hte(r.alpha,n)),E=new D7(null!==(f=r.mode)&&void 0!==f?f:0),A=new I7(null!==(p=r.isMask)&&void 0!==p&&p),M=new Y7(m,g,y,b,w,x,S,_,v,C,E,A),T=new o7(M.calpha,"f");return new fte(e,t,r,{texture:m,textureSize:g,crop:y,projection:b,axis:w,side:x,size:S,blending:_,mat:v,alpha:C,mode:E,isMask:A},M,E,T,A,n)}if("matcap"===r.type){var m,g,v,y,b;let i=n.image(r.texture.image),s=new N7(i,r.texture.wrapping,null!==(m=r.texture.minFilter)&&void 0!==m?m:1008,null!==(g=r.texture.magFilter)&&void 0!==g?g:1006),a=new c7(hte(r.alpha,n)),o=new D7(null!==(v=r.mode)&&void 0!==v?v:0),l=new I7(null!==(y=r.isMask)&&void 0!==y&&y),c=new c7((null!==(b=r.texture.rotation)&&void 0!==b?b:0)*$N.DEG2RAD),u=new tee(s,a,o,l,c),h=new o7(u.calpha,"f");return new fte(e,t,r,{texture:s,alpha:a,mode:o,isMask:l,rotation:c},u,o,h,l,n)}if("displace"===r.type){if("noise"===r.displacementType){var w,x,S,_,C,E,A,M,T,P;let i=new q9(new PB(...r.offset)),s=new c7(null!==(w=r.scale)&&void 0!==w?w:10),a=new c7(null!==(x=r.intensity)&&void 0!==x?x:8),o=new c7(null!==(S=r.movement)&&void 0!==S?S:1),l=new D7(null!==(_=r.noiseType)&&void 0!==_?_:0),c=new D7(null!==(C=r.voronoiStyle)&&void 0!==C?C:0),u=new c7(null!==(E=r.smoothness)&&void 0!==E?E:.5),h=new c7(null!==(A=r.seed)&&void 0!==A?A:0),d=new c7(null!==(M=r.highCut)&&void 0!==M?M:1),f=new c7(null!==(T=r.lowCut)&&void 0!==T?T:0),p=new D7(null!==(P=r.quality)&&void 0!==P?P:1),m=new vee(a,o,i,c,u,h,d,f,p,s,l);return new pte(e,t,r,{offset:i,scale:s,intensity:a,movement:o,noiseType:l,voronoiStyle:c,smoothness:u,seed:h,highCut:d,lowCut:f,quality:p},m,n)}throw new Error}return function(e,t,r,n){let i=ite(r,n);return function(e,t,r,n,i){switch(e.type){case"color":{var s;let a=new k7(null!==(s=n.color)&&void 0!==s?s:n1),o=gte(n),l=new W7(a,o.alpha),c=new o7(l.calpha,"f");return new fte(t,r,e,u({color:a},o),l,o.mode,c,o.isMask,i)}case"fresnel":{var a,o,l,c,h;let s=new k7(null!==(a=n.color)&&void 0!==a?a:16777215),d=new c7(null!==(o=n.bias)&&void 0!==o?o:.1),f=new c7(null!==(l=n.scale)&&void 0!==l?l:1),p=new c7(null!==(c=n.intensity)&&void 0!==c?c:2),m=new c7(null!==(h=n.factor)&&void 0!==h?h:1),g=gte(n),v=new Z7(s,d,f,p,m,g.alpha,g.mode,g.isMask),y=new o7(v.calpha,"f");return new fte(t,r,e,u({color:s,bias:d,scale:f,intensity:p,factor:m},g),v,g.mode,y,g.isMask,i)}case"rainbow":{var d,f,p,m,g,v;let s=new c7(null!==(d=n.filmThickness)&&void 0!==d?d:30),a=new c7(null!==(f=n.movement)&&void 0!==f?f:0),o=new q9(null!==(p=n.wavelengths)&&void 0!==p?p:new PB(0,0,0)),l=new c7(null!==(m=n.noiseStrength)&&void 0!==m?m:0),c=new c7(null!==(g=n.noiseScale)&&void 0!==g?g:1),h=new q9(null!==(v=n.offset)&&void 0!==v?v:new PB(0,0,0)),y=gte(n),b=new cee(s,a,o,l,c,h,y.alpha,y.isMask),w=new o7(b.calpha,"f");return new fte(t,r,e,u({filmThickness:s,movement:a,wavelengths:o,noiseStrength:l,noiseScale:c,offset:h},y),b,y.mode,w,y.isMask,i)}case"transmission":{var y,b,w;let s=new c7(null!==(y=n.thickness)&&void 0!==y?y:10),a=new c7(null!==(b=n.ior)&&void 0!==b?b:1.5),o=new c7(null!==(w=n.roughness)&&void 0!==w?w:.5),l=yee.transmissionSize,c=yee.transmissionRenderTarget,h=yee.transmissionRenderTargetDepth,d=window.innerWidth,f=window.innerHeight,p=d>=f?new G9(f/d,1):new G9(1,d/f),m=gte(n),g=new pee(s,a,o,l,c,h,p,m.alpha),v=new o7(g.calpha,"f");return new fte(t,r,e,u({thickness:s,ior:a,roughness:o,aspectRatio:p},m),g,m.mode,v,m.isMask,i)}case"toon":{var x,S,_,C,E,A;let s,a,o=new D7(null!==(x=n.positioning)&&void 0!==x?x:0);n.colors?s=new U7(n.colors.length,n.colors):(s=new U7(10,new CB(0,0,0,1)),s.value[1]=new CB(1,1,1,1)),n.steps?a=new O7(n.steps.length,n.steps):(a=new O7(10,1),a.value[0]=0);let l=new q9(null!==(S=n.source)&&void 0!==S?S:new PB(0,0,0)),c=new I7(null===(_=n.isWorldSpace)||void 0===_||_),h=new c7(null!==(C=n.noiseStrength)&&void 0!==C?C:0),d=new c7(null!==(E=n.noiseScale)&&void 0!==E?E:1),f=new Y9(n.shadowColor),p=new q9(null!==(A=n.offset)&&void 0!==A?A:new PB(0,0,0)),m=gte(n),g=new hee(o,s,a,l,c,h,d,f,p,m.alpha),v=new o7(g.calpha,"f");return new fte(t,r,e,u({positioning:o,colors:s,steps:a,source:l,isWorldSpace:c,noiseStrength:h,noiseScale:d,shadowColor:f,offset:p},m),g,m.mode,v,m.isMask,i)}case"outline":{var M,T,P,k,D,I,O,R,L,N,B;let s=new k7(null!==(M=n.outlineColor)&&void 0!==M?M:16777215),a=new k7(null!==(T=n.contourColor)&&void 0!==T?T:16777215),o=new c7(null!==(P=n.outlineWidth)&&void 0!==P?P:.1),l=new c7(null!==(k=n.contourWidth)&&void 0!==k?k:.1),c=new c7(null!==(D=n.outlineThreshold)&&void 0!==D?D:.1),h=new c7(null!==(I=n.contourThreshold)&&void 0!==I?I:.1),d=new c7(null!==(O=n.outlineSmoothing)&&void 0!==O?O:.1),f=new c7(null!==(R=n.contourFrequency)&&void 0!==R?R:.1),p=new q9(null!==(L=n.contourDirection)&&void 0!==L?L:new PB(0,1,0)),m=new I7(null!==(N=n.positionalLines)&&void 0!==N&&N),g=new I7(null===(B=n.compensation)||void 0===B||B),v=yee.normalRenderTarget,y=yee.normalRenderTargetDepth,b=yee.pixelRatioNode,w=yee.resolution,x=gte(n),S=new see(s,a,o,l,c,h,d,f,p,m,g,w,v,y,b,x.alpha),_=new o7(S.calpha,"f");return new fte(t,r,e,u({outlineColor:s,contourColor:a,outlineWidth:o,contourWidth:l,outlineThreshold:c,contourThreshold:h,outlineSmoothing:d,contourFrequency:f,contourDirection:p,positionalLines:m,compensation:g},x),S,x.mode,_,x.isMask,i)}case"depth":{var z,F,j,U,V,H,W,G;let s,a,o=new D7(null!==(z=n.gradientType)&&void 0!==z?z:0),l=new I7(null!==(F=n.smooth)&&void 0!==F&&F),c=new c7(null!==(j=n.near)&&void 0!==j?j:50),h=new c7(null!==(U=n.far)&&void 0!==U?U:200),d=new c7(null!==(V=n.isVector)&&void 0!==V?V:1),f=new c7(null!==(H=n.isWorldSpace)&&void 0!==H?H:0),p=new q9(null!==(W=n.origin)&&void 0!==W?W:new PB),m=new q9(null!==(G=n.direction)&&void 0!==G?G:new PB);n.colors?s=new U7(n.colors.length,n.colors):(s=new U7(2,new CB(0,0,0,1)),s.value[1]=new CB(1,1,1,1)),n.steps?a=new O7(n.steps.length,n.steps):(a=new O7(2,1),a.value[0]=0);let g=gte(n),v=new Q7(o,l,c,h,d,f,p,m,s,a,g.alpha,g.isMask),y=new o7(v.calpha,"f");return new fte(t,r,e,u({gradientType:o,smooth:l,near:c,far:h,isVector:d,isWorldSpace:f,origin:p,direction:m,colors:s,steps:a},g),v,g.mode,y,g.isMask,i)}case"noise":{var q,X,Y,K,Q,Z,J,$,ee,te,re,ne,ie;let s=new c7(null!==(q=n.scale)&&void 0!==q?q:1),a=new q9(null!==(X=n.size)&&void 0!==X?X:new PB(100,100,100)),o=new c7(null!==(Y=n.move)&&void 0!==Y?Y:1),l=new G9(null!==(K=n.fA)&&void 0!==K?K:new eB(1.7,9.2)),c=new G9(null!==(Q=n.fB)&&void 0!==Q?Q:new eB(8.3,2.8)),h=new G9(null!==(Z=n.distortion)&&void 0!==Z?Z:new eB(1,1)),d=new Y9(n.colorA),f=new Y9(n.colorB),p=new Y9(n.colorC),m=new Y9(n.colorD),g=new D7(null!==(J=n.noiseType)&&void 0!==J?J:0),v=new D7(null!==($=n.voronoiStyle)&&void 0!==$?$:0),y=new c7(null!==(ee=n.highCut)&&void 0!==ee?ee:1),b=new c7(null!==(te=n.lowCut)&&void 0!==te?te:0),w=new c7(null!==(re=n.smoothness)&&void 0!==re?re:.5),x=new c7(null!==(ne=n.seed)&&void 0!==ne?ne:.5),S=new D7(null!==(ie=n.quality)&&void 0!==ie?ie:1),_=gte(n),C=new nee(s,a,o,l,c,h,d,f,p,m,_.alpha,g,_.isMask,v,y,b,w,x,S),E=new o7(C.calpha,"f");return new fte(t,r,e,u(u({scale:s,size:a,move:o,fA:l,fB:c,distortion:h,colorA:d,colorB:f,colorC:p,colorD:m,noiseType:g},_),{},{voronoiStyle:v,highCut:y,lowCut:b,smoothness:w,seed:x,quality:S}),C,_.mode,E,_.isMask,i)}case"normal":{var se;let s=new q9(null!==(se=n.cnormal)&&void 0!==se?se:new PB(1,1,1)),a=gte(n),o=new q7(s,a.alpha),l=new o7(o.calpha,"f");return new fte(t,r,e,u({cnormal:s},a),o,a.mode,l,a.isMask,i)}case"gradient":{var ae,oe,le,ce,ue;let s,a,o=new D7(null!==(ae=n.gradientType)&&void 0!==ae?ae:0),l=new I7(null!==(oe=n.smooth)&&void 0!==oe&&oe);n.colors?s=new U7(n.colors.length,n.colors):(s=new U7(10,new CB(0,0,0,1)),s.value[1]=new CB(1,1,1,1)),n.steps?a=new O7(n.steps.length,n.steps):(a=new O7(10,1),a.value[0]=0);let c=new G9(null!==(le=n.offset)&&void 0!==le?le:new eB(0,0)),h=new G9(null!==(ce=n.morph)&&void 0!==ce?ce:new eB(0,0)),d=new c7(null!==(ue=n.angle)&&void 0!==ue?ue:0),f=gte(n),p=new $7(o,l,s,a,c,h,d,f.alpha,f.isMask),m=new o7(p.calpha,"f");return new fte(t,r,e,u({gradientType:o,smooth:l,colors:s,steps:a,offset:c,morph:h,angle:d},f),p,f.mode,m,f.isMask,i)}case"pattern":{var he,de,fe,pe,me,ge,ve,ye,be,we,xe,Se,_e,Ce;let s=new D7(null!==(he=n.style)&&void 0!==he?he:0),a=new D7(null!==(de=n.projection)&&void 0!==de?de:0),o=new D7(null!==(fe=["x","y","z"].indexOf(n.axis))&&void 0!==fe?fe:0),l=new c7(null!==(pe=n.blending)&&void 0!==pe?pe:0),c=new G9(null!==(me=n.offset)&&void 0!==me?me:new eB(0,0)),h=new Y9(n.colorA),d=new Y9(n.colorB),f=new G9(null!==(ge=n.frequency)&&void 0!==ge?ge:new eB(10,10)),p=new c7(null!==(ve=n.size)&&void 0!==ve?ve:.5),m=new c7(null!==(ye=n.variation)&&void 0!==ye?ye:0),g=new c7(null!==(be=n.smoothness)&&void 0!==be?be:.5),v=new c7(null!==(we=n.zigzag)&&void 0!==we?we:0),y=new c7(null!==(xe=n.rotation)&&void 0!==xe?xe:0),b=new G9(null!==(Se=n.vertical)&&void 0!==Se?Se:new eB(0,1)),w=new G9(null!==(_e=n.horizontal)&&void 0!==_e?_e:new eB(0,1)),x=new D7(null!==(Ce=n.sides)&&void 0!==Ce?Ce:6),S=gte(n),_=new oee(s,a,o,l,c,h,d,f,p,m,g,v,y,b,w,x,S.alpha,S.isMask),C=new o7(_.calpha,"f");return new fte(t,r,e,u({style:s,projection:a,axis:o,blending:l,offset:c,colorA:h,colorB:d,frequency:f,size:p,variation:m,smoothness:g,zigzag:v,rotation:y,vertical:b,horizontal:w,sides:x},S),_,S.mode,C,S.isMask,i)}default:{let s=new k7(1,0,0,1),a=gte(n),o=new W7(s,a.alpha),l=new o7(o.calpha,"f");return new fte(t,r,e,u({color:s},a),o,a.mode,l,a.isMask,i)}}}(r,e,t,i,n)}(e,t,r,n)}updateByOp(e,t,r){let n=e;if(void 0===n.path[0]){if(0===n.type)return"type"in n.props||"category"in n.props||"visible"in n.props||"noiseType"in n.props?(r.scene.markNeedsUpdateRendererDirty(),!0):function(e,t,r,n){let i=!1;for(let[s,a]of Object.entries(e)){if("bumpMap"===s||"roughnessMap"===s){i=!0;continue}if(!s||void 0===a)continue;if(vte(s,r,n,t)){"visible"===s&&"light"===r.type&&(i=!0);continue}r.visible=n.visible;let e=r.uniforms["f".concat(r.id,"_").concat(s)];if(e&&!(e instanceof R7))switch(i=i||cte(r,s,a),e.constructor){case k7:if("string"==typeof a){let r=t.getColor(a);r&&(e.value=r);break}{let t=a;e.value instanceof ate?e.value=new X9(t.r,t.g,t.b,t.a):e.setRGBA(t);break}case Y9:if("string"==typeof a){let r=t.getColor(a);r&&(e.value=r);break}{let t=a;e.value instanceof ate?e.value=new X9(t.r,t.g,t.b,t.a):e.value.setRGBA(t.r,t.g,t.b,t.a);break}case G9:{let t=a;e.value.setX(t[0]),e.value.setY(t[1]);break}case q9:{let t=a;e.value.setX(t[0]),e.value.setY(t[1]),e.value.setZ(t[2]);break}case l7:ute(a,t,r);break;case U7:e.value=a.map((e=>new CB(...e)));break;default:e.value=a}}return i}(n.props,r.shared,this,t)}else if("texture"===n.path[0])return!("texture"in t)&&!("video"in t)||ute(n.props,r.shared,this);return!1}dispose(){if(function(e){let t=e instanceof dte?e.type:e;return"texture"===t||"video"===t||"displace_map"===t||"matcap"===t}(this)){let e=this.uniforms["f".concat(this.id,"_texture")];if(!e)return!1;let t=e;t.image instanceof Iee||t.image.deref()}}hasValueByKey(e){return void 0!==this.uniforms[e]}hasValue(e){return this.hasValueByKey("f".concat(this.id,"_").concat(e))}setValue(e,t){let r="f".concat(this.id,"_").concat(e);this.hasValueByKey(r)&&void 0!==t&&(this.uniforms[r].value=t)}getNode(e){let t="f".concat(this.id,"_").concat(e);if(this.hasValueByKey(t))return this.uniforms[t]}getValue(e){let t="f".concat(this.id,"_").concat(e);if(this.hasValueByKey(t))return this.uniforms[t].value}getName(e){let t=/f\d+_(.*)/.exec(e);if(t&&t.length>1)return t[1];console.log("Layer.getName: error ".concat(e))}getNames(){let e=[];for(let t in this.uniforms){let r=this.getName(t);r&&e.push(r)}return e}},fte=class extends dte{constructor(e,t,r,n,i,s,a,o,l){super(e,t,r,n,l),this.params=n,this.color=i,this.mode=s,this.alpha=a,this.isMask=o}},pte=class extends dte{constructor(e,t,r,n,i,s){super(e,t,r,n,s),this.position=i}},mte=class extends dte{constructor(e,t,r,n,i,s){super(e,t,r,i,s),this.node=n}static createLightLayer(e,t,r,n){let i,s,a=new c7(hte(r.alpha,n)),o=new D7(r.mode),l=new c7(r.bumpMapIntensity),c=new c7(hte(r.alphaOverride,n));if(r.visible)if("lambert"===r.category){var u,h;i=new See;let e=new k7(null!==(u=n.color(r.emissive))&&void 0!==u?u:0),t=new I7(null===(h=r.occlusion)||void 0===h||h);s={emissive:e,occlusion:t},i.emissive=e,i.occlusion=t}else if("toon"===r.category){var d,f;i=new Aee;let e=new c7(null!==(d=r.shininess)&&void 0!==d?d:30),t=new k7(null!==(f=n.color(r.specular))&&void 0!==f?f:1118481);s={shininess:e,specular:t},i.shininess=e,i.specular=t}else if("physical"===r.category){var p,m,g,v;i=new Eee;let e=new c7(null!==(p=r.roughness)&&void 0!==p?p:.3),t=new c7(null!==(m=r.metalness)&&void 0!==m?m:0),n=new c7(null!==(g=r.reflectivity)&&void 0!==g?g:.5),a=new I7(null===(v=r.occlusion)||void 0===v||v);s={roughness:e,metalness:t,reflectivity:n,occlusion:a},i.roughness=e,i.metalness=t,i.reflectivity=n,i.occlusion=a}else{var y,b,w;i=new Cee;let e=new c7(null!==(y=r.shininess)&&void 0!==y?y:30),t=new k7(void 0!==r.specular&&null!==(b=n.color(r.specular))&&void 0!==b?b:1118481),a=new I7(null===(w=r.occlusion)||void 0===w||w);s={shininess:e,specular:t,occlusion:a},i.shininess=e,i.specular=t,i.occlusion=a}else i=new xee,s={};return i.alpha=new c7(1),i.shadingAlpha=a,i.shadingBlend=o,i.bumpMapIntensity=l,i.alphaOverride=c,s.alpha=i.shadingAlpha,s.mode=i.shadingBlend,s.bumpMapIntensity=i.bumpMapIntensity,s.alphaOverride=i.alphaOverride,new mte(e,t,r,i,s,n)}get category(){return this.node.category}};function gte(e){var t,r,n;return{alpha:new c7(null!==(t=e.alpha)&&void 0!==t?t:1),mode:new D7(null!==(r=e.mode)&&void 0!==r?r:0),isMask:new I7(null!==(n=e.isMask)&&void 0!==n&&n)}}function vte(e,t,r,n){if("displace"===r.type&&("intensity"===e||"visible"===e)){let e=t.uniforms["f".concat(t.id,"_intensity")];return e?(e.value=r.intensity*(r.visible?1:0),e):void 0}if("displace"!==r.type&&("alpha"===e||"visible"===e)){let i=t.uniforms["f".concat(t.id,"_alpha")];if(!i)return;if(i.value=hte(r.alpha,n)*(r.visible?1:0),"outline"===r.type&&"visible"===e){let e=t.uniforms["f".concat(t.id,"_compensation")];e&&(e.value=r.compensation&&r.visible)}return i}}function yte(e,t){let r=0,n=e.layers.find((e=>"light"===e.data.type));if(n){let e=n.data,r=Number(t.getVariable(e.alphaOverride));if(("string"==typeof e.alphaOverride?r/100:e.alphaOverride)<1)return!0}for(let s of e.layers){if("displace"!==s.data.type&&s.data.isMask)return!0;if("displace"!==s.data.type&&"alpha"in s.data&&"light"!==s.data.type&&"fresnel"!==s.data.type&&"texture"!==s.data.type&&"matcap"!==s.data.type&&"rainbow"!==s.data.type&&"outline"!==s.data.type&&"pattern"!==s.data.type){var i;let e=s.data.visible?s.data.alpha:0;if("string"==typeof e&&(e=Math.max(0,Math.min(1,Number(null!==(i=t.getVariable(e))&&void 0!==i?i:100)/100))),1===e&&"depth"===s.data.type||"gradient"===s.data.type){for(let t of s.data.colors)if(t[3]<1){e=t[3];break}}else if(1===e&&"noise"===s.data.type){let r=t.color(s.data.colorA).a,n=t.color(s.data.colorB).a,i=t.color(s.data.colorC).a,a=t.color(s.data.colorD).a,o=Math.min(r,Math.min(n,Math.min(i,a)));o<1&&(e=o)}r+=(1-r)*e}}return r<1}var bte=class extends EF{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.shadersPatchedForShapeBlend=!1,this.nodeContextUuid=0,this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return""}},wte=class extends bte{constructor(e,t,r,n){super(),this.flatShading=e,this.side=t,this.wireframe=r,this.root=n}updateAfterBuild(){let e=this.root;this.lights=e.lights,this.vertexShader=e.vertexShader,this.fragmentShader=e.fragmentShader,Object.assign(this.defines,e.defines),Object.assign(this.uniforms,e.uniforms),this.extensions=e.extensions,this.transparent=e.transparent,this.cacheKey=e.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(e,t){this.root.onBeforeCompile(e)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(e,t,r,n){return this.root.getFlavor(e,t,r,n)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(e){return this.root.getLayersOfType(e)}getLayerByUuid(e){return this.root.getLayerByUuid(e)}updateByOp(e,t,r){this.root.updateByOp(e,t,r)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},xte=class extends bte{constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(),this.data=e,this.allowVariableSaves=r,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.needsJitter=t.shared.needsJitter,j9.startContext(this),this.reset0(e,t),j9.endContext(this)}get nodeMaterial(){return this}getFlavor(e,t,r,n){var i;let s=r?6:(e?3:0)+t;if(s+=7*((null!==(i=null===n||void 0===n?void 0:n.resolutionLevel)&&void 0!==i?i:0)-(null!==n&&void 0!==n&&n.useChildrenColors?4:0)),0===s)return this;void 0===this.flavors&&(this.flavors=[]),s-=1;let a=this.flavors[s];return void 0===a&&(a=new wte(e,t,r,this),a.needsJitter=this.needsJitter,this.flavors[s]=a,a.flatShading=e,a.side=t,a.updateAfterBuild(),n&&(a.defines.SHAPEBLEND=n.resolutionLevel,a.defines.SHAPEBLEND_C=n.useChildrenColors?1:0)),a}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var e,t;return null!==(e=null===(t=this.lightLayer.getNode("occlusion"))||void 0===t?void 0:t.value)&&void 0!==e&&e}reset(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];j9.startContext(this),(this.data!==e||r)&&this.reset0(e,t),j9.endContext(this)}reset0(e,t){var r,n;this.data=e;let i=null!==(r=e.layers)&&void 0!==r?r:_1.defaultTwoLayerData("phong").layers;try{this.layers=i.map((e=>dte.create(this.layerIdGen++,e.id,e.data,t.shared)))}catch(s){this.layers=[]}this.layers.reverse(),this.name=null!==(n=e.name)&&void 0!==n?n:"Untitled Material",this.onUpdate(t.shared),this.transparent=yte(e,t.shared),this.saveVariableLocations(t)}onVariableUpdate(e,t,r){if("alphaOverride"===e[0])this.transparent=yte(this.data,r.shared),this.lightLayer.setValue("alphaOverride",Math.max(0,Math.min(Number(t)/100,1)));else if("layer"===e[0]){let n=e[1],i=e[2];if(n&&i){let e=this.layers.find((e=>e.uuid===n));(null===e||void 0===e?void 0:e.hasValue(i))&&("alpha"===i?(this.transparent=yte(this.data,r.shared),e.setValue(i,Math.max(0,Math.min(Number(t)/100,1)))):e.setValue(i,t))}}}saveVariableLocations(e){if(!this.allowVariableSaves)return;let t=this.data.layers.find((e=>"light"===e.data.type));t&&e.shared.getVariable(t.data.alphaOverride,["material",this.uuid,"alphaOverride"]),this.data.layers.forEach((t=>{"alpha"in t.data&&"string"==typeof t.data.alpha&&e.shared.getVariable(t.data.alpha,["material",this.uuid,"layer",t.id,"alpha"])}))}getLayersOfType(e){return this.layers.filter((t=>t.type===e))}getLayerByUuid(e){return this.layers.find((t=>t.uuid===e))}onUpdate(e){this.lightLayer=this.layers.find((e=>e instanceof mte)),void 0===this.lightLayer&&(this.lightLayer=new mte(0,"",u(u({},S1.defaultData("light","phong")),{},{visible:!1}),new xee,{},e)),this.dispose();for(let t of this.flavors)t&&t.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),this.build(),this.nodeContextUuid=0}applyTextureMaps(){let e=this.layers.find((e=>e instanceof mte));if(!e)return;let t=e.data,r=t.bumpMap,n=t.roughnessMap;e.node.bumpMap=void 0,e.node.roughnessMap=void 0;for(let i=0;i<this.layers.length;++i){let t=this.layers[i];t instanceof fte&&t.color instanceof Y7&&(t.uuid===r&&(e.node.bumpMap=t.color),t.uuid===n&&(e.node.roughnessMap=t.color))}}updateByOp(e,t,r){if(j9.startContext(this),void 0!==t?this.data=t:t=this.data,this.transparent=yte(t,r.shared),"layers"===e.path[0]){let n=r.shared,i=e.path[1];if(void 0===i)r.scene.markNeedsUpdateRendererDirty(),this.reset0(t,r);else{0===e.type&&void 0!==e.props.occlusion&&r.scene.markNeedsUpdateRendererDirty();let s=this.layers.find((e=>e.uuid===i));if(s){let a,o=t.layers.data(i);0===e.type&&("alpha"in e.props||"alphaOverride"in e.props)&&(a="alpha"in e.props?u(u({},e.props),{},{alpha:hte(e.props.alpha,n,["material",this.uuid,"layer",i,"alpha"])}):u(u({},e.props),{},{alphaOverride:hte(e.props.alphaOverride,n,["material",this.uuid,"alphaOverride"])})),s.updateByOp(u(u(u({},e),a?{props:a}:{}),{},{path:e.path.slice(2)}),o,r)&&this.reset0(t,r)}}}else this.reset0(t,r);j9.endContext(this)}applyMasks(){for(let e=0;e<this.layers.length;++e){let t=this.layers[e];t instanceof fte?t.color.mask=void 0:t instanceof mte&&(t.node.mask=void 0)}for(let e=0;e<this.layers.length;++e){let t=this.layers[e];if(t instanceof fte&&t.isMask.value&&t.data.visible&&e>0){let r=e-1,n=this.layers[r];n instanceof mte?n.node.mask=new d7(t.color,t.alpha,d7.MUL):n instanceof fte&&(n.isMask.value||(n.color.mask=new d7(t.color,t.alpha,d7.MUL)))}}}blendColors(){let e=this.layers.findIndex((e=>e instanceof fte)),t=this.layers.findIndex((e=>e instanceof mte));if(-1!==e&&e<t){let r=this.layers[e].color;for(let n=e+1;n<t;++n){let e=this.layers[n];if(e instanceof fte){if(e.isMask.value)continue;r=new V7(r,e.color,e.alpha,e.mode)}}this.fragment.color=r}else this.fragment.color=void 0}blendAfterColors(){let e=new o7("outgoingLight","f"),t=this.layers.findIndex((e=>e instanceof mte));if(this.layers.length>t+1){for(let r=t+1;r<this.layers.length;++r){let t=this.layers[r];if(t instanceof fte){if(t.isMask.value)continue;e=new V7(e,t.color,t.alpha,t.mode)}}this.fragment.afterColor=e}else this.fragment.afterColor=void 0}blendPositions(){let e=this.layers.filter((e=>e instanceof pte));if(e.length>0){let t=e[0].position;for(let r=1;r<e.length;++r)e[r]&&(t=new d7(t,e[r].position,d7.ADD),t=new d7(t,new c7(.5).setReadonly(!0),d7.MUL));this.fragment.position=t}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(e){this.shapeBlendhack&&this.shapeBlendhack(this),e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=!0===this.extensions.derivatives,e.extensionFragDepth=!0===this.extensions.fragDepth,e.extensionDrawBuffers=!0===this.extensions.drawBuffers,e.extensionShaderTextureLOD=!0===this.extensions.shaderTextureLOD}clampUniformsForPreview(e,t){let r=(e,t,r)=>Math.min(Math.max(e,t),r);for(let n of this.layers)if("displace"===n.type){let i=r(n.uniforms["f".concat(n.id,"_intensity")].value,e,t);n.uniforms["f".concat(n.id,"_intensity")].value=i}}updateFrame(e){for(let t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])}build(){let e=new P7;e.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,e.build(this.fragment,this.fragment),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.updaters=e.updaters;for(let t of this.flavors)t&&t.updateAfterBuild();return this.shadersPatchedForShapeBlend=!1,this}nodeMaterialDispose(){this.layers.forEach((e=>e.dispose())),super.dispose();for(let e of this.flavors)e&&e.dispose()}assetsLoaded(){for(let e of this.layers)if(e instanceof fte){let t=e.params.texture;if(t instanceof N7&&!t.image.loaded)return!1}return!0}};Object.defineProperties(bte.prototype,{properties:{get:function(){return this.fragment.properties}}});var Ste=class extends xte{constructor(e,t,r){super(e,t,!1),this.uuid=r,this.allowVariableSaves=!0,this.saveVariableLocations(t)}},_te=new Map;function Cte(e){if("string"==typeof e)return e;let t=_te.get(e);return t||(t={url:URL.createObjectURL(new Blob([e]))},_te.set(e,t)),t.url}var Ete,Ate,Mte,Tte=new Promise((e=>{Ete=e})),Pte=!1;function kte(){if(!Pte)return Ate||(Ate=async function(){await r.e(519).then(r.bind(r,519)),Ete(void 0!==window?window:global),Pte=!0}())}function Dte(e){let t=!1;return e.scene.objects.traverse(((e,r)=>{if(void 0===r.events||!1===Array.isArray(r.events))return!0;let n=[];r.events.forEach((e=>{"dragDropActions"in e.data?(n.push(...e.data.dragDropActions.drag),n.push(...e.data.dragDropActions.drop)):"inActions"in e.data?(n.push(...e.data.inActions),n.push(...e.data.outActions)):"gameActions"in e.data?(n.push(...e.data.gameActions.idle),n.push(...e.data.gameActions.move),n.push(...e.data.gameActions.jump),n.push(...e.data.gameActions.run)):"breakpoints"in e.data?e.data.breakpoints.forEach((e=>{n.push(...e.data.actions)})):"actions"in e.data&&n.push(...e.data.actions),t=t||n.some((e=>"Audio"===e.data.type))}))})),t}Tte.then((e=>Mte=e));var Ite,Ote,Rte=class{constructor(e){let t,{src:r,volume:n,delay:i,loop:s}=e;this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)},t="string"==typeof r?{src:r}:{src:Cte(r),format:"wav"},this.sound=new Mte.Howl(t),this.sound.on("end",this.onEnd),this.src=r,void 0!==n&&(this.volume=n),void 0!==i&&(this.delay=i),void 0!==s&&(this.loop=s)}get status(){return this._status}get volume(){return this._volume}set volume(e){this._volume=e,this.sound.volume(e)}get loop(){return this._loop}set loop(e){this._loop=e,this.loopsRemaining=e}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout((()=>{this.sound.play(),this.clearDelay()}),this.delay)}fade(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;e?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout((()=>{this.sound.fade(this._volume,0,t),this.clearFade()}),e)):this.sound.fade(this._volume,0,t)}on(e,t,r){this.sound.on(e,t,r)}off(e,t,r){this.sound.off(e,t,r)}play(){"playing"===this._status||this.sound.playing()||("paused"===this._status?(0===this.sound.seek()?this.replay():this.sound.play(),this._status="playing"):"stopped"===this._status&&(this.replay(),this._status="playing"))}pause(){"playing"===this._status&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},Lte=class{constructor(){this.type="ShapePath",this.color=new vB,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new uH,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){var r;return null!==(r=this.currentPath)&&void 0!==r&&r.lineTo(e,t),this}quadraticCurveTo(e,t,r,n){var i;return null!==(i=this.currentPath)&&void 0!==i&&i.quadraticCurveTo(e,t,r,n),this}bezierCurveTo(e,t,r,n,i,s){var a;return null!==(a=this.currentPath)&&void 0!==a&&a.bezierCurveTo(e,t,r,n,i,s),this}splineThru(e){var t;return null!==(t=this.currentPath)&&void 0!==t&&t.splineThru(e),this}toShapes(){let e=0,t=1,r=2,n=3,i=4,s=5,a=6,o={loc:e,t:0};function l(t,n,i,s){let a=t.x,l=n.x,u=i.x,h=s.x,d=t.y,f=n.y,p=i.y,m=s.y,g=(h-u)*(d-p)-(m-p)*(a-u),v=(m-p)*(l-a)-(h-u)*(f-d),y=g/v,b=((l-a)*(d-p)-(f-d)*(a-u))/v;if(0===v&&0!==g||y<=0||y>=1||b<0||b>1)return null;if(0===g&&0===v){for(let u=0;u<2;u++){if(c(0===u?i:s,t,n),o.loc===e){let e=0===u?i:s;return{x:e.x,y:e.y,t:o.t}}if(o.loc===r){return{x:+(a+o.t*(l-a)).toPrecision(10),y:+(d+o.t*(f-d)).toPrecision(10),t:o.t}}}return null}for(let r=0;r<2;r++)if(c(0===r?i:s,t,n),o.loc===e){let e=0===r?i:s;return{x:e.x,y:e.y,t:o.t}}return{x:+(a+y*(l-a)).toPrecision(10),y:+(d+y*(f-d)).toPrecision(10),t:y}}function c(l,c,u){let h,d=u.x-c.x,f=u.y-c.y,p=l.x-c.x,m=l.y-c.y,g=d*m-p*f;return l.x===c.x&&l.y===c.y?(o.loc=e,void(o.t=0)):l.x===u.x&&l.y===u.y?(o.loc=t,void(o.t=1)):void(g<-Number.EPSILON?o.loc=n:g>Number.EPSILON?o.loc=i:d*p<0||f*m<0?o.loc=s:Math.sqrt(d*d+f*f)<Math.sqrt(p*p+m*m)?o.loc=a:(h=0!==d?p/d:m/f,o.loc=r,o.t=h))}function u(e,t,r){let n=new eB;t.getCenter(n);let i=[];return r.forEach((t=>{t.boundingBox.containsPoint(n)&&function(e,t){let r=[],n=[];for(let i=1;i<e.length;i++){let s=e[i-1],a=e[i];for(let e=1;e<t.length;e++){let i=l(s,a,t[e-1],t[e]);null!==i&&void 0===r.find((e=>e.t<=i.t+Number.EPSILON&&e.t>=i.t-Number.EPSILON))&&(r.push(i),n.push(new eB(i.x,i.y)))}}return n}(e,t.points).forEach((e=>{i.push({identifier:t.identifier,isCW:t.isCW,point:e})}))})),i.sort(((e,t)=>e.point.x-t.point.x)),i}let h=0,d=999999999,f=-999999999,p=[];this.subPaths.forEach((e=>{let t=e.getPoints(),r=-999999999,n=999999999,i=-999999999,s=999999999;for(let a=0;a<t.length;a++){let e=t[a];e.y>r&&(r=e.y),e.y<n&&(n=e.y),e.x>i&&(i=e.x),e.x<s&&(s=e.x)}f<=i&&(f=i+1),d>=s&&(d=s-1),t.length&&p.push({curves:e.curves,points:t,isCW:VH.isClockWise(t),identifier:h++,boundingBox:new hG(new eB(s,n),new eB(i,r))})}));let m=p.map((e=>{var t;return function(e,t,r,n,i){(null==i||""===i)&&(i="nonzero");let s=new eB;e.boundingBox.getCenter(s);let a=u([new eB(r,s.y),new eB(n,s.y)],e.boundingBox,t);a.sort(((e,t)=>e.point.x-t.point.x));let o=[],l=[];a.forEach((t=>{t.identifier===e.identifier?o.push(t):l.push(t)}));let c=o[0].point.x,h=[],d=0;for(;d<l.length&&l[d].point.x<c;)h.length>0&&h[h.length-1]===l[d].identifier?h.pop():h.push(l[d].identifier),d++;if(h.push(e.identifier),"evenodd"===i){let t=h.length%2===0,r=h[h.length-2];return{identifier:e.identifier,isHole:t,for:r}}if("nonzero"===i){let r=!0,n=null,i=null;for(let e=0;e<h.length;e++){let s=h[e];t[s]&&(r?(i=t[s].isCW,r=!1,n=s):i!==t[s].isCW&&(i=t[s].isCW,r=!0))}return{identifier:e.identifier,isHole:r,for:n}}console.warn('fill-rule: "'+i+'" is currently not implemented.')}(e,p,d,f,null===(t=this.userData)||void 0===t?void 0:t.style.fillRule)})),g=[];return p.forEach((e=>{let t=m[e.identifier];if(t&&!t.isHole){let t=new gH;t.curves=e.curves,m.filter((t=>(null===t||void 0===t?void 0:t.isHole)&&t.for===e.identifier)).forEach((e=>{if(e){let r=p[e.identifier],n=new uH;n.curves=r.curves,t.holes.push(n)}})),g.push(t)}})),g}},Nte=!1,Bte=new Promise((e=>{Ite=e})),zte=!1;function Fte(){if(Nte=!0,!zte)return Ote||(Ote=async function(){let e=await r.e(946).then(r.bind(r,946));Ite(e),zte=!0}(),Ote)}var jte=new class{async load(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},{load:n}=await Bte;n(e,((e,n)=>{e||!n?r(null!==e&&void 0!==e?e:"Something went wrong"):t(n)}))}async parse(e){let{parse:t,Bidi:r}=await Bte;try{let n=t(e),i=new r,s=e=>n.charToGlyphIndex(e.char);return i.registerModifier("glyphIndex",null,s),i.applyFeatures(n,n.defaultRenderOptions.features),{font:n,bidi:i}}catch(U0){console.error(U0)}}};async function Ute(e){let t,r,n=!1;if(e.url?(t=await async function(e){return await(await fetch(e)).arrayBuffer()}(e.url),r=e.url,n=e.url.startsWith("/")):e.data&&(t=e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength)),t){if(!Nte)return{font:void 0,url:r,intercepted:n,arr:t,bidi:null};{let e=await jte.parse(t);if(e)return{font:e.font,url:r,intercepted:n,arr:t,bidi:e.bidi}}}}function Vte(e,t){return t.state.glyphIndex===e||t.state.fina===e||t.state.medi===e||t.state.init===e}var Hte=class{constructor(e){var t;this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=null!==(t=e.isUserFont)&&void 0!==t&&t,this._loadingPromise=Ute(e).then((e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)}))}update(e){var t;this._isLoaded=!1,this._isUserFont=null!==(t=e.isUserFont)&&void 0!==t&&t,this._loadingPromise=Ute(e).then((e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)}))}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(e,t,r){if(!this._bidi)return[];let n=this._bidi;n.getTextGlyphs(t);let i=n.tokenizer.tokens,s=[],a=0,o=r.length===i.length;for(let l=0;l<r.length;l++){let n=r[l].index,c=String.fromCharCode(r[l].unicode),u=i[a];if(Vte(n,u)||o)s.push({char:c,index:n,replacements:[u.state.glyphIndex],replacementChars:[u.char]}),a++;else{let r=u.char,i="",o=[u.state.glyphIndex],l=[],h=!1;for(;!h;)a++,i=t.charAt(a),r+=i,o.push(e.charToGlyphIndex(i)),l=e.stringToGlyphs(r),1===l.length&&l[0].index===n&&(h=!0),a>t.length&&(h=!0);s.push({char:c,index:n,replacements:o,replacementChars:Array.from(r)}),a++}}return s}generateShapes(e,t){if(!this._isLoaded)return;let r,n=this.font,i=t.fontSize/this.unitsPerEm,s=t.fontSize*t.lineHeight,a=e.map((e=>this.getTextWidth(e,t))),o=t.width,l=this.getCharWidth("\n",t),c=1===t.horizontalAlign?l:0,u=this.computeSpaceWidthForLine(e,0,t),h=this.getLineInitialOffsetX(a[0],o,t.horizontalAlign,e[0],l),d=this.getLineInitialOffsetY(s,e.length,t.height,i,t.verticalAlign),f=[],p=e.map((e=>[])),m=e.map((e=>[]));for(let y=0;y<e.length;y++){let g=e[y],b={features:{liga:!0}},w=[];try{w=n.stringToGlyphs(g,b)}catch(v){console.warn(v)}h=this.getLineInitialOffsetX(a[y],o,t.horizontalAlign,g,l);let x=[];try{x=this.reverseLigaturesTable(n,g,w)}catch(v){console.warn(v)}u=this.computeSpaceWidthForLine(e,y,t);for(let e=0;e<w.length;e++){let s=w[e],a=0===s.index?"\n":s.unicode?String.fromCharCode(s.unicode):void 0,o=x[e],l=0,g=0;0===e&&2===t.horizontalAlign&&void 0!==s.leftSideBearing&&(g=-s.leftSideBearing*i),r&&(l=n.getKerningValue(s,r)*i),h+=g+l;let v=0;if("\n"===a)v=c;else if(" "===a)v=u;else{let e=this.createPath(s,i,h,d,t);e&&(v=e.offsetX-(l+g),f.push(e.path))}if(1===o.replacements.length)m[y].push([h,d]),p[y].push(v);else{let e=o.replacements.map((e=>{var t;return(null!==(t=n.glyphs.get(e).advanceWidth)&&void 0!==t?t:0)*i})),t=e.reduce(((e,t)=>e+t),0),r=e.map((e=>e/t)),s=h;for(let n=0;n<r.length;n++){let e=v*r[n];m[y].push([s,d]),p[y].push(e),s+=e}}h+=v,r=s}d-=s}let g=[];for(let y=0,b=f.length;y<b;y++)g.push(...f[y].toShapes());return{shapes:g,charWidths:p,lineWidths:a,charCoords:m}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var e,t;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.ascender)&&void 0!==e?e:0}get descender(){var e,t;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.descender)&&void 0!==e?e:0}get familyName(){var e,t;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.names.fontFamily)&&void 0!==e?e:""}get subfamilyName(){var e,t;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.names.fontSubfamily)&&void 0!==e?e:""}get unitsPerEm(){var e,t;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.unitsPerEm)&&void 0!==e?e:1}getLineInitialOffsetX(e,t,r,n,i){return(3===r||2===r)&&n.indexOf("\n")>=0&&(e-=i),3===r?.5*t-.5*e:2===r?t-e:0}getLineInitialOffsetY(e,t,r,n,i){let s=t*e,a=e-Math.abs(this.ascender-this.descender)*n,o=-this.ascender*n-a/2;return 3===i?-(r-s-o):2===i?-(.5*r-.5*s-o):o}createPath(e,t,r,n,i){var s;let a=e.getPath(r,-n,i.fontSize,{kerning:!1,letterSpacing:i.letterSpacing});if(!a)return void console.error('THREE.Font: character "'+e+'" does not exists in font family '+this.familyName+".");let o=new Lte,l=(null!==(s=e.advanceWidth)&&void 0!==s?s:1)*t;if(e)for(let u of a.commands){var c;let e=null===(c=o.currentPath)||void 0===c?void 0:c.currentPoint;if(!e||"Z"===u.type||e.x!==u.x||-e.y!==u.y)switch(u.type){case"M":o.moveTo(u.x,-u.y);break;case"L":o.lineTo(u.x,-u.y);break;case"Q":o.quadraticCurveTo(u.x1,-u.y1,u.x,-u.y);break;case"C":o.bezierCurveTo(u.x1,-u.y1,u.x2,-u.y2,u.x,-u.y)}}return o.subPaths.forEach((e=>{let t=function(e){if(e.length){let t=e[0];if(t instanceof iH)return t.v1;if(t instanceof rH||t instanceof aH)return t.v0}}(e.curves);void 0!==t&&e.currentPoint.distanceTo(t)>0&&e.lineTo(t.x,t.y)})),{offsetX:l+i.fontSize*i.letterSpacing,path:o}}getCharWidth(e,t){var r,n;return null!==(r=null===(n=this.font)||void 0===n?void 0:n.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))&&void 0!==r?r:0}getTextWidth(e,t){var r,n;return null!==(r=null===(n=this.font)||void 0===n?void 0:n.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))&&void 0!==r?r:0}computeSpaceWidthForLine(e,t,r){let n=this.getCharWidth(" ",r),i=e[t];if(i){let s=this.countSpaces(i.trimEnd());if(4===r.horizontalAlign&&t<e.length-1&&s){return(r.width-(this.getTextWidth(i,r)-s*n))/s}}return n}countSpaces(e){return(e.match(/ /g)||[]).length}};var Wte=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(e){return this.objects.get(e)}get size(){return this.objects.size}get(e,t,r){let n=this.objects.get(e);return void 0===n?(n=this.createObject(e,t,r),this.objects.set(e,n)):n.isShared=!0,n}forceDelete(e){let t=this.objects.get(e);t&&(this.disposeObject(t),this.objects.delete(e))}mutateIfUnique(e,t){let r=this.objects.get(e);if(r&&!0!==r.isShared)return this.objects.delete(e),this.objects.set(t,r),r}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(e,t){t===this.objects.get(e)&&this.unreachable.delete(e)}endGc(){this.unreachable.forEach((e=>{this.disposeObject(this.objects.get(e)),this.objects.delete(e)})),this.unreachable.clear()}dispose(){this.objects.forEach((e=>{this.disposeObject(e)})),this.objects.clear()}},Gte=class extends Wte{constructor(e){super(),this.flatShading=e}disposeObject(e){e.dispose()}createObject(e,t,r){let n=J8(e,t,this.flatShading,r);return n.computeBoundingSphere(),n}},qte={markNeedsUpdateRendererDirty:()=>{}},Xte=1e3,Yte=512e3;var Kte="https://hooks.spline.design",Qte="".concat(Kte,"/events?hashFile="),Zte=("".concat(Kte,"/"),class{constructor(e,t){this.id=e,this.userWebhook=t,this.result=void 0,this._connected=!1,this.emitter=P8(),this.reconnectWaitFor=Xte,this._onError=e=>{var t,r,n;null!==(t=this.eventSource)&&void 0!==t&&t.removeEventListener("message",this._onMessage),null!==(r=this.eventSource)&&void 0!==r&&r.removeEventListener("error",this._onError),null!==(n=this.eventSource)&&void 0!==n&&n.removeEventListener("open",this._onConnected),this._scheduleReconnect()},this._onConnected=e=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=Xte,this._connected=!0},this._onDisconnected=()=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=Xte,this._connected=!1},this._onMessage=e=>{let t,r=e.data;try{t=JSON.parse(r)}catch(U0){console.error("Error parsing webhook message",U0)}if(t){let e=!1;this.userWebhook.parametersSchemas.forEach((r=>{let{data:n}=r;void 0!==t[n.name]&&function(e,t){let r=typeof e;return!!(("string"===t||"number"===t)&&r===t||"boolean"===t&&("true"===e||"false"===e||!0===e||!1===e)||"image"===t&&"string"===r&&e.startsWith("http"))}(t[n.name],n.type)&&(void 0===this.result&&(this.result={}),this.result[n.name]=t[n.name],e=!0)})),e&&this.emitter.emit("message",{userWebhookId:this.id})}}}connect(){clearTimeout(this.scheduledReconnectHandle),this.userWebhook.url&&(this.eventSource=new EventSource(Qte+this.userWebhook.url),this.eventSource.addEventListener("message",this._onMessage),this.eventSource.addEventListener("error",this._onError),this.eventSource.addEventListener("open",this._onConnected))}disconnect(){var e,t,r,n;null!==(e=this.eventSource)&&void 0!==e&&e.removeEventListener("message",this._onMessage),null!==(t=this.eventSource)&&void 0!==t&&t.removeEventListener("error",this._onError),null!==(r=this.eventSource)&&void 0!==r&&r.removeEventListener("open",this._onConnected),null!==(n=this.eventSource)&&void 0!==n&&n.close(),this._onDisconnected(),clearTimeout(this.scheduledReconnectHandle)}_scheduleReconnect(){this.reconnectWaitFor*=2,this.reconnectWaitFor>Yte&&(this.reconnectWaitFor=Yte),clearTimeout(this.scheduledReconnectHandle),this.scheduledReconnectHandle=setTimeout((()=>{this.scheduledReconnectHandle=void 0,this.connect()}),this.reconnectWaitFor)}update(e){this.userWebhook=e}dispose(){this._connected&&this.disconnect()}get connected(){return this._connected}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}getParametersKeys(){return this.userWebhook.parametersSchemas.map((e=>e.data.name))}getParameterValue(e){if(this.getParametersKeys().includes(e)){var t;if(this.result)return null===(t=this.result)||void 0===t?void 0:t[e];for(let t of this.userWebhook.parametersSchemas)if(t.data.name===e)return f2.defaultParameterValueByType(t.data.type)}}}),Jte=globalThis.atob,$te=globalThis.btoa,ere=class{static floatTo16BitPCM(e){let t=new ArrayBuffer(2*e.length),r=new DataView(t),n=0;for(let i=0;i<e.length;i++,n+=2){let t=Math.max(-1,Math.min(1,e[i]));r.setInt16(n,t<0?32768*t:32767*t,!0)}return t}static base64ToArrayBuffer(e){let t=Jte(e),r=t.length,n=new Uint8Array(r);for(let i=0;i<r;i++)n[i]=t.charCodeAt(i);return n.buffer}static arrayBufferToBase64(e){e instanceof Float32Array?e=this.floatTo16BitPCM(e):e instanceof Int16Array&&(e=e.buffer);let t="",r=new Uint8Array(e);for(let n=0;n<r.length;n+=32768){let e=r.subarray(n,n+32768);t+=String.fromCharCode.apply(null,e)}return $te(t)}static mergeInt16Arrays(e,t){if(e instanceof ArrayBuffer&&(e=new Int16Array(e)),t instanceof ArrayBuffer&&(t=new Int16Array(t)),!(e instanceof Int16Array)||!(t instanceof Int16Array))throw new Error("Both items must be Int16Array");let r=new Int16Array(e.length+t.length);for(let n=0;n<e.length;n++)r[n]=e[n];for(let n=0;n<t.length;n++)r[e.length+n]=t[n];return r}static generateId(e){let t="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",r=Array((arguments.length>1&&void 0!==arguments[1]?arguments[1]:21)-e.length).fill(0).map((e=>t[Math.floor(58*Math.random())])).join("");return"".concat(e).concat(r)}},tre=e=>new Promise((t=>setTimeout((()=>t()),e))),rre=class{constructor(){this.eventHandlers={},this.nextEventHandlers={}}clearEventHandlers(){return this.eventHandlers={},this.nextEventHandlers={},!0}on(e,t){return this.eventHandlers[e]=this.eventHandlers[e]||[],this.eventHandlers[e].push(t),t}onNext(e,t){return this.nextEventHandlers[e]=this.nextEventHandlers[e]||[],this.nextEventHandlers[e].push(t),t}off(e,t){let r=this.eventHandlers[e]||[];if(t){let n=r.indexOf(t);if(-1===n)throw new Error('Could not turn off specified event listener for "'.concat(e,'": not found as a listener'));r.splice(n,1)}else delete this.eventHandlers[e];return!0}offNext(e,t){let r=this.nextEventHandlers[e]||[];if(t){let n=r.indexOf(t);if(-1===n)throw new Error('Could not turn off specified next event listener for "'.concat(e,'": not found as a listener'));r.splice(n,1)}else delete this.nextEventHandlers[e];return!0}async waitForNext(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Date.now();for(this.onNext(e,(e=>t=e));!t;){if(r&&Date.now()-n>r)return null;await tre(1)}return t}dispatch(e,t){let r=[].concat(this.eventHandlers[e]||[]);for(let i of r)i(t);let n=[].concat(this.nextEventHandlers[e]||[]);for(let i of n)i(t);return delete this.nextEventHandlers[e],!0}},nre=class extends rre{constructor(){let{url:e,apiKey:t,dangerouslyAllowAPIKeyInBrowser:r,debug:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(super(),this.defaultUrl="wss://api.openai.com/v1/realtime",this.url=e||this.defaultUrl,this.apiKey=t||null,this.debug=!!n,this.ws=null,globalThis.document&&this.apiKey&&!r)throw new Error('Can not provide API key in the browser without "dangerouslyAllowAPIKeyInBrowser" set to true')}isConnected(){return!!this.ws}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=["[Websocket/".concat((new Date).toISOString(),"]")].concat(t).map((e=>"object"==typeof e&&null!==e?JSON.stringify(e,null,2):e));return this.debug&&console.log(...n),!0}async connect(){let{model:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{model:"gpt-4o-realtime-preview-2024-10-01"};if(!this.apiKey&&this.url===this.defaultUrl&&console.warn('No apiKey provided for connection to "'.concat(this.url,'"')),this.isConnected())throw new Error("Already connected");if(globalThis.document){this.apiKey&&console.warn("Warning: Connecting using API key in the browser, this is not recommended");let t=new(0,globalThis.WebSocket)("".concat(this.url).concat(e?"?model=".concat(e):""),["realtime","openai-insecure-api-key.".concat(this.apiKey),"openai-beta.realtime-v1"]);return t.addEventListener("message",(e=>{let t=JSON.parse(e.data);this.receive(t.type,t)})),new Promise(((e,r)=>{let n=()=>{this.disconnect(t),r(new Error('Could not connect to "'.concat(this.url,'"')))};t.addEventListener("error",n),t.addEventListener("open",(()=>{this.log('Connected to "'.concat(this.url,'"')),t.removeEventListener("error",n),t.addEventListener("error",(()=>{this.disconnect(t),this.log('Error, disconnected from "'.concat(this.url,'"')),this.dispatch("close",{error:!0})})),t.addEventListener("close",(()=>{this.disconnect(t),this.log('Disconnected from "'.concat(this.url,'"')),this.dispatch("close",{error:!1})})),this.ws=t,e(!0)}))}))}}disconnect(e){if(!e||this.ws===e)return this.ws&&this.ws.close(),this.ws=null,!0}receive(e,t){return this.log("received:",e,t),this.dispatch("server.".concat(e),t),this.dispatch("server.*",t),!0}send(e,t){if(!this.isConnected())throw new Error("RealtimeAPI is not connected");if("object"!=typeof(t=t||{}))throw new Error("data must be an object");let r=u({event_id:ere.generateId("evt_"),type:e},t);return this.dispatch("client.".concat(e),r),this.dispatch("client.*",r),this.log("sent:",e,r),this.ws.send(JSON.stringify(r)),!0}},ire=class{constructor(){bL(this,"defaultFrequency",24e3),bL(this,"EventProcessors",{"conversation.item.created":e=>{let{item:t}=e,r=JSON.parse(JSON.stringify(t));if(this.itemLookup[r.id]||(this.itemLookup[r.id]=r,this.items.push(r)),r.formatted={},r.formatted.audio=new Int16Array(0),r.formatted.text="",r.formatted.transcript="",this.queuedSpeechItems[r.id]&&(r.formatted.audio=this.queuedSpeechItems[r.id].audio,delete this.queuedSpeechItems[r.id]),r.content){let e=r.content.filter((e=>["text","input_text"].includes(e.type)));for(let t of e)r.formatted.text+=t.text}return this.queuedTranscriptItems[r.id]&&(r.formatted.transcript=this.queuedTranscriptItems.transcript,delete this.queuedTranscriptItems[r.id]),"message"===r.type?"user"===r.role?(r.status="completed",this.queuedInputAudio&&(r.formatted.audio=this.queuedInputAudio,this.queuedInputAudio=null)):r.status="in_progress":"function_call"===r.type?(r.formatted.tool={type:"function",name:r.name,call_id:r.call_id,arguments:""},r.status="in_progress"):"function_call_output"===r.type&&(r.status="completed",r.formatted.output=r.output),{item:r,delta:null}},"conversation.item.truncated":e=>{let{item_id:t,audio_end_ms:r}=e,n=this.itemLookup[t];if(!n)throw new Error('item.truncated: Item "'.concat(t,'" not found'));let i=Math.floor(r*this.defaultFrequency/1e3);return n.formatted.transcript="",n.formatted.audio=n.formatted.audio.slice(0,i),{item:n,delta:null}},"conversation.item.deleted":e=>{let{item_id:t}=e,r=this.itemLookup[t];if(!r)throw new Error('item.deleted: Item "'.concat(t,'" not found'));delete this.itemLookup[r.id];let n=this.items.indexOf(r);return n>-1&&this.items.splice(n,1),{item:r,delta:null}},"conversation.item.input_audio_transcription.completed":e=>{let{item_id:t,content_index:r,transcript:n}=e,i=this.itemLookup[t],s=n||" ";return i?(i.content[r].transcript=n,i.formatted.transcript=s,{item:i,delta:{transcript:n}}):(this.queuedTranscriptItems[t]={transcript:s},{item:null,delta:null})},"input_audio_buffer.speech_started":e=>{let{item_id:t,audio_start_ms:r}=e;return this.queuedSpeechItems[t]={audio_start_ms:r},{item:null,delta:null}},"input_audio_buffer.speech_stopped":(e,t)=>{let{item_id:r,audio_end_ms:n}=e;this.queuedSpeechItems[r]||(this.queuedSpeechItems[r]={audio_start_ms:n});let i=this.queuedSpeechItems[r];if(i.audio_end_ms=n,t){let e=Math.floor(i.audio_start_ms*this.defaultFrequency/1e3),r=Math.floor(i.audio_end_ms*this.defaultFrequency/1e3);i.audio=t.slice(e,r)}return{item:null,delta:null}},"response.created":e=>{let{response:t}=e;return this.responseLookup[t.id]||(this.responseLookup[t.id]=t,this.responses.push(t)),{item:null,delta:null}},"response.output_item.added":e=>{let{response_id:t,item:r}=e,n=this.responseLookup[t];if(!n)throw new Error('response.output_item.added: Response "'.concat(t,'" not found'));return n.output.push(r.id),{item:null,delta:null}},"response.output_item.done":e=>{let{item:t}=e;if(!t)throw new Error('response.output_item.done: Missing "item"');let r=this.itemLookup[t.id];if(!r)throw new Error('response.output_item.done: Item "'.concat(t.id,'" not found'));return r.status=t.status,{item:r,delta:null}},"response.content_part.added":e=>{let{item_id:t,part:r}=e,n=this.itemLookup[t];if(!n)throw new Error('response.content_part.added: Item "'.concat(t,'" not found'));return n.content.push(r),{item:n,delta:null}},"response.audio_transcript.delta":e=>{let{item_id:t,content_index:r,delta:n}=e,i=this.itemLookup[t];if(!i)throw new Error('response.audio_transcript.delta: Item "'.concat(t,'" not found'));return i.content[r].transcript+=n,i.formatted.transcript+=n,{item:i,delta:{transcript:n}}},"response.audio.delta":e=>{let{item_id:t,content_index:r,delta:n}=e,i=this.itemLookup[t];if(!i)throw new Error('response.audio.delta: Item "'.concat(t,'" not found'));let s=ere.base64ToArrayBuffer(n),a=new Int16Array(s);return i.formatted.audio=ere.mergeInt16Arrays(i.formatted.audio,a),{item:i,delta:{audio:a}}},"response.text.delta":e=>{let{item_id:t,content_index:r,delta:n}=e,i=this.itemLookup[t];if(!i)throw new Error('response.text.delta: Item "'.concat(t,'" not found'));return i.content[r].text+=n,i.formatted.text+=n,{item:i,delta:{text:n}}},"response.function_call_arguments.delta":e=>{let{item_id:t,delta:r}=e,n=this.itemLookup[t];if(!n)throw new Error('response.function_call_arguments.delta: Item "'.concat(t,'" not found'));return n.arguments+=r,n.formatted.tool.arguments+=r,{item:n,delta:{arguments:r}}}}),this.clear()}clear(){return this.itemLookup={},this.items=[],this.responseLookup={},this.responses=[],this.queuedSpeechItems={},this.queuedTranscriptItems={},this.queuedInputAudio=null,!0}queueInputAudio(e){return this.queuedInputAudio=e,e}processEvent(e){if(!e.event_id)throw console.error(e),new Error('Missing "event_id" on event');if(!e.type)throw console.error(e),new Error('Missing "type" on event');let t=this.EventProcessors[e.type];if(!t)throw new Error('Missing conversation event processor for "'.concat(e.type,'"'));for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return t.call(this,e,...n)}getItem(e){return this.itemLookup[e]||null}getItems(){return this.items.slice()}},sre=class extends rre{constructor(){let{url:e,apiKey:t,dangerouslyAllowAPIKeyInBrowser:r,debug:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.defaultSessionConfig={modalities:["text","audio"],instructions:"",voice:"alloy",input_audio_format:"pcm16",output_audio_format:"pcm16",input_audio_transcription:null,turn_detection:null,tools:[],tool_choice:"auto",temperature:.8,max_response_output_tokens:4096},this.sessionConfig={},this.transcriptionModels=[{model:"whisper-1"}],this.defaultServerVadConfig={type:"server_vad",threshold:.5,prefix_padding_ms:300,silence_duration_ms:200},this.realtime=new nre({url:e,apiKey:t,dangerouslyAllowAPIKeyInBrowser:r,debug:n}),this.conversation=new ire,this._resetConfig(),this._addAPIEventHandlers()}_resetConfig(){return this.sessionCreated=!1,this.tools={},this.sessionConfig=JSON.parse(JSON.stringify(this.defaultSessionConfig)),this.inputAudioBuffer=new Int16Array(0),!0}_addAPIEventHandlers(){var e=this;this.realtime.on("client.*",(e=>{let t={time:(new Date).toISOString(),source:"client",event:e};this.dispatch("realtime.event",t)})),this.realtime.on("server.*",(e=>{let t={time:(new Date).toISOString(),source:"server",event:e};this.dispatch("realtime.event",t)})),this.realtime.on("server.session.created",(()=>this.sessionCreated=!0));let t=function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];let{item:s,delta:a}=e.conversation.processEvent(t,...n);return{item:s,delta:a}},r=function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];let{item:a,delta:o}=t(r,...i);return a&&e.dispatch("conversation.updated",{item:a,delta:o}),{item:a,delta:o}},n=async e=>{try{let t=JSON.parse(e.arguments),r=this.tools[e.name];if(!r)throw new Error('Tool "'.concat(e.name,'" has not been added'));let n=await r.handler(t);this.realtime.send("conversation.item.create",{item:{type:"function_call_output",call_id:e.call_id,output:JSON.stringify(n)}})}catch(Q0){this.realtime.send("conversation.item.create",{item:{type:"function_call_output",call_id:e.call_id,output:JSON.stringify({error:Q0.message})}})}this.createResponse()};return this.realtime.on("server.response.created",t),this.realtime.on("server.response.output_item.added",t),this.realtime.on("server.response.content_part.added",t),this.realtime.on("server.input_audio_buffer.speech_started",(e=>{t(e),this.dispatch("conversation.interrupted")})),this.realtime.on("server.input_audio_buffer.speech_stopped",(e=>t(e,this.inputAudioBuffer))),this.realtime.on("server.conversation.item.created",(e=>{let{item:t}=r(e);this.dispatch("conversation.item.appended",{item:t}),"completed"===t.status&&this.dispatch("conversation.item.completed",{item:t})})),this.realtime.on("server.conversation.item.truncated",r),this.realtime.on("server.conversation.item.deleted",r),this.realtime.on("server.conversation.item.input_audio_transcription.completed",r),this.realtime.on("server.response.audio_transcript.delta",r),this.realtime.on("server.response.audio.delta",r),this.realtime.on("server.response.text.delta",r),this.realtime.on("server.response.function_call_arguments.delta",r),this.realtime.on("server.response.output_item.done",(async e=>{let{item:t}=r(e);"completed"===t.status&&this.dispatch("conversation.item.completed",{item:t}),t.formatted.tool&&n(t.formatted.tool)})),!0}isConnected(){return this.realtime.isConnected()}reset(){return this.disconnect(),this.clearEventHandlers(),this.realtime.clearEventHandlers(),this._resetConfig(),this._addAPIEventHandlers(),!0}async connect(){if(this.isConnected())throw new Error("Already connected, use .disconnect() first");return await this.realtime.connect(),this.updateSession(),!0}async waitForSessionCreated(){if(!this.isConnected())throw new Error("Not connected, use .connect() first");for(;!this.sessionCreated;)await new Promise((e=>setTimeout((()=>e()),1)));return!0}disconnect(){this.sessionCreated=!1,this.realtime.isConnected()&&this.realtime.disconnect(),this.conversation.clear()}getTurnDetectionType(){var e;return(null===(e=this.sessionConfig.turn_detection)||void 0===e?void 0:e.type)||null}addTool(e,t){if(null===e||void 0===e||!e.name)throw new Error("Missing tool name in definition");let r=null===e||void 0===e?void 0:e.name;if(this.tools[r])throw new Error('Tool "'.concat(r,'" already added. Please use .removeTool("').concat(r,'") before trying to add again.'));if("function"!=typeof t)throw new Error('Tool "'.concat(r,'" handler must be a function'));return this.tools[r]={definition:e,handler:t},this.updateSession(),this.tools[r]}removeTool(e){if(!this.tools[e])throw new Error('Tool "'.concat(e,'" does not exist, can not be removed.'));return delete this.tools[e],!0}deleteItem(e){return this.realtime.send("conversation.item.delete",{item_id:e}),!0}updateSession(){let{modalities:e,instructions:t,voice:r,input_audio_format:n,output_audio_format:i,input_audio_transcription:s,turn_detection:a,tools:o,tool_choice:l,temperature:c,max_response_output_tokens:h}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};void 0!==e&&(this.sessionConfig.modalities=e),void 0!==t&&(this.sessionConfig.instructions=t),void 0!==r&&(this.sessionConfig.voice=r),void 0!==n&&(this.sessionConfig.input_audio_format=n),void 0!==i&&(this.sessionConfig.output_audio_format=i),void 0!==s&&(this.sessionConfig.input_audio_transcription=s),void 0!==a&&(this.sessionConfig.turn_detection=a),void 0!==o&&(this.sessionConfig.tools=o),void 0!==l&&(this.sessionConfig.tool_choice=l),void 0!==c&&(this.sessionConfig.temperature=c),void 0!==h&&(this.sessionConfig.max_response_output_tokens=h);let d=[].concat((o||[]).map((e=>{let t=u({type:"function"},e);if(this.tools[null===t||void 0===t?void 0:t.name])throw new Error('Tool "'.concat(null===t||void 0===t?void 0:t.name,'" has already been defined'));return t})),Object.keys(this.tools).map((e=>u({type:"function"},this.tools[e].definition)))),f=u({},this.sessionConfig);return f.tools=d,this.realtime.isConnected()&&this.realtime.send("session.update",{session:f}),!0}sendUserMessageContent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length){for(let t of e)"input_audio"===t.type&&(t.audio instanceof ArrayBuffer||t.audio instanceof Int16Array)&&(t.audio=ere.arrayBufferToBase64(t.audio));this.realtime.send("conversation.item.create",{item:{type:"message",role:"user",content:e}})}return this.createResponse(),!0}appendInputAudio(e){return e.byteLength>0&&(this.realtime.send("input_audio_buffer.append",{audio:ere.arrayBufferToBase64(e)}),this.inputAudioBuffer=ere.mergeInt16Arrays(this.inputAudioBuffer,e)),!0}createResponse(){return null===this.getTurnDetectionType()&&this.inputAudioBuffer.byteLength>0&&(this.realtime.send("input_audio_buffer.commit"),this.conversation.queueInputAudio(this.inputAudioBuffer),this.inputAudioBuffer=new Int16Array(0)),this.realtime.send("response.create"),!0}cancelResponse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)return this.realtime.send("response.cancel"),{item:null};if(e){let r=this.conversation.getItem(e);if(!r)throw new Error('Could not find item "'.concat(e,'"'));if("message"!==r.type)throw new Error('Can only cancelResponse messages with type "message"');if("assistant"!==r.role)throw new Error('Can only cancelResponse messages with role "assistant"');this.realtime.send("response.cancel");let n=r.content.findIndex((e=>"audio"===e.type));if(-1===n)throw new Error("Could not find audio on item to cancel");return this.realtime.send("conversation.item.truncate",{item_id:e,content_index:n,audio_end_ms:Math.floor(t/this.conversation.defaultFrequency*1e3)}),{item:r}}}async waitForNextItem(){let e=await this.waitForNext("conversation.item.appended"),{item:t}=e;return{item:t}}async waitForNextCompletedItem(){let e=await this.waitForNext("conversation.item.completed"),{item:t}=e;return{item:t}}},are=new Blob(["\nclass AudioProcessor extends AudioWorkletProcessor {\n\n  constructor() {\n    super();\n    this.port.onmessage = this.receive.bind(this);\n    this.initialize();\n  }\n\n  initialize() {\n    this.foundAudio = false;\n    this.recording = false;\n    this.chunks = [];\n  }\n\n  /**\n   * Concatenates sampled chunks into channels\n   * Format is chunk[Left[], Right[]]\n   */\n  readChannelData(chunks, channel = -1, maxChannels = 9) {\n    let channelLimit;\n    if (channel !== -1) {\n      if (chunks[0] && chunks[0].length - 1 < channel) {\n        throw new Error(\n          `Channel ${channel} out of range: max ${chunks[0].length}`\n        );\n      }\n      channelLimit = channel + 1;\n    } else {\n      channel = 0;\n      channelLimit = Math.min(chunks[0] ? chunks[0].length : 1, maxChannels);\n    }\n    const channels = [];\n    for (let n = channel; n < channelLimit; n++) {\n      const length = chunks.reduce((sum, chunk) => {\n        return sum + chunk[n].length;\n      }, 0);\n      const buffers = chunks.map((chunk) => chunk[n]);\n      const result = new Float32Array(length);\n      let offset = 0;\n      for (let i = 0; i < buffers.length; i++) {\n        result.set(buffers[i], offset);\n        offset += buffers[i].length;\n      }\n      channels[n] = result;\n    }\n    return channels;\n  }\n\n  /**\n   * Combines parallel audio data into correct format,\n   * channels[Left[], Right[]] to float32Array[LRLRLRLR...]\n   */\n  formatAudioData(channels) {\n    if (channels.length === 1) {\n      // Simple case is only one channel\n      const float32Array = channels[0].slice();\n      const meanValues = channels[0].slice();\n      return { float32Array, meanValues };\n    } else {\n      const float32Array = new Float32Array(\n        channels[0].length * channels.length\n      );\n      const meanValues = new Float32Array(channels[0].length);\n      for (let i = 0; i < channels[0].length; i++) {\n        const offset = i * channels.length;\n        let meanValue = 0;\n        for (let n = 0; n < channels.length; n++) {\n          float32Array[offset + n] = channels[n][i];\n          meanValue += channels[n][i];\n        }\n        meanValues[i] = meanValue / channels.length;\n      }\n      return { float32Array, meanValues };\n    }\n  }\n\n  /**\n   * Converts 32-bit float data to 16-bit integers\n   */\n  floatTo16BitPCM(float32Array) {\n    const buffer = new ArrayBuffer(float32Array.length * 2);\n    const view = new DataView(buffer);\n    let offset = 0;\n    for (let i = 0; i < float32Array.length; i++, offset += 2) {\n      let s = Math.max(-1, Math.min(1, float32Array[i]));\n      view.setInt16(offset, s < 0 ? s * 0x8000 : s * 0x7fff, true);\n    }\n    return buffer;\n  }\n\n  /**\n   * Retrieves the most recent amplitude values from the audio stream\n   * @param {number} channel\n   */\n  getValues(channel = -1) {\n    const channels = this.readChannelData(this.chunks, channel);\n    const { meanValues } = this.formatAudioData(channels);\n    return { meanValues, channels };\n  }\n\n  /**\n   * Exports chunks as an audio/wav file\n   */\n  export() {\n    const channels = this.readChannelData(this.chunks);\n    const { float32Array, meanValues } = this.formatAudioData(channels);\n    const audioData = this.floatTo16BitPCM(float32Array);\n    return {\n      meanValues: meanValues,\n      audio: {\n        bitsPerSample: 16,\n        channels: channels,\n        data: audioData,\n      },\n    };\n  }\n\n  receive(e) {\n    const { event, id } = e.data;\n    let receiptData = {};\n    switch (event) {\n      case 'start':\n        this.recording = true;\n        break;\n      case 'stop':\n        this.recording = false;\n        break;\n      case 'clear':\n        this.initialize();\n        break;\n      case 'export':\n        receiptData = this.export();\n        break;\n      case 'read':\n        receiptData = this.getValues();\n        break;\n      default:\n        break;\n    }\n    // Always send back receipt\n    this.port.postMessage({ event: 'receipt', id, data: receiptData });\n  }\n\n  sendChunk(chunk) {\n    const channels = this.readChannelData([chunk]);\n    const { float32Array, meanValues } = this.formatAudioData(channels);\n    const rawAudioData = this.floatTo16BitPCM(float32Array);\n    const monoAudioData = this.floatTo16BitPCM(meanValues);\n    this.port.postMessage({\n      event: 'chunk',\n      data: {\n        mono: monoAudioData,\n        raw: rawAudioData,\n      },\n    });\n  }\n\n  process(inputList, outputList, parameters) {\n    // Copy input to output (e.g. speakers)\n    // Note that this creates choppy sounds with Mac products\n    const sourceLimit = Math.min(inputList.length, outputList.length);\n    for (let inputNum = 0; inputNum < sourceLimit; inputNum++) {\n      const input = inputList[inputNum];\n      const output = outputList[inputNum];\n      const channelCount = Math.min(input.length, output.length);\n      for (let channelNum = 0; channelNum < channelCount; channelNum++) {\n        input[channelNum].forEach((sample, i) => {\n          output[channelNum][i] = sample;\n        });\n      }\n    }\n    const inputs = inputList[0];\n    // There's latency at the beginning of a stream before recording starts\n    // Make sure we actually receive audio data before we start storing chunks\n    let sliceIndex = 0;\n    if (!this.foundAudio) {\n      for (const channel of inputs) {\n        sliceIndex = 0; // reset for each channel\n        if (this.foundAudio) {\n          break;\n        }\n        if (channel) {\n          for (const value of channel) {\n            if (value !== 0) {\n              // find only one non-zero entry in any channel\n              this.foundAudio = true;\n              break;\n            } else {\n              sliceIndex++;\n            }\n          }\n        }\n      }\n    }\n    if (inputs && inputs[0] && this.foundAudio && this.recording) {\n      // We need to copy the TypedArray, because the `process`\n      // internals will reuse the same buffer to hold each input\n      const chunk = inputs.map((input) => input.slice(sliceIndex));\n      this.chunks.push(chunk);\n      this.sendChunk(chunk);\n    }\n    return true;\n  }\n}\n\nregisterProcessor('audio_processor', AudioProcessor);\n"],{type:"application/javascript"}),ore=URL.createObjectURL(are),lre=[4186.01,4434.92,4698.63,4978.03,5274.04,5587.65,5919.91,6271.93,6644.88,7040,7458.62,7902.13],cre=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],ure=[],hre=[];for(let r=1;r<=8;r++)for(let e=0;e<lre.length;e++){let t=lre[e];ure.push(t/Math.pow(2,8-r)),hre.push(cre[e]+r)}var dre=[32,2e3],fre=ure.filter(((e,t)=>ure[t]>dre[0]&&ure[t]<dre[1])),pre=hre.filter(((e,t)=>ure[t]>dre[0]&&ure[t]<dre[1])),mre=class{static getFrequencies(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"frequency",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-100,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-30;r||(r=new Float32Array(e.frequencyBinCount),e.getFloatFrequencyData(r));let a,o,l,c=t/2,u=1/r.length*c;if("music"===n||"voice"===n){let e="voice"===n?fre:ure,t=Array(e.length).fill(i);for(let n=0;n<r.length;n++){let i=n*u,s=r[n];for(let r=e.length-1;r>=0;r--)if(i>e[r]){t[r]=Math.max(t[r],s);break}}a=t,o="voice"===n?fre:ure,l="voice"===n?pre:hre}else a=Array.from(r),o=a.map(((e,t)=>u*t)),l=o.map((e=>"".concat(e.toFixed(2)," Hz")));let h=a.map((e=>Math.max(0,Math.min((e-i)/(s-i),1))));return{values:new Float32Array(h),frequencies:o,labels:l}}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.fftResults=[],t){let{length:r,sampleRate:n}=t,i=new OfflineAudioContext({length:r,sampleRate:n}),s=i.createBufferSource();s.buffer=t;let a=i.createAnalyser();a.fftSize=8192,a.smoothingTimeConstant=.1,s.connect(a);let o=1/60,l=r/n,c=e=>{let t=o*e;t<l&&i.suspend(t).then((()=>{let t=new Float32Array(a.frequencyBinCount);a.getFloatFrequencyData(t),this.fftResults.push(t),c(e+1)})),1===e?i.startRendering():i.resume()};s.start(0),c(1),this.audio=e,this.context=i,this.analyser=a,this.sampleRate=n,this.audioBuffer=t}else{let t=new AudioContext,r=t.createMediaElementSource(e),n=t.createAnalyser();n.fftSize=8192,n.smoothingTimeConstant=.1,r.connect(n),n.connect(t.destination),this.audio=e,this.context=t,this.analyser=n,this.sampleRate=this.context.sampleRate,this.audioBuffer=null}}getFrequencies(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"frequency",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-100,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-30,n=null;if(this.audioBuffer&&this.fftResults.length){let e=this.audio.currentTime/this.audio.duration,t=Math.min(e*this.fftResults.length|0,this.fftResults.length-1);n=this.fftResults[t]}return mre.getFrequencies(this.analyser,this.sampleRate,n,e,t,r)}async resumeIfSuspended(){return"suspended"===this.context.state&&await this.context.resume(),!0}},gre=class{static floatTo16BitPCM(e){let t=new ArrayBuffer(2*e.length),r=new DataView(t),n=0;for(let i=0;i<e.length;i++,n+=2){let t=Math.max(-1,Math.min(1,e[i]));r.setInt16(n,t<0?32768*t:32767*t,!0)}return t}static mergeBuffers(e,t){let r=new Uint8Array(e.byteLength+t.byteLength);return r.set(new Uint8Array(e),0),r.set(new Uint8Array(t),e.byteLength),r.buffer}_packData(e,t){return[new Uint8Array([t,t>>8]),new Uint8Array([t,t>>8,t>>16,t>>24])][e]}pack(e,t){if(null===t||void 0===t||!t.bitsPerSample)throw new Error('Missing "bitsPerSample"');if(null===t||void 0===t||!t.channels)throw new Error('Missing "channels"');if(null===t||void 0===t||!t.data)throw new Error('Missing "data"');let{bitsPerSample:r,channels:n,data:i}=t,s=["RIFF",this._packData(1,52),"WAVE","fmt ",this._packData(1,16),this._packData(0,1),this._packData(0,n.length),this._packData(1,e),this._packData(1,e*n.length*r/8),this._packData(0,n.length*r/8),this._packData(0,r),"data",this._packData(1,n[0].length*n.length*r/8),i],a=new Blob(s,{type:"audio/mpeg"});return{blob:a,url:URL.createObjectURL(a),channelCount:n.length,sampleRate:e,duration:i.byteLength/(n.length*e*2)}}},vre=class{constructor(){let{sampleRate:e=44100,outputToSpeakers:t=!1,debug:r=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.scriptSrc=ore,this.sampleRate=e,this.outputToSpeakers=t,this.debug=!!r,this._deviceChangeCallback=null,this._devices=[],this.stream=null,this.processor=null,this.source=null,this.node=null,this.recording=!1,this._lastEventId=0,this.eventReceipts={},this.eventTimeout=5e3,this._chunkProcessor=()=>{},this._chunkProcessorSize=void 0,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)}}static async decode(e){let t,r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=new AudioContext({sampleRate:arguments.length>1&&void 0!==arguments[1]?arguments[1]:44100});if(e instanceof Blob){if(-1!==n)throw new Error('Can not specify "fromSampleRate" when reading from Blob');r=e,t=await r.arrayBuffer()}else if(e instanceof ArrayBuffer){if(-1!==n)throw new Error('Can not specify "fromSampleRate" when reading from ArrayBuffer');t=e,r=new Blob([t],{type:"audio/wav"})}else{let i,s;if(e instanceof Int16Array){s=e,i=new Float32Array(e.length);for(let t=0;t<e.length;t++)i[t]=e[t]/32768}else if(e instanceof Float32Array)i=e;else{if(!(e instanceof Array))throw new Error('"audioData" must be one of: Blob, Float32Arrray, Int16Array, ArrayBuffer, Array<number>');i=new Float32Array(e)}if(-1===n)throw new Error('Must specify "fromSampleRate" when reading from Float32Array, In16Array or Array');if(n<3e3)throw new Error('Minimum "fromSampleRate" is 3000 (3kHz)');s||(s=gre.floatTo16BitPCM(i));let a={bitsPerSample:16,channels:[i],data:s};r=(new gre).pack(n,a).blob,t=await r.arrayBuffer()}let s=await i.decodeAudioData(t),a=s.getChannelData(0);return{blob:r,url:URL.createObjectURL(r),values:a,audioBuffer:s}}log(){return this.debug&&this.log(...arguments),!0}getSampleRate(){return this.sampleRate}getStatus(){return this.processor?this.recording?"recording":"paused":"ended"}async _event(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(r=r||this.processor,!r)throw new Error("Can not send events without recording first");let n={event:e,id:this._lastEventId++,data:t};r.port.postMessage(n);let i=(new Date).valueOf();for(;!this.eventReceipts[n.id];){if((new Date).valueOf()-i>this.eventTimeout)throw new Error('Timeout waiting for "'.concat(e,'" event'));await new Promise((e=>setTimeout((()=>e(!0)),1)))}let s=this.eventReceipts[n.id];return delete this.eventReceipts[n.id],s}listenForDeviceChange(e){if(null===e&&this._deviceChangeCallback)navigator.mediaDevices.removeEventListener("devicechange",this._deviceChangeCallback),this._deviceChangeCallback=null;else if(null!==e){let t=0,r=[],n=e=>e.map((e=>e.deviceId)).sort().join(","),i=async()=>{let i=++t,s=await this.listDevices();i===t&&n(r)!==n(s)&&(r=s,e(s.slice()))};navigator.mediaDevices.addEventListener("devicechange",i),i(),this._deviceChangeCallback=i}return!0}async requestPermission(){let e=await navigator.permissions.query({name:"microphone"});if("denied"===e.state)window.alert("You must grant microphone access to use this feature.");else if("prompt"===e.state)try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach((e=>e.stop()))}catch(t){window.alert("You must grant microphone access to use this feature.")}return!0}async listDevices(){if(!navigator.mediaDevices||!("enumerateDevices"in navigator.mediaDevices))throw new Error("Could not request user devices");await this.requestPermission();let e=(await navigator.mediaDevices.enumerateDevices()).filter((e=>"audioinput"===e.kind)),t=e.findIndex((e=>"default"===e.deviceId)),r=[];if(-1!==t){let n=e.splice(t,1)[0],i=e.findIndex((e=>e.groupId===n.groupId));-1!==i&&(n=e.splice(i,1)[0]),n.default=!0,r.push(n)}return r.concat(e)}async begin(e){if(this.processor)throw new Error("Already connected: please call .end() to start a new session");if(!navigator.mediaDevices||!("getUserMedia"in navigator.mediaDevices))throw new Error("Could not request user media");try{let t={audio:!0};e&&(t.audio={deviceId:{exact:e}}),this.stream=await navigator.mediaDevices.getUserMedia(t)}catch(a){throw new Error("Could not start media stream")}let t=new AudioContext({sampleRate:this.sampleRate}),r=t.createMediaStreamSource(this.stream);try{await t.audioWorklet.addModule(this.scriptSrc)}catch(B0){throw console.error(B0),new Error("Could not add audioWorklet module: ".concat(this.scriptSrc))}let n=new AudioWorkletNode(t,"audio_processor");n.port.onmessage=e=>{let{event:t,id:r,data:n}=e.data;if("receipt"===t)this.eventReceipts[r]=n;else if("chunk"===t)if(this._chunkProcessorSize){let e=this._chunkProcessorBuffer;this._chunkProcessorBuffer={raw:gre.mergeBuffers(e.raw,n.raw),mono:gre.mergeBuffers(e.mono,n.mono)},this._chunkProcessorBuffer.mono.byteLength>=this._chunkProcessorSize&&(this._chunkProcessor(this._chunkProcessorBuffer),this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)})}else this._chunkProcessor(n)};let i=r.connect(n),s=t.createAnalyser();return s.fftSize=8192,s.smoothingTimeConstant=.1,i.connect(s),this.outputToSpeakers&&(console.warn("Warning: Output to speakers may affect sound quality,\nespecially due to system audio feedback preventative measures.\nuse only for debugging"),s.connect(t.destination)),this.source=r,this.node=i,this.analyser=s,this.processor=n,!0}getFrequencies(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"frequency",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-100,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-30;if(!this.processor)throw new Error("Session ended: please call .begin() first");return mre.getFrequencies(this.analyser,this.sampleRate,null,e,t,r)}async pause(){if(!this.processor)throw new Error("Session ended: please call .begin() first");if(!this.recording)throw new Error("Already paused: please call .record() first");return this._chunkProcessorBuffer.raw.byteLength&&this._chunkProcessor(this._chunkProcessorBuffer),this.log("Pausing ..."),await this._event("stop"),this.recording=!1,!0}async record(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8192;if(!this.processor)throw new Error("Session ended: please call .begin() first");if(this.recording)throw new Error("Already recording: please call .pause() first");if("function"!=typeof e)throw new Error("chunkProcessor must be a function");return this._chunkProcessor=e,this._chunkProcessorSize=t,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)},this.log("Recording ..."),await this._event("start"),this.recording=!0,!0}async clear(){if(!this.processor)throw new Error("Session ended: please call .begin() first");return await this._event("clear"),!0}async read(){if(!this.processor)throw new Error("Session ended: please call .begin() first");return this.log("Reading ..."),await this._event("read")}async save(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.processor)throw new Error("Session ended: please call .begin() first");if(!e&&this.recording)throw new Error("Currently recording: please call .pause() first, or call .save(true) to force");this.log("Exporting ...");let t=await this._event("export");return(new gre).pack(this.sampleRate,t.audio)}async end(){if(!this.processor)throw new Error("Session ended: please call .begin() first");let e=this.processor;this.log("Stopping ..."),await this._event("stop"),this.recording=!1,this.stream.getTracks().forEach((e=>e.stop())),this.log("Exporting ...");let t=await this._event("export",{},e);return this.processor.disconnect(),this.source.disconnect(),this.node.disconnect(),this.analyser.disconnect(),this.stream=null,this.processor=null,this.source=null,this.node=null,(new gre).pack(this.sampleRate,t.audio)}async quit(){return this.listenForDeviceChange(null),this.processor&&await this.end(),!0}},yre=new Blob(["\nclass StreamProcessor extends AudioWorkletProcessor {\n  constructor() {\n    super();\n    this.hasStarted = false;\n    this.hasInterrupted = false;\n    this.outputBuffers = [];\n    this.bufferLength = 128;\n    this.write = { buffer: new Float32Array(this.bufferLength), trackId: null };\n    this.writeOffset = 0;\n    this.trackSampleOffsets = {};\n    this.port.onmessage = (event) => {\n      if (event.data) {\n        const payload = event.data;\n        if (payload.event === 'write') {\n          const int16Array = payload.buffer;\n          const float32Array = new Float32Array(int16Array.length);\n          for (let i = 0; i < int16Array.length; i++) {\n            float32Array[i] = int16Array[i] / 0x8000; // Convert Int16 to Float32\n          }\n          this.writeData(float32Array, payload.trackId);\n        } else if (\n          payload.event === 'offset' ||\n          payload.event === 'interrupt'\n        ) {\n          const requestId = payload.requestId;\n          const trackId = this.write.trackId;\n          const offset = this.trackSampleOffsets[trackId] || 0;\n          this.port.postMessage({\n            event: 'offset',\n            requestId,\n            trackId,\n            offset,\n          });\n          if (payload.event === 'interrupt') {\n            this.hasInterrupted = true;\n          }\n        } else {\n          throw new Error(`Unhandled event \"${payload.event}\"`);\n        }\n      }\n    };\n  }\n\n  writeData(float32Array, trackId = null) {\n    let { buffer } = this.write;\n    let offset = this.writeOffset;\n    for (let i = 0; i < float32Array.length; i++) {\n      buffer[offset++] = float32Array[i];\n      if (offset >= buffer.length) {\n        this.outputBuffers.push(this.write);\n        this.write = { buffer: new Float32Array(this.bufferLength), trackId };\n        buffer = this.write.buffer;\n        offset = 0;\n      }\n    }\n    this.writeOffset = offset;\n    return true;\n  }\n\n  process(inputs, outputs, parameters) {\n    const output = outputs[0];\n    const outputChannelData = output[0];\n    const outputBuffers = this.outputBuffers;\n    if (this.hasInterrupted) {\n      this.port.postMessage({ event: 'stop' });\n      return false;\n    } else if (outputBuffers.length) {\n      this.hasStarted = true;\n      const { buffer, trackId } = outputBuffers.shift();\n      for (let i = 0; i < outputChannelData.length; i++) {\n        outputChannelData[i] = buffer[i] || 0;\n      }\n      if (trackId) {\n        this.trackSampleOffsets[trackId] =\n          this.trackSampleOffsets[trackId] || 0;\n        this.trackSampleOffsets[trackId] += buffer.length;\n      }\n      return true;\n    } else if (this.hasStarted) {\n      this.port.postMessage({ event: 'stop' });\n      return false;\n    } else {\n      return true;\n    }\n  }\n}\n\nregisterProcessor('stream_processor', StreamProcessor);\n"],{type:"application/javascript"}),bre=URL.createObjectURL(yre),wre=class{constructor(){let{sampleRate:e=44100}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.scriptSrc=bre,this.sampleRate=e,this.context=null,this.stream=null,this.analyser=null,this.trackSampleOffsets={},this.interruptedTrackIds={}}async connect(){this.context=new AudioContext({sampleRate:this.sampleRate}),"suspended"===this.context.state&&await this.context.resume();try{await this.context.audioWorklet.addModule(this.scriptSrc)}catch(n0){throw console.error(n0),new Error("Could not add audioWorklet module: ".concat(this.scriptSrc))}let e=this.context.createAnalyser();return e.fftSize=8192,e.smoothingTimeConstant=.1,this.analyser=e,!0}getFrequencies(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"frequency",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-100,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-30;if(!this.analyser)throw new Error("Not connected, please call .connect() first");return mre.getFrequencies(this.analyser,this.sampleRate,null,e,t,r)}_start(){let e=new AudioWorkletNode(this.context,"stream_processor");return e.connect(this.context.destination),e.port.onmessage=t=>{let{event:r}=t.data;if("stop"===r)e.disconnect(),this.stream=null;else if("offset"===r){let{requestId:e,trackId:r,offset:n}=t.data,i=n/this.sampleRate;this.trackSampleOffsets[e]={trackId:r,offset:n,currentTime:i}}},this.analyser.disconnect(),e.connect(this.analyser),this.stream=e,!0}add16BitPCM(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";if("string"!=typeof r)throw new Error("trackId must be a string");if(!this.interruptedTrackIds[r]){if(this.stream||this._start(),e instanceof Int16Array)t=e;else{if(!(e instanceof ArrayBuffer))throw new Error("argument must be Int16Array or ArrayBuffer");t=new Int16Array(e)}return this.stream.port.postMessage({event:"write",buffer:t,trackId:r}),t}}async getTrackSampleOffset(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.stream)return null;let t,r=crypto.randomUUID();for(this.stream.port.postMessage({event:e?"interrupt":"offset",requestId:r});!t;)t=this.trackSampleOffsets[r],await new Promise((e=>setTimeout((()=>e()),1)));let{trackId:n}=t;return e&&n&&(this.interruptedTrackIds[n]=!0),t}async interrupt(){return this.getTrackSampleOffset(!0)}},xre=class{constructor(e,t,r){this.data=e,this.id=t,this.shared=r,this.items=[],this.isConnected=!1,this.rafId=0,this.emitter=P8(),this.voice=0,this.frequencies=new Float32Array([0]),this.onRealTimeEvent=e=>{let{time:t,source:r,event:n}=e;"server"===r&&"spline.ready"===n.type?this.onSessionCreated(n):"server"===r&&"session.created"===n.type&&(this.client.createResponse(),this.client.on("realtime.event",this.onRealTimeEvent))},this.onSessionCreated=async e=>{let t=Object.values(this.client.tools).map((e=>u({type:"function"},e.definition)));this.client.realtime.send("spline.tools",{tools:t}),this.client.realtime.send("spline.connect",{}),await this.wavRecorder.record((e=>this.client.isConnected()&&this.client.appendInputAudio(e.mono)))},this.animate=()=>{if(this.rafId=requestAnimationFrame(this.animate),this.isConnected){let e=this.wavStreamPlayer.analyser?this.wavStreamPlayer.getFrequencies("voice"):{values:new Float32Array([0])},t=e.values.reduce(((e,t)=>e+t),0)/e.values.length;this.voice=t,this.frequencies=e.values,this.emitter.emit("voice",{value:t,frequencies:e.values})}},this.client=new sre({url:"https://relayserver.spline.design/?uuidfile="+e.integration.hash}),this.wavRecorder=new vre({sampleRate:24e3}),this.wavStreamPlayer=new wre({sampleRate:24e3})}update(e){this.data=e,this.client=new sre({url:"https://relayserver.spline.design/?uuidfile="+e.integration.hash})}setColorByName(e,t){let r=this.shared.getColorByName(e);if(r){var n;let{id:e}=r,{r:i,g:s,b:a}=null!==(n=C8.hexStringToRgb(t))&&void 0!==n?n:{r:0,g:0,b:0};this.shared.updateColor(e,{r:i/255,g:s/255,b:a/255})}}connect(){if(this.isConnected)return;this.isConnected=!0,this.client.updateSession({turn_detection:{type:"server_vad"}}),this.client.addTool({name:"set_personality_color",description:"returns a color based on the voice personality of the ai assistant. This should be called by the voice assistant each time it is asks to speak differently. If a color cannot be associated to the personality, the color should be a neutral color.",parameters:{type:"object",properties:{color:{type:"string",description:"css hex color string, reflecting the personality"},personality:{type:"string",description:"the personality of the voice assistant"}},required:["color","personality"]}},(e=>{let{color:t}=e;this.setColorByName("Voice Assistant Color",t)}));let e=this.shared.getVariablesNames().join(", ");this.client.addTool({name:"set_variable",description:"Sets a Spline variable value when asked by the user.",parameters:{type:"object",properties:{name:{type:"string",description:"The name of the variable that needs to be set. Here's a list of available variables: ".concat(e,". It the variable does not exist, don't call the function and warn the user about it.")},value:{type:"string",description:"The new value for this variable, should always be a string even for number and boolean variables, assume that the value will be cast to the proper type afterwards."}},required:["name","value","type"]}},(e=>{let{name:t,value:r}=e,n=this.shared.getVariableByName(t);if(n){let e,t=this.shared.getVariable(n.id);e="number"==typeof t?parseFloat(r):"boolean"==typeof t?"true"===r.toLowerCase():{textValue:r},this.shared.updateVariable(n.id,e)}}));let t=this.shared.getColorNames().join(", ");this.client.addTool({name:"set_color",description:"Sets a Spline color asset value when asked by the user.",parameters:{type:"object",properties:{name:{type:"string",description:"The name of the color asset that needs to be set. Here's a list of available color assets: ".concat(t,". It the color asset does not exist, don't call the function and warn the user about it.")},value:{type:"string",description:"css hex color string"}},required:["name","value"]}},(e=>{let{name:t,value:r}=e;this.setColorByName(t,r)}));let r=this.shared.scene,n=[];r.traverseEntity((e=>{e.data.events.forEach((e=>{if("AIAssistantTrigger"===e.data.type){let{description:t}=e.data;n.push(t)}}))})),this.client.addTool({name:"trigger_event",description:"Trigger an event by name, here are the available events, please match what the user is asking for to one of these if it applies, otherwise don't call the function and warn the user.",parameters:{type:"object",properties:{description:{type:"string",description:"The name of the event that needs to be triggered. Here's a list of available events: ".concat(JSON.stringify(n),".")},direction:{type:"string",description:"default is forward, but can be forward or backward. Always set to forward unless the user ask to reverse or cancel the event, then set to backward."}},required:["description","direction"]}},(e=>{let{description:t,direction:r}=e;this.emitter.emit("trigger_event",{description:t,direction:r})})),this.client.on("error",(e=>console.error(e))),this.client.on("conversation.interrupted",(async()=>{let e=await this.wavStreamPlayer.interrupt();if(null!==e&&void 0!==e&&e.trackId){let{trackId:t,offset:r}=e;await this.client.cancelResponse(t,r)}})),this.client.on("conversation.updated",(async e=>{var t;let{item:r,delta:n}=e,i=this.client.conversation.getItems();if(null!==n&&void 0!==n&&n.audio&&this.wavStreamPlayer.add16BitPCM(n.audio,r.id),"completed"===r.status&&null!==(t=r.formatted.audio)&&void 0!==t&&t.length){let e=await vre.decode(r.formatted.audio,24e3,24e3);r.formatted.file=e}this.items=i})),this.animate()}disconnect(){cancelAnimationFrame(this.rafId),this.voice=0,this.isConnected=!1}async start(){try{await this.wavRecorder.end()}catch(e){}await this.wavRecorder.begin(),this.client.on("realtime.event",this.onRealTimeEvent),await this.wavStreamPlayer.connect(),await this.client.connect()}async stop(){try{this.client.off("realtime.event",this.onRealTimeEvent)}catch(e){console.error(e)}this.client.disconnect(),await this.wavRecorder.end(),await this.wavStreamPlayer.interrupt()}computeAnalysisForListenerEvent(e){if("range"===e.analysis){let t=this.frequencies.slice(...e.analysisRange);return t.reduce(((e,t)=>e+t),0)/t.length}return"single"===e.analysis?this.frequencies[e.analysisSingle]:this.voice}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}};function Sre(e){return"variable_"+e}var _re=class extends kee{constructor(e){super(),this.shared=e}create(e){return new Dee(e,this.shared)}},Cre=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.data=e,this.needsJitter=r,this.enableLocalStorageForPersistentVariables=n,this.geometryCache=new Gte(!0),this.geometryCache2=new Gte(!1),this.imageHolderCache=new _re(this),this.thisContext={scene:qte,shared:this},this.deletedMaterial=new Ste(_1.defaultTwoLayerData("phong"),this.thisContext,""),this.deletedImage=new Iee(V2.emptyImage,this),this.deletedVideo=new Iee(f1.defaultVideo,this),this.materials={},this.images={},this.uiBuffers={},this.videos={},this.colors={},this.audios={},this.particles={},this.fonts={},this.variables={},this.userAPIs={},this.userWebhooks={},this.mouseProperty=null,this.raycastProperty=null,this.requestRender=()=>{this._requestRender&&this._requestRender()},t.images)for(let[i,s]of Object.entries(t.images))this.addImage(i,s);if(t.videos)for(let[i,s]of Object.entries(t.videos))this.addVideo(i,s);if(t.audios)for(let[i,s]of Object.entries(t.audios))this.addAudio(i,s);if(t.particles)for(let[i,s]of Object.entries(t.particles))this.addParticle(i,s);this.reset(e)}setRequestRender(e){this._requestRender=e}getImageLoadPromises(){return Object.values(this.images).map((e=>e.loadPromise))}setEntityOpContext(e){this.entityOpContext=e}reset(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.data=e,this.resetLib(e.lib);for(let{id:r,data:n}of e.variables)this.addVariableHolder(r,n),t&&this.updateVariableHolder(r,n);for(let[r,n]of Object.entries(e.userAPIs))this.addUserAPI(r,n);for(let[r,n]of Object.entries(e.userWebhooks))this.addUserWebhook(r,n);for(let[r,n]of Object.entries(e.images))this.addImage(r,n);for(let[r,n]of Object.entries(e.videos))this.addVideo(r,n);for(let[r,n]of Object.entries(e.colors))this.addColor(r,n);for(let[r,n]of Object.entries(e.materials))this.addMaterial(r,n);for(let[r,n]of Object.entries(e.audios))this.addAudio(r,n);for(let[r,n]of Object.entries(e.particles))this.addParticle(r,n);for(let[r,n]of Object.entries(e.fonts))this.addFont(r,n)}addMaterial(e,t){if(this.materials[e]){let r=this.materials[e];r.reset(t,this.thisContext),r.dispose()}else{let r=new Ste(t,this.thisContext,e);this.materials[e]=r}}deleteMaterial(e){this.materials[e]&&(this.materials[e].nodeMaterialDispose(),delete this.materials[e])}getMaterial(e){return this.materials[e]}getMaterialOrDeletedPlaceholder(e){var t;return null!==(t=this.materials[e])&&void 0!==t?t:this.deletedMaterial}material(e){return"string"==typeof e?this.getMaterialOrDeletedPlaceholder(e):null==e?(console.error("material is undefined or null"),this.deletedMaterial):new xte(e,this.thisContext)}getMaterials(){return this.materials}addImage(e,t){return this.images[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[e].updateSrc(t.data),!0):(this.images[e]=new Iee(t,this),!1)}deleteImage(e){let t=this.images[e];t&&(t.dispose(),delete this.images[e])}getDefaultImage(){return this.images.image_0}getImage(e){var t;return null!==(t=this.images[e])&&void 0!==t?t:this.deletedImage}image(e){return"string"==typeof e?this.getImage(e):this.imageHolderCache.load(e)}addUIBuffer(e,t){return this.uiBuffers[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.uiBuffers[e].updateSrc(t),!0):(this.uiBuffers[e]=new Iee(t,this),!1)}uiBuffer(e){return this.uiBuffers[e]}addVideo(e,t){return this.videos[e]?(this.videos[e].updateSrc(t.data),!0):(this.videos[e]=new Iee(t,this),!1)}deleteVideo(e){let t=this.videos[e];t&&(t.dispose(),delete this.videos[e])}getVideo(e){var t;return null!==(t=this.videos[e])&&void 0!==t?t:this.deletedVideo}video(e){return"string"==typeof e?this.getVideo(e):this.imageHolderCache.load(e)}addColor(e,t){return this.colors[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in t?this.colors[e].setRGBA(t.r,t.g,t.b,t.a):this.colors[e].setRGBA(t.r,t.g,t.b,1),!0):(this.colors[e]=new ate(t.r,t.g,t.b,"a"in t?t.a:1),!1)}updateColor(e,t){if(this.colors[e]){var r,n,i,s;this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let a=this.colors[e];return this.colors[e].r=null!==(r=t.r)&&void 0!==r?r:a.r,this.colors[e].g=null!==(n=t.g)&&void 0!==n?n:a.g,this.colors[e].b=null!==(i=t.b)&&void 0!==i?i:a.b,this.colors[e].a=null!==(s=t.a)&&void 0!==s?s:a.a,!0}return!1}deleteColor(e){this.colors[e]&&delete this.colors[e]}getColor(e){return this.colors[e]}getColorNames(){return Object.values(this.data.colors).map((e=>e.name))}getColorByName(e){for(let t in this.data.colors)if(this.data.colors[t].name===e)return{color:this.colors[t],id:t}}color(e){let t;if("string"!=typeof e)return new X9(e.r,e.g,e.b,"a"in e?e.a:1);{let r=this.getColor(e);r?t=r:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),t=new X9(0,0,0,0))}return t}addAudio(e,t){this.audios[e]=t}getAudio(e){let t=this.audios[e];if(t instanceof Rte)return t;{let r=new Rte({src:t.data});return this.audios[e]=r,r}}addParticle(e,t){this.particles[e]=t}getParticle(e){return this.particles[e]}deleteParticle(e){this.particles[e]&&delete this.particles[e]}deleteAudio(e){let t=this.audios[e];t&&(t instanceof Rte&&t.dispose(),delete this.audios[e])}addFont(e,t){this.fonts[e]=new Hte(t),this.fonts[e].loadingPromise.then((()=>this.requestRender()))}getFont(e){return this.fonts[e]}deleteFont(e){this.fonts[e]&&delete this.fonts[e]}dispose(){Object.keys(this.materials).forEach((e=>this.deleteMaterial(e))),this._requestRender=void 0,Object.values(this.audios).forEach((e=>{e instanceof Rte&&e.dispose()})),this.audios={},this.particles={},this.geometryCache.dispose(),this.geometryCache2.dispose()}addVariableHolder(e,t){if(void 0===this.variables[e]){let r=t.value;if(this.enableLocalStorageForPersistentVariables&&t.persistent){let n=localStorage.getItem(Sre(e));r=null!==n?JSON.parse(n):t.value}return this.variables[e]={value:r,locations:[],persistent:t.persistent},"dynamicVariableType"in t&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0),!0}return this.variables[e].value=t.value,!1}resetDynamicVariablePlayState(){for(let e in this.variables)void 0!==this.variables[e].dynamicVariablePlayState&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0)}updateVariableHolder(e,t){this.updateVariable(e,t.value)}updateVariable(e,t){if(void 0===this.variables[e])return!1;this.variables[e].value=t,this.enableLocalStorageForPersistentVariables&&this.variables[e].persistent&&localStorage.setItem(Sre(e),JSON.stringify(t));let r=t;for(;"string"==typeof r;)r=this.variables[r].value;let n=this.entityOpContext.scene;for(let i=this.variables[e].locations.length-1;i>=0;i--){let t=this.variables[e].locations[i];if("material"===t[0]){let e=t[1],i=r,s={scene:n,shared:this},a=t.slice(2);n.traverseMaterial((t=>{var r;let n=null!==(r=t.root)&&void 0!==r?r:t;n.uuid===e&&n.onVariableUpdate(a,i,s)}));let o=this.materials[e];o&&o.onVariableUpdate(a,i,s)}else{let s=n.find(t[0]);if(void 0===s){this.variables[e].locations.splice(i,1);continue}if("geometry"!==t[1]&&"particles"!==t[1]){for(let e=1;e<t.length-1;e++)s=s[t[e]];"rotation"===t[1]?s[t[t.length-1]]=r*$N.DEG2RAD:s[t[t.length-1]]=r}if(s=n.find(t[0]),"ParticleEmitter"===s.type&&s.updateVariableState(r,t),W4.is(s))if("position"===t[1]||"rotation"===t[1]||"scale"===t[1])s.onVariableUpdate();else if("geometry"===t[1]){let e=s;s.component&&(e=s.component);let t=e.dataPatched;e.chooseGeoemtryCache(this).forceDelete(t.geometry),e.createGeometryDelayed(this.entityOpContext),e.onVariableUpdate(!0),e.invalidateDownstreamBooleanData(),e.instances.forEach((e=>{let t=e.dataPatched;e.chooseGeoemtryCache(this).forceDelete(t.geometry),e.createGeometryDelayed(this.entityOpContext),e.onVariableUpdate(!0),e.invalidateDownstreamBooleanData()}))}else"morphTargetInfluences"===t[1]&&s.updateMorphInfluences(t[2],r)}}return this.requestRender(),!0}deleteVariable(e){this.variables[e]&&delete this.variables[e]}getVariable(e,t){if(Array.isArray(e)){var r,n,i,s;if("mouse"===e[0])return null!==(r=null===(n=this.mouseProperty)||void 0===n?void 0:n[e[1]])&&void 0!==r?r:0;if("raycast"===e[0])return null!==(i=null===(s=this.raycastProperty)||void 0===s?void 0:s[e[1]])&&void 0!==i?i:0;let t=this.entityOpContext.scene.find(e[0]);if("width"===e[1]||"height"===e[1]||"depth"===e[1])return t.geometry.userData.parameters[e[1]];for(let r=1;r<e.length;r++)t=t[e[r]];return"rotation"===e[1]&&(t*=$N.RAD2DEG),t}for(let o in this.variables){var a;if(void 0===t)break;let e=this.variables[o],r=null===(a=e.locations)||void 0===a?void 0:a.findIndex((e=>kJ.equal(e,t)));void 0!==r&&-1!==r&&e.locations.splice(r,1)}if("string"==typeof e){let r=e,n=e;do{if(n=r,void 0===this.variables[r])break;let e=this.variables[r].value;t&&void 0!==this.variables[n]&&this.variables[n].locations.push(t),r=e}while("string"==typeof r);return r}return e}getVariables(){return this.variables}getVariablesNames(){return this.data.variables.map((e=>e.data.name))}getVariableByName(e){for(let t of this.data.variables)if(t.data.name===e)return{variable:t.data,id:t.id}}getDynamicVariablePlayState(e){var t;return null===(t=this.variables[e])||void 0===t?void 0:t.dynamicVariablePlayState}setDynamicVariablePlayState(e,t){void 0!==this.variables[e]&&(this.variables[e].dynamicVariablePlayState=t)}getDynamicVariableToggleIsForward(e){var t;return null===(t=this.variables[e])||void 0===t?void 0:t.dynamicVariableToggleIsForward}setDynamicVariableToggleIsForward(e,t){void 0!==this.variables[e]&&(this.variables[e].dynamicVariableToggleIsForward=t)}resetLib(e){for(let[t,r]of Object.entries(e.images))this.addImage(t,r.asset);for(let[t,r]of Object.entries(e.audios))this.addAudio(t,r.asset);for(let[t,r]of Object.entries(e.particles))this.addParticle(t,r.asset);for(let[t,r]of Object.entries(e.colors))this.addColor(t,r.asset);for(let[t,r]of Object.entries(e.fonts))this.addFont(t,r.asset);for(let[t,r]of Object.entries(e.materials))this.addMaterial(t,r.asset);for(let[t,r]of Object.entries(e.videos))this.addVideo(t,r.asset);for(let[t,r]of Object.entries(e.variables))this.addVariableHolder(t,r.asset)}updateLibByOp(e,t){"images"===e.path[0]?1===e.path.length&&1===e.type?this.addImage(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteImage(e.id):"videos"===e.path[0]?1===e.path.length&&1===e.type?this.addVideo(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteVideo(e.id):"audios"===e.path[0]?1===e.path.length&&1===e.type?this.addAudio(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteAudio(e.id):"particles"===e.path[0]?1===e.path.length&&1===e.type?this.addParticle(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteParticle(e.id):"colors"===e.path[0]?1===e.path.length&&1===e.type?this.addColor(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteColor(e.id):"materials"===e.path[0]?1===e.path.length&&1===e.type?this.addMaterial(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteMaterial(e.id):"fonts"===e.path[0]?1===e.path.length&&1===e.type?this.addFont(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteFont(e.id):"variables"===e.path[0]?1===e.path.length&&1===e.type?this.addVariableHolder(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteVariable(e.id):"components"===e.path[0]&&t.updateByLibOp(e,this)}updateByOp(e,t,r){if(this.data=t,"images"===e.path[0])2===e.path.length&&0===e.type?e.props.data&&this.getImage(e.path[1]).updateSrc(e.props.data):1===e.path.length&&1===e.type?this.addImage(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteImage(e.id);else if("videos"===e.path[0])2===e.path.length&&0===e.type?e.props.data&&this.getVideo(e.path[1]).updateSrc(e.props.data):1===e.path.length&&1===e.type?this.addVideo(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteVideo(e.id);else if("audios"===e.path[0])2===e.path.length&&0===e.type?e.props.data&&this.addAudio(e.path[1],t.audios[e.path[1]]):1===e.path.length&&1===e.type?this.addAudio(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteAudio(e.id);else if("particles"===e.path[0])2===e.path.length&&0===e.type?e.props.data&&this.addParticle(e.path[1],t.particles[e.path[1]]):1===e.path.length&&1===e.type?this.addParticle(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteParticle(e.id);else if("colors"===e.path[0])2===e.path.length&&0===e.type?this.updateColor(e.path[1],e.props):1===e.path.length&&1===e.type?this.addColor(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteColor(e.id);else if("materials"===e.path[0])1===e.path.length&&1===e.type?this.addMaterial(e.id,e.data):1===e.path.length&&2===e.type?this.deleteMaterial(e.id):e.path.length>1&&this.getMaterial(e.path[1]).updateByOp(oJ.drop(e,2),t.materials[e.path[1]],{shared:this,scene:r});else if("fonts"===e.path[0])2===e.path.length&&0===e.type?this.updateFont(e.path[1],e,r):1===e.path.length&&1===e.type?this.addFont(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteFont(e.id);else if("variables"===e.path[0])2===e.path.length&&0===e.type?"value"in e.props?this.updateVariable(e.path[1],e.props.value):"persistent"in e.props&&(this.variables[e.path[1]].persistent=e.props.persistent):1===e.path.length&&4===e.type?this.addVariableHolder(e.id,e.data):1===e.path.length&&5===e.type&&this.deleteVariable(e.id);else if("userAPIs"===e.path[0]){if(1===e.path.length&&1===e.type)this.addUserAPI(e.id,e.data);else if(1===e.path.length&&2===e.type)this.deleteUserAPI(e.id);else if("string"==typeof e.path[1]){let r=t.userAPIs[e.path[1]];if(r){let t=0===e.type&&void 0===e.props.debounce,n=this.getUserAPI(e.path[1]);n instanceof xre?n.update(r):null===n||void 0===n||n.update(r,this,t)}}}else if("userWebhooks"===e.path[0]){if(1===e.path.length&&1===e.type)this.addUserWebhook(e.id,e.data);else if(1===e.path.length&&2===e.type)this.deleteUserWebhook(e.id);else if("string"==typeof e.path[1]){var n;let r=t.userWebhooks[e.path[1]];r&&(null===(n=this.getUserWebhook(e.path[1]))||void 0===n||n.update(r))}}else"lib"===e.path[0]&&this.updateLibByOp(oJ.drop(e,1),r)}updateFont(e,t,r){if(t.props.url){let n=this.getFont(e),i=u(u({},this.data.fonts[e]),{},{url:t.props.url});n.update(i),n.loadingPromise.then((()=>this.requestRender())),r.updateFont(e,this)}}addUserAPI(e,t){var r,n;return this.userAPIs[e]?(this.userAPIs[e].update(t,this),!0):(null===(r=this.openAIRealtime)||void 0===r?void 0:r.id)===e?(this.openAIRealtime.update(t),!0):"VoiceAssistant"===(null===(n=t.integration)||void 0===n?void 0:n.type)?(this.openAIRealtime=new xre(t,e,this),!1):(this.userAPIs[e]=new k8(e,t,this),!1)}getUserAPI(e){var t;return(null===(t=this.openAIRealtime)||void 0===t?void 0:t.id)===e?this.openAIRealtime:this.userAPIs[e]}getUserAPIs(){return this.userAPIs}deleteUserAPI(e){let t=this.userAPIs[e];t&&(t.dispose(),delete this.userAPIs[e])}addUserWebhook(e,t){return this.userWebhooks[e]?(this.userWebhooks[e].update(t),!0):(this.userWebhooks[e]=new Zte(e,t),!1)}getUserWebhook(e){return this.userWebhooks[e]}getUserWebhooks(){return this.userWebhooks}deleteUserWebhook(e){let t=this.userWebhooks[e];t&&(t.dispose(),delete this.userWebhooks[e])}get scene(){return this.entityOpContext.scene}},Ere=(new Cre(w2.emptyData()),class extends z9{updateByPatchedOp(e,t,r){if(super.updateByPatchedOp(e,t,r),null!==function(e,t){let r=[];if(t.length!==e.length)return null;for(var n=0;n<e.length;){if("*"===t[n])r.push(e[n]);else if(e[n]!==t[n])return null;n+=1}return r}(e.path,["materials"])&&0===e.type&&Array.isArray(this.material))for(let[n,i]of Object.entries(e.props)){let e=r.shared.material(i);this.material[Number(n)]=e}else if(NJ(e.path,["material"])&&this.material instanceof bte)"material"in t&&"string"!=typeof t.material&&this.material.updateByOp(oJ.drop(e,1),t.material,r);else if(NJ(e.path,["materials","*"])&&Array.isArray(this.material)){let n=e.path[1];if("materials"in t&&n<this.material.length){let i=t.materials[n];"string"!=typeof i&&this.material[n].updateByOp(oJ.drop(e,2),i,r)}}}get needsAO(){return void 0!==this.material&&(Array.isArray(this.material)?this.material[0]:this.material).hasAO}updateState(e,t){var r,n;super.updateState(e,t),void 0!==e.castShadow&&(this.castShadow=e.castShadow),void 0!==e.receiveShadow&&(this.receiveShadow=e.receiveShadow);let i,s=this.dataPatched;if("Mesh"===this.dataPatched.type&&this.dataPatched.geometry.shapeBlendNode&&this.layers.set(9),"Mesh"===this.dataPatched.type&&"ShapeBlendGeometry"===this.dataPatched.geometry.type&&(i={resolutionLevel:this.dataPatched.geometry.resolutionLevel,useChildrenColors:this.dataPatched.geometry.useChildrenColors}),"NonParametricGeometry"!==(null===(r=e.geometry)||void 0===r?void 0:r.type)&&"material"in e&&void 0!==e.material&&(this.disposeMaterial(),this.material=t.shared.material(e.material).getFlavor(s.flatShading,s.side,s.wireframe,i),t.scene.markNeedsUpdateRendererDirty()),("NonParametricGeometry"===(null===(n=e.geometry)||void 0===n?void 0:n.type)||"materials"in e)&&("materials"in e&&void 0!==e.materials?(this.disposeMaterial(),this.material=e.materials.map((e=>t.shared.material(e).getFlavor(s.flatShading,s.side,s.wireframe))),t.scene.markNeedsUpdateRendererDirty()):"material"in e&&void 0!==e.material&&(this.disposeMaterial(),this.material=[t.shared.material(e.material).getFlavor(s.flatShading,s.side,s.wireframe)],t.scene.markNeedsUpdateRendererDirty())),void 0!==e.flatShading||void 0!==e.wireframe||void 0!==e.side)if(Array.isArray(this.material))for(let a=0;a<this.material.length;a++)this.material[a]=this.material[a].getFlavor(s.flatShading,s.side,s.wireframe);else this.material=this.material.getFlavor(s.flatShading,s.side,s.wireframe,i)}disposeMaterial(){this.material&&AZ(this.material).forEach((e=>{e instanceof bte&&(e instanceof Ste||e.nodeMaterialDispose())}))}dispose(){this.disposeMaterial(),super.dispose()}}),Are=new PB,Mre=new CB,Tre=new CB,Pre=new PB,kre=new sz,Dre=class extends Ere{constructor(e,t,r){super(e,t),this.data=t,this.isSkinnedMesh=!1,this.localGeometry=void 0,t.bindMode&&t.bindMatrix&&(this.bindMode=t.bindMode,this.bindMatrix=(new sz).fromArray(t.bindMatrix),this.bindMatrixInverse=new sz)}chooseGeoemtryCache(e){return e.geometryCache}markGeometryAsReachable(e){this.geometryCreateDeleyed instanceof iF&&this.chooseGeoemtryCache(e).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(void 0!==this.localGeometry)return this.localGeometry;if(this.geometryCreateDeleyed instanceof Cre){let e=this.geometryCreateDeleyed,t=this.chooseGeoemtryCache(e);this.geometryCreateDeleyed=t.get(this.dataPatched.geometry,e,this)}return this.geometryCreateDeleyed}set geometry(e){this.localGeometry=e}get is2DAndNoDepth(){let e=this.dataPatched.geometry;return k1.is2DParametricMesh(e.type)&&0===e.depth}get is2DType(){return k1.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return"NonParametricGeometry"===this.geometry.userData.type}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),NJ(e.path,["geometry"])&&this.updateByPatchedOpGeometry(oJ.drop(e,1),t.geometry,r)}removeInteractionGeometry(e){var t;null!==(t=this.localGeometry)&&void 0!==t&&t.dispose(),this.localGeometry=void 0}updateGeometryInteractions(e,t){this.invalidateDownstreamBooleanData();let r=this.data.geometry.type;if("NonParametricGeometry"===r||"SubdivGeometry"===r){let r,n,i,s=e;if(void 0===this.localGeometry){let e=u(u({},this.data.geometry),s);this.localGeometry=J8(e,t,this.data.flatShading,this)}s.scaleBaked?[r,n,i]=s.scaleBaked:({width:r,height:n,depth:i}=s);let a=this.localGeometry.userData;void 0!==a.sxPrev&&e9(this.localGeometry.attributes,r/a.sxPrev,n/a.syPrev,i/a.szPrev),a.sxPrev=r,a.syPrev=n,a.szPrev=i}else{var n;let r=u(u({},this.data.geometry),e);null!==(n=this.localGeometry)&&void 0!==n&&n.dispose(),this.localGeometry=J8(r,t,this.data.flatShading,this)}}refreshAttachedClonersInteractions(){for(let e of this.attachedSurfaceCloners)e.update()}refreshAttachedCloners(e){for(let t of this.attachedSurfaceCloners)e.scene.addPendingUpdateCloner(t.object)}refreshAttachedPaths(e){for(let t of this.attachedPaths)e.scene.addPendingCommand((()=>t.updateShape()))}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.refreshAttachedCloners(e),this.refreshAttachedPaths(e)}updateByPatchedOpGeometry(e,t,r){var n;let i=!1;0===e.type&&0===e.path.length&&Object.keys(e.props).includes("scaleBaked")&&this.geometryCreateDeleyed instanceof o9&&this.chooseGeoemtryCache(r.shared).mutateIfUnique(this.geometryCreateDeleyed.data,t)===this.geometryCreateDeleyed&&(i=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(t,e.props.scaleBaked),this.refreshAttachedCloners(r),this.refreshAttachedPaths(r)),i||(null!==(n=r.scene)&&void 0!==n&&n.markGeometryCacheDirty(),this.createGeometryDelayed(r)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(e,t){this.createGeometryDelayed(t)}updateState(e,t){void 0!==e.geometry&&this.updateGeometryOnStateUpdate(e.geometry,t);let r=e.morphTargetInfluences;if(r){this.updateMorphTargets(),this.geometry.morphTargetsRelative=!0;for(let{data:{name:e,value:n}}of r)this.updateMorphInfluences(e,t.shared.getVariable(n,[this.uuid,"morphTargetInfluences",e]))}super.updateState(e,t)}updateMorphInfluences(e,t){if(void 0===this.morphTargetDictionary)return;let r=this.morphTargetDictionary[e];void 0!==r&&(this.morphTargetInfluences[r]=t)}updateGeometryGroupsIfNeeded(){var e,t;Array.isArray(this.material)&&0===this.geometry.groups.length&&this.geometry.addGroup(0,Math.max(null!==(e=null===(t=this.geometry.getIndex())||void 0===t?void 0:t.count)&&void 0!==e?e:0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(e,t){var r,n;let i=this.geometry.userData.parameters;this.is2DType?e.set(0,0,.5*i.depth):this.isNonParametric?(e.setScalar(0),this.geometry.boundingSphere&&e.copy(this.geometry.boundingSphere.center),t.set(i.width,i.height,null!==(r=i.depth)&&void 0!==r?r:0).multiplyScalar(.5)):i.centerOffset?e.fromArray(i.centerOffset):e.setScalar(0),t.set(i.width,i.height,null!==(n=i.depth)&&void 0!==n?n:0).multiplyScalar(.5)}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(e,t){this.skeleton=e,this.isSkinnedMesh=!0,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(e){let t=new CB,r=this.geometry.attributes.skinWeight;for(let n=0,i=r.count;n<i;n++){t.fromBufferAttribute(r,n);let e=1/t.manhattanLength();e!==1/0?t.multiplyScalar(e):t.set(1,0,0,0),r.setXYZW(n,t.x,t.y,t.z,t.w)}}boneTransform(e,t){let r=this.skeleton;if(void 0===r)return;let n=this.geometry;Mre.fromBufferAttribute(n.attributes.skinIndex,e),Tre.fromBufferAttribute(n.attributes.skinWeight,e),Are.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let i=0;i<4;i++){let e=Tre.getComponent(i);if(0!==e){let n=Mre.getComponent(i);kre.multiplyMatrices(r.bones[n].matrixWorld,r.boneInverses[n]),t.addScaledVector(Pre.copy(Are).applyMatrix4(kre),e)}}return t.applyMatrix4(this.bindMatrixInverse)}};function Ire(e){if(Array.isArray(e.material)){for(let t of e.material)if(0===t.getLayersOfType("outline").length)return}else if(!(e.material instanceof bte)||0===e.material.getLayersOfType("outline").length)return;e instanceof Dre&&e.is2DAndNoDepth?function(e){if(e.geometry.attributes.extrudeNormals||!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,r=new Float32Array(t.length),n=new PB;for(let i=0;i<t.length;i+=3)n.set(t[i],t[i+1],t[i+2]).normalize(),r[i]=n.x,r[i+1]=n.y,r[i+2]=n.z;e.geometry.setAttribute("extrudeNormal",new Qz(r,3))}(e):function(e){if(e.geometry.attributes.extrudeNormal||!e.geometry.attributes.position||!e.geometry.attributes.normal)return;let t=new Map,r=e.geometry.attributes,n=r.position.array,i=r.normal.array,s=new Float32Array(n.length);for(let l=0;l<n.length;l+=3){var a;let e="".concat(n[l],"_").concat(n[l+1],"_").concat(n[l+2]),r=new PB(i[l],i[l+1],i[l+2]);t.has(e)?null===(a=t.get(e))||void 0===a||a.normals.push(r):t.set(e,{normals:[r],result:new PB})}t.forEach(((e,t)=>{for(let r of e.normals)e.result.add(r);e.result.divideScalar(e.normals.length)}));for(let l=0;l<n.length;l+=3){var o;let e="".concat(n[l],"_").concat(n[l+1],"_").concat(n[l+2]),r=null===(o=t.get(e))||void 0===o?void 0:o.result;r&&(s[l]=r.x,s[l+1]=r.y,s[l+2]=r.z)}e.geometry.setAttribute("extrudeNormal",new Qz(s,3))}(e)}function Ore(e){if(!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,r=new Float32Array(t.length),n=parseInt(e.uuid.replace(/\D/g,"")),i=[$N.seededRandom(n),$N.seededRandom(n+1e4),$N.seededRandom(n+2e4)];for(let s=0;s<t.length;s++)r[s]=i[s%3];e.geometry.setAttribute("randomColor",new Xz(r,3))}var Rre=new IB,Lre=new PB;function Nre(e){let t=!1;return e.scene.objects.traverse(((e,r)=>{"Mesh"===r.type&&"SubdivGeometry"===r.geometry.type&&(t=!0)})),t}var Bre=class extends Dre{constructor(e,t,r){super(e,t,r),this.data=t,this.hiddenMatrixOld=new sz,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(e){return this.dataPatched.flatShading?e.geometryCache:e.geometryCache2}get subdivPointerNew(){return void 0!==this.localGeometry?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return void 0!==this.localGeometry?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){var e;return null!==(e=this.data.geometry.phongAngle)&&void 0!==e?e:45}updateEntityBoxSize(e,t){var r;let n=this.geometry.userData.parameters;e.copy(this.originalGeometryNew.boundingSphere.center),t.set(n.width,n.height,null!==(r=n.depth)&&void 0!==r?r:0).multiplyScalar(.5)}createGeometryByControls(e){var t,r,n,i;if(!0===this.skipReactionUpdate)return;let s=null===(t=this.localGeometry)||void 0===t?void 0:t.uuid,{originalGeometry:a,subdividedGeometry:o,subdivPointer:l}=o9.build(e,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=l,void 0!==a&&(null!==(r=this.originalGeometry)&&void 0!==r&&r.dispose(),this.originalGeometry=a),void 0!==o&&(null!==(n=this.subdividedGeometry)&&void 0!==n&&n.dispose(),this.subdividedGeometry=null!==o&&void 0!==o?o:void 0),this.localGeometry=null!==(i=this.subdividedGeometry)&&void 0!==i?i:this.originalGeometry,Ire(this),Ore(this),this.calcBoundingBox(),s&&(this.localGeometry.uuid=s)}updateState(e,t){if(super.updateState(e,t),void 0!==e.flatShading){let r=this.material;this.material=Array.isArray(r)?r.map((e=>e.getFlavor(!1,e.side,e.wireframe))):r.getFlavor(!1,r.side,r.wireframe),this.smoothShading=!e.flatShading,this.createGeometryDelayed(t)}}updateMesh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o9.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&o9.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){var e;this.originalGeometry.dispose(),this.originalGeometry=o9.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=o9.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=null!==(e=this.subdividedGeometry)&&void 0!==e?e:this.originalGeometry}raycast(e,t){let r=this.localGeometry;this.localGeometry=this.originalGeometryNew,z9.prototype.raycast.call(this,e,t),this.localGeometry=r}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let e=this.originalGeometry;null===e.boundingSphere&&(e.boundingSphere=new QB,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,r=e.boundingSphere.center;Rre.setFromBufferAttribute(t),Rre.getCenter(r),e.boundingSphere.radius=r.distanceTo(Rre.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Rre.getSize(Lre),this.hasNonUniformScale&&Lre.divide(this.scale);let n={width:Lre.x,height:Lre.y,depth:Lre.z};return this.geometry.userData.parameters=n,n}updateBoundingSphere(e){let t=this.originalGeometry;Rre.min.set(e[0],e[2],e[4]),Rre.max.set(e[1],e[3],e[5]),this.hasNonUniformScale&&(Rre.min.applyMatrix4(this.shearScaleInv),Rre.max.applyMatrix4(this.shearScaleInv)),null===t.boundingSphere&&(t.boundingSphere=new QB);let r=t.boundingSphere.center;Rre.getCenter(r),t.boundingSphere.radius=r.distanceTo(Rre.max)}freeSubdivPointer(){var e,t;this.subdivPointer&&(o9.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,null!==(e=this.originalGeometry)&&void 0!==e&&e.dispose(),null===(t=this.subdividedGeometry)||void 0===t||t.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(e,t,r){super.updateByPatchedOpGeometry(e,t,r),this.localGeometry&&this.createGeometryByControls(t)}},zre={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},Fre={polygon_center:0,edge:1,vertex:2},jre=(e,t)=>(r,n)=>t&&0!==r&&0!==e?e*n/100:0,Ure=(e,t)=>{let r=Math.abs(t),n=-1*r;return(e- -1)*(r-n)/2+n},Vre=new PB,Hre=new PB,Wre=new PB,Gre=new PB;function qre(e,t){let r=Wre.fromArray(e),n=Gre.fromArray(t);Hre.copy(n).sub(r);let i=Hre.length();return Hre.normalize().multiplyScalar(.5*i),Vre.copy(r).add(Hre).toArray()}var Xre=new Uz,Yre=new PB,Kre=new PB,Qre=new PB;var Zre=e=>.5*(1-Math.cos(e*Math.PI)),Jre=class{constructor(){this.perlin=new Array(4096)}noise(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null==this.perlin){this.perlin=new Array(4096);for(let e=0;e<4096;e++)this.perlin[e]=Math.random()}e<0&&(e=-e),t<0&&(t=-t),r<0&&(r=-r);let n,i,s,a,o,l=Math.floor(e),c=Math.floor(t),u=Math.floor(r),h=e-l,d=t-c,f=r-u,p=0,m=.5;for(let g=0;g<4;g++){let e=l+(c<<4)+(u<<8);n=Zre(h),i=Zre(d),s=this.perlin[4095&e],s+=n*(this.perlin[e+1&4095]-s),a=this.perlin[e+16&4095],a+=n*(this.perlin[e+16+1&4095]-a),s+=i*(a-s),e+=256,a=this.perlin[4095&e],a+=n*(this.perlin[e+1&4095]-a),o=this.perlin[e+16&4095],o+=n*(this.perlin[e+16+1&4095]-o),a+=i*(o-a),s+=Zre(f)*(a-s),p+=s*m,m*=.5,l<<=1,h*=2,c<<=1,d*=2,u<<=1,f*=2,h>=1&&(l++,h--),d>=1&&(c++,d--),f>=1&&(u++,f--)}return p}noiseSeed(e){let t=(()=>{let e,t;return{setSeed(r){t=e=(null!==r&&void 0!==r?r:4294967296*Math.random())>>>0},getSeed:()=>e,rand:()=>(t=(1664525*t+1013904223)%4294967296,t/4294967296)}})();t.setSeed(e),this.perlin=new Array(4096);for(let r=0;r<4096;r++)this.perlin[r]=t.rand()}},$re=new PB,ene=new sz,tne=new iz;function rne(e){let t=!1;return e.scene.objects.traverse(((e,r)=>{"Mesh"===r.type&&("TextGeometry"===r.geometry.type||"InputGeometry"===r.geometry.type)&&(t=!0)})),t}var nne,ine,sne,ane,one=class extends Dre{constructor(e,t,r){super(e,t,r),this.data=t}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var e,t;let r=this.dataPatched;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,r.geometry.height,this.fontScale,r.geometry.verticalAlign))&&void 0!==e?e:0}get fontScale(){let e=this.dataPatched;return this.font?e.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var e,t;return(null!==(e=null===(t=this.font)||void 0===t?void 0:t.ascender)&&void 0!==e?e:1)*this.fontScale}get descender(){var e,t;return(null!==(e=null===(t=this.font)||void 0===t?void 0:t.descender)&&void 0!==e?e:1)*this.fontScale}get lineHeight(){let e=this.dataPatched;return e.geometry.fontSize*e.geometry.lineHeight}raycast(e,t){let{matrixWorld:r}=this;if(!isNaN(e.ray.origin.x)&&0!==this.scale.x&&0!==this.scale.y&&0!==this.scale.z&&(ene.copy(r).invert(),tne.copy(e.ray).applyMatrix4(ene),tne.intersectBox(this.singleBBox,$re))){let n=$re.applyMatrix4(r),i=e.ray.origin.distanceTo(n);t.push({distance:i,point:n.clone(),object:this})}}},lne=1e-4,cne=new PB,une=new PB;Y8.then((e=>{ine=[(nne=e).get_face_center,nne.get_edge_midpoint,nne.get_vertex_position],sne=[nne.get_face_normal,nne.get_edge_normal,nne.get_vertex_normal],ane=[nne.face_count,nne.edge_count,nne.vertex_count]}));var hne=new sz,dne=new sz,fne=new PB,pne=new PB,mne=new PB,gne=new PB,vne=new PB,yne=new PB,bne=class{constructor(e,t){this.data=e,this.is3D=t,this.perlin=new Jre,"perlin"===e.noiseType?(this.perlin.noiseSeed(e.seed),this.noise=t?(e,t,r)=>this.perlin.noise(e,t,r):e=>this.perlin.noise(e)):this.noise=t?function(){let e=N4(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random),t=new Float64Array(e).map((e=>L4[e%12*3])),r=new Float64Array(e).map((e=>L4[e%12*3+1])),n=new Float64Array(e).map((e=>L4[e%12*3+2]));return function(i,s,a){let o,l,c,u,h,d,f,p,m,g,v=(i+s+a)*D4,y=O4(i+v),b=O4(s+v),w=O4(a+v),x=(y+b+w)*I4,S=i-(y-x),_=s-(b-x),C=a-(w-x);S>=_?_>=C?(h=1,d=0,f=0,p=1,m=1,g=0):S>=C?(h=1,d=0,f=0,p=1,m=0,g=1):(h=0,d=0,f=1,p=1,m=0,g=1):_<C?(h=0,d=0,f=1,p=0,m=1,g=1):S<C?(h=0,d=1,f=0,p=0,m=1,g=1):(h=0,d=1,f=0,p=1,m=1,g=0);let E=S-h+I4,A=_-d+I4,M=C-f+I4,T=S-p+2*I4,P=_-m+2*I4,k=C-g+2*I4,D=S-1+.5,I=_-1+.5,O=C-1+.5,R=255&y,L=255&b,N=255&w,B=.6-S*S-_*_-C*C;if(B<0)o=0;else{let i=R+e[L+e[N]];B*=B,o=B*B*(t[i]*S+r[i]*_+n[i]*C)}let z=.6-E*E-A*A-M*M;if(z<0)l=0;else{let i=R+h+e[L+d+e[N+f]];z*=z,l=z*z*(t[i]*E+r[i]*A+n[i]*M)}let F=.6-T*T-P*P-k*k;if(F<0)c=0;else{let i=R+p+e[L+m+e[N+g]];F*=F,c=F*F*(t[i]*T+r[i]*P+n[i]*k)}let j=.6-D*D-I*I-O*O;if(j<0)u=0;else{let i=R+1+e[L+1+e[N+1]];j*=j,u=j*j*(t[i]*D+r[i]*I+n[i]*O)}return 32*(o+l+c+u)}}((0,T4.default)(e.seed)):function(){let e=N4(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random),t=new Float64Array(e).map((e=>R4[e%12*2])),r=new Float64Array(e).map((e=>R4[e%12*2+1]));return function(n,i){let s,a,o=0,l=0,c=0,u=(n+i)*P4,h=O4(n+u),d=O4(i+u),f=(h+d)*k4,p=n-(h-f),m=i-(d-f);p>m?(s=1,a=0):(s=0,a=1);let g=p-s+k4,v=m-a+k4,y=p-1+2*k4,b=m-1+2*k4,w=255&h,x=255&d,S=.5-p*p-m*m;if(S>=0){let n=w+e[x];S*=S,o=S*S*(t[n]*p+r[n]*m)}let _=.5-g*g-v*v;if(_>=0){let n=w+s+e[x+a];_*=_,l=_*_*(t[n]*g+r[n]*v)}let C=.5-y*y-b*b;if(C>=0){let n=w+1+e[x+1];C*=C,c=C*C*(t[n]*y+r[n]*b)}return 70*(o+l+c)}}((0,T4.default)(e.seed))}},wne=class extends(G4(kz)){constructor(e,t){super(),this.parameters=t,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.random=null,this.object=e}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(e){if(null===this.parent)this.updateState(this.parameters,e);else for(let t of this.children)t instanceof X4&&t.expand()}invalidateTransform(e){this.matrixWorldNeedsUpdate=!0,this.traverse((t=>{t instanceof X4&&t.object===e&&(t.matrixWorldNeedsUpdate=!0)}))}onObjUpdateMatrix(){"toObject"!==this.parameters.type&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let e of this.children)e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD())}_updateCount(e){let t;if(t=void 0!==e?e:"grid"===this.parameters.type?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,"toObject"===this.parameters.type)if(this.parameters.toObject.object){if(void 0===e&&"random"!==this.parameters.toObject.spreadType)return}else t=0;if("toObject"===this.parameters.type&&this.objectForSample){let e=this.children;if(e.length===t)return;if(e.length<t)for(let r=0,n=t-e.length;r<n;++r){let e=new X4(this.object);e.expand(),this.add(e)}else for(let r=0,n=e.length-t;r<n;++r)this.remove(e[r])}else{if(this.children.length===t)return;if(this.children.length<t)for(let e=0,r=t-this.children.length;e<r;++e){let e=new X4(this.object);e.expand(),this.add(e)}else for(let e=0,r=this.children.length-t;e<r;++e)this.remove(this.children[e])}}getRandom(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(null===this.random||this.random.data.seed!==e.seed||this.random.is3D!==t)&&(this.random=new bne(e,t)),this.random}_updateRadial(e){var t;let r,n=e.radial,i=n.start*$N.DEG2RAD,s=i-n.end*$N.DEG2RAD,a=new mz(n.rotation[0],n.rotation[1],n.rotation[2]);switch(n.axis){case"z":r=new PB(0,0,1);break;case"y":r=new PB(0,1,0);break;default:r=new PB(1,0,0)}let o=null!==(t=e.randomnessObject)&&void 0!==t?t:$0.defaultData([1,1,1]).randomnessObject,l=this.getRandom(o),c=jre(o.strength,this.parameters.randomness);for(let[u,h]of this.children.entries()){let t=u*(o.freqScale/10)+o.movement,d=l.noise(t,t,t),f=u+1;h.scale.x=n.scale[0]+c(f,Ure(d,o.scale[0]))||lne,h.scale.y=n.scale[1]+c(f,Ure(d,o.scale[1]))||lne,h.scale.z=n.scale[2]+c(f,Ure(d,o.scale[2]))||lne,h.position.setScalar(0);let p=s/e.count*u-i;switch(n.axis){case"x":h.rotation.set(0,p,0);break;case"y":h.rotation.set(0,0,p);break;case"z":h.rotation.set(p,0,0)}h.translateOnAxis(r,n.radius),h.position.x+=n.position[0]+c(f,Ure(d,o.position[0])),h.position.y+=n.position[1]+c(f,Ure(d,o.position[1])),h.position.z+=n.position[2]+c(f,Ure(d,o.position[2]));let m=c(f,Ure(d,o.rotation[0])),g=c(f,Ure(d,o.rotation[1])),v=c(f,Ure(d,o.rotation[2]));!0===n.alignment?(h.rotation.x+=a.x+m,h.rotation.y+=a.y+g,h.rotation.z+=a.z+v):h.rotation.set(a.x+m,a.y+g,a.z+v)}}_updateLinear(e){var t;if("linear"!==e.type)throw new Error;let r=e.linear,n=new mz(r.rotation[0],r.rotation[1],r.rotation[2]),i=null!==(t=e.randomnessObject)&&void 0!==t?t:$0.defaultData([1,1,1]).randomnessObject,s=this.getRandom(i),a=jre(i.strength,this.parameters.randomness);for(let[o,l]of this.children.entries()){let e=o*(i.freqScale/10)+i.movement,t=s.noise(e,e,e),c=o+1,u=a(c,Ure(t,i.rotation[0])),h=a(c,Ure(t,i.rotation[1])),d=a(c,Ure(t,i.rotation[2]));l.scale.x=1+(r.scale[0]-1)*o+a(c,Ure(t,i.scale[0]))||lne,l.scale.y=1+(r.scale[1]-1)*o+a(c,Ure(t,i.scale[1]))||lne,l.scale.z=1+(r.scale[2]-1)*o+a(c,Ure(t,i.scale[2]))||lne,l.rotation.x=n.x*o+u,l.rotation.y=n.y*o+h,l.rotation.z=n.z*o+d,l.position.x=r.position[0]*o+a(c,Ure(t,i.position[0])),l.position.y=r.position[1]*o+a(c,Ure(t,i.position[1])),l.position.z=r.position[2]*o+a(c,Ure(t,i.position[2]))}}_updateGrid(e){var t;let r=0,n=e.grid,i=null!==(t=e.randomnessObject)&&void 0!==t?t:$0.defaultData([1,1,1]).randomnessObject,s=this.getRandom(i,!0),a=jre(i.strength,this.parameters.randomness);if(!0===n.useCenter){let e={x:n.count[0]%2===0?2:1,y:n.count[1]%2===0?2:1,z:n.count[2]%2===0?2:1},t=new PB(n.size[0]*(n.count[0]-e.x)*.5,n.size[1]*(n.count[1]-e.y)*.5,n.size[2]*(n.count[2]-e.z)*.5);for(let o=0;o<n.count[0];o++)for(let e=0;e<n.count[1];e++)for(let l=0;l<n.count[2];l++){let c=s.noise((o+1)*(i.freqScale/10)+i.movement,(e+1)*(i.freqScale/10)+i.movement,(l+1)*(i.freqScale/10)+i.movement),u=this.children[r++];u.scale.x=1+a(r,Ure(c,i.scale[0]))||lne,u.scale.y=1+a(r,Ure(c,i.scale[1]))||lne,u.scale.z=1+a(r,Ure(c,i.scale[2]))||lne;let h=a(r,Ure(c,i.rotation[0])),d=a(r,Ure(c,i.rotation[1])),f=a(r,Ure(c,i.rotation[2]));u.rotation.set(h,d,f),u.position.x=n.size[0]*o-t.x+a(r,Ure(c,i.position[0])),u.position.y=n.size[1]*e-t.y+a(r,Ure(c,i.position[1])),u.position.z=n.size[2]*l-t.z+a(r,Ure(c,i.position[2]))}}else for(let o=0;o<n.count[0];o++)for(let e=0;e<n.count[1];e++)for(let t=0;t<n.count[2];t++){let l=s.noise((o+1)*(i.freqScale/10)+i.movement,(e+1)*(i.freqScale/10)+i.movement,(t+1)*(i.freqScale/10)+i.movement),c=this.children[r++];c.scale.x=1+a(r,Ure(l,i.scale[0]))||lne,c.scale.y=1+a(r,Ure(l,i.scale[1]))||lne,c.scale.z=1+a(r,Ure(l,i.scale[2]))||lne;let u=a(r,Ure(l,i.rotation[0])),h=a(r,Ure(l,i.rotation[1])),d=a(r,Ure(l,i.rotation[2]));c.rotation.set(u,h,d),c.position.x=n.size[0]*o+a(r,Ure(l,i.position[0])),c.position.y=-n.size[1]*e+a(r,Ure(l,i.position[1])),c.position.z=-n.size[2]*t+a(r,Ure(l,i.position[2]))}}_updateToObject(e){var t,r;if("toObject"!==e.type)throw new Error;let{toObject:n}=e,i=new mz(n.rotation[0],n.rotation[1],n.rotation[2]),s=null!==(t=e.randomnessObject)&&void 0!==t?t:$0.defaultData([1,1,1]).randomnessObject,a=this.getRandom(s),o=jre(s.strength,this.parameters.randomness);if(!n.object){for(let[,e]of this.children.entries())e.position.set(0,0,0),e.scale.setScalar(1),e.rotation.set(0,0,0);return void(this.objectForSample=void 0)}if(!this.objectForSample)return;if(this.objectForSample instanceof one){if(null===(r=this.objectForSample.font)||void 0===r||!r.isLoaded||void 0===this.objectForSample.geometry.attributes.position)return void(this._pendingMediaLoad=!0);this._pendingMediaLoad=!1}if(void 0===this.objectForSample.geometry&&this.objectForSample.isAncestorOf(this.object.uuid))return void console.warn('Oh no! The object "'.concat(this.object.name,'" (').concat(this.object.uuid,") seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead."));let l=this.getSubdivData();if(l.length>0){let e=Math.round(l.length*n.count/100);this._updateCount(e)}else{let e=this.objectForSample.geometry.getAttribute("position");if(!e||isNaN(e.count)||0===e.count)return void console.warn('Oh no! The object "'.concat(this.object.name,'" (').concat(this.object.uuid,') cannot be cloned on the surface of "').concat(this.objectForSample.name,'" (').concat(this.objectForSample.uuid,") because the latter does not have a valid geometry."))}this.objectForSample.updateMatrixWorld();let c=new F4(this.objectForSample).build(),u=zre[n.axis],h=this.children;c.setRandomGenerator((0,T4.default)(this.object.uuid+n.seed));for(let[d,f]of h.entries()){let e=d*(s.freqScale/10)+s.movement,t=a.noise(e,e,e),r=d+1,h=o(r,Ure(t,s.rotation[0])),p=o(r,Ure(t,s.rotation[1])),m=o(r,Ure(t,s.rotation[2]));"random"===n.spreadType?c.sample(mne,gne):(l.length&&(mne.fromArray(l[d].pos),gne.fromArray(l[d].norm)),this.objectForSample instanceof Bre&&mne.applyMatrix4(hne.copy(this.objectForSample.matrixWorld).invert())),mne.applyMatrix4(this.object.hiddenMatrix.clone().invert()),f.position.copy(mne),fne.fromArray(u);let g="normal"===n.align?gne:this.object.getWorldDirection(yne),v=pne.fromArray(n.position);pne.x+=o(r,Ure(t,s.position[0])),pne.y+=o(r,Ure(t,s.position[1])),pne.z+=o(r,Ure(t,s.position[2]));let y=Math.acos(g.dot(fne)),b=vne.crossVectors(fne,g).normalize(),w=dne.makeRotationAxis(b,y),x=g.clone().cross(this.object.up).normalize(),S=x.clone().cross(g).normalize(),_=(new sz).makeBasis(x,g,S),C=new PB(fne.y,fne.z,fne.x).normalize(),E=C.clone().cross(fne).normalize(),A=(new sz).makeBasis(C,fne,E).invert(),M=(new sz).multiplyMatrices(_,A);f.rotation.setFromRotationMatrix(M),v.applyMatrix4(w),f.position.add(v),f.rotation.x=f.rotation.x+i.x+h,f.rotation.y=f.rotation.y+i.y+p,f.rotation.z=f.rotation.z+i.z+m,f.scale.setScalar(1),f.scale.x=f.scale.x+n.scale[0]+o(r,Ure(t,s.scale[0]))||lne,f.scale.y=f.scale.y+n.scale[1]+o(r,Ure(t,s.scale[1]))||lne,f.scale.z=f.scale.z+n.scale[2]+o(r,Ure(t,s.scale[2]))||lne,f.scale.multiply(this.object.scale),f.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let e=this.parameters.toObject.spreadType,t=new Map,r=(e,r)=>{let n=Math.round(1e4*e[0])+"_"+Math.round(1e4*e[1])+"_"+Math.round(1e4*e[2]),i=t.get(n);i?(i.pos[0]+=e[0],i.pos[1]+=e[1],i.pos[2]+=e[2],i.norm[0]+=r[0],i.norm[1]+=r[1],i.norm[2]+=r[2],i.count+=1):t.set(n,{pos:[...e],norm:[...r],count:1})};if("random"===e)return[];if(this.objectForSample instanceof Bre){let t=this.objectForSample,n=Fre[e],i=ane[n],s=ine[n],a=sne[n],o=i(t.subdivPointerNew);for(let e=0;e<=o-1;e++){let n=s(t.subdivPointerNew,e),i=a(t.subdivPointerNew,e);cne.fromArray(n).applyMatrix4(t.matrixWorld),une.fromArray(i),r(cne.toArray(),une.toArray())}}else(this.objectForSample.geometry.index?function(e){let t=[];for(let r=0;r<=e.index.count;r++)if(Yre.fromArray(e.index.array,3*r),Xre.setFromAttributeAndIndices(e.attributes.position,Yre.x,Yre.y,Yre.z),Xre.getNormal(Kre),Xre.getMidpoint(Qre),!(isNaN(Qre.x)||isNaN(Qre.y)||isNaN(Qre.z))){let{a:e,b:r,c:n}=Xre,i=e.toArray(),s=r.toArray(),a=n.toArray(),o=e.distanceTo(r),l=r.distanceTo(n),c=n.distanceTo(e),u=qre(i,s),h=qre(s,a),d=qre(a,i),f=[o,l,c],p=Math.max(...f),m=f.filter((e=>Math.round(e)===Math.round(p))).length>1,g=[],v=Xre.getMidpoint(Qre).toArray();p===o&&!m&&(g=[h,d,d],v=u),p===l&&!m&&(g=[u,d,d],v=h),p===c&&!m&&(g=[u,h,h],v=d),m&&(g=[u,h,d]),t.push({vertices:[i,s,a],faceCenters:g,midpoint:v,norm:Xre.getNormal(Kre).toArray()})}return t}(this.objectForSample.geometry):function(e){let t=[],{position:r}=e.attributes;for(let n=0;n<r.count;n++){Xre.setFromAttributeAndIndices(r,3*n,3*n+1,3*n+2),Xre.getNormal(Kre),Xre.getMidpoint(Qre);let e=Xre.a.toArray(),i=Xre.b.toArray(),s=Xre.c.toArray();t.push({vertices:[e,i,s],faceCenters:[qre(e,i),qre(i,s),qre(s,e)],midpoint:Qre.toArray(),norm:Kre.toArray()})}return t}(this.objectForSample.geometry)).forEach(((t,n)=>{"polygon_center"===e&&r(t.midpoint,t.norm),"vertex"===e&&(r(t.vertices[0],t.norm),r(t.vertices[1],t.norm),r(t.vertices[2],t.norm)),"edge"===e&&(r(t.faceCenters[0],t.norm),r(t.faceCenters[1],t.norm),r(t.faceCenters[2],t.norm))}));let n=Array.from(t.values());for(let i of n)i.pos[0]/=i.count,i.pos[1]/=i.count,i.pos[2]/=i.count,i.norm[0]/=i.count,i.norm[1]/=i.count,i.norm[2]/=i.count;return n}updateState(e,t){var r;if(this.parameters=MQ(e),"toObject"!==this.parameters.type)(null===this.parent||this.parent!==this.object)&&(this.removeFromParent(),null!==(r=this.object.parent)&&void 0!==r&&r.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(null===this.parent||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let e=t.find(this.parameters.toObject.object);this.objectForSample=e instanceof z9?e:void 0,this.matrix=new sz,this.hiddenMatrix=new sz,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,e&&e.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},xne=e=>{var t;return(t=class extends e{}).geometryHelper=new wF(30,30,30),t},Sne=new iz,_ne=new QB,Cne=new sz,Ene=function(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,a=t,o=s.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),_ne.copy(a.boundingSphere),_ne.applyMatrix4(o),!1===r.ray.intersectsSphere(_ne)||(Cne.copy(o).invert(),Sne.copy(r.ray).applyMatrix4(Cne),null!==a.boundingBox&&!1===Sne.intersectsBox(a.boundingBox)))return;let l,c,u,h,d,f,p=a.index,m=a.attributes.position,g=a.drawRange;if(!1===i){for(d=Math.max(0,g.start),f=Math.min(p.count,g.start+g.count);d<f;d+=3)if(c=p.getX(d),u=p.getX(d+1),h=p.getX(d+2),l=v(e,r,Sne,m,c,u,h),l)return l.faceIndex=Math.floor(d/3),void n.push(l)}else{let t=a.attributes.position,i=new PB,o=new PB,l=new PB,c=new PB,u=2,h=1/((s.scale.x+s.scale.y+s.scale.z)/3),d=h*h;for(let a=Math.max(0,g.start),f=Math.min(t.count,g.start+g.count)-1;a<f;a+=u){if(i.fromBufferAttribute(t,a),o.fromBufferAttribute(t,a+1),Sne.distanceSqToSegment(i,o,c,l)>d)continue;c.applyMatrix4(s.matrixWorld);let u=r.ray.origin.distanceTo(c);u<r.near||u>r.far||n.push({distance:u,point:l.clone().applyMatrix4(s.matrixWorld),object:e})}}function v(e,t,r,n,i,s,a){let o=new PB,l=new PB,c=new PB,u=new PB,h=new PB;if(o.fromBufferAttribute(n,i),l.fromBufferAttribute(n,s),c.fromBufferAttribute(n,a),null===r.intersectTriangle(o,l,c,!1,u))return null;h.copy(u),h.applyMatrix4(e.matrixWorld);let d=t.ray.origin.distanceTo(h);return d<t.near||d>t.far?null:{faceIndex:1,distance:d,point:h.clone(),object:e}}},Ane=new PB,Mne=new AF,Tne=class extends HV{constructor(e){let t=new iF,r=new RV({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],i=[],s={},a=new vB(15711266),o=new vB(15711266),l=new vB(2857471);function c(e,t,r){u(e,r),u(t,r)}function u(e,t){n.push(0,0,0),i.push(t.r,t.g,t.b),void 0===s[e]&&(s[e]=[]),s[e].push(n.length/3-1)}c("n1","n2",a),c("n2","n4",a),c("n4","n3",a),c("n3","n1",a),c("f1","f2",a),c("f2","f4",a),c("f4","f3",a),c("f3","f1",a),c("n1","f1",a),c("n2","f2",a),c("n3","f3",a),c("n4","f4",a),c("p","n1",o),c("p","n2",o),c("p","n3",o),c("p","n4",o),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l),t.setAttribute("position",new Qz(n,3)),t.setAttribute("color",new Qz(i,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let e=this.geometry,t=this.pointMap;Mne.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let r=.8;Pne("n1",t,e,Mne,-1,-1,r),Pne("n2",t,e,Mne,1,-1,r),Pne("n3",t,e,Mne,-1,1,r),Pne("n4",t,e,Mne,1,1,r);let n=r;Pne("f1",t,e,Mne,-1,-1,n),Pne("f2",t,e,Mne,1,-1,n),Pne("f3",t,e,Mne,-1,1,n),Pne("f4",t,e,Mne,1,1,n);let i=n;Pne("u1",t,e,Mne,.35,1.1,i),Pne("u2",t,e,Mne,-.35,1.1,i),Pne("u3",t,e,Mne,0,1.55,i),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function Pne(e,t,r,n,i,s,a){Ane.set(i,s,a).unproject(n);let o=t[e];if(void 0!==o){let e=r.getAttribute("position");for(let t=0,r=o.length;t<r;t++)e.setXYZ(o[t],Ane.x,Ane.y,Ane.z)}}var kne,Dne=class extends(xne(Tne)){constructor(e){super(e),this.object=e,this.object=e,this.name="CombinedCameraHelper: ".concat(e.uuid)}updateMatrixWorld(e){super.updateMatrixWorld(e),this.updateTarget()}updateTarget(){let e=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(e)}raycast(e,t){Ene(this.object,this.geometry,e,t,!0)}};(e=>{e.is=e=>"objectHelper"in e})(kne||(kne={}));var Ine=(e,t)=>class extends(f5(e)){constructor(){super(...arguments),this.objectHelper=new t(this),this.gizmos={}}get geometryHelper(){return t.geometryHelper}raycast(e,t){this.objectHelper.raycast(e,t)}showGizmos(){for(let e in this.gizmos){let t=this.gizmos[e];t instanceof AG&&(t.visible=!0)}}updateEntityBoxSize(e,t){this.objectHelper.visible&&this.geometryHelper instanceof wF?(e.setScalar(0),t.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(e,t)}hideGizmos(){for(let e in this.gizmos){let t=this.gizmos[e];t instanceof AG&&(t.visible=!1)}}},One=new PB,Rne=new PB,Lne=new TB,Nne=new PB,Bne=new PB,zne=new PB,Fne=class extends(Ine(AF,Dne)){constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u(u({},J1.defaultData),{},{name:""});super(),this._cameraType="OrthographicCamera",this.targetOffset=J0.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(e,t),this.previousProjectionMatrix=new sz,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let r=this.width,n=this.height;this.orthoCamera=new JF(-.5*r,.5*r,.5*n,-.5*n,-5e4,1e4),this.perspCamera=new MF(45,r/n,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return"PerspectiveCamera"===this.cameraType}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(e){this.perspCamera.fov=e}get fov(){return this.perspCamera.fov}setNear(e,t){"PerspectiveCamera"===e?this.perspCamera.near=t:this.orthoCamera.near=t}setZoom(e,t){t>=0&&("PerspectiveCamera"===e?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}set cameraType(e){"PerspectiveCamera"===e?this.toPerspective():"OrthographicCamera"===e&&this.toOrthographic()}get near(){return"PerspectiveCamera"===this._cameraType?this.perspCamera.near:this.orthoCamera.near}set near(e){"PerspectiveCamera"===this._cameraType?this.perspCamera.near=e:this.orthoCamera.near=e}get zoom(){return"PerspectiveCamera"===this._cameraType?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(e){e>=0&&("PerspectiveCamera"===this._cameraType?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}lookAt(e,t,r){"number"==typeof e&&(e=new PB(e,t,r)),super.lookAt(e),this.getWorldPosition(One),this.targetOffset=One.distanceTo(e)}getTarget(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new PB;return this.getWorldDirection(Rne),this.getWorldPosition(One),Rne.multiplyScalar(this.targetOffset),e.copy(One).add(Rne),e}getDistanceToTarget(){let e=this.getTarget();return this.getWorldPosition(One),One.distanceTo(e)}updateUp(){this.getWorldQuaternion(Lne),Nne.set(0,0,1).applyQuaternion(Lne),Bne.copy(kz.DEFAULT_UP),this.isUpVectorFlipped&&Bne.negate(),Bne.applyQuaternion(Lne),zne.copy(kz.DEFAULT_UP).projectOnPlane(Nne),this.angleOffsetFromUp=zne.angleTo(Bne),this.angleOffsetFromUp*=zne.cross(Bne).dot(Nne)>=0?1:-1}updateTransformState(e,t){let r=super.updateTransformState(e,t);return void 0!==e.isUpVectorFlipped&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateUp(),r}getViewFrontToObject(e){let t=e.getWorldPosition(new PB),r=e.getWorldDirection(new PB).multiplyScalar(this.targetOffset);return{position:t.clone().add(r),target:t}}getViewToTarget(e){let t=this.getWorldDirection(new PB).multiplyScalar(this.targetOffset);return{position:e.clone().sub(t),target:e}}getViewToObject(e){let t=new PB;e.getWorldPosition(t);return this.getViewToTarget(t)}setViewplaneSize(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.aspect=e/t,r){let r=e>t?this.aspect:1,n=e>t?1:this.aspect;this.left=-395*r,this.right=395*r,this.top=1/n*395,this.bottom=1/n*-395}else this.left=.5*-e,this.right=.5*e,this.top=.5*t,this.bottom=.5*-t;this.updateProjectionMatrix()}copyViewPlaneSize(e){this.aspect=e.aspect,this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(e){this.perspCamera.setFocalLength(e),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(e,t,r,n,i,s){"PerspectiveCamera"===this._cameraType?this.perspCamera.setViewOffset(e,t,r,n,i,s):this.orthoCamera.setViewOffset(e,t,r,n,i,s)}clearViewOffset(){"PerspectiveCamera"===this._cameraType?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){"PerspectiveCamera"===this._cameraType?this.toPerspective():"OrthographicCamera"===this._cameraType&&this.toOrthographic()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(e,t){return super.copy(e,t),this.parent=e.parent,this.orthoCamera.copy(e.orthoCamera),this.perspCamera.copy(e.perspCamera),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.far=e.far,this.view=null===e.view?null:Object.assign({},e.view),this._cameraType=e._cameraType,this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.targetOffset=e.targetOffset,this.updateProjectionMatrix(),this}toCameraState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return uZ(t,e)}updateCameraSubtype(e,t){let r="perspective"===e?"PerspectiveCamera":"OrthographicCamera";void 0!==t.zoom&&this.setZoom(r,t.zoom),void 0!==t.near&&this.setNear(r,t.near),void 0!==t.fov&&"PerspectiveCamera"===r&&(this.fov=t.fov)}updateState(e,t){this.updateCameraState(e,t)}updateCameraState(e,t){this.updateState_Entity(e,t),void 0!==e.far&&(this.far=e.far),void 0!==e.orthographic&&this.updateCameraSubtype("orthographic",e.orthographic),void 0!==e.perspective&&this.updateCameraSubtype("perspective",e.perspective),void 0!==e.type&&(this.cameraType=e.type),void 0!==e.up&&this.up.fromArray(e.up),void 0!==e.targetOffset&&(this.targetOffset=e.targetOffset),void 0!==e.isUpVectorFlipped&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),1===e.path.length&&0===e.type&&this.updateCameraSubtype(e.path[0],e.props)}toState(e){return u(u(u({},super.toState(e)),this.toCameraState(e)),{},{type:this.cameraType})}},jne=new sz,Une=new sz;function Vne(e){let t=!1;return e.scene.objects.traverse(((e,r)=>{var n;"BooleanGeometry"===(null===(n=r.geometry)||void 0===n?void 0:n.type)&&(t=!0)})),t}var Hne,Wne=class extends Ere{constructor(e,t,r){super(e,t),this.data=t,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new iF,this.onAfterRender=(e,t,r,n,i,s)=>{super.onAfterRender(e,t,r,n,i,s),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){var e;return null!==(e=this.data.geometry.phongAngle)&&void 0!==e?e:45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),1===e.path.length&&"geometry"===e.path[0]&&0===e.type&&void 0!==e.props.operation&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(-1!==this.booleanMeshSetAddress&&!e)return;for(let s=0;s<this.children.length;s++){let r=this.children[s];r instanceof Wne&&!0===r.dataPatched.visible&&r.recomputeBoolean(!0===e,t)}this.meshSetAddresses=[];for(let s=0;s<this.children.length;s++){var r;let i=this.children[s];if(i instanceof z9&&!0===i.dataPatched.visible&&(null===(r=i.geometry.attributes.position)||void 0===r?void 0:r.count)>0&&i.geometry.drawRange.count>0&&0!==i.booleanMeshSetAddress){jne.multiplyMatrices(i.hiddenMatrix,i.matrix);try{if(-1===i.booleanMeshSetAddress){var n;if((null!==(n=i.geometry.index)&&void 0!==n?n:i.geometry.getAttribute("position")).count/3<15e5&&(i.booleanMeshSetAddress=m9.getMeshSet(i.geometry,!0===e,t)),-1===i.booleanMeshSetAddress)return;m9.transformMeshSet(i.booleanMeshSetAddress,jne),i.booleanMatrixInvOld.copy(jne).invert(),i.booleanWasTransformed=!1}else i instanceof Wne&&!0===i.needsTransformForDownstream?(m9.transformMeshSet(i.booleanMeshSetAddress,jne),i.needsTransformForDownstream=!1):!0===i.booleanWasTransformed&&(m9.transformMeshSet(i.booleanMeshSetAddress,Une.multiplyMatrices(jne,i.booleanMatrixInvOld)),i.booleanMatrixInvOld.copy(jne).invert(),i.booleanWasTransformed=!1)}catch(B0){console.error(B0),i.booleanMeshSetAddress=0,i.geometry.userData.booleanOperationDidFail=!0;continue}!1===m9.hasOpenEdges(i.booleanMeshSetAddress)||s===this.children.length-1&&2===this.booleanOp?(this.meshSetAddresses.push(i.booleanMeshSetAddress),i.geometry.userData.booleanOperationDidFail=!1):i.geometry.userData.booleanOperationDidFail="openEdges"}}if(0===this.meshSetAddresses.length)return this.geometry.setAttribute("position",new Qz([],0)),void this.geometry.setDrawRange(0,0);if(!0===e)return m9.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let i=this.geometry;i.dispose(),this.geometry=new iF,this.geometry.userData=i.userData,this.geometry.boundingSphere=i.boundingSphere;try{this.booleanMeshSetAddress=m9.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(Q0){this.booleanMeshSetAddress=0,this.geometry.userData.booleanOperationDidFail=!0,console.error(Q0)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,Ire(this),Ore(this)}dispose(){super.dispose(),this.geometry.dispose()}};(e=>{e.is=function(e){return W4.is(e)&&e instanceof EW}})(Hne||(Hne={}));var Gne=(e,t)=>class extends(Ine(e,t)){updateState_Light(e,t){this.updateState_Entity(e,t),void 0!==e.color&&(this.color=t.shared.color(e.color)),void 0!==e.intensity&&(this.intensity=e.intensity),void 0!==e.depth&&(this.shadow.camera.far=e.depth,this.shadow.needsUpdate=!0),void 0!==e.shadows&&(this.castShadow=e.shadows)}},qne=e=>e instanceof z9,Xne=e=>null!==e&&e instanceof Wne,Yne=e=>kne.is(e),Kne=new PB(1,1,1),Qne=new PB,Zne=new PB,Jne=new TB,$ne=class extends(xne(MG)){constructor(e){super(arguments.length>1&&void 0!==arguments[1]?arguments[1]:15),this.object=e,this.dummy=new cV,this.object.updateMatrixWorld(),this.name="EmptyObjectHelper: ".concat(e.uuid),this.matrix=this.dummy.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(e,t){Ene(this.object,$ne.geometryHelper,e,t,!1,this.dummy)}update(){}updateMatrix(){}updateMatrixWorld(e){this.object.matrixWorld.decompose(Qne,Jne,Zne),this.matrix.compose(Qne,Jne,Kne),super.updateMatrixWorld(e)}updateWorldMatrix(e,t){}},eie=class extends(Ine(cV,$ne)){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t),"buffer"in e&&1===Object.keys(e).length&&t.scene.reloadSplats()}},tie=class extends(Ine(cV,$ne)){constructor(e,t,r){super(),this.super_Entity(e,t),this.context=r,this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t)}},rie=0,nie=1,iie="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",sie=class extends EF{constructor(){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super({name:"BokehMaterial",defines:{PASS:arguments.length>0&&void 0!==arguments[0]&&arguments[0]?"2":"1"},uniforms:{kernel64:new sG(null),kernel16:new sG(null),inputBuffer:new sG(null),cocBuffer:new sG(null),texelSize:new sG(new eB),scale:new sG(1)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;uniform vec4 kernel64[32];varying vec2 vUv;void main(){\n#ifdef FOREGROUND\nvec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;\n#else\nfloat CoC=texture2D(cocBuffer,vUv).g*scale;\n#endif\nif(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{\n#ifdef FOREGROUND\nvec2 step=texelSize*max(CoC,CoCNearFar.g*scale);\n#else\nvec2 step=texelSize*CoC;\n#endif\nvec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;}}",vertexShader:iie}),this.toneMapped=!1,e&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.uniforms.scale.value=e}setScale(e){this.uniforms.scale.value=e}generateKernel(){let e=new Float32Array(128),t=new Float32Array(32),r=0,n=0;for(let a=0;a<80;++a){let i=2.39996323*a,s=Math.sqrt(a)/Math.sqrt(80),o=s*Math.cos(i),l=s*Math.sin(i);a%5===0?(t[n++]=o,t[n++]=l):(e[r++]=o,e[r++]=l)}let i=[],s=[];for(let a=0;a<128;)i.push(new CB(e[a++],e[a++],e[a++],e[a++]));for(let a=0;a<32;)s.push(new CB(t[a++],t[a++],t[a++],t[a++]));this.uniforms.kernel64.value=i,this.uniforms.kernel16.value=s}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}};function aie(e,t,r){return e*(t-r)-t}function oie(e,t,r){return Math.min(Math.max((e+t)/(t-r),0),1)}var lie=class extends EF{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new sG(null),focusDistance:new sG(0),focusRange:new sG(0),cameraNear:new sG(.3),cameraFar:new sG(1e3)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#include <common>\n#include <packing>\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nuniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}void main(){float depth=readDepth(vUv);\n#ifdef PERSPECTIVE_CAMERA\nfloat viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);\n#else\nfloat linearDepth=depth;\n#endif\nfloat signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}",vertexShader:iie}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:IN;this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-aie(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=oie(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-aie(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=oie(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof MF?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},cie=class extends EF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new eB;super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new sG(null),texelSize:new sG(new eB),halfTexelSize:new sG(new eB),kernel:new sG(0),scale:new sG(1)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#include <common>\n#include <dithering_pars_fragment>\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nvarying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;\n#include <encodings_fragment>\n#include <dithering_fragment>\n}",vertexShader:"uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1,this.setTexelSize(e.x,e.y)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.halfTexelSize.value.copy(r.texelSize.value).multiplyScalar(.5)}},uie=class extends EF{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new sG(null),opacity:new sG(1)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;\n#include <encodings_fragment>\n}",vertexShader:iie}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},hie={DEPTH:0,LUMA:1,COLOR:2},die={DISABLED:0,DEPTH:1,CUSTOM:2},fie=class extends EF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new eB,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hie.COLOR;super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:ML.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new sG(null),depthBuffer:new sG(null),predicationBuffer:new sG(null),texelSize:new sG(e)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\n#if EDGE_DETECTION_MODE != 0\nvarying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;\n#endif\n#if EDGE_DETECTION_MODE == 1\n#include <common>\n#endif\n#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nfloat readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}\n#elif PREDICATION_MODE == 2\nuniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}\n#endif\n#if PREDICATION_MODE != 0\nvec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}\n#endif\n#if EDGE_DETECTION_MODE != 0\nuniform sampler2D inputBuffer;\n#endif\nvoid main(){\n#if EDGE_DETECTION_MODE == 0\nconst vec2 threshold=vec2(DEPTH_THRESHOLD);\n#elif PREDICATION_MODE != 0\nvec2 threshold=calculatePredicatedThreshold();\n#else\nconst vec2 threshold=vec2(EDGE_THRESHOLD);\n#endif\n#if EDGE_DETECTION_MODE == 0\nvec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);\n#elif EDGE_DETECTION_MODE == 1\nfloat l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);\n#elif EDGE_DETECTION_MODE == 2\nvec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);\n#endif\n}",vertexShader:"uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;\n#if EDGE_DETECTION_MODE != 0\nvarying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;\n#endif\nvoid main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);\n#if EDGE_DETECTION_MODE != 0\nvUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);\n#endif\ngl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1,this.edgeDetectionMode=t}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:IN;this.depthBuffer=e,this.depthPacking=t}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(e){this.defines.EDGE_DETECTION_MODE=e.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(e){this.edgeDetectionMode=e}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(e){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=e.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(e){this.localContrastAdaptationFactor=e}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(e){this.defines.EDGE_THRESHOLD=e.toFixed("6"),this.defines.DEPTH_THRESHOLD=(.1*e).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(e){this.edgeDetectionThreshold=e}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(e){this.defines.PREDICATION_MODE=e.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(e){this.predicationMode=e}set predicationBuffer(e){this.uniforms.predicationBuffer.value=e}setPredicationBuffer(e){this.uniforms.predicationBuffer.value=e}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(e){this.defines.PREDICATION_THRESHOLD=e.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(e){this.predicationThreshold=e}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(e){this.defines.PREDICATION_SCALE=e.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(e){this.predicationScale=e}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(e){this.defines.PREDICATION_STRENGTH=e.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(e){this.predicationStrength=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},pie={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},mie=class extends EF{constructor(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super({name:"EffectMaterial",defines:{THREE_REVISION:ML.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new sG(null),depthBuffer:new sG(null),resolution:new sG(new eB),texelSize:new sG(new eB),cameraNear:new sG(.3),cameraFar:new sG(1e3),aspect:new sG(1),time:new sG(0)},blending:0,depthWrite:!1,depthTest:!1,dithering:i}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),r&&this.setUniforms(r),this.adoptCameraSettings(n)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:IN;this.depthBuffer=e,this.depthPacking=t}setShaderParts(e){return this.fragmentShader="#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#define packFloatToRGBA(v) packDepthToRGBA(v)\n#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nuniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\n#if THREE_REVISION >= 137\nvec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}\n#endif\nfloat readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}float getViewZ(const in float depth){\n#ifdef PERSPECTIVE_CAMERA\nreturn perspectiveDepthToViewZ(depth,cameraNear,cameraFar);\n#else\nreturn orthographicDepthToViewZ(depth,cameraNear,cameraFar);\n#endif\n}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;\n#ifdef ENCODE_OUTPUT\n#include <encodings_fragment>\n#endif\n#include <dithering_fragment>\n}".replace(pie.FRAGMENT_HEAD,e.get(pie.FRAGMENT_HEAD)).replace(pie.FRAGMENT_MAIN_UV,e.get(pie.FRAGMENT_MAIN_UV)).replace(pie.FRAGMENT_MAIN_IMAGE,e.get(pie.FRAGMENT_MAIN_IMAGE)),this.vertexShader="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}".replace(pie.VERTEX_HEAD,e.get(pie.VERTEX_HEAD)).replace(pie.VERTEX_MAIN_SUPPORT,e.get(pie.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(e){for(let t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(let t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(let t of e)this.extensions[t]=!0;return this}get encodeOutput(){return void 0!==this.defines.ENCODE_OUTPUT}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof MF?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){let r=this.uniforms;r.resolution.value.set(e,t),r.texelSize.value.set(1/e,1/t),r.aspect.value=e/t}static get Section(){return pie}},gie=class extends EF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super({name:"LuminanceMaterial",defines:{THREE_REVISION:ML.replace(/\D+/g,"")},uniforms:{inputBuffer:new sG(null),threshold:new sG(0),smoothing:new sG(1),range:new sG(null)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#include <common>\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#ifdef RANGE\nuniform vec2 range;\n#elif defined(THRESHOLD)\nuniform float threshold;uniform float smoothing;\n#endif\nvarying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);\n#ifdef RANGE\nfloat low=step(range.x,l);float high=step(l,range.y);l*=low*high;\n#elif defined(THRESHOLD)\nl=smoothstep(threshold,threshold+smoothing,l);\n#endif\n#ifdef COLOR\ngl_FragColor=vec4(texel.rgb*l,l);\n#else\ngl_FragColor=vec4(l);\n#endif\n}",vertexShader:iie}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return void 0!==this.defines.COLOR}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return null!==this.luminanceRange}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){null!==e?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},vie=0,yie=1,bie=class extends EF{constructor(){super({name:"MaskMaterial",uniforms:{maskTexture:new sG(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null),inputBuffer:new sG(null),strength:new sG(1)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#ifdef MASK_PRECISION_HIGH\nuniform mediump sampler2D maskTexture;\n#else\nuniform lowp sampler2D maskTexture;\n#endif\n#if MASK_FUNCTION != 0\nuniform float strength;\n#endif\nvarying vec2 vUv;void main(){\n#if COLOR_CHANNEL == 0\nfloat mask=texture2D(maskTexture,vUv).r;\n#elif COLOR_CHANNEL == 1\nfloat mask=texture2D(maskTexture,vUv).g;\n#elif COLOR_CHANNEL == 2\nfloat mask=texture2D(maskTexture,vUv).b;\n#else\nfloat mask=texture2D(maskTexture,vUv).a;\n#endif\n#if MASK_FUNCTION == 0\n#ifdef INVERTED\nmask=step(mask,0.0);\n#else\nmask=1.0-step(mask,0.0);\n#endif\n#else\nmask=clamp(mask*strength,0.0,1.0);\n#ifdef INVERTED\nmask=1.0-mask;\n#endif\n#endif\n#if MASK_FUNCTION == 2\ngl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);\n#else\ngl_FragColor=mask*texture2D(inputBuffer,vUv);\n#endif\n}",vertexShader:iie}),this.toneMapped=!1,this.setColorChannel(rie),this.setMaskFunction(vie)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==oN&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return void 0!==this.defines.INVERTED}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}},wie=class extends EF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new eB,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new eB;super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new sG(null),searchTexture:new sG(null),areaTexture:new sG(null),resolution:new sG(t),texelSize:new sG(e)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)\n#if __VERSION__ < 300\n#define round(v) floor(v + 0.5)\n#endif\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){\n#if !defined(DISABLE_CORNER_DETECTION)\nvec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);\n#endif\n}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){\n#if !defined(DISABLE_CORNER_DETECTION)\nvec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);\n#endif\n}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){\n#if !defined(DISABLE_DIAG_DETECTION)\nweights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){\n#endif\nvec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);\n#if !defined(DISABLE_DIAG_DETECTION)\n}else{e.r=0.0;}\n#endif\n}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}",vertexShader:"uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(e){this.uniforms.searchTexture.value=e}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(e){this.uniforms.areaTexture.value=e}setLookupTextures(e,t){this.searchTexture=e,this.areaTexture=t}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(e){let t=Math.min(Math.max(e,0),112);this.defines.MAX_SEARCH_STEPS_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(e){this.orthogonalSearchSteps=e}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(e){let t=Math.min(Math.max(e,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(e){this.diagonalSearchSteps=e}get diagonalDetection(){return void 0===this.defines.DISABLE_DIAG_DETECTION}set diagonalDetection(e){e?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(e){this.diagonalDetection=e}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(e){let t=Math.min(Math.max(e,0),100);this.defines.CORNER_ROUNDING=t.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(t/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(e){this.cornerRounding=e}get cornerDetection(){return void 0===this.defines.DISABLE_CORNER_DETECTION}set cornerDetection(e){e?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(e){this.cornerDetection=e}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.resolution.value.set(e,t)}},xie=new AF,Sie=null;var _ie=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Pass",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yV,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xie;this.name=e,this.renderer=null,this.scene=t,this.camera=r,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){let t=this.getFullscreenMaterial();null!==t&&(t.needsUpdate=!0),this.rtt=!e}}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return null!==this.screen?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;null!==t?t.material=e:(t=new yF(function(){if(null===Sie){let e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);void 0!==(Sie=new iF).setAttribute?(Sie.setAttribute("position",new Xz(e,3)),Sie.setAttribute("uv",new Xz(t,2))):(Sie.addAttribute("position",new Xz(e,3)),Sie.addAttribute("uv",new Xz(t,2)))}return Sie}(),e),t.frustumCulled=!1,null===this.scene&&(this.scene=new yV),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e){}render(e,t,r,n,i){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(null!==t&&"object"==typeof t&&"function"==typeof t.dispose){if(t instanceof yV||t===this.renderer)continue;this[e].dispose()}}}},Cie=class extends _ie{constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super("CopyPass"),this.fullscreenMaterial=new uie,this.needsSwap=!1,this.renderTarget=e,void 0===e&&(this.renderTarget=new EB(1,1,{minFilter:iN,magFilter:iN,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,r,n,i){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,r){void 0!==r&&(this.renderTarget.texture.type=r,r!==oN?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===DN&&(this.renderTarget.texture.encoding=DN))}},Eie=class extends _ie{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,r,n,i){let s=e.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},Aie=new vB,Mie=class extends _ie{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=r,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,r){this.color=e,this.depth=t,this.stencil=r}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,r,n,i){let s=this.overrideClearColor,a=this.overrideClearAlpha,o=e.getClearAlpha(),l=null!==s,c=a>=0;l?(Aie.copy(e.getClearColor(Aie)),e.setClearColor(s,c?a:o)):c&&e.setClearAlpha(a),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(Aie,o):c&&e.setClearAlpha(o)}},Tie=-1,Pie=class extends FN{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tie,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Tie,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.resizable=e,this.base=new eB(1,1),this.preferred=new eB(t,r),this.target=this.preferred,this.s=n}get width(){let e,{base:t,preferred:r,scale:n}=this;return e=r.width!==Tie?r.width:r.height!==Tie?Math.round(r.height*(t.width/Math.max(t.height,1))):Math.round(t.width*n),e}set width(e){this.preferredWidth=e}get height(){let e,{base:t,preferred:r,scale:n}=this;return e=r.height!==Tie?r.height:r.width!==Tie?Math.round(r.width/Math.max(t.width/Math.max(t.height,1),1)):Math.round(t.height*n),e}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(Tie),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.base.width!==e||this.base.height!==t)&&(this.base.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferred.width!==e||this.preferred.height!==t)&&(this.preferred.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return Tie}},kie=!1,Die=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case 2:t=this.materialsFlatShadedDoubleSide;break;case 1:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded}else switch(e.material.side){case 2:t=this.materialsDoubleSide;break;case 1:t=this.materialsBackSide;break;default:t=this.materials}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,null!==e){let t=this.materials=[e.clone(),e.clone(),e.clone()];for(let r of t)r.uniforms=Object.assign({},e.uniforms),r.side=0;t[2].skinning=!0,this.materialsBackSide=t.map((t=>{let r=t.clone();return r.uniforms=Object.assign({},e.uniforms),r.side=1,r})),this.materialsDoubleSide=t.map((t=>{let r=t.clone();return r.uniforms=Object.assign({},e.uniforms),r.side=2,r})),this.materialsFlatShaded=t.map((t=>{let r=t.clone();return r.uniforms=Object.assign({},e.uniforms),r.flatShading=!0,r})),this.materialsFlatShadedBackSide=t.map((t=>{let r=t.clone();return r.uniforms=Object.assign({},e.uniforms),r.flatShading=!0,r.side=1,r})),this.materialsFlatShadedDoubleSide=t.map((t=>{let r=t.clone();return r.uniforms=Object.assign({},e.uniforms),r.flatShading=!0,r.side=2,r}))}}render(e,t,r){let n=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,kie){let n=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,r);for(let e of n)e[0].material=e[1];this.meshCount!==n.size&&n.clear()}else{let n=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,r),t.overrideMaterial=n}e.shadowMap.enabled=n}disposeMaterials(){if(null!==this.material){let e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return kie}static set workaroundEnabled(e){kie=e}},Iie=class extends _ie{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new Mie,this.overrideMaterialManager=null===r?null:new Die(r),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){let e=this.overrideMaterialManager;return null!==e?e.material:null}set overrideMaterial(e){let t=this.overrideMaterialManager;null!==e?null!==t?t.setMaterial(e):this.overrideMaterialManager=new Die(e):null!==t&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,r,n,i){let s=this.scene,a=this.camera,o=this.selection,l=a.layers.mask,c=s.background,u=e.shadowMap.autoUpdate,h=this.renderToScreen?null:t;null!==o&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||null!==this.clearPass.overrideClearColor)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(h),null!==this.overrideMaterialManager?this.overrideMaterialManager.render(e,s,a):e.render(s,a),a.layers.mask=l,s.background=c,e.shadowMap.autoUpdate=u}},Oie=class extends _ie{constructor(e,t){let{resolutionScale:r=1,width:n=Pie.AUTO_SIZE,height:i=Pie.AUTO_SIZE,renderTarget:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super("DepthPass"),this.needsSwap=!1,this.renderPass=new Iie(e,t,new rV({depthPacking:3201}));let a=this.renderPass;a.skipShadowMapUpdate=!0,a.ignoreBackground=!0;let o=a.getClearPass();o.overrideClearColor=new vB(16777215),o.overrideClearAlpha=1,this.renderTarget=s,void 0===this.renderTarget&&(this.renderTarget=new EB(1,1,{minFilter:tN,magFilter:tN,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new Pie(this,n,i,r);l.addEventListener("change",(e=>this.setSize(l.baseWidth,l.baseHeight)))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,n,i){let s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,s)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}},Rie=(new Float32Array([255/256/256**3,255/256/65536,255/256/256,255/256]),{SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18}),Lie=new Map([[Rie.SKIP,null],[Rie.ADD,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}"],[Rie.ALPHA,"vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}"],[Rie.AVERAGE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}"],[Rie.COLOR_BURN,"float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[Rie.COLOR_DODGE,"float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[Rie.DARKEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}"],[Rie.DIFFERENCE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}"],[Rie.EXCLUSION,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}"],[Rie.LIGHTEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}"],[Rie.MULTIPLY,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}"],[Rie.DIVIDE,"float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[Rie.NEGATION,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}"],[Rie.NORMAL,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}"],[Rie.OVERLAY,"float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[Rie.REFLECT,"float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[Rie.SCREEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}"],[Rie.SOFT_LIGHT,"float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[Rie.SUBTRACT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}"]]),Nie=class extends FN{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.f=e,this.opacity=new sG(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this.f}set blendFunction(e){this.f=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return Lie.get(this.blendFunction)}},Bie={NONE:0,DEPTH:1,CONVOLUTION:2},zie=class extends FN{constructor(e,t){let{attributes:r=Bie.NONE,blendFunction:n=Rie.SCREEN,defines:i=new Map,uniforms:s=new Map,extensions:a=null,vertexShader:o=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.name=e,this.renderer=null,this.attributes=r,this.fragmentShader=t,this.vertexShader=o,this.defines=i,this.uniforms=s,this.extensions=a,this.blendMode=new Nie(n),this.blendMode.addEventListener("change",(e=>this.setChanged()))}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e){}update(e,t,r){}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(null!==t&&"object"==typeof t&&"function"==typeof t.dispose){if(t instanceof yV||t===this.renderer)continue;this[e].dispose()}}}};function Fie(e,t,r){for(let n of t){let t="$1"+e+n.charAt(0).toUpperCase()+n.slice(1),i=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(let e of r.entries())null!==e[1]&&r.set(e[0],e[1].replace(i,t))}}function jie(e,t,r,n,i,s,a){let o=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),l=void 0!==o.get("fragment")&&/mainImage/.test(o.get("fragment")),c=void 0!==o.get("fragment")&&/mainUv/.test(o.get("fragment")),u=[],h=[],d=!1,f=!1;if(void 0===o.get("fragment"))console.error("Missing fragment shader",t);else if(c&&0!==(a&Bie.CONVOLUTION))console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(l||c){let p=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,m=mie.Section;if(c){let t="\t".concat(e,"MainUv(UV);\n");r.set(m.FRAGMENT_MAIN_UV,r.get(m.FRAGMENT_MAIN_UV)+t),d=!0}if(null!==o.get("vertex")&&/mainSupport/.test(o.get("vertex"))){let t="\t".concat(e,"MainSupport(");t+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(o.get("vertex"))?"vUv);\n":");\n",r.set(m.VERTEX_MAIN_SUPPORT,r.get(m.VERTEX_MAIN_SUPPORT)+t),u=u.concat([...o.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map((e=>e[1]))),h=h.concat(u).concat([...o.get("vertex").matchAll(p)].map((e=>e[1])))}h=h.concat([...o.get("fragment").matchAll(p)].map((e=>e[1]))),h=h.concat([...t.defines.keys()].map((e=>e.replace(/\([\w\s,]*\)/g,"")))),h=h.concat([...t.uniforms.keys()]),t.uniforms.forEach(((t,r)=>s.set(e+r.charAt(0).toUpperCase()+r.slice(1),t))),t.defines.forEach(((t,r)=>i.set(e+r.charAt(0).toUpperCase()+r.slice(1),t))),Fie(e,h,i),Fie(e,h,o);let g=t.blendMode;if(n.set(g.blendFunction,g),l){let t=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,n="".concat(e,"MainImage(color0, UV, ");0!==(a&Bie.DEPTH)&&t.test(o.get("fragment"))&&(n+="depth, ",f=!0),n+="color1);\n\t";let i=e+"BlendOpacity";s.set(i,g.opacity),n+="color0 = blend".concat(g.blendFunction,"(color0, color1, ").concat(i,");\n\n\t"),r.set(m.FRAGMENT_MAIN_IMAGE,r.get(m.FRAGMENT_MAIN_IMAGE)+n),n="uniform float ".concat(i,";\n\n"),r.set(m.FRAGMENT_HEAD,r.get(m.FRAGMENT_HEAD)+n)}r.set(m.FRAGMENT_HEAD,r.get(m.FRAGMENT_HEAD)+o.get("fragment")+"\n"),null!==o.get("vertex")&&r.set(m.VERTEX_HEAD,r.get(m.VERTEX_HEAD)+o.get("vertex")+"\n")}else console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);return{varyings:u,transformedUv:d,readDepth:f}}var Uie=class extends _ie{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];super("EffectPass"),this.fullscreenMaterial=new mie(null,null,null,e),this.effects=r.sort(((e,t)=>t.attributes-e.attributes)),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){let t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}verifyResources(){let e=this.renderer.capabilities,t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&console.warn("The current rendering context doesn't support more than "+t+" uniforms, but "+this.uniformCount+" were defined"),t=e.maxVaryings,this.varyingCount>t&&console.warn("The current rendering context doesn't support more than "+t+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let e=mie.Section,t=new Map([[e.FRAGMENT_HEAD,""],[e.FRAGMENT_MAIN_UV,""],[e.FRAGMENT_MAIN_IMAGE,""],[e.VERTEX_HEAD,""],[e.VERTEX_MAIN_SUPPORT,""]]),r=new Map,n=new Map,i=new Map,s=new Set,a=0,o=0,l=0,c=!1,u=!1;for(let d of this.effects)if(d.blendMode.blendFunction===Rie.SKIP)l|=d.getAttributes()&Bie.DEPTH;else if(0!==(l&d.getAttributes()&Bie.CONVOLUTION))console.error("Convolution effects cannot be merged",d);else{l|=d.getAttributes();let e=jie("e"+a++,d,t,r,n,i,l);if(o+=e.varyings.length,c=c||e.transformedUv,u=u||e.readDepth,null!==d.extensions)for(let t of d.extensions)s.add(t)}let h=/\bblend\b/g;for(let d of r.values()){let r=d.getShaderCode().replace(h,"blend".concat(d.blendFunction));t.set(e.FRAGMENT_HEAD,t.get(e.FRAGMENT_HEAD)+r+"\n")}if(0!==(l&Bie.DEPTH)){if(u){let r="float depth = readDepth(UV);\n\n\t";t.set(e.FRAGMENT_MAIN_IMAGE,r+t.get(e.FRAGMENT_MAIN_IMAGE))}this.needsDepthTexture=null===this.getDepthTexture()}else this.needsDepthTexture=!1;if(c){let r="vec2 transformedUv = vUv;\n";t.set(e.FRAGMENT_MAIN_UV,r+t.get(e.FRAGMENT_MAIN_UV)),n.set("UV","transformedUv")}else n.set("UV","vUv");t.forEach(((e,t,r)=>r.set(t,e.trim().replace(/^#/,"\n#")))),this.uniformCount=i.size,this.varyingCount=o,this.skipRendering=0===a,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(t).setExtensions(s).setUniforms(i).setDefines(n)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:IN;this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(let r of this.effects)r.setDepthTexture(e,t)}render(e,t,r,n,i){for(let s of this.effects)s.update(e,t,n);if(!this.skipRendering||this.renderToScreen){let i=this.fullscreenMaterial;i.inputBuffer=t.texture,i.time+=n,e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(let r of this.effects)r.setSize(e,t)}initialize(e,t,r){this.renderer=e;for(let n of this.effects)n.initialize(e,t,r),n.addEventListener("change",(e=>this.handleEvent(e)));this.updateMaterial(),this.verifyResources(),void 0!==r&&r!==oN&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let e of this.effects)e.dispose()}handleEvent(e){if("change"===e.type)this.recompile()}},Vie=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],Hie=class extends _ie{constructor(){let{resolutionScale:e=.5,width:t=Pie.AUTO_SIZE,height:r=Pie.AUTO_SIZE,kernelSize:n=Kie.LARGE}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("KawaseBlurPass"),this.renderTargetA=new EB(1,1,{minFilter:iN,magFilter:iN,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let i=this.resolution=new Pie(this,t,r,e);i.addEventListener("change",(e=>this.setSize(i.baseWidth,i.baseHeight))),this.blurMaterial=new cie,this.ditheredBlurMaterial=new cie,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=n}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,n,i){let s,a,o=this.scene,l=this.camera,c=this.renderTargetA,u=this.renderTargetB,h=Vie[this.kernelSize],d=this.blurMaterial,f=t;for(this.fullscreenMaterial=d,s=0,a=h.length-1;s<a;++s){let t=0===(1&s)?c:u;d.kernel=h[s],d.inputBuffer=f.texture,e.setRenderTarget(t),e.render(o,l),f=t}this.dithering&&(d=this.ditheredBlurMaterial,this.fullscreenMaterial=d),d.kernel=h[s],d.inputBuffer=f.texture,e.setRenderTarget(this.renderToScreen?null:r),e.render(o,l)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let n=r.width,i=r.height;this.renderTargetA.setSize(n,i),this.renderTargetB.setSize(n,i),this.blurMaterial.setSize(n,i),this.ditheredBlurMaterial.setSize(n,i)}initialize(e,t,r){void 0!==r&&(this.renderTargetA.texture.type=r,this.renderTargetB.texture.type=r,r!==oN?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===DN&&(this.renderTargetA.texture.encoding=DN,this.renderTargetB.texture.encoding=DN))}static get AUTO_SIZE(){return Pie.AUTO_SIZE}},Wie=class extends _ie{constructor(){let{width:e=Pie.AUTO_SIZE,height:t=Pie.AUTO_SIZE,renderTarget:r,luminanceRange:n,colorOutput:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("LuminancePass"),this.fullscreenMaterial=new gie(i,n),this.needsSwap=!1,this.renderTarget=r,void 0===this.renderTarget&&(this.renderTarget=new EB(1,1,{minFilter:iN,magFilter:iN,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let s=this.resolution=new Pie(this,e,t);s.addEventListener("change",(e=>this.setSize(s.baseWidth,s.baseHeight)))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,r,n,i){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}initialize(e,t,r){void 0!==r&&r!==oN&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Gie=class extends _ie{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new Mie(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,r,n,i){let s=e.getContext(),a=e.state.buffers,o=this.scene,l=this.camera,c=this.clearPass,u=this.inverted?0:1,h=1-u;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.stencil.setFunc(s.ALWAYS,u,4294967295),a.stencil.setClear(h),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(e,null):(c.render(e,t),c.render(e,r))),this.renderToScreen?(e.setRenderTarget(null),e.render(o,l)):(e.setRenderTarget(t),e.render(o,l),e.setRenderTarget(r),e.render(o,l)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(s.EQUAL,1,4294967295),a.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.stencil.setLocked(!0)}},qie=class extends _ie{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"inputBuffer";super("ShaderPass"),this.fullscreenMaterial=e,this.inputBufferUniform=null,this.setInput(t)}setInput(e){if(this.inputBufferUniform=null,null!==this.fullscreenMaterial){let t=this.fullscreenMaterial.uniforms;void 0!==t&&void 0!==t[e]&&(this.inputBufferUniform=t[e])}}render(e,t,r,n,i){null!==this.inputBufferUniform&&null!==t&&(this.inputBufferUniform.value=t.texture),e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}initialize(e,t,r){void 0!==r&&r!==oN&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Xie=.001,Yie=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(e){return this.fixedDeltaEnabled=e,this}isAutoResetEnabled(e){return this.autoReset}setAutoResetEnabled(e){return typeof document<"u"&&void 0!==document.hidden&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=e),this}getDelta(){return this.delta*Xie}getFixedDelta(){return this.fixedDelta*Xie}setFixedDelta(e){return this.fixedDelta=1e3*e,this}getElapsed(){return this.elapsed*Xie}getTimescale(){return this.timescale}setTimescale(e){return this.timescale=e,this}update(e){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=void 0!==e?e:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},Kie={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},Qie=class extends zie{constructor(){let{blendFunction:e=Rie.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:r=.025,resolutionScale:n=.5,intensity:i=1,width:s=Pie.AUTO_SIZE,height:a=Pie.AUTO_SIZE,kernelSize:o=Kie.LARGE}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("BloomEffect","#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D map;\n#else\nuniform lowp sampler2D map;\n#endif\nuniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}",{blendFunction:e,uniforms:new Map([["map",new sG(null)],["intensity",new sG(i)]])}),this.renderTarget=new EB(1,1,{minFilter:iN,magFilter:iN,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new Wie({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothingFactor=r,this.blurPass=new Hie({resolutionScale:n,width:s,height:a,kernelSize:o});let l=this.blurPass.getResolution();l.addEventListener("change",(e=>this.setSize(l.baseWidth,l.baseHeight)))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,r){let n=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,n),this.blurPass.render(e,n,n)):this.blurPass.render(e,t,n)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height),this.luminancePass.resolution.copy(r)}initialize(e,t,r){this.blurPass.initialize(e,t,r),void 0!==r&&(this.renderTarget.texture.type=r,e.outputEncoding===DN&&(this.renderTarget.texture.encoding=DN))}},Zie=class extends zie{constructor(){let{blendFunction:e=Rie.NORMAL,brightness:t=0,contrast:r=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("BrightnessContrastEffect","uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",{blendFunction:e,uniforms:new Map([["brightness",new sG(t)],["contrast",new sG(r)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}},Jie=class extends zie{constructor(){super("ColorAverageEffect","void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",{blendFunction:arguments.length>0&&void 0!==arguments[0]?arguments[0]:Rie.NORMAL})}},$ie=class extends zie{constructor(){let{blendFunction:e=Rie.NORMAL,offset:t=new eB(.001,5e-4)}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("ChromaticAberrationEffect","varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",{vertexShader:"uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",blendFunction:e,attributes:Bie.CONVOLUTION,uniforms:new Map([["offset",new sG(t)]])})}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}},ese=class extends zie{constructor(e){let{blendFunction:t=Rie.NORMAL,worldFocusDistance:r,worldFocusRange:n,focusDistance:i=0,focalLength:s=.1,focusRange:a=s,bokehScale:o=1,width:l=Pie.AUTO_SIZE,height:c=Pie.AUTO_SIZE}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super("DepthOfFieldEffect","#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;\n#else\nuniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;\n#endif\nuniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}",{blendFunction:t,attributes:Bie.DEPTH,uniforms:new Map([["nearColorBuffer",new sG(null)],["farColorBuffer",new sG(null)],["nearCoCBuffer",new sG(null)],["scale",new sG(1)]])}),this.camera=e,this.renderTarget=new EB(1,1,{minFilter:iN,magFilter:iN,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new qie(new lie(e));let u=this.cocMaterial;u.focusDistance=i,u.focusRange=a,void 0!==r&&(u.worldFocusDistance=r),void 0!==n&&(u.worldFocusRange=n),this.blurPass=new Hie({kernelSize:Kie.MEDIUM,width:l,height:c});let h=this.blurPass.getResolution();h.addEventListener("change",(e=>this.setSize(h.getBaseWidth(),h.getBaseHeight()))),this.maskPass=new qie(new bie(this.renderTargetCoC.texture));let d=this.maskPass.fullscreenMaterial;d.maskFunction=yie,d.colorChannel=nie,this.bokehNearBasePass=new qie(new sie(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new qie(new sie(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new qie(new sie(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new qie(new sie(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=o}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){let t=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let r of t)r.fullscreenMaterial.setScale(e);this.maskPass.fullscreenMaterial.setStrength(e),this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){let t=this.camera;return oie(-t.position.distanceTo(e),t.near,t.far)}setDepthTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:IN;this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,r){let n=this.renderTarget,i=this.renderTargetCoC,s=this.renderTargetCoCBlurred,a=this.renderTargetMasked;if(null!==this.target){let e=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=e}this.cocPass.render(e,null,i),this.blurPass.render(e,i,s),this.maskPass.render(e,t,a),this.bokehFarBasePass.render(e,a,n),this.bokehFarFillPass.render(e,n,this.renderTargetFar),this.bokehNearBasePass.render(e,t,n),this.bokehNearFillPass.render(e,n,this.renderTargetNear)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let n=r.width,i=r.height,s=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];s.push(this.renderTargetCoC,this.renderTargetMasked),s.forEach((r=>r.setSize(e,t))),s=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],s.forEach((e=>e.setSize(n,i))),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach((e=>e.fullscreenMaterial.setSize(n,i)))}initialize(e,t,r){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach((n=>n.initialize(e,t,r))),this.blurPass.initialize(e,t,oN),void 0!==r&&(this.renderTarget.texture.type=r,this.renderTargetNear.texture.type=r,this.renderTargetFar.texture.type=r,this.renderTargetMasked.texture.type=r,e.outputEncoding===DN&&(this.renderTarget.texture.encoding=DN,this.renderTargetNear.texture.encoding=DN,this.renderTargetFar.texture.encoding=DN,this.renderTargetMasked.texture.encoding=DN))}},tse=(new PB,new sz,class extends zie{constructor(){let{blendFunction:e=Rie.NORMAL,hue:t=0,saturation:r=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("HueSaturationEffect","uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",{blendFunction:e,uniforms:new Map([["hue",new sG(new PB)],["saturation",new sG(r)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){let e=this.uniforms.get("hue").value;return Math.acos((3*e.x-1)/2)}set hue(e){let t=Math.sin(e),r=Math.cos(e);this.uniforms.get("hue").value.set((2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}}),rse=(new vB,class extends zie{constructor(){let{blendFunction:e=Rie.SCREEN,premultiply:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("NoiseEffect","void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));\n#ifdef PREMULTIPLY\noutputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);\n#else\noutputColor=vec4(noise,inputColor.a);\n#endif\n}",{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}}),nse=class extends zie{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;super("PixelationEffect","uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",{uniforms:new Map([["active",new sG(!1)],["d",new sG(new eB)]])}),this.resolution=new eB,this.d=0,this.granularity=e}get granularity(){return this.d}set granularity(e){let t=Math.floor(e);t%2>0&&(t+=1),this.d=t,this.uniforms.get("active").value=t>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(e){this.granularity=e}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}},ise=(Math.PI,new PB,new PB,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC"),sse="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",ase={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},ose=class extends zie{constructor(){let e,t,{preset:r=ase.MEDIUM,edgeDetectionMode:n=hie.COLOR,predicationMode:i=die.DISABLED}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("SMAAEffect","uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",{vertexShader:"varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",blendFunction:Rie.NORMAL,attributes:Bie.CONVOLUTION|Bie.DEPTH,uniforms:new Map([["weightMap",new sG(null)]])}),arguments.length>1&&(e=arguments[0],t=arguments[1],arguments.length>2&&(r=arguments[2]),arguments.length>3&&(n=arguments[3])),this.renderTargetEdges=new EB(1,1,{minFilter:iN,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new Mie(!0,!1,!1),this.clearPass.overrideClearColor=new vB(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new qie(new fie),this.edgeDetectionMaterial.edgeDetectionMode=n,this.edgeDetectionMaterial.predicationMode=i,this.weightsPass=new qie(new wie);let s=new vW;s.onLoad=()=>{let r=new _B(e);r.name="SMAA.Search",r.magFilter=tN,r.minFilter=tN,r.generateMipmaps=!1,r.needsUpdate=!0,r.flipY=!0,this.weightsMaterial.searchTexture=r;let n=new _B(t);n.name="SMAA.Area",n.magFilter=iN,n.minFilter=iN,n.generateMipmaps=!1,n.needsUpdate=!0,n.flipY=!1,this.weightsMaterial.areaTexture=n,this.dispatchEvent({type:"load"})},s.itemStart("search"),s.itemStart("area"),void 0!==e&&void 0!==t?(s.itemEnd("search"),s.itemEnd("area")):typeof Image<"u"&&(e=new Image,t=new Image,e.addEventListener("load",(()=>s.itemEnd("search"))),t.addEventListener("load",(()=>s.itemEnd("area"))),e.src=ise,t.src=sse),this.applyPreset(r)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(e){this.edgeDetectionMaterial.edgeDetectionThreshold=e}setOrthogonalSearchSteps(e){this.weightsMaterial.orthogonalSearchSteps=e}applyPreset(e){let t=this.edgeDetectionMaterial,r=this.weightsMaterial;switch(e){case ase.LOW:t.edgeDetectionThreshold=.15,r.orthogonalSearchSteps=4,r.diagonalDetection=!1,r.cornerDetection=!1;break;case ase.MEDIUM:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=8,r.diagonalDetection=!1,r.cornerDetection=!1;break;case ase.HIGH:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=16,r.diagonalSearchSteps=8,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0;break;case ase.ULTRA:t.edgeDetectionThreshold=.05,r.orthogonalSearchSteps=32,r.diagonalSearchSteps=16,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0}}setDepthTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:IN;this.edgeDetectionMaterial.depthBuffer=e,this.edgeDetectionMaterial.depthPacking=t}update(e,t,r){this.clearPass.render(e,this.renderTargetEdges),this.edgeDetectionPass.render(e,t,this.renderTargetEdges),this.weightsPass.render(e,this.renderTargetEdges,this.renderTargetWeights)}setSize(e,t){this.edgeDetectionMaterial.setSize(e,t),this.weightsMaterial.setSize(e,t),this.renderTargetEdges.setSize(e,t),this.renderTargetWeights.setSize(e,t)}dispose(){let{searchTexture:e,areaTexture:t}=this.weightsMaterial;null!==e&&null!==t&&(e.dispose(),t.dispose()),super.dispose()}static get searchImageDataURL(){return ise}static get areaImageDataURL(){return sse}},lse={DEFAULT:0,ESKIL:1},cse=class extends zie{constructor(){let{blendFunction:e=Rie.NORMAL,technique:t=lse.DEFAULT,eskil:r=!1,offset:n=.5,darkness:i=.5}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("VignetteEffect","uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;\n#if VIGNETTE_TECHNIQUE == 0\nfloat d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));\n#else\nvec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));\n#endif\noutputColor=vec4(color,inputColor.a);}",{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new sG(n)],["darkness",new sG(i)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===lse.ESKIL}set eskil(e){this.technique=e?lse.ESKIL:lse.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}};new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array([0,0,0]),new Float32Array([1,0,0]),new Float32Array([1,1,0]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([1,0,0]),new Float32Array([1,0,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,0,1]),new Float32Array([1,0,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,1,0]),new Float32Array([1,1,0]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,1,0]),new Float32Array([0,1,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,0,1]),new Float32Array([0,1,1]),new Float32Array([1,1,1]),new Float32Array(2),new Float32Array(2),new Float32Array([0,-.25,.25,-.125,.125,-.375,.375]),new Float32Array([0,0]),new Float32Array([.25,-.25]),new Float32Array([-.25,.25]),new Float32Array([.125,-.125]),new Float32Array([-.125,.125]),new Uint8Array([0,0]),new Uint8Array([3,0]),new Uint8Array([0,3]),new Uint8Array([3,3]),new Uint8Array([1,0]),new Uint8Array([4,0]),new Uint8Array([1,3]),new Uint8Array([4,3]),new Uint8Array([0,1]),new Uint8Array([3,1]),new Uint8Array([0,4]),new Uint8Array([3,4]),new Uint8Array([1,1]),new Uint8Array([4,1]),new Uint8Array([1,4]),new Uint8Array([4,4]),new Uint8Array([0,0]),new Uint8Array([1,0]),new Uint8Array([0,2]),new Uint8Array([1,2]),new Uint8Array([2,0]),new Uint8Array([3,0]),new Uint8Array([2,2]),new Uint8Array([3,2]),new Uint8Array([0,1]),new Uint8Array([1,1]),new Uint8Array([0,3]),new Uint8Array([1,3]),new Uint8Array([2,1]),new Uint8Array([3,1]),new Uint8Array([2,3]),new Uint8Array([3,3]),new Map([[hse(0,0,0,0),new Float32Array([0,0,0,0])],[hse(0,0,0,1),new Float32Array([0,0,0,1])],[hse(0,0,1,0),new Float32Array([0,0,1,0])],[hse(0,0,1,1),new Float32Array([0,0,1,1])],[hse(0,1,0,0),new Float32Array([0,1,0,0])],[hse(0,1,0,1),new Float32Array([0,1,0,1])],[hse(0,1,1,0),new Float32Array([0,1,1,0])],[hse(0,1,1,1),new Float32Array([0,1,1,1])],[hse(1,0,0,0),new Float32Array([1,0,0,0])],[hse(1,0,0,1),new Float32Array([1,0,0,1])],[hse(1,0,1,0),new Float32Array([1,0,1,0])],[hse(1,0,1,1),new Float32Array([1,0,1,1])],[hse(1,1,0,0),new Float32Array([1,1,0,0])],[hse(1,1,0,1),new Float32Array([1,1,0,1])],[hse(1,1,1,0),new Float32Array([1,1,1,0])],[hse(1,1,1,1),new Float32Array([1,1,1,1])]]);function use(e,t,r){return e+(t-e)*r}function hse(e,t,r,n){let i=use(e,t,.75),s=use(r,n,.75);return use(i,s,.875)}var dse=class{constructor(e,t){this.enabled=!1,this.effect=new e(t),Object.defineProperty(this,"opacity",{enumerable:!0,set(e){this.effect.blendMode.opacity.value=e},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(e){this.effect.blendMode.setBlendFunction(Number(e))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=Rie.NORMAL}},fse=class extends dse{constructor(){super(Qie),this.blendFunction=Rie.SCREEN}set intensity(e){this.effect.intensity=e}get intensity(){return this.effect.intensity}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(e){this.effect.luminanceMaterial.smoothing=e}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(e){this.effect.blurPass.scale=e}get blurScale(){return this.effect.blurPass.scale}set kernelSize(e){this.effect.blurPass.kernelSize=e}get kernelSize(){return this.effect.blurPass.kernelSize}},pse=class extends dse{constructor(){super(Zie)}set contrast(e){this.effect.uniforms.get("contrast").value=e}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(e){this.effect.uniforms.get("brightness").value=e}get brightness(){return this.effect.uniforms.get("brightness").value}},mse=class extends dse{constructor(){super($ie),this.effect.offset=new eB(.01,.01)}set offset(e){this.effect.offset.set(e[0]/1e3,e[1]/1e3)}get offset(){return[1e3*this.effect.offset.x,1e3*this.effect.offset.y]}},gse=class extends dse{constructor(){super(Jie)}},vse=class extends dse{constructor(){super(tse),this._hue=0}set hue(e){this._hue=e,this.effect.setHue(e)}get hue(){return this._hue}set saturation(e){this.effect.uniforms.get("saturation").value=e}get saturation(){return this.effect.uniforms.get("saturation").value}},yse=class extends dse{constructor(){super(rse),this.blendFunction=Rie.OVERLAY}},bse=class extends dse{constructor(){super(cse)}get eskil(){return this.effect.eskil}set eskil(e){this.effect.eskil=e}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(e){this.effect.uniforms.get("darkness").value=e}get offset(){return this.effect.uniforms.get("offset").value}set offset(e){this.effect.uniforms.get("offset").value=e}},wse=class extends dse{constructor(e){super(ese)}set focalLength(e){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=e/2e3}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(e){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=this.isPerspectiveCamera?e/2e3:(e+992)/2e3}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(e){this.effect.bokehScale=e}setCamera(e){let t=!1;(e.isPerspectiveCamera&&!1===this.isPerspectiveCamera||!e.isPerspectiveCamera&&!0===this.isPerspectiveCamera)&&(t=!0),e.isPerspectiveCamera?(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e.perspCamera),this.isPerspectiveCamera=!0):(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e),this.isPerspectiveCamera=!1),t&&this.effect.setChanged()}},xse=class extends dse{constructor(){super(nse)}get granularity(){return this.effect.getGranularity()}set granularity(e){this.effect.setGranularity(e)}},Sse=class extends EF{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new sG(null)},blending:0,depthWrite:!1,depthTest:!1,vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}",fragmentShader:"#define GLSLIFY 1\nlayout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}"})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}},_se=class extends _ie{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new Sse,this.resolutionVector=new eB,this.resolveMaterial=new EF({name:"TAAResolveMaterial",uniforms:{inputBuffer:new sG(null),historyBuffer:new sG(null),velocityBuffer:new sG(null),depthBuffer:new sG(null),resolution:new sG(new eB)},blending:0,depthWrite:!1,depthTest:!1,vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}",fragmentShader:"#define GLSLIFY 1\n#include <common>\nvarying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;\n#define USE_YCOCG\n#define USE_CATMULL_ROM\nconst float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){\n#ifdef USE_YCOCG\nvec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);\n#else\nreturn texture(tex,uv);\n#endif\n}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){\n#ifdef CHOOSE_LONGEST_MOTION_VECTOR\nfloat longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;\n#else\nfloat closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;\n#endif\n}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);\n#ifdef USE_CATMULL_ROM\nvec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);\n#else\nvec4 previousColor=sample_color(historyBuffer,previousPixelPos);\n#endif\n#ifdef USE_YCOCG\npreviousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);\n#endif\nvec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);\n#ifdef USE_YCOCG\nvec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;\n#endif\nvec4 previousColorClipped=clamp(previousColor,cmin,cmax);\n#ifdef LUMINANCE_DIFFERENCES\n#ifdef USE_YCOCG\nfloat lum0=currentColor.r;float lum1=previousColorClipped.r;\n#else\nfloat lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);\n#endif\nfloat unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));\n#else\nconst float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);\n#endif\n#ifdef USE_YCOCG\ngl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);\n#else\ngl_FragColor=result;\n#endif\n}"}),this.historyRenderTarget=new EB(1024,1024,{minFilter:iN,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new EB(1024,1024,{minFilter:iN,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(e,t){this.historyRenderTarget.setSize(e,t),this.resultRenderTarget.setSize(e,t)}render(e,t){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=t.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=t.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=t.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(t.width,t.height),e.setRenderTarget(this.resultRenderTarget),e.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(this.historyRenderTarget),e.render(this.scene,this.camera);let r=this.renderToScreen?null:t;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(r),e.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},Cse=class extends _ie{constructor(e,t,r){super("TransmissionPass",void 0,t),this.MRTCompatible=!0,this.depthPass=new Oie(e,t,{renderTarget:r.transmissionDepthTarget}),this.passThroughMaterial=new Sse,this.splineScene=e,this.needsSwap=!1}updatePasses(e){this.passThroughMaterial=new Sse,this.depthPass=new Oie(this.splineScene,this.camera,{renderTarget:e.transmissionDepthTarget})}setCamera(e){this.camera=e}setScene(e){this.splineScene=e}render(e,t,r){let n=this.camera.layers.mask,i=e;i.setRenderTarget(i.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=t.texture[0],i.clear(),i.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(e,t,r),i.shadowMap.needsUpdate=!1,i.shadowMap.autoUpdate=!1;let s=this.renderToScreen?null:t;this.camera.layers.set(3),e.setRenderTarget(s),e.render(this.splineScene,this.camera),this.camera.layers.mask=n}},Ese=new yV,Ase=new EF({transparent:!0,vertexShader:"\n        void main() {\n            gl_Position = vec4(0.0);\n        }\n    ",fragmentShader:"\n        layout(location = 1) out vec4 gVelocity;\n\n        void main() {\n            gl_FragColor = vec4(0.0);\n\t\t\tgVelocity = vec4(0.0);\n        }\n    "}),Mse=class extends _ie{constructor(e,t,r){super("OpaquePass",null!==t&&void 0!==t?t:Ese,r),this.MRTCompatible=!0,this.originalMaterials=[],this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.MRTCompatible=e}setCamera(e){this.camera=e}setScene(e){this.scene=null!==e&&void 0!==e?e:Ese}getScene(){return this.scene}render(e,t){this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.length=0,this.scene.traverse((e=>{e.layers.isEnabled(3)&&e instanceof z9&&(this.originalMaterials.push([e,e.material]),e.material=Ase)})),e.shadowMap.needsUpdate=!0,e.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let r=this.renderToScreen?null:t;e.setRenderTarget(r),this.clearColorOnly&&e.clear(!0,!1,!0),this.clear&&e.clear(),e.render(this.scene,this.camera),this.clearDepth&&e.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach((e=>{e[0].material=e[1]}))}},Tse=class{constructor(e){let{depthBuffer:t=!0,stencilBuffer:r=!1,multisampling:n=0,frameBufferType:i=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.renderer=e,this.helperStartIndex=0,this.copyPass=new Cie,this.depthTexture=null,this.timer=new Yie,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(t,r,i,n,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(t,r,i,n,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(t,r,i,n,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){let t=this.inputBuffer,r=this.multisampling;r>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):r!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,null!==e){var t,r;let n=e.getSize(new eB),i=null!==(t=null===(r=e.getContext().getContextAttributes())||void 0===r?void 0:r.alpha)&&void 0!==t&&t,s=this.inputBuffer.texture[0].type;s===oN&&e.outputEncoding===DN&&(this.inputBuffer.texture[0].encoding=DN,this.outputBuffer.texture[0].encoding=DN,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),e.autoClear=!1,this.setSize(n.width,n.height,!1);for(let t of this.passes)t.initialize(e,i,s)}}replaceRenderer(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.renderer,n=r.domElement.parentNode;return this.setRenderer(e),t&&null!==n&&(n.removeChild(r.domElement),n.appendChild(e.domElement)),r}createDepthTexture(){let e=this.depthTexture=new dV(this._width,this._height);return this.inputBuffer.depthTexture=e,this.inputBuffer.stencilBuffer?(e.format=pN,e.type=hN):e.type=lN,e}deleteDepthTexture(){if(null!==this.depthTexture){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,r,n,i,s){let a,o=this.renderer,l=null===o?new eB:o.getDrawingBufferSize(new eB),c={minFilter:iN,magFilter:iN,wrapS:$L,wrapT:$L,stencilBuffer:t,depthBuffer:e};return n>0?(a=new EB(l.width,l.height,c),a.samples=n):(i?(a=new MB(l.width,l.height,2,c),a.texture[1].type=uN):a=new EB(l.width,l.height,c),a.depthTexture=new dV(2048,2048),a.depthTexture.type=cN),r===oN&&null!==o&&o.outputEncoding===DN&&(Array.isArray(a.texture)?a.texture.forEach((e=>e.encoding=DN)):a.texture.encoding=DN),Array.isArray(a.texture)?a.texture.forEach(((e,t)=>{e.name="EffectComposer.Buffer ".concat(i," ").concat(t),e.generateMipmaps=!1})):(a.texture.name="EffectComposer.Buffer ".concat(i),a.texture.generateMipmaps=!1),a.name=s,a}addPass(e,t){var r,n;let i,s=this.passes,a=this.renderer,o=a.getDrawingBufferSize(new eB),l=null!==(r=null===(n=a.getContext().getContextAttributes())||void 0===n?void 0:n.alpha)&&void 0!==r&&r;if(e.MRTCompatible&&(i=this.inputBuffer.texture[0].type),e.MRTCompatible||(i=this.inputBuffer.texture.type),e.setRenderer(a),e.setSize(o.width,o.height),e.initialize(a,l,i),this.autoRenderToScreen&&(s.length>0&&(s[s.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),void 0!==t?s.splice(t,0,e):s.push(e),this.autoRenderToScreen&&(s[s.length-1].renderToScreen=!0),e.needsDepthTexture||null!==this.depthTexture)if(null===this.depthTexture){let t=this.createDepthTexture();for(e of s)e.setDepthTexture(t)}else e.setDepthTexture(this.depthTexture)}setHelperStartIndex(e){this.helperStartIndex=e}removePass(e){let t=this.passes,r=t.indexOf(e);if(-1!==r&&t.splice(r,1).length>0){if(null!==this.depthTexture){let r=(e,t)=>e||t.needsDepthTexture;t.reduce(r,!1)||e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null)}this.autoRenderToScreen&&r===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){let e=this.passes;e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){let t,r,n,i,s=this.renderer,a=this.copyPass,o=this.inputBuffer,l=this.outputBuffer,c=this.inputBufferSingle,u=this.outputBufferSingle,h=!1;void 0===e&&(e=this.timer.update().getDelta());for(let d of this.passes)d.enabled&&(d.MRTCompatible?d.render(s,o,l,e,h):d.render(s,c,u,e,h),d.needsSwap&&(h&&(a.renderToScreen=d.renderToScreen,t=s.getContext(),r=s.state.buffers.stencil,r.setFunc(t.NOTEQUAL,1,4294967295),a.render(s,o,l,e,h),r.setFunc(t.EQUAL,1,4294967295)),n=o,i=c,o=l,c=u,l=n,u=i),d instanceof Gie?h=!0:d instanceof Eie&&(h=!1))}setSize(e,t,r){let n=this.renderer;if(this._width=e,this._height=t,void 0===e||void 0===t){let r=n.getSize(new eB);e=r.width,t=r.height}n.setSize(e,t,r);let i=n.getDrawingBufferSize(new eB);this.inputBuffer.setSize(i.width,i.height),this.outputBuffer.setSize(i.width,i.height),this.inputBufferSingle.setSize(i.width,i.height),this.outputBufferSingle.setSize(i.width,i.height);for(let s of this.passes)s.setSize(i.width,i.height)}reset(){let e=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(e)}dispose(){for(let e of this.passes)e.dispose();this.passes=[],null!==this.inputBuffer&&this.inputBuffer.dispose(),null!==this.outputBuffer&&this.outputBuffer.dispose(),null!==this.inputBufferSingle&&this.inputBufferSingle.dispose(),null!==this.outputBufferSingle&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},Pse=new EF({name:"CombineMaterial",uniforms:{inputBufferA:new sG(null),inputBufferB:new sG(null)},blending:0,depthWrite:!1,depthTest:!1,vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n    gl_Position = vec4(position.xy, 1.0, 1.0);\n    vUv = position.xy * 0.5 + 0.5;\n}\n",fragmentShader:"\n    varying vec2 vUv;\n    uniform sampler2D inputBufferA;\n    uniform sampler2D inputBufferB;\n\n    // TODO: Why do we need these when postpro of framemode is enabled???\n    layout(location = 1) out vec4 gVelocity;\n\n    void main() {\n\tvec4 resA = texture2D(inputBufferA, vUv);\n\tvec4 resB = texture2D(inputBufferB, vUv);\n    float a = resA.a + resB.a * ( 1.0 - resA.a );\n\n\tvec4 res;\n\tres.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));\n\tres.a = resA.a + resB.a * (1.0 - resA.a);\n\tgl_FragColor = res;\n    gVelocity = vec4(0.0);\n    }\n"}),kse=class extends _ie{constructor(e){super("HelperPass",void 0,e),this.MRTCompatible=!1,this.fullscreenMaterial=Pse,this.helperPass=new Mse(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new Mse(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let t=new ose({preset:ase.LOW,edgeDetectionMode:hie.COLOR});this.effectPass=new Uie(this.camera,t),this.rt=new EB(10,10,{minFilter:iN,magFilter:iN,wrapS:$L,wrapT:$L,depthBuffer:!0})}setSize(e,t){this.rt.setSize(e,t),this.effectPass.setSize(e,t)}set sceneHelpers(e){this.helperPass.setScene(e)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(e){this.helperPassOnTop.setScene(e)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(e){this.helperPass.setCamera(e),this.helperPassOnTop.setCamera(e)}initialize(e,t,r){super.initialize(e,t,r),this.effectPass.initialize(e,t,r)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(e,t,r){this.rt.depthTexture=t.depthTexture;let n=e.getClearAlpha();e.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(e,this.rt),this.helperPassOnTop.render(e,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.rt,r),this.fullscreenMaterial.uniforms.inputBufferA.value=r.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=t.texture,e.setClearAlpha(n),e.setRenderTarget(null),e.clear(),e.render(this.scene,this.camera)}},Dse=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],Ise=new EF({vertexShader:"#define GLSLIFY 1\n#include <skinning_pars_vertex>\n#include <morphtarget_pars_vertex>\nout vec3 n;void main(){\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\n#include <defaultnormal_vertex>\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\nvec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}",fragmentShader:"#define GLSLIFY 1\nin vec3 n;void main(){gl_FragColor=vec4(n,1.0);}"}),Ose=new EF({vertexShader:"#define GLSLIFY 1\nout vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}",fragmentShader:"#define GLSLIFY 1\nin vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){\n#ifdef DEBUG\nfloat d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);\n#else\nvec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;\n#endif\n}",uniforms:{texture_ao_lrez:new sG(null),texture_depth_lrez:new sG(null),texture_depth_hrez:new sG(null),near:new sG(null),far:new sG(null)}}),Rse=class extends _ie{constructor(e,t){super("AmbientOcclusionPass",void 0,t),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let r=1024,n=1024;this.gBuffer=new EB(r,n,{type:xZ?uN:cN,depthTexture:new dV(r,n),minFilter:iN,magFilter:iN}),this.depthBufferHighRes=new EB(r,n,{depthTexture:new dV(r,n)}),this.aoBuffer=new EB(r,n,{minFilter:iN,magFilter:iN}),this.splineScene=e,this.splineCamera=t;let i=new Float32Array(2*Dse.length);for(let a=0;a<Dse.length;a++){let e=2*a;i[e+0]=Dse[a][0],i[e+1]=Dse[a][1]}this.blueNoiseInDiskTexture=new _V(i,Dse.length,1,gN,cN),this.blueNoiseInDiskTexture.wrapS=JL,this.blueNoiseInDiskTexture.wrapT=JL,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new EF({vertexShader:"#define GLSLIFY 1\nout vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}",fragmentShader:"#define GLSLIFY 1\nin vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}\n#define USE_GBUFFER_NORMALS\nvoid main(){vec3 view_space_p=get_view_position(v_uv);\n#ifdef USE_GBUFFER_NORMALS\nvec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;\n#else\nvec3 view_space_n=-rebuild_normal(v_uv,view_space_p);\n#endif\nfloat radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}",uniforms:{near:new sG(null),far:new sG(null),fov:new sG(null),proj_info:new sG(new CB),is_ortho:new sG(!1),resolution:new sG(new eB),radius_of_influence:new sG(8),radius_in_screen_space:new sG(1),exponent:new sG(1),ao_color:new sG(new PB),bias:new sG(.5),texture_depth:new sG(null),texture_normals:new sG(null),texture_blue_noise:new sG(null),texture_blue_noise_in_disk:new sG(this.blueNoiseInDiskTexture),frame_index:new sG(0),fog_enabled:new sG(!1),fog_near:new sG(1),fog_far:new sG(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new EB(r,n,{minFilter:iN,magFilter:iN,wrapS:$L,wrapT:$L,depthBuffer:!1,type:cN});let s=new ose({preset:ase.ULTRA,edgeDetectionMode:hie.COLOR});this.effectPass=new Uie(this.camera,s)}initialize(e,t,r){super.initialize(e,t,r),this.effectPass.initialize(e,t,r)}setBlueNoiseTexture(e){this.hbaoMaterial.uniforms.texture_blue_noise.value=e}setSize(e,t){this._width=e,this._height=t,this.depthBufferHighRes.setSize(e,t);let r=this._runHalfRes?.5:1,n=e*r,i=t*r;this.gBuffer.setSize(n,i),this.aoBuffer.setSize(n,i),this.hbaoMaterial.uniforms.resolution.value.set(n,i),this.aaBuffer.setSize(n,i),this.effectPass.setSize(n,i)}get runHalfRes(){return this._runHalfRes}set runHalfRes(e){this._runHalfRes=e,this.setSize(this._width,this._height)}setCamera(e){this.splineCamera=e}setScene(e){this.splineScene=e}setDepthTexture(e){this.depthBufferHighRes.depthTexture=e,Ose.uniforms.texture_depth_hrez.value=e,Ose.needsUpdate=!0}render(e,t,r){this.splineScene.overrideMaterial=Ise;let n=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),e.setRenderTarget(this.gBuffer),e.clear(),e.render(this.splineScene,this.splineCamera),e.setRenderTarget(this.depthBufferHighRes),e.clear(),e.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=n,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let e=this.splineCamera.perspCamera.projectionMatrix.elements,t=2/e[0],r=2/e[5],n=-(1-e[8])/e[0],i=-(1+e[9])/e[5];this.hbaoMaterial.uniforms.proj_info.value.set(t,r,n,i);let s=this.splineCamera.perspCamera.fov*(Math.PI/180),a=this.hbaoMaterial.uniforms.resolution.value.y/(2*Math.tan(.5*s)),o=.5*this.hbaoMaterial.uniforms.radius_of_influence.value*a;this.hbaoMaterial.uniforms.radius_in_screen_space.value=o,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let e=this.splineCamera.orthoCamera.projectionMatrix.elements,t=2/e[0],r=2/e[5],n=-(1+e[12])/e[0],i=-(1-e[13])/e[5];this.hbaoMaterial.uniforms.proj_info.value.set(t,r,n,i);let s=this.hbaoMaterial.uniforms.resolution.value.y/r*.5,a=this.hbaoMaterial.uniforms.radius_of_influence.value*s;this.hbaoMaterial.uniforms.radius_in_screen_space.value=a,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aoBuffer),e.clear(),e.render(this.scene,this.camera),this.fullscreenMaterial=Ose,Ose.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,Ose.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,Ose.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,e.setRenderTarget(e.aoRenderTarget),e.clear(),e.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aaBuffer),e.clear(),e.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.aaBuffer,e.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},Lse=class extends qie{constructor(){super(new EF({vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D tInput;\nuniform sampler2D tMap;\nuniform vec2 resolution;\nvarying vec2 vUv;\n\nuniform vec2 uResolution;\nuniform vec2 uCoords;\n\n// Draws a rectangle at center <st> with size <size>\nfloat rectangle(vec2 st, vec2 size) {\n    size = vec2(0.5) - size * 0.5;\n    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));\n    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));\n\n    return uv.x * uv.y;\n}\n\nuniform vec2 uSize;\nuniform float uScale;\nuniform float uDPR;\nuniform float uCurrent;\nuniform vec3 uSceneColor;\n\nvoid main() {\n    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;\n    screenUv *= 1.0 / uDPR;\n\n    vec2 center = vec2(0.5, -0.5);\n    vec2 outsideUv = screenUv;\n    outsideUv += center;\n    outsideUv -= uCoords.xy / uResolution.xy;\n    outsideUv = (outsideUv - 0.5) + 0.5;\n    outsideUv -= center;\n    vec2 s = (uSize / uResolution) * uScale;\n    float isOutside = 1.0 - rectangle(outsideUv, s);\n    \n    vec2 mid = vec2(0.5);\n    vec2 insideUv = (screenUv - mid + s * mid) / s;\n    vec4 background = texture2D(tInput, screenUv);\n    vec4 image = texture2D(tMap, insideUv);\n    gl_FragColor = mix(image, background, isOutside);\n}\n",uniforms:{tInput:new sG(null),tMap:new sG(null),uResolution:new sG(new eB),uSize:new sG(new eB),uCoords:new sG(new eB),uScale:new sG(1),uSceneColor:new sG(new vB(16711680)),uDPR:new sG(1),uCurrent:new sG(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(e){this.uniforms.tMap.value=e}},Nse=[],Bse=class extends qie{constructor(){super(new EF({vertexShader:"\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D toScene;\nuniform sampler2D fromScene;\nuniform vec2 resolution;\n\nuniform vec2 uResolution;\nuniform float uDPR;\n\nuniform float mixRatio;\nuniform sampler2D tMixTexture;\nuniform int useTexture;\nuniform float threshold;\n\nvoid main() {\n\tvec2 screenUv = gl_FragCoord.xy / uResolution.xy;\n\tscreenUv *= 1.0 / uDPR;\n\n\tvec4 texel1 = texture2D( fromScene, screenUv );\n\tvec4 texel2 = texture2D( toScene, screenUv );\n\n\tif (useTexture==1) {\n\t\t\n\t\tvec4 transitionTexel = texture2D( tMixTexture, screenUv );\n\t\tfloat r = mixRatio * (1.0 + threshold * 2.0) - threshold;\n\t\tfloat mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);\n\t\t\n\t\tgl_FragColor = mix( texel1, texel2, mixf );\n\t} else {\n\t\t\n\t\tgl_FragColor = mix( texel1, texel2, mixRatio );\n\t\t\n\t}\n}\n",uniforms:{toScene:new sG(null),fromScene:new sG(null),uResolution:new sG(new eB),uDPR:new sG(1),mixRatio:new sG(0),threshold:new sG(.1),useTexture:new sG(0),tMixTexture:{value:Nse[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(e){this.uniforms.fromScene.value=e}},zse=class extends qie{constructor(){super(new EF({vertexShader:"\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D inputBuffer;\nuniform sampler2D blurredInputBuffer;\nuniform sampler2D overlay;\nuniform float blurIntensity;\n\nuniform vec2 uResolution;\nuniform float uDPR;\n\nvoid main() {\n\tvec2 screenUv = gl_FragCoord.xy / uResolution.xy;\n\tscreenUv *= 1.0 / uDPR;\n\n\tvec4 texel1 = texture2D( overlay, screenUv );\n\tvec4 texel2 = texture2D( inputBuffer, screenUv );\n\tvec4 texel3 = texture2D( blurredInputBuffer, screenUv );\n\n\tfloat blurMask2 = max(sign(texel1.a), 0.0) * blurIntensity;\n    gl_FragColor = mix( mix(texel2, texel3, blurMask2), texel1, texel1.a );\n}\n",uniforms:{inputBuffer:new sG(null),blurredInputBuffer:new sG(null),overlay:new sG(null),uResolution:new sG(new eB),uDPR:new sG(1),blurIntensity:new sG(0)}})),this._blurEnabled=!1,this.blurTarget=new EB(1,1,{minFilter:iN,magFilter:iN,wrapS:$L,wrapT:$L}),this.blurPass=new Hie({width:window.innerWidth,height:window.innerHeight,kernelSize:Kie.HUGE,resolutionScale:.25}),this.blurPass.renderToScreen=!1,this.uniforms.blurredInputBuffer.value=this.blurTarget.texture}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.overlay.value}set texture(e){this.uniforms.overlay.value=e}setResolution(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.uniforms.uResolution.value.set(e,t),this.uniforms.uDPR.value=r,this.blurPass.setSize(e,t),this.blurTarget.setSize(e,t),this.blurPass.setSize(e,t)}get uiCanvas(){return this._uiCanvas}set uiCanvas(e){this._uiCanvas=e,e.texture&&(this.uniforms.overlay.value=e.texture);let t=e.frame;if(t){let e=t.data.backgroundBlur,r=e.radius;this._blurEnabled=e.enabled,this.uniforms.blurIntensity.value=this._blurEnabled?1:0,this.blurPass.scale=r/3}}render(e,t,r,n,i){this._blurEnabled&&(this.blurPass.setDepthTexture(this.getDepthTexture()),this.blurPass.render(e,t,this.blurTarget,n,i)),super.render(e,t,r,n,i)}},Fse=class extends qie{constructor(){super(new EF({vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D tInput;\nuniform sampler2D tOverlayImage;\nvarying vec2 vUv;\nuniform vec2 uResolution;\nuniform vec2 uRightBottom;\nuniform vec2 uImageSize;\nuniform float uScale;\nuniform float uDPR;\n\nvec3 blendNormal(vec3 base, vec3 blend) {\n\treturn blend;\n}\n\nvec3 blendNormal(vec3 base, vec3 blend, float opacity) {\n\treturn (blendNormal(base, blend) * opacity + base * (1.0 - opacity));\n}\n\nvec4 drawFixedSizeImage(sampler2D image, vec2 screenUV, vec2 imageSize, vec2 imageCoords, vec2 screenSize, float dpr) {\n\tvec2 uv = (screenUV * screenSize * dpr - imageCoords) / (imageSize * dpr);\n\tif (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {\n\t\treturn vec4(0.0);\n\t}\n\treturn texture2D(image, uv);\n}\n\nvoid main() {\n    vec2 screenUV = gl_FragCoord.xy / (uResolution.xy * uDPR);\n\tvec2 imageCoords = vec2(uResolution.x * uDPR - uImageSize.x * uScale * uDPR - uRightBottom.x * uDPR, uRightBottom.y * uDPR);\n    vec4 background = texture2D(tInput, screenUV);\n    vec4 image = drawFixedSizeImage(tOverlayImage, screenUV, uImageSize * uScale, imageCoords, uResolution, uDPR);\n    gl_FragColor = vec4(blendNormal(background.rgb, image.rgb, image.a), max(background.a, image.a));\n}\n",uniforms:{tInput:new sG(null),tOverlayImage:new sG(null),uResolution:new sG(new eB),uImageSize:new sG(new eB),uRightBottom:new sG(new eB(20,20)),uScale:new sG(.25),uDPR:new sG(1)}}),"tInput")}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tOverlayImage.value}set texture(e){this.uniforms.tOverlayImage.value=e,this.uniforms.uImageSize.value.set(e.image.width,e.image.height)}};function jse(e,t){return t&&t.enabled&&e.push(t.effect),e}var Use=e=>Object.values(Rie).includes(e)?e:Rie.NORMAL,Vse=class extends FN{constructor(e,t){super(),this._needsDOFResize=t,this.postprocessingState=N1.defaultData,this._scene=new yV,this._camera=new Fne,this.effects=new Map,this.blueNoiseTexture=new _V,this._renderToScreen=!0,this._isUIOverlayEnabled=!1,this.clock=new VW,this.renderer=e,this.debug=!1,this.effects.set("bloom",new fse),this.effects.set("chromaticAberration",new mse),this.effects.set("vignette",new bse),this.effects.set("noise",new yse),this.effects.set("colorAverage",new gse),this.effects.set("hueSaturation",new vse),this.effects.set("brightnessContrast",new pse),this.effects.set("depthOfField",new wse),this.effects.set("pixelation",new xse),this.effectComposer=new Tse(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new Mse(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new Cse(this.scene,this.camera,this.renderer),this.aoPass=new Rse(this.scene,this.camera),this.taaPass=new _se,this.taaPass.renderToScreen=!1,this.helperPass=new kse(this.camera),this.helperPass.renderToScreen=!1,this.stylesOverlayPass=new Lse,this.stylesOverlayPass.enabled=!1,this.uiOverlayPass=new zse,this.uiOverlayPass.enabled=!1,this.logoOverlayPass=new Fse,this.logoOverlayPass.enabled=!1,this.sceneTransitionPass=new Bse,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(e){void 0!==e?(this.stylesOverlayPass.texture=e,this.stylesOverlayPass.enabled=!0):this.stylesOverlayPass.enabled=!1}get overlayTexture(){return this.stylesOverlayPass.texture}set sceneHelpers(e){this.helperPass.sceneHelpers=e}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(e){this.helperPass.sceneHelpersOnTop=e}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(e){this._scene=e,this.opaquePass.setScene(e),this.transmissionPass.setScene(e),this.aoPass.setScene(e)}get camera(){return this._camera}set camera(e){let t=this._camera!==e;this._camera=e,this.opaquePass.setCamera(e),this.transmissionPass.setCamera(e),t&&this.transmissionPass.updatePasses(this.renderer),this.aoPass.setCamera(e),this.helperPass.setCamera(e),this.effects.get("depthOfField").setCamera(e)}updateRenderToScreen(){let e=!1;for(let t=this.effectComposer.passes.length-1;t>=0;t--){let r=this.effectComposer.passes[t];!0!==r.enabled||e||!this._renderToScreen?r.renderToScreen=!1:(r.renderToScreen=!0,e=!0)}}get isUIOverlayEnabled(){return this._isUIOverlayEnabled}disableUIOverlay(){this._isUIOverlayEnabled=!1}enableUIOverlay(){this._isUIOverlayEnabled=!0}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(e){this.blueNoiseTexture=new _V(e,128,128),this.blueNoiseTexture.wrapS=JL,this.blueNoiseTexture.wrapT=JL,this.blueNoiseTexture.minFilter=tN,this.blueNoiseTexture.magFilter=tN,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(e,t,r,n,i,s,a,o){this.aoPass.enabled=e,this.aoPass.radius=t,this.aoPass.bias=r,this.aoPass.aoColor=n,this.aoPass.fogEnabled=i,this.aoPass.fogNear=s,this.aoPass.fogFar=a,this.aoPass.runHalfRes!==!o&&(this.aoPass.runHalfRes=!o)}setTransmissionPassEnabled(e){this.transmissionPass.enabled=e,this.opaquePass.hasTransmissionPass=e}_initPasses(){var e,t;if(null!==(e=this.uvEffectPass)&&void 0!==e&&e.dispose(),null!==(t=this.effectPass)&&void 0!==t&&t.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){var r;let e=[this.effects.get("pixelation")].reduce(jse,[]);e.length>0&&(this.uvEffectPass=new Uie(this.camera,...e),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let t=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("depthOfField"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(jse,[]);if(t.length>0&&(this.effectPass=new Uie(this.camera,...t),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass),this._needsDOFResize&&null!==(r=this.effects.get("depthOfField"))&&void 0!==r&&r.enabled&&void 0!==window)){let e=this.renderer.viewportWidth,t=this.renderer.viewportHeight;this.renderer.setSize(e-1,t-1),this.renderer.setSize(e,t)}}this.effectComposer.addPass(this.stylesOverlayPass),this.effectComposer.addPass(this.uiOverlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass),this.effectComposer.addPass(this.logoOverlayPass)}_initCopyPass(){if(this._savePass)return;let e=new eB;this.renderer.getDrawingBufferSize(e),this._rt=new EB(e.x,e.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:JL,wrapT:JL}),this._rt.samples=0,this._savePass=new Cie(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(e){this._rt=e,this._savePass=new Cie(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(e){if(this._renderToScreen===e)return;let t=this.effectComposer;!t||(!0===e?t.removePass(this._savePass):t.addPass(this._savePass),this._renderToScreen=e,this.updateRenderToScreen())}set sceneTransitionFromTexture(e){e!==this.sceneTransitionPass.texture&&(null!==e?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=e)}setWatermark(e){this.logoOverlayPass.enabled=null!==e,e&&(this.logoOverlayPass.texture=e)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(e){let{enabled:t}=e,r=s(e,cL),n=!1;t!==this.postprocessingState.enabled&&(n=!0);for(let i of Object.entries(r)){let e=i[1],t=this.effects.get(i[0]);if(t){t.enabled!==e.enabled&&(n=!0),t.enabled=e.enabled;for(let[r,n]of Object.entries(e))"blendFunction"===r?t.blendFunction=Use(n):t[r]=n}}this.postprocessingState=e,n&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(e,t,r,n){e instanceof CB?(this.effectComposer.inputBuffer.scissor.set(e.x,e.y,e.z,e.w),this.effectComposer.outputBuffer.scissor.set(e.x,e.y,e.z,e.w)):(this.effectComposer.inputBuffer.scissor.set(e,t,r,n),this.effectComposer.outputBuffer.scissor.set(e,t,r,n));let i=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(i),this.effectComposer.outputBuffer.scissor.multiplyScalar(i),this.renderer.setScissor(e,t,r,n)}setScissorTest(e){this.effectComposer.inputBuffer.scissorTest=e,this.effectComposer.outputBuffer.scissorTest=e,this.renderer.setScissorTest(e)}setViewport(e,t,r,n){e instanceof CB?(this.effectComposer.inputBuffer.viewport.copy(e),this.effectComposer.outputBuffer.viewport.copy(e)):(this.effectComposer.inputBuffer.viewport.set(e,t,r,n),this.effectComposer.outputBuffer.viewport.set(e,t,r,n))}resize(e,t,r){if(this.effectComposer.setSize(e,t,r),this._rt){let r=this.renderer.getPixelRatio();this._rt.setSize(e*r,t*r)}}dispose(){var e,t;null!==(e=this.uvEffectPass)&&void 0!==e&&e.dispose(),null!==(t=this.effectPass)&&void 0!==t&&t.dispose(),this.effectComposer.dispose()}},Hse=VF.lights_fragment_begin,Wse=VF.shadowmask_pars_fragment,Gse=null,qse=new EF({vertexShader:"\nattribute vec3 randomColor;\nvarying vec3 vNormal;\nflat out vec3 vColor;\n#include <skinning_pars_vertex>\n#include <morphtarget_pars_vertex>\n\t\nvoid main()\n{\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\nvec3 transformed = vec3(position);\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n\nvNormal = normal;\nvColor = randomColor;\ngl_Position = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));\n}\n",fragmentShader:"\nuniform float depthContrast;\nvarying vec3 vNormal;\nflat in vec3 vColor;\nvoid main()\n{\nvec3 normal = (normalize(vNormal)).rgb;\n\nfloat contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;\n\nvec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);\ngl_FragColor = vec4(resultColor, vColor.r);\ngl_FragColor = vec4(resultColor, vColor.r);\n}\n",uniforms:{depthContrast:{value:1}}}),Xse=new _B,Yse=new eB,Kse=class extends gV{constructor(e){var t,r;super(e),t=this,this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new eB,this.dummyCamera=new Fne,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.getContext(),s=0;e&&(s|=i.COLOR_BUFFER_BIT),r&&(s|=i.DEPTH_BUFFER_BIT),n&&(s|=i.STENCIL_BUFFER_BIT),i.clear(s),i.clearBufferfv(i.COLOR,1,[0,0,0,1])},this.pipeline=new Vse(this,null!==(r=null===e||void 0===e?void 0:e.needsDOFResize)&&void 0!==r&&r),this.autoClear=!1;let n=this.setPixelRatio.bind(this),i=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=1,this.dummyCamera.matrixAutoUpdate=!1,this.domElement.removeAttribute("data-engine");let s=this.getContext();if(s&&"drawingBufferColorSpace"in s)try{s.drawingBufferColorSpace="display-p3"}catch(T0){console.warn(T0)}this.setPixelRatio=e=>{this._pixelRatio!==e&&(this._pixelRatio=e,n(e))},this.setSize=function(e,r){var n,s;let a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(t.viewportWidth!==e||t.viewportHeight!==r)&&(t.viewportWidth=e,t.viewportHeight=r,i(e,r,a),null!==(n=t.normalRenderTarget)&&void 0!==n&&n.setSize(e*t._pixelRatio,r*t._pixelRatio),t._resizeTransmission(e,r),null!==(s=t.transmissionDepthTarget)&&void 0!==s&&s.setSize(e*t._pixelRatio/2,r*t._pixelRatio/2),t.pipeline.resize(e,r,a))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){void 0===this.aoRenderTarget&&(this.aoRenderTarget=new EB(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:iN,magFilter:iN,wrapS:$L,wrapT:$L,depthBuffer:!1}))}_resizeTransmission(e,t){var r,n;null!==(r=this.transmissionRenderTarget)&&void 0!==r&&r.setSize(e*this._pixelRatio/(this.hdTransmission?1:2),t*this._pixelRatio/(this.hdTransmission?1:2)),null===(n=this.aoRenderTarget)||void 0===n||n.setSize(e*this._pixelRatio/1,t*this._pixelRatio/1)}get hdTransmission(){return 1===yee.transmissionLod.value}set hdTransmission(e){yee.transmissionLod.value=!0===e?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){void 0===this.transmissionRenderTarget&&(this.transmissionRenderTarget=new EB(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:aN,magFilter:iN,wrapS:$L,wrapT:$L,depthBuffer:!1}),this.transmissionDepthTarget=new EB(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:tN,magFilter:tN,depthBuffer:!1}))}createNormalRenderTarget(){void 0===this.normalRenderTarget&&(this.normalRenderTarget=new EB(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:tN,magFilter:tN,type:cN,depthTexture:new dV(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(e,t,r){this.normalRenderTarget&&(this.setClearColor(0),r.layers.enable(8),r.layers.disable(0),r.layers.disable(3),t.traverseEntity((e=>{e.layers.isEnabled(8)&&(e.copyPreviousMatrix=!1)})),this.setRenderTarget(this.normalRenderTarget),this.clear(),qse.uniforms.depthContrast.value=r instanceof Fne?(r.far-r.near)/1e4:1,t.overrideMaterial=qse,this.render(t,r),this.setClearColor(t.bgColor,t.bgColor.a),this.setRenderTarget(null),t.overrideMaterial=e.wireframeState?xle:null,r.layers.enable(0),r.layers.enable(3),t.traverseEntity((e=>{e.layers.isEnabled(8)&&(e.copyPreviousMatrix=!0)})))}renderSplineSceneWithDummyCamera(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.dummyCamera.updateCameraState(t.dataPatched),this.dummyCamera.matrix.copy(t.matrixWorld);let n=t.height,i=t.width,s=this.viewportWidth/this.viewportHeight;i<n?i=n*s:n=i/s,this.dummyCamera.setViewplaneSize(i,n);for(let a=0;a<r;a++)this.renderSplineScene(e,this.dummyCamera)}renderSplineScene(e,t){var r;let{sceneHelpers:n=this.sceneHelpers,sceneHelpersOnTop:i=this.sceneHelpersOnTop,overrideTransmission:s,overrideNormal:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=e instanceof _le?e.activePage:e,l=o.visible;o.visible=!0;let c=o.scene;this.xr.enabled&&(!1===this.isXRCopyPassSet&&null!==this.getRenderTarget()&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(t)),this.setClearColor(o.bgColor,o.bgColor.a),o.penumbraSizeArray.forEach(((e,t)=>{yee.penumbraSize.value[t]=e})),yee.pixelRatioNode.value=this.getPixelRatio(),0!==this.resolution.x&&0!==this.resolution.y?yee.resolution.value.set(this.resolution.x,this.resolution.y):yee.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),void 0!==a?(yee.normalRenderTarget.value=a,yee.normalRenderTargetDepth.value=Xse):c.needsNormal()&&(this.createNormalRenderTarget(),yee.normalRenderTarget.value=this.normalRenderTarget.texture,yee.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(c,o,t));let u=o.data.ao,h=u.occlusion;if(h&&(this.createAORenderTarget(),yee.aoRenderTarget.value=this.aoRenderTarget.texture),yee.aoEnabled.value=h,this.pipeline.setAmbientOcclusionParams(u.occlusion,u.radius,u.bias,o.aoColor,null!==o.fog,o.backupFog.near,o.backupFog.far,u.aoFullRes&&!xZ),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture),this.pipeline.isUIOverlayEnabled&&null!==(r=o.uiCanvas)&&void 0!==r&&r.enabled&&o.uiCanvas.texture&&o.uiCanvas.texture.image.width>0){let e=this.getSize(Yse),t=this.getPixelRatio();(o.uiCanvas.width!==this.viewportWidth||o.uiCanvas.height!==this.viewportHeight||o.uiCanvas.dpr!==t)&&o.uiCanvas.applySize({width:this.viewportWidth,height:this.viewportHeight},t),o.uiCanvas.render(this),this.pipeline.uiOverlayPass.uiCanvas=o.uiCanvas,this.pipeline.uiOverlayPass.enabled=!0,this.pipeline.uiOverlayPass.setResolution(e.x,e.y,t),this.pipeline.updateRenderToScreen()}else this.pipeline.uiOverlayPass.enabled=!1,this.pipeline.updateRenderToScreen();if(this.pipeline.logoOverlayPass.enabled){let e=this.getSize(Yse),t=this.getPixelRatio();this.pipeline.logoOverlayPass.uniforms.uResolution.value.set(e.x,e.y),this.pipeline.logoOverlayPass.uniforms.uDPR.value=t}let d=!1;if(void 0!==s)yee.transmissionRenderTarget.value=s,yee.transmissionRenderTargetDepth.value=Xse,this.pipeline.setTransmissionPassEnabled(!1);else{let e=c.needsTransmission();e&&(void 0===this.transmissionRenderTarget&&(d=!0),this.createTransmissionRenderTarget(),yee.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,yee.aspectRatio.value=function(e,t){return e>=t?new eB(t/e,1):new eB(1,e/t)}(this.viewportWidth,this.viewportHeight),yee.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(e)}t.layers.enable(3),t.layers.enable(8),this.pipeline.sceneHelpers=n,this.pipeline.sceneHelpersOnTop=i,this.pipeline.scene=o,this.pipeline.camera=t,d&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==o.postprocessing&&(this.pipeline.updatePostprocessing(o.postprocessing),!n&&!i&&this.pipeline.disableHelpers()),void 0!==this.clearAlphaOverride&&this.setClearAlpha(this.clearAlphaOverride),c.shapeBlendIntances.forEach((e=>{e.onBeforeShadowPass(this)})),o.overrideMaterial=c.wireframeState?xle:null,this.pipeline.render(),yee.frameIndex.value=(yee.frameIndex.value+1)%16,t instanceof Fne&&t.copyHistory(),o.visible=l}renderFromSceneForSceneTransitionPass(e,t,r){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(e,t),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=r,this.sceneTransitionTimeRemaining=r,this.pipeline.renderToScreen=!0;let n=this.pipeline.sceneTransitionPass.uniforms;n.uDPR.value=window.devicePixelRatio,n.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){var e,t,r,n,i;this._superDispose(),this.pipeline.dispose(),null!==(e=this.aoRenderTarget)&&void 0!==e&&e.dispose(),null!==(t=this.transmissionRenderTarget)&&void 0!==t&&t.dispose(),null!==(r=this.transmissionDepthTarget)&&void 0!==r&&r.dispose(),null!==(n=this.normalRenderTarget)&&void 0!==n&&n.dispose(),null===(i=this.normalRenderTarget)||void 0===i||null===(i=i.depthTexture)||void 0===i||i.dispose()}},Qse=class extends(xne(xG)){constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,arguments.length>2&&void 0!==arguments[2]?arguments[2]:10066329),this.object=e,this.added=!1,this.name="DirectionalLightHelper: ".concat(e.uuid)}raycast(e,t){Ene(this.object,Qse.geometryHelper,e,t)}},Zse=class extends(xne(vG)){constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,arguments.length>2&&void 0!==arguments[2]?arguments[2]:6710886),this.object=e,this.name="PointLightHelper: ".concat(e.uuid)}raycast(e,t){Ene(this.object,Zse.geometryHelper,e,t)}},Jse=class extends(xne(gG)){constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:6710886),this.object=e,this.name="SpotLightHelper: ".concat(e.uuid)}raycast(e,t){Ene(this.object,Jse.geometryHelper,e,t)}update(){if(void 0!==this.object){let e=Jse._vector,t=this.object.distance?this.object.distance:1e3,r=t*Math.tan(this.object.angle);this.cone.scale.set(r,r,t),e.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(e);let n=void 0!==this.color?this.color:this.light.color;if(this.cone.material instanceof Array)for(let i=0,s=this.cone.material.length;i<s;i++)this.cone.material[i].color.set(n);else this.cone.material.color.set(n)}}},$se=Jse;$se._vector=new PB;var eae=class extends cV{constructor(){super(),this.caretIndex=0,this._caretVisibleAlpha=1,this._selectionVisibleAlpha=.3,this.current={start:0,end:void 0},this.matrixAutoUpdate=!1,this.caretMesh=new yF(new UF(1,1),new Wz({transparent:!0,opacity:0,side:2})),this.add(this.caretMesh),this.selectionMesh=new yF(new UF(1,1),new Wz({color:2857471,transparent:!0,depthTest:!1,depthWrite:!1,opacity:0,side:2})),this.add(this.selectionMesh),this.hide()}get caretHeight(){var e,t;return null!==(e=null===(t=this.object)||void 0===t?void 0:t.AD)&&void 0!==e?e:0}show(e){this.visible=!0,this.object=e,this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.y=.5*-this.caretHeight,this.setCaretPosition(this.caretIndex),this.update()}hide(){this.visible=!1}update(){if(void 0===this.object)return;this.updateHelperMatrix();let{depth:e}=this.object.geometry.userData.parameters;this.caretMesh.position.z=e,this.selectionMesh.position.z=e}updateHelperMatrix(){if(void 0===this.object)return;let e=this.object,t=e.parent;null!==t&&t.updateWorldMatrix(!0,!1),e.matrixAutoUpdate&&e.updateMatrix(),null!==t?(this.matrixWorld.multiplyMatrices(t.matrixWorld,e.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,e.matrix)):this.matrixWorld.multiplyMatrices(e.hiddenMatrix,e.matrix),this.matrix.copy(this.matrixWorld);for(let r of this.children)r.matrixWorld.copy(this.matrixWorld);e.updateWorldMatrix(!0,!0)}setCaretColor(e){let t=this.caretMesh.material;t.color.setRGB(e.r,e.g,e.b);let r=this._caretVisibleAlpha===t.opacity;this._caretVisibleAlpha=e.a,r&&(t.opacity=this._caretVisibleAlpha)}setSelectionColor(e){this.selectionMesh.material.color.setRGB(e.r,e.g,e.b)}setCaretPosition(e){if(void 0===this.object)return;this.caretIndex=e;let t=this.object.wrappedText,[r,n]=rae(t,e),[i,s]=e>0?rae(t,e-1):[null,null];"\n"===(e>0&&t.length?t[i].charAt(s):null)&&(r++,n=0),this.current.start=e,this.current.end=void 0;let[a,o]=tae(this.object,r,n),{AD:l,descender:c}=this.object,u=c+.5*l,{width:h,height:d,depth:f}=this.object.geometry.userData.parameters,p="string"==typeof h?0:h,m="string"==typeof d?0:d;this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.set(a-.5*p,o+u+.5*m,f),this.hideSelectionMesh(),this.showCaretMesh()}setSelection(e,t){if(void 0===this.object)return;let r=this.object.wrappedText;this.current.start=e,this.current.end=t;let n=[],i=[],s=function(e,t,r){let[n,i]=rae(e,t),[s,a]=rae(e,r),o=[];i>=e[n].length&&(n++,i=0);for(let l=n;l<=s;l++){let t=e[l],r=l===n?i:0,c=l===s?a:t.length;o.push([l,r,c])}return o}(r,e,t),{lineHeight:a,AD:o,descender:l}=this.object,c=l+.5*o-.5*a;for(let[g,v,y]of s)if(v!==y){let[e,t]=tae(this.object,g,v),[r,s]=tae(this.object,g,y);t+=c,s+=c,s+=a;let o=n.length/3;n.push(e,t,0),n.push(r,t,0),n.push(r,s,0),n.push(e,s,0),i.push(o+0,o+1,o+2),i.push(o+2,o+3,o+0)}let u=new iF;u.setIndex(i),u.setAttribute("position",new Qz(n,3));let{width:h,height:d,depth:f}=this.object.geometry.userData.parameters,p="string"==typeof h?0:h,m="string"==typeof d?0:d;this.selectionMesh.geometry.dispose(),this.selectionMesh.geometry=u,this.selectionMesh.position.x=.5*-p,this.selectionMesh.position.y=.5*m,this.selectionMesh.position.z=f,this.showSelectionMesh(),this.hideCaretMesh()}getSelectionFromPosition(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"previous";if(void 0===this.object||void 0===this.object.font)return;let n=this.object.wrappedText,i=n.length,s=this.object.lineHeight,a=i*s,{height:o,verticalAlign:l}=this.object.geometry.userData.parameters,c="string"==typeof o?0:o,u=0;3===l?u=c-a:2===l&&(u=.5*c-.5*a);let h=Math.min(Math.floor(Math.max(Math.min(-t-u,a),0)/s),i-1),d=this.object.charCoords[h],f=this.object.charWidths[h],p=0,m=!1;if("previous"===r){for(let g=0;g<d.length;g++)if(d[g][0]+.5*f[g]-e>0){p=g,m=!0;break}}else if("closest"===r){let t=1/0;for(let r=0;r<d.length;r++){let n=d[r][0]+.5*f[r],i=Math.abs(n-e);i<t&&(t=i,p=r,m=!0)}}else for(let g=0;g<d.length;g++){let t=d[g][0],r=d[g][0]+f[g];if(e>=t&&e<r){p=g,m=!0;break}}return m||(p=d.length),{index:this.getGlobalIndexFromLineAndCharIndexes(n,h,p),lineIndex:h,characterIndex:p}}getGlobalIndexFromLineAndCharIndexes(e,t,r){return e.slice(0,t).reduce(((e,t)=>e+t.length),0)+r}showSelectionMesh(){this.selectionMesh.material.opacity=this._selectionVisibleAlpha}hideSelectionMesh(){this.selectionMesh.material.opacity=0}showCaretMesh(){this.caretMesh.material.opacity=this._caretVisibleAlpha}hideCaretMesh(){this.caretMesh.material.opacity=0}};function tae(e,t,r){let{charCoords:n,charWidths:i,initialOffsetY:s,lineHeight:a}=e;if(n[t]&&0===n[t].length||0===n.length){let r=0,{horizontalAlign:n}=e.data.geometry,i=e.wrappedText,{width:o}=e.geometry.userData.parameters;return 1===i.length&&0===i[0].length&&(3===n?r=.5*o:2===n&&(r=o)),[r,s-a*t]}let o=n[t];if(void 0===o||0===o.length)return[0,0];let[l,c]=o[Math.min(r,o.length-1)];return r>=o.length&&(l+=i[t][r-1]),[l,c]}function rae(e,t){var r,n;let i=0;for(let s=0;s<e.length;s++){let r=e[s],n=t-i;if(n<=r.length)return[s,n];i+=r.length}return[Math.max(0,e.length-1),null!==(r=null===(n=e[e.length-1])||void 0===n?void 0:n.length)&&void 0!==r?r:0]}function nae(e,t){return"string"==typeof e?t.data.colors[e]:e}function iae(e){return e.colors[0]}var sae,aae=class extends(Gne(FW,Qse)){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.top=1250,n.bottom=-1250,n.right=1250,n.left=-1250,n.near=-1e4,n.far=2500;let i=new CG(this.shadow.camera);i.visible=!1,this.gizmos.shadowmap=i}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof CG&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t);let r=void 0!==e.depth&&e.depth!==this.shadow.camera.far||void 0!==e.size&&e.size/2!==this.shadow.camera.right;void 0!==e.size&&function(e,t){e.shadow.camera.right=t/2,e.shadow.camera.left=-t/2,e.shadow.camera.top=t/2,e.shadow.camera.bottom=-t/2,e.shadow.needsUpdate=!0}(this,e.size),void 0!==e.shadowRadius&&(this.shadow.radius=e.shadowRadius),void 0!==e.shadowResolution&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),void 0!==e.penumbraSize&&t.scene.markPenumbraSizeDirty(),r&&this.update()}},oae=new PB,lae=new PB,cae=new TB,uae=class extends(Gne(IW,$se)){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.fov=2*$N.RAD2DEG*this.angle,n.aspect=1,n.near=100,n.far=2500;let i=new CG(this.shadow.camera);i.visible=!1,this.gizmos.shadowmap=i,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof CG&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),lae.setFromMatrixPosition(this.matrixWorld),cae.setFromRotationMatrix(this.matrixWorld),oae.copy(this.up).applyQuaternion(cae).negate().multiplyScalar(this.distance),this.target.position.copy(lae).add(oae),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),void 0!==e.distance&&(this.distance=e.distance),void 0!==e.decay&&(this.decay=e.decay),void 0!==e.angle&&(this.angle=e.angle),void 0!==e.penumbra&&(this.penumbra=e.penumbra),void 0!==e.shadowRadius&&(this.shadow.radius=e.shadowRadius),void 0!==e.penumbraSize&&t.scene.markPenumbraSizeDirty(),void 0!==e.shadowResolution&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}};function hae(e,t){return[[e[0][0]*t[0][0]+e[0][1]*t[1][0],e[0][0]*t[0][1]+e[0][1]*t[1][1]],[e[1][0]*t[0][0]+e[1][1]*t[1][0],e[1][0]*t[0][1]+e[1][1]*t[1][1]]]}function dae(e){return[[e[0][0],e[1][0]],[e[0][1],e[1][1]]]}function fae(e){let[t,r,n]=function(e){let t=(e[0][0]+e[1][1])/2,r=(e[0][0]-e[1][1])/2,n=(e[1][0]+e[0][1])/2,i=(e[1][0]-e[0][1])/2,s=Math.sqrt(t*t+i*i),a=Math.sqrt(r*r+n*n),o=s+a,l=s-a,c=Math.atan2(n,r),u=Math.atan2(i,t),h=(u-c)/2,d=(u+c)/2,f=[[Math.cos(d),Math.sin(d)],[-Math.sin(d),Math.cos(d)]],p=[[o,0],[0,l]],m=[[Math.cos(h),Math.sin(h)],[-Math.sin(h),Math.cos(h)]];return f[0][0]*=-1,f[0][1]*=-1,m[0][0]*=-1,m[1][0]*=-1,[f,p,m]}(e),i=hae(t,dae(n)),s=hae(hae(n,r),dae(n));return{rotation:Math.atan2(i[1][0],i[0][0]),scale:[s[0][0],s[1][1]],shear:[s[0][1]/s[1][1],s[1][0]/s[0][0]]}}(e=>{function t(e){return[e[0],e[3],e[1],e[4],e[2],e[5]]}e.identity=function(){return[1,0,0,0,1,0,0,0,1]},e.copy=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.identity();for(let e=0,n=t.length;e<n;e++)r[e]=t[e];return r},e.create=function(t,r,n,i,s,a){return e.setAbcdef(e.identity(),t,r,n,i,s,a)},e.setAbcdef=function(e,t,r,n,i,s,a){return e[0]=t,e[1]=n,e[2]=s,e[3]=r,e[4]=i,e[5]=a,e},e.append=function(r,n){let[i,s,a,o,l,c]=t(r),[u,h,d,f,p,m]=t(n),g=u*i+h*a,v=u*s+h*o,y=d*i+f*a,b=d*s+f*o,w=p*i+m*a+l,x=p*s+m*o+c;return e.create(g,v,y,b,w,x)},e.prepend=function(r,n){let[i,s,a,o,l,c]=t(r),[u,h,d,f,p,m]=t(n),g=i,v=s,y=a,b=o;(1!==u||0!==h||0!==d||1!==f)&&(g=i*u+s*d,v=i*h+s*f,y=a*u+o*d,b=a*h+o*f);let w=l*u+c*d+p,x=l*h+c*f+m;return e.create(g,v,y,b,w,x)},e.getAbcdef=t,e.invert=function(t){let[r,n,i,s,a,o]=e.getAbcdef(t),l=r*s-n*i,c=s/l,u=-n/l,h=-i/l,d=r/l,f=(i*o-s*a)/l,p=-(r*o-n*a)/l;return e.create(c,u,h,d,f,p)},e.apply=function(t,r){let[n,i]=t,[s,a,o,l,c,u]=e.getAbcdef(r);return[s*n+o*i+c,a*n+l*i+u]},e.applyInverse=function(t,r){let[n,i,s,a,o,l]=e.getAbcdef(r),c=1/(n*a+s*-i),[u,h]=t;return[a*c*u+-s*c*h+(l*s-o*a)*c,n*c*h+-i*c*u+(-l*n+o*i)*c]},e.scale=function(t,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,[i,s,a,o,l,c]=e.getAbcdef(t);return e.setAbcdef(t,i*r,s*n,a*r,o*n,l*r,c*n),t},e.rotate=function(t,r){let n=Math.cos(r),i=Math.sin(r),[s,a,o,l,c,u]=e.getAbcdef(t);return e.setAbcdef(t,s*n-a*i,s*i+a*n,o*n-l*i,o*i+l*n,c*n-u*i,c*i+u*n),t},e.rotateAround=function(t,r,n){let[i,s]=n,a=e.translate(t,-i,-s);return a=e.rotate(a,r),a=e.translate(a,i,s),a},e.translate=function(t,r,n){let[i,s,a,o,l,c]=e.getAbcdef(t);return e.setAbcdef(t,i,s,a,o,l+r,c+n),t},e.setTranslate=function(t,r,n){let[i,s,a,o]=e.getAbcdef(t);return e.setAbcdef(t,i,s,a,o,r,n),t},e.setPosition=function(t,r,n){let[i,s,a,o]=e.getAbcdef(t);return e.setAbcdef(t,i,s,a,o,r,n),t},e.getScale=function(t){let[r,n,i,s]=e.getAbcdef(t);return[Math.sqrt(r*r+n*n),Math.sqrt(i*i+s*s)]},e.getPosition=function(t){let[,,,,r,n]=e.getAbcdef(t);return[r,n]},e.getRotation=function(t,r){return e.decompose(t,r).rotation},e.decompose=function(t,r){let[n,i,s,a,o,l]=e.getAbcdef(t),{rotation:c,scale:u,shear:h}=fae([[n,s],[i,a]]);return{position:[o+(r[0]*n+r[1]*s)-r[0],l+(r[0]*i+r[1]*a)-r[1]],scale:u,rotation:c,shear:h,pivot:r}},e.compose=function(t,r,n,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[0,0],[a,o]=t,[l,c]=i,[u,h,d,f]=function(e){let{rotation:t,scale:r,shear:n}=e,i=Math.cos(t),s=Math.sin(t),a=hae([[i,-s],[s,i]],[[r[0],n[0]*r[1]],[n[1]*r[0],r[1]]]);return[a[0][0],a[1][0],a[0][1],a[1][1]]}({rotation:n,scale:r,shear:s}),p=a-(l*u+c*d)+l,m=o-(l*h+c*f)+c;return e.create(u,h,d,f,p,m)}})(sae||(sae={}));var pae=Math.PI/180;Math.PI;var mae=class{constructor(e,t,r){var n;this.uuid=e,this.data=t,this.localMatrix=sae.identity(),this.worldMatrix=sae.identity(),this.ignoreCameraZoom=!1,this.visible=!0,this._singleBBox=new Eae,this._recursiveBBox=new Eae,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this.stateSelection=null,this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this.name="",this.position=[0,0],this.scale=[1,1],this.rotation=0,this.shear=[0,0],this.emitter=P8(),this.dpr=null!==(n=r.dpr)&&void 0!==n?n:1,this.dataPatched=t}project(e,t){let r=this.worldMatrix;return t&&(r=sae.append(t.worldMatrix,r)),sae.applyInverse(e,r)}intersects(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.visible&&!this.data.raycastLock&&this.intersectsInLocalSpace(...this.project([e,t],r),n)}intersectsInLocalSpace(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{min:n,max:i}=r?this.recursiveBBox:this.singleBBox;return e>=n[0]&&e<=i[0]&&t>=n[1]&&t<=i[1]}applyTransforms(e){e.setTransform(this.worldMatrix,this.ignoreCameraZoom)}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges()),this._recursiveBBox}updateLocalMatrix(){this.localMatrix=sae.compose(this.position,this.scale,function(e){return e*pae}(this.rotation),s3.getPivot(this.dataPatched),this.shear)}updateWorldMatrix(e,t,r){let n=this.parent;t&&null!==n&&void 0!==n&&n.updateWorldMatrix(e,!0,!1),e&&this.updateLocalMatrix(),this.parent?this.worldMatrix=sae.append(this.parent.worldMatrix,this.localMatrix):this.worldMatrix=sae.copy(this.localMatrix),this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}get pivot(){return s3.getPivot(this.data)}getCenter(){return[0,0]}getHalfSize(){return[0,0]}get id(){return this.uuid}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors((e=>{e.resetBBoxNeedsUpdateSelf()}))}updateTransformState(e){let t=!1;void 0!==e.position&&(t=!0,this.position=e.position),void 0!==e.rotation&&(t=!0,this.rotation=e.rotation),void 0!==e.scale&&(t=!0,this.scale=e.scale),void 0!==e.shear&&(t=!0,this.shear=e.shear),t&&(this.updateWorldMatrix(!0,!1,!0),this.resetBBoxNeedsUpdate())}updateByOp(e,t,r){0===e.type&&void 0!==e.props.visible&&(this.visible=e.props.visible),this.data=t,this.data=t;let n=e,i=NJ(e.path,["states","*"]);if(null!==i){if(0===e.type){let[t]=i;if((null===this||void 0===this?void 0:this.stateSelection)===t){let t=u({},e.props);if(delete t.name,Object.values(e.props).some((e=>void 0===e))){let r=this.data;if(void 0!==r){let n=kJ.zoom(r,e.path.slice(2));if(n)for(let r in e.props)void 0===e.props[r]&&r in n&&(t[r]=n[r])}}n=u(u({},e),{},{props:t,path:e.path.slice(2)})}}}else if(0===e.type){let t=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(void 0!==t){if(void 0!==e.props.name&&t.name){let{name:e}=t;t=s(t,uL)}let r=kJ.removeOverridden(e.path,e.props,t);n=u(u({},e),{},{props:r})}}this.updateByPatchedOpBase(n,Y2.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),r)}changeSelectedState(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0!==this.data.states.length||r){for(let e of this.data.states)Y2.toOps(this.data,e.data).forEach((e=>{let r=aJ.replaceProps(e,this.data);this.dataPatched=this.data,this.updateByPatchedOp(r,this.data,t)}));if(null!==e){let r=this.data.states.data(e);r&&(this.dataPatched=Y2.patch(this.data,r),Y2.toOps(this.data,r).forEach((e=>{this.updateByPatchedOp(e,this.dataPatched,t)})))}r&&this.updateTransformState(this.dataPatched),this.stateSelection=e}}updateState(e,t){void 0!==e.name&&(this.name=e.name),void 0!==e.visible&&(this.visible=e.visible),this.updateTransformState(e)}updateByPatchedOpBase(e,t,r){this.dataPatched=t,this.updateByPatchedOp(e,t,r)}updateByPatchedOp(e,t,r){0===e.path.length&&0===e.type&&this.updateState(e.props,r),this.requestRender()}traverseFrameAncestors(e){this.traverseAncestors((t=>{"frame2d"===t.data.type&&e(t)}))}traverseAncestors(e){let t=this.parent;for(;t;)e(t),t=t.parent}requestRender(){this.traverseFrameAncestors((e=>{e.requestRender()}))}clone(e){let t=new mae(this.uuid,this.data,e);return t.parent=void 0,t}addEventListener(e,t){this.emitter.on(e,t)}removeEventListener(e,t){this.emitter.off(e,t)}dispatchEvent(e){var t;this.emitter.emit(e.type,u(u({},e),{},{target:null!==(t=e.target)&&void 0!==t?t:this}))}traverseSortNextHelper(){let e=this.parent;if(e){let t=e.children;if(t){let r=t.indexOf(this)+1;return t[r]?t[r]:e.traverseSortNextHelper()}}}sortNext(){let e=this.children;return e&&e.length>0&&e[0]?e[0]:this.traverseSortNextHelper()}isDescendantOf(e){e instanceof mae&&(e=e.uuid);let t=this;for(;t.parent;){if(t.parent.uuid===e)return!0;t=t.parent}return!1}},gae=class extends mae{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.context=r,this.children=[]}add(e){e.parent&&e.parent instanceof gae&&e.parent.remove(e),this.children.push(e),e.parent=this}remove(e){let t=this.children.indexOf(e);t>=0&&(this.children.splice(t,1),e.parent=void 0)}traverse(e){let t=e(this);if(!0!==t)for(let r of this.children)r instanceof gae?r.traverse(e):t=e(r)}intersectsChildrenHelper(e,t,r,n,i){for(let s of this.children)if(s.intersects(e,t,r,!1)&&(i.push(s),n)||s instanceof gae&&s.intersectsChildrenHelper(e,t,r,n,i))return!0;return!1}intersectsChildren(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return this.intersectsChildrenHelper(e,t,r,n,i),i}intersectsChildrenHelperReverse(e,t,r,n,i){for(let s of this.children)if(s instanceof gae&&s.intersectsChildrenHelperReverse(e,t,r,n,i)||s.intersects(e,t,r,!1)&&(i.push(s),n))return!0;return!1}intersectsChildrenReverse(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return this.intersectsChildrenHelperReverse(e,t,r,n,i),i}updateWorldMatrix(e,t,r){if(super.updateWorldMatrix(e,t,r),r&&this.children)for(let n of this.children)n.updateWorldMatrix(e,!1,!0)}find(e){let t;return this.traverse((r=>{r.uuid===e&&(t=r)})),t}innerDrawChildren(e){for(let t=this.children.length-1;t>=0;t--)this.children[t].draw(e)}resetBBoxNeedsUpdate(){super.resetBBoxNeedsUpdate(),this.traverse((e=>{e.resetBBoxNeedsUpdateSelf()}))}clone(e){let t=new gae(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}},vae=class extends gae{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.updateState(t,r)}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.innerDrawChildren(e),e.restore())}clone(e){let t=new vae(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}};function yae(e,t){let[[r,n],[i,s]]=e,[[a,o],[l,c]]=t,u=(r-i)*(o-c)-(n-s)*(a-l);if(0===u)return!1;let h=((r-a)*(o-c)-(n-o)*(a-l))/u,d=-((r-i)*(n-o)-(n-s)*(r-a))/u;return h>=0&&h<=1&&d>=0&&d<=1}var bae,wae,xae,Sae,_ae=[[-1,1],[-1,-1],[1,-1],[1,1]],Cae=(e,t,r)=>{let n=e.getCenter(),i=e.getHalfSize(),s=sae.append(t,e.worldMatrix);0===i[0]&&0===i[1]?r.push(sae.apply(n,s)):_ae.forEach((e=>{let t=[e[0]*i[0]+n[0],e[1]*i[1]+n[1]];r.push(sae.apply(t,s))}))},Eae=class{constructor(){this.matrix=sae.identity(),this.min=[1/0,1/0],this.max=[-1/0,-1/0],this.vertices=[],this.edges=[]}setFromObjectSize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(),this.makeEmpty(),sae.copy(e.worldMatrix,this.matrix);let r=sae.invert(e.worldMatrix);this.expandByObjectSize(e,r,t)}expandByObjectSize(e,t){let r=[];!0===(arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&e instanceof gae?e.traverse((e=>{e.visible&&Cae(e,t,r)})):Cae(e,t,r),this.setFromPoints(r)}setFromSize(e,t,r){this.makeEmpty(),sae.copy(r,this.matrix),this.expandBySize(e,t,r)}expandBySize(e,t,r){[sae.apply([0,0],r),sae.apply([0,t],r),sae.apply([e,t],r),sae.apply([e,0],r)].forEach((e=>this.expandByPoint(e)))}getCenter(){let[e,t]=this.min,[r,n]=this.getHalfSize();return sae.apply([e+r,t+n],this.matrix)}getSize(){return[this.max[0]-this.min[0],this.max[1]-this.min[1]]}getHalfSize(){return[.5*(this.max[0]-this.min[0]),.5*(this.max[1]-this.min[1])]}makeEmpty(){this.min=[1/0,1/0],this.max=[-1/0,-1/0]}setFromPoints(e){this.makeEmpty();for(let t of e)this.expandByPoint(t)}expandByPoint(e){this.min=[Math.min(this.min[0],e[0]),Math.min(this.min[1],e[1])],this.max=[Math.max(this.max[0],e[0]),Math.max(this.max[1],e[1])]}computeVertices(){let[e,t]=this.getHalfSize(),r=this.getCenter(),[n,i,s,a]=sae.getAbcdef(this.matrix),o=sae.create(n,i,s,a,r[0],r[1]);this.vertices=_ae.map((r=>{let[n,i]=r;return sae.apply([n*e,i*t],o)}))}computeEdges(){this.edges=[];for(let e=0,t=this.vertices.length;e<t;++e)this.edges.push([this.vertices[e],this.vertices[(e+1)%t]])}project(e,t){let r=this.matrix;return t&&(r=sae.append(t.worldMatrix,r)),sae.applyInverse(e,r)}intersects(e,t,r){return this.intersectsInLocalSpace(...this.project([e,t],r))}intersectsInLocalSpace(e,t){let{min:r,max:n}=this;return e>=r[0]&&e<=n[0]&&t>=r[1]&&t<=n[1]}containsPoint(e){let[t,r]=e,[n,i]=this.min,[s,a]=this.max;return t>=n&&t<=s&&r>=i&&r<=a}intersectsBBox2D(e){for(let t=0,r=this.edges.length;t<r;t++){let r=this.edges[t];for(let t=0,n=e.edges.length;t<n;t++){if(yae(r,e.edges[t]))return!0}}for(let t=0,r=e.vertices.length;t<r;t++){let r=e.vertices[t];if(this.containsPoint(r))return!0}return!1}ensureMinMax(){let e=this.min,t=this.max;this.min=[Math.min(e[0],t[0]),Math.min(e[1],t[1])],this.max=[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}copy(e){this.min=[...e.min],this.max=[...e.max],sae.copy(e.matrix,this.matrix),this.computeVertices(),this.computeEdges()}clone(){let e=new Eae;return e.copy(this),e}},Aae=new Promise((e=>{bae=e})),Mae=!1;function Tae(){if(!Mae)return wae||(wae=async function(){var e;let t=await r.e(160).then(r.bind(r,160));bae(null!==(e=t.default)&&void 0!==e?e:t),Mae=!0}(),wae)}function Pae(e){let t=!1;return e.scene.objects.traverse(((e,r)=>{("Mesh"===r.type&&"UIGeometry"===r.geometry.type||"Page"===r.type&&void 0!==r.uiFrame)&&(t=!0)})),t}var kae=sae.identity(),Dae=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.canvas=e,this._dpr=t,this._width=0,this._height=0,this._strokeMode="inside",this._layerBlur=0,this._backgroundBlur=0,this._dropShadowBlur=0,this._dropShadowOffsetX=0,this._dropShadowOffsetY=0,this._dropShadowColor=W0.transparent,this._innerShadowBlur=0,this._innerShadowOffsetX=0,this._innerShadowOffsetY=0,this._innerShadowSpread=0,this._innerShadowColor=W0.transparent,this._fonts=new Map,this._isSizeDirty=!1;try{let r=e.getBoundingClientRect();e.width=r.width*t,e.height=r.height*t}catch(r){console.log(e.width,t)}this._currentM3Transform=kae,this._currentTransform=new Float32Array(kae)}get dpr(){return this._dpr}set dpr(e){this._dpr=e,this._isSizeDirty=!0}async init(){var e,t;if(!this.wasmURL)throw Error("Your must set the wasm binary url with renderer.wasmURL = ... before you can call renderer.init");await async function(e){let t=await Aae;xae||(Sae||(Sae=t({locateFile:()=>e})),xae=await Sae)}(this.wasmURL),this._surface=xae.MakeWebGLCanvasSurface(this.canvas),this.ctx=null===(e=this._surface)||void 0===e?void 0:e.getCanvas(),this._paint=new xae.Paint,this._paint.setAntiAlias(!0),this._paintFill=this._paint.copy(),this._paintFill.setStyle(xae.PaintStyle.Fill),this._paintStroke=this._paint.copy(),this._paintStroke.setStyle(xae.PaintStyle.Stroke),null===(t=this.ctx)||void 0===t||t.scale(this.dpr,this.dpr)}get currentTransform(){return this._currentM3Transform}get currentTransformBuffer(){return this._currentTransform}set currentTransform(e){this._currentM3Transform=e,this._currentTransform.set(e)}async loadFont(e,t){let r=await(await fetch(e)).arrayBuffer();this.registerFont(r,t)}registerFont(e,t){if(this._fonts.has(t))return;let r=xae.FontMgr.FromData(e);if(!r)throw new Error("Invalid font data for "+t);this._fonts.set(t,r)}get width(){return this._width}get height(){return this._height}set strokeColor(e){this._paintStroke&&this._paintStroke.setColor(Oae(e),xae.ColorSpace.DISPLAY_P3)}set fillColor(e){this._paintFill&&this._paintFill.setColor(Oae(e),xae.ColorSpace.DISPLAY_P3)}set lineWidth(e){this._paintStroke&&this._paintStroke.setStrokeWidth("center"===this._strokeMode?e:2*e)}set strokeMode(e){this._strokeMode=e}set dropShadowBlur(e){this._dropShadowBlur=e}set dropShadowColor(e){this._dropShadowColor=e}set dropShadowOffsetX(e){this._dropShadowOffsetX=e}set dropShadowOffsetY(e){this._dropShadowOffsetY=e}set innerShadowBlur(e){this._innerShadowBlur=e}set innerShadowColor(e){this._innerShadowColor=e}set innerShadowOffsetX(e){this._innerShadowOffsetX=e}set innerShadowOffsetY(e){this._innerShadowOffsetY=e}set innerShadowSpread(e){this._innerShadowSpread=e}set layerBlur(e){this._layerBlur=e}set backgroundBlur(e){this._backgroundBlur=e}clear(){var e;null===(e=this.ctx)||void 0===e||e.clear(xae.TRANSPARENT)}save(){var e;null===(e=this.ctx)||void 0===e||e.save()}restore(){var e;null===(e=this.ctx)||void 0===e||e.restore()}beginPath(){var e;null!==(e=this._currentPath)&&void 0!==e&&e.delete(),this._currentPath=new xae.Path}closePath(){let e=this._currentPath;if(e){if(e.isEmpty())return;let t=e.getBounds();(t[3]-t[1]||t[2]-t[0])&&e.close()}}fill(){this._paintInner(this._paintFill,!0)}stroke(){this._paintInner(this._paintStroke,!1)}clipRect(e,t,r,n){var i;let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=xae.XYWHRect(e,t,r,n);if(0===s&&0===a&&0===l&&0===o)null===(i=this.ctx)||void 0===i||i.clipRect(c,xae.ClipOp.Intersect,!0);else{var u;let e=xae.RRectXY(c,s,s);e[4]=e[5]=s,e[6]=e[7]=a,e[8]=e[9]=o,e[10]=e[11]=l,null===(u=this.ctx)||void 0===u||u.clipRRect(e,xae.ClipOp.Intersect,!0)}}_applyShadowOffsetMatrix(){if(this.ctx){let e=sae.invert(this.currentTransform);this.ctx.concat(e);let t=sae.translate(sae.identity(),this._dropShadowOffsetX,this._dropShadowOffsetY);this.ctx.concat(t),this.ctx.concat(this._currentTransform)}}_applyEffectsToPaint(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.ctx&&this._currentPath){let d,f=!1;if(r&&this._hasDropShadow()){var n,i,s;let r,a=e.copy();a.setColor(Oae(this._dropShadowColor)),this._dropShadowBlur>0&&(r=xae.MaskFilter.MakeBlur(xae.BlurStyle.Normal,this._dropShadowBlur*this.dpr*(null!==(n=null===(i=this.camera)||void 0===i?void 0:i.scale)&&void 0!==n?n:1),!1),a.setMaskFilter(r)),this.ctx.save(),this.ctx.clipPath(this._currentPath,xae.ClipOp.Difference,!0),this._applyShadowOffsetMatrix(),t(a),this.ctx.restore(),a.delete(),null===(s=r)||void 0===s||s.delete()}if(this._backgroundBlur>0&&r){this.ctx.save(),this.ctx.clipPath(this._currentPath,xae.ClipOp.Intersect,!0);let t=xae.ImageFilter.MakeBlur(this._backgroundBlur,this._backgroundBlur,xae.TileMode.Clamp,null),r=e.copy();r.setImageFilter(t),r.setAlphaf(1);let n=this._currentPath.computeTightBounds();this.ctx.saveLayer(r,n,null,xae.SaveLayerInitWithPrevious),this.ctx.drawColor(e.getColor()),this.ctx.restore(),this.ctx.restore(),r.delete(),t.delete(),f=!0}if(this._layerBlur>0){var a,o;let r=e.copy();d=xae.MaskFilter.MakeBlur(xae.BlurStyle.Normal,this._layerBlur*this.dpr*(null!==(a=null===(o=this.camera)||void 0===o?void 0:o.scale)&&void 0!==a?a:1),!1),r.setMaskFilter(d),t(r),r.delete(),d.delete(),f=!0}if(f||t(e),r&&this._hasInnerShadow()){var l,c,u,h;let e,t=new xae.Paint;t.setAntiAlias(!0),t.setStyle(xae.PaintStyle.Fill),t.setColor(Oae(this._innerShadowColor)),this._innerShadowBlur>0&&(e=xae.MaskFilter.MakeBlur(xae.BlurStyle.Normal,this._innerShadowBlur*this.dpr*(null!==(l=null===(c=this.camera)||void 0===c?void 0:c.scale)&&void 0!==l?l:1),!1),t.setMaskFilter(e));let r=this._currentPath.computeTightBounds(),[n,i,s,a]=r,o=s-n,d=a-i;this.ctx.save(),this.ctx.clipPath(this._currentPath,xae.ClipOp.Intersect,!0),this.ctx.saveLayer(t,r,null,xae.SaveLayerInitWithPrevious),null!==(u=this.ctx)&&void 0!==u&&u.translate(this._innerShadowOffsetX,this._innerShadowOffsetY),this.ctx.drawRect(xae.XYWHRect(-1e3-this._innerShadowOffsetX,-1e3-this._innerShadowOffsetY,2e3+o+Math.abs(2*this._innerShadowOffsetX),2e3+d+Math.abs(2*this._innerShadowOffsetY)),t),t.setBlendMode(xae.BlendMode.Clear),this.ctx.drawPath(this._currentPath,t),this.ctx.restore(),this.ctx.restore(),t.delete(),null===(h=e)||void 0===h||h.delete()}}}_paintInner(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.ctx&&this._currentPath&&e){let r=this.ctx,n=this._currentPath;this._applyEffectsToPaint(e,(e=>{let i=!1;!t&&"center"!==this._strokeMode&&(r.save(),r.clipPath(n,"outside"===this._strokeMode?xae.ClipOp.Difference:xae.ClipOp.Intersect,!0),i=!0),r.drawPath(n,e),i&&r.restore()}),t)}}_hasDropShadow(){var e;return(null===(e=this._dropShadowColor)||void 0===e?void 0:e.a)>0}_hasInnerShadow(){var e;return(null===(e=this._innerShadowColor)||void 0===e?void 0:e.a)>0}path(e){var t;null===(t=this._currentPath)||void 0===t||t.addPath(xae.Path.MakeFromSVGString(e))}ellipse(e,t,r,n,i,s,a,o){var l;if(!Iae([e,t,r,n])||!this._currentPath)return;if(r<0||n<0)throw Error("radii cannot be negative");let c=xae.XYWHRect(e-r,t-n,2*r,2*n);null===(l=this._currentPath)||void 0===l||l.addOval(c)}rect(e,t,r,n){var i;let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=xae.XYWHRect(e,t,r,n);if(Iae(c))if(0===s&&0===a&&0===l&&0===o)null===(i=this._currentPath)||void 0===i||i.addRect(c);else{var u;let e=xae.RRectXY(c,s,s);e[4]=e[5]=s,e[6]=e[7]=a,e[8]=e[9]=o,e[10]=e[11]=l,null===(u=this._currentPath)||void 0===u||u.addRRect(e)}}getHorizontalAlign(e){switch(e){case 2:return xae.TextAlign.Right;case 3:return xae.TextAlign.Center;case 4:return xae.TextAlign.Justify;default:return xae.TextAlign.Left}}drawTextInner(e,t,r,n,i,s){let[a,o,l,c]=n,u=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],h=0,{ctx:d}=this;if(!d)return h;let f=s.copy(),p=s.copy();return p.setAlphaf(0),this._applyEffectsToPaint(f,(n=>{t.pushPaintStyle(r,n,p),t.addText(e);let s=t.build();s.layout(l);let u=o;2===i?u+=(c-s.getHeight())/2:3===i&&(u+=c-s.getHeight()),d.drawParagraph(s,a,u),h=s.getHeight(),t.reset(),s.delete()}),u),f.delete(),p.delete(),h}drawText(e,t){let r=0,n=this._fonts.get(t.font),{ctx:i,_paintFill:s,_paintStroke:a}=this;if(n&&i){let i=new xae.TextStyle({fontFamilies:[t.font],fontSize:t.fontSize,heightMultiplier:t.lineHeight,letterSpacing:t.letterSpacing}),o=new xae.ParagraphStyle({textStyle:i,textAlign:this.getHorizontalAlign(t.horizontalAlign)}),l=xae.XYWHRect(t.x,t.y,t.width,t.height),c=xae.ParagraphBuilder.Make(o,n);s&&(r=this.drawTextInner(e,c,i,l,t.verticalAlign,s,!0)),a&&(r=this.drawTextInner(e,c,i,l,t.verticalAlign,a,!1)),c.delete()}return{height:r}}render(){var e;null===(e=this._surface)||void 0===e||e.flush()}moveTo(e,t){var r;null===(r=this._currentPath)||void 0===r||r.moveTo(e,t)}lineTo(e,t){var r;null===(r=this._currentPath)||void 0===r||r.lineTo(e,t)}bezierCurveTo(e,t,r,n,i,s){var a;null===(a=this._currentPath)||void 0===a||a.cubicTo(e,t,r,n,i,s)}quadraticCurveTo(e,t,r,n){var i;null===(i=this._currentPath)||void 0===i||i.quadTo(e,t,r,n)}setTransform(e){var t,r,n,i;let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.ctx)return;let a=this.ctx.getTotalMatrix(),o=sae.invert(a);if(o&&this.ctx.concat(o),null!==(t=this.ctx)&&void 0!==t&&t.scale(this.dpr,this.dpr),null!==(r=this.camera)&&void 0!==r&&r.enabled&&(null!==(n=this.ctx)&&void 0!==n&&n.concat(this.camera.worldMatrix),s)){var l;let e=sae.getScale(this.camera.worldMatrix);null===(l=this.ctx)||void 0===l||l.scale(1/e[0],1/e[1])}null!==(i=this.ctx)&&void 0!==i&&i.concat(e),this.currentTransform=e}transform(e){var t;null===(t=this.ctx)||void 0===t||t.concat(e)}setSize(e,t){var r;!this._isSizeDirty&&e===this._width&&t===this._height||(this._isSizeDirty=!1,this._width=e,this._height=t,this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.canvas.width=e*this.dpr,this.canvas.height=t*this.dpr,this._surface&&(this._surface=xae.MakeWebGLCanvasSurface(this.canvas),this.ctx=null===(r=this._surface)||void 0===r?void 0:r.getCanvas()))}};function Iae(e){for(let t=0;t<e.length;t++)if(void 0!==e[t]&&!Number.isFinite(e[t]))return!1;return!0}function Oae(e){let{r:t,g:r,b:n,a:i}=e;return xae.Color4f(t,r,n,i)}var Rae,Lae,Nae,Bae=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=W0.transparent,this.blurRadius=0,this.offset=[0,0],this.spread=0,this.update(t)}update(e){void 0!==e.color&&(this.color=e.color),void 0!==e.enabled&&(this.enabled=e.enabled),void 0!==e.blurRadius&&(this.blurRadius=e.blurRadius),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.spread&&(this.spread=e.spread)}},zae=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.radius=0,this.update(t)}update(e){void 0!==e.enabled&&(this.enabled=e.enabled),void 0!==e.radius&&(this.radius=e.radius)}},Fae=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=W0.transparent,this.update(t)}update(e){void 0!==e.enabled&&(this.enabled=e.enabled),void 0!==e.color&&(this.color=e.color)}},jae=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=W0.transparent,this.thickness=0,this.mode="inside",this.update(t)}update(e){void 0!==e.enabled&&(this.enabled=e.enabled),void 0!==e.color&&(this.color=e.color),void 0!==e.thickness&&(this.thickness=e.thickness),void 0!==e.mode&&(this.mode=e.mode)}},Uae=class extends mae{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.autoClose=!0,this.fill=new Fae(e+"-fill",t.fill,r),this.stroke=new jae(e+"-stroke",t.stroke,r),this.dropShadow=new Bae(e+"-dropShadow",t.dropShadow,r),this.innerShadow=new Bae(e+"-innerShadow",t.innerShadow,r),this.backgroundBlur=new zae(e+"-backgroundBlur",t.backgroundBlur,r),this.layerBlur=new zae(e+"-layerBlur",t.layerBlur,r)}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:W0.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:W0.transparent,e.strokeMode=this.stroke.mode,e.lineWidth=this.stroke.thickness}applyFilters(e){this.layerBlur.enabled?e.layerBlur=5*this.layerBlur.radius:e.layerBlur=0,this.backgroundBlur.enabled?e.backgroundBlur=5*this.backgroundBlur.radius:e.backgroundBlur=0,this.dropShadow.enabled?(e.dropShadowBlur=5*this.dropShadow.blurRadius,e.dropShadowColor=this.dropShadow.color,e.dropShadowOffsetX=this.dropShadow.offset[0],e.dropShadowOffsetY=this.dropShadow.offset[1]):e.dropShadowColor=W0.transparent,this.innerShadow.enabled?(e.innerShadowSpread=this.innerShadow.spread,e.innerShadowBlur=5*this.innerShadow.blurRadius,e.innerShadowColor=this.innerShadow.color,e.innerShadowOffsetX=this.innerShadow.offset[0],e.innerShadowOffsetY=this.innerShadow.offset[1]):e.innerShadowColor=W0.transparent}innerDraw(e){}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.applyFilters(e),this.applyFillStroke(e),e.beginPath(),this.innerDraw(e),this.autoClose&&e.closePath(),this.fill.enabled&&e.fill(),this.stroke.enabled&&e.stroke(),e.restore())}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),0===e.type&&(NJ(e.path,["fill"])?this.fill.update(e.props):NJ(e.path,["stroke"])?this.stroke.update(e.props):NJ(e.path,["dropShadow"])?this.dropShadow.update(e.props):NJ(e.path,["innerShadow"])?this.innerShadow.update(e.props):NJ(e.path,["layerBlur"])?this.layerBlur.update(e.props):NJ(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}updateState(e,t){super.updateState(e,t),void 0!==e.fill&&this.fill.update(e.fill),void 0!==e.stroke&&this.stroke.update(e.stroke),void 0!==e.dropShadow&&this.dropShadow.update(e.dropShadow),void 0!==e.innerShadow&&this.innerShadow.update(e.innerShadow),void 0!==e.layerBlur&&this.layerBlur.update(e.layerBlur),void 0!==e.backgroundBlur&&this.backgroundBlur.update(e.backgroundBlur)}clone(e){let t=new Uae(this.uuid,this.data,e);return t.parent=void 0,t}},Vae=class extends Uae{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.width=0,this.height=0,this.updateState(t,r)}innerDraw(e){e.ellipse(.5*this.width,.5*this.height,.5*this.width,.5*this.height,0,0,2*Math.PI)}intersectsInLocalSpace(e,t){return function(e,t,r,n,i,s){let a=e-r,o=t-n;return a*a/(i*i)+o*o/(s*s)<=1}(e,t,.5*this.width,.5*this.height,.5*this.width,.5*this.height)}getCenter(){return[.5*this.width,.5*this.height]}getHalfSize(){return[.5*this.width,.5*this.height]}updateSizeState(e){let t=!1;void 0!==e.width&&(this.width="number"==typeof e.width?e.width:this.width,t=!0),void 0!==e.height&&(this.height="number"==typeof e.height?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e)}clone(e){let t=new Vae(this.uuid,this.data,e);return t.parent=void 0,t}},Hae=class extends Uae{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.width=0,this.height=0,this.cornerRadius=[0,0,0,0],this.updateState(t,r)}innerDraw(e){e.rect(0,0,this.width,this.height,...this.cornerRadius)}getCenter(){return[.5*this.width,.5*this.height]}getHalfSize(){return[.5*this.width,.5*this.height]}updateCornerState(e){void 0!==e.cornerRadius&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;void 0!==e.width&&(this.width="number"==typeof e.width?e.width:this.width,t=!0),void 0!==e.height&&(this.height="number"==typeof e.height?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e)}clone(e){let t=new Hae(this.uuid,this.data,e);return t.parent=void 0,t}},Wae=class extends Uae{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this._textHeight=0,this._textHeightDirty=!0,this.width=0,this.height=0,this.updateState(t,r)}get textHeight(){return this._textHeight}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:W0.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:W0.transparent,e.strokeMode="center",e.lineWidth=this.stroke.thickness}innerDraw(e){var t,r,n;(null===(t=this._fontHolder)||void 0===t?void 0:t.arrayBuffer)&&this._fontHolder.arrayBuffer.byteLength>1&&this.data.font&&e.registerFont(this._fontHolder.arrayBuffer,this.data.font);let i=this.data.textTransform,s=this.data.text.textValue.toString(),a=2===i?s.toUpperCase():3===i?s.toLowerCase():s,{height:o}=e.drawText(a,{x:0,y:0,width:this.width,height:this.height,fontSize:this.data.fontSize,lineHeight:null!==(r=this.data.lineHeight)&&void 0!==r?r:1,letterSpacing:null!==(n=this.data.letterSpacing)&&void 0!==n?n:0,horizontalAlign:this.data.horizontalAlign,verticalAlign:this.data.verticalAlign,font:this.data.font});this._textHeight=o}getCenter(){return[.5*this.width,.5*this.height]}getHalfSize(){return[.5*this.width,.5*this.height]}updateSizeState(e){let t=!1;void 0!==e.width&&(this.width="number"==typeof e.width?e.width:this.width,t=!0),void 0!==e.height&&(this.height="number"==typeof e.height?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateFontState(e,t){let{shared:r}=t;void 0!==e.font&&(this._fontHolder=r.getFont(e.font),this._fontHolder&&!this._fontHolder.isLoaded&&this._fontHolder.loadingPromise.then((()=>{this.requestRender()})))}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateFontState(e,t)}clone(e){let t=new Wae(this.uuid,this.data,e);return t.parent=void 0,t}},Gae=class extends Uae{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.curves=[],this.extremasBBox={min:[0,0],max:[0,0]},this.updateState(t,r)}computeExtremas(){0===this.curves.length&&this.computeCurves();let e=this.curves.map((e=>Rae.extremas(e))),t=[1/0,1/0],r=[-1/0,-1/0];for(let n=0,i=e.length;n<i;n++){let i=e[n];i[0][0]<t[0]&&(t[0]=i[0][0]),i[0][1]<t[1]&&(t[1]=i[0][1]),i[1][0]>r[0]&&(r[0]=i[1][0]),i[1][1]>r[1]&&(r[1]=i[1][1])}return this.extremasBBox.min=[t[0],t[1]],this.extremasBBox.max=[r[0],r[1]],this.extremasBBox}computeCurves(){this.curves=[];for(let r=1,n=this.data.points.length;r<n;r++){let e=this.data.points[r].data,t=this.data.points[r-1].data,n={start:t.position,cp1:t.controlNext.position,cp2:e.controlPrevious.position,end:e.position};this.curves.push(n)}let e=this.data.points[0].data,t=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let r={start:t.position,cp1:t.controlNext.position,cp2:e.controlPrevious.position,end:e.position};this.curves.push(r)}}getCenter(){let[e,t]=this.extremasBBox.min,[r,n]=this.getHalfSize();return[e+r,t+n]}getHalfSize(){let{min:e,max:t}=this.extremasBBox;return[.5*(t[0]-e[0]),.5*(t[1]-e[1])]}innerDraw(e){for(let n=0,i=this.data.points.length;n<i;n++){let t=this.data.points[n].data;if(0===n){let[r,n]=t.position;e.moveTo(r,n)}else{let r=this.data.points[n-1].data,[i,s]=r.controlNext.position,[a,o]=t.controlPrevious.position,[l,c]=t.position,u={start:r.position,cp1:r.controlNext.position,cp2:t.controlPrevious.position,end:t.position};Rae.derive(u),e.bezierCurveTo(i,s,a,o,l,c)}}let t=this.data.points[0].data,r=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let[n,i]=r.controlNext.position,[s,a]=t.controlPrevious.position,[o,l]=t.position;e.bezierCurveTo(n,i,s,a,o,l)}}updateState(e,t){super.updateState(e,t),this.computeExtremas()}clone(e){let t=new Gae(this.uuid,this.data,e);return t.parent=void 0,t}};(e=>{function t(e,t,r){let n=e-2*t+r;if(0!==n){let i=-Math.sqrt(Math.abs(t*t-e*r)),s=-e+t;return[-(i+s)/n,-(-i+s)/n]}return t!==r&&0===n?[(2*t-r)/(2*(t-r))]:[]}e.derive=function(e){let t=e.start,r=e.cp1,n=e.cp2,i=e.end,s={start:[3*(r[0]-t[0]),3*(r[1]-t[1])],cp:[3*(n[0]-r[0]),3*(n[1]-r[1])],end:[3*(i[0]-n[0]),3*(i[1]-n[1])]};return e.derivative=s,s.derivative=Lae.derive(s),s},e.droot=function(r){var n;let i=null!==(n=r.derivative)&&void 0!==n?n:e.derive(r),s=i.start,a=i.cp,o=i.end;return[t(s[0],a[0],o[0]),t(s[1],a[1],o[1])]},e.extremas=function(t){let[r,n]=e.droot(t),i=[t.start[0],t.end[0]],s=[t.start[1],t.end[1]];for(let a of r)i.push(e.compute(t,Math.min(1,Math.max(0,a)))[0]);for(let a of n)s.push(e.compute(t,Math.min(1,Math.max(0,a)))[1]);return i.sort(((e,t)=>e-t)),s.sort(((e,t)=>e-t)),[[i[0],s[0]],[i[i.length-1],s[s.length-1]]]},e.compute=function(e,t){if(0===t)return[...e.start];if(1===t)return[...e.end];let r=1-t,n=r*r,i=t*t,s=n*r,a=n*t*3,o=r*i*3,l=t*i;return[s*e.start[0]+a*e.cp1[0]+o*e.cp2[0]+l*e.end[0],s*e.start[1]+a*e.cp1[1]+o*e.cp2[1]+l*e.end[1]]}})(Rae||(Rae={})),(e=>{e.derive=function(e){let t=e.start,r=e.cp,n=e.end,i={start:[2*(r[0]-t[0]),2*(r[1]-t[1])],end:[2*(n[0]-r[0]),2*(n[1]-r[1])]};return i.derivative=Nae.derive(i),e.derivative=i,i},e.droot=function(t){var r;let n=null!==(r=t.derivative)&&void 0!==r?r:e.derive(t),i=n.start,s=n.end;return[i[0]!==s[0]?i[0]/(i[0]-s[0]):0,i[1]!==s[1]?i[1]/(i[1]-s[1]):0]},e.compute=function(e,t){if(0===t)return[...e.start];if(1===t)return[...e.end];let r=1-t,n=r*r,i=r*t*2,s=t*t;return[n*e.start[0]+i*e.cp[0]+s*e.end[0],n*e.start[1]+i*e.cp[1]+s*e.end[1]]}})(Lae||(Lae={})),(e=>{e.derive=function(e){let t=e.start,r=e.end,n=[r[0]-t[0],r[1]-t[1]];return e.derivative=n,e.derivative},e.compute=function(e,t){if(0===t)return[...e.start];if(1===t)return[...e.end];let r=e.start,n=e.end;return[r[0]+(n[0]-r[0])*t,r[1]+(n[1]-r[1])*t]}})(Nae||(Nae={}));var qae=class extends gae{constructor(e,t,r){super(e,t,r),this.uuid=e,this.width=0,this.height=0,this.clipped=!0,this.background=new Hae(e+"-background",$2.defaultData,r),this.background.parent=this,this.updateState(t,r)}get fill(){return this.background.fill}get stroke(){return this.background.stroke}get backgroundBlur(){return this.background.backgroundBlur}get layerBlur(){return this.background.layerBlur}get dropShadow(){return this.background.dropShadow}get innerShadow(){return this.background.innerShadow}get cornerRadius(){return this.background.cornerRadius}set cornerRadius(e){this.background.cornerRadius=e}updateLocalMatrix(){var e;super.updateLocalMatrix(),null===(e=this.background)||void 0===e||e.updateLocalMatrix()}updateWorldMatrix(e,t,r){var n;super.updateWorldMatrix(e,t,r),null===(n=this.background)||void 0===n||n.updateWorldMatrix(e,t,r)}draw(e){if(!this.visible)return;e.save();let t=this.width,r=this.height;this.applyTransforms(e),this.background.width=t,this.background.height=r,this.background.draw(e),this.clipped&&e.clipRect(0,0,t,r,...this.cornerRadius),this.innerDrawChildren(e),e.restore()}getCenter(){return[.5*this.width,.5*this.height]}getHalfSize(){return[.5*this.width,.5*this.height]}updateCornerState(e){void 0!==e.cornerRadius&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;void 0!==e.width&&(this.width="number"==typeof e.width?e.width:this.width,t=!0),void 0!==e.height&&(this.height="number"==typeof e.height?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e),void 0!==e.fill&&this.fill.update(e.fill),void 0!==e.stroke&&this.stroke.update(e.stroke),void 0!==e.dropShadow&&this.dropShadow.update(e.dropShadow),void 0!==e.innerShadow&&this.innerShadow.update(e.innerShadow),void 0!==e.layerBlur&&this.layerBlur.update(e.layerBlur),void 0!==e.backgroundBlur&&this.backgroundBlur.update(e.backgroundBlur),void 0!==e.clipped&&(this.clipped=e.clipped)}requestRender(){super.requestRender(),this.dispatchEvent({type:"render"})}dispose(){this.removeEventListener("render")}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),0===e.type&&(NJ(e.path,["fill"])?this.fill.update(e.props):NJ(e.path,["stroke"])?this.stroke.update(e.props):NJ(e.path,["dropShadow"])?this.dropShadow.update(e.props):NJ(e.path,["innerShadow"])?this.innerShadow.update(e.props):NJ(e.path,["layerBlur"])?this.layerBlur.update(e.props):NJ(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}clone(e){let t=new qae(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}},Xae=yL(EL(),1),Yae=class extends Uae{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this._pathBBox=new DOMRect,this.path="",this.updateState(t,r),this.autoClose=!1,this.computeSVGBBox()}computeSVGBBox(){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),t=document.createElementNS("http://www.w3.org/2000/svg","path");document.body.appendChild(e),t.setAttribute("d",this.path),e.appendChild(t),this._pathBBox=t.getBBox(),e.remove()}innerDraw(e){e.path(this.path)}intersectsInLocalSpace(e,t){return e>=this._pathBBox.x&&e<=this._pathBBox.x+this._pathBBox.width&&t>=this._pathBBox.y&&t<=this._pathBBox.y+this._pathBBox.height}getCenter(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}getHalfSize(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}updateState(e,t){super.updateState(e,t),void 0!==e.path&&(this.path=e.path,this.computeSVGBBox())}clone(e){let t=new Yae(this.uuid,this.data,e);return t.parent=void 0,t}};var Kae=class{constructor(e,t,r){this.uuid=e,this.data=t,this.group=new vae(Kae.GROUP_ID,u({},n3.defaultData),r),this.createChildrenObjects(t.objects,this.group,r)}createObject(e,t,r,n,i,s){let a=function(e,t,r){switch(t.type){case"ellipse2d":return new Vae(e,t,r);case"rectangle2d":return new Hae(e,t,r);case"text2d":return new Wae(e,t,r);case"vector2d":return new Gae(e,t,r);case"path2d":return new Yae(e,t,r);case"frame2d":return new qae(e,t,r);default:return new vae(e,t,r)}}(e,t,s);a&&(n.add(a),n.children.splice(i,0,n.children.pop()),a.updateWorldMatrix(),r.length>0&&(a instanceof vae||a instanceof qae)&&this.createChildrenObjects(r,a,s))}createChildrenObjects(e,t,r){let n=0;for(let i of e)this.createObject(i.id,i.data,i.children,t,n,r),n+=1}draw(e){this.group.draw(e)}updateEntityByOp(e,t,r,n){let i=this.find(e);if(i)try{i.updateByOp(t,r,{shared:n})}catch(T0){console.error(T0)}}updateTreeByOp(e,t){if(0===e.path.length&&7===e.type){let r=null===e.parent?this.group:this.find(e.parent);void 0!==r&&r instanceof gae&&(this.createObject(e.id,e.data,e.children,r,e.localIndex,t),r.requestRender())}else if(0===e.path.length&&8===e.type){let t=this.find(e.id);if(void 0!==t&&void 0!==t.parent&&t.parent instanceof gae){let e=t.parent;t.resetBBoxNeedsUpdate(),null!==e&&void 0!==e&&e.remove(t),null===e||void 0===e||e.requestRender()}}else if(0===e.path.length&&9===e.type){let t=this.find(e.id);if(void 0!==t){let r=t.parent,n=null===e.parent?this:this.find(e.parent);if(n instanceof gae||n===this){n.add(t);let i=e.localIndex;n.children.splice(i,0,n.children.pop()),t.updateWorldMatrix(!0,!1,!0),null!==r&&void 0!==r&&r.requestRender(),t.requestRender()}t.resetBBoxNeedsUpdate()}}}add(e){this.group.add(e)}remove(e){this.group.remove(e)}traverse(e){this.group.traverse((t=>{t!==this.group&&e(t)}))}intersectsChildren(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return this.group.intersectsChildren(e,t,r,n,i,!0)}intersectsChildrenReverse(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return this.group.intersectsChildrenReverse(e,t,r,n,i,!0)}find(e){return this.group.find(e)}get children(){return this.group.children}project(e,t){return this.group.project(e,t)}getWithSortKey(e){let t=this.find(e);if(void 0===t)return;let r=[],n=t;for(;n!==this.group;){let e=n;n=n.parent;let t=n.children.indexOf(e);r.splice(0,0,t)}return{entity:t,sortKey:r}}getAllSorted(e){let t=[];for(let r of e){let e=this.getWithSortKey(r.id);void 0!==e&&t.push(e)}return t.sort(((e,t)=>MZ(e.sortKey,t.sortKey))),t.map((e=>e.entity))}},Qae=Kae;function Zae(e){let{constraints:t,newParentWidth:r,newParentHeight:n,initialParentWidth:i,initialParentHeight:s,objectInitialWidth:a,objectInitialHeight:o,objectInitialPosition:l}=e,{horizontalConstraint:c,verticalConstraint:u}=t,h=r-i,d=n-s,f=a,p=o,m=l[0],g=l[1];if(0!==c)if(1===c)m+=h;else if(3===c)m+=h/2;else if(2===c)f=Math.max(1,f+h);else if(4===c){let e=r/i;f*=e,m*=e}if(0!==u)if(1===u)g+=d;else if(3===u)g+=d/2;else if(2===u)p=Math.max(1,p+d);else if(4===u){let e=n/s;p*=e,g*=e}return{width:f,height:p,position:[m,g]}}Qae.GROUP_ID="scene2d";yL(EL(),1);var Jae=new JF(-1,1,1,-1,0,1),$ae=new class extends iF{constructor(){super(),this.setAttribute("position",new Qz([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Qz([0,2,0,0,2,0],2))}},eoe=new EF({defines:{},uniforms:{tDiffuse:new sG(null)},vertexShader:"\n\tvarying vec2 vUv;\n\tvoid main() {\n\t\tvUv = uv;\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t}",fragmentShader:"\n\tuniform sampler2D tDiffuse;\n\tvarying vec2 vUv;\n\tvoid main() {\n\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\tgl_FragColor = texel;\n\t}"}),toe=new class{constructor(e){this._mesh=new yF($ae,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,Jae)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}(eoe),roe=null,noe=null,ioe=sae.identity(),soe=class{constructor(e,t,r,n){this.uuid=e,this.width=t,this.height=r,this.context=n,this.enabled=!0,this.isScreenSpace=!1,this.dpr=window.devicePixelRatio,this.isFrameDirty=!1,this.onRenderRequestedDownstream=()=>{this.isFrameDirty=!0,this.context.shared.requestRender()},this._innerApplySize=()=>{let e=this.width,t=this.height,r=this.dpr;this.renderer.dpr=this.isScreenSpace?r:Math.floor(2048/Math.max(e,t)),this.renderer.setSize(e,t)},this.onFrameOverrideObjectEvent=e=>{var t;if(void 0!==(null===(t=e.target)||void 0===t?void 0:t.uuid)){var r;let t=null===(r=this.frameRoot)||void 0===r?void 0:r.find(e.target.uuid);t&&t.dispatchEvent(u(u({},e),{},{target:t}))}},this.scene2d=new Qae($N.generateUUID(),a3.defaultData,{dpr:window.devicePixelRatio,shared:n.shared}),this.canvas=(null===roe&&(roe=document.createElement("canvas")),roe),this.renderer=(e=>(null===noe&&(noe=new Dae(e)),noe))(this.canvas),this.promise=this.init(),this.renderTarget=new EB(1,1,{type:uN,stencilBuffer:!1,depthBuffer:!1}),n.shared.addUIBuffer(this.uuid,this.renderTarget),this.textureHolder=n.shared.uiBuffer(this.uuid)}get canvasTexture(){return this._canvasTexture||(this._canvasTexture=new GV(this.canvas)),this._canvasTexture}async init(){this.renderer instanceof Dae&&(this.renderer.wasmURL=wee.skiaWasmUrl),await this.renderer.init()}render(e){if(this.isFrameDirty){var t,r;this.isFrameDirty=!1,this._innerApplySize(),this.renderer.clear(),null!==(t=this.frameOverride)&&void 0!==t&&t.draw(this.renderer),this.renderer.render(),eoe.uniforms.tDiffuse.value=this.canvasTexture,this.canvasTexture.needsUpdate=!0;let n=e.getRenderTarget();e.setRenderTarget(this.renderTarget),e.clear(),toe.render(e),e.setRenderTarget(n),null===(r=this.textureHolder)||void 0===r||r.setNeedsUpdate(!0)}}updateEntity2DByOp(e,t,r,n){this.scene2d.updateEntityByOp(e,t,r,n),this.applySize()}updateTreeByOp(e,t){this.scene2d.updateTreeByOp(e,t),this.applySize()}applyOverrides(e){if(this.frameOverride&&this.frameRoot){var t,r;this.frameOverride.position=[0,0],this.frameOverride.rotation=0;let n=null!==(t=null===e||void 0===e?void 0:e.width)&&void 0!==t?t:this.width,i=null!==(r=null===e||void 0===e?void 0:e.height)&&void 0!==r?r:this.height;this.frameOverride.width=n,this.frameOverride.height=i,this.frameOverride.localMatrix=ioe,this.isScreenSpace&&(this.frameOverride.fill.color=W0.from0to1([0,0,0,0])),this.frameOverride.data=u(u({},this.frameOverride.data),{},{width:n,height:i}),aoe({objectOverride:this.frameOverride,objectRoot:this.frameRoot,newParentWidth:this.frameOverride.width,newParentHeight:this.frameOverride.height,initialParentWidth:this.frameRoot.width,initialParentHeight:this.frameRoot.height}),this.frameOverride.updateWorldMatrix(!0,!1,!0)}}applySize(e){var t,r,n,i;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.devicePixelRatio,a=Math.max(1,null!==(t=null===e||void 0===e?void 0:e.width)&&void 0!==t?t:this.width),o=Math.max(1,null!==(r=null===e||void 0===e?void 0:e.height)&&void 0!==r?r:this.height);this.dpr=s,this.width=a,this.height=o,this._innerApplySize();let l=1;(a*s<512||o*s<512)&&(l=Math.max(512/(a*s),512/(o*s))),this.renderTarget.setSize(a*s*l,o*s*l),null!==(n=this._canvasTexture)&&void 0!==n&&n.dispose(),this._canvasTexture=void 0,this.applyOverrides(e),null===(i=this.frameOverride)||void 0===i||i.requestRender()}applyFrame(e){var t,r;let n=this.context.scene.find2D(e);if(n&&n instanceof qae)return this.disposeFrameOverride(),this.frameRoot=n,this.frameOverride=n.clone({dpr:this.renderer.dpr,shared:this.context.shared}),this.scene2d.add(this.frameOverride),this.applySize(),null!==(t=this.frame)&&void 0!==t&&t.addEventListener("render",this.onRenderRequestedDownstream),this.frameOverride.traverse((e=>{e.addEventListener("beginState",this.onFrameOverrideObjectEvent)})),this.frameOverride.traverse((e=>{e.addEventListener("completeState",this.onFrameOverrideObjectEvent)})),null!==(r=this.frame)&&void 0!==r&&r.requestRender(),n}get frame(){return this.frameOverride}get frameId(){var e;return null===(e=this.frame)||void 0===e?void 0:e.uuid}find(e){return this.scene2d.find(e)}get texture(){var e;return null===(e=this.textureHolder)||void 0===e?void 0:e.getTexture(1001)}disposeFrameOverride(){var e,t,r;null!==(e=this.frameOverride)&&void 0!==e&&e.removeEventListener("render",this.onRenderRequestedDownstream),null!==(t=this.frameOverride)&&void 0!==t&&t.traverse((e=>{e.removeEventListener("beginStateChange",this.onFrameOverrideObjectEvent)})),null!==(r=this.frameOverride)&&void 0!==r&&r.traverse((e=>{e.removeEventListener("completeState",this.onFrameOverrideObjectEvent)})),this.frameOverride&&this.scene2d.remove(this.frameOverride)}};function aoe(e){let{objectOverride:t,objectRoot:r,newParentWidth:n,newParentHeight:i,initialParentWidth:s,initialParentHeight:a}=e;if(t instanceof qae&&r instanceof qae||t instanceof vae&&r instanceof vae)for(let o=0,l=t.children.length;o<l;o++){let e=t.children[o],l=r.children[o];e&&l&&e.uuid===l.uuid&&ooe({objectOverride:e,objectRoot:l,newParentWidth:n,newParentHeight:i,initialParentWidth:s,initialParentHeight:a})}}function ooe(e){let{objectOverride:t,objectRoot:r,newParentWidth:n,newParentHeight:i,initialParentWidth:s,initialParentHeight:a}=e,[o,l]=function(e){if(coe(e))return[e.width,e.height];if(e instanceof Yae){let[t,r]=e.getHalfSize();return[2*t,2*r]}if(e instanceof vae){let[t,r]=e.recursiveBBox.getHalfSize();return[2*t,2*r]}return[0,0]}(r),{width:c,height:h,position:d}=Zae({constraints:t.data,newParentWidth:n,newParentHeight:i,initialParentWidth:s,initialParentHeight:a,objectInitialWidth:o,objectInitialHeight:l,objectInitialPosition:r.position});if(t.position=d,t.data=u(u({},t.data),{},{position:d}),t.states)for(let u in t.states)loe({stateId:u,objectOverride:t,objectRoot:r,newParentWidth:n,newParentHeight:i,initialParentWidth:s,initialParentHeight:a});if(coe(t)||t instanceof vae)coe(t)&&(t.width=c,t.height=h,t.data=u(u({},t.data),{},{width:c,height:h})),aoe({objectOverride:t,objectRoot:r,newParentWidth:c,newParentHeight:h,initialParentWidth:o,initialParentHeight:l});else if(t instanceof Yae){let e=r,n=0!==o?c/o:1,i=0!==l?h/l:1;t.path=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(t<=0||r<=0)return e;let n=(0,Xae.parseSVG)(e).map((e=>{let n=u({},e);return"x"in n&&(n.x=n.x*t),"y"in n&&(n.y=n.y*r),"x1"in n&&(n.x1=n.x1*t),"x2"in n&&(n.x2=n.x2*t),"y1"in n&&(n.y1=n.y1*r),"y2"in n&&(n.y2=n.y2*r),"rx"in n&&(n.rx=n.rx*t),"ry"in n&&(n.ry=n.ry*r),n}));return function(e){let t,r=["rx","ry","xAxisRotation","largeArc","sweep","x1","y1","x2","y2","x","y"];return e.map((e=>{let n=[];r.forEach((t=>{if(t in e){let r=1*e[t];n.length&&r>=0&&n.push(","),n.push(r)}}));let i=(t===e.code?n[0]<0?"":",":e.code)+n.join("");return t=e.code,i})).join("")}(n)}(e.path,n,i),t.data=u(u({},t.data),{},{path:t.path})}}function loe(e){var t,r;let{stateId:n,objectOverride:i,objectRoot:s,newParentWidth:a,newParentHeight:o,initialParentWidth:l,initialParentHeight:c}=e,u=null===(t=i.states)||void 0===t?void 0:t[n],h=null===(r=s.states)||void 0===r?void 0:r[n];if(u&&h){let{width:e,height:t,position:r}=Zae({constraints:i.data,newParentWidth:a,newParentHeight:o,initialParentWidth:l,initialParentHeight:c,objectInitialWidth:s3.isResizeable(h)?h.width:0,objectInitialHeight:s3.isResizeable(h)?h.height:0,objectInitialPosition:h.position});Object.assign(i.states[n],{position:r}),s3.isResizeable(u)&&Object.assign(i.states[n],{width:e,height:t})}}function coe(e){return e instanceof Hae||e instanceof qae||e instanceof Vae||e instanceof Wae}var uoe=class extends(f5(yV)){constructor(e,t,r){super(),this.data=t,this.bgColor=new X9(1,1,1,1),this.fog=null,this.backupFog=new vV(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new vB,this.penumbraSizeArrayCache=null,this.super_Entity(e,t),this.personalCamera=new Fne(t1,u(u(u({},J1.defaultData),t.camera),{},{name:"Personal Camera"})),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new AW(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight),t.uiScene?this.uiScene=new Qae((Array.isArray(e)?e[0]:e)+"-ui",t.uiScene,{dpr:window.devicePixelRatio,shared:r.shared}):t.uiFrame&&this.createUICanvas(t.uiFrame,r)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}get frameId(){return this.data.uiFrame}get frame(){var e;return null===(e=this.uiCanvas)||void 0===e?void 0:e.frame}createUICanvas(e,t){this.uiCanvas=new soe(this.uuid+"-uiscreen",window.innerWidth,window.innerHeight,t),this.uiCanvas.isScreenSpace=!0,this.uiCanvas.promise.then((()=>{var t,r;null!==(t=this.uiCanvas)&&void 0!==t&&t.applyFrame(e),null===(r=this.uiCanvas)||void 0===r||r.applySize()}))}updateVisible(){}setBackgroundColor(e){this.bgColor=e,!0===this.fogUseBGColor&&(this.backupFog.color=e)}entityChildrenCount(){return this.uiScene?this.uiScene.children.length:super.entityChildrenCount()}updateAmbientLight(e,t){void 0!==e.color&&(this.ambientLight.color=rte(e.color,t)),void 0!==e.intensity&&(this.ambientLight.intensity=e.intensity),void 0!==e.enabled&&(e.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(e){this.isActive=!0,e.fog=this.fog,this.traverseEntity((e=>{e instanceof Wne&&e.recomputeBoolean()})),this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity((e=>{if(e instanceof Ere)if(Array.isArray(e.material))for(let t of e.material)t.needsUpdate=!0;else e.material.needsUpdate=!0,e.material.dispose()}))}updateShadow(e){void 0!==e.softShadowQuality&&this.isActive&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"medium";if(Gse===e)return!1;Gse=e;let t=(e=>{switch(e){case"low":return 8;case"medium":default:return 16;case"high":return 32}})(e);VF.shadowmap_pars_fragment=(e=>"\n\n// PCSS implementation based on:\n// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/\n// NOTE: This number affects how big the shadow blur can\n// possibly get. Bigger number == bigger blur, but less precise results\n\nconst float  gPenumbraFilterSize = 80.0;\nconst int   gPenumbraSamples = ".concat(e,";\nconst int gShadowSamples = ").concat(e,";\nconst float gShadowSamplesRpc = 1.0f / float(gShadowSamples);\n\n#ifdef USE_SHADOWMAP\n    #if NUM_DIR_LIGHT_SHADOWS > 0\n\n        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n        struct DirectionalLightShadow {\n            float shadowBias;\n            float shadowNormalBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n        };\n\n        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\n    #endif\n\n    #if NUM_SPOT_LIGHT_SHADOWS > 0\n\n        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n        struct SpotLightShadow {\n            float shadowBias;\n            float shadowNormalBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n        };\n\n        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\n    #endif\n\n    #if NUM_POINT_LIGHT_SHADOWS > 0\n\n        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n        struct PointLightShadow {\n            float shadowBias;\n            float shadowNormalBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n            float shadowCameraNear;\n            float shadowCameraFar;\n        };\n\n        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\n    #endif\n\n    /*\n    #if NUM_RECT_AREA_LIGHTS > 0\n\n        // TODO (abelnation): create uniforms for area light shadows\n\n    #endif\n    */\n\nfloat computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)\n{\n    float penumbra = 1.0;\n    float blockerDepthAvg = 0.0;\n    float blockerCount = 0.0;\n\n    #pragma unroll_loop_start\n    for(int i = 0; i < gPenumbraSamples; i ++)\n    {\n        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;\n        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );\n\n        if(depth < compare + 0.0001)\n        {\n            blockerDepthAvg += depth;\n            blockerCount++;\n        }\n    }\n    #pragma unroll_loop_end\n\n    if (blockerCount > 0.0)\n    {\n        blockerDepthAvg /= blockerCount;\n\n        // Compute penumbra\n        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);\n        penumbra *= penumbra;\n        penumbra *= 200.0 * penumbraSize[min(index, ",5," - 1)]; // Magic number that affects how quickly the penumbra grows\n\n        return clamp(penumbra, 0.00, 1.0);\n    }\n    return 0.0;\n}\n\nfloat vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)\n{\n    float shadow         = 0.0f;\n\n    // NOTE: When using TAA, we should use screen space interleaved gradient noise\n    vec2 halton = haltonSequence[frameIndex];\n    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n    float temporalAngle  = temporalOffset * PI2;\n\n    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);\n    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);\n    if (penumbra == -1.0) {\n        return 1.0;\n    }\n\n    #pragma unroll_loop_start\n    for (int i = 0; i < gShadowSamples; i++)\n    {\n        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;\n        // Overall blurring offset\n        vec2 offset = vogelSample * (shadowRadius * 2.);\n\n        // Penumbra offset\n        offset += vogelSample * (penumbra * texelScalar);\n\n        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );\n    }\n    #pragma unroll_loop_end\n\n    return shadow * gShadowSamplesRpc;\n}\n\n\n    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\n        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\n    }\n\n    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\n        return unpackRGBATo2Half( texture2D( shadow, uv ) );\n\n    }\n\n    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\n        float occlusion = 1.0;\n\n        vec2 distribution = texture2DDistribution( shadow, uv );\n\n        float hard_shadow = step( compare , distribution.x ); // Hard Shadow\n\n        if (hard_shadow != 1.0 ) {\n\n            float distance = compare - distribution.x ;\n            float variance = max( 0.00000, distribution.y * distribution.y );\n            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality\n            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed\n            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\n        }\n        return occlusion;\n\n    }\n\n    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\n        float shadow = 1.0;\n\n        shadowCoord.xyz /= shadowCoord.w;\n        shadowCoord.z += shadowBias;\n\n        // if ( something && something ) breaks ATI OpenGL shader compiler\n        // if ( all( something, something ) ) using this instead\n\n        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n        bool inFrustum = all( inFrustumVec );\n\n        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n        bool frustumTest = all( frustumTestVec );\n\n        if ( frustumTest ) {\n\n        #if defined( SHADOWMAP_TYPE_PCF )\n\n            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );\n\n        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n            float dx = texelSize.x;\n            float dy = texelSize.y;\n\n            vec2 uv = shadowCoord.xy;\n            vec2 f = fract( uv * shadowMapSize + 0.5 );\n            uv -= f * texelSize;\n\n            shadow = (\n                texture2DCompare( shadowMap, uv, shadowCoord.z ) +\n                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n                     f.x ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n                     f.x ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n                     f.y ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n                     f.y ) +\n                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n                          f.x ),\n                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n                          f.x ),\n                     f.y )\n            ) * ( 1.0 / 9.0 );\n\n        #elif defined( SHADOWMAP_TYPE_VSM )\n\n            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n        #else // no percentage-closer filtering:\n\n            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n        #endif\n\n        }\n\n        return shadow;\n\n    }\n\n    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D\n    // vector suitable for 2D texture mapping. This code uses the following layout for the\n    // 2D texture:\n    //\n    // xzXZ\n    //  y Y\n    //\n    // Y - Positive y direction\n    // y - Negative y direction\n    // X - Positive x direction\n    // x - Negative x direction\n    // Z - Positive z direction\n    // z - Negative z direction\n    //\n    // Source and test bed:\n    // https://gist.github.com/tschw/da10c43c467ce8afd0c4\n\n    vec2 cubeToUV( vec3 v, float texelSizeY ) {\n\n        // Number of texels to avoid at the edge of each square\n\n        vec3 absV = abs( v );\n\n        // Intersect unit cube\n\n        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n        absV *= scaleToCube;\n\n        // Apply scale to avoid seams\n\n        // two texels less per square (one texel will do for NEAREST)\n        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\n        // Unwrap\n\n        // space: -1 ... 1 range for each square\n        //\n        // #X##         dim    := ( 4 , 2 )\n        //  # #         center := ( 1 , 1 )\n\n        vec2 planar = v.xy;\n\n        float almostATexel = 1.5 * texelSizeY;\n        float almostOne = 1.0 - almostATexel;\n\n        if ( absV.z >= almostOne ) {\n\n            if ( v.z > 0.0 )\n                planar.x = 4.0 - v.x;\n\n        } else if ( absV.x >= almostOne ) {\n\n            float signX = sign( v.x );\n            planar.x = v.z * signX + 2.0 * signX;\n\n        } else if ( absV.y >= almostOne ) {\n\n            float signY = sign( v.y );\n            planar.x = v.x + 2.0 * signY + 2.0;\n            planar.y = v.z * signY - 2.0;\n\n        }\n\n        // Transform to UV space\n\n        // scale := 0.5 / dim\n        // translate := ( center + 0.5 ) / dim\n        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\n    }\n\n    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\n        float shadow = 1.0;\n        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\n        // for point lights, the uniform @vShadowCoord is re-purposed to hold\n        // the vector from the light to the world-space position of the fragment.\n        vec3 lightToPosition = shadowCoord.xyz;\n\n        // dp = normalized distance from light to fragment position\n        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?\n        compare += shadowBias;\n\n        // bd3D = base direction 3D\n        vec3 bd3D = normalize( lightToPosition );\n\n        vec2 halton = haltonSequence[frameIndex];\n        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n        float temporalAngle  = temporalOffset * PI2;\n\n        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )\n            for (int i = 0; i < gShadowSamples; i++) {\n                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;\n\n                // Overall blurring offset\n                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);\n\n                // NOTE: Removed for now\n                // Penumbra offset\n                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);\n\n                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );\n\n            }\n            return shadow * gShadowSamplesRpc;\n\n        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n            for (int i = 0; i < 16; i++) {\n                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;\n\n                // Overall blurring offset\n                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);\n\n                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );\n\n            }\n            return shadow * (1.0 / 16.0);\n        #else // no percentage-closer filtering\n\n            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );\n\n        #endif\n\n    }\n\n#endif\n"))(t);let r=Hse.slice();r=r.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + ".concat(3,", spotShadowMap[ i ]")),r=r.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),VF.lights_fragment_begin=r;let n=Wse.slice();return n=n.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),VF.shadowmask_pars_fragment=n,!0}(e.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(e,t){if(e.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){this.scene.fog=this.fog}this.fogUseBGColor=e.useBackgroundColor,e.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=rte(e.color,t),this.backupFog.near=e.near,this.backupFog.far=e.far}updateAo(e,t){void 0!==e.aoColor&&(this.aoColor=rte(e.aoColor,t))}updateByOp(e,t,r,n){let i=this.data.uiFrame;super.updateByOp(e,t,r,n);let s=t;NJ(e.path,["fog"])?this.updateFog(s.fog,r.shared):NJ(e.path,["ao"])?this.updateAo(s.ao,r.shared):NJ(e.path,["ambient"])?this.updateAmbientLight(s.ambient,r.shared):NJ(e.path,["shadow"])?this.updateShadow(s.shadow):0===e.type&&0===e.path.length&&(void 0!==e.props.uiFrame||i!==s.uiFrame)&&this.updateUIFrame(e.props.uiFrame,r)}updateUIFrame(e,t){e?(this.uiCanvas||this.createUICanvas(e,t),this.uiCanvas.enabled=!0,this.uiCanvas.applyFrame(e)):this.uiCanvas&&(this.uiCanvas.enabled=!1)}updateState(e,t){this.updateState_Entity(e,t),void 0!==e.backgroundColor&&this.setBackgroundColor(rte(e.backgroundColor,t.shared)),void 0!==e.fog&&this.updateFog(e.fog,t.shared),void 0!==e.ambient&&this.updateAmbientLight(e.ambient,t.shared),void 0!==e.ao&&this.updateAo(e.ao,t.shared),void 0!==e.shadow&&this.updateShadow(e.shadow)}createFrame(e,t){}raycast(e,t){super.raycast(e,t)}switchActiveCamera(e){e&&e.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=e,e.objectHelper.visible=!1)}get playCamera(){var e,t;return null!==(e=null===(t=this.scene)||void 0===t?void 0:t.find(this.data.publish.playCamera))&&void 0!==e?e:this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return null===this.penumbraSizeArrayCache&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let e=0,t=0;this.traverseEntity((r=>{var n,i;if(!r.visible)return!0;r instanceof aae&&r.visible&&e<3&&(this.penumbraSizeArrayCache[e]=null!==(n=r.data.penumbraSize)&&void 0!==n?n:.5,e+=1),r instanceof uae&&r.visible&&e<2&&(this.penumbraSizeArrayCache[3+t]=null!==(i=r.data.penumbraSize)&&void 0!==i?i:.5,t+=1)}))}raycastWithClones(e){let t=[],r=n=>{for(let i of n.children){let n=i.cloner;W4.is(i)&&(i.visible||(null===n||void 0===n?void 0:n.object.data.visible))&&((qne(i)||Yne(i)&&this.scene.enableHelpers&&i.objectHelper.visible)&&(e.intersectObject(i,!1,t),sle(i,e,t,!0)),r(i))}};return r(this),t}updateEntity2DByOp(e,t,r,n){var i;null===(i=this.uiCanvas)||void 0===i||i.updateEntity2DByOp(e,t,r,n)}},hoe=class extends(Gne(BW,Zse)){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.fov=90,n.aspect=1,n.near=100,n.far=2500;let i=new PB(-n.far+this.position.x,-n.far+this.position.y,-n.far+this.position.z),s=new PB(n.far+this.position.x,n.far+this.position.y,n.far+this.position.z),a=new IB(i,s),o=new AG(a,new vB(16755200));o.visible=!1,this.gizmos.shadowmap=o,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let e in this.gizmos){let t=this.gizmos[e];if(t instanceof AG){let e=this.shadow.camera,r=new PB(-e.far+this.position.x,-e.far+this.position.y,-e.far+this.position.z),n=new PB(e.far+this.position.x,e.far+this.position.y,e.far+this.position.z);t.box.set(r,n),t.updateMatrixWorld(!0)}}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),void 0!==e.distance&&(this.distance=e.distance),void 0!==e.decay&&(this.decay=e.decay),void 0!==e.shadowRadius&&(this.shadow.radius=e.shadowRadius),void 0!==e.shadowResolution&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},doe=class extends Dre{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");void 0!==r?L9(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},foe=class extends Dre{constructor(e,t,r){super(e,t,r),this._shapeId=null,this._context=r}updateState(e,t){super.updateState(e,t),this.updateShape(),this.refreshAttachedCloners(t)}updateShape(){let e,t=u({},this.data.geometry.extrusion.shape);for(let i in t)"string"==typeof t[i]&&(t[i]=this._context.shared.getVariable(t[i],[this.uuid,"geometry","extrusion","shape",i]));if("Custom"===t.type){let n=t.shapeId;if(n!==this._shapeId&&this.detachShape(),n){var r;this._shapeId=n;let t=this._context.scene.find(n);null!==t&&void 0!==t&&t.data&&(t.attachedPaths.add(this),e=null===(r=t.geometry.userData)||void 0===r?void 0:r.shape),e||this._context.scene.addPendingCommand((()=>this.updateShape()))}}else{let r;switch(t.type){case"Rectangle":r=x8;break;case"Ellipse":r=j6;break;case"Polygon":r=g8;break;case"Star":r=_8;break;default:throw new Error("Unknown shape type: ".concat(t.type))}e=r.create({parameters:t}).userData.shape}let n=this.geometry;e&&n.inputs&&(n.inputs.shapeData=e,n.build())}detachShape(){var e;null!==this._shapeId&&(null===(e=this._context.scene.find(this._shapeId))||void 0===e||e.attachedPaths.delete(this))}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.updateShape(),this.refreshAttachedPaths(e)}updateTransformState(e,t){return super.updateTransformState(e,t)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.updateShape()}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");void 0!==r?L9(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},poe=class extends one{constructor(e,t,r){super(e,t,r),this.data=t}},moe=class extends(Ine(cV,$ne)){constructor(e,t,r){super(),"Instance"===t.type&&"string"==typeof e&&(t=this.transformAssignData(t,r)),this.super_Entity(e,t),this.objectHelper.update()}get isComponentRoot(){return"Component"===this.data.type&&"string"==typeof this.identity}get isInstanceRoot(){return"Instance"===this.data.type&&"string"==typeof this.identity}transformAssignData(e,t){let r=U2.getComponentData({scene:t.scene.data,shared:t.shared.data},e.component);if(r){let t,n;for(let i of t2.rootOverrideProps)void 0===e[i]?(void 0===t&&(t=u({},e)),t[i]=r.data[i]):(void 0===n&&(n={}),n[i]=e[i],void 0===t&&(t=u({},e)),t[i]=sJ.apply(r.data[i],e[i]));return this.overrideData=n,t}return u(u(u({},q1.defaultData),e),mZ(q1.defaultData,t2.rootOverrideProps))}updateByOp(e,t,r,n){var i;let s;if(this.isInstanceRoot&&!n)if(t=this.transformAssignData(t,r),0===e.type&&0===e.path.length&&this.component)for(let a of t2.rootOverrideProps)a in e.props&&void 0===e.props[a]&&(void 0===s&&(s=u(u({},e),{},{props:u({},e.props)})),s.props[a]=this.component.data[a]);else if(0===e.type&&e.path.length>0&&t2.rootOverrideProps.includes(e.path[0])){let r=e.path[0];void 0===s&&(s=u(u({},e),{},{path:[],props:{[r]:t[r]}}))}super.updateByOp(null!==(i=s)&&void 0!==i?i:e,t,r,n)}updateState(e,t){this.updateState_Entity(e,t)}expandInstanceChildren(e){let t=this.data;if(void 0===this.component){var r;let n=null!==(r=e.scene.find(t.component))&&void 0!==r?r:null,i=!1;if(n!==this.oldComponent){if(this.oldComponent){let t=0;for(let r of this.children){if(!W4.is(r))break;e.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(r),goe(r),t+=1}this.children.splice(0,t)}i=!0}if(n){let r={};yoe(e,[this.uuid],t.overrides,this,n,n,0,i,r);for(let t of this.children)if(W4.is(t)){let n=t.data;"Empty"===n.type&&n.animations&&t.traverseEntity((t=>{let n=t.dataPatched;if(t instanceof Dre&&n.bones&&n.boneInverses){let n=t.dataPatched;if(n.bones&&n.boneInverses){let i=n.bones.map((t=>e.scene.find(r[t]))),s=n.boneInverses.map((e=>(new sz).fromArray(e))),a=new AV(i,s);t.bind(a,t.bindMatrix)}}else t.matrixAutoUpdate=!0}))}}this.oldComponent=this.component}}};function goe(e){if(e.component){let t=e.component.instances.indexOf(e);t>=0&&e.component.instances.splice(t,1);for(let r of e.children)W4.is(r)&&goe(r)}}function voe(e,t,r,n){return e.component===t&&iZ(e.identity,n)?e.overrideData===r?2:1:0}function yoe(e,t,r,n,i,s,a,o,l){if(a>50)return!1;if(n.component!==i){if(n.component){let e=n.component.instances.indexOf(n);e>=0&&n.component.instances.splice(e,1)}i.instances.find((e=>e===n))||i.instances.push(n),n.component=i}i instanceof moe&&i.isInstanceRoot&&i.expandInstanceChildren(e);let c=0;for(let d of i.children)if(W4.is(d)){let i=[...t,..."string"==typeof d.identity?[d.identity]:d.identity],f=e2.resolve(r,i,1);null==f||f instanceof cJ||(Object.setPrototypeOf(f,cJ.prototype),console.error("wrong prototype"));let p,m=null;if(!o){var h;let t=n.children[c];if(m=W4.is(t)?t:null,null!==m){let e=voe(m,d,f,i);p=e>=1?m.stateSelection:void 0,2!==e&&(m=null)}if(null===m&&(m=null!==(h=e.scene.findInstance(i))&&void 0!==h?h:null,null!==m)){let t=voe(m,d,f,i);if(p=t>=1?m.stateSelection:void 0,2!==t)m=null;else{let t=m.parent.children.indexOf(m);m.parent.children.splice(t,1),n.children.splice(c,0,m),m.parent===n?t<=c&&console.error("not possible"):(m.parent=n,m.matrixWorldNeedsUpdate=!0,m.resetBBoxNeedsUpdate(),m.updateVisible(),e.pendingDeletes.delete(m))}}}if(null===m){let t=f?sJ.apply(d.data,f):d.data;Z0.is(t.type)&&(t=u(u({},t),{},{type:"Empty"})),m=r5.createEntity(i,t,e),m.overrideData=f,n.add(m),n.children.splice(n.children.length-1,1),n.children.splice(c,0,m),m.updateState(m.data,e),p&&m.changeSelectedState(p,e),e.scene.registerInstanceAndSetUuid(m)}if(m.isBone){l[m.identity[m.identity.length-1]]=m.uuid}c+=1,yoe(e,t,r,m,d,s,a+1,o,l)}if(!o){let t=c;for(;;){let t=n.children[c];if(!W4.is(t))break;e.pendingDeletes.add(t),c+=1}n.children.splice(t,c-t)}return!0}var boe=class extends(Ine(SV,$ne)){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(e,t){this.updateState_Entity(e,t)}},woe=class extends Dre{constructor(e,t,r){super(e,t,r),this.onBeforeRender=e=>{this.uiCanvas.render(e)},this.uiCanvas=new soe(e+"-canvas",t.geometry.width,t.geometry.height,r),this.uiCanvas.promise.then((()=>{this.applyFrame(this.dataPatched.geometry.frame,r.shared)}))}updateByPatchedOpGeometry(e,t,r){super.updateByPatchedOpGeometry(e,t,r),0===e.type&&(void 0!==e.props.frame&&this.applyFrame(e.props.frame,r.shared),(void 0!==e.props.width||void 0!==e.props.height)&&this.applySize(e.props,r.shared))}applySize(e,t){var r,n;let i=null!==(r=null===e||void 0===e?void 0:e.width)&&void 0!==r?r:this.dataPatched.geometry.width,s=null!==(n=null===e||void 0===e?void 0:e.height)&&void 0!==n?n:this.dataPatched.geometry.height;this.uiCanvas.applySize({width:i,height:s}),this.applyGeometryParametersFromFrame(t)}applyFrame(e,t){this.uiCanvas.applyFrame(e),this.applyGeometryParametersFromFrame(t),this.applyMaterialParametersFromFrame({shared:t})}applyGeometryParametersFromFrame(e){var t;let r=this.frame;r&&(Object.assign(this.data,{geometry:Object.assign(this.data.geometry,{cornerRadius:r.cornerRadius,cornerType:0})}),Object.assign(this.dataPatched,{geometry:Object.assign(this.dataPatched.geometry,{cornerRadius:r.cornerRadius,cornerType:0})}),null!==(t=this.localGeometry)&&void 0!==t&&t.dispose(),this.localGeometry=J8(this.dataPatched.geometry,e,this.data.flatShading,this))}applyMaterialParametersFromFrame(e){let t=this.frame;if(t){let r=t.data.backgroundBlur;Object.assign(this.data.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.data.material.layers[1].data,{roughness:r.radius,alpha:r.enabled?1:0}),Object.assign(this.dataPatched.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.dataPatched.material.layers[1].data,{roughness:r.radius,alpha:r.enabled?1:0}),this.material.reset(this.dataPatched.material,e,!0)}}updateEntity2DByOp(e,t,r,n){this.uiCanvas.updateEntity2DByOp(e,t,r,n),e===this.frameId&&0===t.type&&(void 0!==t.props.cornerRadius?this.applyGeometryParametersFromFrame(n):NJ(t.path,["backgroundBlur"])&&this.applyMaterialParametersFromFrame({shared:n}))}get frame(){return this.uiCanvas.frame}get frameId(){var e;return null===(e=this.frame)||void 0===e?void 0:e.uuid}removeInteractionGeometry(e){super.removeInteractionGeometry(e),this.applySize({},e)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.applySize({width:e.width,height:e.height},t)}},xoe=class{constructor(e,t,r){this.variables=[],this.currentTextureIndex=0;let n=cN,i=new yV,s=new AF;s.position.z=1;let a={passThruTexture:{value:null}},o=u("uniform sampler2D passThruTexture;\n\nvoid main() {\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\n\tgl_FragColor = texture2D( passThruTexture, uv );\n\n}\n",a),l=new yF(new UF(2,2),o);function c(r){r.defines.resolution="vec2( "+e.toFixed(1)+", "+t.toFixed(1)+" )"}function u(e,t){let r=new EF({uniforms:t=t||{},vertexShader:"void main()\t{\n\n\tgl_Position = vec4( position, 1.0 );\n\n}\n",fragmentShader:e});return c(r),r}i.add(l),this.setDataType=function(e){return n=e,this},this.addVariable=function(e,t,r){let n={name:e,initialValueTexture:r,material:this.createShaderMaterial(t),dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:tN,magFilter:tN};return this.variables.push(n),n},this.setVariableDependencies=function(e,t){e.dependencies=t},this.init=function(){if(!1===r.capabilities.isWebGL2&&!1===r.extensions.has("OES_texture_float"))return"No OES_texture_float support for float textures.";if(0===r.capabilities.maxVertexTextures)return"No support for vertex shader textures.";for(let r=0;r<this.variables.length;r++){let n=this.variables[r];n.renderTargets[0]=this.createRenderTarget(e,t,n.wrapS,n.wrapT,n.minFilter,n.magFilter),n.renderTargets[1]=this.createRenderTarget(e,t,n.wrapS,n.wrapT,n.minFilter,n.magFilter),this.renderTexture(n.initialValueTexture,n.renderTargets[0]),this.renderTexture(n.initialValueTexture,n.renderTargets[1]);let i=n.material,s=i.uniforms;if(null!==n.dependencies)for(let e=0;e<n.dependencies.length;e++){let t=n.dependencies[e];if(t.name!==n.name){let e=!1;for(let r=0;r<this.variables.length;r++)if(t.name===this.variables[r].name){e=!0;break}if(!e)return"Variable dependency not found. Variable="+n.name+", dependency="+t.name}s[t.name]={value:null},i.fragmentShader="\nuniform sampler2D "+t.name+";\n"+i.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){let e=this.currentTextureIndex,t=0===this.currentTextureIndex?1:0;for(let r=0,n=this.variables.length;r<n;r++){let n=this.variables[r];if(null!==n.dependencies){let t=n.material.uniforms;for(let r=0,i=n.dependencies.length;r<i;r++){let i=n.dependencies[r];t[i.name].value=i.renderTargets[e].texture}}this.doRenderTarget(n.material,n.renderTargets[t])}this.currentTextureIndex=t},this.getCurrentRenderTarget=function(e){return e.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(e){return e.renderTargets[0===this.currentTextureIndex?1:0]},this.dispose=function(){l.geometry.dispose(),l.material.dispose();let e=this.variables;for(let t=0;t<e.length;t++){let r=e[t];r.initialValueTexture&&r.initialValueTexture.dispose();let n=r.renderTargets;for(let e=0;e<n.length;e++)n[e].dispose()}},this.addResolutionDefine=c,this.createShaderMaterial=u,this.createRenderTarget=function(r,i,s,a,o,l){return new EB(r=r||e,i=i||t,{wrapS:s=s||$L,wrapT:a=a||$L,minFilter:o=o||tN,magFilter:l=l||tN,format:dN,type:n,depthBuffer:!1})},this.createTexture=function(){let r=new Float32Array(e*t*4),n=new _V(r,e,t,dN,cN);return n.needsUpdate=!0,n},this.renderTexture=function(e,t){a.passThruTexture.value=e,this.doRenderTarget(o,t),a.passThruTexture.value=null},this.doRenderTarget=function(e,t){let n=r.getRenderTarget(),a=r.xr.enabled,c=r.shadowMap.autoUpdate,u=r.outputEncoding,h=r.toneMapping;r.xr.enabled=!1,r.shadowMap.autoUpdate=!1,r.outputEncoding=kN,r.toneMapping=0,l.material=e,r.setRenderTarget(t),r.render(i,s),l.material=o,r.xr.enabled=a,r.shadowMap.autoUpdate=c,r.outputEncoding=u,r.toneMapping=h,r.setRenderTarget(n)}}},Soe=new Uz,_oe=new PB,Coe=class{constructor(e){let t=e.geometry;if(!t.isBufferGeometry||3!==t.attributes.position.itemSize)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(e){return this.weightAttribute=e?this.geometry.getAttribute(e):null,this}build(){let e=this.positionAttribute,t=this.weightAttribute,r=new Float32Array(e.count/3);for(let i=0;i<e.count;i+=3){let n=1;t&&(n=t.getX(i)+t.getX(i+1)+t.getX(i+2)),Soe.a.fromBufferAttribute(e,i),Soe.b.fromBufferAttribute(e,i+1),Soe.c.fromBufferAttribute(e,i+2),n*=Soe.getArea(),r[i/3]=n}this.distribution=new Float32Array(e.count/3);let n=0;for(let i=0;i<r.length;i++)n+=r[i],this.distribution[i]=n;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t,r){let n=this.distribution[this.distribution.length-1],i=this.binarySearch(this.randomFunction()*n);return this.sampleFace(i,e,t,r)}binarySearch(e){let t=this.distribution,r=0,n=t.length-1,i=-1;for(;r<=n;){let s=Math.ceil((r+n)/2);if(0===s||t[s-1]<=e&&t[s]>e){i=s;break}e<t[s]?n=s-1:r=s+1}return i}sampleFace(e,t,r,n){let i=this.randomFunction(),s=this.randomFunction();return i+s>1&&(i=1-i,s=1-s),Soe.a.fromBufferAttribute(this.positionAttribute,3*e),Soe.b.fromBufferAttribute(this.positionAttribute,3*e+1),Soe.c.fromBufferAttribute(this.positionAttribute,3*e+2),t.set(0,0,0).addScaledVector(Soe.a,i).addScaledVector(Soe.b,s).addScaledVector(Soe.c,1-(i+s)),void 0!==r&&Soe.getNormal(r),void 0!==n&&void 0!==this.colorAttribute&&(Soe.a.fromBufferAttribute(this.colorAttribute,3*e),Soe.b.fromBufferAttribute(this.colorAttribute,3*e+1),Soe.c.fromBufferAttribute(this.colorAttribute,3*e+2),_oe.set(0,0,0).addScaledVector(Soe.a,i).addScaledVector(Soe.b,s).addScaledVector(Soe.c,1-(i+s)),n.r=_oe.x,n.g=_oe.y,n.b=_oe.z),this}};function Eoe(e,t){let r=e,n=new Float32Array(4*t*t);for(let s=0;s<t*t;s++)n[4*s]=r[3*s],n[4*s+1]=r[3*s+1],n[4*s+2]=r[3*s+2],n[4*s+3]=0;let i=new _V(n,t,t,dN,cN);return i.needsUpdate=!0,i}var Aoe="\n// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU\nuniform sampler2D uOriginalPosition;\nuniform sampler2D uDirections;     \nuniform vec3 uDirectionsAxis;\nuniform vec4 uWorldQuaternion;\nuniform vec3 uGravity;        \nuniform float uNoiseStrength;     // Variation of the noise\nuniform float uNoiseScale;        // Scale of the noise\nuniform float uNoiseSeed;         // Seed of the noise\nuniform float particleSize;\nuniform float uSpeed;     // update speed of the particles\nuniform float uRandomMassFactor;\n\n// COLLIDER\nuniform vec3 uColliderPos;                // Collider Position\nuniform vec3 uColliderSize;               // Collider Dimension\nuniform vec4 uColliderQuaternion;         // Collider Rotation\nuniform vec4 uColliderQuaternionInvert;   // Collider Rotation\nuniform float uBounce;                    // Bounce factor\nuniform float uForceDamping;\nuniform float uForceIntensity;\n\n\n\n\n    vec3 mod289(vec3 x) {\n      return x - floor(x * (1.0 / 289.0)) * 289.0;\n    }\n    \n    vec4 mod289(vec4 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n    }\n    \n    vec4 permute(vec4 x) {\n        return mod289(((x*34.0)+1.0)*x);\n    }\n    \n    vec4 taylorInvSqrt(vec4 r)\n    {\n    return 1.79284291400159 - 0.85373472095314 * r;\n    }\n    \n    vec3 fade(vec3 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n    float snoise(vec3 v)\n    {\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n    vec3 i  = floor(v + dot(v, C.yyy) );\n    vec3 x0 =   v - i + dot(i, C.xxx) ;\n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n    vec3 x1 = x0 - i1 + C.xxx;\n    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n    \n    // Permutations\n    i = mod289(i);\n    vec4 p = permute( permute( permute(\n                i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n              + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n    \n    // Gradients: 7x7 points over a square, mapped onto an octahedron.\n    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n    float n_ = 0.142857142857; // 1.0/7.0\n    vec3  ns = n_ * D.wyz - D.xzx;\n    \n    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n    \n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n    \n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n    \n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n    \n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n    \n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n    \n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n    \n    //Normalise gradients\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    \n    // Mix final noise value\n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                  dot(p2,x2), dot(p3,x3) ) );\n    }\n    \n    vec3 snoiseVec3( vec3 x ){\n    \n      float s  = snoise(vec3( x ));\n      float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));\n      float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));\n      vec3 c = vec3( s , s1 , s2 );\n      return c;\n    \n    }\n    \n      \n    vec3 curlNoise( vec3 p, float seed){\n      p += seed;\n      const float e = .1;\n      vec3 dx = vec3( e   , 0.0 , 0.0 );\n      vec3 dy = vec3( 0.0 , e   , 0.0 );\n      vec3 dz = vec3( 0.0 , 0.0 , e   );\n    \n      vec3 p_x0 = snoiseVec3( p - dx );\n      vec3 p_x1 = snoiseVec3( p + dx );\n      vec3 p_y0 = snoiseVec3( p - dy );\n      vec3 p_y1 = snoiseVec3( p + dy );\n      vec3 p_z0 = snoiseVec3( p - dz );\n      vec3 p_z1 = snoiseVec3( p + dz );\n    \n      float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;\n      float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;\n      float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;\n    \n      const float divisor = 1.0 / ( 2.0 * e );\n      return normalize( vec3( x , y , z ) * divisor );\n    \n    }\n\n\n// Classic Perlin noise\nfloat cnoise(vec3 P)\n{\n  vec3 Pi0 = floor(P); // Integer part for indexing\n  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1\n  Pi0 = mod289(Pi0);\n  Pi1 = mod289(Pi1);\n  vec3 Pf0 = fract(P); // Fractional part for interpolation\n  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n  vec4 iz0 = Pi0.zzzz;\n  vec4 iz1 = Pi1.zzzz;\n\n  vec4 ixy = permute(permute(ix) + iy);\n  vec4 ixy0 = permute(ixy + iz0);\n  vec4 ixy1 = permute(ixy + iz1);\n\n  vec4 gx0 = ixy0 * (1.0 / 7.0);\n  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n  gx0 = fract(gx0);\n  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n  vec4 sz0 = step(gz0, vec4(0.0));\n  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n  vec4 gx1 = ixy1 * (1.0 / 7.0);\n  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n  gx1 = fract(gx1);\n  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n  vec4 sz1 = step(gz1, vec4(0.0));\n  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n  g000 *= norm0.x;\n  g010 *= norm0.y;\n  g100 *= norm0.z;\n  g110 *= norm0.w;\n  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n  g001 *= norm1.x;\n  g011 *= norm1.y;\n  g101 *= norm1.z;\n  g111 *= norm1.w;\n\n  float n000 = dot(g000, Pf0);\n  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n  float n111 = dot(g111, Pf1);\n\n  vec3 fade_xyz = fade(Pf0);\n  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); \n  return 2.2 * n_xyz;\n}\n\n\nvec3 fbm_vec3(vec3 p, float frequency, float offset)\n{\n  return vec3(\n    cnoise((p+vec3(offset))*frequency),\n    cnoise((p+vec3(offset+20.0))*frequency),\n    cnoise((p+vec3(offset-30.0))*frequency)\n  );\n}\n\n"+"\nfloat rand(vec2 co){\n    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvec3 applyQuaternionToVector( vec4 q, vec3 v ){\n    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );\n } \nvec3 applyForce(vec3 force, float mass) {\n  vec3 acceleration = force / mass;\n  \n  return acceleration;\n}\n\nvec4 conjugate(vec4 q) {\n  return vec4(q.w, -q.x, -q.y, -q.z);\n}\n\n// Function to compute the normal of the ellipsoid at a given point\nvec3 ellipsoidNormal(vec3 p, vec3 radii) {\n  return normalize(p / (radii * radii));\n}\n\nfloat friction = .3;\n\nvoid main() {\n    vec2 vUv = gl_FragCoord.xy / resolution.xy;\n    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;\n    vec3 originalPosition = texture2D( uOriginalPosition, vUv ).xyz;\n    float timeLeft = texture2D( uCurrentPosition, vUv ).w;\n    vec3 directions = texture2D( uDirections, vUv ).xyz;    \n    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;\n    float mass = rand(originalPosition.xy) * 0.5 + 0.5;\n    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).x;        // 1. = spawning, 0. = not spawning\n    float isActive = texture2D( uCurrentEmissionRate, vUv ).y;          // 1. = active, 0. = not active\n    float collisionFlag =texture2D( uCurrentVelocity, vUv ).w;          // Indicate collision\n\n    // Randomness Mass\n    mass = (1.0 - (uRandomMassFactor * mass));\n    \n    if (isActive == 1.0) {\n      // **************************************************************\n      // FORCES NOISES\n      // **************************************************************\n      #ifdef USE_CURL_NOISE\n        if (uNoiseScale > 0.0 ) {\n          velocity = curlNoise(position * uNoiseScale * .002, uNoiseSeed) * ( uNoiseStrength + 1.0) * .05 * uSpeed;\n        }\n        // Variation of the noise Over Time\n        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {\n          velocity += curlNoise( position, uNoiseSeed)  * uNoiseStrength * 0.05 * uSpeed;\n        }\n      #endif\n      // **************************************************************\n      #ifdef USE_SIMPLEX_NOISE\n        if (uNoiseScale > 0.0 ) {\n          velocity = vec3(snoise(position * uNoiseScale * .001) * ( uNoiseStrength + 1.0) * .1);\n          velocity *= uSpeed;\n        }\n        // Variation of the noise Over Time\n        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0) {\n          velocity += vec3(snoise(position * uNoiseStrength * .001) * .05 * uSpeed);\n        }\n      #endif\n      // ************************************************************** \n      #ifdef USE_FBM_NOISE\n        if (uNoiseScale > 0.0 ) {\n          velocity = fbm_vec3(position * uNoiseScale * .001, ( uNoiseStrength + 1.0), uNoiseSeed);\n          velocity *= uSpeed;\n        }\n        // Variation of the noise Over Time\n        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {      \n          velocity += fbm_vec3(position * uNoiseStrength * .001, ( uNoiseStrength + 1.0), uNoiseSeed) * .1 * uSpeed;\n        }\n      #endif\n\n      // COLLIDER\n      ".concat("\n  #ifdef USE_COLLIDER\n    float restitution = max(uBounce * 2., .01); // Energy Loss\n    // SPHERE COLLIDER\n    // **************************************************************\n    #ifdef USE_SPHERE_COLLIDER       \n      // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)\n      vec3 radii = uColliderSize;\n      // Adjust position relative to collider\n      vec3 relPos = position - uColliderPos;\n      // Apply rotation of the collider to the relative position\n      relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            \n      // Scale relative position by radii (for ellipsoid collision detection)\n      vec3 scaledPos = relPos / radii;\n      // Calculate ellipsoidal distance\n      float dist = length(scaledPos); // Distance in terms of ellipsoid\n      \n      // Check for collision\n      if (dist <= 1. + particleSize / length(radii) && collisionFlag == 0.0) {\n          // Compute the normal at the collision point, accounting for particle size\n        vec3 adjustedPos = scaledPos * (1.0 + particleSize / length(radii));          \n        // Compute the normal at the collision point\n        vec3 normal = ellipsoidNormal(adjustedPos, radii);\n        // Rotate the normal back to world space\n        normal = applyQuaternionToVector(uColliderQuaternion, normal);\n        // Reflect the velocity vector off the normal\n        velocity = reflect(velocity, normal) * restitution;\n\n        collisionFlag = 1.0;\n      } else {\n        collisionFlag = 0.0;\n      }\n    #endif\n\n    // BOX COLLIDER or PLANE COLLIDER \n    // **************************************************************\n    #ifdef USE_BOX_COLLIDER\n      // Box dimensions and repulsion variables\n      vec3 boxHalfSize = uColliderSize / 2.0;\n      // Convert world position to box's local space\n      vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      \n      // Collision detection\n      vec3 localDistance = abs(localPos) - boxHalfSize;\n      float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));    \n\n      // Collision Detected\n      if (distToSurface <= particleSize * 0.5 && collisionFlag == 0.0) {      \n        // Find the nearest face normal for bounce direction\n        vec3 normal;\n        if (localDistance.x > localDistance.y && localDistance.x > localDistance.z) {\n            normal = vec3(sign(localPos.x), 0.0, 0.0);\n        } else if (localDistance.y > localDistance.z) {\n            normal = vec3(0.0, sign(localPos.y), 0.0);\n        } else {\n            normal = vec3(0.0, 0.0, sign(localPos.z));\n        }            \n        // Rotate normal back to world space\n        normal = applyQuaternionToVector(uColliderQuaternion, normal);      \n        // Reflect velocity and apply repulsion force\n        velocity = reflect(velocity, normal) * restitution;\n        \n        collisionFlag = 1.0;\n      } else {\n        collisionFlag = 0.0;\n      }\n    #endif      \n  #endif      \n  // END COLLIDER    \n","\n      // ATTRACTION\n      ").concat("\n  #ifdef USE_ATTRACTOR\n\n      #ifdef USE_SPHERE_COLLIDER      \n        // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)\n        vec3 radii = uColliderSize;\n        // Adjust position relative to collider\n        vec3 relPos = position - uColliderPos;\n        // Apply rotation of the collider to the relative position\n        relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            \n        // Scale relative position by radii (for ellipsoid collision detection)\n        vec3 scaledPos = relPos / radii;\n        // Calculate ellipsoidal distance\n        float distToSurface = length(scaledPos); // Distance in terms of ellipsoid\n        float insideCheck = 1.0;\n\n      #endif\n\n\n      #ifdef USE_BOX_COLLIDER\n        // Box dimensions\n        vec3 boxHalfSize = uColliderSize / 2.0;\n        // Convert world position to box's local space\n        vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      \n        vec3 localDistance = abs(localPos) - boxHalfSize;\n        float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));\n        float insideCheck = particleSize;\n      #endif      \n  \n      // Apply vortex force inside the Helper\n      #ifdef USE_FORCE_LOCAL_SPACE\n        if (distToSurface <= insideCheck ) {    \n            // Define parameters for the attractor field\n            #ifdef USE_SPHERE_COLLIDER      \n              float attractorStrength = (1.0 - distToSurface ) * uForceIntensity; // Adjust as needed\n            #endif\n\n            #ifdef USE_BOX_COLLIDER\n              float attractorStrength = max((1.0 - insideCheck / distToSurface), 0.) * uForceIntensity; // Adjust as needed\n              #endif\n\n            float attractorDamping = uForceDamping;  // Adjust as needed (higher values will attenuate velocity more)\n          \n            // Use the same radii calculation code as for the collider\n            vec3 attractorRadii = uColliderSize;\n            // Adjust position relative to attractor center\n            vec3 relPos = position - uColliderPos;\n            // Apply rotation of the collider to the relative position\n            relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            \n            // Scale relative position by radii (for ellipsoid attraction)\n            vec3 scaledPos = relPos / attractorRadii;\n\n            // Calculate ellipsoidal distance as attractor radius\n            float attractorRadius = length(scaledPos);\n            // Calculate the distance from the attractor center\n            vec3 relativePosition = position - uColliderPos;\n            // Calculate the force vector towards the attractor center\n            vec3 attractorForce = normalize(relativePosition) * attractorStrength;\n            // Apply the attractor force to the particle\n            velocity -= attractorForce;\n            // Attenuate the particle's velocity\n            velocity *= attractorDamping;\n        }\n      #else \n            // Calculate the distance from the attractor center\n            vec3 relativePosition = position - uColliderPos;\n            // Calculate the force vector towards the attractor center\n            vec3 attractorForce = normalize(relativePosition) * uForceIntensity;\n            // Apply the attractor force to the particle\n            velocity -= attractorForce;\n            // Attenuate the particle's velocity\n            velocity *= uForceDamping;\n      #endif    \n  #endif      \n","  \n      // VORTEX\n      ").concat("\n  #ifdef USE_VORTEX\n    // Box dimensions\n    vec3 boxHalfSize = uColliderSize / 2.0;\n    // Convert world position to box's local space\n    vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      \n    vec3 localDistance = abs(localPos) - boxHalfSize;\n    float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));\n\n    // Apply vortex force inside the box\n    if (distToSurface <= particleSize) {\n      float vortexStrength = uForceIntensity;\n      vec3 localTopCenter = vec3(0.0, 0., 0.0);\n\n      // Transform the local top center to the world space\n      vec3 vortexCenter = uColliderPos + applyQuaternionToVector(uColliderQuaternion, localTopCenter);\n      // Calculate the vector from particle to vortex center\n      vec3 vortexVector = vortexCenter - position;\n\n      // Calculate the rotation axis from the inverse of the collider's quaternion and the fixed up vector\n      // Note: important to add a tiny z component to the up vector to avoid instability\n      vec3 upVector = vec3(0.0, 1.0, 0.01);\n      vec3 rotationAxis = cross(upVector, applyQuaternionToVector(uColliderQuaternion, vortexVector));\n      rotationAxis = normalize(rotationAxis);\n\n      // Add rotational component to velocity\n      float rotationSpeed = length(vortexVector * vortexStrength * 3.0) ; \n\n      vec3 rotationVelocity = rotationAxis * rotationSpeed;\n      // velocity += rotationVelocity * 0.005 ;\n      velocity = rotationVelocity * 0.005 ;\n\n      // Calculate vortex force\n      // vec3 vortexForce = normalize(vortexVector) * uSpeed * .1 ;\n      // Apply the vortex force to the particle\n      vec3 originDirection = applyQuaternionToVector(uWorldQuaternion, directions);\n      velocity += applyForce( originDirection * uSpeed * (1. - uForceDamping) , mass * .5);\n    }\n  #endif      \n","\n    } \n    // End isActive\n\n    // SPAWN BIRTH \n    // **************************************************************\n    // if (isSpawning == 1.)\n    #ifdef USE_NORMALS\n      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, directions) * uSpeed, isSpawning);\n    #else\n      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, uDirectionsAxis) * uSpeed, isSpawning);    \n    #endif\n    \n    // if (collisionFlag == 0.0)\n    velocity += applyForce(uGravity, mass * .5) * (1.0 - collisionFlag);\n\n    gl_FragColor = vec4(velocity, collisionFlag);\n}\n"),Moe="\n\n  // Linear Fade In\n  float linearFadeIn(float t) {\n    return t;\n  }\n\n\n  // linear fade out\n  float linearFadeOut(float t) {\n    return 1.0 - t;\n  }\n  \n  float linearInOut(float t) {\n    return t < 0.5 ? t :  (1.0 - t);  \n  }\n\n    // lerp\n    float lerp(float a, float b, float t) {\n      return a + (b - a) * t;\n    }\n\n  // Ease In Out Quart\n  float exponentialInOut(float t) {\n    return t < 0.4 ? lerp(0.0, 1.0, t / 0.4) :\n    t > 0.6 ? lerp(1.0, 0.0, (t - 0.6) / 0.4) :\n    1.0;\n   }\n\n  // constant\n  float constant(float t) {\n    return 1.0;\n  } \n",Toe="\n  uniform sampler2D uPosition;\n  uniform float uSize;\n  uniform float uSizeEnd;\n  uniform vec3 uWorldOffset;\n  uniform vec4 uWorldQuaternion;\n  // Billboard Behavior - Currently at Zero, but we can change that\n  uniform float uRotation;\n  uniform float uRotationEnd;\n  uniform vec2 center;\n\n  // Randomness\n  uniform float uRandScaleFactor;\n  uniform float uRandRotationFactor;\n\n  attribute vec2 ref;\n\n  varying float v_LifeLeft;    // normalized lifetime 1 to 0\n  varying vec2 vUv;\n  varying vec2 vRef;\n\n  ".concat("\n\nfloat rand(vec3 co){\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvec3 applyQuaternionToVector( vec4 q, vec3 v ){\n  return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );\n}\n\nvec3 applyForce(vec3 force, float mass) {\n  vec3 acceleration = force / mass;\n    \n  return acceleration;\n}\n","\n  ").concat(Moe,"\n"),Poe="\n  uniform vec4 uColor;                // start color\n  uniform vec4 uColor2;               // end color\n  uniform sampler2D uTexture;         // texture\n  varying float v_LifeLeft;   // normalized lifetime 1 to 0\n  varying vec2 vUv;\n  varying vec2 vRef;\n\n  float random(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n  }\n  "+Moe+"  \n  ".concat("\nvec3 rgb2xyz (in vec3 rgb) {\n    float r = rgb.r;\n\tfloat g = rgb.g;\n\tfloat b = rgb.b;\n\n\tr = r > 0.04045 ? pow(((r + 0.055) / 1.055), 2.4) : (r / 12.92);\n\tg = g > 0.04045 ? pow(((g + 0.055) / 1.055), 2.4) : (g / 12.92);\n\tb = b > 0.04045 ? pow(((b + 0.055) / 1.055), 2.4) : (b / 12.92);\n\n\tfloat x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);\n\tfloat y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);\n\tfloat z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);\n    \n    vec3 xyz = vec3(\n        (r * 0.4124) + (g * 0.3576) + (b * 0.1805) * 100.0,\n        (r * 0.2126) + (g * 0.7152) + (b * 0.0722) * 100.0,\n        (r * 0.0193) + (g * 0.1192) + (b * 0.9505) * 100.0\n    );\n    return(xyz);\n}\n\nvec3 xyz2lab (in vec3 xyz) {\n\tfloat x = xyz.x / 95.047;\n\tfloat y = xyz.y / 100.0;\n\tfloat z = xyz.z / 108.883;\n\n\tx = x > 0.008856 ? pow(x, 1.0 / 3.0) : (7.787 * x) + (16.0 / 116.0);\n\ty = y > 0.008856 ? pow(y, 1.0 / 3.0) : (7.787 * y) + (16.0 / 116.0);\n\tz = z > 0.008856 ? pow(z, 1.0 / 3.0) : (7.787 * z) + (16.0 / 116.0);\n\n    vec3 lab = vec3((116.0 * y) - 16.0, 500.0 * (x - y), 200.0 * (y - z));\n    return(lab);\n}\n\nvec3 rgb2lab(in vec3 rgb) {\n    vec3 xyz = rgb2xyz(rgb);\n    vec3 lab = xyz2lab(xyz);\n    return(lab);\n}\n\nvec3 xyz2rgb (in vec3 xyz) {\n\tfloat x = xyz.x / 100.0;\n\tfloat y = xyz.y / 100.0;\n\tfloat z = xyz.z / 100.0;\n\t\n    \n\tfloat r = (x *  3.2406) + (y * -1.5372) + (z * -0.4986);\n\tfloat g = (x * -0.9689) + (y *  1.8758) + (z *  0.0415);\n\tfloat b = (x *  0.0557) + (y * -0.2040) + (z *  1.0570);\n\n\tr = r > 0.0031308 ? ((1.055 * pow(r, 1.0 / 2.4)) - 0.055) : r * 12.92;\n\tg = g > 0.0031308 ? ((1.055 * pow(g, 1.0 / 2.4)) - 0.055) : g * 12.92;\n\tb = b > 0.0031308 ? ((1.055 * pow(b, 1.0 / 2.4)) - 0.055) : b * 12.92;\n\n\tr = min(max(0.0, r), 1.0);\n\tg = min(max(0.0, g), 1.0);\n\tb = min(max(0.0, b), 1.0);\n\n\treturn(vec3(r, g, b));\n}\n\nvec3 lab2xyz (in vec3 lab) {\n    float l = lab.x;\n\tfloat a = lab.y;\n\tfloat b = lab.z;\n\n  \tfloat y = (l + 16.0) / 116.0;\n\tfloat x = a / 500.0 + y;\n\tfloat z = y - b / 200.0;\n\n\tfloat y2 = pow(y, 3.0);\n\tfloat x2 = pow(x, 3.0);\n\tfloat z2 = pow(z, 3.0);\n\n  \ty = y2 > 0.008856 ? y2 : (y - 16.0 / 116.0) / 7.787;\n\tx = x2 > 0.008856 ? x2 : (x - 16.0 / 116.0) / 7.787;\n\tz = z2 > 0.008856 ? z2 : (z - 16.0 / 116.0) / 7.787;\n\n\tx *= 95.047;\n\ty *= 100.0;\n\tz *= 108.883;\n\n\treturn(vec3(x, y, z));\n}\nvec3 lab2rgb (in vec3 lab) {\n    vec3 xyz = lab2xyz(lab);\n    vec3 rgb = xyz2rgb(xyz);\n    return(rgb);\n}\n\n","\n\n"),koe=class extends EF{constructor(e,t){super(),this.needsJitter=!0,this.type="ParticleMaterial",this.easeOpacity="linearFadeIn",this.easeSize="linearFadeIn",this.useSizeEnd=!1,this.isColoringRandom=!1,this.init(e,t),this.context=t}reset(){}init(e,t){this.transparent=!0,this.depthTest=!0,this.depthWrite=!1,this.easeOpacity=e.ease,this.easeSize=e.easeSize,this.layers=[],j9.startContext(j9.globalContext),this.lightLayer=new mte(0,"",u(u({},S1.defaultData("light","phong")),{},{visible:!1}),new xee,{},t.shared),j9.endContext(j9.globalContext),this.build()}updateState(e){void 0!==e.coloring&&(this.isColoringRandom="random"===e.coloring),void 0!==e.color&&(e.color instanceof Array?this.uniforms.uColor.value=e.color:this.uniforms.uColor.value=this.context.shared.color(e.color)),void 0!==e.color2&&(e.color2 instanceof Array?this.uniforms.uColor2.value=e.color2:this.uniforms.uColor2.value=this.context.shared.color(e.color2)),void 0!==e.size&&(this.uniforms.uSize.value=e.size[0],this.uniforms.uSizeEnd.value=e.size[1],e.size[0]!==e.size[1]?this.useSizeEnd=!0:this.useSizeEnd=!1),void 0!==e.ease&&(this.easeOpacity=e.ease,this.build()),void 0!==e.easeSize&&(this.easeSize=e.easeSize,this.build()),this.needsUpdate=!0}onBeforeCompile(e){this.build(),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader}build(){let e=new P7;return e.needsJitter=this.needsJitter,e.addFragmentParsCode("\nlayout(location = 1) out vec4 gVelocity;\n"),e.buildShader("vertex",this.fragment),e.buildShader("fragment",this.fragment),e.addFragmentFinalCode("\n    // Discard fully transparent pixels \n    if (gl_FragColor.a <= 0.0) discard;\n\n    gVelocity = vec4(0.0, 0.0, 0.0, 1.0);\n"),this.isColoringRandom&&e.define("USE_RANDOM_COLORING"),this.useSizeEnd&&e.define("USE_SIZE_END"),e.addVertexParsCode(Toe),e.addFragmentParsCode(Poe),e.addVertexFinalCode((e=>{let{easeSize:t="linearFadeOut"}=e;return"\n  vUv = uv;  \n  vRef = ref;\n  // Normalized LifeTime 1 to 0\n  float lifeLeft = texture2D(uPosition, ref).w;\n  v_LifeLeft = lifeLeft;\n  // Position From DataTexture Simulation\n  vec3 pos = texture2D(uPosition, ref).rgb - uWorldOffset;\n  // Apply World Quaternion\n  pos = applyQuaternionToVector(uWorldQuaternion, pos);  \n            \n  #ifdef  USE_SIZE_END\n    // Scaled Over Time\n    float t = 1. - lifeLeft;\n    float currentSize = mix(uSize, uSizeEnd, t); // Linearly interpolate between uSize and uSizeEnd\n    vec3 scaledPosition = position * vec3(currentSize);\n  #else\n    // Change Size Behavior over LifeTime\n    float easeSize = ".concat(t,"(1. - lifeLeft);\n    // Scaled Over Time\n    vec3 scaledPosition = position * vec3(uSize * easeSize);\n  #endif\n\n  // Billboard Behavior\n  vec2 scale;\n  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );    \n  // Randomness \n  float randRef = rand(ref);\n  scale *= (1.0 - (uRandScaleFactor * randRef));\n  // Rotation\n  float randRotation =  2.0 * PI * ( uRandRotationFactor * randRef);\n  float originalRotation = (1.0 - uRotation) * 2.0 * PI;\n  float originalRotationEnd = (1.0 - uRotationEnd) * 2.0 * PI;\n  // OverTime\n  float finalRotation = mix(originalRotation + randRotation, originalRotationEnd + randRotation, lifeLeft);\n\n  vec2 alignedPosition = ( scaledPosition.xy - ( center - vec2( 0.5 ) ) ) * scale;\n  vec2 rotatedPosition;\n  rotatedPosition.x = cos( finalRotation ) * alignedPosition.x - sin( finalRotation ) * alignedPosition.y;\n  rotatedPosition.y = sin( finalRotation ) * alignedPosition.x + cos( finalRotation ) * alignedPosition.y;\n  \n  mat4 instanceMatrix = mat4(\n    vec4(1.0, 0.0, 0.0, 0.0),\n    vec4(0.0, 1.0, 0.0, 0.0),\n    vec4(0.0, 0.0, 1.0, 0.0),\n    vec4(pos.x, pos.y, pos.z, 1.0)\n  );  \n\n  mvPosition = modelViewMatrix * instanceMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n  mvPosition.xy += rotatedPosition;\n  gl_Position = projectionMatrix  * mvPosition;   \n")})({easeSize:this.easeSize})),e.addFragmentFinalCode((e=>{let{easeOpacity:t="linearFadeOut"}=e;return"  \n  // if Particle is dead, hide it\n  if (v_LifeLeft <= 0.005 ) {\n    discard;\n  }\n\n  #ifdef USE_RANDOM_COLORING\n    float randVal = random(vRef); // Generate a random value based on the reference\n    vec4 color = mix(uColor, uColor2, randVal); // Interpolate between the two colors\n  #else\n    vec4 color = mix(uColor, uColor2, 1. - v_LifeLeft);\n  #endif\n\n  // Opacity over Life Time\n  float finalAlpha = ".concat(t,"(1. - v_LifeLeft);  \n  vec4 textureColor = texture2D(uTexture, vUv).rgba; \n  finalColor = textureColor.rgb * color.rgb;\n  finalAlpha = color.a * textureColor.a * finalAlpha;\n  \n  gl_FragColor = vec4(finalColor, finalAlpha);     \n\n")})({easeOpacity:this.easeOpacity})),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=u(u({},e.uniforms),this.uniforms),this.extensions=e.extensions,this}get nodeMaterial(){return this}get fragment(){return this.lightLayer.node}getDefines(){return this.defines}nodeMaterialDispose(){this.layers.forEach((e=>e.dispose())),super.dispose()}},Doe=class{constructor(e,t,r,n){var i;this.type="SphereEmitterShape",this.targetMesh=void 0,this.size=e,this.type=r,this.textureSize=function(e){let t=Math.ceil(Math.sqrt(e));return Math.max(t,1)}(t);this.targetMesh="Mesh"===(null===n||void 0===n?void 0:n.type)&&n?n:this.getMesh(r,1);let{positions:s,dataTexture:a,dataTextureNormals:o}=this.createPositions(this.textureSize,null!==(i=this.targetMesh)&&void 0!==i?i:this.getMesh(r,1));this.positionsTexture=a,this.positionsAttribute=s,this.directionsTexture=o}createPositions(e,t){let{positions:r,normals:n}=function(e,t){let r=new yF(e.geometry,e.material),n=[],i=[],s=new PB,a=new PB;null!==r.geometry.index&&(r.geometry=r.geometry.toNonIndexed());let o=new Coe(r).build();for(let l=0;l<t;l++)o.sample(s,a),n.push(s.x,s.y,s.z),i.push(a.x,a.y,a.z);return{positions:new Float32Array(n),normals:new Float32Array(i)}}(t,e*e);return{dataTexture:Eoe(r,e),positions:r,dataTextureNormals:Eoe(n,e)}}getMesh(e,t){let r=null;switch(e){case"SphereEmitterShape":r=new qH(.5*t,32,32);break;case"TorusEmitterShape":r=new XH(.5*t,.3,15,40);break;case"ConeEmitterShape":r=new fH(t,t,15);break;case"BoxEmitterShape":r=new wF(t,t,t);break;case"PlaneEmitterShape":r=new UF(t,t),r.rotateX(-Math.PI/2);break;default:r=new qH(t,32,32)}return new yF(r,new Wz({color:16711680}))}applyToShader(e,t){this.size=(new PB).fromArray(t.size),e.uEmitterSize.value=this.size}dispose(){this.positionsTexture.dispose(),this.directionsTexture.dispose(),this.positionsAttribute=new Float32Array}};function Ioe(e){let t=u({},e),r=o1.defaultData;t.forceFieldObjectId&&(t.colliderEntityId=t.forceFieldObjectId);let n=u(u({},r.shape),t.shape),i=u(u({},r.renderMaterial),t.renderMaterial);return u(u(u({},r),t),{},{shape:n,renderMaterial:i})}var Ooe=class extends kz{constructor(e,t){var r,n,i,s;super(),this.type="ParticleEmitter",this.debugMode=!1,this.worldSpace=!0,this.rootObject=null,this.gpuCompute=null,this.positionSimRT=null,this.velocitySimRT=null,this.emissionRateSimRT=null,this.emitterShape=void 0,this.isEmitting=!1,this.hasBeenReset=!1,this.emittedParticlesAmount=0,this.lastEmitTime=0,this.globalTime=0,this.targetFPS=60,this.previousRatio=1,this.lerpFactor=.4,this.particlesAmount=0,this.noiseStrength=0,this.noiseScale=0,this.isBillboardBased=!0,this.simFeaturesDefinition={USE_COLLIDER:!1,USE_ATTRACTOR:!1,USE_VORTEX:!1,USE_SPHERE_COLLIDER:!1,USE_BOX_COLLIDER:!1,USE_FORCE_LOCAL_SPACE:!1,USE_NORMALS:!1,USE_CURL_NOISE:!0,USE_SIMPLEX_NOISE:!1,USE_FBM_NOISE:!1},this.textureLoader=new CW,this.currentWorldPosition=new PB,this.systemQuaternion=new TB,this.worldGravity=new PB(0,0,0),this.directionAxis=new PB(0,0,0),this.colliderV3=new PB(0,0,0),this.colliderQuaternion=new TB(0,0,0,1),this.matrixAutoUpdate=!0,this.renderer=e,this.system=t,this.shared=t.context.shared;let a=t.data;this.material=new koe(a.renderMaterial,t.context),this.material.uniforms={uSize:{value:0},uSizeEnd:{value:0},uColor:{value:a.renderMaterial.color},uColor2:{value:a.renderMaterial.color2},uPosition:{value:new PB(0,0,0)},uEmissionData:{value:new PB(0,0,0)},uTexture:{value:this.defaultTexture},uWorldOffset:{value:new PB(0,0,0)},uWorldQuaternion:{value:new CB(0,0,0,1)},uRandScaleFactor:{value:null!==(r=a.randomScale)&&void 0!==r?r:0},uRandRotationFactor:{value:null!==(n=a.randomRotation)&&void 0!==n?n:0},uRotation:{value:null!==(i=a.renderMaterial.spriteRotation[0])&&void 0!==i?i:0},uRotationEnd:{value:null!==(s=a.renderMaterial.spriteRotation[1])&&void 0!==s?s:0}},this.setTexture(this.material.uniforms,a.renderMaterial.texture),this.init(a)}setTexture(e,t){let r=t.data;if("string"==typeof t){let r=this.shared.image(t),n=new _B(r.img);return n.needsUpdate=!0,void(e.uTexture.value=n)}if("string"!=typeof r){let t=new Image;t.onload=()=>{let r=new _B(t);r.needsUpdate=!0,e.uTexture.value=r};let n=new Blob([r],{type:"image/*"}),i=URL.createObjectURL(n);t.src=i}}updateGeometryAttributes(e,t){var r;let n=function(e){let t=new Float32Array(e*e*2);for(let r=0;r<e;r++)for(let n=0;n<e;n++){let i=r*e+n;t[2*i+0]=r/(e-1),t[2*i+1]=n/(e-1)}return t}(t);null===(r=this.emitterShape)||void 0===r||!r.positionsAttribute||e.geometry.setAttribute("ref",new MV(n,2))}applyWorldSpace(){if(!this.system.started||!this.worldSpace||!this.positionSimRT||!this.velocitySimRT)return;let e=this.system;e.getWorldQuaternion(this.systemQuaternion),this.systemQuaternion.invert(),e.getWorldPosition(this.currentWorldPosition),this.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.positionSimRT.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.systemQuaternion.invert(),this.positionSimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.velocitySimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize())}update(e,t){var r;if(!this.gpuCompute||!this.positionSimRT||!this.velocitySimRT||!this.emissionRateSimRT||this.hasBeenReset)return;if(this.checkIfAllParticlesAreDead()&&!this.hasBeenReset)return void this.reset();this.applyWorldSpace(),this.globalTime=e,this.positionSimRT.material.uniforms.uTime.value=e,this.emissionRateSimRT.material.uniforms.uTime.value=e;let n=1e3/t,i=this.targetFPS/n,s=this.previousRatio+(i-this.previousRatio)*this.lerpFactor;this.positionSimRT.material.uniforms.uFPSRatio.value=s,this.previousRatio=s;let a=this.isEmitting?this.GoEmitSomeParticles(e,this.system.data.birthRatePerSec):0;this.emissionRateSimRT.material.uniforms.uLastIndexEmitted.value=this.emittedParticlesAmount,this.emissionRateSimRT.material.uniforms.uParticlesToEmit.value=a,this.material.uniforms.uPosition.value=null===(r=this.gpuCompute.getCurrentRenderTarget(this.positionSimRT))||void 0===r?void 0:r.texture,this.system.colliderEntities.length>0&&this.renderColliders(),this.gpuCompute.compute()}renderColliders(){if(!this.velocitySimRT)return;let e=this.system.colliderEntities[0],t=this.simFeaturesDefinition.USE_COLLIDER||this.simFeaturesDefinition.USE_ATTRACTOR||this.simFeaturesDefinition.USE_VORTEX;if(e.destroyedInAction&&t&&this.init(Ioe(u(u({},this.system.data),{},{colliderEntityId:null}))),!e||e.destroyedInAction)return;e.getWorldPosition(this.colliderV3),0===this.colliderV3.y&&(this.colliderV3.y=1e-4),this.velocitySimRT.material.uniforms.uColliderPos.value.copy(this.colliderV3);let r=e.data.size;this.colliderV3.fromArray(r),this.velocitySimRT.material.uniforms.uColliderSize.value.copy(this.simFeaturesDefinition.USE_SPHERE_COLLIDER?this.colliderV3.multiplyScalar(.5):this.colliderV3),e.getWorldQuaternion(this.colliderQuaternion),this.velocitySimRT.material.uniforms.uColliderQuaternion.value.copy(this.colliderQuaternion.normalize()),this.velocitySimRT.material.uniforms.uColliderQuaternionInvert.value.copy(this.colliderQuaternion.normalize().invert())}updateState(e){!this.velocitySimRT||!this.positionSimRT||(e.renderMaterial&&this.updateMaterialState(e.renderMaterial),this.updateParticleState(e))}updateVariableState(e,t){if(!this.velocitySimRT||!this.positionSimRT)return;"size"===t[2]&&this.material.updateState({size:[e,this.material.uniforms.uSizeEnd.value]}),"sizeEnd"===t[2]&&this.material.updateState({size:[this.material.uniforms.uSize.value,e]});let r=(e,t)=>{let r=[...this.system.data.shape.size];r[e]=t,this.updateParticleState({shape:u(u({},this.system.data.shape),{},{size:r})})};"shape_size_0"===t[2]&&r(0,e),"shape_size_1"===t[2]&&r(1,e),"shape_size_2"===t[2]&&r(2,e),"speed"===t[2]&&(this.velocitySimRT.material.uniforms.uSpeed.value=e/10),"gravity"===t[2]&&this.worldGravity.set(0,e/100,0),"noiseStrength"===t[2]&&(this.noiseStrength=e,this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),"noiseScale"===t[2]&&(this.noiseScale=e,this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),"direction_x"===t[2]&&(this.directionAxis=this.getDirectionAxis([Number(e),this.system.data.direction[1],this.system.data.direction[2]])),"direction_y"===t[2]&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],Number(e),this.system.data.direction[2]])),"direction_z"===t[2]&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],this.system.data.direction[1],Number(e)]))}updateMaterialState(e){this.material.updateState(u(u({},e),{},{size:e.size?[Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","size"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","sizeEnd"]))]:[0,0]})),e.texture&&(this.setTexture(this.material.uniforms,e.texture),this.material.needsUpdate=!0)}updateParticleState(e){if(this.positionSimRT&&this.velocitySimRT){var t,r;if(this.shouldReInitGPUCompute(e)&&this.init(Ioe(this.system.data)),void 0!==e.life&&(this.positionSimRT.material.uniforms.uMaxLifeTime.value=e.life),void 0!==e.speed&&(this.velocitySimRT.material.uniforms.uSpeed.value=Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/10),void 0!==e.collisionBounce&&(this.velocitySimRT.material.uniforms.uBounce.value=e.collisionBounce),void 0!==e.noiseStrength&&(this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),void 0!==e.noiseScale&&(this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"])),this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),void 0!==e.noiseSeed&&(this.velocitySimRT.material.uniforms.uNoiseSeed.value=e.noiseSeed),void 0!==e.randomMass&&(this.velocitySimRT.material.uniforms.uRandomMassFactor.value=e.randomMass),void 0!==(null===(t=e.renderMaterial)||void 0===t?void 0:t.size)){let t=this.shared.getVariable(e.renderMaterial.size[0],[this.uuid,"particles","size"]);this.velocitySimRT.material.uniforms.particleSize.value=Number(t)}if(void 0!==(null===(r=e.renderMaterial)||void 0===r?void 0:r.spriteRotation)&&(this.material.uniforms.uRotation.value=e.renderMaterial.spriteRotation[0],this.material.uniforms.uRotationEnd.value=e.renderMaterial.spriteRotation[1]),void 0!==e.shape){var n,i;let t=null!==(n=e.shape.size)&&void 0!==n?n:this.system.data.shape.size,r=[Number(this.shared.getVariable(t[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(t[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(t[2],[this.uuid,"particles","shape_size_2"]))],s=u(u({},Ioe(this.system.data).shape),{},{size:r});null===(i=this.emitterShape)||void 0===i||i.applyToShader(this.positionSimRT.material.uniforms,s)}if(void 0!==e.gravity&&(this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.velocitySimRT.material.uniforms.uGravity={value:this.worldGravity}),void 0!==e.direction){let t=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(t),this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis}void 0!==e.randomRotation&&(this.material.uniforms.uRandRotationFactor.value=e.randomRotation),void 0!==e.randomScale&&(this.material.uniforms.uRandScaleFactor.value=e.randomScale)}}updateForceFieldParameters(e){!this.velocitySimRT||(void 0!==e.forceIntensity&&(this.velocitySimRT.material.uniforms.uForceIntensity.value=e.forceIntensity),void 0!==e.forceDambing&&(this.velocitySimRT.material.uniforms.uForceDamping.value=e.forceDambing))}getDirectionAxis(e){let t=[Number(e[0])*$N.DEG2RAD,Number(e[1])*$N.DEG2RAD,Number(e[2])*$N.DEG2RAD],r=new mz(t[0],t[1],t[2],"XYZ");return this.directionAxis.set(0,1,0).applyEuler(r).normalize(),this.velocitySimRT&&(this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis),this.directionAxis}shouldReInitGPUCompute(e){let{birthRatePerSec:t,rootObjectType:r,colliderEntityId:n,shape:i,emitTimeDuration:s,emitTimeCycle:a,life:o,directionMode:l,noiseType:c}=e;return void 0!==t||void 0!==r||n||null===n||void 0!==a||void 0!==i||void 0!==o||void 0!==s||void 0!==l||void 0!==c}init(e){this.dispose(),this.particlesAmount=this.getMaxParticlesAmount({birthRatePerSecond:e.birthRatePerSec,particleMaxLifeTime:e.life,loopDuration:"infinity"===e.emitTimeCycle?0:e.emitTimeDuration}),this.particlesAmount>1e5&&(console.warn("The maximum number of particles is limited to ".concat(1e5,".")),this.particlesAmount=1e5),this.emitterShape=this.createShape(e.shape,this.particlesAmount);let t=setInterval((()=>{if(this.emitterShape){if(isNaN(this.emitterShape.positionsTexture.source.data.data[0]))return void this.init(e);clearInterval(t)}}),100);if(!this.emitterShape)return;let r=new xoe(this.emitterShape.textureSize,this.emitterShape.textureSize,this.renderer),n=this.updateSimulationDefinition(e),i=r.addVariable("uCurrentPosition",n+"\n// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU\nuniform sampler2D uOriginalPosition;\nuniform float uTime;\nuniform float uSpeed;     // update speed of the particles\nuniform vec3 uWorldOffset;    \nuniform vec4 uWorldQuaternion;\nuniform float uMaxLifeTime;\nuniform vec3 uEmitterSize;\nuniform float uFPSRatio;     // 1  for 60 FPS\n\nfloat random (vec2 st) {\n    return fract(sin(dot(st.xy,\n        vec2(12.9898,78.233)))*\n        43758.5453123);\n}\nvec3 applyQuaternionToVector( vec4 q, vec3 v ){\n    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );\n}\n\nvec3 applyForce(vec3 force, float mass) {\n    vec3 acceleration = force / mass;\n    \n    return acceleration;\n  }\n  \n\nvoid main() {\n    vec2 vUv = gl_FragCoord.xy / resolution.xy;\n    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;\n    float currentLife = texture2D( uCurrentPosition, vUv ).w;   // from 1 to 0\n    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).r;        // 1. = spawning, 0. = not spawning\n    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;          // 1. = active, 0. = not active\n    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;         // timeStart in seconds when the particle was emitted\n    vec3 originalPosition = ((texture2D( uOriginalPosition, vUv ).xyz) * uEmitterSize);\n    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;\n    float collisionFlag = texture2D( uCurrentVelocity, vUv ).w;             // 1. = collided, 0. = not collided\n    float lifeTime = uMaxLifeTime;\n\n    // Calculate the position adjustment based on collision\n    //     if (collisionFlag > .5) {  \n    float isColliding = step(0.5, collisionFlag); // 1.0 if collisionFlag > 0.5, otherwise 0.0\n    float bounceOffset = 3.0 * isColliding; // Becomes 3.0 if colliding, 0.0 otherwise\n    vec3 collisionAdjustedVelocity = velocity * (1.0 + bounceOffset);\n\n    // Update position based on collision or normal movement\n    vec3 fpsVelocity = velocity * min(uFPSRatio, 5.0);\n    position += mix(fpsVelocity, collisionAdjustedVelocity, isColliding);\n\n    // EMISSION RATE - BIRTH\n    // if (isSpawning == 1.0) {\n    // Better Approach to avoid If statement\n    vec3 newPosition = applyQuaternionToVector(uWorldQuaternion, originalPosition) + uWorldOffset;\n    originalPosition = mix(originalPosition, newPosition, isSpawning);\n    position = mix(position, originalPosition, isSpawning);;\n    timeStart = mix(timeStart, uTime, isSpawning);\n\n    // Calculate timeLeft for life normalization\n    float timeLeft = max(lifeTime - (uTime - timeStart), 0.0);\n    float life_Normalize = timeLeft / lifeTime;\n\n    // Use isActive to blend between the calculated color and black\n    vec4 activeColor = vec4(position, life_Normalize);\n    // if (isActive == 1.0) {\n    gl_FragColor = mix(vec4(0.0), activeColor, isActive);\n\n}\n",this.emitterShape.positionsTexture),s=r.addVariable("uCurrentVelocity",n+Aoe,this.emitterShape.directionsTexture),a=r.addVariable("uCurrentEmissionRate","\n// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU\n\nuniform sampler2D uIndex; // Texture with corresponding index\nuniform float uLastIndexEmitted; // Last emitted index\nuniform float uParticlesToEmit; // Number of particles to emit on that frame\nuniform float uTime;\n\nvoid main() {\n    vec2 vUv = gl_FragCoord.xy / resolution.xy;\n    float particleIndex = texture(uIndex, vUv).x;\n    float timeLeft = texture2D( uCurrentPosition, vUv ).w;\n    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;    // 1. = active, 0. = not active\n    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;\n\n\n    // ********** Detect Colision to Create a flag and use it in position **********\n    // We are doing this here, so\n\n    // ********** Emit Particles **********\n    // X = isSpawning 0.0 or 1.0\n    // Y = isActive 0.0 or 1.0\n    // Check if the vertex index is between the first value and the last value\n    // if (particleIndex >= uLastIndexEmitted && particleIndex < uLastIndexEmitted + uParticlesToEmit) {\n    //     // Emit a particle by writing 1 to the red channel of the color output\n    //     // r: 1. == emit the particle\n    //     // g: 1. == particle is now active\n    //     timeStart = uTime;\n    //     gl_FragColor = vec4(1.0, 1.0, timeStart, 1.0);\n    // } else {\n    //     // The Particle is either already emitted or not in the range of the particles to emit\n    //     // Do not emit a particle by writing 0 to the red channel of the color output        \n    //     gl_FragColor = vec4(0.0, isActive, timeStart, 1.0);\n    // }\n    // Determine if the particle is within the emission range\n    float emitLowerBound = step(uLastIndexEmitted, particleIndex);\n    float emitUpperBound = step(particleIndex, uLastIndexEmitted + uParticlesToEmit - 1.0);\n    float emitParticle = emitLowerBound * emitUpperBound; // 1.0 if in range, 0.0 otherwise\n\n    // Set timeStart and color\n    timeStart = mix(timeStart, uTime, emitParticle);\n    gl_FragColor = vec4(emitParticle, mix(isActive, 1.0, emitParticle), timeStart, 1.0);\n\n\n}\n",function(e){let t=new Float32Array(4*e*e);for(let n=0;n<e*e;n++)t[4*n]=0,t[4*n+1]=0,t[4*n+2]=0,t[4*n+3]=0;let r=new _V(t,e,e,dN,cN);return r.needsUpdate=!0,r}(this.emitterShape.textureSize));r.setVariableDependencies(i,[i,s,a]),r.setVariableDependencies(s,[i,s,a]),r.setVariableDependencies(a,[i,s,a]);let o=function(e){let{size:t}=e,r=new Float32Array(4*t*t);for(let i=0;i<t*t;i++)r[4*i]=i,r[4*i+1]=0,r[4*i+2]=0,r[4*i+3]=0;let n=new _V(r,t,t,dN,cN);return n.needsUpdate=!0,n}({size:this.emitterShape.textureSize}),l={uOriginalPosition:{value:this.emitterShape.positionsTexture},uWorldOffset:{value:new PB(0,0,0)},uWorldQuaternion:{value:new CB(0,0,0,1)},uTime:{value:0},uFPSRatio:{value:1},uMaxLifeTime:{value:e.life},uEmitterSize:{value:new PB(Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"])))},particleSize:{value:0}};i.material.uniforms=l;let c=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(c),this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"]));let h=e.colliderEntityId&&this.system.getColliderData(e.colliderEntityId),d={uOriginalPosition:{value:this.emitterShape.positionsTexture},uDirections:{value:this.emitterShape.directionsTexture},uDirectionsAxis:{value:this.directionAxis},uWorldQuaternion:{value:new CB(0,0,0,1)},uColliderPos:{value:new PB(0,0,0)},uColliderSize:{value:new PB(0,0,0)},uForceIntensity:{value:h?h.forceIntensity:0},uForceDamping:{value:h?h.forceDambing:0},uColliderQuaternion:{value:new CB(0,0,0,1)},uColliderQuaternionInvert:{value:new CB(0,0,0,1)},particleSize:{value:0},uGravity:{value:this.worldGravity},uNoiseStrength:{value:this.noiseStrength},uNoiseScale:{value:this.noiseScale},uNoiseSeed:{value:e.noiseSeed},uRandomMassFactor:{value:e.randomMass},uBounce:{value:e.collisionBounce},uSpeed:{value:Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/10}};s.material.uniforms=d;let f={uIndex:{value:o},uTime:{value:0},uLastIndexEmitted:{value:0},uParticlesToEmit:{value:0}};a.material.uniforms=f;let p=[Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"]))],m=u(u({},Ioe(this.system.data).shape),{},{size:p});this.emitterShape.applyToShader(i.material.uniforms,m),r.init(),this.gpuCompute=r,this.positionSimRT=i,this.velocitySimRT=s,this.emissionRateSimRT=a,this.rootObject=this.createPrimaryEmitter(this.emitterShape.textureSize),this.add(this.rootObject),this.material.needsUpdate=!0}getDirectionFromVariable(e){return[Number(this.shared.getVariable(e[0],[this.uuid,"particles","direction_x"])),Number(this.shared.getVariable(e[1],[this.uuid,"particles","direction_y"])),Number(this.shared.getVariable(e[2],[this.uuid,"particles","direction_z"]))]}updateSimulationDefinition(e){if(this.simFeaturesDefinition.USE_COLLIDER=!1,this.simFeaturesDefinition.USE_ATTRACTOR=!1,this.simFeaturesDefinition.USE_VORTEX=!1,this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!1,this.simFeaturesDefinition.USE_BOX_COLLIDER=!1,this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!1,this.simFeaturesDefinition.USE_NORMALS=!1,this.simFeaturesDefinition.USE_CURL_NOISE=!1,this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!1,this.simFeaturesDefinition.USE_FBM_NOISE=!1,e.colliderEntityId&&this.system.colliderEntities.length>0){let t=this.system.getColliderData(e.colliderEntityId);switch(null===t||void 0===t?void 0:t.forceType){case"attractor":this.simFeaturesDefinition.USE_ATTRACTOR=!0;break;case"collider":this.simFeaturesDefinition.USE_COLLIDER=!0;break;case"vortex":this.simFeaturesDefinition.USE_VORTEX=!0}let r=null===t||void 0===t?void 0:t.colliderType;"sphere"===r&&(this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!0),"box"===r&&(this.simFeaturesDefinition.USE_BOX_COLLIDER=!0),"helper"===(null===t||void 0===t?void 0:t.forceRange)&&(this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!0)}"normals"===e.directionMode&&(this.simFeaturesDefinition.USE_NORMALS=!0),"curl"===e.noiseType&&(this.simFeaturesDefinition.USE_CURL_NOISE=!0),"simplex"===e.noiseType&&(this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!0),"fbm"===e.noiseType&&(this.simFeaturesDefinition.USE_FBM_NOISE=!0);let t="";for(let[r,n]of Object.entries(this.simFeaturesDefinition))n&&(t+="#define ".concat(r,"\n"));return t}createShape(e,t){this.emitterShape&&this.emitterShape.dispose();let r=new PB(Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.size[2],[this.uuid,"particles","shape_size_2"])));if("MeshEmitterShape"===e.type){let n=null;return this.system.context.scene.traverseEntity((t=>{t.uuid===e.fromMeshId&&(n=t)})),n?new Doe(r,t,e.type,n):new Doe(r,t,"SphereEmitterShape")}return new Doe(r,t,e.type)}createPrimaryEmitter(e){let t,r=e*e;return t=new OV(new UF(1,1,1),this.material,r),this.updateGeometryAttributes(t,e),this.material.needsUpdate=!0,t.onBeforeRender=()=>{this.applyWorldSpace()},t}getMaxParticlesAmount(e){let{birthRatePerSecond:t,particleMaxLifeTime:r,loopDuration:n=0}=e;return Math.ceil(t*(r+n))}dispose(){var e,t;!this.gpuCompute||(null!==(e=this.rootObject)&&void 0!==e&&null!==(e=e.parent)&&void 0!==e&&e.remove(this.rootObject),this.gpuCompute.dispose(),this.material.nodeMaterialDispose(),null===(t=this.emitterShape)||void 0===t||t.dispose())}GoEmitSomeParticles(e,t){let r=e-this.lastEmitTime,n=1/t;if(r>=n){let t=Math.max(1,Math.floor(r/n));return this.lastEmitTime=e,this.emittedParticlesAmount+t>this.particlesAmount&&(this.emittedParticlesAmount=0),this.emittedParticlesAmount+=t,t}return 0}checkIfAllParticlesAreDead(){return this.lastEmitTime+this.system.data.life+1<this.globalTime}reset(){this.hasBeenReset=!0,this.lastEmitTime=0,this.emittedParticlesAmount=0,this.gpuCompute&&this.init(Ioe(this.system.data))}startEmitting(e){this.isEmitting=!0,this.hasBeenReset=!1,this.lastEmitTime=e}stopEmitting(){this.isEmitting=!1}},Roe=class extends z9{constructor(e,t,r){super(e,t),this.type="ParticleSystem",this.geometry=new iF,this.actualTime=0,this.currentLoopTime=0,this.started=!1,this.stopped=!1,this.timeoutId=void 0,this.isFrozen=!1,this.isIdle=!0,this.emitter=null,this.colliderEntities=[],this.renderer=null,this.isPreWarm=!1,this._hasOnAfterRenderBeenCalled=!1,this.onAfterRender=e=>{this._hasOnAfterRenderBeenCalled||(this._hasOnAfterRenderBeenCalled=!0,this.init(e))},this.context=r,this.data=u(u({},t),Ioe(t)),this.geometry.setAttribute("position",new Qz([],3)),this.material=new Wz({colorWrite:!1}),this.frustumCulled=!1}init(e){this.renderer=e,this.emitter=new Ooe(e,this),this.add(this.emitter),this.updateParticleState(this.data)}update(e){if(!this.isReady||!this.started||this.isFrozen||this.isIdle)return;this.actualTime+=e,this.stopped||(this.currentLoopTime+=e);let t="one_time"===this.data.emitTimeCycle;if(("loop"===this.data.emitTimeCycle||t)&&this.currentLoopTime>1e3*this.data.emitTimeDuration&&(this.stopped||(this.stop(),t||this.start(1e3*this.data.emitTimeDelay))),this.emitter&&this.started){let t=this.actualTime/1e3;this.emitter.update(t,e)}this.scale.set(1,1,1),this.updateMatrix()}isReady(){return!!this.emitter}hasCollider(e){return this.colliderEntities.some((t=>t.identity===e))}getColliderData(e){let t=this.colliderEntities.find((t=>t.identity===e));return t?t.data:null}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),NJ(e.path,["renderMaterial"])&&this.updateParticleState({renderMaterial:u(u({},this.data.renderMaterial),oJ.drop(e,1).props)}),NJ(e.path,["shape"])&&this.updateParticleState({shape:u(u({},this.data.shape),oJ.drop(e,1).props)})}updateState(e,t){super.updateState(e,t),this.updateParticleState(e)}updateParticleState(e){if(this.emitter){if(void 0!==e.colliderEntityId&&null!==e.colliderEntityId){let t=this.context.scene.find(e.colliderEntityId);this.colliderEntities=t?[t]:[]}null===e.colliderEntityId&&(this.colliderEntities=[]),this.emitter.updateState(e),e.emitTimeCycle&&this.started&&this.start()}}updateFromColliderEntity(e){!this.emitter||(this.emitter.updateForceFieldParameters(e),this.stop(),this.start())}start(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.currentLoopTime=0,t?this.timeoutId=window.setTimeout((()=>{this.start(0)}),t):(this.started=!0,this.stopped=!1,this.isFrozen=!1,null===(e=this.emitter)||void 0===e||e.startEmitting(this.actualTime/1e3))}froze(){this.isFrozen=!0}unFroze(){this.isFrozen=!1}stop(){var e;this.stopped=!0,this.currentLoopTime=0,null!==(e=this.emitter)&&void 0!==e&&e.stopEmitting(),clearTimeout(this.timeoutId)}reset(){var e;this.started=!1,this.stopped=!1,null===(e=this.emitter)||void 0===e||e.reset()}wakeUp(){this.isIdle=!1}sleep(){this.isIdle=!0,this.reset()}};var Loe=function(){try{let e=window.location.href;if(e.includes("reducesubdiv=")){let t=e.indexOf("reducesubdiv=")+13;return parseInt(e.slice(t,t+1))}}catch(e){}}();function Noe(e,t,r){return console.assert(void 0!==t.type),"Mesh"===t.type?function(e,t,r){var n,i;let s;return void 0!==Loe&&(null!==(n=null===t||void 0===t||null===(i=t.geometry)||void 0===i?void 0:i.subdivisions)&&void 0!==n?n:0)>Loe&&(console.log("reducing subdivisions",t.name,t.geometry.subdivisions),t.geometry.subdivisions=Loe),"TextGeometry"===t.geometry.type?new one(e,t,r):"InputGeometry"===t.geometry.type?new poe(e,t,r):(s="SubdivGeometry"===t.geometry.type?new Bre(e,t,r):"PathGeometry"===t.geometry.type?new foe(e,t,r):"VectorGeometry"===t.geometry.type?new doe(e,t,r):"BooleanGeometry"===t.geometry.type?new Wne(e,t,r):"ShapeBlendGeometry"===t.geometry.type?new Woe(e,t,r):"UIGeometry"===t.geometry.type?new woe(e,t,r):new Dre(e,t,r),s)}(e,t,r):"Empty"===t.type?new eie(e,t):"Particle"===t.type?new Roe(e,t,r):"ParticleCollider"===t.type?new tie(e,t,r):"Splat"===t.type?new eie(e,t):"Bone"===t.type?new boe(e,t):"Page"===t.type?new uoe(e,t,r):"PointLight"===t.type?new hoe(e,t,r):"SpotLight"===t.type?new uae(e,t,r):"DirectionalLight"===t.type?new aae(e,t,r):"Component"===t.type||"Instance"===t.type?new moe(e,t,r):Z0.is(t.type)?new Fne(e,t):(console.error(t),new eie(e,t))}r5.createEntity=Noe,r5.changeEntityProptotype=function(e,t,r){let n=Noe(e.identity,t,r),i=e.children,s=e.attachedPaths,a=e.parent,o=e.component,l=e.instances,c=e.overrideData,u=e.uuid,h=e.stateSelection;e.dispose();for(let d of Object.keys(e))delete e[d];Object.setPrototypeOf(e,Object.getPrototypeOf(n));for(let d of Object.keys(n))e[d]=n[d];e.children=[...e.children,...i],e.attachedPaths=s,e.parent=a,e.component=o,e.instances=l,e.uuid=u,e.overrideData=c,e.updateState(e.data,r),h&&e.changeSelectedState(h,r),e.resetBBoxNeedsUpdate()},r5.Cloner=wne;var Boe=new iF;Boe.setAttribute("position",new Xz(new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),3));var zoe=class extends KH{constructor(e){super(u(u({},e),{},{depthTest:!1,depthWrite:!1,glslVersion:BN,vertexShader:"\n\t\t\t\tprecision highp float;\n\t\t\t\tin vec3 position;\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_Position = vec4(position, 1);\n\t\t\t\t}\n\t\t\t"}))}customProgramCacheKey(){return""}};var Foe=new AF,joe=24,Uoe=96,Voe={shapeInput:()=>"\n\t\t\tconst float posRowCoord = ".concat(.1,";  // vec4: px py pz opType\n\t\t\tconst float quatRowCoord = ").concat(.3,";  // vec4: qx qy qz qw\n\t\t\tconst float param1RowCoord = ").concat(.5,";// vec4: type param1 param2 param3\n\t\t\tconst float param2RowCoord = ").concat(.7,";// vec4: blendRange roundness scale param4\n\t\t\tconst float colorRowCoord = ").concat(.9,"; // vec4: r g b a\n\t\t\tuniform sampler2D shapesDataTexture;\n\t\t\tvec4 shapePos(float iin) { \n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, posRowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tvec4 shapeQuat(float iin) {\n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, quatRowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tvec4 shapeParams1(float iin) {\n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, param1RowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tvec4 shapeParams2(float iin) {\n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, param2RowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tvec4 shapeColor(float iin) {\n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, colorRowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t"),getxyzi:"\n\t\t\t// this code must complement lookup\n\t\t\tfloat xi = mod(gl_FragCoord.x - 0.5, VOXEL_RESOLUTION);\n\t\t\tfloat yi = mod(gl_FragCoord.y - 0.5, VOXEL_RESOLUTION);\n\t\t\tfloat zi = floor((gl_FragCoord.x - 0.5) * INV_VOXEL_RESOLUTION) + floor((gl_FragCoord.y - 0.5) * INV_VOXEL_RESOLUTION) * Z_LAYERS_PER_ROW;\n\t\t",lookup:"\n\t\t\tuniform sampler2D potentialPassTexture;\n\t\t\tuniform sampler2D voxelPassTexture; // includes normal (in xyz) and key (in w)\n\t\t\t\n\t\t\t// box or marching cube lookup value in value texture, integer box coord inputs\n\t\t\t// this code must complement codebits.getxyzi\n\t\t\tvec4 look(float xi, float yi, float zi, sampler2D rt) {// range 0 .. numv etc\n\t\t\t\tvec2 uv = vec2(\n\t\t\t\t\tmod(zi, Z_LAYERS_PER_ROW) + (xi + 0.5) / VOXEL_RESOLUTION,\n\t\t\t\t\tfloor(zi / Z_LAYERS_PER_ROW) + (yi + 0.5) / VOXEL_RESOLUTION\n\t\t\t\t); \n\t\t\t\tuv /= Z_LAYERS_PER_ROW;\n\t\t\t\treturn texture(rt, uv);\n\t\t\t}\n\t\t",getpart:"\n\t\t\tfloat getpart(inout float a, float b) {\n\t\t\t\tfloat t = floor(a/b);\n\t\t\t\tfloat r = a - t*b;\n\t\t\t\ta = t;\n\t\t\t\treturn r;\n\t\t\t}\n\t\t",triTable:new Float32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,1,1,8,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,10,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,9,9,2,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,2,8,10,2,8,9,10,-1,-1,-1,-1,-1,-1,-1,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,0,0,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,11,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,1,11,9,1,11,8,9,-1,-1,-1,-1,-1,-1,-1,1,10,3,3,10,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,10,0,10,8,0,10,11,8,-1,-1,-1,-1,-1,-1,-1,0,9,3,9,11,3,9,10,11,-1,-1,-1,-1,-1,-1,-1,10,8,9,11,8,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,4,4,3,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,7,4,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,4,1,7,4,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,2,1,7,4,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,4,3,4,0,3,10,2,1,-1,-1,-1,-1,-1,-1,-1,10,2,9,2,0,9,7,4,8,-1,-1,-1,-1,-1,-1,-1,9,10,2,7,9,2,3,7,2,4,9,7,-1,-1,-1,-1,7,4,8,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,4,11,4,2,11,4,0,2,-1,-1,-1,-1,-1,-1,-1,1,0,9,7,4,8,11,3,2,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,9,2,11,9,1,2,9,-1,-1,-1,-1,1,10,3,10,11,3,4,8,7,-1,-1,-1,-1,-1,-1,-1,10,11,1,11,4,1,4,0,1,4,11,7,-1,-1,-1,-1,8,7,4,11,0,9,10,11,9,3,0,11,-1,-1,-1,-1,11,7,4,9,11,4,10,11,9,-1,-1,-1,-1,-1,-1,-1,4,5,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,9,3,8,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,0,0,5,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,8,5,3,8,5,1,3,-1,-1,-1,-1,-1,-1,-1,10,2,1,4,5,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,3,10,2,1,5,9,4,-1,-1,-1,-1,-1,-1,-1,10,2,5,2,4,5,2,0,4,-1,-1,-1,-1,-1,-1,-1,5,10,2,5,2,3,4,5,3,8,4,3,-1,-1,-1,-1,4,5,9,11,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,0,11,8,0,5,9,4,-1,-1,-1,-1,-1,-1,-1,4,5,0,5,1,0,11,3,2,-1,-1,-1,-1,-1,-1,-1,5,1,2,8,5,2,11,8,2,5,8,4,-1,-1,-1,-1,11,3,10,3,1,10,4,5,9,-1,-1,-1,-1,-1,-1,-1,5,9,4,1,8,0,1,10,8,10,11,8,-1,-1,-1,-1,0,4,5,11,0,5,10,11,5,3,0,11,-1,-1,-1,-1,8,4,5,10,8,5,11,8,10,-1,-1,-1,-1,-1,-1,-1,8,7,9,9,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,9,3,5,9,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,7,0,7,1,0,7,5,1,-1,-1,-1,-1,-1,-1,-1,3,5,1,7,5,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,7,9,7,5,9,2,1,10,-1,-1,-1,-1,-1,-1,-1,2,1,10,0,5,9,0,3,5,3,7,5,-1,-1,-1,-1,2,0,8,5,2,8,7,5,8,2,5,10,-1,-1,-1,-1,5,10,2,3,5,2,7,5,3,-1,-1,-1,-1,-1,-1,-1,5,9,7,9,8,7,2,11,3,-1,-1,-1,-1,-1,-1,-1,7,5,9,2,7,9,0,2,9,11,7,2,-1,-1,-1,-1,11,3,2,8,1,0,8,7,1,7,5,1,-1,-1,-1,-1,1,2,11,7,1,11,5,1,7,-1,-1,-1,-1,-1,-1,-1,8,5,9,7,5,8,3,1,10,11,3,10,-1,-1,-1,-1,0,7,5,9,0,5,0,11,7,10,0,1,0,10,11,-1,0,10,11,3,0,11,0,5,10,7,0,8,0,7,5,-1,5,10,11,5,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,6,10,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,0,9,6,10,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,1,8,9,1,6,10,5,-1,-1,-1,-1,-1,-1,-1,5,6,1,1,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,6,1,6,2,1,8,0,3,-1,-1,-1,-1,-1,-1,-1,5,6,9,6,0,9,6,2,0,-1,-1,-1,-1,-1,-1,-1,8,9,5,2,8,5,6,2,5,8,2,3,-1,-1,-1,-1,11,3,2,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,11,0,2,11,5,6,10,-1,-1,-1,-1,-1,-1,-1,9,1,0,11,3,2,6,10,5,-1,-1,-1,-1,-1,-1,-1,6,10,5,2,9,1,2,11,9,11,8,9,-1,-1,-1,-1,11,3,6,3,5,6,3,1,5,-1,-1,-1,-1,-1,-1,-1,11,8,0,5,11,0,1,5,0,6,11,5,-1,-1,-1,-1,6,11,3,6,3,0,5,6,0,9,5,0,-1,-1,-1,-1,9,5,6,11,9,6,8,9,11,-1,-1,-1,-1,-1,-1,-1,6,10,5,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,4,3,7,4,10,5,6,-1,-1,-1,-1,-1,-1,-1,0,9,1,6,10,5,7,4,8,-1,-1,-1,-1,-1,-1,-1,5,6,10,7,9,1,3,7,1,4,9,7,-1,-1,-1,-1,2,1,6,1,5,6,8,7,4,-1,-1,-1,-1,-1,-1,-1,5,2,1,6,2,5,4,0,3,7,4,3,-1,-1,-1,-1,7,4,8,5,0,9,5,6,0,6,2,0,-1,-1,-1,-1,9,3,7,4,9,7,9,2,3,6,9,5,9,6,2,-1,2,11,3,4,8,7,5,6,10,-1,-1,-1,-1,-1,-1,-1,6,10,5,2,7,4,0,2,4,11,7,2,-1,-1,-1,-1,9,1,0,8,7,4,11,3,2,6,10,5,-1,-1,-1,-1,1,2,9,2,11,9,11,4,9,4,11,7,6,10,5,-1,7,4,8,5,11,3,1,5,3,6,11,5,-1,-1,-1,-1,11,1,5,6,11,5,11,0,1,4,11,7,11,4,0,-1,9,5,0,5,6,0,6,3,0,3,6,11,7,4,8,-1,9,5,6,11,9,6,9,7,4,9,11,7,-1,-1,-1,-1,9,4,10,10,4,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,10,4,10,9,4,3,8,0,-1,-1,-1,-1,-1,-1,-1,1,0,10,0,6,10,0,4,6,-1,-1,-1,-1,-1,-1,-1,1,3,8,6,1,8,4,6,8,10,1,6,-1,-1,-1,-1,9,4,1,4,2,1,4,6,2,-1,-1,-1,-1,-1,-1,-1,8,0,3,9,2,1,9,4,2,4,6,2,-1,-1,-1,-1,4,2,0,6,2,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,4,2,8,6,2,4,-1,-1,-1,-1,-1,-1,-1,9,4,10,4,6,10,3,2,11,-1,-1,-1,-1,-1,-1,-1,2,8,0,11,8,2,10,9,4,6,10,4,-1,-1,-1,-1,2,11,3,6,1,0,4,6,0,10,1,6,-1,-1,-1,-1,1,4,6,10,1,6,1,8,4,11,1,2,1,11,8,-1,4,6,9,6,3,9,3,1,9,3,6,11,-1,-1,-1,-1,1,11,8,0,1,8,1,6,11,4,1,9,1,4,6,-1,6,11,3,0,6,3,4,6,0,-1,-1,-1,-1,-1,-1,-1,8,4,6,8,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,10,7,10,8,7,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,7,0,7,10,0,10,9,0,10,7,6,-1,-1,-1,-1,7,6,10,7,10,1,8,7,1,0,8,1,-1,-1,-1,-1,7,6,10,1,7,10,3,7,1,-1,-1,-1,-1,-1,-1,-1,6,2,1,8,6,1,9,8,1,7,6,8,-1,-1,-1,-1,9,6,2,1,9,2,9,7,6,3,9,0,9,3,7,-1,0,8,7,6,0,7,2,0,6,-1,-1,-1,-1,-1,-1,-1,2,3,7,2,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,3,2,8,6,10,9,8,10,7,6,8,-1,-1,-1,-1,7,0,2,11,7,2,7,9,0,10,7,6,7,10,9,-1,0,8,1,8,7,1,7,10,1,10,7,6,11,3,2,-1,1,2,11,7,1,11,1,6,10,1,7,6,-1,-1,-1,-1,6,9,8,7,6,8,6,1,9,3,6,11,6,3,1,-1,1,9,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,6,0,7,0,11,3,0,6,11,-1,-1,-1,-1,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,3,6,7,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,6,7,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,8,1,3,8,6,7,11,-1,-1,-1,-1,-1,-1,-1,2,1,10,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,1,8,0,3,7,11,6,-1,-1,-1,-1,-1,-1,-1,0,9,2,9,10,2,7,11,6,-1,-1,-1,-1,-1,-1,-1,7,11,6,3,10,2,3,8,10,8,9,10,-1,-1,-1,-1,3,2,7,7,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,7,0,6,7,0,2,6,-1,-1,-1,-1,-1,-1,-1,6,7,2,7,3,2,9,1,0,-1,-1,-1,-1,-1,-1,-1,2,6,1,6,8,1,8,9,1,6,7,8,-1,-1,-1,-1,6,7,10,7,1,10,7,3,1,-1,-1,-1,-1,-1,-1,-1,6,7,10,10,7,1,7,8,1,8,0,1,-1,-1,-1,-1,7,3,0,10,7,0,9,10,0,7,10,6,-1,-1,-1,-1,10,6,7,8,10,7,9,10,8,-1,-1,-1,-1,-1,-1,-1,4,8,6,6,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,6,3,6,0,3,6,4,0,-1,-1,-1,-1,-1,-1,-1,11,6,8,6,4,8,1,0,9,-1,-1,-1,-1,-1,-1,-1,6,4,9,3,6,9,1,3,9,6,3,11,-1,-1,-1,-1,4,8,6,8,11,6,1,10,2,-1,-1,-1,-1,-1,-1,-1,10,2,1,11,0,3,11,6,0,6,4,0,-1,-1,-1,-1,8,11,4,11,6,4,9,2,0,9,10,2,-1,-1,-1,-1,3,9,10,2,3,10,3,4,9,6,3,11,3,6,4,-1,3,2,8,2,4,8,2,6,4,-1,-1,-1,-1,-1,-1,-1,2,4,0,2,6,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,4,3,2,6,4,2,8,3,4,-1,-1,-1,-1,4,9,1,2,4,1,6,4,2,-1,-1,-1,-1,-1,-1,-1,3,1,8,1,6,8,6,4,8,1,10,6,-1,-1,-1,-1,0,1,10,6,0,10,4,0,6,-1,-1,-1,-1,-1,-1,-1,3,6,4,8,3,4,3,10,6,9,3,0,3,9,10,-1,4,9,10,4,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,9,4,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,5,9,4,6,7,11,-1,-1,-1,-1,-1,-1,-1,1,0,5,0,4,5,11,6,7,-1,-1,-1,-1,-1,-1,-1,6,7,11,4,3,8,4,5,3,5,1,3,-1,-1,-1,-1,4,5,9,2,1,10,11,6,7,-1,-1,-1,-1,-1,-1,-1,7,11,6,10,2,1,3,8,0,5,9,4,-1,-1,-1,-1,11,6,7,10,4,5,10,2,4,2,0,4,-1,-1,-1,-1,8,4,3,4,5,3,5,2,3,2,5,10,6,7,11,-1,3,2,7,2,6,7,9,4,5,-1,-1,-1,-1,-1,-1,-1,4,5,9,6,8,0,2,6,0,7,8,6,-1,-1,-1,-1,2,6,3,6,7,3,0,5,1,0,4,5,-1,-1,-1,-1,8,2,6,7,8,6,8,1,2,5,8,4,8,5,1,-1,4,5,9,6,1,10,6,7,1,7,3,1,-1,-1,-1,-1,10,6,1,6,7,1,7,0,1,0,7,8,4,5,9,-1,10,0,4,5,10,4,10,3,0,7,10,6,10,7,3,-1,10,6,7,8,10,7,10,4,5,10,8,4,-1,-1,-1,-1,5,9,6,9,11,6,9,8,11,-1,-1,-1,-1,-1,-1,-1,11,6,3,3,6,0,6,5,0,5,9,0,-1,-1,-1,-1,8,11,0,11,5,0,5,1,0,11,6,5,-1,-1,-1,-1,3,11,6,5,3,6,1,3,5,-1,-1,-1,-1,-1,-1,-1,10,2,1,11,5,9,8,11,9,6,5,11,-1,-1,-1,-1,3,11,0,11,6,0,6,9,0,9,6,5,10,2,1,-1,5,8,11,6,5,11,5,0,8,2,5,10,5,2,0,-1,3,11,6,5,3,6,3,10,2,3,5,10,-1,-1,-1,-1,9,8,5,8,2,5,2,6,5,2,8,3,-1,-1,-1,-1,6,5,9,0,6,9,2,6,0,-1,-1,-1,-1,-1,-1,-1,8,5,1,0,8,1,8,6,5,2,8,3,8,2,6,-1,6,5,1,6,1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,3,1,10,6,1,6,8,3,9,6,5,6,9,8,-1,0,1,10,6,0,10,0,5,9,0,6,5,-1,-1,-1,-1,8,3,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,5,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,11,11,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,11,5,7,11,0,3,8,-1,-1,-1,-1,-1,-1,-1,7,11,5,11,10,5,0,9,1,-1,-1,-1,-1,-1,-1,-1,5,7,10,7,11,10,1,8,9,1,3,8,-1,-1,-1,-1,2,1,11,1,7,11,1,5,7,-1,-1,-1,-1,-1,-1,-1,3,8,0,7,2,1,5,7,1,11,2,7,-1,-1,-1,-1,5,7,9,7,2,9,2,0,9,7,11,2,-1,-1,-1,-1,2,5,7,11,2,7,2,9,5,8,2,3,2,8,9,-1,10,5,2,5,3,2,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,2,8,2,5,8,5,7,8,5,2,10,-1,-1,-1,-1,1,0,9,3,10,5,7,3,5,2,10,3,-1,-1,-1,-1,2,8,9,1,2,9,2,7,8,5,2,10,2,5,7,-1,5,3,1,5,7,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,1,7,0,5,7,1,-1,-1,-1,-1,-1,-1,-1,3,0,9,5,3,9,7,3,5,-1,-1,-1,-1,-1,-1,-1,7,8,9,7,9,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,5,8,10,5,8,11,10,-1,-1,-1,-1,-1,-1,-1,4,0,5,0,11,5,11,10,5,0,3,11,-1,-1,-1,-1,9,1,0,10,4,8,11,10,8,5,4,10,-1,-1,-1,-1,4,11,10,5,4,10,4,3,11,1,4,9,4,1,3,-1,1,5,2,5,8,2,8,11,2,8,5,4,-1,-1,-1,-1,11,4,0,3,11,0,11,5,4,1,11,2,11,1,5,-1,5,2,0,9,5,0,5,11,2,8,5,4,5,8,11,-1,5,4,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,2,2,5,3,5,4,3,4,8,3,-1,-1,-1,-1,2,10,5,4,2,5,0,2,4,-1,-1,-1,-1,-1,-1,-1,2,10,3,10,5,3,5,8,3,8,5,4,9,1,0,-1,2,10,5,4,2,5,2,9,1,2,4,9,-1,-1,-1,-1,5,4,8,3,5,8,1,5,3,-1,-1,-1,-1,-1,-1,-1,5,4,0,5,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,4,8,3,5,8,5,0,9,5,3,0,-1,-1,-1,-1,5,4,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,11,4,11,9,4,11,10,9,-1,-1,-1,-1,-1,-1,-1,3,8,0,7,9,4,7,11,9,11,10,9,-1,-1,-1,-1,11,10,1,4,11,1,0,4,1,11,4,7,-1,-1,-1,-1,4,1,3,8,4,3,4,10,1,11,4,7,4,11,10,-1,7,11,4,4,11,9,11,2,9,2,1,9,-1,-1,-1,-1,4,7,9,7,11,9,11,1,9,1,11,2,3,8,0,-1,4,7,11,2,4,11,0,4,2,-1,-1,-1,-1,-1,-1,-1,4,7,11,2,4,11,4,3,8,4,2,3,-1,-1,-1,-1,10,9,2,9,7,2,7,3,2,9,4,7,-1,-1,-1,-1,7,10,9,4,7,9,7,2,10,0,7,8,7,0,2,-1,10,7,3,2,10,3,10,4,7,0,10,1,10,0,4,-1,2,10,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,4,7,1,4,3,1,7,-1,-1,-1,-1,-1,-1,-1,1,9,4,7,1,4,1,8,0,1,7,8,-1,-1,-1,-1,3,0,4,3,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,10,9,8,11,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,3,11,9,3,10,9,11,-1,-1,-1,-1,-1,-1,-1,10,1,0,8,10,0,11,10,8,-1,-1,-1,-1,-1,-1,-1,10,1,3,10,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,2,1,9,11,1,8,11,9,-1,-1,-1,-1,-1,-1,-1,9,0,3,11,9,3,9,2,1,9,11,2,-1,-1,-1,-1,11,2,0,11,0,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,2,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,10,8,2,9,8,10,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,10,8,2,8,1,0,8,10,1,-1,-1,-1,-1,2,10,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),numTrisTable:new Float32Array([0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,2,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,2,3,4,4,3,3,4,4,3,4,5,5,2,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,4,2,3,3,4,3,4,2,3,3,4,4,5,4,5,3,2,3,4,4,3,4,5,3,2,4,5,5,4,5,2,4,1,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,4,3,4,4,5,3,2,4,3,4,3,5,2,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,4,3,4,4,3,4,5,5,4,4,3,5,2,5,4,2,1,2,3,3,4,3,4,4,5,3,4,4,5,2,3,3,2,3,4,4,5,4,5,5,2,4,3,5,4,3,2,4,1,3,4,4,5,4,5,3,4,4,5,5,2,3,4,2,1,2,3,3,2,3,4,2,1,3,2,4,1,2,1,1,0])},Hoe=class extends Dre{constructor(e,t,r){super(e,t,r),this.data=t,this.needsRebuild=!0,this.customDepthMaterialNeedsUpdate=!1,this._npart=-1,this.spatialn=1,this.drawRangeNeedsForceUpdate=!0,this._resolutionLevel=-1,this.resolution=64,this.spatialDivisions=25,this.zLayersPerRow=8,this.basePyramidSize=512,this.pyramidTexture1Width=341,this.pyramidTexture1Height=256,this.pyramidTexture2Width=170,this.pyramidTexture2Height=128,this.numLevels=9,this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512],this.bboxSize=0,this.bboxOffset=0,this.shapesDataTexture={value:void 0},this.spatialscene=new yV,this.potentialPassScene=new yV,this.voxelPassScene=new yV,this._spatialPassRenderTargets=[],this._potentialPassRenderTargets=[],this._voxelPassRenderTargets=[],this._pyramidRenderTargets=[],this.geometry=new iF,this.geometry.drawRange.count=0,this.spatialPassUniforms={span:{value:-1},shapesDataTexture:this.shapesDataTexture,npart:{value:this.npart},spatialn:{value:this.spatialn}},this.spatialMesh=new yF(Boe,this.spatialPassMaterial()),this.spatialMesh.frustumCulled=!1,this.spatialscene.add(this.spatialMesh);let n=new _V(Voe.triTable,16,256,mN,cN);n.needsUpdate=!0;let i=new _V(Voe.numTrisTable,256,1,mN,cN);i.needsUpdate=!0,this.voxelPassUniforms={potentialPassTexture:{value:void 0},numTrisTable:{value:i}},this.voxelMesh=new yF(Boe,this.voxelPassMaterial()),this.voxelMesh.frustumCulled=!1,this.voxelPassScene.add(this.voxelMesh),this.potentialPassUniforms={shapesDataTexture:this.shapesDataTexture,spatialPassTexture:{value:void 0},npart:{value:this.npart},spatialn:{value:this.spatialn}},this.potentialMesh=new yF(Boe,this.potentialPassMaterial()),this.potentialMesh.frustumCulled=!1,this.potentialPassScene.add(this.potentialMesh),this.marchPassUniforms={triTable:{value:n},potentialPassTexture:{value:void 0},voxelPassTexture:{value:void 0},pyramidTexture1:{value:void 0},pyramidTexture1Size:{value:void 0},pyramidTexture2:{value:void 0},pyramidTexture2Size:{value:void 0}},this.frustumCulled=!1,this.onBeforeShadowPass=e=>{if($oe.call(this),0===this.npart)return void(this.geometry.drawRange.count=0);let t=this.material.root;if(t.shadersPatchedForShapeBlend){if(this.customDepthMaterialNeedsUpdate){this.customDepthMaterialNeedsUpdate=!1,this.customDepthMaterial=new EF({vertexShader:t.vertexShader,fragmentShader:"\n\t\t\t\t\t\t#include <packing>\n\t\t\t\t\t\tvoid main()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgl_FragColor = packDepthToRGBA(gl_FragCoord.z);\n\t\t\t\t\t\t}\n\t\t\t\t\t",uniforms:t.uniforms,defines:this.material.defines}),this.isMeshDepthMaterial=!0,this.customDistanceMaterial=new EF({vertexShader:t.vertexShader,fragmentShader:"\n\t\t\t\t\t#include <common>\n\t\t\t\t\t#include <packing>\n\t\t\t\t\tuniform vec3 referencePosition;\n\t\t\t\t\tuniform float nearDistance;\n\t\t\t\t\tuniform float farDistance;\n\t\t\t\t\t// World-space position\n\t\t\t\t\tvarying vec3 vWPosition;\n\t\t\t\t\tvoid main()\n\t\t\t\t\t{\n\t\t\t\t\t\tfloat dist = length(vWPosition - referencePosition);\n\t\t\t\t\t\tdist = (dist - nearDistance) / (farDistance - nearDistance);\n\t\t\t\t\t\tdist = saturate(dist);\n\t\t\t\t\t\t// Required by Three.js for this to work\n\t\t\t\t\t\tgl_FragColor = packDepthToRGBA( dist );\n\t\t\t\t\t}",uniforms:u({nearDistance:{value:0},farDistance:{value:0},referencePosition:{value:new PB},opacity:{value:0}},t.uniforms),defines:this.material.defines});let e=this.customDistanceMaterial;e.referencePosition=new PB,e.nearDistance=0,e.farDistance=0,e.opacity=1,e.isMeshDistanceMaterial=!0}}else this.patchVertexShaderForShapeBlend(t),t.shadersPatchedForShapeBlend=!0,this.customDepthMaterialNeedsUpdate=!0;if(this.spatialPassUniforms.npart.value=this.npart,this.spatialPassUniforms.spatialn.value=this.spatialn,this.potentialPassUniforms.npart.value=this.npart,this.potentialPassUniforms.spatialn.value=this.spatialn,this.needsRebuild){this.needsRebuild=!1,this.spatialMesh.material.defines.RES=this.resolutionLevel,this.spatialMesh.material.needsUpdate=!0,this.potentialMesh.material.defines.RES=this.resolutionLevel,this.potentialPassUniforms.spatialPassTexture.value=this.spatialPassRenderTarget.texture,this.potentialMesh.material.needsUpdate=!0,this.voxelMesh.material.defines.RES=this.resolutionLevel,this.voxelMesh.material.needsUpdate=!0,this.voxelPassUniforms.potentialPassTexture.value=this.potentialPassRenderTarget.texture,this.marchPassUniforms.potentialPassTexture.value=this.potentialPassRenderTarget.texture,this.marchPassUniforms.voxelPassTexture.value=this.voxelPassRenderTarget.texture[0],this.material.defines.RES=this.resolutionLevel,this.material.defines.LEVELS=this.pyramidLevelSizes.length,this.material.defines.LOOP=this.pyramidLevelSizes.length%2===0?this.pyramidLevelSizes.length-3:this.pyramidLevelSizes.length-2,this.material.defines.HALF=this.pyramidLevelSizes.length%2===0?1:0,this.material.needsUpdate=!0;let e=this.pyramidLevelSizes.length%2===0?0:1,t=this.pyramidLevelSizes.length%2===0?1:0;this.marchPassUniforms.pyramidTexture2.value=this.pyramidRenderTarget[e].texture,this.marchPassUniforms.pyramidTexture2Size.value=new eB(this.pyramidRenderTarget[e].width,this.pyramidRenderTarget[e].height),this.marchPassUniforms.pyramidTexture1.value=this.pyramidRenderTarget[t].texture,this.marchPassUniforms.pyramidTexture1Size.value=new eB(this.pyramidRenderTarget[t].width,this.pyramidRenderTarget[t].height),Object.assign(this.material.uniforms,this.marchPassUniforms)}let r=e.shadowMap.enabled;e.shadowMap.enabled=!1;let n=e.getRenderTarget();e.setRenderTarget(this.spatialPassRenderTarget),e.render(this.spatialscene,Foe),e.setRenderTarget(this.potentialPassRenderTarget),e.render(this.potentialPassScene,Foe),e.setRenderTarget(this.voxelPassRenderTarget),e.render(this.voxelPassScene,Foe),Hoe.streamCompaction.renderPyramid(this.resolutionLevel,this.pyramidLevelSizes,e,this.voxelPassRenderTarget,this.pyramidRenderTarget).then((e=>{this.material.wireframe&&(3*e>this.geometry.attributes.position.count||this.drawRangeNeedsForceUpdate)&&(this.geometry.dispose(),this.geometry=new iF,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]},this.geometry.attributes.position=new Xz(new Float32Array(3*e*2),3)),(3*e>this.geometry.drawRange.count||this.drawRangeNeedsForceUpdate)&&(this.geometry.drawRange.count=3*Math.floor(1.2*e)),this.drawRangeNeedsForceUpdate=!1})),e.shadowMap.enabled=r,e.setRenderTarget(n)}}set npart(e){e!==this._npart&&(this.drawRangeNeedsForceUpdate=!0,this._npart=e,this.spatialn=Math.ceil(e/96))}get npart(){return this._npart}set resolutionLevel(e){let t=Math.min(8,Math.max(5,e));if(t!==this._resolutionLevel){switch(this._resolutionLevel=t,this.resolution=Math.pow(2,t),this.resolutionLevel){case 5:this.pyramidLevelSizes=[1,2,4,6,12,24,48,96,192],this.bboxSize=496,this.bboxOffset=-8;break;case 6:this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512],this.bboxSize=504,this.bboxOffset=-4;break;case 7:this.pyramidLevelSizes=[1,2,4,6,12,24,48,96,192,384,768,1536],this.bboxSize=508,this.bboxOffset=-2;break;case 8:this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096],this.bboxSize=510,this.bboxOffset=-1}this.pyramidTexture1Width=0,this.pyramidTexture2Width=0,this.pyramidTexture1Height=this.pyramidLevelSizes[this.pyramidLevelSizes.length-2],this.pyramidTexture2Height=this.pyramidLevelSizes[this.pyramidLevelSizes.length-3];for(let e=this.pyramidLevelSizes.length-2;e>=0;e--)(this.pyramidLevelSizes.length-2)%2===e%2?this.pyramidTexture1Width+=this.pyramidLevelSizes[e]:this.pyramidTexture2Width+=this.pyramidLevelSizes[e];this.basePyramidSize=this.pyramidLevelSizes[this.pyramidLevelSizes.length-1],this.zLayersPerRow=this.basePyramidSize/this.resolution,this.numLevels=this.pyramidLevelSizes.length-1,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]},this.needsRebuild=!0}}get resolutionLevel(){return this._resolutionLevel}get spatialPassRenderTarget(){let e=this._spatialPassRenderTargets[this.resolutionLevel];return e||(e=new EB(this.spatialDivisions*this.spatialn,this.spatialDivisions**2,{format:dN,type:cN,stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:tN,magFilter:tN}),this._spatialPassRenderTargets[this.resolutionLevel]=e),e}get potentialPassRenderTarget(){let e=this._potentialPassRenderTargets[this.resolutionLevel];return e||(e=new EB(this.basePyramidSize,this.basePyramidSize,{format:dN,type:cN,stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:tN,magFilter:tN}),this._potentialPassRenderTargets[this.resolutionLevel]=e),e}get voxelPassRenderTarget(){let e=this._voxelPassRenderTargets[this.resolutionLevel];return e||(e=new MB(this.basePyramidSize,this.basePyramidSize,2,{stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:tN,magFilter:tN}),e.texture[0].format=dN,e.texture[0].type=cN,e.texture[1].format=mN,e.texture[1].type=cN,this._voxelPassRenderTargets[this.resolutionLevel]=e),e}get pyramidRenderTarget(){let e=this._pyramidRenderTargets[this.resolutionLevel];if(!e){e=[new EB(this.pyramidTexture1Width,this.pyramidTexture1Height,{format:dN,type:cN,stencilBuffer:!1,depthBuffer:!1,magFilter:tN,minFilter:tN}),new EB(this.pyramidTexture2Width,this.pyramidTexture2Height,{format:dN,type:cN,stencilBuffer:!1,depthBuffer:!1,magFilter:tN,minFilter:tN})],this._pyramidRenderTargets[this.resolutionLevel]=e}return e}updateState(e,t){let r=this.material;super.updateState(e,t),r!==this.material&&(this.needsRebuild=!0),e.geometry&&(this.resolutionLevel=e.geometry.resolutionLevel,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]}),e.wireframe&&!this.geometry.getAttribute("position")?this.geometry.setAttribute("position",new Xz(new Float32Array(3*this.geometry.drawRange.count),3)):!e.wireframe&&this.geometry.getAttribute("position")&&this.geometry.deleteAttribute("position")}spatialPassMaterial(){let e="\n\t\t\tprecision highp float;\n\t\t\tout vec4 pc_FragColor;\n\t\t\tconst float spatialDivisions = ".concat(this.spatialDivisions,".;\n\t\t\tuniform float span;\n\t\t\tuniform float npart;\n\t\t\tuniform float spatialn;\n\t\t\t").concat(Voe.shapeInput(),"\n\n\t\t\tvec3 low, high;     // range of current div; subset of -1 .. 1 with span border\n\n\t\t\t// lookup one element/channel's worth of spheres for current division\n\t\t\t// stating with low sphere number lowi\n\t\t\t// gives a key to which spheres from lowi..lowi+23 are active within given div (low..high)\n\t\t\tfloat spatialKey(float lowi) {\n\t\t\t\tfloat t = 0.;\n\t\t\t\tfor (float ii = ").concat(23,".; ii >= 0.; ii--) {\n\t\t\t\t\tfloat i = ii + lowi;\n\t\t\t\t\tfloat iin = (i + 0.5) / ").concat(Uoe,".;\n\t\t\t\t\tvec4 shape = shapePos(iin);\n\t\t\t\t\tvec3 d = shape.xyz;\n\t\t\t\t\tfloat op = shape.w;\n\t\n\t\t\t\t\tt *= 2.;\n\t\t\t\t\tt += (\n\t\t\t\t\t\tlow.x < d.x && d.x < high.x &&\n\t\t\t\t\t\tlow.y < d.y && d.y < high.y &&\n\t\t\t\t\t\tlow.z < d.z && d.z < high.z &&\n\t\t\t\t\t\ti < npart || op == -2. // always include if op is -2, which is the intersection operation\n\t\t\t\t\t) ? 1. : 0.;\n\t\t\t\t}\n\t\t\t\treturn t;\n\t\t\t}\n\n\t\t\t").concat(Voe.getpart,"\n\n\t\t\tvoid main() {               // spatialial fragment shader\n\t\t\t\t// find active div\n\t\t\t\tvec3 div;                               // which div is current\n\t\t\t\t// out holds x=> x, lowi faster moving and y=> z, y faster moving\n\t\t\t\tfloat yz = float(gl_FragCoord.y - 0.5);     // contains  z, y faster moving\n\t\t\t\tdiv.y = getpart(yz, spatialDivisions);\n\t\t\t\tdiv.z = yz; // getpart(yz, spatialDivisions.z); // what's left, should be the same as getpart\n\n\t\t\t\tfloat lx = float(gl_FragCoord.x - 0.5);     // contains x, lowi faster moving\n\t\t\t\tfloat lowi = getpart(lx, spatialn) * ").concat(96,".;\n\t\t\t\tdiv.x = lx;\n\n\t\t\t\tlow = div / spatialDivisions * 2. - 1. - span;\n\t\t\t\thigh = (div+1.) / spatialDivisions * 2. - 1. + span;\n\n\t\t\t\t// find active range of spheres\n\t\t\t\tpc_FragColor.x = spatialKey(lowi);\n\t\t\t\tpc_FragColor.y = spatialKey(lowi+").concat(joe,".);\n\t\t\t\tpc_FragColor.z = spatialKey(lowi+").concat(48,".);\n\t\t\t\tpc_FragColor.w = spatialKey(lowi+").concat(72,".);\n\t\t\t}\n\t\t");return new zoe({name:"Spatial Pass",fragmentShader:e,uniforms:this.spatialPassUniforms})}potentialPassMaterial(){let e="\n\t\t\tprecision highp float;\n\t\t\tout vec4 pc_FragColor;\n\n\t\t\t".concat(Voe.shapeInput(),"\n\t\t\tuniform sampler2D spatialPassTexture;\n\n\t\t\tconst float res = float(RES);\n\t\t\tconst float VOXEL_RESOLUTION = pow(2., res);\n\t\t\tconst float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));\n\t\t\tconst float VOXEL_RESOLUTION_SUB1 = VOXEL_RESOLUTION - 1.;\n\t\t\tconst float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;\n\n\t\t\tuniform float npart;\n\t\t\tuniform float spatialn;\n\t\t\tconst float spatialDivisions = ").concat(this.spatialDivisions,".;\n\t\t\tconst float spatialDivisions2 = spatialDivisions * spatialDivisions;\n\t\t\tconst float spatialDivisionsSub1 = spatialDivisions - 1.;\n\n\t\t\t").concat(Voe.getpart,"\n\n\t\t\tvec3 packRGBAToVec3(vec4 color) {\n\t\t\t\tuint r = uint(color.r * 255.);\n\t\t\t\tuint g = uint(color.g * 255.);\n\t\t\t\tuint combined = (r << 8) | g; \n\t\t\t\treturn vec3(float(combined) * 0.00001525902, color.b, color.a); // 1/65535\n\t\t\t}\n\n\t\t\tvoid applyQuaternionToVector(in vec4 q, inout vec3 v) {\n\t\t\t\tv += 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * SDF functions (reference: https://iquilezles.org/articles/distfunctions/)\n\t\t\t */\n\n\t\t\t// branchless version of \"Smooth Union, Subtraction and Intersection - bound, bound, bound\" in above reference\n\t\t\tfloat smoothOperation(float op, float sdf, float d, float k) {\n\t\t\t  //        union: op =  1 => signSubtract =  1, signIntersection =  1\n\t\t\t  //     subtract: op = -1 => signSubtract = -1, signIntersection =  1\n\t\t\t\t// intersection: op = -2 => signSubtract = -1, signIntersection = -1\n\n\t\t\t\tfloat signSubtract = clamp(op, -1., 1.);\n\t\t\t\tfloat signIntersection = 2. * (op - signSubtract) + 1.;\n\t\t\t\tfloat h = clamp(\n\t\t\t\t\t0.5 + signSubtract * 0.5 * (sdf - signSubtract * signIntersection * d) / k,\n\t\t\t\t\t0.0,\n\t\t\t\t\t1.0\n\t\t\t\t);\n\t\t\t\treturn mix(sdf, signSubtract * signIntersection * d, h) - \n\t\t\t\t\t\t\t signSubtract * k * h * (1.0 - h);\n\t\t\t}\n\n\t\t\tfloat sdSphere( vec3 p, float s )\n\t\t\t{\n\t\t\t\treturn length(p)-s;\n\t\t\t}\n\n\t\t\tfloat sdEllipsoid( vec3 p, vec3 r )\n\t\t\t{\n\t\t\t\tfloat k0 = length(p/r);\n\t\t\t\tfloat k1 = length(p/(r*r));\n\t\t\t\treturn k0*(k0-1.0)/k1;\n\t\t\t}\n\n\t\t\tfloat sdBox( vec3 p, vec3 b )\n\t\t\t{\n\t\t\t\tvec3 q = abs(p) - b;\n\t\t\t\treturn length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0);\n\t\t\t}\n\n\t\t\tfloat sdTorus( vec3 p, vec2 t )\n\t\t\t{\n\t\t\t\tvec2 q = vec2(length(p.xy)-t.x,p.z);\n\t\t\t\treturn length(q)-t.y;\n\t\t\t}\n\n\t\t\tfloat sdCappedTorus( vec3 p, vec2 sc, float ra, float rb)\n\t\t\t{\n\t\t\t\tp.x = abs(p.x);\n\t\t\t\tfloat k = (sc.y*p.x>sc.x*p.y) ? dot(p.xy,sc) : length(p.xy);\n\t\t\t\treturn sqrt( dot(p,p) + ra*ra - 2.0*ra*k ) - rb;\n\t\t\t}\n\n\t\t\tfloat dot2( in vec2 v ) { return dot(v,v); }\n\t\t\tfloat sdCappedCone( vec3 p, float h, float r1, float r2 )\n\t\t\t{\n\t\t\t\tvec2 q = vec2( length(p.xz), p.y );\n\t\t\t\tvec2 k1 = vec2(r2,h);\n\t\t\t\tvec2 k2 = vec2(r2-r1,2.0*h);\n\t\t\t\tvec2 ca = vec2(q.x-min(q.x,(q.y<0.0)?r1:r2), abs(q.y)-h);\n\t\t\t\tvec2 cb = q - k1 + k2*clamp( dot(k1-q,k2)/dot2(k2), 0.0, 1.0 );\n\t\t\t\tfloat s = (cb.x<0.0 && ca.y<0.0) ? -1.0 : 1.0;\n\t\t\t\treturn s*sqrt( min(dot2(ca),dot2(cb)) );\n\t\t\t}\n\n\t\t\tfloat sdCappedCylinder( vec3 p, float h, float r )\n\t\t\t{\n\t\t\t\tvec2 d = abs(vec2(length(p.xz),p.y)) - vec2(r,h);\n\t\t\t\treturn min(max(d.x,d.y),0.0) + length(max(d,0.0));\n\t\t\t}\n\n\t\t\tfloat maxBlend = 0.0;\n\t\t\t// compute potential from A (=24) spheres, using the bit flags in 'activeKey'\n\t\t\t// to avoid lookup/compute for inactive spheres\n\t\t\t// return field potential, side effect updates track,\n\t\t\t// compute and return +ve and -ve values separately\n\t\t\tvoid fillSpatialInner(\n\t\t\t\tfloat ii,\n\t\t\t\tfloat activeKey,\n\t\t\t\tvec3 corner,\n\t\t\t\tinout float sdf,\n\t\t\t\tinout float colorDivisor,\n\t\t\t\tinout vec4 trackColor\n\t\t\t) {\n\t\t\t\tfor (float i = 0.; i < ").concat(joe,".; i++) {\n\t\t\t\t\tif (activeKey < 1.) break; // activeKey exhausted, no more active spheres\n\t\t\t\t\tactiveKey *= 0.5;\n\t\t\t\t\tif (fract(activeKey) < 0.5) continue;\n\n\t\t\t\t\tfloat iin = (i + ii + 0.5) * ").concat(1/Uoe,";\n\t\t\t\t\tvec4 shape = shapePos(iin);\n\t\t\t\t\tvec4 quat = shapeQuat(iin);\n\t\t\t\t\tvec4 params1 = shapeParams1(iin);\n\t\t\t\t\tvec4 params2 = shapeParams2(iin);\n\n\t\t\t\t\tvec3 p = corner - shape.xyz;\n\t\t\t\t\tapplyQuaternionToVector(quat, p);\n\t\t\t\t\tp /= params2.z; // scale\n\t\t\t\t\tfloat d; // d in -1..1 coordinates\n\t\t\t\t\tswitch (int(params1.x)) {\n\t\t\t\t\t\tcase 0: d = sdSphere(p, params1.y); break;\n\t\t\t\t\t\tcase 1: d = sdEllipsoid(p, params1.yzw); break;\n\t\t\t\t\t\tcase 2: d = sdBox(p, params1.yzw); break;\n\t\t\t\t\t\tcase 3: d = sdCappedCylinder(p, params1.y, params1.z); break;\n\t\t\t\t\t\tcase 4: d = sdCappedCone(p, params1.y, params1.z, params1.w); break;\n\t\t\t\t\t\tcase 5: d = sdTorus(p, params1.yz); break;\n\t\t\t\t\t\tcase 6: d = sdCappedTorus(p, params1.yz, params1.w, params2.w); break;\n\t\t\t\t\t}\n\t\t\t\t\td -= params2.y; // rounded edge\n\t\t\t\t\td *= params2.z; // scale\n\n\t\t\t\t\tfloat k = params2.x;\n\t\t\t\t\tfloat op = shape.w;\n\n\t\t\t\t\tsdf = smoothOperation(shape.w, sdf, d, k);\n\n\t\t\t\t\tfloat isNegativeOne = step(-1.5, op) * step(op, -0.5); // 1 when op == -1, 0 otherwise\n\t\t\t\t\tfloat colorCull = smoothstep(maxBlend, 0., -d);\n\t\t\t\t\tfloat cullFactor = mix(1.0, colorCull, isNegativeOne);\n\t\t\t\t\ttrackColor *= cullFactor;\n\t\t\t\t\tcolorDivisor *= cullFactor;\n\n\t\t\t\t\tmaxBlend = max(maxBlend, k);\n\n\t\t\t\t\tk += 2. * INV_VOXEL_RESOLUTION; // avoid division by zero, and other color artifacts with very small k\n\t\t\t\t\tfloat nearness = smoothstep(k, 0., d);\n\n\t\t\t\t\tvec4 color = shapeColor(iin);\n\t\t\t\t\tnearness *= float(color.a >= 0.);\n\n\t\t\t\t\tcolorDivisor += nearness;\n\t\t\t\t\ttrackColor += color * nearness;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvec3 div;\n\t\t\t// compute potential from all spheres; collect +ve and =ve values separately\n\t\t\t// work in blocks of A*4 (=96) spheres, using the bit flags in 4 float channel 'activeKey' values\n\t\t\t// TODO check if extra vec3 output useful, not really used at present\n\t\t\tfloat fillSpatial(vec3 corner, inout vec4 trackColor) {\n\t\t\t\tfloat sdf = 1e3; // hack: initialize to large value\n\t\t\t\tfloat colorDivisor = 0.;\n\t\t\t\t// spatialPassTexture holds x=> lowi, x faster moving and y=> z, y faster moving\n\t\t\t\tfloat divyz = (div.y + div.z * spatialDivisions + 0.5) / (spatialDivisions2);\n\t\t\t\tfor (float ii = 0.; ii < spatialn; ii++) {\n\t\t\t\t\tfloat i = ii * ").concat(96,".;\n\n\t\t\t\t\tvec4 activeKey = texture(spatialPassTexture, vec2((div.x * spatialn + ii + 0.5)/(spatialn * spatialDivisions), divyz));\n\t\t\t\t\tfillSpatialInner(i, activeKey.x, corner, sdf, colorDivisor, trackColor);\n\t\t\t\t\tfillSpatialInner(i+").concat(joe,"., activeKey.y, corner, sdf, colorDivisor, trackColor);\n\t\t\t\t\tfillSpatialInner(i+").concat(48,"., activeKey.z, corner, sdf, colorDivisor, trackColor);\n\t\t\t\t\tfillSpatialInner(i+").concat(72,"., activeKey.w, corner, sdf, colorDivisor, trackColor);\n\t\t\t\t}\n\n\t\t\t\ttrackColor /= colorDivisor;\n\t\t\t\treturn mix(sdf, 0.0, step(1e20 - 0.1, sdf));\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\t").concat(Voe.getxyzi,"    // get xi yi zi from 2d position\n\n\t\t\t\tvec3 xyzi = vec3(xi,yi,zi);\n\t\t\t\tvec3 corner = xyzi / VOXEL_RESOLUTION_SUB1 * 2. - 1.;  // -1..1 coords\n\n\t\t\t\tdiv = floor(xyzi / VOXEL_RESOLUTION_SUB1 * spatialDivisionsSub1);\n\n\t\t\t\tvec4 c = vec4(0.);\n\t\t\t\tfloat t = fillSpatial(corner, c);\n\n\t\t\t\tpc_FragColor = vec4(t, packRGBAToVec3(c)); // RGB texture\n\t\t\t}\n\t\t");return new zoe({name:"PotentialPass",fragmentShader:e,uniforms:this.potentialPassUniforms})}voxelPassMaterial(){let e="\n\t\t\tprecision highp float;\n\t\t\tlayout(location = 0) out vec4 pc_FragColor;\n\t\t\tlayout(location = 1) out vec4 numTris;\n\n\t\t\tconst float res = float(RES);\n\t\t\tconst float VOXEL_RESOLUTION = pow(2., res);\n\t\t\tconst float VOXEL_RESOLUTION_SUB1 = VOXEL_RESOLUTION - 1.; \n\t\t\tconst float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));\n\t\t\tconst float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;\n\t\t\tuniform sampler2D numTrisTable; // 256 x 1\n\n\t\t\tfloat keyi(float f000, float f100, float f010, float f110, float f001, float f101, float f011, float f111) {\n\t\t\t\treturn (float(f000 < 0.) * 1.) +\n\t\t\t\t\t\t\t (float(f100 < 0.) * 2.) +\n\t\t\t\t\t\t\t (float(f010 < 0.) * 8.) +\n\t\t\t\t\t\t\t (float(f110 < 0.) * 4.) +\n\t\t\t\t\t\t\t (float(f001 < 0.) * 16.) +\n\t\t\t\t\t\t\t (float(f101 < 0.) * 32.) +\n\t\t\t\t\t\t\t (float(f011 < 0.) * 128.) +\n\t\t\t\t\t\t\t (float(f111 < 0.) * 64.);\n\t\t\t}\n\n\t\t\t".concat(Voe.lookup,"\n\n\t\t\tvec3 compNormi(float xi, float yi, float zi) {\n\t\t\t\tfloat dx = look(xi + 1., yi, zi, potentialPassTexture).r - look(xi - 1., yi, zi, potentialPassTexture).r;\n\t\t\t\tfloat dy = look(xi, yi + 1., zi, potentialPassTexture).r - look(xi, yi - 1., zi, potentialPassTexture).r;\n\t\t\t\tfloat dz = look(xi, yi, zi + 1., potentialPassTexture).r - look(xi, yi, zi - 1., potentialPassTexture).r;\n\t\t\t\t// if we allow (common) 0,0,0 case through then NaN can spread\n\t\t\t\t// eg r = vec4(compNorm i(???), 1.) will pollute r.w\n\t\t\t\tif (dx == 0.0 && dy == 0.0 && dz == 0.0) {\n\t\t\t\t\treturn vec3(0.199, 0.299, 0.399);\n\t\t\t\t}\n\t\t\t\treturn normalize(vec3(dx, dy, dz));\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\t").concat(Voe.getxyzi,"    // get xi yi zi from 2d\n\n\t\t\t\tvec3 normal = compNormi(xi, yi, zi);  // even if our key is -1 this may be needed by a neighbouring voxel\n\n\t\t\t\tif (xi >= VOXEL_RESOLUTION_SUB1 || yi >= VOXEL_RESOLUTION_SUB1 || zi >= VOXEL_RESOLUTION_SUB1) {\n\t\t\t\t\tpc_FragColor = vec4(normal, 0.);\n\t\t\t\t\tnumTris = vec4(0.);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfloat\n\t\t\t\t\tf000 = look(xi, yi, zi, potentialPassTexture).r,\n\t\t\t\t\tf100 = look(xi+1., yi, zi, potentialPassTexture).r,\n\t\t\t\t\tf010 = look(xi, yi+1., zi, potentialPassTexture).r,\n\t\t\t\t\tf110 = look(xi+1., yi+1., zi, potentialPassTexture).r,\n\t\t\t\t\tf001 = look(xi, yi, zi+1., potentialPassTexture).r,\n\t\t\t\t\tf101 = look(xi+1., yi, zi+1., potentialPassTexture).r,\n\t\t\t\t\tf011 = look(xi, yi+1., zi+1., potentialPassTexture).r,\n\t\t\t\t\tf111 = look(xi+1., yi+1., zi+1., potentialPassTexture).r;\n\t\t\t\tfloat key = keyi(f000, f100, f010, f110, f001, f101, f011, f111);\n\n\t\t\t\tpc_FragColor = vec4(normal, key);\n\n\t\t\t\tnumTris = texture(numTrisTable, vec2((key + 0.5) / 256., 0.5));\n\t\t\t}\n\t\t");return new zoe({name:"VoxelPass",fragmentShader:e,uniforms:this.voxelPassUniforms})}patchVertexShaderForShapeBlend(e){let t="\n\t\t#ifdef SHAPEBLEND \n\t\t\tprecision highp sampler2D;\n\n\t\t\tuniform float isol;\n\n\t\t\tuniform sampler2D triTable;     // 256 x 16\n\t\t\tuniform sampler2D pyramidTexture1;\n\t\t\tuniform vec2 pyramidTexture1Size;\n\t\t\tuniform sampler2D pyramidTexture2;\n\t\t\tuniform vec2 pyramidTexture2Size;\n\n\t\t\tconst vec2 halfPixelOffset = vec2(0.5, 0.5);\n\n\t\t\tconst vec2 rShift = vec2(0., 1.);\n\t\t\tconst vec2 gShift = vec2(1., 1.);\n\t\t\tconst vec2 bShift = vec2(1., 0.);\n\n\t\t\tconst float res = float(RES);\n\t\t\tconst float VOXEL_RESOLUTION = pow(2., res);\n\t\t\tconst float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));\n\t\t\tconst float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;\n\n\t\t\tconst float scale_factor = ".concat(2,".;\n\n\t\t\t#if SHAPEBLEND == 5\n\t\t\t\tconst float levelShiftX[7] = float[7](4., 6., 12., 24., 48., 96., 192.);\n\t\t\t\tconst float scale = 8. * scale_factor;\n\t\t\t\tconst vec3 originOffset = vec3(16.);\n\t\t\t#elif SHAPEBLEND == 7\n\t\t\t\tconst float levelShiftX[10] = float[10](4., 6., 12., 24., 48., 96., 192., 384., 768., 1536.); \n\t\t\t\tconst float scale = 2. * scale_factor;\n\t\t\t\tconst vec3 originOffset = vec3(64.);\n\t\t\t#elif SHAPEBLEND == 8\n\t\t\t\tconst float levelShiftX[11] = float[11](4., 8., 16., 32., 64., 128., 256., 512., 1024., 2048., 4096.);\n\t\t\t\tconst float scale = scale_factor;\n\t\t\t\tconst vec3 originOffset = vec3(128.);\n\t\t\t#else\n\t\t\t\tconst float levelShiftX[8] = float[8](4., 8., 16., 32., 64., 128., 256., 512.);\n\t\t\t\tconst float scale = 4. * scale_factor;\n\t\t\t\tconst vec3 originOffset = vec3(32.);\n\t\t\t#endif\n\n\t\t\t").concat(Voe.lookup,"\n\n\t\t\tconst vec3 offsets[24] = vec3[](\n\t\t\t\tvec3(0., 0., 0.), vec3(1., 0., 0.),\n\t\t\t\tvec3(1., 0., 0.), vec3(1., 1., 0.),\n\t\t\t\tvec3(0., 1., 0.), vec3(1., 1., 0.),\n\t\t\t\tvec3(0., 0., 0.), vec3(0., 1., 0.),\n\t\t\t\tvec3(0., 0., 1.), vec3(1., 0., 1.),\n\t\t\t\tvec3(1., 0., 1.), vec3(1., 1., 1.),\n\t\t\t\tvec3(0., 1., 1.), vec3(1., 1., 1.),\n\t\t\t\tvec3(0., 0., 1.), vec3(0., 1., 1.),\n\t\t\t\tvec3(0., 0., 0.), vec3(0., 0., 1.),\n\t\t\t\tvec3(1., 0., 0.), vec3(1., 0., 1.),\n\t\t\t\tvec3(1., 1., 0.), vec3(1., 1., 1.),\n\t\t\t\tvec3(0., 1., 0.), vec3(0., 1., 1.)\n\t\t\t);\n\n\t\t\tvec2 computeShiftedPosition1(vec2 xy, float levelOriginX) {\n\t\t\t\tvec2 xyShifted = xy;\n\t\t\t\txyShifted.x += levelOriginX;\n\t\t\t\treturn (xyShifted + halfPixelOffset) / pyramidTexture1Size;\n\t\t\t}\n\n\t\t\tvec2 computeShiftedPosition2(vec2 xy, float levelOriginX) {\n\t\t\t\tvec2 xyShifted = xy;\n\t\t\t\txyShifted.x += levelOriginX;\n\t\t\t\treturn (xyShifted + halfPixelOffset) / pyramidTexture2Size;\n\t\t\t}\n\n\t\t\tvec4 unpackVec3ToRGBA(vec3 vec) {\n\t\t\t\tuint combined = uint(vec.x * 65535.0 + 0.5); // Add 0.5 for rounding\n\t\t\t\tfloat g = float(combined & uint(0xFF)) * 0.00392156862; // 1/255\n\t\t\t\tfloat r = float((combined >> 8) & uint(0xFF)) * 0.00392156862; \n\t\t\n\t\t\t\treturn vec4(r, g, vec.y, vec.z);\n\t\t\t}\n\n\t\t\tout vec4 marchColor;\n\t\t\t// end of marchvertPre\n\t\t#endif\n\t\t");e.vertexShader=t+e.vertexShader.replace("#include <project_vertex>","\n\t\t#ifdef SHAPEBLEND\n\t\t\tfloat triIndex = floor(float(gl_VertexID/3));\n\t\t\tfloat vertexIndex = float(gl_VertexID);\n\t\t\t\n\t\t\t// Initial pyramid lookup\n\t\t\tfloat levelOriginX1 = pyramidTexture1Size.x - 2.;\n\t\t\tfloat levelOriginX2 = pyramidTexture2Size.x - 1.;\n\t\t\tvec2 xy = vec2(0.);\n\t\t\tvec4 lookUp = texture(pyramidTexture2, computeShiftedPosition2(xy, levelOriginX2));\n\t\t\t\n\t\t\t// Early exit check\n\t\t\tif (triIndex >= lookUp.r) return;\n\t\t\t\n\t\t\t// Optimize loop variables\n\t\t\tfloat start = 0.;\n\t\t\tvec4 triIndexVec = vec4(triIndex);\n\t\t\t\n\t\t\t// Main position computation loop\n\t\t\tfor (int i = 0; i < LOOP;) {\n\t\t\t\t// Compute boundaries\n\t\t\t\tvec4 ends = lookUp + vec4(start);\n\t\t\t\tvec4 starts = vec4(ends.gba, start);\n\t\t\t\tvec4 check = vec4(greaterThanEqual(triIndexVec, starts)) * \n\t\t\t\t\t\t\t\t\t\t\tvec4(lessThan(triIndexVec, ends));\n\t\t\t\t\n\t\t\t\t// Update position\n\t\t\t\txy *= 2.;\n\t\t\t\txy += check.r * rShift + check.g * gShift + check.b * bShift;\n\t\t\t\t\n\t\t\t\t// Update loop variables\n\t\t\t\tstart = dot(check, starts);\n\t\t\t\tlevelOriginX2 -= levelShiftX[i];\n\t\t\t\t\n\t\t\t\t// Update lookup\n\t\t\t\tlookUp = texture(pyramidTexture1, computeShiftedPosition1(xy, levelOriginX1));\n\t\t\t\ti++;\n\n\t\t\t\tends = lookUp + vec4(start);\n\t\t\t\tstarts = vec4(ends.gba, start);\n\t\t\t\tcheck = vec4(greaterThanEqual(triIndexVec, starts)) * \n\t\t\t\t\t\t\t\t\t\t\tvec4(lessThan(triIndexVec, ends));\n\t\t\t\t\n\t\t\t\t// Update position\n\t\t\t\txy *= 2.;\n\t\t\t\txy += check.r * rShift + check.g * gShift + check.b * bShift;\n\t\t\t\t\n\t\t\t\t// Update loop variables\n\t\t\t\tstart = dot(check, starts);\n\t\t\t\tlevelOriginX1 -= levelShiftX[i];\n\t\t\t\t\n\t\t\t\t// Update lookup\n\t\t\t\tlookUp = texture(pyramidTexture2, computeShiftedPosition2(xy, levelOriginX2));\n\n\t\t\t\ti++;\n\t\t\t}\n\n\t\t\t#if HALF == 1\n\t\t\t\tvec4 ends = lookUp + vec4(start);\n\t\t\t\tvec4 starts = vec4(ends.gba, start);\n\t\t\t\tvec4 check = vec4(greaterThanEqual(triIndexVec, starts)) * vec4(lessThan(triIndexVec, ends));\n\t\t\t\n\t\t\t\t// Update position\n\t\t\t\txy *= 2.;\n\t\t\t\txy += check.r * rShift + check.g * gShift + check.b * bShift;\n\t\t\t\n\t\t\t\t// Update loop variables\n\t\t\t\tstart = dot(check, starts);\n\t\t\t#endif\n\t\t\t\n\t\t\t// Compute final coordinates\n\t\t\tvec3 gridPos;\n\t\t\tgridPos.x = mod(xy.x, VOXEL_RESOLUTION);\n\t\t\tgridPos.y = mod(xy.y, VOXEL_RESOLUTION);\n\t\t\tgridPos.z = floor(xy.x * INV_VOXEL_RESOLUTION) + \n\t\t\t\t\t\t\t\t\tfloor(xy.y * INV_VOXEL_RESOLUTION) * Z_LAYERS_PER_ROW;\n\t\t\t\n\t\t\t// Vertex key computation\n\t\t\tvertexIndex -= start * 3.;\n\t\t\tfloat vk = vertexIndex * 0.0625 + 0.03125; // Optimized division by 16 and addition of 1/32\n\t\t\t\n\t\t\t// Voxel lookup and edge computation\n\t\t\tvec4 voxel = look(gridPos.x, gridPos.y, gridPos.z, voxelPassTexture);\n\t\t\tfloat key = (voxel.w + 0.5) * 0.00390625; // Optimized division by 256\n\t\t\t\n\t\t\t// Edge lookup and offset computation\n\t\t\tfloat edgeNum = texture(triTable, vec2(vk, key)).x;\n\t\t\tint edgeIndex = int(edgeNum) * 2;\n\t\t\t\n\t\t\t// Compute edge positions\n\t\t\tvec3 p1 = gridPos + offsets[edgeIndex];\n\t\t\tvec3 p2 = gridPos + offsets[edgeIndex + 1];\n\t\t\t\n\t\t\t// Compute potentials and normals\n\t\t\tvec4 potential1 = look(p1.x, p1.y, p1.z, potentialPassTexture);\n\t\t\tvec4 potential2 = look(p2.x, p2.y, p2.z, potentialPassTexture);\n\t\t\t\n\t\t\t// Final position and normal computation\n\t\t\tfloat mu = potential1.r / (potential1.r - potential2.r);\n\n\t\t\tmarchColor = mix(\n\t\t\t\tunpackVec3ToRGBA(potential1.gba),\n\t\t\t\tunpackVec3ToRGBA(potential2.gba),\n\t\t\t\tmu\n\t\t\t);\n\n\t\t\ttransformed = p1 + (p2 - p1) * mu;\n\t\t\ttransformed -= originOffset;\n\t\t\ttransformed *= scale;\n\t\t\tvec4 data1 = look(p1.x, p1.y, p1.z, voxelPassTexture);\n\t\t\tvec4 data2 = look(p2.x, p2.y, p2.z, voxelPassTexture);\n\t\t\tobjectNormal = normalize(mix(data1.xyz, data2.xyz, mu));\n\t\t\ttransformedNormal = normalMatrix * objectNormal;\n\t\t\t#ifndef FLAT_SHADED\n\t\t\t\tvNormal = transformedNormal;\n\t\t\t#endif\n\t\t#endif\n\t\t\n#include <project_vertex>");let r=e.fragmentShader.match(/vec3 diffuseColor[^\n]*\n/);if(!r)return;let n="\n\t\t#ifdef SHAPEBLEND_C\n\t\t\t#if SHAPEBLEND_C == 1\n\t\t\t\t".concat(r[0].replace(/nodeU0,/g,"marchColor.rgb,").replace(/nodeU\d+(?=,g_uid\d+_calpha\))/g,"marchColor.a"),"\n\t\t\t#else\n\t\t\t\t").concat(r[0],"\n\t\t\t#endif\n\t\t#else\n\t\t\t").concat(r[0],"\n\t\t#endif\n\t\t");e.fragmentShader="in vec4 marchColor;\n"+e.fragmentShader.replace(r[0],n),Object.assign(e.uniforms,this.marchPassUniforms)}initDebugPass(e){console.log("fboToDebug.width",e.width,e.height),this.geometry=new UF(e.width,e.height),this.geometry.userData={parameters:{width:4,height:4}};let t={inputTexture:{value:Array.isArray(e.texture)?e.texture[1]:e.texture},pyramidTextureSize:{value:void 0}},r=e=>{e.vertexShader="\n\t\t\t\tprecision highp float;\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t\t\tvUv = uv;\n\t\t\t\t}\n\t\t\t",e.fragmentShader="\n\t\t\t\tlayout(location = 1) out vec4 gVelocity;\n\n\t\t\t\tprecision highp float;\n\t\t\t\t\n\t\t\t\tuniform sampler2D inputTexture;\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t\tuniform vec2 pyramidTextureSize;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\t\t// Sample the input texture using UV coordinates\n\t\t\t\t\t\tgl_FragColor = texture(inputTexture, vUv);\n\t\t\t\t\t\tgVelocity = vec4(0.0);\n\t\t\t\t}\n\t\t\t",t.pyramidTextureSize.value=new eB(this.pyramidRenderTarget.width,this.pyramidRenderTarget.height),Object.assign(e.uniforms,t)};this.material.shapeBlendhack=r,this.material.root.shapeBlendhack=r}},Woe=Hoe;Woe.streamCompaction=new class{constructor(){this.pyramidPassScene=new yV,this.pyramidPassMaterial=new zoe({name:"PyramidPass"}),this.pyramidPassUniforms={inputTexture:{value:void 0},inputWidth:{value:0},inputHeight:{value:0},inputShiftX:{value:0},outputShiftX:{value:0}},this.pyramidTopLevelReadPixelBuffer=new Float32Array(4);this.pyramidPassMaterial.fragmentShader="\n\t\t\tprecision highp float;\n\t\t\tprecision highp sampler2D;\n\t\t\tlayout(location = 0) out vec4 pc_FragColor;\n\t\t\tuniform sampler2D inputTexture;\n\t\t\tuniform float inputWidth;\n\t\t\tuniform float inputHeight;\n\t\t\tuniform float inputShiftX;\n\t\t\tuniform float outputShiftX;\n\t\t\tconst vec2 half_unit_coord = vec2(0.5);\n\t\t\tconst vec4 one = vec4(1.0);\n\t\t\tvoid main() {\n\t\t\t\tvec2 inputSize = vec2(inputWidth, inputHeight);\n\t\t\t\tvec2 input_pixel_uv = 1. / inputSize;\n\t\t\t\tvec2 coord = gl_FragCoord.xy - half_unit_coord;\n\t\t\t\tcoord.x -= outputShiftX;\n\t\t\t\tcoord = coord * 2. + half_unit_coord;\n\t\t\t\tcoord.x += inputShiftX;\n\n\t\t\t\t// sample bottom left corner\n\t\t\t\tvec2 input_uv = coord / inputSize;\n\t\t\t\tfloat bl = texture(inputTexture, input_uv).r;\n\n\t\t\t\t// sample bottom right corner\n\t\t\t\tinput_uv.x += input_pixel_uv.x;\n\t\t\t\tfloat br = texture(inputTexture, input_uv).r;\n\n\t\t\t\t// sample top right corner\n\t\t\t\tinput_uv.y += input_pixel_uv.y;\n\t\t\t\tfloat tr = texture(inputTexture, input_uv).r;\n\n\t\t\t\t// sample top left corner\n\t\t\t\tinput_uv.x -= input_pixel_uv.x;\n\t\t\t\tfloat tl = texture(inputTexture, input_uv).r;\n\n\t\t\t\tpc_FragColor.a = bl;\n\t\t\t\tpc_FragColor.b = pc_FragColor.a + br;\n\t\t\t\tpc_FragColor.g = pc_FragColor.b + tr;\n\t\t\t\tpc_FragColor.r = pc_FragColor.g + tl; \n\t\t\t}\n\t\t",this.pyramidPassMaterial.uniforms=this.pyramidPassUniforms,this.pyramidPassMaterial.depthTest=!1,this.pyramidPassMaterial.depthWrite=!1;let e=new yF(Boe,this.pyramidPassMaterial);e.frustumCulled=!1,this.pyramidPassScene.add(e)}renderPyramid(e,t,r,n,i){(new hG).min.setScalar(0);let s=t.length-1,a=new CB;r.getViewport(a),this.pyramidPassUniforms.inputShiftX.value=0,this.pyramidPassUniforms.outputShiftX.value=0;let o=s-1;for(let c=o;c>=0;c--){let s=c%2===o%2?i[0]:i[1],a=c===o?n:c%2===o%2?i[1]:i[0];this.pyramidPassUniforms.inputTexture.value=Array.isArray(a.texture)?a.texture[1]:a.texture,this.pyramidPassUniforms.inputWidth.value=a.width,this.pyramidPassUniforms.inputHeight.value=a.height,r.setRenderTarget(s);let l=t[c],u=r.getPixelRatio();r.setViewport(this.pyramidPassUniforms.outputShiftX.value/u,0,l/u,l/u),2===c&&e%2!==0&&r.setViewport(this.pyramidPassUniforms.outputShiftX.value/u,0,3/u,3/u),r.render(this.pyramidPassScene,Foe);let h=this.pyramidPassUniforms.inputShiftX.value;this.pyramidPassUniforms.inputShiftX.value=this.pyramidPassUniforms.outputShiftX.value,this.pyramidPassUniforms.outputShiftX.value=h,c<o&&(this.pyramidPassUniforms.outputShiftX.value+=t[c+1])}r.setViewport(a);let l=t.length%2===0?0:1;return r.readRenderTargetPixelsAsync(i[l],i[l].width-1,0,1,1,this.pyramidTopLevelReadPixelBuffer).then((()=>this.pyramidTopLevelReadPixelBuffer[0]))}};var Goe=new sz,qoe=new sz,Xoe=new TB,Yoe=new PB,Koe=new PB,Qoe=new TB;function Zoe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.children.length;for(;r--;){let n=this.children[r];B4.is(n)&&Joe.call(n,e,t+1)}}function Joe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!0!==e(this,t)){let r=this.children.length;for(;r--;){let n=this.children[r];B4.is(n)&&Joe.call(n,e,t+1)}}}function $oe(){if(void 0===this.shapesDataTexture.value){let e=new _V(new Float32Array(1920),Uoe,5,dN,cN);this.shapesDataTexture.value=e}let e=this.shapesDataTexture.value,t=e.image.data;e.needsUpdate=!0;let r=0,n=this.data.geometry.blendRange,i=Goe.copy(this.matrixWorld).invert(),s=0;Zoe.call(this,(e=>{var a;if(!1===e.visible)return!0;let o;if(e instanceof wne)return;if(e instanceof tie||e instanceof Roe)return;o=e instanceof X4?e.object:e;let l=null===(a=e.data)||void 0===a?void 0:a.cloner;if(W4.is(e)&&l&&!l.hideBase&&"radial"!==l.type&&!0!==l.disabled||!(o instanceof Dre))return;let c=o.geometry.userData.parameters,u=c.shapeBlendNode;if(void 0===u)return;if(qoe.multiplyMatrices(i,e.matrixWorld).decompose(Koe,Xoe,Yoe),"TorusGeometry"===c.type&&360!==c.arc){let e=c.arc*Math.PI/180;e/=4,Xoe.multiply(Qoe.set(0,0,Math.sin(e),Math.cos(e)))}let h=u.overrideGlobalBlend?u.blendRange:n;h=h/this.bboxSize*2,t[4*s]=(Koe.x-this.bboxOffset)/this.bboxSize*2,t[4*s+1]=(Koe.y-this.bboxOffset)/this.bboxSize*2,t[4*s+2]=(Koe.z-this.bboxOffset)/this.bboxSize*2,t[4*s+3]=0===u.operation?1:2===u.operation?-1:-2,t[384+4*s]=-Xoe.x,t[384+4*s+1]=-Xoe.y,t[384+4*s+2]=-Xoe.z,t[384+4*s+3]=Xoe.w;let d=new Float32Array(4),f=0;if("SphereGeometry"===c.type)c.width===c.height&&c.width===c.depth?d[0]=0:d[0]=1,d[1]=c.width/this.bboxSize,d[2]=c.height/this.bboxSize,d[3]=c.depth/this.bboxSize,r=Math.max(r,d[1]*Yoe.x+h,d[2]*Yoe.x+h,d[3]*Yoe.x+h);else if("CubeGeometry"===c.type){f=c.cornerRadius;let e=c.width,t=c.height,n=c.depth;d[0]=2,d[1]=(e-2*f)/this.bboxSize,d[2]=(t-2*f)/this.bboxSize,d[3]=(n-2*f)/this.bboxSize,r=Math.max(r,Math.sqrt(e**2+t**2+n**2)/this.bboxSize*Yoe.x+h)}else if("CylinderGeometry"===c.type){f=c.cornerRadius;let e=c.height,t=c.radiusBottom,n=c.radiusTop;if(n>=t){let r=Math.atan2(n-t,e),i=(Math.PI/2-r)/2;n-=f/Math.tan(i),t-=f*Math.tan(i)}else if(t>n){let r=Math.atan2(t-n,e),i=(Math.PI/2-r)/2;n-=f*Math.tan(i),t-=f/Math.tan(i)}d[1]=(c.height-2*f)/this.bboxSize,t===n?(d[0]=3,d[2]=t/this.bboxSize*2):(d[0]=4,d[2]=t/this.bboxSize*2,d[3]=n/this.bboxSize*2),r=Math.max(r,4*d[1]*Yoe.x+h)}else if("TorusGeometry"===c.type){if(d[0]=5,d[1]=(c.width-c.depth)/this.bboxSize,d[2]=c.depth/this.bboxSize,360!==c.arc){d[0]=6,d[3]=d[1],t[1152+4*s+3]=d[2];let e=2*Math.atan2(d[2]/2,d[1]),r=c.arc*Math.PI/180/2-e;d[1]=Math.sin(r),d[2]=Math.cos(r)}r=Math.max(r,c.width*Yoe.x/this.bboxSize+h)}t.set(d,768+4*s),t[1152+4*s]=h,t[1152+4*s+1]=f/this.bboxSize*2,t[1152+4*s+2]=Yoe.x;let p=o.material,m=p.uniforms.nodeU0.node.value,g=p.uniforms.nodeU1.value;0!==u.operation&&!u.useColor&&(g=-1),t[1536+4*s]=m.r,t[1536+4*s+1]=m.g,t[1536+4*s+2]=m.b,t[1536+4*s+3]=g,g<1&&1===this.material.defines.SHAPEBLEND_C&&(this.material.transparent=!0),s++})),this.npart=s,this.spatialPassUniforms.span.value=1.4*r}function ele(e,t){let r=!1,n=512&e.layers.mask,i=t.getLayersOfType("transmission"),s=t.getLayersOfType("outline");return s.length>0&&(e.layers.set(8),i.length>0&&e.layers.enable(3),r=!0,Ore(e),Ire(e)),0===i.length&&0===s.length&&e.layers.set(0),n&&e.layers.set(9),e instanceof Ere&&e.needsAO&&e.layers.enable(5),r}function tle(e,t){if(!t.layers)return!1;let r=512&e.layers.mask,n=!1,i=t.getLayersOfType("transmission").filter((e=>e.data.visible)),s=t.getLayersOfType("outline").filter((e=>e.data.visible));return i.length>0&&(e.layers.set(3),s.length>0&&e.layers.enable(8),n=!0),0===i.length&&0===s.length&&e.layers.set(0),r&&e.layers.set(9),e.needsAO&&e.layers.enable(5),n}var rle=new aG,nle=new sz,ile=new iz;function sle(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=e.cloner;if(i)for(let s of i.children){let i=nle.copy(s.matrixWorld).invert(),a=ile.copy(t.ray).applyMatrix4(i),o=e.matrixWorld;a.applyMatrix4(o);let l=rle;l.set(a.origin,a.direction),l.near=t.near,l.far=t.far;let c=l.intersectObject(e,!1);c.length>0&&r.push(u(u({},c[0]),{},{object:n?s:e}))}}var ale=class{constructor(){this._constraints=new Map}setConstraint(e,t){null===t?this._constraints.delete(e):this._constraints.set(e,t)}removeDependencies(e){this._constraints.delete(e)}applyConstraints(e){let t=new Set;this._constraints.forEach(((r,n)=>{let i=[n,r],s=r;for(;this._constraints.has(s);){if(s=this._constraints.get(s),i.includes(s)){console.warn("circular dependency detected: ".concat(i.join(" -> ")));break}t.has(s)||i.push(s)}for(let a=i.length-2;a>=0;a--)if(!t.has(i[a])){let r=e.find(i[a]);r?r.applyPathSnapping(e):console.warn("missing entity ".concat(i[a])),t.add(i[a])}}))}findDependency(e,t){let r=e;for(;this._constraints.has(r);)if(r=this._constraints.get(r),r===t)return!0;return!1}},ole=class{};function lle(e){let t,r,n,i,s,a,o,l,c,u,h,d,f,p,m,g;function v(e,t,a){let o=new Float32Array(u,s,3*r);n=0;let l=new Uint32Array(u,i,r);for(let r=0;r<a.length-1;r++){let i=t[r],s=e[r].elements,c=i.filter((e=>e.enabled&&"Include"===e.mode)).map((e=>"Box"===e.type?b(e):x(e))),u=i.filter((e=>e.enabled&&"Exclude"===e.mode)).map((e=>"Box"===e.type?b(e):x(e)));for(let e=a[r];e<a[r+1];e++){let t=f[3*e],r=f[3*e+1],i=f[3*e+2];if((0===c.length||y(t,r,i,c))&&(0===u.length||!y(t,r,i,u))){let a=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);o[3*n]=(s[0]*t+s[4]*r+s[8]*i+s[12])*a,o[3*n+1]=(s[1]*t+s[5]*r+s[9]*i+s[13])*a,o[3*n+2]=(s[2]*t+s[6]*r+s[10]*i+s[14])*a,l[n]=e,n++}}}}function y(e,t,r,n,i){return n["Intersect"===i?"every":"some"]((n=>{let i=function(e,t,r,n,i){let s=e-i[0],a=t-i[1],o=r-i[2],l=1/(n[3]*s+n[7]*a+n[11]*o+n[15]);return{x:(n[0]*s+n[4]*a+n[8]*o+n[12])*l+i[0],y:(n[1]*s+n[5]*a+n[9]*o+n[13])*l+i[1],z:(n[2]*s+n[6]*a+n[10]*o+n[14])*l+i[2]}}(e,t,r,n.invRotationMatrix,n.cropCenter);return Array.isArray(n)?function(e,t,r,n){return e>=n[0]&&e<=n[3]&&t>=n[1]&&t<=n[4]&&r>=n[2]&&r<=n[5]}(i.x,i.y,i.z,n):function(e,t,r,n){let i=(e-n.cropCenter[0])*n.invRadiusX,s=(t-n.cropCenter[1])*n.invRadiusY,a=(r-n.cropCenter[2])*n.invRadiusZ;return i*i+s*s+a*a<=1}(i.x,i.y,i.z,n)}))}function b(e){let t=e.cropSize[0]/2,r=e.cropSize[1]/2,n=e.cropSize[2]/2,i=[e.cropCenter[0]-t,e.cropCenter[1]-r,e.cropCenter[2]-n,e.cropCenter[0]+t,e.cropCenter[1]+r,e.cropCenter[2]+n],s=w(e.cropRotation);return Object.assign(i,{invRotationMatrix:s,cropCenter:e.cropCenter})}function w(e){let t=[],r=e[0]*Math.PI/180,n=e[1]*Math.PI/180,i=e[2]*Math.PI/180,s=Math.cos(r),a=Math.sin(r),o=Math.cos(n),l=Math.sin(n),c=Math.cos(i),u=Math.sin(i),h=s*c,d=s*u,f=a*c,p=a*u;return t[0]=o*c,t[1]=-o*u,t[2]=l,t[4]=d+f*l,t[5]=h-p*l,t[6]=-a*o,t[8]=p-h*l,t[9]=f+d*l,t[10]=s*o,t[12]=0,t[13]=0,t[14]=0,t[3]=0,t[7]=0,t[11]=0,t[15]=1,t}function x(e){let t=2/e.cropSize[0],r=2/e.cropSize[1],n=2/e.cropSize[2],i=w(e.cropRotation);return{invRadiusX:t,invRadiusY:r,invRadiusZ:n,cropCenter:e.cropCenter,invRotationMatrix:i}}e.onmessage=w=>{if(w.data.getCroppedIndexes){let t=new Uint32Array(function(e,t){let r=[],n=t.filter((e=>e.enabled&&"Include"===e.mode)).map((e=>"Box"===e.type?b(e):x(e))),i=t.filter((e=>e.enabled&&"Exclude"===e.mode)).map((e=>"Box"===e.type?b(e):x(e))),s=e.length;for(let a=0;a<s;a+=3){let t=e[a],s=e[a+1],o=e[a+2];(0===n.length||y(t,s,o,n))&&(0===i.length||!y(t,s,o,i))||r.push(a/3)}return r}(new Float32Array(w.data.positions),w.data.crops)).buffer;e.postMessage({outOfBoundsIndexes:t},[t])}else if(w.data.positions)h=w.data.positions,f=new Float32Array(h),m=w.data.meshMatrixWorlds,g=w.data.cropsArray,p=w.data.meshIndexIntervals,v(m,g,p),e.postMessage({sortSetupComplete:!0});else if(w.data.sort||w.data.newMatrixWorlds||w.data.newCropsArray)(w.data.newMatrixWorlds||w.data.newCropsArray)&&(g=w.data.newCropsArray||g,m=w.data.newMatrixWorlds||m,v(m,g,p)),function(h){let f,p=new Float64Array(u,a,16);for(let e=0;e<16;e++)p[e]=h[e];if(n>1){t.exports.sortIndexes(i,s,c,a,o,l,d.DepthMapRange,n);let e=new Uint32Array(n);f=e.buffer,e.set(new Uint32Array(u,l,n))}else if(1===n){let e=new Uint32Array(n);e[0]=new Uint32Array(u,i,r)[0],f=e.buffer}else f=new ArrayBuffer(0);e.postMessage({sortDone:!0,indexesBuffer:f},[f])}(w.data.sort.view,w.data.sort.cameraPosition);else if(w.data.init){d=w.data.init.Constants,r=w.data.init.splatCount;let n=d.BytesPerInt,h=3*d.BytesPerFloat,f=new Uint8Array(w.data.init.sorterWasmBytes),p=r*(n+h)+(r*d.BytesPerInt*2+d.DepthMapRange*d.BytesPerInt*2)+32*d.MemoryPageSize,m=Math.floor(p/d.MemoryPageSize)+1,g={module:{},env:{memory:new WebAssembly.Memory({initial:2*m,maximum:3*m,shared:!0})}};WebAssembly.compile(f).then((e=>WebAssembly.instantiate(e,g))).then((f=>{t=f,i=0,s=r*n,a=s+r*h,c=a+16*d.BytesPerFloat*2,o=c+r*d.BytesPerInt,l=o+d.DepthMapRange*d.BytesPerInt,u=g.env.memory.buffer,e.postMessage({sortSetupPhase1Complete:!0})}))}}}bL(ole,"DepthMapRange",65536),bL(ole,"MemoryPageSize",65536),bL(ole,"BytesPerFloat",4),bL(ole,"BytesPerInt",4);var cle=function(){let e=new Float32Array(1),t=new Int32Array(e.buffer);return function(r){return e[0]=r,t[0]}}(),ule=function(e,t,r,n){return e+(t<<8)+(r<<16)+(n<<24)},hle=new eB;function dle(e){let t=!1;return e.scene.objects.traverse(((e,r)=>{if(!1===r.visible)return!0;"Splat"===r.type&&(t=!0)})),t}var fle,ple,mle,gle=class extends yF{constructor(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6?arguments[6]:void 0,o=arguments.length>7?arguments[7]:void 0;super(r,n),this.splatCount=t,this.meshIndexIntervals=a,this.meshMatrixWorlds=o,this.splatBuffers=e,this.geometry=r,this.material=n,this.splatDataTextures=null,this.halfPrecisionCovariancesOnGPU=i,this.devicePixelRatio=s,this.resetLocalSplatDataAndTexturesFromSplatBuffer()}static buildMesh(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,a=gle.buildGeomtery(t),o=gle.buildMaterial(i);return new gle(e,t,a,o,r,n,i,s)}static buildMaterial(e){let t={covariancesTexture:{type:"t",value:null},centersColorsTexture:{type:"t",value:null},meshIndexIntervals:{value:e},meshMatrixWorldsTexture:{type:"t",value:null},focal:{type:"v2",value:new eB},viewport:{type:"v2",value:new eB},basisViewport:{type:"v2",value:new eB},debugColor:{type:"v3",value:new vB},covariancesTextureSize:{type:"v2",value:new eB(1024,1024)},centersColorsTextureSize:{type:"v2",value:new eB(1024,1024)},orthoZoom:{type:"f",value:-1}};return new EF({uniforms:t,vertexShader:"\n            precision highp float;\n            #include <common>\n\n            attribute uint splatIndex;\n\n            uniform highp sampler2D covariancesTexture;\n            uniform highp usampler2D centersColorsTexture;\n            uniform vec2 focal;\n            uniform vec2 viewport;\n            uniform vec2 basisViewport;\n            uniform vec2 covariancesTextureSize;\n            uniform vec2 centersColorsTextureSize;\n\t\t\t\t\t\tuniform highp sampler2D meshMatrixWorldsTexture;\n\t\t\t\t\t\tuniform uint meshIndexIntervals[257];\n\t\t\t\t\t\tuniform float orthoZoom;\n\n            varying vec4 vColor;\n            varying vec2 vUv;\n\n            varying vec2 vPosition;\n\n            const vec4 encodeNorm4 = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);\n            const uvec4 mask4 = uvec4(uint(0x000000FF), uint(0x0000FF00), uint(0x00FF0000), uint(0xFF000000));\n            const uvec4 shift4 = uvec4(0, 8, 16, 24);\n            vec4 uintToRGBAVec (uint u) {\n               uvec4 urgba = mask4 & u;\n               urgba = urgba >> shift4;\n               vec4 rgba = vec4(urgba) * encodeNorm4;\n               return rgba;\n            }\n\n            vec2 getDataUV(in int stride, in int offset, in vec2 dimensions) {\n                vec2 samplerUV = vec2(0.0, 0.0);\n                float d = float(splatIndex * uint(stride) + uint(offset)) / dimensions.x;\n                samplerUV.y = float(floor(d)) / dimensions.y;\n                samplerUV.x = fract(d);\n                return samplerUV;\n            }\n\n            void main () {\n                uvec4 sampledCenterColor = texture(centersColorsTexture, getDataUV(1, 0, centersColorsTextureSize));\n                vec3 splatCenter = uintBitsToFloat(uvec3(sampledCenterColor.gba));\n                vColor = uintToRGBAVec(sampledCenterColor.r);\n\n                vPosition = position.xy * 2.0;\n\n\t\t\t\t\t\t\t\tuint meshIndex;\n\t\t\t\t\t\t\t\tfor (int i = 1; i < 257; i++) {\n\t\t\t\t\t\t\t\t\tif (splatIndex < meshIndexIntervals[i]) {\n\t\t\t\t\t\t\t\t\t\tmeshIndex = uint(i - 1);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tfloat strideMulmeshIndex = float(4u*meshIndex);\n\t\t\t\t\t\t\t\tfloat meshMatrixWorldsTextureLength = float(256*4);\n\n\t\t\t\t\t\t\t\tmat4 modelMat = mat4(\n\t\t\t\t\t\t\t\t\ttexture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+0.0)/meshMatrixWorldsTextureLength, 0)),\n\t\t\t\t\t\t\t\t\ttexture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+1.0)/meshMatrixWorldsTextureLength, 0)),\n\t\t\t\t\t\t\t\t\ttexture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+2.0)/meshMatrixWorldsTextureLength, 0)),\n\t\t\t\t\t\t\t\t\ttexture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+3.0)/meshMatrixWorldsTextureLength, 0))\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tmat4 modelViewMat = viewMatrix * modelMat;\n\t\t\t\t\t\t\t\tvec4 viewCenter = modelViewMat * vec4(splatCenter, 1.0); \n                vec4 clipCenter = projectionMatrix * viewCenter;\n\n                vec2 sampledCovarianceA = texture(covariancesTexture, getDataUV(3, 0, covariancesTextureSize)).rg;\n                vec2 sampledCovarianceB = texture(covariancesTexture, getDataUV(3, 1, covariancesTextureSize)).rg;\n                vec2 sampledCovarianceC = texture(covariancesTexture, getDataUV(3, 2, covariancesTextureSize)).rg;\n\n                vec3 cov3D_M11_M12_M13 = vec3(sampledCovarianceA.rg, sampledCovarianceB.r);\n                vec3 cov3D_M22_M23_M33 = vec3(sampledCovarianceB.g, sampledCovarianceC.rg);\n\n                // Compute the 2D covariance matrix from the upper-right portion of the 3D covariance matrix\n                mat3 Vrk = mat3(\n                    cov3D_M11_M12_M13.x, cov3D_M11_M12_M13.y, cov3D_M11_M12_M13.z,\n                    cov3D_M11_M12_M13.y, cov3D_M22_M23_M33.x, cov3D_M22_M23_M33.y,\n                    cov3D_M11_M12_M13.z, cov3D_M22_M23_M33.y, cov3D_M22_M23_M33.z\n                );\n                float s = 1.0 / (viewCenter.z * viewCenter.z);\n\n                mat3 W = transpose(mat3(modelViewMat));\n                mat3 T = orthoZoom > 0.0 ? W : W * mat3(\n\t\t\t\t\t\t\t\t\tfocal.x / viewCenter.z, 0., -(focal.x * viewCenter.x) * s,\n\t\t\t\t\t\t\t\t\t0., focal.y / viewCenter.z, -(focal.y * viewCenter.y) * s,\n\t\t\t\t\t\t\t\t\t0., 0., 0.\n\t\t\t\t\t\t\t\t);\n                mat3 cov2Dm = transpose(T) * Vrk * T;\n                cov2Dm[0][0] += 0.3;\n                cov2Dm[1][1] += 0.3;\n\n                // We are interested in the upper-left 2x2 portion of the projected 3D covariance matrix because\n                // we only care about the X and Y values. We want the X-diagonal, cov2Dm[0][0],\n                // the Y-diagonal, cov2Dm[1][1], and the correlation between the two cov2Dm[0][1]. We don't\n                // need cov2Dm[1][0] because it is a symetric matrix.\n                vec3 cov2Dv = vec3(cov2Dm[0][0], cov2Dm[0][1], cov2Dm[1][1]);\n\n                vec3 ndcCenter = clipCenter.xyz / clipCenter.w;\n\n                // We now need to solve for the eigen-values and eigen vectors of the 2D covariance matrix\n                // so that we can determine the 2D basis for the splat. This is done using the method described\n                // here: https://people.math.harvard.edu/~knill/teaching/math21b2004/exhibits/2dmatrices/index.html\n                //\n                // This is a different approach than in the original work at INRIA. In that work they compute the\n                // max extents of the 2D covariance matrix in screen space to form an axis aligned bounding rectangle\n                // which forms the geometry that is actually rasterized. They then use the inverse 2D covariance\n                // matrix (called 'conic') to determine fragment opacity.\n                float a = cov2Dv.x;\n                float d = cov2Dv.z;\n                float b = cov2Dv.y;\n                float D = a * d - b * b;\n                float trace = a + d;\n                float traceOver2 = 0.5 * trace;\n                float term2 = sqrt(trace * trace / 4.0 - D);\n                float eigenValue1 = traceOver2 + term2;\n\t\t\t\t\t\t\t\tfloat eigenValue2 = max(traceOver2 - term2, 0.00); // prevent negative eigen value\n\n                const float maxSplatSize = 1024.0;\n                vec2 eigenVector1 = normalize(vec2(b, eigenValue1 - a));\n                // since the eigen vectors are orthogonal, we derive the second one from the first\n                vec2 eigenVector2 = vec2(eigenVector1.y, -eigenVector1.x);\n                vec2 basisVector1 = eigenVector1 * min(sqrt(2.0 * eigenValue1), maxSplatSize);\n                vec2 basisVector2 = eigenVector2 * min(sqrt(2.0 * eigenValue2), maxSplatSize);\n\n                vec2 ndcOffset = vec2(vPosition.x * basisVector1 + vPosition.y * basisVector2) * basisViewport;\n\n\t\t\t\t\t\t\t\tif (orthoZoom > 0.0) {\n\t\t\t\t\t\t\t\t\tndcOffset *= orthoZoom;\n\t\t\t\t\t\t\t\t}\n\n                gl_Position = vec4(ndcCenter.xy + ndcOffset, ndcCenter.z, 1.0);\n            }",fragmentShader:"\n            precision highp float;\n            #include <common>\n\n            uniform vec3 debugColor;\n\n            varying vec4 vColor;\n            varying vec2 vUv;\n\n            varying vec2 vPosition;\n\t\t\t\t\t\tlayout(location = 1) out vec4 gVelocity; \n\n            void main () {\n                // compute the negative squared distance from the center of the splat to the\n                // current fragment in the splat's local space.\n                float A = -dot(vPosition, vPosition);\n                if (A < -4.0) discard;\n                vec3 color = vColor.rgb;\n                A = exp(A) * vColor.a;\n                gl_FragColor = vec4(color.rgb, A);\n\t\t\t\t\t\t\t\tgVelocity = vec4(0.0); // so it is ignored by TAA\n            }",transparent:!0,alphaTest:1,blending:1,depthTest:!0,depthWrite:!1,side:2})}static buildGeomtery(e){let t=new iF;t.setIndex([0,1,2,0,2,3]);let r=new Float32Array(12),n=new Xz(r,3);t.setAttribute("position",n),n.setXYZ(0,-1,-1,0),n.setXYZ(1,-1,1,0),n.setXYZ(2,1,1,0),n.setXYZ(3,1,-1,0),n.needsUpdate=!0;let i=(new jW).copy(t),s=new Uint32Array(e),a=new MV(s,1,!1);return a.setUsage(35048),i.setAttribute("splatIndex",a),i.instanceCount=e,i}resetLocalSplatDataAndTexturesFromSplatBuffer(){this.updateLocalSplatDataFromSplatBuffer(),this.allocateAndStoreLocalSplatDataInTextures()}updateLocalSplatDataFromSplatBuffer(){this.splatBuffers.forEach((e=>e.buildPreComputedBuffers())),this.covariances=new Float32Array(6*this.splatCount),this.colors=new Uint8Array(4*this.splatCount),this.centers=new Float32Array(3*this.splatCount);let e=0,t=0,r=0;for(let n of this.splatBuffers){let i=n.nsplats;this.colors.subarray(e,e+4*i).set(n.colorsA),e+=4*i,this.centers.subarray(t,t+3*i).set(n.decoded.xyz.denormDequant().data),t+=3*i,this.covariances.subarray(r,r+6*i).set(new Float32Array(n.precomputedCovarianceBufferData)),r+=6*i}}allocateAndStoreLocalSplatDataInTextures(){let e=this.splatCount,t=new eB(4096,1024);for(;t.x*t.y*2<6*e;)t.y*=2;let r,n,i=new eB(4096,1024);for(;i.x*i.y*4<4*e;)i.y*=2;if(this.halfPrecisionCovariancesOnGPU){n=new Uint16Array(t.x*t.y*2);for(let e=0;e<this.covariances.length;e++)n[e]=PG.toHalfFloat(this.covariances[e]);r=new _V(n,t.x,t.y,gN,uN)}else n=new Float32Array(t.x*t.y*2),n.set(this.covariances),r=new _V(n,t.x,t.y,gN,cN);r.needsUpdate=!0,this.material.uniforms.covariancesTexture.value=r,this.material.uniforms.covariancesTextureSize.value.copy(t);let s=new Uint32Array(i.x*i.y*4);for(let c=0;c<e;c++){let e=4*c,t=3*c,r=4*c;s[r]=ule(this.colors[e],this.colors[e+1],this.colors[e+2],this.colors[e+3]),s[r+1]=cle(this.centers[t]),s[r+2]=cle(this.centers[t+1]),s[r+3]=cle(this.centers[t+2])}let a=new _V(s,i.x,i.y,1033,lN);a.internalFormat="RGBA32UI",a.needsUpdate=!0,this.material.uniforms.centersColorsTexture.value=a,this.material.uniforms.centersColorsTextureSize.value.copy(i);let o=new Float32Array(4096);for(let c=0;c<this.meshMatrixWorlds.length;c++)o.set(this.meshMatrixWorlds[c].elements,16*c);let l=new _V(o,1024,1,dN,cN);l.needsUpdate=!0,this.material.uniforms.meshMatrixWorldsTexture.value=l,this.material.uniformsNeedUpdate=!0,this.splatDataTextures={covariances:{data:n,texture:r,size:t},centerColors:{data:s,texture:a,size:i},meshMatrixWorlds:{data:o,texture:l}}}updateIndexes(e){let t=this.geometry;t.attributes.splatIndex.set(e),t.attributes.splatIndex.needsUpdate=!0,t.instanceCount=e.length}updateUniforms(e,t,r,n){this.splatCount>0&&(hle.set(e.x*this.devicePixelRatio,e.y*this.devicePixelRatio),this.material.uniforms.viewport.value.copy(hle),this.material.uniforms.basisViewport.value.set(2/hle.x,2/hle.y),this.material.uniforms.focal.value.set(t,r),this.material.uniforms.orthoZoom.value=n,this.material.uniformsNeedUpdate=!0)}getSplatDataTextures(){return this.splatDataTextures}getSplatCount(){return this.splatCount}getCenters(){return this.centers}getColors(){return this.colors}getCovariances(){return this.covariances}dispose(){this.geometry.dispose(),this.material.dispose(),this.splatDataTextures&&(this.splatDataTextures.covariances.texture.dispose(),this.splatDataTextures.centerColors.texture.dispose(),this.splatDataTextures.meshMatrixWorlds.texture.dispose()),this.removeFromParent()}},vle=new Promise((e=>{fle=e})),yle=!1;function ble(){if(!yle)return ple||(ple=async function(){let e=await r.e(23).then(r.bind(r,23));fle(e),yle=!0}(),ple)}vle.then((e=>mle=e));var wle=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};bL(this,"updateView",function(){let e=new sz,t=[],r=new PB(0,0,-1),n=new PB(0,0,-1),i=new PB,s=new PB;return function(){let a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=arguments.length>1?arguments[1]:void 0,l=this.updateMatrixWorldsInWorkerIfNeeded(),c=this.cropsChanged();if(!a){n.set(0,0,-1).applyQuaternion(o.quaternion);let e=!1,t=!1;if(n.dot(r)<=.95&&(e=!0),s.copy(o.position).sub(i).length()>=1&&(t=!0),!e&&!t&&!l&&!c&&!this.needsInitialRender)return}this.needsInitialRender=!1,i.copy(o.position),r.copy(n),e.copy(o.matrixWorld).invert(),e.premultiply(this.dummyPerspectiveMatrix),t[0]=o.position.x,t[1]=o.position.y,t[2]=o.position.z;let h=u(u({sort:{view:e.elements,cameraPosition:t,splatRenderCount:this.splatRenderCount,splatSortCount:this.splatRenderCount}},l?{newMatrixWorlds:this.meshMatrixWorlds}:{}),c?{newCropsArray:this.cropsArray}:{});this.sortRunning?this.queuedMessage=h:(this.queuedMessage=null,this.sortRunning=!0,this.sortWorker.postMessage(h))}}()),this.scene=e.scene,this.currentPage=null,this.devicePixelRatio=window.devicePixelRatio,this.sortWorker=null,this.splatRenderCount=0,this.splatSortCount=0,this.splatMesh=null,this.sortRunning=!1,this.meshMatrixWorlds=null,this.meshMatrixWorldsOld=null,this.cropsArray=null,this.splatEntries=null,this.queuedMessage=null,this.needsInitialRender=!0,this.dummyPerspectiveMatrix=(new sz).makePerspective(-1,1,-1,1,.1,1e3)}updateSplatMeshUniforms(e,t){let r=new eB;null!==this.splatMesh&&this.splatMesh.getSplatCount()>0&&(e.getSize(r),this.cameraFocalLengthX=t.projectionMatrix.elements[0]*this.devicePixelRatio*r.x*.45,this.cameraFocalLengthY=t.projectionMatrix.elements[5]*this.devicePixelRatio*r.y*.45,this.splatMesh.updateUniforms(r,this.cameraFocalLengthX,this.cameraFocalLengthY,t.isPerspectiveCamera?-1:t.zoom*this.devicePixelRatio))}loadSplat(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.activePage=this.scene.activePage,e.position&&(e.position=(new PB).fromArray(e.position)),e.orientation&&(e.orientation=(new TB).fromArray(e.orientation)),e.halfPrecisionCovariances=!!e.halfPrecisionCovariances;let t=[];if(this.splatEntries=t,this.activePage.traverseVisibleEntity((e=>{"Splat"===e.data.type&&t.push(e)})),this.splatMesh&&this.splatMesh.dispose(),0===t.length)return this.splatMesh=null,!1;this.meshMatrixWorlds=t.map((e=>e.matrixWorld)),this.meshMatrixWorldsOld=t.map((e=>e.matrixWorld.clone())),this.cropsArray=t.map((e=>e.data.crops.map((e=>e.data))));let r=t.map((e=>new mle.GSplineBuffer(new Uint8Array(e.data.buffer).buffer))),n=0,i=[0];for(let s of r)n+=s.getSplatCount(),i.push(n);return this.setupSplatMesh(r,n,e.position,e.orientation,e.halfPrecisionCovariances,this.devicePixelRatio,i,this.meshMatrixWorlds),this.setupSortWorker(n),!0}updateMatrixWorldsInWorkerIfNeeded(){let e=this.splatDataTextures.meshMatrixWorlds.data;for(let t=0;t<this.meshMatrixWorlds.length;t++)e.set(this.meshMatrixWorlds[t].elements,16*t);return this.splatDataTextures.meshMatrixWorlds.texture.needsUpdate=!0,!this.meshMatrixWorlds.every(((e,t)=>e.equals(this.meshMatrixWorldsOld[t])))&&(this.meshMatrixWorldsOld=this.meshMatrixWorlds.map((e=>e.clone())),!0)}cropsChanged(){let e=!1;return this.splatEntries.forEach(((t,r)=>{var n;t.data.crops.forEach(((t,n)=>{void 0===this.cropsArray[r][n]?(e=!0,this.cropsArray[r][n]=t.data):Object.entries(t.data).forEach((t=>{var i;let[s,a]=t;(Array.isArray(a)&&a.some(((e,t)=>e!==this.cropsArray[r][n][s][t]))||a!==(null===(i=this.cropsArray[r][n])||void 0===i?void 0:i[s]))&&(e=!0,this.cropsArray[r][n][s]=a)}))})),t.data.crops.length!==(null===(n=this.cropsArray[r])||void 0===n?void 0:n.length)&&(this.cropsArray[r].length=t.data.crops.length,e=!0)})),e}setupSplatMesh(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new PB,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new TB,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6?arguments[6]:void 0,o=arguments.length>7?arguments[7]:void 0;this.splatMesh=gle.buildMesh(e,t,i,s,a,o),this.splatMesh.position.copy(r),this.splatMesh.quaternion.copy(n),this.splatMesh.frustumCulled=!1,this.splatMesh.renderOrder=99999,this.splatRenderCount=t,this.splatMesh.onBeforeRender=(e,t,r)=>this.update(e,r)}setupSortWorker(e){this.sortWorker=function(e){let t=new Worker(URL.createObjectURL(new Blob(["(",lle.toString(),")(self)"],{type:"application/javascript"}))),r=atob("AGFzbQEAAAAADwhkeWxpbmsuMAEEAAAAAAETA2AAAGAIf39/f39/f38AYAABfwISAQNlbnYGbWVtb3J5AgMAgIAEAwQDAAECBzkDEV9fd2FzbV9jYWxsX2N0b3JzAAALc29ydEluZGV4ZXMAARNlbXNjcmlwdGVuX3Rsc19pbml0AAIK3gMDAwABC9IDAwF/BnwBfgJAIAdFDQAgAysDUCEMIAMrAzAhDSADKwMQIQ5BACEDRP///////+9/IQtEAAAAAAAAEAAhCgNAIAIgA0ECdGoCfyAOIAEgA0EMbGoiCCoCALuiIA0gCCoCBLuioCAMIAgqAgi7oqBEAAAAAAAAsECiIgmZRAAAAAAAAOBBYwRAIAmqDAELQYCAgIB4CzYCACAJIAsgCSALYxshCyAJIAogCSAKZBshCiADQQFqIgMgB0cNAAsgB0UNACAGuCAKIAuhoyEJQQAhAwNAAn8gCSACIANBAnRqIgEoAgC3IAuhoiIKmUQAAAAAAADgQWMEQCAKqgwBC0GAgICAeAshCCABIAg2AgAgBCAIQQJ0aiIBIAEoAgBBAWo2AgAgA0EBaiIDIAdHDQALCyAGQQJPBEAgBCgCACEIQQEhAwNAIAQgA0ECdGoiASABKAIAIAhqIgg2AgAgA0EBaiIDIAZHDQALCyAHQQFrIgGtIQ8DQCAEIAIgD6dBAnQiA2ooAgBBAnRqIgcgBygCAEEBayIHNgIAIAUgASAHa0ECdGogACADaigCADYCACAPUCEDIA9CAX0hDyADRQ0ACyAGBEAgBEEAIAZBAnT8CwALCwQAQQAL"),n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return t.postMessage({init:{sorterWasmBytes:n.buffer,splatCount:e,Constants:{BytesPerFloat:ole.BytesPerFloat,BytesPerInt:ole.BytesPerInt,DepthMapRange:ole.DepthMapRange,MemoryPageSize:ole.MemoryPageSize}}}),t}(e),this.sortWorker.onmessage=e=>{var t;e.data.sortDone?(this.sortRunning=!1,null!==(t=this.splatMesh)&&void 0!==t&&t.updateIndexes(new Uint32Array(e.data.indexesBuffer)),this.lastSortTime=e.data.sortTime,this.queuedMessage&&(this.sortWorker.postMessage(this.queuedMessage),this.queuedMessage=null)):e.data.sortCanceled?this.sortRunning=!1:e.data.sortSetupPhase1Complete?this.sortWorker.postMessage({positions:this.splatMesh.getCenters().buffer,meshMatrixWorlds:this.splatMesh.meshMatrixWorlds,meshIndexIntervals:this.splatMesh.meshIndexIntervals,cropsArray:this.cropsArray}):e.data.sortSetupComplete&&(this.splatDataTextures=this.splatMesh.getSplatDataTextures(),this.scene.activePage.add(this.splatMesh),this.needsInitialRender=!0)}}update(e,t){null!==this.splatMesh&&(this.updateSplatMeshUniforms(e,t),this.updateView(!1,t))}getSplatMesh(){return this.splatMesh}},xle=new Wz;xle.wireframe=!0;var Sle=new PB,_le=class extends yV{constructor(e,t){super(),this.data=e,this.sharedAssets=t,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.splatViewer=null,this.shapeBlendIntances=[],this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new ale,this.invisibleObjects=new eie("jflkdsafjasdifjaslk",u(u({},X1.defaultData),{},{visible:!1,name:"buildin invisible"})),this.needsRecomputeInstances=!1,this.init(e,t),this.matrixAutoUpdate=!1,this.errorPage=new uoe("fdasfa",u(u({},r2.defaultData),{},{name:""}),{shared:t,scene:this})}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=function(e){let t=!1;return e.traverseEntity((e=>{if(e instanceof Ere)if(Array.isArray(e.material))for(let r=0;r<e.material.length;r++)tle(e,e.material[r])&&(t=!0);else tle(e,e.material)&&(t=!0)})),t}(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=function(e){let t=!1;return e.traverseEntity((e=>{if(e instanceof Ere)if(Array.isArray(e.material))for(let r=0;r<e.material.length;r++)ele(e,e.material[r])&&(t=!0);else ele(e,e.material)&&(t=!0)})),t}(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(e){let t=e.identity.join("-"),r=this.entityIdentityToEntity[t];r&&(e.uuid=r.uuid),this.entityIdentityToEntity[t]=e,this.entityByUuid[e.uuid]=e}markPenumbraSizeDirty(){for(let e of this.children)e instanceof uoe&&(e.penumbraSizeArrayCache=null)}findInstance(e){return this.entityIdentityToEntity[e.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(e){let t=this.find(e);if(void 0===t)return;let r=[],n=t;for(;n!==this;){let e=n;n=n.parent;let t=n.children.indexOf(e);r.splice(0,0,t)}return{entity:t,sortKey:r}}getAllSorted(e){let t=[];for(let r of e){let e=this.getWithSortKey(r.id);void 0!==e&&t.push(e)}return t.sort(((e,t)=>MZ(e.sortKey,t.sortKey))),t.map((e=>e.entity))}nonExistOrDescendantOf(e,t){let r=this.find(e);if(void 0===r)return!0;for(;r;){if(r.uuid===t)return!0;r=r.parent}return!1}find(e){if(this.activePage&&this.activePage.personalCamera.parent){if("f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera"===e)return this.activePage.personalCamera;if(e===t1)return this.activePage.personalCamera}if(""===e||void 0===e)return;let t=this.entityByUuid[e];return void 0===t?this.getObjectByProperty("uuid",e):t}find2D(e){for(let t of this.children)if(t instanceof uoe&&t.uiScene){let r=t.uiScene.find(e);if(r)return r}}findScene2DfromObject2D(e){for(let t of this.children)if(t instanceof uoe&&t.uiScene&&t.uiScene.find(e))return t.uiScene}find2DInUIObjects(e){let t;return this.traverseEntity((r=>{void 0===t&&r instanceof woe&&(t=r.uiCanvas.find(e))})),t}traverse2D(e){for(let t of this.children)t instanceof uoe&&t.uiScene&&t.uiScene.traverse(e)}debugEnsureEntity(e){let t=this.find(e);t?Array.isArray(t.identity)&&void 0===this.findInstance(t.identity)&&console.error("not found instance"):console.error("not found")}addPendingExpandCloner(e){this.toExpandCloner.add(e)}addPendingUpdateCloner(e){this.toUpdateCloner.add(e)}markToExpandCloner(e){this.toExpandCloner.add(e),e.traverseEntityAncestors((e=>{this.toExpandCloner.add(e)}))}doPendingExpandCloner(){this.toExpandCloner.forEach((e=>{e.expandCloner(this)})),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach((e=>{var t;null===(t=e.cloner)||void 0===t||t.update()})),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(e){this.pendingCommands.push(e)}applyPendingCommands(){this.pendingCommands.forEach((e=>e())),this.pendingCommands.length=0}updateByLibOp(e,t){1===e.path.length&&"components"===e.path[0]&&1===e.type&&this.createChildrenObjects([u(u({},e.data.asset),{},{id:e.id})],this.invisibleObjects,t)}updateTreeByOp(e,t){if(0===e.path.length&&7===e.type){let r=null===e.parent?this:this.find(e.parent);if(void 0===r)throw new Error("unexpected");let n=this.createObject(e.id,e.data,e.children,r,e.localIndex,t);n.updateVisible(this),n.resetBBoxNeedsUpdate(),qne(n)&&Xne(n.parent)&&(n.invalidateUpstreamBooleanData(),n.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(r),this.markNeedsRecomputeInstancesForChildren(n),this.markToExpandCloner(n),this.markPenumbraSizeDirty(),n.updatePathSnapping()}else if(0===e.path.length&&8===e.type){let t=this.find(e.id);if(void 0===t)throw new Error("unexpected");t.traverseEntity((e=>{e instanceof Woe&&(this.shapeBlendIntances=this.shapeBlendIntances.filter((t=>t!==e)))})),this.markToExpandCloner(t),t.resetBBoxNeedsUpdate(),this.unregisterObject(t);let r=t.parent;this.markNeedsRecomputeInstancesForAncessors(r),this.markNeedsRecomputeInstancesForChildren(t),this.markPenumbraSizeDirty(),t.parent.remove(t),Xne(t.parent)&&(t.parent.invalidateUpstreamBooleanData(),t.parent.invalidateDownstreamBooleanData().recomputeBoolean()),qne(t)&&(t.freeBooleanPointer(),r instanceof Wne&&r.invalidateDownstreamBooleanData().recomputeBoolean()),t instanceof foe&&t.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(t),this.pathConstraints.removeDependencies(t.uuid),t.updatePathSnapping()}else if(0===e.path.length&&9===e.type){var r;let t=this.find(e.id);if(void 0===t)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(t);let n=t.parent;this.markNeedsRecomputeInstancesForAncessors(n),null!==(r=t.cloner)&&void 0!==r&&r.resetOnMove(),this.markToExpandCloner(t);let i=null===e.parent?this:this.find(e.parent);if(void 0===i)throw new Error("unexpected");i.add(t),this.markNeedsRecomputeInstancesForAncessors(i),this.markToExpandCloner(t),t.invalidateClonerTransform(t),t.updateVisible(this),t.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let s=e.localIndex;i.children.splice(s,0,i.children.pop()),qne(t)&&(t.invalidateUpstreamBooleanData(),Xne(t.parent)?t.parent.invalidateDownstreamBooleanData().recomputeBoolean():n instanceof Wne&&n.invalidateDownstreamBooleanData().recomputeBoolean()),t.updatePathSnapping()}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){var e;return null!==(e=this.find(this.data.publish.playPage))&&void 0!==e?e:this.errorPage}updatePage(e){var t;this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let r of this.children)r instanceof uoe&&(r.visible=r.uuid===e,r.visible&&(this.activePage=r,this.activePage.onActive(this)));this.activePage!==(null===(t=this.splatViewer)||void 0===t?void 0:t.activePage)&&this.reloadSplats()}updateEntityByOp(e,t,r,n){if(0===t.type){if(("overrides"in t.props||"component"in t.props)&&this.markNeedsRecomputeInstances(),"visible"in t.props&&this.markPenumbraSizeDirty(),t.path.includes("overrides")&&"states"in t.props){let{rest:e}=t.props;t=u(u({},t),{},{props:e}),this.markNeedsRecomputeInstances()}"pathSnapping"===t.path[0]&&void 0!==t.props.pathId&&this.pathConstraints.setConstraint(e,t.props.pathId)}let i=this.find(e);if(i)try{(function(e,t,r,n){e.updateByOp(t,r,n,!1)})(i,t,r,{scene:this,shared:n}),i instanceof Dre&&i.updateGeometryGroupsIfNeeded()}catch(B0){console.error(B0)}}updateEntity2DByOp(e,t,r,n,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];e.updateEntityByOp(t,r,n,i),this.traverseEntity((e=>{var a;(e instanceof woe||e instanceof uoe)&&(s.includes(null!==(a=e.frameId)&&void 0!==a?a:"")||e.frameId===t)&&e.updateEntity2DByOp(t,r,n,i)}))}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(e){this.activePage.switchActiveCamera(e)}isInvisibleObjects(e){return e===this.invisibleObjects||e.hasAnccestor(this.invisibleObjects)}init(e,t){let r=Object.entries(t.data.lib.components).map(((e,t)=>({data:e[1].asset.data,children:e[1].asset.children,id:e[0],fi:t})));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:t}),this.add(this.invisibleObjects),this.createChildrenObjects(r,this.invisibleObjects,t),this.createChildrenObjects(e.objects,this,t),this.updatePage(e.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(t,!0),this.traverseEntity((e=>{e instanceof Fne&&e.updateUp()})),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(e){e.traverseEntity((e=>{("Component"===e.data.type||"Instance"===e.data.type)&&this.markNeedsRecomputeInstances()}))}markNeedsRecomputeInstancesForAncessors(e){W4.is(e)&&("Component"===e.data.type&&this.markNeedsRecomputeInstances(),e.traverseAncestors((e=>{W4.is(e)&&"Component"===e.data.type&&this.markNeedsRecomputeInstances()})))}relativeizeInner(e,t,r,n,i,s,a){if(e){let o=n.find(e);o&&o!==n&&i.forInstancesRec((n=>{n.data=RJ(n.data,(i=>{let o=i.events.data(a.id),l=n.goUp(s);if(l){let n=[...AZ(l.identity),e].join("-"),i=this.entityIdentityToEntity[n];if(i){let e=i.uuid;kJ.zoom(o,t)[r]=e}else console.warn("cannot find instance")}})).data}))}}rewriteActions(e,t,r,n,i,s){e.forEach((e=>{"Transition"===e.data.type||"Animation"===e.data.type?this.relativeizeInner(e.data.object,[...t,e.id],"object",r,n,i,s):"Conditional"===e.data.type&&(this.rewriteActions(e.data.ifActions,[...t,e.id,"ifActions"],r,n,i,s),this.rewriteActions(e.data.elseActions,[...t,e.id,"elseActions"],r,n,i,s))}))}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity((e=>{if(e instanceof moe&&"string"==typeof e.identity&&"Component"===e.data.type)return e.traverseEntity(((t,r)=>{t.data.events.forEach((n=>{if("GameControl"===n.data.type){let i=!1;if(t.forInstancesRec((e=>{e.data=RJ(e.data,(t=>{e.isInstanceRoot||(t.events.delete(n.id),i=!0)})).data})),!1===i)for(let s of x2.list)this.rewriteActions(n.data.gameActions[s],["gameActions",s],e,t,r,n)}else"Conditional"===n.data.type?("Distance"===n.data.condition.type?(this.relativeizeInner(n.data.condition.fromObject,["condition"],"fromObject",e,t,r,n),this.relativeizeInner(n.data.condition.toObject,["condition"],"toObject",e,t,r,n)):"State"===n.data.condition.type?this.relativeizeInner(n.data.condition.object,["condition"],"object",e,t,r,n):"Comparison"===n.data.condition.type&&("Property"===n.data.condition.lOperand.type&&this.relativeizeInner(n.data.condition.lOperand.value[0],["condition","lOperand","value"],0,e,t,r,n),"Property"===n.data.condition.rOperand.type&&this.relativeizeInner(n.data.condition.rOperand.value[0],["condition","rOperand","value"],0,e,t,r,n)),this.rewriteActions(n.data.inActions,["inActions"],e,t,r,n),this.rewriteActions(n.data.outActions,["outActions"],e,t,r,n)):"actions"in n.data&&this.rewriteActions(n.data.actions,["actions"],e,t,r,n)}))})),!0}))}expandInstances(e,t,r){let n=new Set;this.traverseEntity((i=>{if(i instanceof moe&&i.isInstanceRoot)return i.expandInstanceChildren({scene:this,shared:e,pendingDeletes:n}),t||i.resetBBoxNeedsUpdate(),r&&i.traverseEntity((e=>{r.addClip(e)})),!0}));for(let i of n)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(i),goe(i)}recomputeInstances(e,t){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity((e=>{e instanceof moe&&e.isInstanceRoot&&(e.component=void 0)})),this.expandInstances(e,!1,t))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(e){e.traverseEntity((e=>{let t="string"==typeof e.identity?e.identity:e.identity.join("-");this.entityIdentityToEntity[t]===e&&(delete this.entityByUuid[e.uuid],delete this.entityIdentityToEntity[t]),e.dispose()}))}clearScene(){for(let e of this.children)W4.is(e)&&e.disposeRecursively();this.children.length=0}resetAfterClear(e,t){this.init(e,t)}raycast(e){return this.raycast1(e,!1)}raycast1(e,t){let r=[],n=i=>{for(let s of i.children){let i=s.cloner;if(W4.is(s)&&!s.raycastLock&&(s.visible||null!==i&&void 0!==i&&i.object.data.visible))if(!0===t&&s.isInstanceRoot){let t=[];if(e.intersectObject(s,!0,t),t.length){let e=t[0];e.object=s,e.point.applyMatrix4(e.object.matrixWorld);let n=s.matrixWorld.clone().invert();e.point.applyMatrix4(n),r.push(e)}}else(qne(s)||Yne(s)&&this.enableHelpers&&s.objectHelper.visible)&&(e.intersectObject(s,!1,r),sle(s,e,r)),n(s)}};return n(this.activePage),r}raycastWithClones(e){let t=[],r=n=>{for(let i of n.children){let n=i.cloner;W4.is(i)&&(i.visible||(null===n||void 0===n?void 0:n.object.data.visible))&&((qne(i)||Yne(i)&&this.enableHelpers&&i.objectHelper.visible)&&(e.intersectObject(i,!1,t),sle(i,e,t,!0)),r(i))}};return r(this),t}forEachEntity(e){for(let t of this.children)W4.is(t)&&e(t)}traverseConcreteEntity(e){for(let t of this.children)W4.is(t)&&t.isConcreteEntity&&t.traverseEntity(e)}traverseEntity(e){for(let t of this.children)W4.is(t)&&t.traverseEntity(e)}updateFont(e,t){this.traverseEntity((r=>{if(r instanceof Dre&&"Mesh"===r.data.type&&("TextGeometry"===r.data.geometry.type||"InputGeometry"===r.data.geometry.type)&&r.data.geometry.font===e){let n=r.geometry,i=r.data.geometry;n.updateFont(e,t).then((()=>{n.update(i);let e=r.invalidateDownstreamBooleanData();Xne(e)&&e.recomputeBoolean()}))}}))}traverseObject(e){for(let t of this.children)B4.is(t)&&t.traverseObject(e)}traverseVisibleEntity(e){for(let t of this.children)W4.is(t)&&t.visible&&t.traverseVisibleEntity(e)}dispose(){this.clearScene()}createChildrenObjects(e,t,r){let n=0;for(let i of e)this.createObject(i.id,i.data,i.children,t,n,r),n+=1}registerObjectCreatedInLegacy(e){this.entityByUuid[e.uuid]=e}unregisterObject(e){delete this.entityByUuid[e.uuid];for(let t of e.children)this.unregisterObject(t)}createObject(e,t,r,n,i,s){var a;let o={scene:this,shared:s},l=Noe(e,t,o);return l instanceof Woe&&this.shapeBlendIntances.push(l),l&&(this.entityByUuid[e]=l,n.add(l),n.children.splice(i,0,n.children.pop()),r.length>0&&(l.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(r,l,s)),l.updateState(t,o),l instanceof Dre&&l.updateGeometryGroupsIfNeeded(),l.updateVisible(this),l.cloner&&this.toExpandCloner.add(l),null!==(a=t.pathSnapping)&&void 0!==a&&a.pathId&&this.pathConstraints.setConstraint(e,t.pathSnapping.pathId)),"Empty"===t.type&&t.animations&&l.traverseEntity((e=>{let t=e.dataPatched;if(e instanceof Dre&&t.bones&&t.boneInverses){let r=t.bones.map((e=>this.find(e))),n=t.boneInverses.map((e=>(new sz).fromArray(e))),i=new AV(r,n);e.bind(i,e.bindMatrix)}else e.matrixAutoUpdate=!0})),l}getCenter(e){let t=[];for(let n=0,i=e.length;n<i;++n){let{id:r,recursive:i}=e[n],s=this.find(r),a=i?s.recursiveBBox:s.singleBBox;t.push(...a.vertices)}let r=new IB;return r.setFromPoints(t),r.getCenter(Sle),Sle}copyMatrixWorld(e,t){if(null===e)return void t.identity();let r=this.find(e);r?t.copy(r.matrixWorld):t.identity()}copyParentMatrixWorld(e,t){var r;if(null===e)return void t.identity();let n=null===(r=this.find(e))||void 0===r?void 0:r.parent;n?t.copy(n.matrixWorld):t.identity()}traverseMaterial(e){this.traverseEntity((t=>{if(t instanceof z9)if(Array.isArray(t.material))for(let r=0;r<t.material.length;r++)t.material[r]instanceof bte&&e(t.material[r]);else t.material instanceof bte&&e(t.material)}))}updateViewPlaneSize(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.traverseConcreteEntity((n=>{n instanceof Fne&&n.setViewplaneSize(e,t,r)}))}initializeSplatViewer(){this.splatViewer=new wle({scene:this}),this.reloadSplats()}reloadSplats(){var e;null===(e=this.splatViewer)||void 0===e||e.loadSplat()}},Cle=(e,t)=>{let r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)},Ele=e=>e*(Math.PI/180),Ale=e=>e*(180/Math.PI),Mle=new Map,Tle=e=>{Mle.has(e)&&clearTimeout(Mle.get(e)),Mle.set(e,setTimeout(e,100))},Ple=(e,t,r)=>{let n,i=t.split(/[ ,]+/g);for(let s=0;s<i.length;s+=1)n=i[s],e.addEventListener?e.addEventListener(n,r,!1):e.attachEvent&&e.attachEvent(n,r)},kle=(e,t,r)=>{let n,i=t.split(/[ ,]+/g);for(let s=0;s<i.length;s+=1)n=i[s],e.removeEventListener?e.removeEventListener(n,r):e.detachEvent&&e.detachEvent(n,r)},Dle=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),Ile=()=>{if(typeof window>"u")return;return{x:void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},Ole=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},Rle=(e,t,r)=>{let n=Lle(e);for(let i in n)if(n.hasOwnProperty(i))if("string"==typeof t)n[i]=t+" "+r;else{let e="";for(let n=0,i=t.length;n<i;n+=1)e+=t[n]+" "+r+", ";n[i]=e.slice(0,-2)}return n},Lle=e=>{let t={};return t[e]="",["webkit","Moz","o"].forEach((function(r){t[r+e.charAt(0).toUpperCase()+e.slice(1)]=""})),t},Nle=(e,t)=>{for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},Ble=(e,t)=>{if(e.length)for(let r=0,n=e.length;r<n;r+=1)t(e[r]);else t(e)};typeof window<"u"&&(zle="ontouchstart"in window,Fle=!!window.PointerEvent,jle=!!window.MSPointerEvent);var zle,Fle,jle,Ule,Vle={start:"mousedown",move:"mousemove",end:"mouseup"},Hle={};function Wle(){}Fle?Ule={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:jle?Ule={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:zle?(Ule={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},Hle=Vle):Ule=Vle,Wle.prototype.on=function(e,t){var r,n=this,i=e.split(/[ ,]+/g);n._handlers_=n._handlers_||{};for(var s=0;s<i.length;s+=1)r=i[s],n._handlers_[r]=n._handlers_[r]||[],n._handlers_[r].push(t);return n},Wle.prototype.off=function(e,t){var r=this;return r._handlers_=r._handlers_||{},void 0===e?r._handlers_={}:void 0===t?r._handlers_[e]=null:r._handlers_[e]&&r._handlers_[e].indexOf(t)>=0&&r._handlers_[e].splice(r._handlers_[e].indexOf(t),1),r},Wle.prototype.trigger=function(e,t){var r,n=this,i=e.split(/[ ,]+/g);n._handlers_=n._handlers_||{};for(var s=0;s<i.length;s+=1)r=i[s],n._handlers_[r]&&n._handlers_[r].length&&n._handlers_[r].forEach((function(e){e.call(n,{type:r,target:n},t)}))},Wle.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=((e,t)=>{let r={};for(let n in e)e.hasOwnProperty(n)&&t.hasOwnProperty(n)?r[n]=t[n]:e.hasOwnProperty(n)&&(r[n]=e[n]);return r})(t.options,e))},Wle.prototype.bindEvt=function(e,t){var r=this;return r._domHandlers_=r._domHandlers_||{},r._domHandlers_[t]=function(){"function"==typeof r["on"+t]?r["on"+t].apply(r,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},Ple(e,Ule[t],r._domHandlers_[t]),Hle[t]&&Ple(e,Hle[t],r._domHandlers_[t]),r},Wle.prototype.unbindEvt=function(e,t){var r=this;return r._domHandlers_=r._domHandlers_||{},kle(e,Ule[t],r._domHandlers_[t]),Hle[t]&&kle(e,Hle[t],r._domHandlers_[t]),delete r._domHandlers_[t],this};var Gle=Wle;function qle(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),"dynamic"===this.options.mode&&(this.options.restOpacity=0),this.id=qle.id,qle.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}qle.prototype=new Gle,qle.constructor=qle,qle.id=0,qle.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly||(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front)),this},qle.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=((e,t)=>{let r=Lle(e);for(let n in r)r.hasOwnProperty(n)&&(r[n]=t);return r})("borderRadius","50%"),r=Rle("transition","opacity",e),n={};return n.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},n.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},n.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},Nle(n.el,r),"circle"===this.options.shape&&Nle(n.back,t),Nle(n.front,t),this.applyStyles(n),this},qle.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var r in e[t])this.ui[t].style[r]=e[t][r];return this},qle.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)||this.options.zone.appendChild(this.ui.el),this},qle.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)||this.options.zone.removeChild(this.ui.el),this},qle.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},qle.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout((function(){t.ui.el.style.opacity=1}),0),t.showTimeout=setTimeout((function(){t.trigger("shown",t.instance),"function"==typeof e&&e.call(this)}),t.options.fadeTime)),t},qle.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout((function(){var r="dynamic"===t.options.mode?"none":"block";t.ui.el.style.display=r,"function"==typeof e&&e.call(t),t.trigger("hidden",t.instance)}),t.options.fadeTime),t.options.restJoystick){let r=t.options.restJoystick,n={};n.x=!0===r||!1!==r.x?0:t.instance.frontPosition.x,n.y=!0===r||!1!==r.y?0:t.instance.frontPosition.y,t.setPosition(e,n)}return t},qle.prototype.setPosition=function(e,t){var r=this;r.frontPosition={x:t.x,y:t.y};var n=r.options.fadeTime+"ms",i={};i.front=Rle("transition",["top","left"],n);var s={front:{}};s.front={left:r.frontPosition.x+"px",top:r.frontPosition.y+"px"},r.applyStyles(i),r.applyStyles(s),r.restTimeout=setTimeout((function(){"function"==typeof e&&e.call(r),r.restCallback()}),r.options.fadeTime)},qle.prototype.restCallback=function(){var e=this,t={};t.front=Rle("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)},qle.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},qle.prototype.computeDirection=function(e){var t,r,n,i=e.angle.radian,s=Math.PI/4,a=Math.PI/2;if(i>s&&i<3*s&&!e.lockX?t="up":i>-s&&i<=s&&!e.lockY?t="left":i>3*-s&&i<=-s&&!e.lockX?t="down":e.lockY||(t="right"),e.lockY||(r=i>-a&&i<a?"left":"right"),e.lockX||(n=i>0?"up":"down"),e.force>this.options.threshold){var o,l={};for(o in this.direction)this.direction.hasOwnProperty(o)&&(l[o]=this.direction[o]);var c={};for(o in this.direction={x:r,y:n,angle:t},e.direction=this.direction,l)l[o]===this.direction[o]&&(c[o]=!0);if(c.x&&c.y&&c.angle)return e;(!c.x||!c.y)&&this.trigger("plain",e),c.x||this.trigger("plain:"+r,e),c.y||this.trigger("plain:"+n,e),c.angle||this.trigger("dir dir:"+t,e)}else this.resetDirection();return e};var Xle=qle;function Yle(e,t){var r=this;r.nipples=[],r.idles=[],r.actives=[],r.ids=[],r.pressureIntervals={},r.manager=e,r.id=Yle.id,Yle.id+=1,r.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},r.config(t),("static"===r.options.mode||"semi"===r.options.mode)&&(r.options.multitouch=!1),r.options.multitouch||(r.options.maxNumberOfNipples=1);let n=getComputedStyle(r.options.zone.parentElement);return n&&"flex"===n.display&&(r.parentIsFlex=!0),r.updateBox(),r.prepareNipples(),r.bindings(),r.begin(),r.nipples}Yle.prototype=new Gle,Yle.constructor=Yle,Yle.id=0,Yle.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(e){if(void 0===e)return t[0];for(var r=0,n=t.length;r<n;r+=1)if(t[r].identifier===e)return t[r];return!1}},Yle.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"},Yle.prototype.begin=function(){var e=this,t=e.options;if("static"===t.mode){var r=e.createNipple(t.position,e.manager.getIdentifier());r.add(),e.idles.push(r)}},Yle.prototype.createNipple=function(e,t){var r=this,n=r.manager.scroll,i={},s=r.options,a=r.parentIsFlex?n.x:n.x+r.box.left,o=r.parentIsFlex?n.y:n.y+r.box.top;if(e.x&&e.y)i={x:e.x-a,y:e.y-o};else if(e.top||e.right||e.bottom||e.left){var l=document.createElement("DIV");l.style.display="hidden",l.style.top=e.top,l.style.right=e.right,l.style.bottom=e.bottom,l.style.left=e.left,l.style.position="absolute",s.zone.appendChild(l);var c=l.getBoundingClientRect();s.zone.removeChild(l),i=e,e={x:c.left+n.x,y:c.top+n.y}}var u=new Xle(r,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:t,position:e,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(Ole(u.ui.el,i),Ole(u.ui.front,u.frontPosition)),r.nipples.push(u),r.trigger("added "+u.identifier+":added",u),r.manager.trigger("added "+u.identifier+":added",u),r.bindNipple(u),u},Yle.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},Yle.prototype.bindNipple=function(e){var t,r=this,n=function(e,n){t=e.type+" "+n.id+":"+e.type,r.trigger(t,n)};e.on("destroyed",r.onDestroyed.bind(r)),e.on("shown hidden rested dir plain",n),e.on("dir:up dir:right dir:down dir:left",n),e.on("plain:up plain:right plain:down plain:left",n)},Yle.prototype.pressureFn=function(e,t,r){var n=this,i=0;clearInterval(n.pressureIntervals[r]),n.pressureIntervals[r]=setInterval(function(){var r=e.force||e.pressure||e.webkitForce||0;r!==i&&(t.trigger("pressure",r),n.trigger("pressure "+t.identifier+":pressure",r),i=r)}.bind(n),100)},Yle.prototype.onstart=function(e){var t=this,r=t.options,n=e;e=Dle(e),t.updateBox();return Ble(e,(function(i){t.actives.length<r.maxNumberOfNipples?t.processOnStart(i):n.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach((function(r){if(Object.values(n.touches).findIndex((function(e){return e.identifier===r}))<0){var i=[e[0]];i.identifier=r,t.processOnEnd(i)}})),t.actives.length<r.maxNumberOfNipples&&t.processOnStart(i))})),t.manager.bindDocument(),!1},Yle.prototype.processOnStart=function(e){var t,r=this,n=r.options,i=r.manager.getIdentifier(e),s=e.force||e.pressure||e.webkitForce||0,a={x:e.pageX,y:e.pageY},o=r.getOrCreate(i,a);o.identifier!==i&&r.manager.removeIdentifier(o.identifier),o.identifier=i;var l=function(t){t.trigger("start",t),r.trigger("start "+t.id+":start",t),t.show(),s>0&&r.pressureFn(e,t,t.identifier),r.processOnMove(e)};if((t=r.idles.indexOf(o))>=0&&r.idles.splice(t,1),r.actives.push(o),r.ids.push(o.identifier),"semi"!==n.mode)l(o);else{if(!(Cle(a,o.position)<=n.catchDistance))return o.destroy(),void r.processOnStart(e);l(o)}return o},Yle.prototype.getOrCreate=function(e,t){var r,n=this,i=n.options;return/(semi|static)/.test(i.mode)?(r=n.idles[0])?(n.idles.splice(0,1),r):"semi"===i.mode?n.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1):r=n.createNipple(t,e)},Yle.prototype.processOnMove=function(e){var t=this,r=t.options,n=t.manager.getIdentifier(e),i=t.nipples.get(n),s=t.manager.scroll;if((e=>isNaN(e.buttons)?0!==e.pressure:0!==e.buttons)(e)){if(!i)return console.error("Found zombie joystick with ID "+n),void t.manager.removeIdentifier(n);if(r.dynamicPage){var a=i.el.getBoundingClientRect();i.position={x:s.x+a.left,y:s.y+a.top}}i.identifier=n;var o=i.options.size/2,l={x:e.pageX,y:e.pageY};r.lockX&&(l.y=i.position.y),r.lockY&&(l.x=i.position.x);var c,u,h=Cle(l,i.position),d=((e,t)=>{let r=t.x-e.x,n=t.y-e.y;return Ale(Math.atan2(n,r))})(l,i.position),f=Ele(d),p=h/o,m={distance:h,position:l};if("circle"===i.options.shape?(c=Math.min(h,o),u=((e,t,r)=>{let n={x:0,y:0};return r=Ele(r),n.x=e.x-t*Math.cos(r),n.y=e.y-t*Math.sin(r),n})(i.position,c,d)):(u=((e,t,r)=>({x:Math.min(Math.max(e.x,t.x-r),t.x+r),y:Math.min(Math.max(e.y,t.y-r),t.y+r)}))(l,i.position,o),c=Cle(u,i.position)),r.follow){if(h>o){let e=l.x-u.x,r=l.y-u.y;i.position.x+=e,i.position.y+=r,i.el.style.top=i.position.y-(t.box.top+s.y)+"px",i.el.style.left=i.position.x-(t.box.left+s.x)+"px",h=Cle(l,i.position)}}else l=u,h=c;var g=l.x-i.position.x,v=l.y-i.position.y;i.frontPosition={x:g,y:v},r.dataOnly||Ole(i.ui.front,i.frontPosition);var y={identifier:i.identifier,position:l,force:p,pressure:e.force||e.pressure||e.webkitForce||0,distance:h,angle:{radian:f,degree:d},vector:{x:g/o,y:-v/o},raw:m,instance:i,lockX:r.lockX,lockY:r.lockY};(y=i.computeDirection(y)).angle={radian:Ele(180-d),degree:180-d},i.trigger("move",y),t.trigger("move "+i.id+":move",y)}else this.processOnEnd(e)},Yle.prototype.processOnEnd=function(e){var t=this,r=t.options,n=t.manager.getIdentifier(e),i=t.nipples.get(n),s=t.manager.removeIdentifier(i.identifier);!i||(r.dataOnly||i.hide((function(){"dynamic"===r.mode&&(i.trigger("removed",i),t.trigger("removed "+i.id+":removed",i),t.manager.trigger("removed "+i.id+":removed",i),i.destroy())})),clearInterval(t.pressureIntervals[i.identifier]),i.resetDirection(),i.trigger("end",i),t.trigger("end "+i.id+":end",i),t.ids.indexOf(i.identifier)>=0&&t.ids.splice(t.ids.indexOf(i.identifier),1),t.actives.indexOf(i)>=0&&t.actives.splice(t.actives.indexOf(i),1),/(semi|static)/.test(r.mode)?t.idles.push(i):t.nipples.indexOf(i)>=0&&t.nipples.splice(t.nipples.indexOf(i),1),t.manager.unbindDocument(),/(semi|static)/.test(r.mode)&&(t.manager.ids[s.id]=s.identifier))},Yle.prototype.onDestroyed=function(e,t){var r=this;r.nipples.indexOf(t)>=0&&r.nipples.splice(r.nipples.indexOf(t),1),r.actives.indexOf(t)>=0&&r.actives.splice(r.actives.indexOf(t),1),r.idles.indexOf(t)>=0&&r.idles.splice(r.idles.indexOf(t),1),r.ids.indexOf(t.identifier)>=0&&r.ids.splice(r.ids.indexOf(t.identifier),1),r.manager.removeIdentifier(t.identifier),r.manager.unbindDocument()},Yle.prototype.destroy=function(){var e=this;for(var t in e.unbindEvt(e.options.zone,"start"),e.nipples.forEach((function(e){e.destroy()})),e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};var Kle=Yle;function Qle(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=Ile(),t.config(e),t.prepareCollections();var r=function(){var e;t.collections.forEach((function(r){r.forEach((function(r){e=r.el.getBoundingClientRect(),r.position={x:t.scroll.x+e.left,y:t.scroll.y+e.top}}))}))};if(typeof window>"u")return t.collections;Ple(window,"resize",(function(){Tle(r)}));var n=function(){t.scroll=Ile()};return Ple(window,"scroll",(function(){Tle(n)})),t.collections}Qle.prototype=new Gle,Qle.constructor=Qle,Qle.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var r;return e.collections.every((function(e){return!(r=e.get(t))})),r}},Qle.prototype.create=function(e){return this.createCollection(e)},Qle.prototype.createCollection=function(e){var t=this,r=new Kle(t,e);return t.bindCollection(r),t.collections.push(r),r},Qle.prototype.bindCollection=function(e){var t,r=this,n=function(e,n){t=e.type+" "+n.id+":"+e.type,r.trigger(t,n)};e.on("destroyed",r.onDestroyed.bind(r)),e.on("shown hidden rested dir plain",n),e.on("dir:up dir:right dir:down dir:left",n),e.on("plain:up plain:right plain:down plain:left",n)},Qle.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)},Qle.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||!0===e)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)},Qle.prototype.getIdentifier=function(e){var t;return e?void 0===(t=void 0===e.identifier?e.pointerId:e.identifier)&&(t=this.latest||0):t=this.index,void 0===this.ids[t]&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]},Qle.prototype.removeIdentifier=function(e){var t={};for(var r in this.ids)if(this.ids[r]===e){t.id=r,t.identifier=this.ids[r],delete this.ids[r];break}return t},Qle.prototype.onmove=function(e){return this.onAny("move",e),!1},Qle.prototype.onend=function(e){return this.onAny("end",e),!1},Qle.prototype.oncancel=function(e){return this.onAny("end",e),!1},Qle.prototype.onAny=function(e,t){var r,n=this,i="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=Dle(t);var s=function(e,t,r){r.ids.indexOf(t)>=0&&(r[i](e),e._found_=!0)};return Ble(t,(function(e){r=n.getIdentifier(e),Ble(n.collections,s.bind(null,e,r)),e._found_||n.removeIdentifier(r)})),!1},Qle.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach((function(e){e.destroy()})),e.off()},Qle.prototype.onDestroyed=function(e,t){var r=this;if(r.collections.indexOf(t)<0)return!1;r.collections.splice(r.collections.indexOf(t),1)};var Zle=new Qle,Jle=function(e){return Zle.create(e)},$le=new Map,ece=new Map,tce=class{constructor(e,t,r,n){this.data=t;let{audio:i,volume:s,delay:a,loop:o}=t;if(!i)throw new Error("Missing property");let l="string"==typeof i?n.getAudio(i).src:i.data;this.audioPlayer=new Rte({src:l,volume:s,delay:a,loop:o}),ece.has(r.uuid)?ece.get(r.uuid).push(this):ece.set(r.uuid,[this]),$le.set(e,this)}playByToggle(){"stop"===this.data.toggle?"playing"===this.audioPlayer.status?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):"pause"===this.data.toggle?"playing"===this.audioPlayer.status?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},rce=class{constructor(e){this.data=e}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(e){let t=$le.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{t.audioPlayer[this.data.interaction](),this.disposeDelay()}),this.data.delay)):t.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(e){let t=ece.get(e);null===t||void 0===t||!t.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{t.forEach((e=>e.audioPlayer[this.data.interaction]())),this.disposeDelay()}),this.data.delay)):t.forEach((e=>e.audioPlayer[this.data.interaction]())))}pauseAllAudios(){let e=[...ece.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{e.forEach((e=>{e.forEach((e=>{e.audioPlayer[this.data.interaction]()}))})),this.disposeDelay()}),this.data.delay)):e.forEach((e=>{e.forEach((e=>{e.audioPlayer[this.data.interaction]()}))})))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},nce=class{constructor(e,t,r,n,i){if(this.data=t,this.shared=n,this.condition=i,"play"===t.interaction)this.interaction=new tce(e,t,r,n);else{if("pause"!==t.interaction&&"stop"!==t.interaction)throw new Error("Missing property");this.interaction=new rce(t)}}dispatchBasic(){if(!1===che(this.shared,this.condition))return!1;this.interaction instanceof tce?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(!1===che(this.shared,this.condition))return!1;this.interaction instanceof tce?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(e){if(!1===che(this.shared,this.condition))return!1;this.interaction instanceof tce&&("start"===e?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},ice=class{constructor(e,t,r,n){this.data=e,this.page=t,this.shared=r,this.condition=n,this.delay=0,this.emission=e.emission,void 0!==e.delay&&(this.delay=e.delay),this.particleSystem=this.page.scene.find(this.data.emitterObjectId)}toggleEmitting(){this.particleSystem.started&&!this.particleSystem.stopped?this.stop(this.delay):this.start(this.delay)}toggleFroze(){this.particleSystem.started&&!this.particleSystem.isFrozen?this.freeze(this.delay):this.unFreeze(this.delay)}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout((()=>{this.start(0),this.clearDelay()}),e):this.particleSystem.start()}stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout((()=>{this.stop(0),this.clearDelay()}),e):this.particleSystem.stop()}freeze(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout((()=>{this.freeze(0),this.clearDelay()}),e):this.particleSystem.froze()}unFreeze(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout((()=>{this.unFreeze(0),this.clearDelay()}),e):this.particleSystem.unFroze()}reset(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout((()=>{this.reset(0),this.clearDelay()}),e):this.particleSystem.reset()}reverseFromCurrent(){switch(this.emission){case"emitToggle":this.toggleEmitting();break;case"pauseToggle":this.toggleFroze()}}dispatchBasic(){if(!1===che(this.shared,this.condition)||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"emitToggle":this.toggleEmitting();break;case"pause":this.freeze(this.delay);break;case"pauseToggle":this.toggleFroze();break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay)}}dispatchConditional(){if(!1===che(this.shared,this.condition)||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay)}}dispatchGameControl(e){if(!1===che(this.shared,this.condition)||!this.particleSystem)return!1;"start"===e?this.start(this.delay):this.stop(this.delay)}dispose(){!this.particleSystem||(this.particleSystem.reset(),this.clearDelay())}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}},sce=(e,t)=>t.some((t=>t instanceof RegExp?t.test(e):t===e));function ace(e,t){if(t=u({defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0},t),e=e.trim(),/^data:/i.test(e))return((e,t)=>{let{stripHash:r}=t,n=iL(/^data:([^,]*?),([^#]*?)(?:#(.*))?$/,{type:1,data:2,hash:3}).exec(e);if(!n)throw new Error("Invalid URL: ".concat(e));let{type:i,data:s,hash:a}=n.groups,o=i.split(";");a=r?"":a;let l=!1;"base64"===o[o.length-1]&&(o.pop(),l=!0);let c=(o.shift()||"").toLowerCase(),u=[...o.map((e=>{let[t,r=""]=e.split("=").map((e=>e.trim()));return"charset"===t&&(r=r.toLowerCase(),"us-ascii"===r)?"":"".concat(t).concat(r?"=".concat(r):"")})).filter(Boolean)];return l&&u.push("base64"),(u.length>0||c&&"text/plain"!==c)&&u.unshift(c),"data:".concat(u.join(";"),",").concat(l?s.trim():s).concat(a?"#".concat(a):"")})(e,t);if(/^view-source:/i.test(e))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let r=e.startsWith("//");!r&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));let n=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&"https:"===n.protocol&&(n.protocol="http:"),t.forceHttps&&"http:"===n.protocol&&(n.protocol="https:"),t.stripAuthentication&&(n.username="",n.password=""),t.stripHash?n.hash="":t.stripTextFragment&&(n.hash=n.hash.replace(/#?:~:text.*?$/i,"")),n.pathname){let e=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,t=0,r="";for(;;){let i=e.exec(n.pathname);if(!i)break;let s=i[0],a=i.index;r+=n.pathname.slice(t,a).replace(/\/{2,}/g,"/"),r+=s,t=a+s.length}r+=n.pathname.slice(t,n.pathname.length).replace(/\/{2,}/g,"/"),n.pathname=r}if(n.pathname)try{n.pathname=decodeURI(n.pathname)}catch(s){}if(!0===t.removeDirectoryIndex&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let e=n.pathname.split("/"),r=e[e.length-1];sce(r,t.removeDirectoryIndex)&&(e=e.slice(0,-1),n.pathname=e.slice(1).join("/")+"/")}if(n.hostname&&(n.hostname=n.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(n.hostname)&&(n.hostname=n.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(let o of[...n.searchParams.keys()])sce(o,t.removeQueryParameters)&&n.searchParams.delete(o);if(!0===t.removeQueryParameters&&(n.search=""),t.sortQueryParameters){n.searchParams.sort();try{n.search=decodeURIComponent(n.search)}catch(a){}}t.removeTrailingSlash&&(n.pathname=n.pathname.replace(/\/$/,""));let i=e;return e=n.toString(),!t.removeSingleSlash&&"/"===n.pathname&&!i.endsWith("/")&&""===n.hash&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||"/"===n.pathname)&&""===n.hash&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),r&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var oce=class{constructor(e,t,r,n){let{url:i,context:s}=e;if(this.controlsManager=t,this.shared=r,this.condition=n,!i)throw new Error("Missing property");this.url=i.startsWith("mailto:")?i:ace(i,{removeTrailingSlash:!1,removeSingleSlash:!1,stripWWW:!1}),this.context=null!==s&&void 0!==s?s:"tab"}dispatch(){var e;if(!1===che(this.shared,this.condition))return!1;xZ?window.location.assign(this.url):("tab"===this.context||bZ&&"none"===this.context?window.open(this.url,"_blank"):"window"===this.context?window.open(this.url,"_blank","width=".concat(window.innerWidth,", height=").concat(window.innerHeight)):window.open(this.url,"_parent"),null!==(e=this.controlsManager.orbitControls)&&void 0!==e&&e.onPointerUp(PZ[0]),PZ.splice(0,PZ.length))}},lce=class{constructor(e,t,r,n,i){this.data=e,this.page=t,this.controlsManager=r,this.shared=n,this.condition=i,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=e=>{var t;this.timeoutIdQueue.shift();let r=this.page.scene.find(e);if(void 0===r)return;let n=this.controlsManager.sharedGameControlGlobals.rapierWorld,i=!n||(null===(t=r.dataPatched.physics)||void 0===t?void 0:t.fusedBody);if(r.cloner){for(let e of r.cloner.children){var s;i?(e.playModeVisible=!1,e.rigidBody&&"positioned"===(null===(s=r.dataPatched.physics)||void 0===s?void 0:s.rigidBody)&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(e.rigidBody.collider(0).handle),n.removeRigidBody(e.rigidBody),e.rigidBody=void 0),e.bvhGeometry&&(e.bvhGeometry=void 0)):void 0===this.clone||this.clone===e?(e.playModeVisible=!1,e.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(e.rigidBody.collider(0).handle),n.removeRigidBody(e.rigidBody),e.rigidBody=void 0)):void 0===e.playModeVisible&&(e.playModeVisible=!0)}(i||void 0===this.clone||!1===this.clone)&&(r.visible=!1,r.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(r.rigidBody.collider(0).handle),n.removeRigidBody(r.rigidBody),r.rigidBody=void 0),r.bvhGeometry&&(r.bvhGeometry=void 0))}else r.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(r.rigidBody.collider(0).handle),n.removeRigidBody(r.rigidBody),r.rigidBody=void 0),r.bvhGeometry&&(r.bvhGeometry=void 0),r.visible=!1;this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=void 0===n?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter((e=>void 0!==e.bvhGeometry)):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter((e=>void 0!==e.rigidBody)),r.destroyedInAction=!0,this.controlsManager.requestRender()},this.objects=[...e.objects]}dispatch(e){if(!1===che(this.shared,this.condition))return!1;this.clone=e,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,1e3*this.data.delay)):this.dispatchInner()}dispatchFromStart(){if(!1===che(this.shared,this.condition))return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,1e3*this.data.delay))}dispose(){this.timeoutIdQueue.forEach((e=>window.clearTimeout(e)))}},cce=class{constructor(e,t,r,n,i){this.data=e,this.page=t,this.shared=r,this.eventManager=n,this.condition=i,this.shared=r}dispatch(){var e;if(!1===che(this.shared,this.condition))return!1;clearTimeout(this.timeoutId),delete this.timeoutId,this.timeoutId=window.setTimeout((()=>{var e;this.shared.reset(this.shared.data,!0),Vue(this.page,this.shared,!0),this.eventManager.reset(),null!==(e=this.eventManager.controlsManager.gameControl)&&void 0!==e&&e.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender(),delete this.timeoutId}),1e3*(null!==(e=this.data.delay)&&void 0!==e?e:0))}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},uce={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},hce={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},dce=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],fce={CSS:{},springs:{}};function pce(e,t,r){return Math.min(Math.max(e,t),r)}function mce(e,t){return e.indexOf(t)>-1}function gce(e,t){return e.apply(null,t)}var vce={arr:function(e){return Array.isArray(e)},obj:function(e){return mce(Object.prototype.toString.call(e),"Object")},pth:function(e){return vce.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return!("isNode"in e)&&(e.nodeType||vce.svg(e))},str:function(e){return"string"==typeof e},fnc:function(e){return"function"==typeof e},und:function(e){return typeof e>"u"},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return vce.hex(e)||vce.rgb(e)||vce.hsl(e)},key:function(e){return!uce.hasOwnProperty(e)&&!hce.hasOwnProperty(e)&&"targets"!==e&&"keyframes"!==e}};function yce(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map((function(e){return parseFloat(e)})):[]}function bce(e,t){var r=yce(e),n=pce(vce.und(r[0])?1:r[0],.1,100),i=pce(vce.und(r[1])?100:r[1],.1,100),s=pce(vce.und(r[2])?10:r[2],.1,100),a=pce(vce.und(r[3])?0:r[3],.1,100),o=Math.sqrt(i/n),l=s/(2*Math.sqrt(i*n)),c=l<1?o*Math.sqrt(1-l*l):0,u=l<1?(l*o-a)/c:-a+o;function h(e){var r=t?t*e/1e3:e;return r=l<1?Math.exp(-r*l*o)*(1*Math.cos(c*r)+u*Math.sin(c*r)):(1+u*r)*Math.exp(-r*o),0===e||1===e?e:1-r}return t?h:function(){var t=fce.springs[e];if(t)return t;for(var r=1/6,n=0,i=0;;)if(1===h(n+=r)){if(++i>=16)break}else i=0;var s=n*r*1e3;return fce.springs[e]=s,s}}function wce(e){return void 0===e&&(e=10),function(t){return Math.ceil(pce(t,1e-6,1)*e)*(1/e)}}var xce=function(){var e=.1;function t(e,t){return 1-3*t+3*e}function r(e,t){return 3*t-6*e}function n(e){return 3*e}function i(e,i,s){return((t(i,s)*e+r(i,s))*e+n(i))*e}function s(e,i,s){return 3*t(i,s)*e*e+2*r(i,s)*e+n(i)}return function(t,r,n,a){if(0<=t&&t<=1&&0<=n&&n<=1){var o=new Float32Array(11);if(t!==r||n!==a)for(var l=0;l<11;++l)o[l]=i(l*e,t,n);return function(e){return t===r&&n===a||0===e||1===e?e:i(c(e),r,a)}}function c(r){for(var a=0,l=1;10!==l&&o[l]<=r;++l)a+=e;--l;var c=a+(r-o[l])/(o[l+1]-o[l])*e,u=s(c,t,n);return u>=.001?function(e,t,r,n){for(var a=0;a<4;++a){var o=s(t,r,n);if(0===o)return t;t-=(i(t,r,n)-e)/o}return t}(r,c,t,n):0===u?c:function(e,t,r,n,s){var a,o,l=0;do{(a=i(o=t+(r-t)/2,n,s)-e)>0?r=o:t=o}while(Math.abs(a)>1e-7&&++l<10);return o}(r,a,a+e,t,n)}}}(),Sce=function(){var e={linear:function(){return function(e){return e}}},t={Sine:function(){return function(e){return 1-Math.cos(e*Math.PI/2)}},Circ:function(){return function(e){return 1-Math.sqrt(1-e*e)}},Back:function(){return function(e){return e*e*(3*e-2)}},Bounce:function(){return function(e){for(var t,r=4;e<((t=Math.pow(2,--r))-1)/11;);return 1/Math.pow(4,3-r)-7.5625*Math.pow((3*t-2)/22-e,2)}},Elastic:function(e,t){void 0===e&&(e=1),void 0===t&&(t=.5);var r=pce(e,1,10),n=pce(t,.1,2);return function(e){return 0===e||1===e?e:-r*Math.pow(2,10*(e-1))*Math.sin((e-1-n/(2*Math.PI)*Math.asin(1/r))*(2*Math.PI)/n)}}};return["Quad","Cubic","Quart","Quint","Expo"].forEach((function(e,r){t[e]=function(){return function(e){return Math.pow(e,r+2)}}})),Object.keys(t).forEach((function(r){var n=t[r];e["easeIn"+r]=n,e["easeOut"+r]=function(e,t){return function(r){return 1-n(e,t)(1-r)}},e["easeInOut"+r]=function(e,t){return function(r){return r<.5?n(e,t)(2*r)/2:1-n(e,t)(-2*r+2)/2}}})),e}();function _ce(e,t){if(vce.fnc(e))return e;var r=e.split("(")[0],n=Sce[r],i=yce(e);switch(r){case"spring":return bce(e,t);case"cubicBezier":return gce(xce,i);case"steps":return gce(wce,i);default:return gce(n,i)}}function Cce(e){try{return document.querySelectorAll(e)}catch(t){return}}function Ece(e,t){for(var r=e.length,n=arguments.length>=2?arguments[1]:void 0,i=[],s=0;s<r;s++)if(s in e){var a=e[s];t.call(n,a,s,e)&&i.push(a)}return i}function Ace(e){return e.reduce((function(e,t){return e.concat(vce.arr(t)?Ace(t):t)}),[])}function Mce(e){return vce.arr(e)?e:(vce.str(e)&&(e=Cce(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function Tce(e,t){return e.some((function(e){return e===t}))}function Pce(e){var t={};for(var r in e)t[r]=e[r];return t}function kce(e,t){var r=Pce(e);for(var n in e)r[n]=t.hasOwnProperty(n)?t[n]:e[n];return r}function Dce(e,t){var r=Pce(e);for(var n in t)r[n]=vce.und(e[n])?t[n]:e[n];return r}function Ice(e){return vce.rgb(e)?function(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}(e):vce.hex(e)?function(e){var t=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,r,n){return t+t+r+r+n+n})),r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return"rgba("+parseInt(r[1],16)+","+parseInt(r[2],16)+","+parseInt(r[3],16)+",1)"}(e):vce.hsl(e)?function(e){var t,r,n,i=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),s=parseInt(i[1],10)/360,a=parseInt(i[2],10)/100,o=parseInt(i[3],10)/100,l=i[4]||1;function c(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}if(0==a)t=r=n=o;else{var u=o<.5?o*(1+a):o+a-o*a,h=2*o-u;t=c(h,u,s+1/3),r=c(h,u,s),n=c(h,u,s-1/3)}return"rgba("+255*t+","+255*r+","+255*n+","+l+")"}(e):void 0}function Oce(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function Rce(e,t){return vce.fnc(e)?e(t.target,t.id,t.total):e}function Lce(e,t){return e.getAttribute(t)}function Nce(e,t,r){if(Tce([r,"deg","rad","turn"],Oce(t)))return t;var n=fce.CSS[t+r];if(!vce.und(n))return n;var i=document.createElement(e.tagName),s=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;s.appendChild(i),i.style.position="absolute",i.style.width=100+r;var a=100/i.offsetWidth;s.removeChild(i);var o=a*parseFloat(t);return fce.CSS[t+r]=o,o}function Bce(e,t,r){if(t in e.style){var n=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),i=e.style[t]||getComputedStyle(e).getPropertyValue(n)||"0";return r?Nce(e,i,r):i}}function zce(e,t){return vce.dom(e)&&!vce.inp(e)&&(Lce(e,t)||vce.svg(e)&&e[t])?"attribute":vce.dom(e)&&Tce(dce,t)?"transform":vce.dom(e)&&"transform"!==t&&Bce(e,t)?"css":null!=e[t]?"object":void 0}function Fce(e){if(vce.dom(e)){for(var t,r=e.style.transform||"",n=/(\w+)\(([^)]*)\)/g,i=new Map;t=n.exec(r);)i.set(t[1],t[2]);return i}}function jce(e,t,r,n){var i=mce(t,"scale")?1:0+function(e){return mce(e,"translate")||"perspective"===e?"px":mce(e,"rotate")||mce(e,"skew")?"deg":void 0}(t),s=Fce(e).get(t)||i;return r&&(r.transforms.list.set(t,s),r.transforms.last=t),n?Nce(e,s,n):s}function Uce(e,t,r,n){switch(zce(e,t)){case"transform":return jce(e,t,n,r);case"css":return Bce(e,t,r);case"attribute":return Lce(e,t);default:return e[t]||0}}function Vce(e,t){var r=/^(\*=|\+=|-=)/.exec(e);if(!r)return e;var n=Oce(e)||0,i=parseFloat(t),s=parseFloat(e.replace(r[0],""));switch(r[0][0]){case"+":return i+s+n;case"-":return i-s+n;case"*":return i*s+n}}function Hce(e,t){if(vce.col(e))return Ice(e);if(/\s/g.test(e))return e;var r=Oce(e),n=r?e.substr(0,e.length-r.length):e;return t?n+t:n}function Wce(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Gce(e){for(var t,r=e.points,n=0,i=0;i<r.numberOfItems;i++){var s=r.getItem(i);i>0&&(n+=Wce(t,s)),t=s}return n}function qce(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return function(e){return 2*Math.PI*Lce(e,"r")}(e);case"rect":return function(e){return 2*Lce(e,"width")+2*Lce(e,"height")}(e);case"line":return function(e){return Wce({x:Lce(e,"x1"),y:Lce(e,"y1")},{x:Lce(e,"x2"),y:Lce(e,"y2")})}(e);case"polyline":return Gce(e);case"polygon":return function(e){var t=e.points;return Gce(e)+Wce(t.getItem(t.numberOfItems-1),t.getItem(0))}(e)}}function Xce(e,t){var r=t||{},n=r.el||function(e){for(var t=e.parentNode;vce.svg(t)&&vce.svg(t.parentNode);)t=t.parentNode;return t}(e),i=n.getBoundingClientRect(),s=Lce(n,"viewBox"),a=i.width,o=i.height,l=r.viewBox||(s?s.split(" "):[0,0,a,o]);return{el:n,viewBox:l,x:l[0]/1,y:l[1]/1,w:a/l[2],h:o/l[3]}}function Yce(e,t){function r(r){void 0===r&&(r=0);var n=t+r>=1?t+r:0;return e.el.getPointAtLength(n)}var n=Xce(e.el,e.svg),i=r(),s=r(-1),a=r(1);switch(e.property){case"x":return(i.x-n.x)*n.w;case"y":return(i.y-n.y)*n.h;case"angle":return 180*Math.atan2(a.y-s.y,a.x-s.x)/Math.PI}}function Kce(e,t){var r=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,n=Hce(vce.pth(e)?e.totalLength:e,t)+"";return{original:n,numbers:n.match(r)?n.match(r).map(Number):[0],strings:vce.str(e)||t?n.split(r):[]}}function Qce(e){return Ece(e?Ace(vce.arr(e)?e.map(Mce):Mce(e)):[],(function(e,t,r){return r.indexOf(e)===t}))}function Zce(e){var t=Qce(e);return t.map((function(e,r){return{target:e,id:r,total:t.length,transforms:{list:Fce(e)}}}))}function Jce(e,t){var r=Pce(t);if(/^spring/.test(r.easing)&&(r.duration=bce(r.easing)),vce.arr(e)){var n=e.length;2===n&&!vce.obj(e[0])?e={value:e}:vce.fnc(t.duration)||(r.duration=t.duration/n)}var i=vce.arr(e)?e:[e];return i.map((function(e,r){var n=vce.obj(e)&&!vce.pth(e)?e:{value:e};return vce.und(n.delay)&&(n.delay=r?0:t.delay),vce.und(n.endDelay)&&(n.endDelay=r===i.length-1?t.endDelay:0),n})).map((function(e){return Dce(e,r)}))}function $ce(e,t){var r=[],n=t.keyframes;for(var i in n&&(t=Dce(function(e){for(var t=Ece(Ace(e.map((function(e){return Object.keys(e)}))),(function(e){return vce.key(e)})).reduce((function(e,t){return e.indexOf(t)<0&&e.push(t),e}),[]),r={},n=function(n){var i=t[n];r[i]=e.map((function(e){var t={};for(var r in e)vce.key(r)?r==i&&(t.value=e[r]):t[r]=e[r];return t}))},i=0;i<t.length;i++)n(i);return r}(n),t)),t)vce.key(i)&&r.push({name:i,tweens:Jce(t[i],e)});return r}function eue(e,t){var r;return e.tweens.map((function(n){var i=function(e,t){var r={};for(var n in e){var i=Rce(e[n],t);vce.arr(i)&&(i=i.map((function(e){return Rce(e,t)})),1===i.length&&(i=i[0])),r[n]=i}return r.duration=parseFloat(r.duration),r.delay=parseFloat(r.delay),r}(n,t),s=i.value,a=vce.arr(s)?s[1]:s,o=Oce(a),l=Uce(t.target,e.name,o,t),c=r?r.to.original:l,u=vce.arr(s)?s[0]:c,h=Oce(u)||Oce(l),d=o||h;return vce.und(a)&&(a=c),i.from=Kce(u,d),i.to=Kce(Vce(a,u),d),i.start=r?r.end:0,i.end=i.start+i.delay+i.duration+i.endDelay,i.easing=_ce(i.easing,i.duration),i.isPath=vce.pth(s),i.isColor=vce.col(i.from.original),i.isColor&&(i.round=1),r=i,i}))}var tue={css:function(e,t,r){return e.style[t]=r},attribute:function(e,t,r){return e.setAttribute(t,r)},object:function(e,t,r){return e[t]=r},transform:function(e,t,r,n,i){if(n.list.set(t,r),t===n.last||i){var s="";n.list.forEach((function(e,t){s+=t+"("+e+") "})),e.style.transform=s}}};function rue(e,t){Zce(e).forEach((function(e){for(var r in t){var n=Rce(t[r],e),i=e.target,s=Oce(n),a=Uce(i,r,s,e),o=Vce(Hce(n,s||Oce(a)),a),l=zce(i,r);tue[l](i,r,o,e.transforms,!0)}}))}function nue(e,t){return Ece(Ace(e.map((function(e){return t.map((function(t){return function(e,t){var r=zce(e.target,t.name);if(r){var n=eue(t,e),i=n[n.length-1];return{type:r,property:t.name,animatable:e,tweens:n,duration:i.end,delay:n[0].delay,endDelay:i.endDelay}}}(e,t)}))}))),(function(e){return!vce.und(e)}))}function iue(e,t){var r=e.length,n=function(e){return e.timelineOffset?e.timelineOffset:0},i={};return i.duration=r?Math.max.apply(Math,e.map((function(e){var t,r,i,s;let a=null!==(t=e.startOnceDelay)&&void 0!==t?t:0,o=null!==(r=e.pingPongDelayCorrection)&&void 0!==r?r:0,l=null!==(i=e.pingPongEndDelayCorrection)&&void 0!==i?i:0;return n(e)+a+o+l+e.duration*(null!==(s=e.loop)&&void 0!==s?s:1)}))):t.duration,i.delay=r?Math.min.apply(Math,e.map((function(e){var t,r;let i=null!==(t=e.startOnceDelay)&&void 0!==t?t:0,s=null!==(r=e.pingPongDelayCorrection)&&void 0!==r?r:0;return n(e)+i+s+e.delay}))):t.delay,i.endDelay=r?i.duration-Math.max.apply(Math,e.map((function(e){var t,r,i,s;let a=null!==(t=e.startOnceDelay)&&void 0!==t?t:0,o=null!==(r=e.pingPongDelayCorrection)&&void 0!==r?r:0,l=null!==(i=e.pingPongEndDelayCorrection)&&void 0!==i?i:0;return n(e)+a+o+e.duration*(null!==(s=e.loop)&&void 0!==s?s:1)-e.endDelay-l}))):t.endDelay,i}var sue=0;var aue,oue=[],lue=[],cue=function(){function e(){aue=requestAnimationFrame(t)}function t(t){var r=oue.length;if(r){for(var n=0;n<r;){var i=oue[n];i.paused?(oue.splice(n,1),r-=1):(i.tick(t),n++)}e()}else aue=cancelAnimationFrame(aue)}return e}();function uue(e){void 0===e&&(e={});var t,r,n=0,i=0,s=0,a=0,o=null;function l(e){var t=window.Promise&&new Promise((function(e){return o=e}));return e.finished=t,t}var c=function(e){var t=kce(uce,e),r=kce(hce,e),n=$ce(r,e),i=Zce(e.targets),s=nue(i,n),a=iue(s,r),o=sue;return sue++,Dce(t,{id:o,children:[],animatables:i,animations:s,duration:a.duration,delay:a.delay,endDelay:a.endDelay,startOnceDelay:r.startOnceDelay,pingPongDelayCorrection:r.pingPongDelayCorrection,pingPongEndDelayCorrection:r.pingPongEndDelayCorrection})}(e);l(c);function u(){var e=c.direction;"alternate"!==e&&(c.direction="normal"!==e?"normal":"reverse"),c.reversed=!c.reversed,r.forEach((function(e){(1===e.loop||e.loop%2===0)&&(e.reversed=c.reversed)}))}function h(e){return c.reversed?c.duration-e:e}function d(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t&&(c.reversed?t.seek(t.duration*t.loop-(e-t.timelineOffset-t.pingPongDelayCorrection),r):t.seek(e-t.timelineOffset-t.startOnceDelay-t.pingPongDelayCorrection,r))}function f(e){var t=0,r=c.animations,n=r.length;for("alternate"!==c.direction&&"alternate"===(null===(i=c.parent)||void 0===i?void 0:i.direction)?!1===(null===(s=c.parent)||void 0===s?void 0:s.rewind)&&!0===c.reversePlayback&&!1===c.rewind&&(e=null!==(a=c.parent)&&void 0!==a&&a.reversed&&"alternate"===c.direction?c.duration-c.delay+c.endDelay-e:c.duration+c.delay-c.endDelay-e):g(!1,null===(o=c.parent)||void 0===o?void 0:o.rewind,c.rewind,null===(l=c.parent)||void 0===l?void 0:l.reversePlayback,c.reversePlayback)&&(e=null!==(u=c.parent)&&void 0!==u&&u.reversed&&"alternate"===c.direction?c.duration-c.delay+c.endDelay-e:c.duration+c.delay-c.endDelay-e);t<n;){var i,s,a,o,l,u,h,d=r[t],f=d.animatable,p=d.tweens,m=p.length-1,v=p[m];let n;m&&(v=Ece(p,(function(t){return e<t.end}))[0]||v),n=null!==(h=c.parent)&&void 0!==h&&h.reversed&&"alternate"===c.direction?pce(e-v.start-v.endDelay,0,v.duration)/v.duration:pce(e-v.start-v.delay,0,v.duration)/v.duration;for(var y=isNaN(n)?1:v.easing(n),b=v.to.strings,w=v.round,x=[],S=v.to.numbers.length,_=void 0,C=0;C<S;C++){var E,A,M,T=void 0;let e,t;"alternate"!==c.direction?!1===(null===(E=c.parent)||void 0===E?void 0:E.rewind)&&!0===c.reversePlayback&&!1===c.rewind?(e=v.to.numbers[C],t=v.from.numbers[C]||0):(t=v.to.numbers[C],e=v.from.numbers[C]||0):g(!0,null===(A=c.parent)||void 0===A?void 0:A.rewind,c.rewind,null===(M=c.parent)||void 0===M?void 0:M.reversePlayback,c.reversePlayback)?(e=v.to.numbers[C],t=v.from.numbers[C]||0):(t=v.to.numbers[C],e=v.from.numbers[C]||0),T=v.isPath?Yce(v.value,y*t):e+y*(t-e),w&&(v.isColor&&C>2||(T=Math.round(T*w)/w)),x.push(T)}var P=b.length;if(P){_=b[0];for(var k=0;k<P;k++){b[k];var D=b[k+1],I=x[k];isNaN(I)||(_+=D?I+D:I+" ")}}else _=x[0];tue[d.type](f.target,d.property,_,f.transforms),d.currentValue=_,t++}}function p(e){c[e]&&!c.passThrough&&c[e](c)}let m={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function g(e,t,r,n,i){return m[e<<4|t<<3|r<<2|n<<1|i]}function v(e){var t;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var s=c.duration;let m=c.delay,g=s-c.endDelay;(null===(t=c.parent)||void 0===t?void 0:t.reversed)&&"alternate"===c.direction&&(m=c.endDelay,g=s-c.delay);var v=h(e);if(c.progress=pce(v/s*100,0,100),i||(c.reversePlayback=v<c.currentTime),a&&function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(c.reversed)for(var n=a;n--;)d(e,r[n],t);else for(var i=0;i<a;i++)d(e,r[i],t)}(v,i),!c.began&&c.currentTime>=0&&(c.began=!0,p("begin")),!c.loopBegan&&c.currentTime>0&&(c.loopBegan=!0,p("loopBegin")),(c.reversed||v>=0)&&v<=m&&0!==c.currentTime&&(f(0),p("change")),(v>=g&&c.currentTime!==s+c.pingPongDelayCorrection||!s)&&(f(s),p("change")),v>m&&v<g?(c.changeBegan||(c.changeBegan=!0,c.changeCompleted=!1,p("changeBegin")),f(v),p("change")):c.changeBegan?(c.changeCompleted=!0,c.changeBegan=!1,p("change"),a&&p("timelineChangeComplete")):c.began&&v>g&&p("changeComplete"),c.currentTime=pce(v,0,s+c.pingPongDelayCorrection),c.began&&p("update"),e>=s)if(c.remaining&&!0!==c.remaining&&c.remaining--,c.remaining){n+=a?c.duration/uue.speed:c.duration;for(let e of r)e.setStartTime(0),e.remaining=e.loop;p("loopComplete"),c.loopBegan=!1,"alternate"===c.direction?u():a&&(c.direction="normal",c.reversed=!1,r.forEach((function(e){return e.reversed=!1})))}else c.paused=!0,c.completed||(c.completed=!0,p("loopComplete"),p("complete"),!c.passThrough&&"Promise"in window&&(o(),l(c)))}return c.reset=function(){var e=c.direction;c.passThrough=!1,c.currentTime=0,c.progress=0,c.paused=!0,c.began=!1,c.loopBegan=!1,c.changeBegan=!1,c.completed=!1,c.changeCompleted=!1,c.reversePlayback=!1,c.reversed="reverse"===e,c.remaining=c.loop,r=c.children;for(var t=a=r.length;t--;)c.children[t].reset();f(c.reversed?c.duration:0)},c.setStartTime=function(e){n=e},c.set=function(e,t){return rue(e,t),c},c.tick=function(e){s=e,n||(n=s),v((s+(i-n))*uue.speed)},c.seek=function(e){v(e-n,arguments.length>1&&void 0!==arguments[1]&&arguments[1])},c.pause=function(e){c.paused=!0,a&&(t=null!==e&&void 0!==e?e:performance.now())},c.play=function(e){!c.paused||(c.completed&&c.reset(),c.paused=!1,oue.push(c),a&&void 0!==t&&(n+=(null!==e&&void 0!==e?e:performance.now())-t),aue||cue())},c.reverse=function(){u(),c.completed=!c.reversed,n=0,i=h(c.currentTime)*(1/uue.speed)},c.restart=function(){c.reset(),c.play()},c.reset(),c.autoplay&&c.play(),c}function hue(e,t){for(var r=t.length;r--;)Tce(e,t[r].animatable.target)&&t.splice(r,1)}typeof document<"u"&&document.addEventListener("visibilitychange",(function(e){document.hidden?(oue.forEach((function(t){return t.pause(e.timeStamp)})),lue=oue.slice(0),uue.running=oue=[]):lue.forEach((function(t){return t.play(e.timeStamp)}))})),uue.version="3.2.0",uue.speed=1,uue.running=oue,uue.remove=function(e){for(var t=Qce(e),r=oue.length;r--;){var n=oue[r],i=n.animations,s=n.children;hue(t,i);for(var a=s.length;a--;){var o=s[a],l=o.animations;hue(t,l),!l.length&&!o.children.length&&s.splice(a,1)}!i.length&&!s.length&&n.pause()}},uue.get=Uce,uue.set=rue,uue.convertPx=Nce,uue.path=function(e,t){var r=vce.str(e)?Cce(e)[0]:e,n=t||100;return function(e){return{property:e,el:r,svg:Xce(r),totalLength:qce(r)*(n/100)}}},uue.setDashoffset=function(e){var t=qce(e);return e.setAttribute("stroke-dasharray",t),t},uue.stagger=function(e,t){void 0===t&&(t={});var r=t.direction||"normal",n=t.easing?_ce(t.easing):null,i=t.grid,s=t.axis,a=t.from||0,o="first"===a,l="center"===a,c="last"===a,u=vce.arr(e),h=parseFloat(u?e[0]:e),d=u?parseFloat(e[1]):0,f=Oce(u?e[1]:e)||0,p=t.start||0+(u?h:0),m=[],g=0;return function(e,t,v){if(o&&(a=0),l&&(a=(v-1)/2),c&&(a=v-1),!m.length){for(var y=0;y<v;y++){if(i){var b=l?(i[0]-1)/2:a%i[0],w=l?(i[1]-1)/2:Math.floor(a/i[0]),x=b-y%i[0],S=w-Math.floor(y/i[0]),_=Math.sqrt(x*x+S*S);"x"===s&&(_=-x),"y"===s&&(_=-S),m.push(_)}else m.push(Math.abs(a-y));g=Math.max.apply(Math,m)}n&&(m=m.map((function(e){return n(e/g)*g}))),"reverse"===r&&(m=m.map((function(e){return s?e<0?-1*e:-e:Math.abs(g-e)})))}return p+(u?(d-h)/g:h)*(Math.round(100*m[t])/100)+f}},uue.timeline=function(e){void 0===e&&(e={});var t=uue(e);return t.duration=0,t.add=function(r,n){var i=oue.indexOf(t),s=t.children;function a(e){e.passThrough=!0}i>-1&&oue.splice(i,1);for(var o=0;o<s.length;o++)a(s[o]);var l=Dce(r,kce(hce,e));l.targets=l.targets||e.targets;var c=t.duration;l.autoplay=!1,l.timelineOffset=vce.und(n)?c:Vce(n,c),a(t);var u=uue(l);a(u),s.push(u),u.parent=t;var h=iue(s,e);return t.delay=h.delay,t.endDelay=h.endDelay,t.duration=h.duration,!0===u.loop&&(t.duration=1/0),t.seek(0),t.reset(),t.autoplay&&t.play(),t},t},uue.easing=_ce,uue.penner=Sce,uue.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var due=uue,fue=new PB,pue=new PB,mue=new TB;function gue(e,t,r,n,i,s){var a,o;let l=void 0!==r[e]?r[e]:void 0,c=n[e];if(null==c)return;let u=null!=l?"string"==typeof l?Number(null!==(a=i.getVariable(l))&&void 0!==a?a:0):l:t[e],h="string"==typeof c?Number(null!==(o=i.getVariable(c))&&void 0!==o?o:0):c;return u!==h?{update:r=>{let n=$N.lerp(u,h,r);t[e]=s?Math.trunc(n):n},start:()=>{t[e]=u},end:()=>{t[e]=h}}:void 0}function vue(e,t,r,n,i,s){let a=r[e]?r[e]:void 0,o=n[e];if(!o)return;let l=t[e],c=[...null!==a&&void 0!==a?a:l].map((e=>{var t;return"string"==typeof e?Number(null!==(t=i.getVariable(e))&&void 0!==t?t:0):e})),u=[...o].map((e=>{var t;return"string"==typeof e?Number(null!==(t=i.getVariable(e))&&void 0!==t?t:0):e}));return c.length!==u.length||iZ(c,u)?void 0:{update:r=>{c.forEach(((n,i)=>{let a=$N.lerp(n,u[i],r);t[e][i]=s?Math.trunc(a):a}))},start:()=>{Object.assign(t[e],c)},end:()=>{Object.assign(t[e],u)}}}function yue(e,t,r){return t.forEach(((t,n)=>{var i;e.setComponent(n,"string"==typeof t?Number(null!==(i=r.getVariable(t))&&void 0!==i?i:0):t)})),e}function bue(e,t,r,n,i){let s=r[e]?r[e]:void 0,a=n[e];if(!a)return;let o=t[e],l=s?yue(new PB,s,i):o.clone(),c=yue(new PB,a,i);return l.equals(c)?void 0:{update:e=>{o.lerpVectors(l,c,e)},start:()=>{o.copy(l)},end:()=>{o.copy(c)}}}function wue(e,t,r){return t.forEach(((t,n)=>{var i;e.setComponent(n,"string"==typeof t?Number(null!==(i=r.getVariable(t))&&void 0!==i?i:0):t)})),e}function xue(e,t,r,n,i){let s=r[e]?r[e]:void 0,a=n[e];if(!a)return;let o=t[e],l=!(o instanceof eB),c=o instanceof eB?o:(new eB).fromArray(o),u=s?wue(new eB,s,i):c.clone(),h=wue(new eB,a,i);return u.equals(h)?void 0:{update:r=>{c.lerpVectors(u,h,r),l&&(t[e]=c.toArray())},start:()=>{c.copy(u),l&&(t[e]=c.toArray())},end:()=>{c.copy(h),l&&(t[e]=c.toArray())}}}function Sue(e,t,r,n,i){let s=r[e]?r[e]:void 0,a=n[e];if(!a)return;let o=t[e],l=new X9(o.r,o.g,o.b,o.a),c=s?"string"==typeof s?i.getColor(s).clone():new X9(s.r,s.g,s.b,s.a):l.clone(),u="string"==typeof a?i.getColor(a).clone():new X9(a.r,a.g,a.b,a.a);return c.equals(u)?void 0:{update:r=>{l.lerpColors(c,u,r);let n=$N.lerp(c.a,u.a,r);l.a=n,t[e]={r:l.r,g:l.g,b:l.b,a:l.a}},start:()=>{l.copy(c)},end:()=>{l.copy(u)}}}function _ue(e,t,r,n,i){return"number"==typeof t[e]?gue(e,t,null!==r&&void 0!==r?r:{},n,i):Array.isArray(t[e])?vue(e,t,null!==r&&void 0!==r?r:{},n,i):void 0}function Cue(e,t,r,n){let i=[];if(!("geometry"in r))return i;let s=e.geometry.userData.parameters,a="geometry"in t?t.geometry:{},o=r.geometry;if(e instanceof Bre){let t=function(e,t,r,n){var i;if(void 0===r.scaleBaked)return;let s=(null!==(i=t.scaleBaked)&&void 0!==i?i:e.data.geometry.scaleBaked).map((e=>{var t;return"string"==typeof e?Number(null!==(t=n.getVariable(e))&&void 0!==t?t:0):e})),a=r.scaleBaked.map((e=>{var t;return"string"==typeof e?Number(null!==(t=n.getVariable(e))&&void 0!==t?t:0):e}));if(N0.isEqual(s,a))return;let o=[];return o.push({update:t=>{e.updateGeometryInteractions({scaleBaked:[$N.lerp(s[0],a[0],t),$N.lerp(s[1],a[1],t),$N.lerp(s[2],a[2],t)]},n),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},start:()=>{e.updateGeometryInteractions({scaleBaked:s},n),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},end:()=>{e.updateGeometryInteractions({scaleBaked:a},n),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()}}),o}(e,a,o,n);t&&i.push(...t)}else{let t={};if(Object.assign(t,mZ(s,_2),mZ(a,_2)),_2.forEach((e=>{let r=_ue(e,t,a,o,n);r&&i.push(r)})),e instanceof foe){Object.assign(t,{extrusion:u({},s.extrusion)});let e=function(e,t,r,n){var i;if(!r.extrusion)return;let s=e.extrusion,a=null!==(i=t.extrusion)&&void 0!==i?i:{},o=r.extrusion,l=[];return R1.forEach((e=>{let t=_ue(e,s,a,o,n);t&&l.push(t)})),l}(t,a,o,n);e&&i.push(...e)}i.length&&i.push({update:r=>{e.updateGeometryInteractions(t,n),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},start:r=>{e.updateGeometryInteractions(t,n),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},end:r=>{e.updateGeometryInteractions(t,n),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()}})}return i}function Eue(e,t,r,n){let i=[];if(void 0!==r.intensity){let s=gue("intensity",e,t,r,n);s&&i.push(s)}if(void 0!==r.color){let s=function(e,t,r,n,i){let s=r[e]?r[e]:void 0,a=n[e];if(!a)return;let o=t[e],l=s?"string"==typeof s?i.getColor(s).clone():(new vB).setRGB(s.r,s.g,s.b):o.clone(),c="string"==typeof a?i.getColor(a).clone():(new vB).setRGB(a.r,a.g,a.b);if(l.equals(c))return;let u=o.clone();return{update:r=>{var n,i;u.lerpColors(l,c,r),null===(n=t[e])||void 0===n||null===(i=n.copy)||void 0===i||i.call(n,u)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}("color",e,t,r,n);s&&i.push(s)}return i}function Aue(e,t,r,n){let i=[],s=yte(r,n)||!!t.layers&&yte(t,n);i.push(function(e,t){return{update:()=>{e.transparent=t}}}(e,s));for(let c of e.layers){var a,o,l;let e=null===(a=t.layers)||void 0===a?void 0:a.data(c.uuid),s=r.layers.data(c.uuid);if(!s||"light"!==c.type&&(null!==(o=c.visible)&&void 0!==o&&!o||null!==(l=s.visible)&&void 0!==l&&!l))continue;let u=c.getNames().filter((e=>!A1.some((t=>e.includes(t)))));for(let t of u)try{let r,a=c.getValue(t);if("colors"===t)r=Oue(c,e,s,t);else if(Array.isArray(a))"steps"===t&&(r=Iue(c,e,s,t));else if("number"==typeof a)r=Mue(c,e,s,t,n);else{if("boolean"==typeof a)continue;a instanceof eB?r=Tue(c,e,s,t):a instanceof PB?r=Pue(c,e,s,t,n):a instanceof X9?r=Due(c,e,s,t,n):a instanceof vB?r=kue(c,e,s,t,n):"isTexture"in a&&(r=Rue(c,e,s,t))}r&&(Array.isArray(r)?i.push(...r):i.push(r))}catch(H0){console.error("lerpMaterial: unexpected material layer for ".concat(t),H0)}}return i}function Mue(e,t,r,n,i){var s,a;if(!e.hasValue(n)||!(n in r))return;let o=t?t[n]:e.getValue(n),l=r[n],c="string"==typeof o?Number(null!==(s=i.getVariable(o))&&void 0!==s?s:0):o,u="string"==typeof l?Number(null!==(a=i.getVariable(l))&&void 0!==a?a:0):l;return c!==u?{update:t=>{e.setValue(n,$N.lerp(c,u,t))},start:()=>{e.setValue(n,c)},end:()=>{e.setValue(n,u)}}:void 0}function Tue(e,t,r,n){if(!e.hasValue(n)||!(n in r))return;let i=e.getValue(n),s=t?(new eB).fromArray(t[n]):i.clone(),a=(new eB).fromArray(r[n]);return s.equals(a)?void 0:{update:e=>{i.lerpVectors(s,a,e)},start:()=>{i.copy(s)},end:()=>{i.copy(a)}}}function Pue(e,t,r,n,i){if(!e.hasValue(n)||!(n in r))return;let s=e.getValue(n),a=t?t[n]:void 0,o=r[n],l=a?yue(new PB,a,i):s.clone(),c=yue(new PB,o,i);return l.equals(c)?void 0:{update:e=>{s.lerpVectors(l,c,e)},start:()=>{s.copy(l)},end:()=>{s.copy(c)}}}function kue(e,t,r,n,i){if(!e.hasValue(n)||!(n in r))return;let s=t?t[n]:void 0,a=r[n],o=e.getValue(n),l=s?"string"==typeof s?i.getColor(s).clone():(new vB).setRGB(s.r,s.g,s.b):o.clone(),c="string"==typeof a?i.getColor(a).clone():(new vB).setRGB(a.r,a.g,a.b);if(l.equals(c))return;let u=o.clone();return{update:t=>{e.getValue(n)!==u&&e.setValue(n,u),u.lerpColors(l,c,t)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function Due(e,t,r,n,i){if(!e.hasValue(n)||!(n in r))return;let s=t?t[n]:void 0,a=r[n],o=e.getValue(n),l=s?"string"==typeof s?i.getColor(s).clone():(new vB).setRGB(s.r,s.g,s.b):o.clone(),c="string"==typeof a?i.getColor(a).clone():new X9(a.r,a.g,a.b,a.a);if(l.equals(c))return;let u=o.clone();return{update:t=>{e.getValue(n)!==u&&e.setValue(n,u),u.lerpColors(l,c,t)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function Iue(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(!e.hasValue(n)||!(n in r))return;let i=[],s=e.getValue(n),a=t?t[n]:s,o=r[n];return iZ(a,o)||i.push({update:t=>{let r=[...s];for(let e=0;e<s.length;++e){let n=a[e],i=o[e];r[e]=$N.lerp(n,i,t)}e.setValue(n,r)},start:()=>{e.setValue(n,a)},end:()=>{e.setValue(n,o)}}),i.length?i:void 0}function Oue(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"colors";if(!e.hasValue(n)||!(n in r))return;let i=[],s=e.getValue(n),a=t?t[n]:s.map((e=>e.toArray())),o=r[n];for(let l=0;l<s.length;++l){let e=[...a[l]],t=[...o[l]];z0.isEqual(e,t)||i.push({update:r=>{s[l].fromArray(z0.lerp(e,t,r))},start:()=>{s[l].fromArray(e)},end:()=>{s[l].fromArray(t)}})}return i.length?i:void 0}function Rue(e,t,r){var n,i,s,a,o,l;let c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"texture";if(!e.hasValue(c)||!(c in r))return;let u=e.getNode("rotation"),h=null!==(n=null===t||void 0===t||null===(i=t[c])||void 0===i?void 0:i.rotation)&&void 0!==n?n:0,d=null!==(s=null===(a=r[c])||void 0===a?void 0:a.rotation)&&void 0!==s?s:0;if(u&&h!==d)return{update:e=>{u.value=$N.lerp(h,d,e)*$N.DEG2RAD},start:()=>{u.value=h*$N.DEG2RAD},end:()=>{u.value=d*$N.DEG2RAD}};let f=e.getNode("mat");if(!f)return;let p=t?t[c]:f,m=r[c],g=[...p.repeat],v=[...p.offset],y=[...m.repeat],b=[...m.offset],w=null!==(o=p.rotation)&&void 0!==o?o:0,x=null!==(l=m.rotation)&&void 0!==l?l:0;return L0.isEqual(g,y)&&L0.isEqual(v,b)&&w===x?void 0:{update:e=>{f.repeat=L0.lerp(g,y,e),f.offset=L0.lerp(v,b,e),f.rotation=$N.lerp(w,x,e),f.updateMatrix()},start:()=>{f.repeat=[...g],f.offset=[...v],f.rotation=w,f.updateMatrix()},end:()=>{f.repeat=[...y],f.offset=[...b],f.rotation=x,f.updateMatrix()}}}var Lue=new PB,Nue=new mz;function Bue(e,t,r,n,i){var s,a,o,l,c,u,h,d,f,p,m,g,v,y,b,w,x,S;let _,C,E,A,M,T,P,k,D=[];if(e instanceof mae?(_=xue("position",e,t,r,i),_&&D.push(_),E=gue("rotation",e,t,r,i),E&&D.push(E),A=xue("shear",e,t,r,i),A&&D.push(A)):(k={slide:null!==(s=null!==(a=null!==(o=null===(l=t.pathSnapping)||void 0===l?void 0:l.slide)&&void 0!==o?o:null===(c=e.updatedPathSnapping)||void 0===c?void 0:c.slide)&&void 0!==a?a:null===(u=e.dataPatched.pathSnapping)||void 0===u?void 0:u.slide)&&void 0!==s?s:0,offset:null!==(h=null!==(d=null!==(f=null===(p=t.pathSnapping)||void 0===p?void 0:p.offset)&&void 0!==f?f:null===(m=e.updatedPathSnapping)||void 0===m?void 0:m.offset)&&void 0!==d?d:null===(g=e.dataPatched.pathSnapping)||void 0===g?void 0:g.offset)&&void 0!==h?h:0},T=gue("slide",k,null!==(v=null!==(y=t.pathSnapping)&&void 0!==y?y:e.updatedPathSnapping)&&void 0!==v?v:e.dataPatched.pathSnapping,null!==(b=r.pathSnapping)&&void 0!==b?b:e.dataPatched.pathSnapping,i),T&&D.push(T),P=gue("offset",k,null!==(w=null!==(x=t.pathSnapping)&&void 0!==x?x:e.updatedPathSnapping)&&void 0!==w?w:e.dataPatched.pathSnapping,null!==(S=r.pathSnapping)&&void 0!==S?S:e.dataPatched.pathSnapping,i),P&&D.push(P),!T&&!P&&(_=bue("position",e,t,r,i),_&&D.push(_),C=bue("scale",e,t,r,i),C&&D.push(C),E=function(e,t,r,n,i){var s;let a=null!==t&&void 0!==t&&t.rotation?t.rotation.map((e=>{var t;return("string"==typeof e?Number(null!==(t=i.getVariable(e))&&void 0!==t?t:0):e)*$N.DEG2RAD})):void 0,o=null===(s=r.rotation)||void 0===s?void 0:s.map((e=>{var t;return("string"==typeof e?Number(null!==(t=i.getVariable(e))&&void 0!==t?t:0):e)*$N.DEG2RAD}));if(!o)return;let l=a?(new PB).fromArray(a):(new PB).setFromEuler(e.rotation),c=(new PB).fromArray(o);if(l.equals(c))return;let u=Lue.subVectors(c,l);if(n&&u.toArray().every((e=>Math.abs(e)<2*Math.PI))){let t=(new TB).setFromEuler(Nue.setFromVector3(l)),r=(new TB).setFromEuler(Nue.setFromVector3(c));return{update:n=>{!function(e,t,r,n){if(0===n)return r.copy(e);if(1===n)return r.copy(t);let i=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(i>=1)return r.copy(e);let s=1-i*i;if(s<=Number.EPSILON){let i=1-n;return r.w=i*e.w+n*t.w,r.x=i*e.x+n*t.x,r.y=i*e.y+n*t.y,r.z=i*e.z+n*t.z,r.normalize(),r}let a=Math.sqrt(s),o=Math.atan2(a,i),l=Math.sin((1-n)*o)/a,c=Math.sin(n*o)/a;r.w=e.w*l+t.w*c,r.x=e.x*l+t.x*c,r.y=e.y*l+t.y*c,r.z=e.z*l+t.z*c}(t,r,e.quaternion,n)},start:()=>{e.rotation.setFromVector3(l)},end:()=>{e.rotation.setFromVector3(c)}}}return{update:t=>{Lue.lerpVectors(l,c,t),e.rotation.setFromVector3(Lue)},start:()=>{e.rotation.setFromVector3(l)},end:()=>{e.rotation.setFromVector3(c)}}}(e,t,r,n,i),E&&D.push(E),M=function(e,t,r,n){let i=r[e]?r[e]:void 0,s=n[e];if(!s)return;let a=t[e],o=i?(new sz).fromArray(i):a.clone(),l=new PB,c=new TB,u=new PB;o.decompose(l,c,u);let h=(new sz).fromArray(s),d=new PB,f=new TB,p=new PB;return h.decompose(d,f,p),o.equals(h)?void 0:{update:e=>{mue.slerpQuaternions(c,f,e),fue.lerpVectors(l,d,e),pue.lerpVectors(u,p,e),a.compose(fue,mue,pue)},start:()=>{a.compose(l,c,u)},end:()=>{a.compose(d,f,p)}}}("hiddenMatrix",e,t,r),M&&D.push(M))),_||C||E||M||T||P){let r=e instanceof mae?()=>{e.updateWorldMatrix(!0,!1,!0),e.resetBBoxNeedsUpdate()}:()=>{var r;e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),null!==(r=e.parent)&&void 0!==r&&r.matrixWorldFusedFalse&&(e.matrixWorld.multiplyMatrices(e.parent.matrixWorldFusedFalse,e.matrix),e.matrixWorldNeedsUpdate=!1),qne(e)&&Xne(e.parent)&&e.invalidateDownstreamBooleanData(!0),e.updatePathSnapping(Object.assign({},t.pathSnapping,k))};D.push({update:r,start:r,end:r})}return D}function zue(e,t,r,n){let i=[];if(!("cloner"in r)||!e.cloner)return i;let s=e.cloner,a="cloner"in t?t.cloner:{},o=r.cloner;g1.forEach((e=>{let t;t="count"===e?gue("count",s.parameters,a,o,n,!0):_ue(e,s.parameters,null!==a&&void 0!==a?a:{},o,n),t&&i.push(t)}));let l=function(e,t,r,n){if("radial"!==e.parameters.type)return;let i=t.radial,s=r.radial;if(!s)return;let a=e.parameters.radial,o=[];return v1.forEach((e=>{let t=_ue(e,a,null!==i&&void 0!==i?i:{},s,n);t&&o.push(t)})),o}(s,a,o,n);(null===l||void 0===l?void 0:l.length)&&i.push(...l);let c=function(e,t,r,n){if("linear"!==e.parameters.type)return;let i=t.linear,s=r.linear;if(!s)return;let a=[],o=e.parameters.linear;return y1.forEach((e=>{let t=_ue(e,o,null!==i&&void 0!==i?i:{},s,n);t&&a.push(t)})),a}(s,a,o,n);(null===c||void 0===c?void 0:c.length)&&i.push(...c);let u=function(e,t,r,n){if("grid"!==e.parameters.type)return;let i=t.grid,s=r.grid;if(!s)return;let a=[],o=e.parameters.grid;return b1.forEach((e=>{let t;t="count"===e?vue(e,o,null!==i&&void 0!==i?i:{},s,n,!0):_ue(e,o,null!==i&&void 0!==i?i:{},s,n),t&&a.push(t)})),a}(s,a,o,n);(null===u||void 0===u?void 0:u.length)&&i.push(...u);let h=function(e,t,r,n){if("toObject"!==e.parameters.type)return;let i=t.toObject,s=r.toObject;if(!s)return;let a=[],o=e.parameters.toObject;return w1.forEach((e=>{let t;t="count"===e?gue(e,o,null!==i&&void 0!==i?i:{},s,n,!0):_ue(e,o,null!==i&&void 0!==i?i:{},s,n),t&&a.push(t)})),a}(s,a,o,n);(null===h||void 0===h?void 0:h.length)&&i.push(...h);let d=function(e,t,r,n){if(!e.parameters.randomness)return;let i=t.randomnessObject,s=r.randomnessObject;if(!s)return;let a=[],o=e.parameters.randomnessObject;return x1.forEach((e=>{let t=_ue(e,o,null!==i&&void 0!==i?i:{},s,n);t&&a.push(t)})),a}(s,a,o,n);return null!==d&&void 0!==d&&d.length&&i.push(...d),i.length&&i.push({update:()=>{s.update()}}),i}function Fue(e,t,r,n,i){let s,a,o,l,c,h,d,f,p,m,g,v,y,b,w,x=[];if("width"in e&&(s=gue("width",e,t,r,i),s&&x.push(s)),"height"in e&&(a=gue("height",e,t,r,i),a&&x.push(a)),e instanceof Uae||e instanceof qae){let n=u({},t.fill),s=u({},r.fill);void 0!==n.enabled&&n.enabled!==s.enabled&&(x.push(function(e,t){return{update:()=>{e instanceof Uae&&(e.fill.enabled=t)}}}(e,!0)),n.enabled||Object.assign(n,{enabled:!0,color:u(u({},n.color),{},{a:0})}),s.enabled||Object.assign(s,{enabled:!0,color:u(u({},s.color),{},{a:0})})),o=Sue("color",e.fill,n,s,i),o&&x.push(o)}if(e instanceof Uae){let n=u({},t.stroke),s=u({},r.stroke);(n.enabled||s.enabled)&&(x.push(function(e,t){return{update:()=>{e instanceof Uae&&(e.stroke.enabled=t)}}}(e,!0)),n.enabled||Object.assign(n,{enabled:!0,color:u(u({},n.color),{},{a:0})}),s.enabled||Object.assign(s,{enabled:!0,color:u(u({},s.color),{},{a:0})})),l=Sue("color",e.stroke,n,s,i),l&&x.push(l),c=gue("thickness",e.stroke,n,s,i),c&&x.push(c)}if(e instanceof Uae){let n=u({},t.dropShadow),s=u({},r.dropShadow);(n.enabled||s.enabled)&&(x.push(function(e,t){return{update:()=>{e instanceof Uae&&(e.dropShadow.enabled=t)}}}(e,!0)),n.enabled||Object.assign(n,{enabled:!0,color:u(u({},n.color),{},{a:0})}),s.enabled||Object.assign(s,{enabled:!0,color:u(u({},s.color),{},{a:0})})),h=Sue("color",e.dropShadow,n,s,i),h&&x.push(h),d=gue("blurRadius",e.dropShadow,n,s,i),d&&x.push(d),p=gue("spread",e.dropShadow,n,s,i),p&&x.push(p),f=xue("offset",e.dropShadow,n,s,i),f&&x.push(f)}if(e instanceof Uae){let n=u({},t.innerShadow),s=u({},r.innerShadow);(n.enabled||s.enabled)&&(x.push(function(e,t){return{update:()=>{e instanceof Uae&&(e.innerShadow.enabled=t)}}}(e,!0)),n.enabled||Object.assign(n,{enabled:!0,color:u(u({},n.color),{},{a:0})}),s.enabled||Object.assign(s,{enabled:!0,color:u(u({},s.color),{},{a:0})})),m=Sue("color",e.innerShadow,n,s,i),m&&x.push(m),g=gue("blurRadius",e.innerShadow,n,s,i),g&&x.push(g),y=gue("spread",e.innerShadow,n,s,i),y&&x.push(y),v=xue("offset",e.innerShadow,n,s,i),v&&x.push(v)}if(e instanceof Uae||e instanceof qae){let n=u({},t.backgroundBlur),s=u({},r.backgroundBlur);(n.enabled||s.enabled)&&(x.push(function(e,t){return{update:()=>{e instanceof Uae&&(e.backgroundBlur.enabled=t)}}}(e,!0)),n.enabled||Object.assign(n,{enabled:!0,radius:0}),s.enabled||Object.assign(s,{enabled:!0,radius:0})),b=gue("radius",e.backgroundBlur,n,s,i),b&&x.push(b)}if(e instanceof Uae){let n=u({},t.layerBlur),s=u({},r.layerBlur);(n.enabled||s.enabled)&&(x.push(function(e,t){return{update:()=>{e instanceof Uae&&(e.layerBlur.enabled=t)}}}(e,!0)),n.enabled||Object.assign(n,{enabled:!0,radius:0}),s.enabled||Object.assign(s,{enabled:!0,radius:0})),w=gue("radius",e.layerBlur,n,s,i),w&&x.push(w)}if(e instanceof qae||e instanceof Hae){let n=vue("cornerRadius",e,t,r,i);n&&x.push(n)}return x}function jue(e,t,r,n,i){let s=[];return e.data.visible&&s.push(...Bue(e,t,r,i,n)),e instanceof mae?s.push(...Fue(e,t,r,0,n)):(e.data.visible&&s.push(...zue(e,t,r,n)),qne(e)?(e instanceof Dre&&e.data.visible&&s.push(...Cue(e,t,r,n)),e.data.visible&&s.push(...function(e,t,r,n){let i=[];if(Array.isArray(e.material)){if(!("materials"in r)||!r.materials)return i;let s="materials"in t&&t.materials?t.materials:[],a=r.materials;e.material.forEach(((e,t)=>{var r;if(!a[t])return;let o=null!==(r=s[t])&&void 0!==r?r:{},l=a[t];"string"==typeof o||"string"==typeof l||i.push(...Aue(e,o,l,n))}))}else{if(!("material"in r)||!r.material)return i;let s="material"in t&&t.material?t.material:{},a=r.material;if("string"==typeof s||"string"==typeof a)return i;i.push(...Aue(e.material,s,a,n))}return i}(e,t,r,n))):(e=>Hne.is(e))(e)?e.data.visible&&s.push(...Eue(e,t,r,n)):(e=>e instanceof Fne)(e)&&s.push(...function(e,t,r,n){var i,s,a,o;let l=[],c="OrthographicCamera"===e.cameraType?null===(i=t.orthographic)||void 0===i?void 0:i.zoom:null===(s=t.perspective)||void 0===s?void 0:s.zoom,u="OrthographicCamera"===e.cameraType?null===(a=r.orthographic)||void 0===a?void 0:a.zoom:null===(o=r.perspective)||void 0===o?void 0:o.zoom;if(void 0!==u){let t=null!==c&&void 0!==c?c:e.zoom,r=u;t!==r&&l.push({update:n=>{e.zoom=$N.lerp(t,r,n),e.updateProjectionMatrix()},start:()=>{e.zoom=t,e.updateProjectionMatrix()},end:()=>{e.zoom=r,e.updateProjectionMatrix()}})}if(void 0!==r.targetOffset){let i=gue("targetOffset",e,t,r,n);i&&l.push(i)}return l}(e,t,r,n))),s.length?{update:e=>{s.forEach((t=>t.update(e)))},start:e=>{s.forEach((t=>{var r;return null===(r=t.start)||void 0===r?void 0:r.call(t,e)}))},end:e=>{s.forEach((t=>{var r;return null===(r=t.end)||void 0===r?void 0:r.call(t,e)}))}}:void 0}var Uue=new PB;function Vue(e,t){var r;let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[],s=r=>{let n=r.data;delete r.states,r.currentState=null,r.reversibleToState=null,r.currentTransitionEvent=null;for(let e of n.states){let t=u({},e.data);r.states||(r.states={}),r.states[e.id]=Y2.patch(n,t)}Wue(e.scene,r,null,t,void 0!==n.events.find((e=>"Follow"===e.data.type||"LookAt"===e.data.type))),Hue(e)};e.scene.traverse2D(s),e.traverseChildren((r=>{var a,o,l,c,h,d;if(n&&(null!==(a=r.rigidBody)&&void 0!==a&&a.setTranslation(r.position0,!0),null!==(o=r.rigidBody)&&void 0!==o&&o.setRotation(r.rotation0,!0),null!==(l=r.rigidBody)&&void 0!==l&&l.setLinvel(Uue,!0),null!==(c=r.rigidBody)&&void 0!==c&&c.setAngvel(Uue,!0)),!W4.is(r))return;let f=r.uuid,p=r.data;if(delete r.states,r.uuid===t1)return;let m=!1;i.some((t=>{var r;return null===(r=e.scene.find(f))||void 0===r?void 0:r.isDescendantOf(t)}))?m=!0:!0===(null===(h=p.physics)||void 0===h?void 0:h.fusedBody)&&"dynamic"===p.physics.rigidBody&&i.push(f),r.data=p,r.currentState=null,r.reversibleToState=null,r.currentTransitionEvent=null;for(let t of p.states){let n=u({},t.data);!0===e.data.globalPhysics.usePhysics&&p.physics&&("dynamic"===p.physics.rigidBody||m)&&(void 0!==t.data.position&&delete n.position,void 0!==t.data.rotation&&delete n.rotation,void 0!==t.data.hiddenMatrix&&delete n.hiddenMatrix),r.states||(r.states={}),r.states[t.id]=i2.patch(p,n)}Wue(e.scene,r,null,t,void 0!==p.events.find((e=>"Follow"===e.data.type||"LookAt"===e.data.type))),r instanceof woe&&r.frame&&(r.frame.traverse((e=>s(e))),null===(d=r.uiCanvas)||void 0===d||d.applySize())})),Hue(e),e.frame&&(e.frame.traverse((e=>s(e))),null===(r=e.uiCanvas)||void 0===r||r.applySize())}function Hue(e){e.traverseEntity((t=>{for(let r of t.data.events){let t=[];switch(r.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":t.push(...r.data.actions);break;case"GameControl":for(let e of Object.values(r.data.gameActions))t.push(...e);break;case"DragDrop":t.push(...r.data.dragDropActions.drag,...r.data.dragDropActions.drop);break;case"Conditional":t.push(...r.data.inActions,...r.data.outActions)}for(let r of t)if("Create"===r.data.type&&"Yes"===r.data.hideBase){let t=e.scene.find(r.data.object);t&&(t.visible=!1)}}}))}function Wue(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(t instanceof Dre&&!(t instanceof Woe)&&t.removeInteractionGeometry(n),t instanceof mae?t.changeSelectedState(r,{shared:n},i):t.changeSelectedState(r,{scene:e,shared:n},i),t instanceof Dre&&t.updateGeometryGroupsIfNeeded(),t instanceof Fne&&t.updateCameraState(t.dataPatched,{scene:e,shared:n}),!(t instanceof mae)){if(t.cloner)for(let e of t.cloner.children)e.playModeVisible=void 0;t.updateVisible()}}function Gue(e){let t;if(5===e.easing){let{control1:r,control2:n}=e;t="cubicBezier(\n\t\t\t".concat(r[0],", ").concat(r[1],", ").concat(n[0],", ").concat(n[1],"\n\t\t)")}else if(6===e.easing){let{mass:r,stiffness:n,damping:i,velocity:s}=e;t="spring( ".concat(r,", ").concat(n,", ").concat(i,", ").concat(s," )")}else{let r;switch(e.easing){case 0:default:r=K0.linear;break;case 1:r=K0.ease;break;case 2:r=K0.easeIn;break;case 3:r=K0.easeOut;break;case 4:r=K0.easeInOut}let[n,i,s,a]=r;t="cubicBezier( ".concat(n,", ").concat(i,", ").concat(s,", ").concat(a," )")}return{duration:Math.max(e.duration,1e-4),easing:t}}function que(e){let t={delay:0,loop:-1===e.repeat||e.repeat+1};if(0===e.repeat)t.direction="normal",t.rewind=!1;else switch(e.direction){case"pingpong":t.direction="alternate",t.rewind=!1;break;case"pingpong-rewind":t.direction="alternate",t.rewind=!0;break;default:t.direction="normal",t.rewind=!1}switch(t.delay=0,t.endDelay=0,t.startOnceDelay=0,t.pingPongDelayCorrection=0,t.pingPongEndDelayCorrection=0,e.delayDirection){case"start-once":t.startOnceDelay=e.delay;break;case"start":t.delay=e.delay;break;case"end":t.endDelay=e.delay;break;case"start-end":case void 0:t.delay=e.delay,t.endDelay=e.delay}return"alternate"===t.direction&&(t.delay/=2,t.endDelay/=2,"start"===e.delayDirection?(t.pingPongDelayCorrection=t.delay,"number"==typeof t.loop&&t.loop%2===0&&(t.pingPongEndDelayCorrection=t.delay)):"end"===e.delayDirection?"number"==typeof t.loop&&t.loop%2!==0&&(t.pingPongEndDelayCorrection=t.endDelay):"start-end"===e.delayDirection&&(t.pingPongDelayCorrection=t.delay,t.pingPongEndDelayCorrection=t.endDelay)),t}var Xue={type:"beginState"},Yue={type:"completeState",isfromEntity:!1},Kue=class{constructor(e,t,r,n,i,s){if(this.object=e,this.data=n,this.sharedAssets=i,this.allowSlerp=s,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.requestRender()),0===this.targets.t||1===this.targets.t?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let e=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=e,this.object.dispatchEvent({type:"beginState",state:e}),this.object instanceof mae||this.object.traverseEntity((e=>{e!==this.object&&e instanceof Fne&&e.dispatchEvent(Xue)}))},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let e=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=e,this.object.dispatchEvent({type:"completeState",state:e}),this.object instanceof mae||this.object.traverseEntity((e=>{e!==this.object&&e instanceof Fne&&e.dispatchEvent(Yue)}))},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=jue(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},void 0===t){let e=Zue(this.object,this.object.currentState===r?this.object.prevState:this.object.currentState);if(!e)throw new Error("Missing property");this.from=e}else{let e=Zue(this.object,t);if(!e)throw new Error("Missing property");this.from=e}if(void 0===r)throw new Error("Missing property");{let e=Zue(this.object,r);if(!e)throw new Error("Missing property");this.to=e}this.useCurrentState=void 0===t||void 0===r,this.params=u(u(u({targets:this.targets,t:1,autoplay:!1},que(n)),Gue(n)),{},{change:this.onChange}),this.callback=jue(this.object,void 0===t?{}:this.from.data,void 0===r?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},Que=class extends FN{constructor(e,t,r,n,i){var s,a,o;if(super(),this.eventType=e,this.data=t,this.page=r,this.shared=n,this.condition=i,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.hasPlayedOnce=!1,this.onTimelineChangeComplete=()=>{var e;"normal"!==this.data.tweens[0].data.direction&&(this.toggleIsForward=!this.toggleIsForward),!1!==this.timelineNeedsRebuild&&(null!==(e=this.timeline)&&void 0!==e&&e.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!1,isRebuild:!0}),this.timeline.play())},!t.object)throw new Error("Missing property");let l=null!==(s=null!==(a=this.page.scene.find(t.object))&&void 0!==a?a:null===(o=this.page.uiCanvas)||void 0===o?void 0:o.find(t.object))&&void 0!==s?s:this.page.scene.find2DInUIObjects(t.object);if(!l)throw new Error("Missing property");if(!l.states)throw new Error("Missing property");if(this.object=l,t.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay="start-once"===t.tweens[0].data.delayDirection?t.tweens[0].data.delay:0,this.init()}get playing(){var e;return!1===(null===(e=this.timeline)||void 0===e?void 0:e.paused)}get changeBegan(){var e;return null!==(e=this.tweens.some((e=>e.changeBegan)))&&void 0!==e&&e}init(){this.initialCurrentState=Zue(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return"Toggle"===this.data.runMode&&f0(this.eventType)?this.initialCurrentState:this.object.currentState}buildTimeline(){var e;let{isForward:t=!0,needsRebuild:r=!1,isRebuild:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var i;let e=que(this.data.tweens[0].data);n&&"number"==typeof e.loop&&e.loop--,null!==(i=this.timeline)&&void 0!==i&&i.pause(),this.timeline=due.timeline(u(u({autoplay:!1},e),!0===e.loop||e.loop>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}));let c=this.tweens.findIndex((e=>null===e||void 0===e?void 0:e.changeBegan));if(!0===r&&(this.timelineNeedsRebuild=!0),t){let t=-1===c?0:c;for(let r=t;r<this.data.tweens.length-1;r++){var s,a;let n,i=this.data.tweens[r],o=this.data.tweens[r+1];r!==t||!0!==this.object.wasMovedByUser&&!0!==(null===(s=this.object.previousAction)||void 0===s?void 0:s.changeBegan)?n=void 0===i.data.state?this.currentState:i.data.state:(n=void 0,this.object instanceof Fne&&(this.object.wasMovedByUser=!1));let l=new Kue(this.object,n,void 0===o.data.state?this.currentState:o.data.state,o.data,this.shared,null!==(a=this.data.allowSlerp)&&void 0!==a&&a);-1!==c&&r===t&&Object.assign(l.params,{startOnceDelay:0}),this.tweens[r]=l,this.timeline.add(l.params,this.timeline.duration+(r===t?e.delay:0))}this.timeline.duration+=e.endDelay}else{let t=-1===c?this.data.tweens.length-1:c+1;for(let r=t;r>0;r--){var o,l;let n,i=this.data.tweens[r],s=this.data.tweens[r-1];r!==t||!0!==this.object.wasMovedByUser&&!0!==(null===(o=this.object.previousAction)||void 0===o?void 0:o.changeBegan)?n=void 0===i.data.state?this.currentState:i.data.state:(n=void 0,this.object instanceof Fne&&(this.object.wasMovedByUser=!1));let a=new Kue(this.object,n,void 0===s.data.state?this.currentState:s.data.state,i.data,this.shared,null!==(l=this.data.allowSlerp)&&void 0!==l&&l);-1!==c&&r===t&&Object.assign(a.params,{startOnceDelay:0}),this.tweens[r-1]=a,this.timeline.add(a.params,this.timeline.duration+(r===t?e.endDelay:0))}this.timeline.duration+=e.delay}}catch(Q0){Q0 instanceof Error&&console.error(Q0.message)}!0===(null===(e=this.object.previousAction)||void 0===e?void 0:e.playing)&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(!1===che(this.shared,this.condition)||f0(this.eventType)&&"Once"===this.data.runMode&&this.hasPlayedOnce||(this.hasPlayedOnce=!0,this.playing))return!1;clearTimeout(this.timeoutId);let e=que(this.data.tweens[0].data).pingPongDelayCorrection;this.timeoutId=window.setTimeout((()=>{try{this.buildTimeline(),this.timeline.play()}catch(ca){ca instanceof Error&&console.error(ca.message)}}),this.startOnceDelay+e)}pause(){var e;null!==(e=this.timeline)&&void 0!==e&&e.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let e=void 0===this.data.tweens[0].data.state?this.initialCurrentState:this.data.tweens[0].data.state;this.object instanceof mae?this.object.changeSelectedState(e,{shared:this.shared}):this.object.changeSelectedState(e,{scene:this.page.scene,shared:this.shared}),this.object.currentState=e}seek(e){var t;if(!1===che(this.shared,this.condition))return!1;void 0===this.timeline&&this.buildTimeline(),null===(t=this.timeline)||void 0===t||t.seek(e*this.timeline.duration,!0)}toggle(e){var t;if(!1===che(this.shared,this.condition))return!1;clearTimeout(this.timeoutId),this.toggleIsForward=null!==e&&void 0!==e?e:!this.toggleIsForward,this.playing?(null!==(t=this.timeline)&&void 0!==t&&t.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!0}),this.timeline.play()):this.timeoutId=window.setTimeout((()=>{var e;null!==(e=this.timeline)&&void 0!==e&&e.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()}),this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function Zue(e,t){var r;let n,i;if("string"==typeof t?(n=t,i=null===(r=e.states)||void 0===r?void 0:r[n]):null===t&&(n=null,i=e.data),void 0!==n&&void 0!==i)return{id:n,data:i}}var Jue={type:"beginState"},$ue={type:"completeState",isfromEntity:!1},ehe={type:"requestRender"},the=class extends FN{constructor(e,t,r,n){super(),this.data=e,this.page=t,this.shared=r,this.condition=n,this.toggleIsForward=!1,this.posStart=new PB,this.posEnd=new PB,this.qStart=new TB,this.qEnd=new TB,this.zoomStart=1,this.zoomEnd=1}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(){if(!this.data.animate)return;let e=this.page.scene.find(this.data.targetCamera);if(!e||!e.visible)throw new ReferenceError("Target camera not founded or not visible");let t={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=due(u(u({targets:t,t:1},Gue(this.data)),{},{update:()=>{0===t.t&&("Toggle"!==this.data.runMode||this.toggleIsForward?(this.posEnd.copy(e.position),this.qEnd.copy(e.quaternion),this.zoomEnd=e.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(e.uuid)):this.fromCamera&&(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera.uuid)),this.page.activeCamera.dispatchEvent(Jue));let r=this.page.activeCamera;r.position.lerpVectors(this.posStart,this.posEnd,t.t),r.quaternion.slerpQuaternions(this.qStart,this.qEnd,t.t),r.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*t.t,r.wasMovedBySwitchCameraAction=!0,r.updateMatrix(),r.updateMatrixWorld(),r.updateProjectionMatrix(),r.dispatchEvent(ehe),1===t.t&&r.dispatchEvent($ue)}}))}switchCamera(e){let t=this.page.activeCamera,r=this.page.scene.find(e);if(!r||!r.visible)throw new ReferenceError("Target camera not founded or not visible");this.page.switchActiveCamera(r),t.dispatchEvent({type:"cameraChange",camera:r})}play(){if(!1===che(this.shared,this.condition))return!1;if(!this.playing&&this.page.activeCamera.uuid!==this.data.targetCamera)try{clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout((()=>{var e;delete this.timeoutId,this.data.animate?(this.buildAnimation(),null===(e=this.animation)||void 0===e||e.play()):this.switchCamera(this.data.targetCamera)}),1e3*this.data.delay)}catch(e){}}pause(){var e;null!==(e=this.animation)&&void 0!==e&&e.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(e){if(!1===che(this.shared,this.condition))return!1;if(window.clearTimeout(this.timeoutId),delete this.timeoutId,e!==this.toggleIsForward)try{var t,r;this.playing?(null!==(t=this.animation)&&void 0!==t&&t.pause(),this.toggleIsForward=null!==e&&void 0!==e?e:!this.toggleIsForward,this.buildAnimation(!0),null===(r=this.animation)||void 0===r||r.play()):this.timeoutId=window.setTimeout((()=>{var t,r;this.toggleIsForward=null!==e&&void 0!==e?e:!this.toggleIsForward,this.data.animate?(null!==(t=this.animation)&&void 0!==t&&t.pause(),this.buildAnimation(),null===(r=this.animation)||void 0===r||r.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.data.targetCamera)):this.fromCamera&&this.switchCamera(this.fromCamera.uuid),this.page.activeCamera.dispatchEvent($ue),this.page.activeCamera.dispatchEvent(ehe))}),1e3*this.data.delay)}catch(n){}}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}};function rhe(e){let t=null===e||void 0===e?void 0:e.tracks.filter((e=>"vector"===e.ValueTypeName||"quaternion"===e.ValueTypeName)).map((e=>e.times.length));if(null!==t&&void 0!==t&&t.length){let e=aZ(t);return e&&e>2?e:2}return 2}var nhe=class extends FN{constructor(e,t,r,n,i){var s,a;super(),this.data=e,this.page=t,this.animationControls=r,this.shared=n,this.condition=i,this.startOnceDelay=0,this.toggleIsForward=!1;let o=e.object,l=t.scene.find(e.object);l&&Array.isArray(l.identity)&&(o=l.identity[0]),this.data=u(u({},e),{},{object:o});let c=this.animationControls.clipIdToAction[e.clipId+"/"+o];if(this.duration=null!==(s=null===c||void 0===c||null===(a=c.getClip())||void 0===a?void 0:a.duration)&&void 0!==s?s:1,this.data.crop2){let e=rhe(null===c||void 0===c?void 0:c.getClip());this.leftFrameTime=this.data.crop2[0]/(e-1)*this.duration,this.rightFrameTime=this.data.crop2[1]/(e-1)*this.duration}else{var h;let e=null===c||void 0===c||null===(h=c.getClip())||void 0===h||null===(h=h.tracks[0])||void 0===h?void 0:h.times.length;e&&e>1?(this.leftFrameTime=this.data.crop[0]/e*this.duration,this.rightFrameTime=this.data.crop[1]/e*this.duration):(this.leftFrameTime=0,this.rightFrameTime=this.duration)}this.startOnceDelay=e.delay}get playing(){var e,t;return null!==(e=null===(t=this.threeAnimAction)||void 0===t?void 0:t.isRunning())&&void 0!==e&&e}play(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!1===che(this.shared,this.condition))return!1;window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout((()=>{var t;if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let r=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach((t=>{let[n,i]=t,s=n.split("/")[1];this.threeAnimAction!==i&&s===r&&i.isRunning()&&(e?i.fadeOut(.2):i.stop())})),e&&(null===(t=this.threeAnimAction)||void 0===t||t.fadeIn(.2))}),this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){var e;null===(e=this.threeAnimAction)||void 0===e||e.fadeOut(.2)}seek(e){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=$N.clamp(this.threeAnimAction.time+1/60*e,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!1===che(this.shared,this.condition))return!1;this.toggleIsForward=null!==e&&void 0!==e?e:!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout((()=>{if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){var e;this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let r=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach((e=>{let[n,i]=e,s=n.split("/")[1];this.threeAnimAction!==i&&s===r&&i.isRunning()&&(t?i.fadeOut(.2):i.stop())})),t&&(null===(e=this.threeAnimAction)||void 0===e||e.fadeIn(.2))}}),this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){var e;let t=null===(e=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object])||void 0===e?void 0:e.getClip();t&&(t.duration=this.duration),this.pause()}},ihe=class{constructor(e,t,r,n,i){this.data=e,this.page=t,this.eventManager=r,this.shared=n,this.condition=i,this.timeOutId=-1,this.scene=t.scene}dispatch(){if(!1===che(this.shared,this.condition))return!1;this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout((()=>{this.play()}),1e3*this.data.delay))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every((e=>e.uuid!==this.data.target||e.data.uiScene)))return;"fade"===this.data.transition&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,1e3*this.data.duration),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let e=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.traverseVisibleEntity((e=>{"ParticleSystem"===e.type&&(e.sleep(),e.wakeUp(),e.data.autoPlay?e.start():e.stop())})),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(e),Vue(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}},she=class{constructor(e,t,r,n){this.data=e,this.page=t,this.shared=r,this.condition=n,this.evaluatedCondition=!1}checkConditions(){this.evaluatedCondition=che(this.shared,this.condition)}dispatch(){if(!1===this.evaluatedCondition)return!1;let e=this.shared.getVariable(this.data.variableId),t=z8(this.data.expression,this.shared,m2.typeOfVariable(e));void 0!==t&&this.shared.updateVariable(this.data.variableId,"string"==typeof t?{textValue:t}:t)}dispose(){}},ahe=class{constructor(e,t,r,n){this.data=e,this.page=t,this.shared=r,this.condition=n,this.timeoutId=null}dispatchInner(){if(!1===che(this.shared,this.condition))return!1;let e=this.shared.getDynamicVariablePlayState(this.data.variableId);if("PlayPause"===this.data.mode)void 0===this.shared.getDynamicVariableToggleIsForward(this.data.variableId)&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"===e?"Paused":"Playing");else if("Play"===this.data.mode&&"Playing"!==e)void 0===this.shared.getDynamicVariableToggleIsForward(this.data.variableId)&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing");else if("Stop"===this.data.mode&&"Stopped"!==e)this.shared.setDynamicVariablePlayState(this.data.variableId,"Stopped");else if("Pause"===this.data.mode&&"Paused"!==e)this.shared.setDynamicVariablePlayState(this.data.variableId,"Paused");else if("Restart"===this.data.mode)this.shared.setDynamicVariablePlayState(this.data.variableId,"Restarted");else if("Toggle"===this.data.mode){let t=this.shared.getDynamicVariableToggleIsForward(this.data.variableId);"Playing"===e?this.shared.setDynamicVariableToggleIsForward(this.data.variableId,void 0!==t&&!t):(this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!t),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"))}}dispatch(){let e=this.data.delay,t=this.shared.getDynamicVariablePlayState(this.data.variableId);"PlayPause"===this.data.mode&&"Playing"===t&&(e=this.data.pauseDelay),0!==e?(this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout((()=>{this.timeoutId=null,this.dispatchInner()}),e)):this.dispatchInner()}dispose(){this.timeoutId&&window.clearTimeout(this.timeoutId)}},ohe=class{constructor(e,t,r,n){this.data=e,this.page=t,this.shared=r,this.condition=n}dispatch(){if(!1===che(this.shared,this.condition))return!1;("single"===this.data.target?this.data.variableId?[this.data.variableId]:[]:Object.keys(this.shared.getVariables())).forEach((e=>{var t;this.shared.getVariable(e);let r=null===(t=this.shared.data.variables.data(e))||void 0===t?void 0:t.value;void 0!==r&&this.shared.updateVariable(e,r),this.shared.enableLocalStorageForPersistentVariables&&localStorage.removeItem(Sre(e))}))}dispose(){}},lhe=class{constructor(e,t,r,n){this.data=e,this.page=t,this.shared=r,this.condition=n}dispatch(){var e;if(!1===che(this.shared,this.condition))return!1;this.data.userAPIId&&(null===(e=this.shared.getUserAPI(this.data.userAPIId))||void 0===e||e.callUserAPI(this.shared))}dispose(){}};function che(e,t){if(void 0===t)return!0;if(0===t.expression.length)return!1;let r=z8(t.expression,e,"boolean");return t.negate?!r:!!r}function uhe(e,t,r,n,i,s){let a={Audio:[],Video:[],Particles:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[],SetVariable:[],DynamicVariablePlay:[],ClearLocalStorage:[],UserAPI:[]},o=t=>l=>{let{id:c,data:u}=l;try{"Audio"===u.type?R0[e.type].includes("Audio")&&a.Audio.push(new nce(c,u,s,n,t)):"Video"!==u.type||s instanceof mae?"Particles"===u.type?R0[e.type].includes("Particles")&&a.Particles.push(new ice(u,r,n,t)):"Link"===u.type?R0[e.type].includes("Link")&&a.Link.push(new oce(u,i.controlsManager,n,t)):"Create"===u.type?R0[e.type].includes("Create")&&a.Create.push(new She(u,r,i.controlsManager,n,t)):"Destroy"===u.type?R0[e.type].includes("Destroy")&&a.Destroy.push(new lce(u,r,i.controlsManager,n,t)):"Reset"===u.type?R0[e.type].includes("Reset")&&a.Reset.push(new cce(u,r,n,i,t)):"Transition"===u.type?R0[e.type].includes("Transition")&&a.Transition.push(new Que(e.type,u,r,n,t)):"SwitchCamera"===u.type?R0[e.type].includes("SwitchCamera")&&a.SwitchCamera.push(new the(u,r,n,t)):"SceneTransition"===u.type?R0[e.type].includes("SceneTransition")&&a.SceneTransition.push(new ihe(u,r,i,n,t)):"Animation"===u.type?R0[e.type].includes("Animation")&&a.Animation.push(new nhe(u,r,i.animationControls,n,t)):"SetVariable"===u.type?R0[e.type].includes("SetVariable")&&a.SetVariable.push(new she(u,r,n,t)):"DynamicVariablePlay"===u.type?R0[e.type].includes("DynamicVariablePlay")&&a.DynamicVariablePlay.push(new ahe(u,r,n,t)):"Conditional"===u.type?R0[e.type].includes("Conditional")&&(u.ifActions.forEach(o({expression:u.condition,negate:!1})),u.elseActions.forEach(o({expression:u.condition,negate:!0}))):"ClearLocalStorage"===u.type?R0[e.type].includes("ClearLocalStorage")&&a.ClearLocalStorage.push(new ohe(u,r,n,t)):"UserAPI"===u.type&&R0[e.type].includes("UserAPI")&&a.UserAPI.push(new lhe(u,r,n,t)):R0[e.type].includes("Video")&&a.Video.push(new ghe(c,u,s,n,t))}catch(H0){}};return t.forEach(o()),a}function hhe(e){Object.values(e).forEach((e=>{e.forEach((e=>{(e instanceof nce||e instanceof ghe||e instanceof ice||e instanceof nhe||e instanceof Que||e instanceof She||e instanceof lce||e instanceof the||e instanceof ihe||e instanceof cce||e instanceof she||e instanceof ahe)&&e.dispose()}))}))}var dhe=new Map,fhe=new Map,phe=class{constructor(e,t,r){this.data=t,this.delay=0,this.status="stopped";let{layerId:n,loop:i,volume:s,delay:a}=t;if(this.object=r,void 0===n)throw new Error("Missing property");let o=function(e,t){let r;if("material"in e){let n=e.material;r=Array.isArray(n)?e.material[0].layers.find((e=>e.uuid===t)):e.material.layers.find((e=>e.uuid===t))}if(r)return r.color.texture.image.img instanceof HTMLVideoElement?r.color.texture.image.img:void 0}(r,n);o&&(this.videoElement=o,this.videoElement.loop=i===1/0,xZ&&(this.videoElement.autoplay=!0),void 0!==s&&(this.videoElement.volume=s)),void 0!==a&&(this.delay=a),fhe.has(r.uuid)?fhe.get(r.uuid).push(this):fhe.set(r.uuid,[this]),dhe.set(e,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(e){if(!this.videoElement)return;let t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e?(this.mute(),this.delay+=150):t?(this.mute(),window.setTimeout((()=>{this.unMute()}),100)):this.unMute(),this.delayTimerId=window.setTimeout((()=>{if(!this.videoElement)return;let e=this.videoElement.play();void 0!==e&&e.then((e=>{})).catch((e=>{this.play()})),this.clearDelay()}),this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){"stop"===this.data.toggle?"playing"===this.status?this.stop():(this.stop(),this.play()):"pause"===this.data.toggle?"playing"===this.status?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},mhe=class{constructor(e){this.data=e}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(e){let t=dhe.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{t[this.data.interaction](),this.disposeDelay()}),this.data.delay)):t[this.data.interaction]())}pauseAllVideosFromObject(e){let t=fhe.get(e);null===t||void 0===t||!t.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{t.forEach((e=>e[this.data.interaction]())),this.disposeDelay()}),this.data.delay)):t.forEach((e=>e[this.data.interaction]())))}pauseAllVideos(){let e=[...fhe.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{e.forEach((e=>{e.forEach((e=>{e[this.data.interaction]()}))})),this.disposeDelay()}),this.data.delay)):e.forEach((e=>{e.forEach((e=>{e[this.data.interaction]()}))})))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},ghe=class{constructor(e,t,r,n,i){if(this.data=t,this.shared=n,this.condition=i,"play"===t.interaction)this.interaction=new phe(e,t,r);else{if("pause"!==t.interaction&&"stop"!==t.interaction)throw new Error("Missing property");this.interaction=new mhe(t)}}dispatchBasic(){if(!1===che(this.shared,this.condition))return!1;this.interaction instanceof phe?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(!1===che(this.shared,this.condition))return!1;this.interaction instanceof phe?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},vhe=(()=>{let e,t,r,n;function i(r){var i;!e&&!yhe()&&(null===(i=t)||void 0===i?void 0:i.sharedGameControlGlobals.createdObjects.length)>0&&(e=requestAnimationFrame(s)),r&&(t=r,n=r.requestRender)}function s(i){let a=r?i-r:0,o=t.sharedGameControlGlobals.createdObjects,l=t.sharedGameControlGlobals.nCreatedPerAction,c=o.length,u=0;for(;u<c;){let e=o[u];void 0===e.userData.createdTime&&(e.userData.createdTime=i),void 0===e.userData.lifetime&&void 0===e.userData.quantity||e.userData.lifetime&&i-e.userData.createdTime<e.userData.lifetime||e.userData.quantity&&l[e.userData.actionId]<=e.userData.quantity?(e.userData.velocity&&(e.position.addScaledVector(e.userData.velocity,a/1e3),e.updateMatrix(),n()),u++):(l[e.userData.actionId]>e.userData.quantity&&l[e.userData.actionId]--,o.splice(u,1),e.removeFromParent(),t.sharedGameControlGlobals.rapierWorld&&e.rigidBody?(t.sharedGameControlGlobals.colliderToEntity.delete(e.rigidBody.collider(0).handle),t.sharedGameControlGlobals.rapierWorld.removeRigidBody(e.rigidBody)):(e.bvhGeometry=void 0,t.sharedGameControlGlobals.entitiesWithTransformAnim=t.sharedGameControlGlobals.entitiesWithTransformAnim.filter((e=>void 0!==e.bvhGeometry))),c--,n())}e=u>0?requestAnimationFrame(s):void 0,r=u>0?i:void 0}return typeof document<"u"&&document.addEventListener("visibilitychange",(function(){yhe()?e&&(cancelAnimationFrame(e),e=void 0,r=void 0):i()})),i})();function yhe(){return!!document&&document.hidden}var bhe=new TB,whe=new PB,xhe=new PB,She=class{constructor(e,t,r,n,i){this.data=e,this.page=t,this.controlsManager=r,this.shared=n,this.condition=i,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=$N.generateUUID(),this.dispatch=()=>{if(!1===che(this.shared,this.condition))return!1;this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,1e3*this.data.delay)):this.dispatchInner()},this.dispatchFromStart=()=>{if(!1===che(this.shared,this.condition))return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,1e3*this.data.delay))},this.dispatchThrottled=gZ(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{null===this.intervalId&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{null!==this.intervalId&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let e=new X4(this.object);if(e.playModeVisible=!0,e.expand(),"world"!==this.data.coordinateSystem){let t=this.data.coordinateSystem,r=this.page.scene.find(t);r&&(r.updateMatrixWorldSVD(),e.hiddenMatrix.copy(r.matrixWorldRigid))}e.scale.copy(this.object.scale),e.position.fromArray(this.data.position),e.rotation.fromArray(this.data.rotation),e.updateMatrix(),this.page.add(e);let t=this.controlsManager.sharedGameControlGlobals;t.createdObjects.push(e),void 0===t.nCreatedPerAction[this.uniqueId]?t.nCreatedPerAction[this.uniqueId]=1:t.nCreatedPerAction[this.uniqueId]++,e.updateWorldMatrix(!0,!0),e.traverseObject(this.traverseObjectCB),vhe(),this.controlsManager.requestRender()},this.traverseObjectCB=e=>{var t,r,n;let i;if(e.hasNonUniformScale&&e.updateMatrixWorldSVD(),this.controlsManager.sharedGameControlGlobals.rapierWorld){var s;if(e instanceof wne){if(!e.objectForSample)return!0===e.object.dataPatched.physics.fusedBody&&"dynamic"===e.object.dataPatched.physics.rigidBody||void 0;if(e.objectForSample.dataPatched.physics.fusedBody)return;i=e.object}else if(e instanceof X4)i=e.object;else if(i=e,null!==(s=i.dataPatched.cloner)&&void 0!==s&&s.hideBase)return!0}else{if(e instanceof wne)return;i=e instanceof X4?e.object:e}"Time"===this.data.destroy?e.userData.lifetime=1e3*this.data.lifetime:"Quantity"===this.data.destroy&&(e.userData.quantity=this.data.destroyAfterQuantity,e.userData.actionId=this.uniqueId);let a=(new PB).fromArray(this.data.velocity),o=i.dataPatched;if(!("visibility"===o.physics.enabled?!o.visible:!o.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(e,i,{fromCreate:!0,dynamic:this.data.dynamic}),"Collision"===this.data.destroy&&(null!==(t=e.rigidBody)&&void 0!==t&&t.collider(0).setActiveEvents(1),e.userData.hasCollisionDestroy=!0),e.matrixWorld.decompose(whe,bhe,xhe),a.applyQuaternion(bhe),this.data.velocity.some((e=>0!==e))&&this.data.dynamic&&(null===(r=e.rigidBody)||void 0===r||r.setLinvel(a.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in e.object&&this.controlsManager.addBoundsTree(e),this.data.velocity.some((e=>0!==e))&&this.data.dynamic&&(e.userData.velocity=a)),!0===(null===(n=i.dataPatched.physics)||void 0===n?void 0:n.fusedBody)))return!0};let s=this.page.scene.find(this.data.object);if(!s)throw new Error("Missing Property");if(this.object=s,"world"!==this.data.coordinateSystem&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");vhe(r)}dispose(){null!==this.intervalId&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach((e=>window.clearTimeout(e))),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},_he=.02,Che=(new PB,new PB),Ehe=new PB,Ahe=new PB,Mhe=new PB,The=new PB,Phe=new PB,khe=new sz,Dhe=new sz,Ihe=new sz,Ohe=(new sz,new TB),Rhe=new TB,Lhe=new mz(0,0,0,"YXZ"),Nhe=new PB(1,0,0),Bhe=new PB(0,1,0),zhe=new PB(0,0,1),Fhe=new PB(1,1,1),jhe=(new QB,new pG),Uhe=new IB,Vhe={type:"requestRender"},Hhe={type:"updateMatrix"},Whe=Math.PI/6,Ghe=class extends FN{constructor(e,t,r,n,i,s,a,o,l){var c,h,d,f,p,m,g,v,y,b,w,x,S,_,C,E,A,M,T;super(),this.object=e,this.domElement=t,this.data=r,this.gloabalPhysics=n,this.controlsManager=i,this.cameraFollow=s,this.camera=a,this.page=o,this.sharedAssets=l,this.enableDamping=!0,this.hiddenMatrix0=new sz,this.target0=new PB,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=200,this.euler0=new mz(0,0,0,"YXZ"),this.position0Cam=new PB,this.quat0Cam=new TB,this.scale0Cam=new PB,this.hiddenMatrix0Cam=new sz,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new pG(new PB(0,-40,0),new PB(0,40,0)),matrix:new sz,position:new PB,rotation:new TB},this.euler=new mz(0,0,0,"YXZ"),this.eulerDelta=new PB,this.lastPosition=new PB,this.lastCameraQuaternion=new TB,this.lastCameraPosition=new PB,this.PI_2=Math.PI/2,this.prevMouse=new eB,this.velocityTarget=new PB,this.velocity=new PB,this.directionXZ=new PB,this.rotVelocityStick=new PB,this.rotVelocityTarget=new PB,this.rotVelocity=new PB,this.rotDirection=new PB,this.nonColliderRotOffset=new sz,this.nonColliderPosOffset=new sz,this.firstPointerId=-1,this.rot=new PB,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new sz,this.objectToTarget=new PB,this.objectToTarget0=new PB,this.objectToCamXZ=new PB,this.objectToCamXZ0=new PB,this.targetToCamera=new PB,this.targetToCamera0=new PB,this.cameraPolarAxis0=new PB,this.targetPos=new PB,this.targetQuat=new TB,this.lerpFactorPos=(new PB).setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new TB,this.objXZQuatInv=new TB,this.objXZRotMat=new sz,this.isFirstPerson=!1,this.didHit=!1,this.groundVelocity=new PB,this.pushedVelocity=new PB,this.groundYRotation=0,this.objectRealQuat=new TB,this.colliderWorldQuat=new TB,this.groundNormal=new PB,this.groundTilt=new TB,this.groundTiltInv=new TB,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new PB,this.quaternion=new TB,this.scale=new PB,this.initialAction=!0,this.onPointerDown=e=>{var t;!(e.target===this.domElement||e.target instanceof HTMLElement&&"SPLINE-VIEWER"===e.target.tagName&&null!==(t=e.target.shadowRoot)&&void 0!==t&&t.contains(this.domElement))||-1!==this.firstPointerId||(this.firstPointerId=e.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),"keys"!==this.rotBy&&!_Z&&!CZ&&this.domElement.requestPointerLock(),this.prevMouse.set(e.clientX,e.clientY))},this.onPointerUp=e=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),"mouse"===e.pointerType&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=e=>{if(e.pointerId!==this.firstPointerId)return;let t=e.clientX-this.prevMouse.x,r=e.clientY-this.prevMouse.y;this.prevMouse.set(e.clientX,e.clientY),"mouse"===e.pointerType&&"keys"!==this.rotBy&&(CZ&&EZ<15.5&&!_Z?(this.eulerDelta.y=-t*this.mouseOrbitSensitivity,this.eulerDelta.x=-r*this.mouseOrbitSensitivity):(this.eulerDelta.y=-e.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-e.movementY*this.mouseOrbitSensitivity)),"mouse"!==e.pointerType&&"drag"===this.rotByTouch&&(this.eulerDelta.y=-t*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-r*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=e=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?Ghe.isLocked=!0:Ghe.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{var e;if(null!==(e=document)&&void 0!==e&&e.hidden)for(let t in this.movementState)this.movementState[t]=0},this.onKeyDown=e=>{!(e.target instanceof HTMLInputElement)&&("ArrowLeft"===e.code||"ArrowUp"===e.code||"ArrowRight"===e.code||"ArrowDown"===e.code||"Space"===e.code)&&e.preventDefault();for(let t of this.keyAssignments)if(e.key.toUpperCase()===t[1]||e.key===t[1]){this.movementState[t[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=e=>{for(let t of this.keyAssignments)if(e.key.toUpperCase()===t[1]||e.key===t[1]||e.code.slice(3,e.code.length).toUpperCase()===t[1]){this.movementState[t[0]]=0;break}},this.copyVRGamePadValues=(e,t)=>{for(let r=2;r<4;r++){let n=e.axes[r];0===t?2===r?this.movementState.movePosX=n:this.movementState.movePosZ=n:(e.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,2===r?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(n)>=.3&&(this.vrEulerYOffset+=n<0?1:-1),this.movementState.rotPosY=n):"fly"===this.moveMode&&(this.movementState.moveNegY=n))}},this.sharedGameControlGlobals=i.sharedGameControlGlobals,e===a&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let P=this.euler0.clone(),k=P.y;if(this.objectRealQuat.copy(this.quaternion),P.y=0,this.quaternion.setFromEuler(P),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),P.set(0,k,0),this.quaternion.setFromEuler(P),this.rot.setFromEuler(P),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||!0===this.cameraFollow)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),!0===this.cameraFollow){var D;this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy(null===(D=this.camera)||void 0===D?void 0:D.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let e,t,r=new PB(0,0,-1).applyQuaternion(this.camera.quaternion),n=(new PB).subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(n),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ),Math.abs(r.y)<1e-6?(n.y=0,r.y=0,t=n.projectOnVector(r)):t=n.y/r.y>0?r.multiplyScalar(n.y/r.y):r.multiplyScalar(n.length()),this.targetToCamera0.copy(t).negate(),e=this.camera.position.clone().add(t),this.objectToTarget0.subVectors(e,this.position);let i=(new mz).setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-i.x,i.x=0,i.z=0,i.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(i)}if(this.object instanceof Fne&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=null!==(c=r.rotByTouch)&&void 0!==c?c:"joystick",this.rotBy=null!==(h=r.rotBy)&&void 0!==h?h:"keys",this.rotationMode=null!==(d=r.rotationMode)&&void 0!==d?d:"normal",this.moveMode=null!==(f=r.moveMode)&&void 0!==f?f:"walk",this.collisionEnabled=r.collisionEnabled,this.speedTranslate=1*(null!==(p=r.speedTranslate)&&void 0!==p?p:250),this.speedOrbit=.025*(null!==(m=r.speedRotate)&&void 0!==m?m:100),this.mouseOrbitSensitivity=16e-6*(null!==(g=r.speedRotate)&&void 0!==g?g:100),this.keyAssignments=r.keyAssignments.map((e=>{let t=[e[0],e[1]];return"\u25b2"===t[1]?t[1]="ArrowUp":"\u25c0"===t[1]?t[1]="ArrowLeft":"\u25bc"===t[1]?t[1]="ArrowDown":"\u25b6"===t[1]?t[1]="ArrowRight":"\u21e7"===t[1]?t[1]="Shift":"\u21b5"===t[1]?t[1]="Enter":"Space"===t[1]?t[1]=" ":"\u2318"===t[1]?t[1]="Meta":"Ctrl"===t[1]?t[1]="Control":"Esc"===t[1]&&(t[1]="Escape"),t})),"mouse"===r.rotBy){let e;e=this.keyAssignments.findIndex((e=>"rotNegX"===e[0])),-1!==e&&(this.keyAssignments[e][1]=""),e=this.keyAssignments.findIndex((e=>"rotPosX"===e[0])),-1!==e&&(this.keyAssignments[e][1]=""),e=this.keyAssignments.findIndex((e=>"rotPosY"===e[0])),-1!==e&&(this.keyAssignments[e][1]=""),e=this.keyAssignments.findIndex((e=>"rotNegY"===e[0])),-1!==e&&(this.keyAssignments[e][1]="")}this.lerpFactorPosStart=1-.02**(1/(60*(null!==(v=r.delayPos[0])&&void 0!==v?v:.3))),this.lerpFactorPosEnd=1-.02**(1/(60*(null!==(y=r.delayPos[1])&&void 0!==y?y:.3))),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/(60*(null!==(b=r.delayRot[0])&&void 0!==b?b:.3))),this.lerpFactorRotEnd=1-.02**(1/(60*(null!==(w=r.delayRot[1])&&void 0!==w?w:.3))),this.lerpFactorPosCamera=1-.02**(1/(60*(null!==(x=r.delayPosCamera)&&void 0!==x?x:.3))),this.lerpFactorRotCamera=1-.02**(1/(60*(null!==(S=r.delayRotCamera)&&void 0!==S?S:.3))),this.gravity=12*(null!==(_=this.gloabalPhysics.gravity)&&void 0!==_?_:j1.defaultData.gravity),this.usePhysics=null!==(C=this.gloabalPhysics.usePhysics)&&void 0!==C?C:j1.defaultData.usePhysics,this.jumpPower=20*r.jumpPower,this.resetYPosition=this.position.y+Math.abs(r.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=null!==(E=r.alignToGround)&&void 0!==E&&E,this.orientMode=r.autoOrientMove?r.orientMode:"none",this.orientWith=null!==(A=r.orientWith)&&void 0!==A?A:S2.defaultDataThirdPerson.orientWith,this.slopeThresh=65*Math.PI/180,"capsule"===r.collider.type?(this.collider.radius=r.collider.radius,this.collider.segment.start.y=r.collider.height/2-r.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=r.collider.height*_he/this.pixelsPerMeter,this.stepThresh=.3*r.collider.height/this.pixelsPerMeter,this.colliderHeight=r.collider.height):"sphere"===r.collider.type?(this.collider.radius=r.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*r.collider.radius*_he/this.pixelsPerMeter,this.stepThresh=2*r.collider.radius*.3/this.pixelsPerMeter,this.colliderHeight=2*r.collider.radius):(this.offset=r.collider.height*_he/this.pixelsPerMeter,this.stepThresh=.3*r.collider.height/this.pixelsPerMeter,this.colliderHeight=r.collider.height),this.collider.type=r.collider.type;let I=(new PB).fromArray(r.collider.position),O=(new TB).setFromEuler((new mz).fromArray([...r.collider.rotation,"XYZ"]));this.collider.position.copy(I).multiply(this.scale),this.collider.rotation.copy(O),this.collider.matrix.compose(I,O,Fhe),void 0!==r.cameraXAxis&&(this.cameraXAxis=r.cameraXAxis,this.cameraYAxis=r.cameraYAxis,this.minPolarAngle=r.cameraRotXLimits[0],this.maxPolarAngle=r.cameraRotXLimits[1],this.minAzimuthAngleRel=r.cameraRotYLimits[0],this.maxAzimuthAngleRel=r.cameraRotYLimits[1]),this.forwardDir=null!==(M=r.forwardDirection)&&void 0!==M?M:"-z",this.isFirstPerson&&(this.forwardDir="-z"),this.runMultiplier=null!==(T=r.runMultiplier)&&void 0!==T?T:2;let R=2*r.navmesh.destinationHelperRadius;if(R>0){let e=new nJ;e.push({fi:0,data:u(u({},S1.defaultData("light","phong")),{},{alpha:0}),id:"layer1"}),e.push({fi:0,data:u(u({},S1.defaultData("color")),{},{color:r.navmesh.destinationHelperColor,alpha:r.navmesh.destinationHelperColor.a}),id:"layer2"});let t=new xte({layers:e},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new yF(p5.create({parameters:{width:R,height:R/10,hollow:.7}}),t),this.navMeshPathDest.material.userData.opacity0=r.navmesh.destinationHelperColor.a}this.activate()}reset(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),e){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let e=(new mz).setFromQuaternion(this.quaternion,"YXZ"),t=e.y;this.objectRealQuat.copy(this.quaternion),e.y=0,this.quaternion.setFromEuler(e),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),e.set(0,t,0),this.quaternion.setFromEuler(e),this.rot.setFromEuler(e),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof Fne?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();!0===this.cameraFollow&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){var e;this.deactivate(),(null===(e=this.navMeshPathDest)||void 0===e?void 0:e.parent)&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let e=this.data,t=this.sharedAssets;void 0!==e.gameActions&&(this.actions={},x2.list.forEach((r=>{this.actions[r]=uhe(u(u({},e),{},{disabled:!1,type:"GameControl"}),e.gameActions[r],this.page,t,this.controlsManager.eventManager,this.object)}))),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),hhe(this.actions.idle),hhe(this.actions.move),hhe(this.actions.run),hhe(this.actions.jump)}dispatchStartEvent(e){void 0!==this.actions[e]&&(this.actionState[e]||(this.actionState[e]=!0,this.actions[e].Transition.forEach((e=>{e.play()})),this.actions[e].Animation.forEach((e=>{e.play(!1===this.initialAction)})),this.actions[e].Create.forEach((e=>{e.dispatchStart()})),this.actions[e].Audio.forEach((e=>{e.dispatchGameControl("start")})),this.actions[e].Particles.forEach((e=>{e.dispatchGameControl("start")}))))}dispatchStopEvent(e){void 0!==this.actions[e]&&(!this.actionState[e]||(this.actionState[e]=!1,this.actions[e].Transition.forEach((e=>{e.stop(),null!==e.object.currentState&&e.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})})),this.actions[e].Create.forEach((e=>{e.dispatchStop()})),this.actions[e].Audio.forEach((e=>{e.dispatchGameControl("stop")})),this.actions[e].Particles.forEach((e=>{e.dispatchGameControl("stop")}))))}get colliderWorldPosition(){return Mhe.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(e,t,r){var n;if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let i=(this.isFirstFrame?16.6:e)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let s=60*i,a=!1;if(this.usePhysics&&this.collisionEnabled){var o;let e=The.set(0,(0===this.velocity.y?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/120,1)*(this.gravity>0?1:-1):this.velocity.y)*i,0).divideScalar(this.pixelsPerMeter),t=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,e,null===(o=this.object.rigidBody)||void 0===o?void 0:o.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(t){var l;this.onObject=!0,this.groundNormal.set(t.normal2.x,t.normal2.y,t.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(a=!0),0===(null===(l=t.collider.parent())||void 0===l?void 0:l.bodyType())&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let e=t.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(t.rigidBody===e&&t.userData.isFollowingObj!==this.object.uuid){(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(Mhe,Rhe,The),this.groundVelocity.subVectors(Mhe,t.prevT),this.object.getWorldPosition(The).add(this.collider.position).sub(Mhe),this.groundYRotation=Lhe.setFromQuaternion(Rhe).y-t.prevR.y,Phe.copy(The).applyAxisAngle(Bhe,this.groundYRotation),this.groundVelocity.add(Phe.sub(The)).divideScalar(i);break}}else this.onObject=!1}if("walk"===this.moveMode&&this.collisionEnabled&&(1===this.movementState.jump&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*s),"fly"===this.moveMode&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,"+z"===this.forwardDir&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let e=this.navMeshPathDest.material;if("walk"===this.moveMode&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let t=Mhe.subVectors(this.path[1],this.position),r=The.subVectors(this.path[1],this.path[0]);t.dot(r)<0?this.path.shift():(this.directionXZ.x=r.x,this.directionXZ.z=r.z),e.opacity=e.userData.opacity0}else e.opacity-=.05*e.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,("walk"===this.moveMode?this.velocityTarget.x+this.velocityTarget.z===0:0===this.velocityTarget.manhattanLength())?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),"walk"===this.moveMode&&(this.lerpFactorPos.y=1),!1===this.didHit&&0===this.pushedVelocity.manhattanLength()||!1===this.usePhysics?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**s),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**s),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**s)):this.velocity.copy(this.velocityTarget),("walk"===this.moveMode?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let c=Ahe.copy(this.velocity);if("none"!==this.orientMode&&!1===this.isFirstPerson){let e=The.copy(c);e.y=0,c.set(0,c.y,e.length()*("+z"===this.forwardDir?1:-1))}if(this.directionXZ.manhattanLength()>0&&"none"!==this.orientMode&&!1===this.isFirstPerson)if("camera"===this.orientWith&&this.path.length<=1){let e=Mhe;this.camera.getWorldDirection(e);let t=Phe.copy(Bhe).multiplyScalar(e.dot(Bhe));e.sub(t);let r=The.copy(this.directionXZ);r.x*=-1,this.rot.y=e.angleTo(r)*(e.cross(r).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*("+z"===this.forwardDir?1:-1);if(Lhe.setFromVector3(this.rot),"walk"===this.moveMode&&(Lhe.x=0),c.applyEuler(Lhe),a&&(Rhe.setFromUnitVectors(Bhe,this.groundNormal),c.applyQuaternion(Rhe)),r){let e=Lhe.set(0,this.vrEulerYOffset*Whe,0);r.applyEuler(e),c.x+=r.x,c.z+=r.z,this.nonColliderPosOffset.elements[13]+=r.y*i}if(!0===this.usePhysics){let e=The;this.pushedVelocity.set(0,0,0);for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim){let r=Phe.setFromMatrixPosition(t.matrixWorld).sub(t.prevT).divideScalar(i).divideScalar(this.pixelsPerMeter),n=t.rigidBody.collider(0).castCollider(r,this.object.rigidBody.collider(0),Mhe.copy(c).divideScalar(this.pixelsPerMeter),i,!1);r.multiplyScalar(this.pixelsPerMeter);let s=W4.is(t)?t:t.object;if(null!==n&&this.lastHitObj!==s){let e;t instanceof X4&&(e=t);let r=this.sharedGameControlGlobals.entityToCollisionEvents[s.uuid];if(r)for(let t of r)"character"===t.data.target&&(t.dispatch(e),s.dispatchEvent(gpe));this.lastHitObj=s}if(null!==n){this.pushedVelocity.copy(r),e.copy(n.normal1).applyQuaternion(t.quaternion);break}}if(0!==this.pushedVelocity.manhattanLength()){let t=e.dot(c);t<0&&c.addScaledVector(e,-t),c.add(this.pushedVelocity)}else c.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),"normal"===this.rotationMode&&(this.movementState.rotPosX||this.movementState.rotNegX)||"steer"===this.rotationMode&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||"walk"===this.moveMode)?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,"normal"===this.rotationMode&&(this.movementState.rotPosY||this.movementState.rotNegY)||"steer"===this.rotationMode&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(i),this.rotVelocityStick),0===this.rotVelocityTarget.manhattanLength()?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**s):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**s),this.euler.x+=this.rotVelocity.x*i,this.euler.y+=this.rotVelocity.y*i+this.groundYRotation,0===this.rotVelocityTarget.y&&0===this.directionXZ.manhattanLength()?this.rotationAccumWhenOrientWithCamera=0:(!1===this.cameraFollow||"Locked"===this.cameraYAxis)&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*i),!1===this.isFirstPerson&&"none"!==this.orientMode&&this.directionXZ.manhattanLength()>0){if("radial"===this.orientMode){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(Bhe,this.euler.y-this.euler0.y);let e=The.copy(this.objectToCamXZ).normalize(),t=Phe.copy(c).multiplyScalar(i);t.y=0;let r=t.sub(Mhe.copy(e).multiplyScalar(t.dot(e))).cross(e).y;this.euler.y-=Math.atan2(r,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*i+this.groundYRotation,0!==this.rotVelocityTarget.y&&(!1===this.cameraFollow||"Locked"===this.cameraYAxis)&&(this.euler.y=this.rot.y);if(!0===this.cameraFollow&&("walk"===this.moveMode?"Limit"===this.cameraXAxis?this.euler.x=$N.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=$N.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):"Limit"===this.cameraXAxis&&(this.euler.x=$N.clamp(this.euler.x,-this.PI_2,this.PI_2))),"fly"===this.moveMode?this.rot.x=this.euler.x:this.isFirstPerson&&(t?(Lhe.copy(t),Lhe.y=0):(Lhe.copy(this.euler),Lhe.y=0),this.nonColliderRotOffset.makeRotationFromEuler(Lhe)),t&&("walk"===this.moveMode?(this.rot.y=t.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(t),this.rot.y+=this.vrEulerYOffset*Whe),Ohe.setFromAxisAngle(Nhe,this.rot.x),Rhe.setFromAxisAngle(Bhe,this.rot.y),Rhe.multiply(Ohe),Ohe.setFromAxisAngle(zhe,this.rot.z),Rhe.multiply(Ohe),this.quaternion.copy(Rhe),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){var u,h;let e=The.copy(c).multiplyScalar(i/this.pixelsPerMeter),t=null;this.didHit=!1;let r=new PB;for(let n=0;n<5;n++){var d;let i=e.length(),s=Phe.copy(e).normalize();if(t=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(r),this.colliderWorldQuat,s,null===(d=this.object.rigidBody)||void 0===d?void 0:d.collider(0).shape,i,!1,24,void 0,void 0,this.object.rigidBody),null===t){0===n&&0!==this.directionXZ.manhattanLength()&&(this.lastHitObj=null),r.add(e);break}{this.didHit=!0;let a=this.sharedGameControlGlobals.colliderToEntity.get(t.collider.handle);if(a!==this.lastHitObj&&0===n){this.lastHitObj=a;let e=this.sharedGameControlGlobals.entityToCollisionEvents[null===a||void 0===a?void 0:a.uuid];if(e)for(let r of e)if("character"===r.data.target){var f;let e,n=(null===(f=this.sharedGameControlGlobals.rapierWorld)||void 0===f?void 0:f.getCollider(t.collider.handle))._parent;if(a.cloner)for(let t of a.cloner.children)if(t.rigidBody===n){e=t;break}r.dispatch(e),a.dispatchEvent(gpe)}}let o=Che.set(t.normal2.x,t.normal2.y,t.normal2.z).applyQuaternion(this.colliderWorldQuat),l=Ehe.copy(s).multiplyScalar(t.toi).dot(o),c=t.toi;if(0===c&&(this.position.y+=this.offset*this.pixelsPerMeter),l>this.offset&&(c=t.toi*(l-this.offset)/l,r.addScaledVector(s,c)),e.copy(s).multiplyScalar(i-c),Math.acos(-o.y)>this.slopeThresh){var p;let n=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(r),i=Phe.copy(t.witness2).applyQuaternion(this.colliderWorldQuat);i.y=0;let s=n.add(i);s.y+=this.stepThresh;let a=this.sharedGameControlGlobals.rapierWorld.castShape(s,this.colliderWorldQuat,e,null===(p=this.object.rigidBody)||void 0===p?void 0:p.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);null!==a&&0===a.toi&&(o.y=0,o.normalize())}e.addScaledVector(o,-e.dot(o))}}this.position.addScaledVector(r,this.pixelsPerMeter),null!==(u=this.object.rigidBody)&&void 0!==u&&u.setTranslation(Mhe.copy(this.position).divideScalar(this.pixelsPerMeter),!0),null===(h=this.object.rigidBody)||void 0===h||h.setRotation(Ohe.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let e=this.onObject?1:5,t=c.multiplyScalar(i/e);for(let r=0;r<e;r++)this.position.add(t),this.collisionAdjustment(i/e)}else this.position.addScaledVector(c,i);if("walk"===this.moveMode&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),!0===this.cameraFollow){this.updateFollowArms();let e=this.objectToTarget.add(this.position),t=this.targetToCamera.add(e);khe.lookAt(t,e,Bhe).setPosition(t),khe.decompose(this.targetPos,this.targetQuat,Mhe),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**s),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**s),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),"Limit"===this.cameraYAxis&&"cartesian"===this.orientMode&&(this.euler.y=$N.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=$N.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(Hhe),(!(this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(void 0===this.camera||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate))||"fly"!==this.moveMode&&!0!==this.onObject&&!1!==this.collisionEnabled||!(null===this.navMeshPathDest||this.navMeshPathDest.material.opacity<-.04*(null===(n=this.navMeshPathDest)||void 0===n||null===(n=n.material)||void 0===n?void 0:n.userData.opacity0)))&&(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(Vhe),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let e,t=Ohe.setFromAxisAngle(Bhe,"Limit"===this.cameraYAxis&&"radial"!==this.orientMode?$N.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);("Locked"!==this.cameraYAxis||"radial"===this.orientMode)&&this.objectToTarget.applyQuaternion(t),e="Limit"===this.cameraXAxis?$N.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):$N.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let r=Mhe.copy(this.cameraPolarAxis0);("Locked"!==this.cameraYAxis||"radial"===this.orientMode)&&r.applyQuaternion(t);let n=Rhe.setFromAxisAngle(r,e);"Locked"!==this.cameraYAxis&&this.targetToCamera.applyQuaternion(t),"Locked"!==this.cameraXAxis&&this.targetToCamera.applyQuaternion(n)}groundTiltAdjustment(e){180*Bhe.angleTo(e)/Math.PI<15||180*Bhe.angleTo(e)/Math.PI>85?Ohe.identity():Ohe.setFromUnitVectors(Bhe,e),this.groundTilt.slerp(Ohe,.06),this.groundTiltInv.copy(this.groundTilt).invert()}collisionAdjustment(e){var t;let r=Ehe.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let n=khe.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(Mhe,Ohe,The).compose(Mhe,Ohe,Fhe);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach((e=>{if(e===this.object||e.isDescendantOf(this.object))return;Uhe.makeEmpty(),e.updateMatrixWorldSVD();let t=e.matrixWorldRigid,i=Dhe.copy(t).invert(),s=Ihe.copy(Dhe).multiply(n);jhe.copy(this.collider.segment),jhe.start.applyMatrix4(s),jhe.end.applyMatrix4(s);let a=Che.copy(this.position).applyMatrix4(i);Uhe.expandByPoint(jhe.start),Uhe.expandByPoint(jhe.end),Uhe.min.addScalar(-this.collider.radius),Uhe.max.addScalar(this.collider.radius),e.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder:e=>e.distanceToPoint(jhe.end),intersectsBounds:e=>e.intersectsBox(Uhe),intersectsTriangle:e=>{let n=Mhe,i=The,s=e.closestPointToSegment(jhe,n,i);if(s<this.collider.radius){let e=this.collider.radius-s,o=i.sub(n).normalize(),l=Phe.copy(a);l.addScaledVector(o,e);let c=l.applyMatrix4(t).sub(this.position);r.add(c),jhe.start.addScaledVector(o,e),jhe.end.addScaledVector(o,e)}}})})),Uhe.makeEmpty(),jhe.copy(this.collider.segment),jhe.start.applyMatrix4(n),jhe.end.applyMatrix4(n),Uhe.expandByPoint(jhe.start),Uhe.expandByPoint(jhe.end),Uhe.min.addScalar(-this.collider.radius),Uhe.max.addScalar(this.collider.radius),null!==(t=this.sharedGameControlGlobals.staticMeshBVH)&&void 0!==t&&t.shapecast({traverseBoundsOrder:e=>e.distanceToPoint(jhe.end),intersectsBounds:e=>e.intersectsBox(Uhe),intersectsTriangle:e=>{let t=Mhe,n=The,i=e.closestPointToSegment(jhe,t,n);if(i<this.collider.radius){let e=this.collider.radius-i,s=n.sub(t).normalize();this.alignToGround&&this.groundTiltAdjustment(s),r.addScaledVector(s,e),jhe.start.addScaledVector(s,e),jhe.end.addScaledVector(s,e)}}}),this.onObject=Math.abs(r.y)>Math.abs(e*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let i=Math.max(0,r.length()-1e-5);r.normalize().multiplyScalar(i),this.position.add(r)}},qhe=Ghe;qhe.isLocked=!1;var Xhe=yL(xL());function Yhe(e){let t=e.elements,r=t[0]**2+t[1]**2+t[2]**2,n=t[4]**2+t[5]**2+t[6]**2,i=t[8]**2+t[9]**2+t[10]**2,s=t[0]**2+t[4]**2+t[8]**2,a=t[1]**2+t[5]**2+t[9]**2,o=t[2]**2+t[6]**2+t[10]**2,l=1e-8;return r<l||n<l||i<l||s<l||a<l||o<l}function Khe(e,t){let r=new iF;if(t&&Yhe(t))return r.setAttribute("position",new Qz([],3)),r.setIndex([]),r;if(!e.getAttribute("position"))return r.setAttribute("position",new Qz([],3)),r.setIndex([]),r;let{positions:n,triIndices:i}=c9(e.getAttribute("position"),e.getIndex());return r.setAttribute("position",new Qz(n,3)),r.setIndex(i),t&&r.applyMatrix4(t),r}var Qhe=new sz,Zhe=new sz,Jhe=[[0,0,0],[0,0,0],[0,0,0]];function $he(e){let t=e.elements;Jhe[0][0]=t[0],Jhe[0][1]=t[4],Jhe[0][2]=t[8],Jhe[1][0]=t[1],Jhe[1][1]=t[5],Jhe[1][2]=t[9],Jhe[2][0]=t[2],Jhe[2][1]=t[6],Jhe[2][2]=t[10];let{u:r,v:n}=(0,Xhe.SVD)(Jhe),i=Qhe.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),s=Zhe.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1);return i.multiply(s.transpose())}var ede=class extends aG{constructor(){super(),this.layers.enable(3),this.layers.enable(8),this.layers.enable(9)}setFromCamera(e,t){t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):t.isPerspectiveCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.forEach((e=>{e.visible&&this.intersectObject(e,t,r)})),r}createRaycastLineHelper(){let e=new RV({color:65280,linewidth:10}),t=new PB(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),r=new PB(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),n=this.camera.far-this.camera.near,i=(new PB).addVectors(t,r.multiplyScalar(n)),s=new iF;return s.setFromPoints([t,i]),new jV(s,e)}},tde=e=>e instanceof eie||e instanceof moe;function rde(e,t){return e.distance-t.distance}function nde(e,t,r){if(l5(t)&&t.visible){qne(t)&&t.raycast(e,r);for(let n of t.children)nde(e,n,r)}}function ide(e,t,r){if(!(arguments.length>3&&void 0!==arguments[3]&&arguments[3])&&!r.some((t=>void 0!==ode(e,t))))return[];let n=[];return t.children.forEach((t=>nde(e,t,n))),n.sort(rde),n}function sde(e){let t=[];if(e.length){let r=e[0].object;l5(r)&&t.push(r);let n=r.parent;for(;n;)tde(n)&&t.push(n),n=n.parent}return t}function ade(e,t,r,n){let i=e.frame;if(i){let e=t[0]*i.width,s=(1-t[1])*i.height;for(let t of r){let r=t===i.uuid?i:i.find(t);if(null!==r&&void 0!==r&&r.intersects(e,s))return n(r),!0}}return!1}function ode(e,t){if(qne(t)){if(t.visible){let r=[];return t.raycast(e,r),r.length?r[0]:void 0}}else if(tde(t))return lde(e,t)}function lde(e,t){if(l5(t)&&t.visible){if(qne(t)){let r=[];if(t.raycast(e,r),r.length)return r[0]}for(let r of t.children){let t=lde(e,r);if(t)return t}}}var cde=class{constructor(e,t,r,n,i,s,a,o){this.renderer=e,this.publish=t,this.scene=r,this.getCamera=n,this.sharedAssets=i,this.requestRender=s,this.isExport=a,this.frame=o,this.raycaster=new ede,this._useWindowEvents=!1,this.pointerWorld={x:0,y:0},this.pointerScreen={x:0,y:0},this._useWindowEvents="window"===t.mouseEventTarget,this.domElement=e.domElement,this.eventElement=this._useWindowEvents?window:e.domElement,this._domRect=this.domElement.getBoundingClientRect()}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(e){this._useWindowEvents=e,this.eventElement=e?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}set domRect(e){this._domRect=e}get domRect(){return this._domRect}updateRaycaster(e){var t;let{pageX:r,pageY:n}=(null===(t=e.touches)||void 0===t?void 0:t.length)>0?e.touches[0]:e;this.pointerWorld=function(e,t,r){return{x:(e-(r.left+window.scrollX))/r.width*2-1,y:-(t-(r.top+window.scrollY))/r.height*2+1}}(r,n,this._domRect),this.pointerScreen=function(e,t,r){return{x:(e-(r.left+window.scrollX))/r.width,y:1-(t-(r.top+window.scrollY))/r.height}}(r,n,this._domRect),this.raycaster.setFromCamera(this.pointerWorld,this.getCamera())}},ude=class{constructor(e){this.eventContext=e,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},hde=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],dde=e=>{var t;return null===(t=hde.find((t=>{let[r,n]=t;return n===e})))||void 0===t?void 0:t[0]},fde=e=>{var t;return null===(t=hde.find((t=>{let[r]=t;return r===e})))||void 0===t?void 0:t[1]},pde=(e,t)=>{let r=dde(e);if(r){let e=new CustomEvent(r,{bubbles:!0});return Object.defineProperty(e,"target",{writable:!1,value:t}),e}},mde=class extends ude{constructor(){super(...arguments),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=e=>{var t;if(!e.eventName||!e.target||"Scroll"===e.eventName)return;let r=null===(t=this.splineEvents[dde(e.eventName)])||void 0===t?void 0:t[e.target.uuid];if(!r)return;"Scroll"===e.eventName&&void 0!==e.deltaY&&Object.assign(r,{deltaY:e.deltaY});let{domElement:n}=this.eventContext;n.dispatchEvent(r)}}connect(){let{page:e}=this.eventContext;e.traverseEntity((e=>{var t;if(null!==(t=e.data)&&void 0!==t&&t.events.length)for(let[n,i]of hde)if(e.data.events.some((e=>e.data.type===i&&!e.data.disabled))){var r;this.objectsPerEvents.has(n)?null===(r=this.objectsPerEvents.get(n))||void 0===r||r.push(e):this.objectsPerEvents.set(n,[e]);let t={id:e.uuid,name:e.name},s=pde(i,t),a=this.splineEvents[n];a?a[e.uuid]=s:this.splineEvents[n]={[e.uuid]:s}}})),this.objectsPerEvents.forEach((e=>{e.forEach((e=>{e.addEventListener("beginEvent",this.onBeginEvent)}))}))}disconnect(){this.objectsPerEvents.forEach((e=>{e.forEach((e=>{e.removeEventListener("beginEvent",this.onBeginEvent)}))}))}},gde=class{constructor(e,t,r,n,i,s){if(this.id=e,this.data=t,this.object=r,this.entered=!1,("KeyDown"===t.type||"KeyUp"===t.type||"KeyPress"===t.type)&&!t.key)throw new Error("Missing property");this.actions=uhe(t,t.actions,n,i,s,r)}disconnect(){hhe(this.actions)}dispatchHeld(e){this.actions.Create.forEach((t=>{e&&t.dispatchThrottled.cancel(),t.dispatchThrottled()}))}dispatch(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),"MousePress"===this.data.type||"KeyPress"===this.data.type?this.entered||(this.entered=!0,this.actions.Transition.forEach((e=>e.playFromCurrent())),this.actions.Animation.forEach((e=>e.playFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.playFromCurrent())),this.actions.Create.forEach((e=>e.dispatchStart()))):(this.actions.Transition.some((e=>e.playing&&"Toggle"!==e.data.runMode))||this.actions.Transition.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.SwitchCamera.some((e=>e.playing&&"Toggle"!==e.data.runMode))||this.actions.SwitchCamera.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.Animation.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()}))),this.actions.Link.forEach((e=>{e.dispatch()})),this.actions.SceneTransition.forEach((e=>{e.dispatch()})),!1===e&&this.actions.Create.forEach((e=>{e.dispatch()})),this.actions.Destroy.forEach((e=>{e.dispatch()})),this.actions.Reset.forEach((e=>{e.dispatch()})),this.actions.Audio.forEach((e=>{e.dispatchBasic()})),this.actions.Video.forEach((e=>{e.dispatchBasic()})),this.actions.Particles.forEach((e=>{e.dispatchBasic()})),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Particles.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.reverseFromCurrent())),this.actions.Create.forEach((e=>e.dispatchStop())))}dispatchUserEvent(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),e?(this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.reverseFromCurrent()))):(this.actions.Transition.forEach((e=>e.playFromCurrent())),this.actions.Animation.forEach((e=>e.playFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.playFromCurrent()))),this.actions.Link.forEach((e=>{e.dispatch()})),this.actions.SceneTransition.forEach((e=>{e.dispatch()})),this.actions.Create.forEach((e=>{e.dispatch()})),this.actions.Destroy.forEach((e=>{e.dispatch()})),this.actions.Reset.forEach((e=>{e.dispatch()})),this.actions.Audio.forEach((e=>{e.dispatchBasic()})),this.actions.Video.forEach((e=>{e.dispatchBasic()})),this.actions.Particles.forEach((e=>{e.dispatchBasic()})),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}},vde=class extends ude{constructor(e,t,r){super(e),this.eventManager=t,this.useForRaycastProperty=r,this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.sceneInterects=null,this.onCanvasRaycast=e=>{if(!0===this.useForRaycastProperty&&null===this.sceneInterects){this.eventContext.updateRaycaster(e);let{raycaster:t,page:r}=this.eventContext,n=ide(t,r,[],!0);this.sceneInterects=n,n.length&&(this.eventContext.sharedAssets.raycastProperty={x:n[0].point.x,y:n[0].point.y,z:n[0].point.z,objX:n[0].object.matrixWorld.elements[12],objY:n[0].object.matrixWorld.elements[13],objZ:n[0].object.matrixWorld.elements[14]})}},this.onCanvasMouseDown=e=>{(e.target===this.eventContext.domElement||"SPLINE-VIEWER"===e.target.tagName)&&this.canvasMouseEvents.forEach((t=>{("MouseDown"===t.data.type||"MousePress"===t.data.type)&&(this.onCanvasRaycast(e),t.dispatch())}))},this.onCanvasMouseUp=e=>{(e.target===this.eventContext.domElement||"SPLINE-VIEWER"===e.target.tagName)&&this.canvasMouseEvents.forEach((t=>{"MouseUp"===t.data.type?(this.onCanvasRaycast(e),t.dispatch()):"MousePress"===t.data.type&&t.dispatchRelease()}))},this.onMouseDown=e=>{PZ.length>1||(this.eventContext.updateRaycaster(e),this.handleMouseEvent("MouseDown"))},this.onMouseUp=e=>{PZ.length>1||(this.eventContext.updateRaycaster(e),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=e=>{PZ.length>1||(this.eventContext.updateRaycaster(e),this.handleMousePressEvent())},this.onMousePressRelease=e=>{PZ.length>1||(this.eventContext.updateRaycaster(e),this.handleMousePressEvent(!0))},this.onKeyDown=e=>{this.heldKeys[e.key]||(this.handleKeyEvent(e,"KeyDown"),this.handleKeyEventHeld(e,"KeyDown",!0)),this.heldKeys[e.key]=!0},this.onKeyUp=e=>{this.handleKeyEvent(e,"KeyUp"),this.handleKeyEventHeld(e,"KeyUp",!0)},this.onKeyPressDown=e=>{this.heldKeysPress[e.key]?this.handleKeyEventHeld(e,"KeyPress"):(this.handleKeyEvent(e,"KeyPress"),this.handleKeyEventHeld(e,"KeyPress",!0)),this.heldKeysPress[e.key]=!0},this.onKeyPressUp=e=>{this.handleKeyEvent(e,"KeyPress",!0)},this.releaseHeldKey=e=>{delete this.heldKeys[e.key]},this.releaseHeldKeyPress=e=>{delete this.heldKeysPress[e.key]},this._onUserEvent=e=>{var t,r;let{eventName:n,target:i,reverse:s}=e;if(!n||!i)return;let a=fde(n);a&&("MouseDown"===a||"MouseUp"===a||"MousePress"===a?(i.dispatchEvent({type:"beginEvent",eventName:a}),null===(t=this.eventsPerObjects[a])||void 0===t||null===(t=t[i.uuid])||void 0===t||t.forEach((e=>{e.dispatchUserEvent(s)}))):("KeyDown"===a||"KeyUp"===a||"KeyPress"===a)&&(i.dispatchEvent({type:"beginEvent",eventName:a}),null===(r=this.eventsPerObjects[a])||void 0===r||null===(r=r[i.uuid])||void 0===r||r.forEach((e=>{e.dispatchUserEvent()}))))}}connect(){var e,t,r,n,i,s;let{page:a,sharedAssets:o,domElement:l}=this.eventContext,c=(e,t)=>{var r;if(null===(r=e.data)||void 0===r||!r.events.length)return;let n=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let s of n){var i;let r=this.eventsPerObjects[s];if(e.data.events.filter((e=>{let{data:t}=e;return t.type===s&&!0!==t.disabled})).forEach((t=>{let{id:n,data:i}=t;try{let t=new gde(n,i,e,a,o,this.eventManager);t.actions.Video.length&&(this.hasVideoAction=!0),"MouseDown"!==i.type&&"MouseUp"!==i.type&&"MousePress"!==i.type||"Canvas"!==i.mode&&"Window"!==i.mode?(r[e.uuid]?r[e.uuid].some((e=>e.id===t.id))||r[e.uuid].push(t):r[e.uuid]=[t],e instanceof Woe&&e.traverseChildren((e=>{var n;if(!e.visible)return!0;e instanceof Dre&&2!==(null===(n=e.data.geometry.shapeBlendNode)||void 0===n?void 0:n.operation)&&(r[e.uuid]?r[e.uuid].push(t):r[e.uuid]=[t])}))):this.canvasMouseEvents.push(t)}catch(s){}})),null!==(i=r[e.uuid])&&void 0!==i&&i.length&&(this.objectsPerTypes[s].push(e instanceof mae&&("MouseDown"===s||"MouseUp"===s||"MousePress"===s)?t:e),e instanceof Woe)){let t=this.objectsPerTypes[s];e.traverseChildren((e=>{if(!e.visible)return!0;e instanceof Dre&&-1===t.indexOf(e)&&t.push(e)}))}}};a.traverseEntity((e=>{var t;(e instanceof woe||e instanceof uoe)&&null!==(t=e.frame)&&void 0!==t&&t.traverse((t=>{c(t,e)})),c(e)})),this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),l.addEventListener("pointerdown",this.onCanvasMouseDown),l.addEventListener("pointerup",this.onCanvasMouseUp),(null!==(e=this.objectsPerTypes.MouseDown)&&void 0!==e&&e.length||this.useForRaycastProperty)&&(this.domEventsNeeded.add("pointerdown"),l.addEventListener("pointerdown",this.onMouseDown)),null!==(t=this.objectsPerTypes.MouseUp)&&void 0!==t&&t.length&&(this.domEventsNeeded.add("pointerup"),l.addEventListener("pointerup",this.onMouseUp)),null!==(r=this.objectsPerTypes.MousePress)&&void 0!==r&&r.length&&(this.domEventsNeeded.add("pointerdown"),l.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),l.addEventListener("pointerup",this.onMousePressRelease)),null!==(n=this.objectsPerTypes.KeyDown)&&void 0!==n&&n.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),null!==(i=this.objectsPerTypes.KeyUp)&&void 0!==i&&i.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),null!==(s=this.objectsPerTypes.KeyPress)&&void 0!==s&&s.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach((e=>{let[t,r]=e;r.forEach((e=>{e.addEventListener("userEvent",this._onUserEvent)}))}))}disconnect(){let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},e.removeEventListener("pointerdown",this.onCanvasMouseDown),e.removeEventListener("pointerup",this.onCanvasMouseUp),e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerdown",this.onMousePressDown),e.removeEventListener("pointerup",this.onMouseUp),e.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach((e=>{Object.values(e).forEach((e=>{e.forEach((e=>{e.disconnect()}))}))})),this.canvasMouseEvents.forEach((e=>{e.disconnect()})),Object.entries(this.objectsPerTypes).forEach((e=>{let[t,r]=e;r.forEach((e=>{e.removeEventListener("userEvent",this._onUserEvent)}))}))}handleMouseEvent(e){let{stopRaycast:t,raycaster:r,page:n,pointerScreen:i}=this.eventContext,s=this.objectsPerTypes[e],a=s.filter((e=>!(e instanceof mae)));if((s.length||this.useForRaycastProperty)&&(!n.uiCanvas||!ade(n,[i.x,i.y],Object.keys(this.eventsPerObjects[e]),(t=>{this.handleObjectMouseEventDispatch(t,e)})))){if(t||this.useForRaycastProperty){let i;if(null===this.sceneInterects?i=ide(r,n,a,this.useForRaycastProperty):(i=this.sceneInterects,this.sceneInterects=null),this.useForRaycastProperty&&i.length&&(this.eventContext.sharedAssets.raycastProperty={x:i[0].point.x,y:i[0].point.y,z:i[0].point.z,objX:i[0].object.matrixWorld.elements[12],objY:i[0].object.matrixWorld.elements[13],objZ:i[0].object.matrixWorld.elements[14]}),t){var o,l,c,u;let t=[null!==(o=null===(l=i[0])||void 0===l||null===(l=l.uv)||void 0===l?void 0:l.x)&&void 0!==o?o:0,null!==(c=null===(u=i[0])||void 0===u||null===(u=u.uv)||void 0===u?void 0:u.y)&&void 0!==c?c:0];sde(i).forEach((r=>{r instanceof woe&&ade(r,t,Object.keys(this.eventsPerObjects[e]),(t=>{this.handleObjectMouseEventDispatch(t,e)})),this.eventsPerObjects[e][r.uuid]&&this.handleObjectMouseEventDispatch(r,e)}))}}t||a.forEach((t=>{var n,i,s,a;let o=ode(r,t);o&&(this.handleObjectMouseEventDispatch(t,e),t instanceof woe&&ade(t,[null!==(n=null===o||void 0===o||null===(i=o.uv)||void 0===i?void 0:i.x)&&void 0!==n?n:0,null!==(s=null===o||void 0===o||null===(a=o.uv)||void 0===a?void 0:a.y)&&void 0!==s?s:0],Object.keys(this.eventsPerObjects[e]),(t=>{this.handleObjectMouseEventDispatch(t,e)})))}))}}handleMousePressEvent(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t="MousePress",r=this.objectsPerTypes[t],n=r.filter((e=>!(e instanceof mae))),i=[];if(r.length){if(!e){let{stopRaycast:e,raycaster:r,page:s,pointerScreen:a}=this.eventContext,o=!1;if(s.uiCanvas&&(o=ade(s,[a.x,a.y],Object.keys(this.eventsPerObjects[t]),(e=>{i.push(e)}))),e&&!o){let e=ide(r,s,n);i=sde(e),e.forEach((e=>{var r,n,s,a;e.object instanceof woe&&ade(e.object,[null!==(r=null===e||void 0===e||null===(n=e.uv)||void 0===n?void 0:n.x)&&void 0!==r?r:0,null!==(s=null===e||void 0===e||null===(a=e.uv)||void 0===a?void 0:a.y)&&void 0!==s?s:0],Object.keys(this.eventsPerObjects[t]),(e=>{i.push(e)}))}))}else n.forEach((e=>{var n,s,a,o;let l=ode(r,e);l&&(i.push(e),e instanceof woe&&ade(e,[null!==(n=null===l||void 0===l||null===(s=l.uv)||void 0===s?void 0:s.x)&&void 0!==n?n:0,null!==(a=null===l||void 0===l||null===(o=l.uv)||void 0===o?void 0:o.y)&&void 0!==a?a:0],Object.keys(this.eventsPerObjects[t]),(e=>{i.push(e)})))}))}this._prevObjects.length&&this._prevObjects.forEach((e=>{i.includes(e)||this.handleObjectMouseEventDispatchRelease(e,t)})),i.length&&i.forEach((e=>{this.handleObjectMouseEventDispatch(e,t)})),this._prevObjects=i}}handleObjectMouseEventDispatch(e,t){var r;e.dispatchEvent({type:"beginEvent",eventName:t}),null===(r=this.eventsPerObjects[t])||void 0===r||null===(r=r[e.uuid])||void 0===r||r.forEach((e=>{e.dispatch()}))}handleObjectMouseEventDispatchRelease(e,t){var r;e.dispatchEvent({type:"beginEvent",eventName:t}),null===(r=this.eventsPerObjects[t])||void 0===r||null===(r=r[e.uuid])||void 0===r||r.forEach((e=>{e.dispatchRelease()}))}handleKeyEvent(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.objectsPerTypes[t].forEach((n=>{let i=this.eventsPerObjects[t][n.uuid];i.some((t=>{let{data:r}=t;return"key"in r&&r.key===e.key}))&&n.dispatchEvent({type:"beginEvent",eventName:t}),i.forEach((t=>{"key"in t.data&&t.data.key===e.key&&(r?t.dispatchRelease():t.dispatch(!0))}))}))}handleKeyEventHeld(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.objectsPerTypes[t].forEach((n=>{this.eventsPerObjects[t][n.uuid].forEach((t=>{"key"in t.data&&t.data.key===e.key&&t.dispatchHeld(r)}))}))}},yde=new PB,bde=new PB,wde=class{constructor(e,t,r,n,i){this.actionsIn=uhe(e,e.inActions,r,n,i,t),this.actionsOut=uhe(e,e.outActions,r,n,i,t)}disconnect(){hhe(this.actionsIn),hhe(this.actionsOut)}},xde=class extends wde{constructor(e,t,r,n,i,s){super(t,r,n,i,s),this.id=e,this.data=t,this.object=r,this.stage="out",this.objects=[],this.onUpdateMatrixWorld=()=>{for(let n of this.objects)if(!n.visible)return;let e=yde.setFromMatrixPosition(this.objects[0].matrixWorld),t=bde.setFromMatrixPosition(this.objects[1].matrixWorld),r=e.distanceTo(t)<=this.distance?"in":"out";if(this.stage!==r){this.stage=r;let e="in"===r?this.actionsIn:this.actionsOut;e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Link.forEach((e=>e.dispatch())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}};let{distance:a,fromObject:o,toObject:l}=t.condition;this.distance=a;for(let c of[o,l]){if(!c)throw new Error("Missing property");let e=n.find(c);if(!e)throw new Error("Missing property");this.objects.push(e)}}connect(){window.setTimeout((()=>{this.objects.forEach((e=>{e.addEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)})),this.onUpdateMatrixWorld()}),0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach((e=>{e.removeEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)}))}},Sde=class extends wde{constructor(e,t,r,n,i,s){var a,o;super(t,r,n,i,s),this.id=e,this.data=t,this.object=r,this.onBegin=e=>{let{target:t,state:r}=e;this.toState!==r&&(this.actionsOut.Audio.forEach((e=>e.dispatchConditional())),this.actionsOut.Particles.forEach((e=>e.dispatchConditional())),this.actionsOut.Video.forEach((e=>e.dispatchConditional())),this.actionsOut.Link.forEach((e=>e.dispatch())),this.actionsOut.Create.forEach((e=>e.dispatch())),this.actionsOut.Destroy.forEach((e=>e.dispatch())),this.actionsOut.Reset.forEach((e=>e.dispatch())),this.actionsIn.Transition.forEach((e=>e.pause())),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach((e=>e.play())),this.actionsOut.Animation.forEach((e=>e.play())),this.actionsIn.SwitchCamera.forEach((e=>e.pause())),this.actionsOut.SwitchCamera.forEach((e=>e.play())),this.actionsOut.SceneTransition.forEach((e=>e.dispatch())),this.actionsOut.SetVariable.forEach((e=>e.checkConditions())),this.actionsOut.SetVariable.forEach((e=>e.dispatch())),this.actionsOut.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actionsOut.ClearLocalStorage.forEach((e=>e.dispatch())),this.actionsOut.UserAPI.forEach((e=>e.dispatch())))},this.onComplete=e=>{let{target:t,state:r}=e;this.toState===r&&(this.actionsIn.Audio.forEach((e=>e.dispatchConditional())),this.actionsIn.Particles.forEach((e=>e.dispatchConditional())),this.actionsIn.Video.forEach((e=>e.dispatchConditional())),this.actionsIn.Link.forEach((e=>e.dispatch())),this.actionsIn.Create.forEach((e=>e.dispatch())),this.actionsIn.Destroy.forEach((e=>e.dispatch())),this.actionsIn.Reset.forEach((e=>e.dispatch())),this.actionsOut.Transition.forEach((e=>e.pause())),this.actionsOut.Transition.forEach((e=>e.pause())),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach((e=>e.play())),this.actionsIn.Animation.forEach((e=>e.play())),this.actionsOut.SwitchCamera.forEach((e=>e.pause())),this.actionsIn.SwitchCamera.forEach((e=>e.play())),this.actionsIn.SceneTransition.forEach((e=>e.dispatch())),this.actionsIn.SetVariable.forEach((e=>e.checkConditions())),this.actionsIn.SetVariable.forEach((e=>e.dispatch())),this.actionsIn.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actionsOut.ClearLocalStorage.forEach((e=>e.dispatch())),this.actionsOut.UserAPI.forEach((e=>e.dispatch())))};let{condition:l}=t;if(!l.object)throw new Error("Missing property");let c=null!==(a=n.find(l.object))&&void 0!==a?a:n.scene.find2D(l.object);if(!c)throw new Error("Missing property");if(this.toObject=c,l.state&&(null===(o=this.toObject.states)||void 0===o||!o[l.state]))throw new Error("Missing property");this.toState=l.state}connect(){uY(this.actionsOut).forEach((e=>{var t;(null===(t=this.actionsOut[e])||void 0===t?void 0:t.length)&&this.toObject.addEventListener("beginState",this.onBegin)})),uY(this.actionsIn).forEach((e=>{var t;(null===(t=this.actionsIn[e])||void 0===t?void 0:t.length)&&this.toObject.addEventListener("completeState",this.onComplete)}))}disconnect(){super.disconnect(),uY(this.actionsOut).forEach((e=>{var t;(null===(t=this.actionsIn[e])||void 0===t?void 0:t.length)&&this.toObject.removeEventListener("beginState",this.onBegin)})),uY(this.actionsIn).forEach((e=>{var t;(null===(t=this.actionsIn[e])||void 0===t?void 0:t.length)&&this.toObject.removeEventListener("completeState",this.onComplete)}))}},_de=class extends ude{constructor(e,t){super(e),this.eventManager=t,this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1}connect(){super.connect();let{page:e,sharedAssets:t}=this.eventContext;e.traverseEntity((r=>{var n;if(null!==(n=r.data)&&void 0!==n&&n.events.length)for(let{id:i,data:s}of r.data.events)if(!s.disabled&&"Conditional"===s.type)try{let n;"Comparison"===s.condition.type||("Distance"===s.condition.type?n=new xde(i,s,r,e,t,this.eventManager):"State"===s.condition.type&&(n=new Sde(i,s,r,e,t,this.eventManager))),n&&(this.eventsPerConditions[s.condition.type].push(n),(n.actionsIn.Video.length||n.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch(B0){}})),Object.values(this.eventsPerConditions).forEach((e=>e.forEach((e=>e.connect()))))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach((e=>e.forEach((e=>e.disconnect()))))}},Cde=new PB,Ede=new PB,Ade=new PB,Mde=new LF,Tde=new PB,Pde=new PB,kde=new PB,Dde=new TB,Ide=new mz,Ode=new sz,Rde=new tB,Lde=new PB,Nde=new PB,Bde=.2;function zde(e,t){!t||(t[0]<t[1]&&(e.x=Math.min(Math.max(e.x,t[0]),t[1])),t[2]<t[3]&&(e.y=Math.min(Math.max(e.y,t[2]),t[3])),t[4]<t[5]&&(e.z=Math.min(Math.max(e.z,t[4]),t[5])))}var Fde=function(){let e=new sz;return(t,r,n)=>{let i=t.obj;e.copy(i.hiddenMatrix),null!==i.parent&&e.premultiply(i.parent.matrixWorld),e.invert(),i.position.copy(r),"global"===t.reference&&zde(i.position,t.limits),i.position.applyMatrix4(e),"parent"===t.reference?zde(i.position,t.limits):"local"===t.reference&&(Dde.copy(t.quat0).invert(),i.position.sub(t.position0),i.position.applyQuaternion(Dde),zde(i.position,t.limits),Dde.invert(),i.position.applyQuaternion(Dde),i.position.add(t.position0)),e.multiply(null!==n&&void 0!==n?n:i.matrixWorld).decompose(Tde,i.quaternion,Pde),i.updateMatrix(),i.hasNonUniformScale&&(i.updateMatrixWorld(),i.updateMatrixWorldSVD()),i instanceof z9&&Xne(i.parent)&&i.invalidateDownstreamBooleanData(!0)}}(),jde=class{constructor(e,t,r,n,i,s,a){this.object=e,this.id=t,this.data=r,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=0===this.data.resetSpeed?1:8/this.data.resetSpeed+1,this.snapDampingFactor=0===this.data.snapSpeed?1:8/this.data.snapSpeed+1,this.actionsDrag=uhe(r,r.dragDropActions.drag,n,i,s,this.object),this.actionsDrop=uhe(r,r.dragDropActions.drop,n,i,s,this.object);let o=[];this.data.objects.forEach((e=>{let t=n.find(e);!t||!1!==t.data.visible&&(o.push(t),a[t.uuid]&&a[t.uuid].forEach((e=>{let t=n.find(e);!t||!1!==t.data.visible&&o.push(t)})))})),this.data.dropDestinations.forEach((e=>{let t=n.find(e);!t||!1!==t.data.visible&&(this.dropDestIds.push(t.uuid),a[t.uuid]&&a[t.uuid].forEach((e=>{let t=n.find(e);!t||!1!==t.data.visible&&this.dropDestIds.push(t.uuid)})))})),this.dragItems=o.map((e=>("locked"===this.data.planeMode&&(e.userData.lockedPlane=!0),e.userData.worldPosition0=(new PB).setFromMatrixPosition(e.matrixWorld),{obj:e,fromPosition:(new PB).setFromMatrixPosition(e.matrixWorld),pointStart:new PB,pointEnd:new PB,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:(new PB).copy(e.position),quat0:(new TB).copy(e.quaternion),snapped:!1,orientationMatrix:new sz,limits:this.data.limits,reference:this.data.referenceFrame})))}get activeDragItem(){return null!==this.activeIdx?this.dragItems[this.activeIdx]:null}dispose(){hhe(this.actionsDrag),hhe(this.actionsDrop),this.dragItems.forEach((e=>{e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart),e.obj.recursiveBBoxNeedsUpdate=!0,e.obj.userData.lockedPlane=void 0,e.obj.position.copy(e.position0),e.obj.quaternion.copy(e.quat0),e.obj.updateMatrix()}))}},Ude=class extends ude{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=e=>{if(PZ.length>1)return;this.eventContext.updateRaycaster(e);let{raycaster:t,page:r}=this.eventContext,n=r.raycastWithClones(t);if(this.lastDropDestination=null,0!==n.length){for(let e of this.events){let t=0;for(let{obj:r,pointEnd:s,pointStart:a}of e.dragItems){if(r===n[0].object||r===n[0].object.object||W4.is(r)&&r.isAncestorOf(n[0].object.uuid)){var i;if(e.activeIdx=t,e.activeDragItem.reset=!1,e.activeDragItem.currentDampingFactor=e.data.dampingFactor,e.activeDragItem.snapped=!1,"hand"===e.data.cursor&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){e.activeDragItem.obj.rigidBody&&e.activeDragItem.obj.rigidBody.setBodyType(2,!0);let t=e.activeDragItem.obj;r.hasNonUniformScale&&r.updateMatrixWorldSVD(),(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(Tde,Dde,Pde),Ide.setFromQuaternion(Dde),void 0===t.prevR?(t.prevR=Ide.clone(),t.prevT=Tde.clone()):(t.prevR.copy(Ide),t.prevT.copy(Tde)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(e.activeDragItem.obj)}return this.calcPlaneIntersectPos(r,a,e.data.plane,e.data.referenceFrame),s.copy(a),(this.eventManager.controlsManager.usePhysics&&"dynamic"===(null===(i=r.data.physics)||void 0===i?void 0:i.rigidBody)||!1===e.data.drop||!1===e.data.resetOnSnapFail)&&e.activeDragItem.fromPosition.setFromMatrixPosition(e.activeDragItem.obj.matrixWorld),this.activeEvent=e,void(this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1))}t++}}this.activeEvent=null}else this.activeEvent=null},this.onPointerMove=e=>{if(PZ.length>1)return;this.eventContext.updateRaycaster(e);let{raycaster:t,page:r}=this.eventContext,n=r.raycastWithClones(t);if(0!==PZ.length){if(this.activeEvent&&this.activeEvent.activeDragItem){let e,t=this.activeEvent.activeDragItem;if(t.snapped=!1,this.activeEvent.data.drop&&(e=n.filter((e=>t.obj!==e.object&&!t.obj.isAncestorOf(e.object.uuid)&&!(e.object instanceof eie)&&("all"===this.activeEvent.data.dropOn||this.activeEvent.dropDestIds.some((t=>t===e.object.uuid||r.scene.find(t).isAncestorOf(e.object.uuid))))))[0]),e){let r=kde.copy(e.face.normal).applyMatrix3(Rde.getNormalMatrix(e.object.matrixWorld));if("center"===this.activeEvent.data.snapTo)t.fromPosition.setFromMatrixPosition(e.object.matrixWorld);else if("surface"===this.activeEvent.data.snapTo){if(t.fromPosition.copy(e.point),"bbox"===this.activeEvent.data.snapSurfaceMode){Tde.copy(r).applyMatrix3(Rde.setFromMatrix4(t.obj.matrixWorld).transpose());let e=t.obj;Tde.x>Bde?Pde.x=-e.recursiveBBox.min.x:Tde.x<-Bde&&(Pde.x=-e.recursiveBBox.max.x),Tde.y>Bde?Pde.y=-e.recursiveBBox.min.y:Tde.y<-Bde&&(Pde.y=-e.recursiveBBox.max.y),Tde.z>Bde?Pde.z=-e.recursiveBBox.min.z:Tde.z<-Bde&&(Pde.z=-e.recursiveBBox.max.z),Pde.applyMatrix3(Rde.invert())}else Pde.copy(r).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);t.fromPosition.add(Pde)}this.activeEvent.data.autoOrient&&(Tde.set(0,1,0).cross(r),Tde.length()<1e-4&&Tde.set(-1,0,0).cross(r),Pde.crossVectors(kde,Tde),t.orientationMatrix.makeBasis(Tde,Pde,r)),t.pointStart.copy(t.fromPosition),t.pointEnd.copy(t.pointStart),t.currentDampingFactor=this.activeEvent.snapDampingFactor,t.snapped=!0,this.lastDropDestination!==e.object&&(this.lastDropDestination=e.object,this.activeEvent.actionsDrop.Transition.forEach((e=>{e.play()})),this.activeEvent.actionsDrop.Animation.forEach((e=>{e.play()})),this.activeEvent.actionsDrop.Audio.forEach((e=>{e.dispatchGameControl("start")})),this.activeEvent.actionsDrop.Particles.forEach((e=>{e.dispatchGameControl("start")})),this.activeEvent.actionsDrop.Create.forEach((e=>{e.dispatchThrottled()})))}else t.orientationMatrix.makeRotationFromQuaternion(t.quat0),this.lastDropDestination=null,t.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(t.obj,t.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach((e=>{e.stop(),null!==e.object.currentState&&e.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})})),this.activeEvent.actionsDrop.Animation.forEach((e=>{e.stop()})),this.activeEvent.actionsDrop.Audio.forEach((e=>{e.dispatchGameControl("stop")})),this.activeEvent.actionsDrop.Particles.forEach((e=>{e.dispatchGameControl("stop")}));this.activeEvent.actionsDrag.Create.forEach((e=>{e.dispatchThrottled()})),this.activeEvent.actionsDrag.SetVariable.forEach((e=>e.checkConditions())),this.activeEvent.actionsDrag.SetVariable.forEach((e=>e.dispatch())),this.activeEvent.actionsDrag.DynamicVariablePlay.forEach((e=>e.dispatch())),this.activeEvent.actionsDrag.ClearLocalStorage.forEach((e=>e.dispatch())),this.activeEvent.actionsDrag.UserAPI.forEach((e=>e.dispatch())),!1===this.activeEvent.wasDragEventTriggered&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach((e=>{e.play()})),this.activeEvent.actionsDrag.Animation.forEach((e=>{e.play()})),this.activeEvent.actionsDrag.Audio.forEach((e=>{e.dispatchGameControl("start")})),this.activeEvent.actionsDrag.Particles.forEach((e=>{e.dispatchGameControl("start")}))),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout((()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach((e=>{e.dispatchGameControl("stop")})),this.activeEvent.actionsDrag.Particles.forEach((e=>{e.dispatchGameControl("stop")})),this.activeEvent.actionsDrag.Transition.forEach((e=>{e.stop(),null!==e.object.currentState&&e.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})})),this.activeEvent.actionsDrag.Animation.forEach((e=>{e.stop()})))}),500),this.updateDragItem(t),t.obj.dispatchEvent({type:"requestRender"})}}else{let e=!1;for(let t of this.events){for(let{obj:r}of t.dragItems){var i,s,a;if(r===(null===(i=n[0])||void 0===i?void 0:i.object)||r===(null===(s=n[0])||void 0===s||null===(s=s.object)||void 0===s?void 0:s.object)||W4.is(r)&&r.isAncestorOf(null===(a=n[0])||void 0===a?void 0:a.object.uuid)){switch(e=!0,t.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move")}break}}if(e)break}e||this.setCursor("default")}},this.onPointerUp=e=>{if(this.activeEvent&&this.activeEvent.activeDragItem){var t;"hand"===this.activeEvent.data.cursor&&this.setCursor("grab");let e="dynamic"===(null===(t=this.activeEvent.activeDragItem.obj.data.physics)||void 0===t?void 0:t.rigidBody);!1===this.activeEvent.activeDragItem.snapped&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(!1===this.eventManager.controlsManager.usePhysics||!e)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&e&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),!0===this.activeEvent.wasDragEventTriggered&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach((e=>{e.stop(),null!==e.object.currentState&&e.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})})),this.activeEvent.actionsDrag.Animation.forEach((e=>{e.stop()})),this.activeEvent.actionsDrag.Audio.forEach((e=>{e.dispatchGameControl("stop")})),this.activeEvent.actionsDrag.Particles.forEach((e=>{e.dispatchGameControl("stop")})),this.activeEvent.actionsDrop.SetVariable.forEach((e=>e.checkConditions())),this.activeEvent.actionsDrop.SetVariable.forEach((e=>e.dispatch())),this.activeEvent.actionsDrop.DynamicVariablePlay.forEach((e=>e.dispatch())),this.activeEvent.actionsDrop.ClearLocalStorage.forEach((e=>e.dispatch())),this.activeEvent.actionsDrop.UserAPI.forEach((e=>e.dispatch()))),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}}}connect(){let e={};if(this.eventContext.page.traverseEntity((t=>{t.component&&(e[t.component.uuid]?e[t.component.uuid].push(t.uuid):e[t.component.uuid]=[t.uuid])})),this.eventContext.page.traverseEntity((t=>{var r;null===(r=t.data)||void 0===r||r.events.filter((e=>"DragDrop"===e.data.type&&!e.data.disabled)).forEach((r=>{this.events.push(new jde(t,r.id,r.data,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager,e))}))})),!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let t=this.eventContext.domElement;t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let e=this.eventContext.domElement;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),this.events.forEach((e=>e.dispose()))}setCursor(e){this.eventContext.domElement.style.cursor=e}onAnimationFrameDamping(){for(let e of this.events)for(let t of e.dragItems)t.paused||this.updateDragItem(t,!0)}calcPlaneIntersectPos(e,t,r,n){let{getCamera:i,raycaster:s}=this.eventContext;i().getWorldDirection(Ede),Ede.negate();let a=Dde.identity();switch("parent"===n?Ode.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix).decompose(Tde,a,Pde):"local"===n&&e.matrixWorld.decompose(Tde,a,Pde),r){case"x":Tde.set(1,0,0).applyQuaternion(a),Lde.copy(Ede).cross(Tde),Nde.copy(Tde).cross(Lde);break;case"y":Tde.set(0,1,0).applyQuaternion(a),Lde.copy(Ede).cross(Tde),Nde.copy(Tde).cross(Lde);break;case"z":Tde.set(0,0,1).applyQuaternion(a),Lde.copy(Ede).cross(Tde),Nde.copy(Tde).cross(Lde);break;case"xy":Nde.set(0,0,1).applyQuaternion(a);break;case"yz":Nde.set(1,0,0).applyQuaternion(a);break;case"xz":Nde.set(0,1,0).applyQuaternion(a);break;case"adaptive":Ede.angleTo(Pde.set(0,1,0))>Math.PI/6?(Tde.crossVectors(Pde.set(0,1,0),Ede),Nde.crossVectors(Tde,Pde)):Nde.set(0,1,0);break;default:Nde.copy(Ede)}Ade.setFromMatrixPosition(e.matrixWorld);let o=e.userData.lockedPlane?e.userData.worldPosition0:Ade;if(Mde.setFromNormalAndCoplanarPoint(Nde,o),s.ray.intersectPlane(Mde,t)&&("x"===r||"y"===r||"z"===r)){let e=Pde.subVectors(t,o).dot(Tde);t.copy(o).addScaledVector(Tde,e)}}updateDragItem(e){var t,r;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Ade.setFromMatrixPosition(e.obj.matrixWorld),"current"===e.reset?Cde.subVectors(e.fromPosition,Ade).divideScalar(e.currentDampingFactor):"original"===e.reset?(Cde.subVectors(e.obj.userData.worldPosition0,Ade).divideScalar(e.currentDampingFactor),e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart)):Cde.subVectors(e.pointEnd,e.pointStart).add(e.fromPosition).sub(Ade).divideScalar(e.currentDampingFactor),e.paused=!(e.currentDampingFactor>1)||Cde.length()<.01,(this.activeEvent&&1===this.activeEvent.data.dampingFactor||n)&&Fde(e,Cde.add(Ade),null!==(t=this.activeEvent)&&void 0!==t&&t.data.drop&&null!==(r=this.activeEvent)&&void 0!==r&&r.data.autoOrient?e.orientationMatrix:null),e.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},Vde=new PB,Hde=new PB,Wde=new PB,Gde=new PB,qde=new LF,Xde={type:"requestRender"},Yde=function(){let e=new PB,t=new PB;return(r,n,i)=>i>0?(e.subVectors(r,n),e.length()<=i?r:t.copy(n).add(e.normalize().multiplyScalar(i))):n}(),Kde=function(){let e=new sz;return(t,r)=>{t.position.copy(r),null!==t.parent&&(e.copy(t.parent.matrixWorld).invert(),t.position.applyMatrix4(e)),e.copy(t.hiddenMatrix).invert(),t.position.applyMatrix4(e),t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),t instanceof z9&&Xne(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),Qde=class{constructor(e,t,r,n,i,s){this.data=e,this.id=t,this.object=r,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new PB,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data=u(u(u({},w0.defaultData),e),void 0===e.resetOnPointerLeave&&{resetOnPointerLeave:!1}),void 0===e.target||"cursor"===e.target||(this.target=n.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=uhe(e,e.actions,n,i,s,r)}},Zde=class extends ude{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.pairOfEventListeners=[],this.onMouseMove=e=>{if(!(PZ.length>1)){this.eventContext.updateRaycaster(e);for(let e of this.events)void 0===e.target&&this.updateSingleEvent(e)}},this.onMouseEnter=e=>{for(let t of this.events)void 0===t.target&&(t.isReset=!1,t.currentDampingFactor=t.data.dampingFactor)},this.onMouseLeave=e=>{for(let t of this.events)void 0===t.target&&(t.data.resetOnPointerLeave&&(t.isReset=!0,t.currentDampingFactor=t.resetDampingFactor),this.updateSingleEvent(t))},this.onTargetChange=e=>()=>{this.updateSingleEvent(e)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity((t=>{var r,n;let i=null===(r=t.data)||void 0===r?void 0:r.events.find((e=>"Follow"===e.data.type&&!e.data.disabled));i&&(!e.data.globalPhysics.usePhysics||"dynamic"!==(null===(n=t.dataPatched.physics)||void 0===n?void 0:n.rigidBody))&&this.events.push(new Qde(i.data,i.id,t,e,this.eventContext.sharedAssets,this.eventManager))})),!this.events.length)return;let{domElement:t,eventElement:r}=this.eventContext;this.domEventsNeeded.clear(),_Z&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),r.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let n of this.events)if(void 0!==n.target){let e=n.target,t=this.onTargetChange(n);this.pairOfEventListeners.push([e,t]),e.addEventListener("requestRender",t)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),_Z&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave);for(let[r,n]of this.pairOfEventListeners)r.removeEventListener("requestRender",n);for(let r of this.events)r.paused=!0,r.isReset=!1,hhe(r.actions)}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e,!0)}updateSingleEvent(e){var t;let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.events.forEach((e=>{e.actions.Create.forEach((e=>{e.dispatchThrottled()}))}));let{plane:n,limitDistance:i,limitDistanceEnabled:s}=e.data;if(e.object.getWorldPosition(Wde),e.isReset)Gde.copy(e.worldPosition0);else if(e.target)e.target.getWorldPosition(Gde);else{let{getCamera:e,raycaster:t}=this.eventContext;if("custom"===n?(e().getWorldDirection(Hde),Hde.negate(),Vde.copy(Hde)):"xy"===n?Vde.set(0,0,1):"xz"===n?Vde.set(0,1,0):"yz"===n&&Vde.set(1,0,0),qde.setFromNormalAndCoplanarPoint(Vde,Wde),!t.ray.intersectPlane(qde,Gde))return}if(!e.isReset)if(Gde.distanceTo(e.worldPosition0)>i&&s&&e.target){if(e.snapComplete=!1,e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&null!==e.timeoutId&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,!e.data.resetAfterDistanceLimit)return;Gde.copy(e.worldPosition0),e.currentDampingFactor=e.resetDampingFactor}else if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout((()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)}),1e3*e.data.snapDelay)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),!1===e.delayFinished)return;!1===e.data.enabledTranslation[0]&&(Gde.x=Wde.x),!1===e.data.enabledTranslation[1]&&(Gde.y=Wde.y),!1===e.data.enabledTranslation[2]&&(Gde.z=Wde.z);let a=Yde(Wde,Gde,e.wasOutside?0:e.data.maxDelta);if(e.currentDampingFactor>1){let t=Vde.subVectors(a,Wde).divideScalar(e.currentDampingFactor);Wde.add(t),r&&Kde(e.object,Wde),e.paused=t.length()<.01}else Kde(e.object,a),e.paused=!0;null!==(t=e.object)&&void 0!==t&&t.dispatchEvent({type:"beginEvent",eventName:"Follow"}),e.object.dispatchEvent(Xde)}},Jde=new PB,$de=new PB,efe=new sz,tfe=new TB,rfe=new TB,nfe=new PB,ife=new PB,sfe=new PB,afe=new PB,ofe=new LF,lfe={type:"requestRender"},cfe={type:"changeRotation"},ufe=function(){let e=new sz;return function(t,r){null!==t.parent?e.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix):e.copy(t.hiddenMatrix),r.premultiply($he(e).invert()),t.rotation.setFromRotationMatrix(r),t.updateMatrix(),t instanceof z9&&Xne(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),hfe=class{constructor(e,t,r,n){this.id=t,this.object=r,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new TB,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data=u(u(u({},x0.defaultData),e),void 0===e.resetOnPointerLeave&&{resetOnPointerLeave:!1}),void 0===e.target||"cursor"===e.target||(this.target=n.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},dfe=class extends ude{constructor(){super(...arguments),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=e=>{if(!(PZ.length>1)){this._lastMouseEvent=e,this.eventContext.updateRaycaster(e);for(let e of this.events)void 0===e.target&&this.updateSingleEvent(e)}},this.onMouseEnter=e=>{for(let t of this.events)void 0===t.target&&(t.isReset=!1,t.currentDampingFactor=t.data.dampingFactor)},this.onMouseLeave=e=>{for(let t of this.events)void 0===t.target&&(t.data.resetOnPointerLeave&&(t.isReset=!0,t.currentDampingFactor=t.resetDampingFactor),this.updateSingleEvent(t))},this.onScroll=e=>{if(this._lastMouseEvent){let e=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(e)}},this.onTargetChange=e=>()=>{this.updateSingleEvent(e)},this.createUserEventListener=e=>t=>{let{eventName:r,target:n}=t;if(!r||!n)return;let i=fde(r);i&&"LookAt"===i&&this.updateSingleEvent(e)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity((t=>{var r,n;let i=null===(r=t.data)||void 0===r?void 0:r.events.find((e=>"LookAt"===e.data.type&&!e.data.disabled));i&&(!e.data.globalPhysics.usePhysics||"dynamic"!==(null===(n=t.dataPatched.physics)||void 0===n?void 0:n.rigidBody))&&this.events.push(new hfe(i.data,i.id,t,e))})),!this.events.length)return;let{domElement:t,eventElement:r}=this.eventContext;this.domEventsNeeded.clear(),_Z&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),r.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?r.addEventListener("scroll",this.onScroll):(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let n of this.events){if(void 0!==n.target){let e=this.onTargetChange(n),t=n.target;this.pairOfEventListeners.push([t,e]),t.addEventListener("requestRender",e)}let e=this.createUserEventListener(n),t=n.object;this.pairOfUserEventListeners.push([t,e]),t.addEventListener("userEvent",e)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),_Z&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave),t.removeEventListener("scroll",this.onScroll);for(let[r,n]of this.pairOfEventListeners)r.removeEventListener("requestRender",n);for(let[r,n]of this.pairOfUserEventListeners)r.removeEventListener("userEvent",n);for(let r of this.events)r.paused=!0,r.isReset=!1}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e)}updateSingleEvent(e){var t;let{tilt:r,axis:n,distance:i,plane:s,limitDistance:a,enabledRotation:o,limitDistanceEnabled:l}=e.data,{getCamera:c,raycaster:u}=this.eventContext,{object:h,target:d}=e;if(h.getWorldPosition(nfe),!e.isReset)if(e.target)e.target.getWorldPosition(ife);else{if("custom"===s?(c().getWorldDirection($de),$de.negate(),ofe.setFromNormalAndCoplanarPoint($de,nfe)):("xy"===s?Jde.set(0,0,1):"xz"===s?Jde.set(0,1,0):"yz"===s&&Jde.set(1,0,0),ofe.setFromNormalAndCoplanarPoint(Jde,nfe)),!u.ray.intersectPlane(ofe,ife))return;i>0&&("custom"===s||void 0===s)&&ife.addScaledVector($de,i)}if(e.isReset||(d?"target"===r?sfe.copy(d.up).applyMatrix4(efe.extractRotation(d.matrixWorld)).normalize():o.some((e=>!1===e))?("x"===n?(afe.set(0,0,1),!1===o[2]&&afe.set(0,1,0)):"y"===n?(afe.set(1,0,0),!1===o[0]&&afe.set(0,0,1)):(afe.set(0,1,0),!1===o[1]&&afe.set(1,0,0)),sfe.copy(afe).applyQuaternion(e.worldQuaternion0).normalize()):sfe.set(0,1,0):"custom"===s?sfe.set(0,1,0):sfe.copy(Jde)),e.isReset)rfe.copy(e.worldQuaternion0);else if(nfe.distanceTo(ife)>a&&l&&d){if(e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&null!==e.timeoutId&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,!e.data.resetAfterDistanceLimit)return;rfe.copy(e.worldQuaternion0),e.currentDampingFactor=e.resetDampingFactor}else{if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout((()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)}),1e3*e.data.snapDelay)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),!1===e.delayFinished)return;(function(e,t,r,n,i,s){let a=e.elements;mfe.subVectors(t,r),0===mfe.lengthSq()&&(mfe.z=1),mfe.normalize(),pfe.crossVectors(n,mfe),0===pfe.lengthSq()&&(1===Math.abs(n.z)?mfe.x+=1e-4:mfe.z+=1e-4,mfe.normalize(),pfe.crossVectors(n,mfe)),pfe.normalize(),ffe.crossVectors(mfe,pfe),"x"===i?1===s.z?[pfe,ffe,mfe]=[mfe,pfe,ffe]:(pfe.negate(),[pfe,mfe]=[mfe,pfe]):"y"===i?1===s.x?[pfe,ffe,mfe]=[ffe,mfe,pfe]:(pfe.negate(),[ffe,mfe]=[mfe,ffe]):1===s.x&&(pfe.negate(),[pfe,ffe]=[ffe,pfe]),a[0]=pfe.x,a[4]=ffe.x,a[8]=mfe.x,a[1]=pfe.y,a[5]=ffe.y,a[9]=mfe.y,a[2]=pfe.z,a[6]=ffe.z,a[10]=mfe.z})(efe,ife,nfe,sfe,n,afe),rfe.setFromRotationMatrix(efe),tfe.setFromUnitVectors(afe.applyQuaternion(rfe),sfe),o.some((e=>!1===e))&&"target"!==r&&rfe.premultiply(tfe).normalize()}e.currentDampingFactor>1?(h.updateWorldMatrix(!0,!1),tfe.setFromRotationMatrix($he(h.matrixWorld)),tfe.slerp(rfe,1/e.currentDampingFactor),ufe(h,efe.makeRotationFromQuaternion(tfe)),e.paused=8*(1-tfe.dot(rfe))<1e-6):(ufe(h,efe.makeRotationFromQuaternion(rfe)),e.paused=!0),null!==(t=e.object)&&void 0!==t&&t.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),h.dispatchEvent(lfe),h.dispatchEvent(cfe)}},ffe=new PB,pfe=new PB,mfe=new PB;var gfe=class{constructor(e,t,r,n,i,s){this.id=e,this.data=t,this.object=r,this.entered=!1,this.actions=uhe(t,t.actions,n,i,s,r)}disconnect(){hhe(this.actions)}dispatchEnter(){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),this.entered||(this.entered=!0,this.actions.Transition.forEach((e=>e.playFromCurrent())),this.actions.Animation.forEach((e=>e.play())),this.actions.Create.forEach((e=>e.dispatchStart())),this.actions.Particles.forEach((e=>e.dispatchBasic())),this.actions.Destroy.forEach((e=>e.dispatch())),this.actions.SwitchCamera.forEach((e=>e.playFromCurrent())),this.actions.SceneTransition.forEach((e=>e.dispatch())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch())))}dispatchLeave(){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),this.entered&&(this.entered=!1,this.actions.Create.forEach((e=>e.dispatchStop())),this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Particles.forEach((e=>e.reverseFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.reverseFromCurrent())))}dispatchUserEvent(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),e?(this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Particles.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.reverseFromCurrent()))):(this.actions.Transition.forEach((e=>e.playFromCurrent())),this.actions.Animation.forEach((e=>e.playFromCurrent())),this.actions.Create.forEach((e=>e.dispatch())),this.actions.Particles.forEach((e=>e.dispatchBasic())),this.actions.Destroy.forEach((e=>e.dispatch())),this.actions.SwitchCamera.forEach((e=>e.playFromCurrent()))),this.actions.SceneTransition.forEach((e=>e.dispatch())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}},vfe=class extends ude{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObjects={},this.objects=[],this.objects2D=[],this._prevObjects=[],this.onMouseDown=e=>{PZ.length>1||(this.eventContext.updateRaycaster(e),this.handleMouseHoverEvent())},this.onMouseUp=e=>{PZ.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=e=>{PZ.length>1||(this.eventContext.updateRaycaster(e),this.handleMouseHoverEvent())},this.onUserEvent=e=>{var t;let{eventName:r,target:n,reverse:i}=e;if(!r||!n)return;let s=fde(r);s&&"MouseHover"===s&&(n.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),null===(t=this.eventsPerObjects[n.uuid])||void 0===t||t.forEach((e=>e.dispatchUserEvent(i))))}}connect(){let{page:e,sharedAssets:t}=this.eventContext,r=(r,n)=>{var i;if(r.visible&&null!==(i=r.data)&&void 0!==i&&i.events.length){var s;for(let{id:n,data:i}of r.data.events)if(!i.disabled&&"MouseHover"===i.type)try{let s=new gfe(n,i,r,e,t,this.eventManager);this.eventsPerObjects[r.uuid]?this.eventsPerObjects[r.uuid].push(s):this.eventsPerObjects[r.uuid]=[s]}catch(a){}(null===(s=this.eventsPerObjects[r.uuid])||void 0===s?void 0:s.length)&&this.objects.push(r instanceof mae?n:r)}};if(e.traverseEntity((e=>{var t;(e instanceof woe||e instanceof uoe)&&null!==(t=e.frame)&&void 0!==t&&t.traverse((t=>{r(t,e)})),r(e)})),!this.objects.length)return;let{domElement:n}=this.eventContext;this.domEventsNeeded.clear(),_Z&&(this.domEventsNeeded.add("pointerdown"),n.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),n.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),n.addEventListener("pointermove",this.onMouseMove),this.objects.forEach((e=>{e.addEventListener("userEvent",this.onUserEvent)}))}disconnect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),_Z&&(e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerup",this.onMouseUp)),e.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach((e=>{e.forEach((e=>{e.disconnect()}))})),this.objects.forEach((e=>{e.removeEventListener("userEvent",this.onUserEvent)}))}handleMouseHoverEvent(){let e=[];if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])){let{stopRaycast:t,raycaster:r,page:n,pointerScreen:i}=this.eventContext,s=!1;if(n.uiCanvas&&(s=ade(n,[i.x,i.y],Object.keys(this.eventsPerObjects),(t=>{e.push(t)}))),t&&!s){let t=ide(r,n,this.objects);e=sde(t),t.forEach((t=>{var r,n,i,s;t.object instanceof woe&&ade(t.object,[null!==(r=null===t||void 0===t||null===(n=t.uv)||void 0===n?void 0:n.x)&&void 0!==r?r:0,null!==(i=null===t||void 0===t||null===(s=t.uv)||void 0===s?void 0:s.y)&&void 0!==i?i:0],Object.keys(this.eventsPerObjects),(t=>{e.push(t)}))}))}else this.objects.forEach((t=>{var n,i,s,a;let o=ode(r,t);o&&(e.push(t),t instanceof woe&&ade(t,[null!==(n=null===o||void 0===o||null===(i=o.uv)||void 0===i?void 0:i.x)&&void 0!==n?n:0,null!==(s=null===o||void 0===o||null===(a=o.uv)||void 0===a?void 0:a.y)&&void 0!==s?s:0],Object.keys(this.eventsPerObjects),(t=>{e.push(t)})))}))}this._prevObjects.length&&this._prevObjects.forEach((t=>{var r;e.includes(t)||(t.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),null===(r=this.eventsPerObjects[t.uuid])||void 0===r||r.forEach((e=>e.dispatchLeave())))})),e.length&&e.forEach((e=>{var t;e.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),null===(t=this.eventsPerObjects[e.uuid])||void 0===t||t.forEach((e=>e.dispatchEnter()))})),this._prevObjects=e}},yfe=class{constructor(e,t,r,n,i,s){this.id=e,this.data=t,this.object=r,this.scrollCounter=0,this.actions=uhe(t,t.actions,n,i,s,r)}connect(){this.scrollCounter=0}disconnect(){hhe(this.actions)}dispatch(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}));let t=e>0?1:-1;this.scrollCounter+=t,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let r=this.scrollCounter/this.data.steps;this.actions.Transition.forEach((e=>e.seek(r))),this.actions.Animation.forEach((e=>e.seek(t))),this.actions.Create.forEach((e=>e.dispatchThrottled())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}dispatchUserEvent(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),e?(this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent()))):(this.actions.Transition.forEach((e=>{e.playFromCurrent()})),this.actions.Animation.forEach((e=>{e.playFromCurrent()}))),this.actions.Create.forEach((e=>e.dispatchThrottled())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}},bfe=class{constructor(e,t,r,n,i,s,a){this.id=e,this.data=t,this.object=r,this.domElement=s,this.eventManager=a,this.scrollStart=0,this.scrollEnd=0,this.actions=uhe(t,t.actions,n,i,a,r)}getStickyParentElement(){let e=this.domElement;for(;e;){if("sticky"===window.getComputedStyle(e).position)return e;e=e.parentElement}return null}computeScrollBounds(){var e,t;let r=this.getStickyParentElement(),n=null===r||void 0===r?void 0:r.parentElement,i=this.domElement.getBoundingClientRect(),s={top:i.top,bottom:i.bottom,left:i.left,right:i.right,width:i.width,height:i.height};if(n){let e=n.getBoundingClientRect(),t=window.getComputedStyle(r),l=parseFloat(t.marginTop)+parseFloat(t.marginBottom),c=parseFloat(t.top),u=parseFloat(t.bottom),h=e.height-l;if(isNaN(c)){if(!isNaN(u)){var a,o;let t=null!==(a=document.body.clientHeight)&&void 0!==a?a:window.innerHeight,r=window.innerWidth-(null!==(o=document.documentElement.clientWidth)&&void 0!==o?o:window.innerWidth);i.bottom===t-u?(s.top+=e.top-i.height+u+r,s.bottom+=e.top-i.height+u+r):i.bottom<t-u&&(s.top-=h-i.height,s.bottom-=h-i.height)}}else i.top===c?(s.top+=e.top-c,s.bottom+=e.top-c):i.top<0&&(s.top-=h-i.height,s.bottom-=h-i.height)}let l=document.body,c=document.documentElement,u=window.pageYOffset||c.scrollTop||l.scrollTop,h=c.clientTop||l.clientTop||0,d=Math.round(s.top+u-h);if("enter"===this.data.startFrom){let e=window.innerHeight,t=s.height,r=this.data.enterAnchor,n="top"===r?e:"bottom"===r?e-t:e-.5*t;this.scrollStart=d-n}else this.scrollStart=0;this.scrollStart+=null!==(e=this.data.startOffset)&&void 0!==e?e:0,this.scrollEnd=this.scrollStart+(null!==(t=this.data.endAfter)&&void 0!==t?t:400),this.box=s,this.computeScroll({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){hhe(this.actions)}handleResize(){this.computeScrollBounds()}get isInvalidBox(){return void 0===this.box||0===this.box.width&&0===this.box.height&&0===this.box.top&&0===this.box.bottom}computeScroll(e){let{x:t,y:r}=e;this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}));let n=this.scrollEnd-this.scrollStart,i=Math.min(1,Math.max(0,(r-this.scrollStart)/n));this.actions.Transition.forEach((e=>e.seek(i))),this.actions.Animation.forEach((e=>e.seek(i))),this.actions.Create.forEach((e=>e.dispatchThrottled())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}dispatch(e){this.isInvalidBox&&this.computeScrollBounds(),this.computeScroll(e)}dispatchUserEvent(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),e?(this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent()))):(this.actions.Transition.forEach((e=>{e.playFromCurrent()})),this.actions.Animation.forEach((e=>{e.playFromCurrent()}))),this.actions.Create.forEach((e=>e.dispatchThrottled())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}},wfe=class extends ude{constructor(e,t){super(e),this.managers=t,this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach((e=>{let[t,r]=e;r.forEach((e=>e.handleResize()))}))},this.onScroll=e=>{if(!this.isInview)return;let t={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach((e=>{let[r,n]=e;r.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:t}),n.forEach((e=>e.dispatch(t)))}))},this.onWheel=e=>{!this.isInview||e.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach((t=>{let[r,n]=t;r.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:e.deltaY}),n.forEach((t=>t.dispatch(e.deltaY)))}))},this.onUserEvent=e=>{var t;let{eventName:r,target:n,reverse:i}=e;if(!r||!n)return;let s=fde(r);s&&"Scroll"===s&&(n.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),null===(t=this.wheelEventsPerObject.get(n))||void 0===t||t.forEach((e=>{e.dispatchUserEvent(i)})))}}connect(){let{page:e,sharedAssets:t,domElement:r,isExport:n}=this.eventContext,i=i=>{var s;if(null!==(s=i.data)&&void 0!==s&&s.events.length)for(let{id:l,data:c}of i.data.events)if(!c.disabled&&"Scroll"===c.type)if("load"!==c.trigger&&n){var a;let n=new bfe(l,c,i,e,t,r,this.managers);this.scrollEventsPerObject.has(i)?null===(a=this.scrollEventsPerObject.get(i))||void 0===a||a.push(n):this.scrollEventsPerObject.set(i,[n])}else{var o;let r=new yfe(l,c,i,e,t,this.managers);this.wheelEventsPerObject.has(i)?null===(o=this.wheelEventsPerObject.get(i))||void 0===o||o.push(r):this.wheelEventsPerObject.set(i,[r])}};e.traverseEntity((e=>{var t;(e instanceof woe||e instanceof uoe)&&null!==(t=e.frame)&&void 0!==t&&t.traverse((e=>{i(e)})),i(e)})),this.intersectionObserver=new IntersectionObserver((e=>{let t=e[0];t&&(this.isInview=t.isIntersecting)}),{root:null}),this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach((e=>{let[t,r]=e;r.forEach((e=>e.connect())),t.addEventListener("userEvent",this.onUserEvent)})),[...this.scrollEventsPerObject.entries()].forEach((e=>{let[t,r]=e;r.forEach((e=>e.connect())),t.addEventListener("userEvent",this.onUserEvent)})),[...this.wheelEventsPerObject.values()].some((e=>e.length))&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some((e=>e.length))&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach((e=>{let[t,r]=e;r.forEach((e=>e.disconnect())),t.removeEventListener("userEvent",this.onUserEvent)})),[...this.scrollEventsPerObject.entries()].forEach((e=>{let[t,r]=e;r.forEach((e=>e.disconnect())),t.removeEventListener("userEvent",this.onUserEvent)}))}},xfe=class{constructor(e,t,r,n,i,s){this.id=e,this.data=t,this.object=r,this.actions=uhe(t,t.actions,n,i,s,r)}disconnect(){hhe(this.actions)}dispatch(){this.actions.Transition.forEach((e=>{e.play()})),this.actions.Animation.forEach((e=>{e.play()})),this.actions.SwitchCamera.forEach((e=>{e.play()})),this.actions.SceneTransition.forEach((e=>{e.dispatch()})),this.actions.Reset.forEach((e=>e.dispatch())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch())),this.actions.Create.forEach((e=>{e.dispatchFromStart()})),this.actions.Destroy.forEach((e=>{e.dispatchFromStart()}))}dispatchAfter(e){this.actions.Audio.forEach((t=>{var r;(null!==(r=t.interaction.data.triggerAfter)&&void 0!==r?r:"any")===e&&(t.interaction instanceof tce?t.interaction.audioPlayer.play():t.interaction instanceof rce&&t.interaction.dispatch())})),this.actions.Video.forEach((t=>{var r;let n=null!==(r=t.interaction.data.triggerAfter)&&void 0!==r?r:"autoplay";n===e&&(t.interaction instanceof phe?t.interaction.play("autoplay"===n):t.interaction instanceof mhe&&t.interaction.dispatch())})),this.actions.Particles.forEach((t=>{var r;(null!==(r=t.data.triggerAfter)&&void 0!==r?r:"any")===e&&t.dispatchBasic()}))}dispatchUserEvent(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),e?(this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.reverseFromCurrent()))):(this.actions.Transition.forEach((e=>e.playFromCurrent())),this.actions.Animation.forEach((e=>e.playFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.playFromCurrent()))),this.actions.SceneTransition.forEach((e=>e.dispatch())),this.actions.Reset.forEach((e=>e.dispatch())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch())),this.actions.Create.forEach((e=>{e.dispatch()})),this.actions.Destroy.forEach((e=>{e.dispatch()})),this.actions.Audio.forEach((e=>{e.interaction instanceof tce?e.interaction.audioPlayer.play():e.interaction instanceof rce&&e.interaction.dispatch()})),this.actions.Video.forEach((e=>{e.interaction instanceof phe?e.interaction.play():e.interaction instanceof mhe&&e.interaction.dispatch()})),this.actions.Particles.forEach((e=>{e.dispatchBasic()}))}},Sfe=class extends ude{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,r]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach((e=>{e.dispatchAfter("mouseDown")}))}))},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,r]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach((e=>{e.dispatchAfter("keyDown")}))}))},this.onAny=()=>{let{domElement:e,isExport:t}=this.eventContext,r=t?document:e;r.removeEventListener("pointerdown",this.onAny),r.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,r]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach((e=>{e.dispatchAfter("any")}))}))},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,r]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach((e=>{e.actions.Audio.forEach((e=>{e.interaction instanceof tce&&e.interaction.audioPlayer.play()})),e.actions.Video.forEach((e=>{var t;let r=null!==(t=e.interaction.data.triggerAfter)&&void 0!==t?t:"autoplay";e.interaction instanceof phe&&e.interaction.play("autoplay"===r)})),e.actions.Particles.forEach((e=>{e.dispatchBasic()}))}))}))},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,r]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach((e=>{e.dispatchAfter("autoplay")}))}))},this.onUserEvent=e=>{var t,r;let{eventName:n,target:i,reverse:s}=e;if(!n||!i)return;let a=fde(n);a&&"Start"===a&&(i instanceof mae||i.dispatchEvent({type:"beginEvent",eventName:"Start"}),null!==(t=this.eventsPerObject.get(i))&&void 0!==t&&t.forEach((e=>{e.dispatchUserEvent(s)})),null===(r=this.eventsAfterPerObject.get(i))||void 0===r||r.forEach((e=>{e.dispatchUserEvent(s)})))}}connect(){let{sharedAssets:e,page:t}=this.eventContext,r=r=>{var n;if(null!==(n=r.data)&&void 0!==n&&n.events.length)for(let{id:l,data:c}of r.data.events){var i,s,a,o;if(c.disabled||"Start"!==c.type)continue;let n=new xfe(l,c,r,t,e,this.eventManager);(n.actions.Transition.length||n.actions.Animation.length||n.actions.SwitchCamera.length||n.actions.Create.length||n.actions.Destroy.length||n.actions.SceneTransition.length||n.actions.Reset.length||n.actions.SetVariable.length||n.actions.DynamicVariablePlay.length||n.actions.ClearLocalStorage.length||n.actions.UserAPI.length)&&(this.eventsPerObject.has(r)?null===(i=this.eventsPerObject.get(r))||void 0===i||i.push(n):this.eventsPerObject.set(r,[n])),n.actions.Audio.length&&(this.eventsAfterPerObject.has(r)?null===(s=this.eventsAfterPerObject.get(r))||void 0===s||s.push(n):this.eventsAfterPerObject.set(r,[n])),n.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(r)?null===(a=this.eventsAfterPerObject.get(r))||void 0===a||a.push(n):this.eventsAfterPerObject.set(r,[n])),n.actions.Particles.length&&(this.eventsAfterPerObject.has(r)?null===(o=this.eventsAfterPerObject.get(r))||void 0===o||o.push(n):this.eventsAfterPerObject.set(r,[n]))}};if(t.traverseEntity((e=>{var t;(e instanceof woe||e instanceof uoe)&&null!==(t=e.frame)&&void 0!==t&&t.traverse((e=>{r(e)})),r(e)})),[...this.eventsAfterPerObject.values()].some((e=>e.length))){if(0===this.eventManager.activateCount){let{domElement:e,isExport:t}=this.eventContext,r=t?document:e;r.addEventListener("pointerdown",this.onMouseDown,{once:!0}),r.addEventListener("mousedown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),r.addEventListener("pointerdown",this.onAny),r.addEventListener("mousedown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,r]=e;t.addEventListener("userEvent",this.onUserEvent)}))}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach((e=>{let[t,r]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach((e=>e.dispatch())),t.addEventListener("userEvent",this.onUserEvent)}))}disconnect(){if([...this.eventsAfterPerObject.values()].some((e=>e.length))){let{domElement:e,isExport:t}=this.eventContext,r=t?document:e;r.removeEventListener("pointerdown",this.onMouseDown),r.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),r.removeEventListener("pointerdown",this.onAny),r.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,r]=e;t.removeEventListener("userEvent",this.onUserEvent),r.forEach((e=>e.disconnect()))}))}[...this.eventsPerObject.entries()].forEach((e=>{let[t,r]=e;t.removeEventListener("userEvent",this.onUserEvent),r.forEach((e=>e.disconnect()))})),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},_fe=class{constructor(e,t,r,n,i,s){this.id=e,this.data=t,this.object=r,this.initialDisabled=!1,this.actions=uhe(t,t.actions,n,i,s,r),this.target=t.target}disconnect(){hhe(this.actions)}dispatch(e){this.initialDisabled||(this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.actions.Transition.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.Animation.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.Reset.forEach((e=>{e.dispatch()})),this.actions.Link.forEach((e=>{e.dispatch()})),this.actions.Reset.forEach((e=>{e.dispatch()})),this.actions.Create.forEach((e=>{e.dispatch()})),this.actions.Destroy.forEach((t=>{t.dispatch(null!==e&&void 0!==e&&e)})),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.Audio.forEach((e=>{e.dispatchBasic()})),this.actions.Particles.forEach((e=>{e.dispatchBasic()})),this.actions.Video.forEach((e=>{e.dispatchBasic()})),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch())))}},Cfe=class extends ude{constructor(e,t,r,n,i){super(e),this.sharedVariables=t,this.eventManager=r,this.needsMouse=n,this.needsRaycast=i,this.dynamicVars=[],this.variablesToWatch=[],this.prevMouseProperty=null,this.prevRaycastProperty=null,this.pauseTime=0,this.isOutOfFocus=!1,this.events=[],this.onFrame=e=>{let t=this.eventContext.sharedAssets;if(this.rafId=window.requestAnimationFrame(this.onFrame),this.isOutOfFocus)return;let r=new Date,n=[],i=[];for(let c=0;c<this.propertiesToWatch.length;c++){let{objectId:e,property:t,prevValue:r}=this.propertiesToWatch[c],n=this.eventContext.scene.find(e),s=P0.propertyPaths[t];if("width"===s[0]||"height"===s[0]||"depth"===s[0])n=n.geometry.userData.parameters[s[0]];else for(let i=0;i<s.length;i++)n=n[s[i]];null===r?this.propertiesToWatch[c].prevValue=n instanceof PB?n.clone():n:(n instanceof PB?!n.equals(r):r!==n)&&(i.push({objId:e,property:t}),n instanceof PB?this.propertiesToWatch[c].prevValue.copy(n):this.propertiesToWatch[c].prevValue=n)}for(let c=0;c<this.variablesToWatch.length;c++){let{id:e,prevValue:r}=this.variablesToWatch[c],i=t.getVariable(e);i!==r&&(n.push(e),this.variablesToWatch[c].prevValue=i)}for(let c=0;c<this.dynamicVars.length;c++){let{id:i,expectedTime:o,last:l,data:u,timerSeconds:h,startValue:d}=this.dynamicVars[c],f=1e3;if("timer"!==u.dynamicVariableType&&"stopwatch"!==u.dynamicVariableType||"number3decimal"!==u.format?"counter"===u.dynamicVariableType?f=u.updateInterval:"random"===u.dynamicVariableType&&(f=u.isStatic?1/0:u.updateInterval):f=1,-1!==o){if("Stopped"!==t.getDynamicVariablePlayState(i)&&"Restarted"!==t.getDynamicVariablePlayState(i)||(this.dynamicVars[c].last=e,this.dynamicVars[c].expectedTime=e+f,"counter"===u.dynamicVariableType&&t.getVariable(i)!==d&&(t.updateVariable(i,d),this.eventManager.requestRender()),("timer"===u.dynamicVariableType||"stopwatch"===u.dynamicVariableType)&&this.dynamicVars[c].timerSeconds!==d&&(this.dynamicVars[c].timerSeconds=d,t.updateVariable(i,w2.getFormattedTimerTime(d,u)),this.eventManager.requestRender()),"Restarted"===t.getDynamicVariablePlayState(i)&&t.setDynamicVariablePlayState(i,"Playing"),"Stopped"!==t.getDynamicVariablePlayState(i))){if("Paused"===t.getDynamicVariablePlayState(i)){void 0===this.dynamicVars[c].deltaToExpectedTime&&(this.dynamicVars[c].deltaToExpectedTime=Math.max(this.dynamicVars[c].expectedTime-e,0)),this.dynamicVars[c].last=e-(f-this.dynamicVars[c].deltaToExpectedTime),this.dynamicVars[c].expectedTime=e+this.dynamicVars[c].deltaToExpectedTime;continue}if(this.dynamicVars[c].deltaToExpectedTime=void 0,e>=o)if(this.dynamicVars[c].last=e,this.dynamicVars[c].expectedTime+=f,"random"===u.dynamicVariableType){let e=u.min+Math.random()*(u.max-u.min),r=u.decimals;e=Math.round(e*Math.pow(10,r))/Math.pow(10,r),t.updateVariable(i,e),n.push(i),this.eventManager.requestRender()}else if("counter"===u.dynamicVariableType){var s;let e=t.getVariable(i),r=null===(s=t.getDynamicVariableToggleIsForward(i))||void 0===s||s,a=t.getVariable(i)+u.increment*(r?1:-1);u.hasEnd&&(a=u.increment>0?$N.clamp(a,d,u.endValue):$N.clamp(a,u.endValue,d),a===d&&t.setDynamicVariableToggleIsForward(i,void 0),u.repeat?a===u.endValue&&(a=d):(a===d||a===u.endValue)&&t.setDynamicVariablePlayState(i,"Paused")),a!==e&&(n.push(i),t.updateVariable(i,a),this.eventManager.requestRender())}else if("time"===u.dynamicVariableType){let e=t.getVariable(i),s=nte(r,u);if("object"==typeof e&&"textValue"in e&&"object"==typeof s&&"textValue"in s){if(Array.isArray(e.textValue)&&Array.isArray(s.textValue)){if(e.textValue.every(((e,t)=>e===s.textValue[t])))continue}else if(e.textValue===s.textValue)continue}else if(e===s)continue;t.updateVariable(i,s),n.push(i),this.eventManager.requestRender()}else{var a;let r=m2.isTextValue(u.endValue)?Afe(u.endValue.textValue):u.endValue,s=null===(a=t.getDynamicVariableToggleIsForward(i))||void 0===a||a,o=h+(e-l)/1e3*("timer"===u.dynamicVariableType?-1:1)*(s?1:-1);o=Math.max(o,0),u.hasEnd&&(o="stopwatch"===u.dynamicVariableType?$N.clamp(o,d,r):$N.clamp(o,r,d),o===d&&t.setDynamicVariableToggleIsForward(i,void 0),u.repeat?Math.abs(o-r)<("number3decimal"===u.format?1e-4:.1)&&(o=d):(Math.abs(o-d)<("number3decimal"===u.format?1e-4:.1)||Math.abs(o-r)<("number3decimal"===u.format?1e-4:.1))&&t.setDynamicVariablePlayState(i,"Paused")),o!==h&&(n.push(i),this.dynamicVars[c].timerSeconds=o,t.updateVariable(i,w2.getFormattedTimerTime(o,u)),this.eventManager.requestRender())}}}else this.dynamicVars[c].last=e,this.dynamicVars[c].expectedTime=e+f}let o=!1;t.mouseProperty!==this.prevMouseProperty&&(this.prevMouseProperty=t.mouseProperty,o=!0);let l=!1;t.raycastProperty!==this.prevRaycastProperty&&(this.prevRaycastProperty=t.raycastProperty,l=!0),this.events.forEach((e=>{(n.includes(e.data.variableId)||i.find((t=>t.objId===e.data.objectId&&t.property===e.data.property))||"mouseProperty"===e.data.variableId&&o||"raycastProperty"===e.data.variableId&&l)&&(e.dispatch(),this.eventManager.requestRender())}))},this.onBlur=()=>{this.pause()},this.onFocus=()=>{this.resume()}}pause(){this.isOutOfFocus||(this.isOutOfFocus=!0,this.pauseTime=Date.now())}resume(){if(!this.isOutOfFocus)return;this.isOutOfFocus=!1;let e=Date.now()-this.pauseTime;for(let t=0;t<this.dynamicVars.length;t++)this.dynamicVars[t].last+=e,this.dynamicVars[t].expectedTime+=e}connect(){this.eventContext.page.traverseEntity((e=>{var t;null===(t=e.data)||void 0===t||t.events.filter((e=>"VariableChange"===e.data.type&&!e.data.disabled)).forEach((t=>{this.events.push(new Efe(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))}))})),this.propertiesToWatch=this.events.filter((e=>"objectProperty"===e.data.variableId&&null!==e.data.objectId)).map((e=>({objectId:e.data.objectId,property:e.data.property,prevValue:null})));let e=this.eventContext.sharedAssets;this.sharedVariables.forEach((t=>{let r,{id:n,data:i}=t;if("dynamicVariableType"in i)if("timer"===i.dynamicVariableType||"stopwatch"===i.dynamicVariableType){let e;if(m2.isTextValue(i.value)&&Array.isArray(i.value.textValue)){let t=i.value.textValue;e=3===t.length?t[2]+60*t[1]+3600*t[0]:t[1]+60*t[0]}else e=i.value;r=e,this.dynamicVars.push({id:n,last:-1,expectedTime:-1,data:i,timerSeconds:e,startValue:r})}else"time"===i.dynamicVariableType&&e.updateVariable(n,nte(new Date,i)),"counter"===i.dynamicVariableType&&(r=m2.isTextValue(i.value)?Afe(i.value.textValue):i.value),this.dynamicVars.push({id:n,last:-1,expectedTime:-1,data:i,startValue:r});else this.events.find((e=>e.data.variableId===n))&&this.variablesToWatch.push({id:n,prevValue:e.getVariable(n)})})),this.rafId=window.requestAnimationFrame(this.onFrame),window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus)}disconnect(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=void 0),this.events.forEach((e=>e.dispose()))}},Efe=class{constructor(e,t,r,n,i,s){this.id=e,this.data=t,this.object=r,this.actions=uhe(t,t.actions,n,i,s,r)}dispatch(){let e=this.actions;e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}dispose(){hhe(this.actions)}};function Afe(e){return 3===e.length?e[2]+60*e[1]+3600*e[0]:e[1]+60*e[0]}var Mfe,Tfe,Pfe,kfe="\n(async function() {\n\tconst [wasmImport, wasmBinary] = await Promise.all([\n\t\timport('".concat("https://unpkg.com/@splinetool/runtime@1.9.59/build/","' + 'navmesh.js'),\n\t\tfetch('").concat("https://unpkg.com/@splinetool/navmesh-wasm@1.9.59/build/","' + 'navmesh.wasm').then((res) => res.arrayBuffer()),\n\t]);\n\tconst wasmModule = wasmImport.default;\n\tself.module = await wasmModule({ wasmBinary });\n\tpostMessage('ready');\n})();\n"),Dfe={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1};UZ.then((e=>{Mfe=e,Tfe=new e.Vec3,Pfe=new e.Vec3}));var Ife=new PB,Ofe=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.usePhysics=e,this.isExport=t,this.onPointerDown=e=>{if(1!==PZ.length)return;let{raycaster:t,page:r}=this.eventContext;this.eventContext.updateRaycaster(e);let n=r.raycastWithClones(t);if(0!==n.length){if(this.gameControl){let e=Ife.copy(this.gameControl.colliderWorldPosition);e.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(e,n[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(e,t)=>r=>{var n,i,s,a,o,l;let c;if(r instanceof wne){if(!r.objectForSample)return!0===r.object.dataPatched.physics.fusedBody&&"dynamic"===r.object.dataPatched.physics.rigidBody||void 0;if(r.objectForSample.dataPatched.physics.fusedBody)return;c=r.object}else if(r instanceof X4)c=r.object;else if(c=r,!1===(null===(n=c.dataPatched.cloner)||void 0===n?void 0:n.disabled)&&null!==(i=c.dataPatched.cloner)&&void 0!==i&&i.hideBase&&!0!==(null===(s=c.dataPatched.physics)||void 0===s?void 0:s.fusedBody))return!0;if(t&&!c.userData.navmesh)return;let u=c.dataPatched;if(!u.visible&&!0!==(null===(a=u.physics)||void 0===a?void 0:a.enabled))return!0;r.updateMatrixWorldSVD();let h=ype(u),d=c.userData.hasDestroy,f=c.userData.hasDrag,p=!1,m=!1;for(let e of u.events)!0!==e.data.disabled&&("GameControl"===e.data.type?p=!0:"Follow"===e.data.type&&(m=!0));if(p||h||m||d||f)return!0;var g;if(this.usePhysics&&"dynamic"===(null===(o=u.physics)||void 0===o?void 0:o.rigidBody)){if(this.usePhysics&&null!==(g=u.physics)&&void 0!==g&&g.fusedBody)return!0}else if("geometry"in r&&r.geometry&&e.push(Khe(r.geometry,r.matrixWorld)),this.usePhysics&&null!==(l=u.physics)&&void 0!==l&&l.fusedBody)return r.traverseObject(((t,r)=>{var n,i;if(0===r)return;let s;if(t instanceof wne){if(!t.objectForSample)return!0===t.object.dataPatched.physics.fusedBody&&"dynamic"===t.object.dataPatched.physics.rigidBody||void 0;if(t.objectForSample.dataPatched.physics.fusedBody)return;s=t.object}else if(t instanceof X4)s=t.object;else if(s=t,null!==(n=t.dataPatched.cloner)&&void 0!==n&&n.hideBase)return!0;let a=s.dataPatched;if(!a.visible&&!0!==(null===(i=a.physics)||void 0===i?void 0:i.enabled))return!0;"geometry"in t&&t.geometry&&e.push(Khe(t.geometry,t.matrixWorld))})),!0},this.traverseNoPhysics=(e,t)=>r=>{let n;if(r instanceof wne)return;n=r instanceof X4?r.object:r;let i=n.dataPatched;if("visibility"===i.physics.enabled?!i.visible:!i.physics.enabled)return!0;if(t&&!n.userData.navmesh)return;let s=r.geometry,a=!0===n.userData.hasDestroy,o=!0===n.userData.hasDrag;if(ype(i)||a||o||n.dataPatched.events.some((e=>!0!==e.data.disabled&&"GameControl"===e.data.type)))return!0;s&&e.push(Khe(s,r.matrixWorld))},this.navmeshWasm=Mfe,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(t?kfe:"\n(async function() {\n\tconst [wasmImport, wasmBinary] = await Promise.all([\n\t\timport(self.location.origin + '/_libraries/navmesh.js'),\n\t\tfetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),\n\t]);\n\tconst wasmModule = wasmImport.default;\n\tself.module = await wasmModule({ wasmBinary });\n\tpostMessage('ready');\n})();\n")+"\n\nonmessage = function(messageEvent) {\n\tconst meshData = messageEvent.data;\n\tconst positions = meshData[0];\n\tconst offset = meshData[1];\n\tconst indices = meshData[2];\n\tconst indicesLength = meshData[3];\n\tconst parameters = meshData[4];\n\n\tconst module = self.module;\n\tconst rc = new module.rcConfig();\n\trc.cs = parameters.cs;\n\trc.ch = parameters.ch;\n\trc.borderSize = parameters.borderSize ? parameters.borderSize : 0;\n\trc.tileSize = parameters.tileSize ? parameters.tileSize : 0;\n\trc.walkableSlopeAngle = parameters.walkableSlopeAngle;\n\trc.walkableHeight = parameters.walkableHeight;\n\trc.walkableClimb = parameters.walkableClimb;\n\trc.walkableRadius = parameters.walkableRadius;\n\trc.maxEdgeLen = parameters.maxEdgeLen;\n\trc.maxSimplificationError = parameters.maxSimplificationError;\n\trc.minRegionArea = parameters.minRegionArea;\n\trc.mergeRegionArea = parameters.mergeRegionArea;\n\trc.maxVertsPerPoly = parameters.maxVertsPerPoly;\n\trc.detailSampleDist = parameters.detailSampleDist;\n\trc.detailSampleMaxError = parameters.detailSampleMaxError;\n\n\tif (!self.navMesh) {\n\t\tself.navMesh = new module.NavMesh();\n\t}\n\tself.navMesh.build(positions, offset, indices, indicesLength, rc);\n\n\tconst navmeshData = navMesh.getNavmeshData();\n\tconst arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);\n\tconst ret = new Uint8Array(navmeshData.size);\n\tret.set(arrView);\n\tnavMesh.freeNavmeshData(navmeshData);\n\n\tpostMessage(ret);\n}\n"])),this._worker=new Worker(this._workerURL)}init(e,t,r){this.gameControl=t,this.eventContext=r,this.setDefaultQueryExtent((new PB).setScalar(e.ch*e.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(r.page,e,(e=>{this.buildFromNavmeshData(e.data)}))},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(e,t,r){t.objects.forEach((t=>{var r;let n=e.scene.find(t);n.traverseEntity((e=>{e.userData.navmesh=!0})),null===(r=n.cloner)||void 0===r||r.traverseObject((e=>{e.userData.navmesh=!0}))}));let n=[],i=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(n,"custom"===t.zones);if(e.traverseChildren(i),t.objects.forEach((t=>{var r;let n=e.scene.find(t);n.traverseEntity((e=>{e.userData.navmesh=void 0})),null===(r=n.cloner)||void 0===r||r.traverseObject((e=>{e.userData.navmesh=void 0}))})),0===n.length)return!1;let s=h3(n),{positions:a,triIndices:o}=c9(s.getAttribute("position"),s.getIndex());return this._worker.postMessage([a,a.length/3,o,o.length,u(u({},Dfe),t)]),this._worker.onmessage=r,!0}createDebugNavGeometry(){let e,t,r=this.navMesh.getDebugNavMesh(),n=r.getTriangleCount(),i=new Uint32Array(3*n),s=new Float32Array(3*n*3);for(e=0;e<3*n;e++)i[e]=e;for(e=0;e<n;e++)for(t=0;t<3;t++){let n=r.getTriangle(e).getPoint(t);s[9*e+3*t+0]=n.x,s[9*e+3*t+1]=n.y,s[9*e+3*t+2]=n.z}let a=new iF;return a.setIndex(new Xz(i,1)),a.setAttribute("position",new Xz(s,3)),a}getClosestPoint(e){return Tfe.x=e.x,Tfe.y=e.y,Tfe.z=e.z,this.navMesh.getClosestPoint(Tfe)}getClosestPointToRef(e,t){Tfe.x=e.x,Tfe.y=e.y,Tfe.z=e.z;let r=this.navMesh.getClosestPoint(Tfe);t.set(r.x,r.y,r.z)}getRandomPointAround(e,t){return Tfe.x=e.x,Tfe.y=e.y,Tfe.z=e.z,this.navMesh.getRandomPointAround(Tfe,t)}getRandomPointAroundToRef(e,t,r){Tfe.x=e.x,Tfe.y=e.y,Tfe.z=e.z;let n=this.navMesh.getRandomPointAround(Tfe,t);r.set(n.x,n.y,n.z)}moveAlong(e,t){return Tfe.x=e.x,Tfe.y=e.y,Tfe.z=e.z,Pfe.x=t.x,Pfe.y=t.y,Pfe.z=t.z,this.navMesh.moveAlong(Tfe,Pfe)}moveAlongToRef(e,t,r){return Tfe.x=e.x,Tfe.y=e.y,Tfe.z=e.z,Pfe.x=t.x,Pfe.y=t.y,Pfe.z=t.z,this.navMesh.moveAlong(Tfe,Pfe)}computePath(e,t){let r=this.getClosestPoint(t);if(Pfe.x=r.x,Pfe.y=r.y,Pfe.z=r.z,Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2)+Math.pow(t.z-r.z,2))>this.getDefaultQueryExtent().y)return[];this.getClosestPoint(e);let n=this.navMesh.computePath(Tfe,Pfe),i=n.getPointCount(),s=[];for(let a=0;a<i;a++){let e=n.getPoint(a);s.push(new PB(e.x,e.y,e.z))}return s}createCrowd(e,t){return new Rfe(this,e,t)}setDefaultQueryExtent(e){Tfe.x=e.x,Tfe.y=e.y,Tfe.z=e.z,this.navMesh.setDefaultQueryExtent(Tfe)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(e){let t=e.length*e.BYTES_PER_ELEMENT,r=this.navmeshWasm._malloc(t),n=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,r,t);n.set(e);let i=new this.navmeshWasm.NavmeshData;i.dataPointer=n.byteOffset,i.size=e.length,this.navMesh.buildFromNavmeshData(i),this.navmeshWasm._free(n.byteOffset)}getNavmeshData(){let e=this.navMesh.getNavmeshData(),t=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,e.dataPointer,e.size),r=new Uint8Array(e.size);return r.set(t),this.navMesh.freeNavmeshData(e),r}getDefaultQueryExtentToRef(e){let t=this.navMesh.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}dispose(){var e;this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),null===(e=this.eventContext)||void 0===e||e.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(e,t,r){return Tfe.x=e.x,Tfe.y=e.y,Tfe.z=e.z,this.navMesh.addCylinderObstacle(Tfe,t,r)}addBoxObstacle(e,t,r){return Tfe.x=e.x,Tfe.y=e.y,Tfe.z=e.z,Pfe.x=t.x,Pfe.y=t.y,Pfe.z=t.z,this.navMesh.addBoxObstacle(Tfe,Pfe,r)}removeObstacle(e){this.navMesh.removeObstacle(e)}isSupported(){return void 0!==this.navmeshWasm}},Rfe=class{constructor(e,t,r){this.navmeshWasmWrapper=e,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(t,r,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(e,t){}addAgent(e,t,r){let n=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;n.radius=t.radius,n.height=t.height,n.maxAcceleration=t.maxAcceleration,n.maxSpeed=t.maxSpeed,n.collisionQueryRange=t.collisionQueryRange,n.pathOptimizationRange=t.pathOptimizationRange,n.separationWeight=t.separationWeight,n.updateFlags=7,n.obstacleAvoidanceType=0,n.queryFilterType=0,n.userData=0;let i=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z),n);return this.transforms.push(r),this.agents.push(i),this.reachRadii.push(t.reachRadius?t.reachRadius:t.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new PB(0,0,0)),i}getAgentPosition(e){return this.crowd.getAgentPosition(e)}getAgentPositionToRef(e,t){let r=this.crowd.getAgentPosition(e);t.set(r.x,r.y,r.z)}getAgentVelocity(e){return this.crowd.getAgentVelocity(e)}getAgentVelocityToRef(e,t){let r=this.crowd.getAgentVelocity(e);t.set(r.x,r.y,r.z)}getAgentNextTargetPath(e){return this.crowd.getAgentNextTargetPath(e)}getAgentNextTargetPathToRef(e,t){let r=this.crowd.getAgentNextTargetPath(e);t.set(r.x,r.y,r.z)}getAgentState(e){return this.crowd.getAgentState(e)}overOffmeshConnection(e){return this.crowd.overOffmeshConnection(e)}agentGoto(e,t){this.crowd.agentGoto(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z));let r=this.agents.indexOf(e);r>-1&&(this._agentDestinationArmed[r]=!0,this._agentDestination[r].set(t.x,t.y,t.z))}agentTeleport(e,t){this.crowd.agentTeleport(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z))}updateAgentParameters(e,t){let r=this.crowd.getAgentParameters(e);void 0!==t.radius&&(r.radius=t.radius),void 0!==t.height&&(r.height=t.height),void 0!==t.maxAcceleration&&(r.maxAcceleration=t.maxAcceleration),void 0!==t.maxSpeed&&(r.maxSpeed=t.maxSpeed),void 0!==t.collisionQueryRange&&(r.collisionQueryRange=t.collisionQueryRange),void 0!==t.pathOptimizationRange&&(r.pathOptimizationRange=t.pathOptimizationRange),void 0!==t.separationWeight&&(r.separationWeight=t.separationWeight),this.crowd.setAgentParameters(e,r)}removeAgent(e){this.crowd.removeAgent(e);let t=this.agents.indexOf(e);t>-1&&(this.agents.splice(t,1),this.transforms.splice(t,1),this.reachRadii.splice(t,1),this._agentDestinationArmed.splice(t,1),this._agentDestination.splice(t,1))}getAgents(){return this.agents}update(e){if(this.navmeshWasmWrapper.navMesh.update(),e<=.001)return;let t=1/60;{let r=Math.floor(e/t);r>10&&(r=10),r<1&&(r=1);let n=e/r;for(let e=0;e<r;e++)this.crowd.update(n)}for(let r=0;r<this.agents.length;r++){let e=this.agents[r],t=this.getAgentPosition(e);if(this.transforms[r].copy(t),this._agentDestinationArmed[r]){let n=t.x-this._agentDestination[r].x,i=t.z-this._agentDestination[r].z,s=this.reachRadii[r],a=this._agentDestination[r].y-this.reachRadii[r],o=this._agentDestination[r].y+this.reachRadii[r],l=n*n+i*i;t.y>a&&t.y<o&&l<s*s&&(this.onReachTarget(e,this._agentDestination[r]),this._agentDestinationArmed[r]=!1)}}}setDefaultQueryExtent(e){let t=new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z);this.crowd.setDefaultQueryExtent(t)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(e){let t=this.crowd.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}getCorners(e){let t,r=this.crowd.getCorners(e),n=r.getPointCount(),i=[];for(t=0;t<n;t++){let e=r.getPoint(t);i.push(new PB(e.x,e.y,e.z))}return i}dispose(){this.crowd.destroy()}};function Lfe(e){let t=!1;return e.scene.objects.forEach((r=>{"Page"===r.data.type&&!t&&r.data.publish.gameControlObject&&u2.traverseModuleInstances(e,r.id,((e,r,n)=>{for(let i of n)"GameControl"===i.data.type&&i.data.navmesh.enabled&&(t=!0)}))})),t}var Nfe={type:"change"},Bfe={type:"changeZoom"},zfe={type:"changePan"},Ffe={type:"start"},jfe={type:"end",changed:!0},Ufe={type:"end",changed:!1},Vfe=new TB,Hfe=new eB,Wfe=2*Math.PI,Gfe=new PB,qfe=new eB,Xfe=new PB,Yfe=new TB,Kfe=new sz,Qfe={type:"requestRender"},Zfe=class extends FN{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{isPlayMode:!1,isExport:!1};super(),this.object=e,this.domElement=t,this.options=r,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,DL,PL],this.offset=new PB,this.eye=new PB,this.lastPosition=new PB,this.lastQuaternion=new TB,this.current=new eB,this.overShoot=new eB,this.overRatio=new eB,this.spherical=new cG,this.sphericalDelta=new cG,this.panOffset=new PB,this.panLeftV=new PB,this.panUpV=new PB,this.panV=new PB,this.rotateStart=new eB,this.rotateEnd=new eB,this.rotateDelta=new eB,this.panStart=new eB,this.panEnd=new eB,this.panDelta=new eB,this.dollyStart=new eB,this.dollyEnd=new eB,this.dollyDelta=new eB,this.rotationRangeFactor=new eB,this.panRangeFactor=new eB,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.hoverRotateDamping=this.dampingFactor,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=e=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=e.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(Xfe,Yfe,Gfe),this.offset.copy(Xfe).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&-1===this.state&&this.rotateLeft((!0===this.autoRotateClockwise?1:-1)*this.getAutoRotationAngle()),0!==this.rotationLimitsMode&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),2!==this.rotationLimitsMode&&(this.spherical.phi+=this.sphericalDelta.phi),(1!==this.rotationLimitsMode||!0===this.autoRotate)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&this.object.isPerspectiveCamera&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),0!==this.panLimitsMode&&(this.target.applyQuaternion(Vfe.copy(Yfe).invert()),this.panOffset.applyQuaternion(Vfe),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(Yfe),this.panOffset.applyQuaternion(Yfe)),2===this.panLimitsMode&&(this.panOffset.y=0),1===this.panLimitsMode&&(this.panOffset.x=0),-1!==this.state||this.gesture?(this.target.add(this.panOffset),this.panOffset.set(0,0,0)):(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)),this.offset.setFromSpherical(this.spherical),Xfe.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(Kfe.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(Kfe));let e=this.spherical.phi%Wfe;if(this.eye.copy(this.offset).normalize(),this.object.up.copy(kz.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),e>0&&e>Math.PI||e<0&&e>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),-1===this.state||!0===this.enableDamping){let e=1===this.hoverRotatePanMode?this.hoverRotateDamping:this.dampingFactor;this.sphericalDelta.theta*=1-e,this.sphericalDelta.phi*=1-e}else this.sphericalDelta.set(0,0,0);return this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>.01||8*(1-this.lastQuaternion.dot(this.object.quaternion))>1e-8?(this.dispatchEvent(Nfe),this.object.dispatchEvent(Qfe),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=e=>{!1!==this.enabled&&("touch"===e.pointerType||"pen"===e.pointerType&&_Z?this.onPointerDownTouch(e):this.onPointerDownMouse(e),-1!==this.state&&(this.isPointerDown=!0,this.dispatchEvent(Ffe),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),e.stopPropagation(),"touch"===e.pointerType||"pen"===e.pointerType&&_Z||this.domElement.setPointerCapture(e.pointerId)))},this.onPointerLeave=e=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(1===this.hoverRotatePanMode?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,Gfe.subVectors(this.position0,this.target0),this.spherical.setFromVector3(Gfe),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):2===this.hoverRotatePanMode&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=e},this.onPointerEnter=e=>{this.resetHoverEffectOnPointerLeave||void 0===this.pointerLeaveEvent?qfe.set(e.clientX-this.domElement.clientWidth/2,e.clientY-this.domElement.clientHeight/2):qfe.set(e.clientX-this.pointerLeaveEvent.clientX,e.clientY-this.pointerLeaveEvent.clientY),1===this.hoverRotatePanMode?(this.rotateDelta.copy(qfe).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(Hfe,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(e.clientX,e.clientY)):2===this.hoverRotatePanMode&&(this.panDelta.copy(qfe).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(e.clientX,e.clientY)),this.update()},this.onPointerMove=e=>{!1!==this.enabled&&(this.checkRaycastLock()||("touch"===e.pointerType||"pen"===e.pointerType&&_Z?this.onPointerMoveTouch(e):this.onPointerMoveMouse(e),e.stopPropagation()))},this.onPointerUp=e=>{this.isPointerDown=!1,0===PZ.length&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),PZ.length>1&&e.preventDefault(),this.hasChange?this.dispatchEvent(jfe):this.dispatchEvent(Ufe),this.state=-1,e&&(e.stopPropagation(),"touch"===e.pointerType||"pen"===e.pointerType&&_Z||this.domElement.releasePointerCapture(e.pointerId))},this.onPointerDownMouse=e=>{let t;switch(t=this.useKeyEvents?this.mouseButtons[e.button]:this.mouseButtonsPlay[e.button],t){case 0:if(!0!==e.altKey||e.shiftKey||TZ(e)){if(" "===this.key){if(!1===this.enablePan)return;this.handleMouseDownPan(e),this.state=2}}else{if(!1===this.enableRotate)return;this.handleMouseDownRotate(e),this.state=0}break;case 4:if(!1===this.enablePan)return;this.handleMouseDownPan(e),this.state=2;break;case 3:if(TZ(e)||e.shiftKey){if(!1===this.enablePan)return;this.handleMouseDownPan(e),this.state=2}else{if(!1===this.enableRotate)return;this.handleMouseDownRotate(e),this.state=0}break;case 5:if(TZ(e)||e.shiftKey){if(!1===this.enableRotate)return;this.handleMouseDownRotate(e),this.state=0}else{if(!1===this.enablePan)return;this.handleMouseDownPan(e),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=e=>{switch(this.state){case 0:if(!1===this.enableRotate)return;this.handleMouseMoveRotate(e);break;case 1:if(!1===this.enableZoom)return;this.handleMouseMoveDolly(e);break;case 2:if(!1===this.enablePan)return;this.handleMouseMovePan(e)}this.object.wasMovedByUser=!0},this.onPointerDownTouch=e=>{switch(PZ.length>1&&e.preventDefault(),this.touches[PZ.length-1]){case TL:if(!1===this.enableRotate)return void(this.state=-1);this.handleTouchStartRotate(),this.state=3;break;case PL:if(!1===this.enablePan)return void(this.state=-1);this.handleTouchStartPan(),this.state=4;break;case kL:if(!1===this.enableZoom&&!1===this.enablePan)return;this.handleTouchStartDollyPan(),this.state=5;break;case DL:if(!1===this.enableZoom&&!1===this.enableRotate)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=e=>{switch(PZ.length>1&&e.preventDefault(),this.state){case 3:if(!1===this.enableRotate)return;this.handleTouchMoveRotate(e),this.update();break;case 4:if(!1===this.enablePan)return;this.handleTouchMovePan(e),this.update();break;case 5:if(!1===this.enableZoom&&!1===this.enablePan)return;this.handleTouchMoveDollyPan(e),this.update();break;case 6:if(!1===this.enableZoom&&!1===this.enableRotate)return;this.handleTouchMoveDollyRotate(e),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=eZ((()=>this.dispatchEvent(jfe)),33),this.onMouseWheel=e=>{!1===this.enabled||!1===this.enableZoom&&!1===this.enablePan||this.checkRaycastLock()||(!this.options.isExport&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&e.preventDefault(),this.dispatchEvent(Ffe),this.handleMouseWheel(e),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=e=>{if(e.preventDefault(),!1!==this.enabled&&!this.checkRaycastLock()&&!xZ)if("gesturechange"===e.type){if(!1===this.enableZoom||!1===this.isTouchZoom)return;this.dispatchEvent(Ffe),e.scale>this.prevScale?this.dollyIn(this.getZoomScale()):e.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=e.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(jfe)},this.onContextMenu=e=>{e.preventDefault()},this.onTouchEnd=e=>{e.preventDefault()},this.onKeyDown=e=>{!1!==this.enabled&&(this.key=e.key," "===e.key&&this.dispatchEvent(Ffe))},this.onKeyUp=e=>{!1!==this.enabled&&(this.key=void 0,-1!==this.state&&"Alt"===e.key&&this.onPointerUp(PZ[0])," "===e.key&&this.dispatchEvent(jfe))},this.onPointerHover=e=>{"mouse"!==e.pointerType||!1===this.enabled||-1!==this.state||2===this.hoverRotatePanMode&&this.isPanOverShoot||1===this.hoverRotatePanMode&&this.isRotateOverShoot||(this.isPointerDown=!0,2===this.hoverRotatePanMode?this.handleMouseMovePan(e,this.hoverRotatePanStrength):1===this.hoverRotatePanMode&&this.handleMouseMoveRotate(e,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=e=>{e.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.initialSphericalRadius=this.spherical.radius,this.addEventListenersToCamera()}dispatchEvent(e){"start"===e.type?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(e)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(e){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=e,0!==this.hoverRotatePanMode&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),0!==this.hoverRotatePanMode&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(e,t){var r,n;this.setEnableDampingSpeed(e.enableDamping),this.enablePan=e.enablePan,this.enableZoom=e.enableZoom,this.enableRotate=e.enableRotate,this.rotationLimitsMode=e.rotationLimitsMode,this.thetaIsFree=e.rotationHorizontalOffset.min===e.rotationHorizontalOffset.max&&e.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=e.rotationVerticalOffset.min===e.rotationVerticalOffset.max&&e.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=e.panLimitsMode,this.panSoftLimit=e.panSoftLimit,this.rotationSoftLimit=e.rotationSoftLimit,this.hoverRotatePanMode=e.hoverRotatePanMode,this.hoverRotateDamping=null!==(r=e.hoverRotateDamping)&&void 0!==r?r:this.dampingFactor,this.useWindowEvents="window"===t,0!==this.hoverRotatePanMode&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let i=e.hoverRotatePanStrength/100;this.hoverRotatePanStrength=i**2,this.zoomLimitsEnabled=e.zoomLimitsEnabled,this.minZoom=e.zoomLimits.min,this.maxZoom=Math.max(e.zoomLimits.min,e.zoomLimits.max),this.minDistance=1e3/e.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/e.zoomLimits.min),this.autoRotate=e.autoRotate,this.autoRotateSpeed=e.autoRotateSpeed,this.autoRotateClockwise=e.autoRotateClockwise;let s=this.object.getTarget().applyQuaternion(Vfe.copy(this.object.quaternion).invert());this.minV=-e.panVerticalOffset.min+s.y,this.maxV=e.panVerticalOffset.max+s.y,this.minH=-e.panHorizontalOffset.min+s.x,this.maxH=e.panHorizontalOffset.max+s.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=Jfe(this.spherical.phi-e.rotationVerticalOffset.min),this.maxPhi=Jfe(this.spherical.phi+e.rotationVerticalOffset.max),this.minTheta=Jfe(Jfe(this.spherical.theta)-e.rotationHorizontalOffset.min),this.maxTheta=Jfe(Jfe(this.spherical.theta)+e.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,1===e.orbitTouches&&(this.touches[0]=TL),1===e.panTouches&&(this.touches[0]=PL),2===e.orbitTouches&&(this.touches[1]=DL),2===e.panTouches&&(this.touches[1]=kL),3===e.orbitTouches&&(this.touches[2]=TL),3===e.panTouches&&(this.touches[2]=PL),this.isTouchZoom=e.isTouchZoom,this.resetHoverEffectOnPointerLeave=null!==(n=e.resetHoverEffectOnPointerLeave)&&void 0!==n&&n}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),0!==this.hoverRotatePanMode&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(e,t,r,n,i,s,a,o){let l,c,u;this.overShoot.set(0,0),e instanceof PB?(l=e.x,c=e.y,this.current.set(this.target.x,this.target.y),u=!0):(l=e.theta,c=e.phi,this.current.set(Jfe(this.spherical.theta),Jfe(this.spherical.phi)),u=!1),0===r&&(this.current.x+=l,this.current.y+=c),(3===t||2===t)&&(!u&&this.isThetaFlipped?this.current.x>n&&this.current.x<0?this.overShoot.x=n-this.current.x:this.current.x<i&&this.current.x>0&&(this.overShoot.x=i-this.current.x):this.current.x>n?this.overShoot.x=n-this.current.x:this.current.x<i&&(this.overShoot.x=i-this.current.x)),(3===t||1===t)&&(this.current.y>s?this.overShoot.y=s-this.current.y:this.current.y<a&&(this.overShoot.y=a-this.current.y)),u||(this.overShoot.x=Jfe(this.overShoot.x),this.overShoot.y=Jfe(this.overShoot.y)),0!==r?(this.overRatio.copy(this.overShoot).divide(o),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),1===r&&(this.overRatio.x=$fe(Math.abs(this.overRatio.x)),this.overRatio.y=$fe(Math.abs(this.overRatio.y))),this.isPointerDown||1===r?2===r&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),c*this.overShoot.y<0&&!this.phiIsFree&&(c*=1-this.overRatio.y)):2===r&&(!u&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||u&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=.05*this.overShoot.x),this.phiIsFree||(c=.05*this.overShoot.y),u?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):u?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,c+=this.overShoot.y),e instanceof PB?(e.x=l,e.y=c):(this.thetaIsFree||(e.theta=l),this.phiIsFree||(e.phi=c))}setEnableDampingSpeed(e){this.enableDamping=e,this.rotateSpeed=!0===e?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(e){this.sphericalDelta.theta-=e}rotateUp(e){this.sphericalDelta.phi-=e}panLeft(e,t){this.panLeftV.setFromMatrixColumn(t,0),this.panLeftV.multiplyScalar(-e),this.panOffset.add(this.panLeftV)}panUp(e,t){this.panUpV.setFromMatrixColumn(t,1),this.panUpV.multiplyScalar(e),this.panOffset.add(this.panUpV)}pan(e,t){let r=this.domElement;if(r&&this.object.isPerspectiveCamera){let n=this.object.position;this.panV.copy(n).sub(this.target);let i=this.panV.length();i*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*e*i/r.clientHeight,this.object.matrixWorld),this.panUp(2*t*i/r.clientHeight,this.object.matrixWorld)}else r&&this.object.isOrthographicCamera&&(this.panLeft(e*(this.object.right-this.object.left)/this.object.zoom/r.clientWidth,this.object.matrixWorld),this.panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/r.clientHeight,this.object.matrixWorld));this.dispatchEvent(zfe)}dollyOut(e){this.object.isPerspectiveCamera?this.scale/=e:this.object.isOrthographicCamera&&(this.object.zoom*=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(Bfe)}dollyIn(e){this.object.isPerspectiveCamera?this.scale*=e:this.object.isOrthographicCamera&&(this.object.zoom/=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(Bfe)}zoomOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getZoomScale();this.dispatchEvent(Ffe),this.dollyOut(e),this.dispatchEvent(jfe)}zoomIn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getZoomScale();this.dispatchEvent(Ffe),this.dollyIn(e),this.dispatchEvent(jfe)}setZoom(e){if(this.dispatchEvent(Ffe),this.object.isPerspectiveCamera){let t=this.initialSphericalRadius/e/this.spherical.radius;this.scale=t}else this.object.isOrthographicCamera&&(this.object.zoom=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0);this.dispatchEvent(jfe)}handleMouseDownRotate(e){this.rotateStart.set(e.clientX,e.clientY)}handleMouseDownDolly(e){this.dollyStart.set(e.clientX,e.clientY)}handleMouseDownPan(e){this.panStart.set(e.clientX,e.clientY)}handleMouseMoveRotate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;void 0!==e.movementX?this.rotateDelta.set(e.movementX,e.movementY):(this.rotateEnd.set(e.clientX,e.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*t).rotateAround(Hfe,-this.object.angleOffsetFromUp);let r=this.domElement,n=this.useWindowEvents?window.innerHeight:r.clientHeight,i=2*Math.PI*this.rotateDelta.x/n,s=2*Math.PI*this.rotateDelta.y/n;this.rotateLeft(i),this.rotateUp(s),this.update()}handleMouseMoveDolly(e){this.dollyEnd.set(e.clientX,e.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;void 0!==e.movementX?this.panDelta.set(e.movementX,e.movementY):(this.panEnd.set(e.clientX,e.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*t),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(e){if(!1===SZ&&!1===TZ(e)&&!0===function(e){return 0===e.wheelDeltaY||0===e.deltaY?!(wZ&&e.shiftKey&&Math.abs(e.wheelDeltaX)>=120)&&(e.wheelDeltaX?e.wheelDeltaX===-3*e.deltaX||e.wheelDeltaX===-3*window.devicePixelRatio*e.deltaX:0===e.deltaMode):e.wheelDeltaY?e.wheelDeltaY===-3*e.deltaY||e.wheelDeltaY===-3*window.devicePixelRatio*e.deltaY:0===e.deltaMode}(e)){if(!1===this.enablePan)return;this.gesture?(this.panDelta.set(-e.deltaX,-e.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),e.altKey?this.pan(0,this.panDelta.y):e.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout((()=>{this.gesture=!1,this.isPointerDown=!1}),30)}else{if(!1===this.enableZoom||this.gesture)return;0===e.deltaY?e.deltaX<0?this.dollyIn(this.getZoomScale()):e.deltaX>0&&this.dollyOut(this.getZoomScale()):e.deltaY<0?this.dollyIn(this.getZoomScale()):e.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(2===PZ.length){let e=.5*(PZ[0].pageX+PZ[1].pageX),t=.5*(PZ[0].pageY+PZ[1].pageY);this.rotateStart.set(e,t)}else this.rotateStart.set(PZ[0].pageX,PZ[0].pageY)}handleTouchStartPan(){if(2===PZ.length){let e=.5*(PZ[0].pageX+PZ[1].pageX),t=.5*(PZ[0].pageY+PZ[1].pageY);this.panStart.set(e,t)}else this.panStart.set(PZ[0].pageX,PZ[0].pageY)}handleTouchStartDolly(){let e=PZ[0].pageX-PZ[1].pageX,t=PZ[0].pageY-PZ[1].pageY,r=Math.sqrt(e*e+t*t);this.dollyStart.set(0,r)}handleTouchStartDollyPan(){this.enableZoom&&!0===this.isTouchZoom&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&!0===this.isTouchZoom&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(e){if(2===PZ.length){let t=NZ(e),r=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);this.rotateEnd.set(r,n)}else{if(e.pointerId!==PZ[0].pointerId)return;this.rotateEnd.set(e.pageX,e.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;t&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/t.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/t.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(e){if(2===PZ.length){let t=NZ(e),r=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);this.panEnd.set(r,n)}else{if(e.pointerId!==PZ[0].pointerId)return;this.panEnd.set(e.pageX,e.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(e){let t=NZ(e),r=e.pageX-t.x,n=e.pageY-t.y,i=Math.sqrt(r*r+n*n);this.dollyEnd.set(0,i),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(e){this.enableZoom&&!0===this.isTouchZoom&&this.handleTouchMoveDolly(e),this.enablePan&&this.handleTouchMovePan(e)}handleTouchMoveDollyRotate(e){this.enableZoom&&!0===this.isTouchZoom&&this.handleTouchMoveDolly(e),this.enableRotate&&this.handleTouchMoveRotate(e)}checkRaycastLock(){if(this.object.data.raycastLock){if(this.options.isPlayMode)return!1;{var e;let t=null===(e=this.options)||void 0===e?void 0:e.showCameraLock;return t&&t(),!0}}return!1}};function Jfe(e){let t=2*Math.PI;for(;e<=-Math.PI;)e+=t;for(;e>Math.PI;)e-=t;return e}function $fe(e){return 1-Math.pow(1-e,4)}var epe,tpe=class{constructor(e,t,r,n,i,s){this.id=e,this.data=t,this.object=r,this.page=n,this.currentIntersectedObjects=[],this.actions=uhe(t,t.actions,n,i,s,r),this.target=t.target,this.triggeringObjects=[];for(let a of t.triggeringObjects){let e=n.scene.find(a);e&&this.triggeringObjects.push(e)}}isValidTriggeringObject(e){return"all"===this.target||this.triggeringObjects.some((t=>t===e||t.isAncestorOf(e.uuid)||e.isAncestorOf(t.uuid)))}disconnect(){hhe(this.actions)}dispatch(){this.object.destroyedInAction||(this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.actions.Transition.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.SwitchCamera.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.Link.forEach((e=>{e.dispatch()})),this.actions.Reset.forEach((e=>{e.dispatch()})),this.actions.Create.forEach((e=>{e.dispatch()})),this.actions.Destroy.forEach((e=>{e.dispatch(!1)})),this.actions.Audio.forEach((e=>{e.dispatchBasic()})),this.actions.Particles.forEach((e=>{e.dispatchBasic()})),this.actions.Video.forEach((e=>{e.dispatchBasic()})),this.actions.SceneTransition.forEach((e=>{e.dispatch()})),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch())))}};GZ.then((e=>epe=e));var rpe=new PB,npe=new TB,ipe=new PB,spe=new mz(0,0,0,"YXZ"),ape=new mz(0,0,0,"XYZ"),ope=new PB,lpe=new PB,cpe=new PB(1,1,1),upe=new TB,hpe=new sz,dpe=new sz,fpe={type:"updateMatrix"},ppe=new TB,mpe=new QB,gpe={type:"beginEvent",eventName:"Collision"},vpe={type:"beginEvent",eventName:"Trigger"};var ype=e=>e.states.some((e=>void 0!==e.data.position||void 0!==e.data.rotation||void 0!==e.data.hiddenMatrix||void 0!==e.data.cloner||void 0!==e.data.pathSnapping)),bpe=class{constructor(e){this.eventContext=e,this.isEnabled=!1,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.processRigidBody=e=>{if(e.bodyType()!==epe.RigidBodyType.Dynamic)return;e.isSleeping()||this.nActiveRigidBodies++;let[t,r,n]=this.rigidBodyToMesh.get(e.handle);if(rpe.copy(e.translation()).multiplyScalar(this.pixelsPerMeter),npe.copy(e.rotation()),t.matrixWorld.compose(rpe,npe,r),t.hasNonUniformScale&&t.matrixWorld.multiply(t.shearScale),t.dispatchEvent(fpe),n){let e=t.cloner;if(e&&void 0===e.objectForSample){e.matrixWorld.copy(t.matrixWorld);for(let t of e.children)t.updateMatrixWorld(!0)}for(let r of t.children)r.updateMatrixWorld(!0)}},this.accumulator=0,this.handleCollisionEvents=(e,t,r)=>{var n,i;if(!1===r)return;let s,a;if(this.sensorToTriggerEvent[e]?(s=this.sensorToTriggerEvent[e],a=this.sharedGameControlGlobals.colliderToEntity.get(t)):this.sensorToTriggerEvent[t]&&(s=this.sensorToTriggerEvent[t],a=this.sharedGameControlGlobals.colliderToEntity.get(e)),s&&a&&s.isValidTriggeringObject(a))s.dispatch();else{for(let r=this.sharedGameControlGlobals.createdObjects.length-1;r>=0;r--){var o,l;let n=this.sharedGameControlGlobals.createdObjects[r];if(n.userData.hasCollisionDestroy&&((null===(o=n.rigidBody)||void 0===o?void 0:o.collider(0).handle)===e||(null===(l=n.rigidBody)||void 0===l?void 0:l.collider(0).handle)===t)){this.sharedGameControlGlobals.createdObjects.splice(r,1),n.removeFromParent(),requestAnimationFrame((()=>{var e;return null===(e=this.sharedGameControlGlobals.rapierWorld)||void 0===e?void 0:e.removeRigidBody(n.rigidBody)}));break}}if(void 0!==(null===(n=this.gameControl)||void 0===n?void 0:n.object)&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(e)){let e=this.sharedGameControlGlobals.colliderToEntity.get(t),r=this.sharedGameControlGlobals.entityToCollisionEvents[e.uuid];if(void 0===r)return;for(let n of r)"character"===n.data.target&&this.dispatchCollisionEvent(n,e,t)}else if(void 0!==(null===(i=this.gameControl)||void 0===i?void 0:i.object)&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(t)){let t=this.sharedGameControlGlobals.colliderToEntity.get(e),r=this.sharedGameControlGlobals.entityToCollisionEvents[t.uuid];if(void 0===r)return;for(let n of r)"character"===n.data.target&&this.dispatchCollisionEvent(n,t,e)}else{let r=this.sharedGameControlGlobals.colliderToEntity.get(e),n=this.sharedGameControlGlobals.entityToCollisionEvents[r.uuid];if(void 0!==n)for(let t of n)"scene"===t.data.target&&this.dispatchCollisionEvent(t,r,e);let i=this.sharedGameControlGlobals.colliderToEntity.get(t),s=this.sharedGameControlGlobals.entityToCollisionEvents[null===i||void 0===i?void 0:i.uuid];if(void 0!==s)for(let e of s)"scene"===e.data.target&&this.dispatchCollisionEvent(e,i,t)}}},this.isExport=e.isExport,this.sharedAssets=e.sharedAssets,this.renderer=e.renderer,this.requestRender=e.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=200,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(e){e.forEach((e=>{e.addEventListener("connected",(e=>{"gamepad"in e.data&&"axes"in e.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(e.data.gamepad)}))}))}markIsDestroyTarget(){this.page.traverseVisibleEntity((e=>{let t=e.dataPatched;for(let n of t.events){var r;if(!0===n.data.disabled)continue;let e=null===(r=n.data.actions)||void 0===r||null===(r=r.find((e=>"Destroy"===e.data.type)))||void 0===r?void 0:r.data;if(e)for(let t of e.objects){let e=this.page.scene.find(t);e&&(e.userData.hasDestroy=!0)}}}))}markIsDragObject(){this.page.traverseVisibleEntity((e=>{let t=e.dataPatched;for(let r of t.events)if(!0!==r.data.disabled&&"DragDrop"===r.data.type)for(let e of r.data.objects){let t=this.page.scene.find(e);t&&(t.userData.hasDrag=!0)}}))}initBVH(){let e=[];if(this.page.traverseChildren((t=>{var r,n;let i;if(t instanceof wne||t instanceof tie||t instanceof Roe)return;i=t instanceof X4?t.object:t;let s=i.dataPatched;if("visibility"===(null===(r=s.physics)||void 0===r?void 0:r.enabled)?!s.visible:null===(n=s.physics)||void 0===n||!n.enabled)return!0;let a=t.geometry,o=!0===i.userData.hasDestroy,l=!0===i.userData.hasDrag;if(ype(s)||o||l||i.dataPatched.events.some((e=>!0!==e.data.disabled&&("GameControl"===e.data.type||"Follow"===e.data.type))))return t.updateMatrixWorldSVD(),this.addBoundsTree(t),!0;a&&e.push(Khe(a,t.matrixWorld))})),e.length>0){let t=h3(e,!1);this.sharedGameControlGlobals.staticMeshBVH=new M4(t)}}addRigidBody(e,t,r){if(Yhe(e.matrixWorld))return;let n=[],i="geometry"in e?e.geometry:void 0,s=t.dataPatched;if(void 0!==(null===i||void 0===i?void 0:i.getAttribute("position"))&&n.push(Khe(i,e.shearScale)),s.physics.fusedBody){let t=this.gatherChildrenGeom(e,n);e.traverseObject(t),e.children.forEach((e=>e.updateMatrixWorld(!0)));let r=e.cloner;r&&void 0===r.objectForSample&&"dynamic"===s.physics.rigidBody&&(r.traverseObject(t),r.children.forEach((e=>e.updateMatrixWorld(!0))))}if(n.length>0){let l,c=!r.fromCreate&&"dynamic"===s.physics.rigidBody||r.fromCreate&&r.dynamic;c?(l=epe.RigidBodyDesc.dynamic(),l.setLinearDamping(s.physics.damping).setAngularDamping(s.physics.damping).setAdditionalMass(1e-9).setGravityScale(s.physics.gravityScale).enabledRotations(...s.physics.enabledRotation).enabledTranslations(...s.physics.enabledTranslation)):(r.hasTransformAnim||r.hasFollow||r.hasDrag)&&!r.fromCreate?(l=epe.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)):l=epe.RigidBodyDesc.fixed();let u=h3(n);(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(rpe,npe,ipe),e.position0=rpe.clone().divideScalar(this.pixelsPerMeter),e.rotation0=npe.clone(),rpe.divideScalar(this.pixelsPerMeter),l.setTranslation(rpe.x,rpe.y,rpe.z).setRotation(npe),i?null===u||void 0===u||u.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):null===u||void 0===u||u.scale(ipe.x/this.pixelsPerMeter,ipe.y/this.pixelsPerMeter,ipe.z/this.pixelsPerMeter);let h=this.sharedGameControlGlobals.rapierWorld.createRigidBody(l);c&&this.rigidBodyToMesh.set(h.handle,[e,ipe.clone(),s.physics.fusedBody]);let d=!(void 0===s.geometry||"SubdivGeometry"===s.geometry.type||"NonParametricGeometry"===s.geometry.type||"BooleanGeometry"===s.geometry.type||"VectorGeometry"===s.geometry.type||"StarGeometry"===s.geometry.type||"RectangleGeometry"===s.geometry.type||"EllipseGeometry"===s.geometry.type||"TriangleGeometry"===s.geometry.type||"TorusGeometry"===s.geometry.type||"HelixGeometry"===s.geometry.type);try{this.addCollider(h,s.physics,u,t,d)}catch(a){try{this.addCollider(h,s.physics,u,t,!1)}catch(o){console.error(o)}}e.rigidBody=h}}addBoundsTree(e){var t,r;let n=[];if(void 0!==(null===(t=e.geometry)||void 0===t?void 0:t.getAttribute("position"))&&(null===(r=e.geometry)||void 0===r?void 0:r.getAttribute("position").count)>0&&n.push(Khe(e.geometry,e.shearScale)),e.traverseObject(this.gatherChildrenGeom(e,n)),e.children.forEach((e=>e.updateMatrixWorld(!0))),n.length>0){let t=h3(n,!1);e.bvhGeometry=t,t.getAttribute("position").count>0&&(e.bvhGeometry.boundsTree=new M4(t),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e))}}addCollider(e,t,r,n){var i,s;let a,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(0===(null===r||void 0===r?void 0:r.getAttribute("position").count)||0===(null===r||void 0===r||null===(i=r.getIndex())||void 0===i?void 0:i.count))return;r&&(a="trimesh"===t.colliderType?epe.ColliderDesc.trimesh(r.getAttribute("position").array,r.getIndex().array):epe.ColliderDesc.convexMesh(r.getAttribute("position").array,o?r.getIndex().array:void 0)),a.setFrictionCombineRule(epe.CoefficientCombineRule.Average).setRestitutionCombineRule(epe.CoefficientCombineRule.Average).setDensity(t.density).setFriction(t.friction).setRestitution(t.restitution);let l=this.sharedGameControlGlobals.rapierWorld.createCollider(a,e);this.sharedGameControlGlobals.colliderToEntity.set(l.handle,n),(null===(s=this.sharedGameControlGlobals.entityToCollisionEvents[n.uuid])||void 0===s?void 0:s.some((e=>"scene"===e.target)))&&l.setActiveEvents(epe.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(e,t){return(r,n)=>{var i;if(0===n)return;let s;if(r instanceof wne){if(!r.objectForSample)return!0===r.object.dataPatched.physics.fusedBody&&"dynamic"===r.object.dataPatched.physics.rigidBody||void 0;if(r.objectForSample.dataPatched.physics.fusedBody)return;s=r.object}else if(r instanceof X4)s=r.object;else if(s=r,null!==(i=s.dataPatched.cloner)&&void 0!==i&&i.hideBase)return!0;let a=s.dataPatched;if("visibility"===a.physics.enabled?!a.visible:!a.physics.enabled)return!0;1===n?e.hasNonUniformScale?r.matrixWorld.multiplyMatrices(e.shearScale,r.hiddenMatrix):r.matrixWorld.copy(r.hiddenMatrix):r.matrixWorld.multiplyMatrices(r.parent.matrixWorld,r.hiddenMatrix),r.matrixWorld.multiply(r.matrix);let o=r.geometry;void 0!==(null===o||void 0===o?void 0:o.getAttribute("position"))&&t.push(Khe(o,r.matrixWorld))}}activate(e){if(this.isEnabled)return;this.isEnabled=!0,this.eventManager=e,this.usePhysics=this.page.data.globalPhysics.usePhysics;let t=this.page.playCamera,r=!1,n=5,i=8,s=9,a="drag",o=this.page.data.publish.gameControlObject,l=null!==o?this.page.find(o):null,c=null;if(l)for(let u of l.data.events){if(u.data.disabled||"GameControl"!==u.data.type)continue;let e=l;for(;this.usePhysics&&null!==(null===(h=e=e.parent)||void 0===h?void 0:h.parent);){var h,d;null===(d=e.data.physics)||void 0===d||d.fusedBody}u.data.collisionEnabled&&(this.needsCollisionDetection=!0),null===c&&(c=u.data)}if(this.page.traverseEntity((e=>{for(let t of e.dataPatched.events)if(!1===t.data.disabled&&"Trigger"===t.data.type)return this.needsCollisionDetection=!0,!0})),l&&c&&(!0===l.data.visible||!0===l.data.physics.enabled)){r=r||c.camera===t.uuid||l.uuid===t.uuid;let e=new qhe(l,this.renderer.domElement,c,this.eventContext.page.data.globalPhysics,this,l.uuid!==t.uuid&&c.camera===t.uuid,t,this.page,this.sharedAssets);this.gameControl=e,n=c.joystickPosLoc,i=c.joystickRotLoc,s=c.jumpTouchButtonLoc,a=c.rotByTouch,_Z&&c.touchControl&&(this.joystickToGameControls[n]="pos","walk"===c.moveMode&&(this.joystickToGameControls[s]="jmp"),"joystick"===a&&(this.joystickToGameControls[i]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let e=this.gameControl.data;if(!this.navigationMeshWrapper){let t;this.navigationMeshWrapper=new Ofe(this.usePhysics,this.isExport),t="sphere"===e.collider.type?2*e.collider.radius:e.collider.height,t=Math.floor(t/e.navmesh.ch-1),this.navigationMeshWrapper.init(u(u({},e.navmesh),{},{walkableHeight:t}),this.gameControl,this.eventContext)}}if(!1===r){let{enableRotate:e,enablePan:r,enableZoom:n,autoRotate:i,hoverRotatePanMode:s}=this.eventManager.publish.orbitControls;(e||r||n||i||0!==s)&&(this.orbitControls=new Zfe(t,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let f=this.renderer.domElement.width/this.renderer.getPixelRatio(),p=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach(((e,t)=>{let r=document.body.appendChild(document.createElement("div")),[n,i,s]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[t],a=(f-5*n)/4+n,o={},l="jmp"===e,c=l?0:n;t<10?(t<5?o.top=c/2:o.bottom=c/2,o.left=c/2+t%5*a):10===t?(o.left=c/2,o.top=p/2):(o.right=c/2,o.top=p/2),o.top?o.top-=i[1]:o.bottom+=i[1],o.left?o.left+=i[0]:o.right-=i[0];for(let d in o)o[d]+="px";if(l){let e=r.appendChild(document.createElement("div"));Object.assign(e.style,o,{position:"absolute",width:n+"px",height:n+"px",backgroundColor:"rgba(255,255,255,".concat("show"===s?.4:0,")"),zIndex:"9999",borderRadius:n+"px",border:"show"===s?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let i=n/16*16*.4;return"show"===s&&(e.innerHTML='\n\t\t\t\t\t\t<svg width="'.concat(i,'" height="').concat(.4*n,'" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t')),e.addEventListener("pointerdown",(()=>{this.gameControl.movementState.jump=1,this.requestRender()})),e.addEventListener("touchend",(e=>e.preventDefault())),void(this.joysticks[t]=[void 0,r])}let u={zone:r,mode:"static",position:o,size:n};"hide"===s&&(u.restOpacity=0);let h=Jle(u);h.on("move",((t,r)=>{let n=this.gameControl;"pos"===e?r.force<.2?n.moveForce=0:(n.movementState.movePosZ=Math.sin(-r.angle.radian),n.movementState.movePosX=Math.cos(-r.angle.radian),r.force>1.2?n.movementState.run=1:n.movementState.run=0,r.force<.3?n.moveForce=(r.force-.2)/.1:n.moveForce=1):"rot"===e&&(r.force<.2?n.rotForce=0:(n.movementState.rotPosX=r.vector.y,n.movementState.rotPosY=-r.vector.x,r.force<.3?n.rotForce=(r.force-.2)/.1:n.rotForce=1)),this.requestRender()})),h.on("end",((t,r)=>{let n=this.gameControl;"pos"===e?(n.movementState.movePosZ=0,n.movementState.movePosX=0,n.moveForce=1):"rot"===e&&(n.movementState.rotPosX=0,n.movementState.rotPosY=0,n.rotForce=1)})),this.joysticks[t]=[h,r]})),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout((()=>{this.collisionEvents.forEach((e=>e.initialDisabled=!1))}),80)}initPhysics(){var e;null!==(e=this.sharedGameControlGlobals.rapierWorld)&&void 0!==e&&e.free(),this.sharedGameControlGlobals.rapierWorld=new epe.World(new epe.Vector3(0,this.gravity,0)),this.events=new epe.EventQueue(!0);let t=[],r=[];if(this.page.traverseChildren((e=>{var n;let i;if(e instanceof wne){if(!e.objectForSample)return!0===e.object.dataPatched.physics.fusedBody&&"dynamic"===e.object.dataPatched.physics.rigidBody||void 0;if(e.objectForSample.dataPatched.physics.fusedBody)return;i=e.object}else if(e instanceof X4)i=e.object;else{var s,a,o;if(e instanceof Roe||e instanceof tie)return;if(i=e,!1===(null===(s=i.dataPatched.cloner)||void 0===s?void 0:s.disabled)&&null!==(a=i.dataPatched.cloner)&&void 0!==a&&a.hideBase&&!0!==(null===(o=i.dataPatched.physics)||void 0===o?void 0:o.fusedBody))return!0}let l,c=i.dataPatched;for(let t of c.events)!0!==t.data.disabled&&"GameControl"===t.data.type&&(l=t.data);if(!c.physics||("visibility"===c.physics.enabled?!c.visible:!c.physics.enabled))return!0;e.updateMatrixWorldSVD();let u=ype(c),h=!1,d=i.userData.hasDestroy,f=i.userData.hasDrag,p=!1;for(let t of c.events)if(!0!==t.data.disabled)if("Collision"===t.data.type){h=!0;let e=new _fe(t.id,t.data,i,this.page,this.sharedAssets,this.eventManager);e.initialDisabled=!0,this.collisionEvents.push(e),this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid].every((e=>e.id!==t.id))?this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid].push(e):this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid]=[e]}else if("Follow"===t.data.type){p=!0;let r=t.data.target;e.traverseVisible((e=>{e.userData.isFollowingObj=r}))}"dynamic"===c.physics.rigidBody&&!1===c.physics.fusedBody&&(e.matrixWorldFusedFalse=e.matrixWorld.clone());let m=e.geometry;if(void 0!==l){let t=epe.RigidBodyDesc.kinematicPositionBased();(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(rpe,npe,ipe),e.position0=rpe.clone().divideScalar(this.pixelsPerMeter),e.rotation0=npe.clone(),rpe.divideScalar(this.pixelsPerMeter),t.setTranslation(rpe.x,rpe.y,rpe.z).setRotation(npe);let r,n=this.sharedGameControlGlobals.rapierWorld.createRigidBody(t);e.rigidBody=n,r="sphere"===l.collider.type?epe.ColliderDesc.ball(l.collider.radius/this.pixelsPerMeter):"capsule"===l.collider.type?epe.ColliderDesc.capsule((l.collider.height/2-l.collider.radius)/this.pixelsPerMeter,l.collider.radius/this.pixelsPerMeter):epe.ColliderDesc.cuboid(l.collider.width/this.pixelsPerMeter/2,l.collider.height/this.pixelsPerMeter/2,l.collider.depth/this.pixelsPerMeter/2),r.setFrictionCombineRule(epe.CoefficientCombineRule.Average).setRestitutionCombineRule(epe.CoefficientCombineRule.Average).setDensity(c.physics.density).setFriction(c.physics.friction).setRestitution(c.physics.restitution);let s=this.sharedGameControlGlobals.rapierWorld.createCollider(r,n);this.sharedGameControlGlobals.colliderToEntity.set(s.handle,i),rpe.fromArray(l.collider.position).multiply(ipe.setFromMatrixScale(i.matrixWorld)).divideScalar(this.pixelsPerMeter),s.setTranslationWrtParent(rpe);let a=(new TB).setFromEuler((new mz).setFromVector3((new PB).fromArray(l.collider.rotation)));s.setRotationWrtParent(a),s.setActiveEvents(epe.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(i,!0)}else"dynamic"===c.physics.rigidBody||u||p||d||f||h?(this.addRigidBody(e,i,{hasFollow:p,hasTransformAnim:u,hasDrag:f}),this.generateSensorColliderDescs(i,c.physics.fusedBody)):(m&&t.push(Khe(m,e.matrixWorld)),c.physics.fusedBody&&e.traverseObject(((e,r)=>{if(0===r)return;let n;if(e instanceof wne){if(!e.objectForSample)return!0===e.object.dataPatched.physics.fusedBody&&"dynamic"===e.object.dataPatched.physics.rigidBody||void 0;if(e.objectForSample.dataPatched.physics.fusedBody)return;n=e.object}else{var i;if(e instanceof Roe||e instanceof tie)return;if(e instanceof X4)n=e.object;else if(n=e,null!==(i=n.dataPatched.cloner)&&void 0!==i&&i.hideBase)return!0}let s=n.dataPatched;if("visibility"===s.physics.enabled?!s.visible:!s.physics.enabled)return!0;let a=e.geometry;void 0!==(null===a||void 0===a?void 0:a.getAttribute("position"))&&t.push(Khe(a,e.matrixWorld))})),this.generateSensorColliderDescs(i,c.physics.fusedBody,r));return!(!0!==(null===(n=c.physics)||void 0===n?void 0:n.fusedBody)&&!l)||void 0})),0===t.length)return;let n=h3(t);n.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let i=epe.RigidBodyDesc.fixed(),s=this.sharedGameControlGlobals.rapierWorld.createRigidBody(i),a=epe.ColliderDesc.trimesh(n.getAttribute("position").array,n.getIndex().array).setFrictionCombineRule(epe.CoefficientCombineRule.Multiply).setRestitutionCombineRule(epe.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(a,s);for(let[o,l]of r){let e=this.sharedGameControlGlobals.rapierWorld.createCollider(o,s);this.sensorToTriggerEvent[e.handle]=l}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?this.initPhysics():(this.page.traverseEntity((e=>{for(let t of e.dataPatched.events)if("Trigger"===t.data.type&&!0!==t.data.disabled){let r=new tpe(t.id,t.data,e,this.page,this.sharedAssets,this.eventManager),n=(new sz).compose(ope.fromArray(t.data.position),upe.setFromEuler(ape.fromArray(t.data.rotation)),cpe);if("box"===t.data.triggerZone){let i=new IB;i.min.fromArray(t.data.size).multiplyScalar(-.5),i.max.fromArray(t.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([i,n,e,r])}else this.sharedGameControlGlobals.triggers.push([t.data.radius,n,e,r])}})),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach((e=>e.disconnect())),this.sharedGameControlGlobals.triggers.forEach((e=>e[3].disconnect())),this.sharedGameControlGlobals.triggers.length=0}deactivate(){if(this.isEnabled){var e,t,r,n;this.isEnabled=!1,this.page.traverse((e=>{let t=e;t.matrixWorldFusedFalse&&(t.matrixWorldFusedFalse=void 0),t.rigidBody&&(t.rigidBody=void 0),t.position0&&(t.position0=void 0),t.rotation0&&(t.rotation0=void 0)})),null!==(e=this.sharedGameControlGlobals.rapierWorld)&&void 0!==e&&e.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.accumulator=0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),null!==(t=this.gameControl)&&void 0!==t&&t.reset(),null!==(r=this.gameControl)&&void 0!==r&&r.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach((e=>{let[t,r]=e;null!==t&&void 0!==t&&t.destroy(),r.remove()})),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),null!==(n=this.navigationMeshWrapper)&&void 0!==n&&n.dispose(),this.navigationMeshWrapper=void 0;for(let e of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))e.forEach((e=>e.disconnect()));this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}}update(e,t,r){if(!this.isEnabled)return!0;let n=!0;if(void 0!==this.orbitControls&&this.orbitControls.needsUpdate&&(n=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,n=!1):2===this.initializationCounter&&this.gameControl&&(n=!this.gameControl.update(e,t,r)&&n),!1===this.usePhysics&&this.checkTrigger(),this.usePhysics){let t=.016666666666666666;if(0===e)n=this.stepPhysics()&&n;else{let r=e/1e3;r<t&&r>.55*t&&(r=t),this.accumulator+=r;let i=performance.now(),s=0,a=6;for(;this.accumulator>=t&&s<a&&(n=this.stepPhysics()&&n,this.accumulator-=t,s++,!(performance.now()-i>1e3*t)););this.accumulator=this.accumulator%t}}return n}stepPhysics(){var e;for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim){(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(rpe,npe,ipe),spe.setFromQuaternion(npe);let e=t;void 0===e.prevR?(e.prevR=spe.clone(),e.prevT=rpe.clone()):(e.prevR.copy(spe),e.prevT.copy(rpe)),t.rigidBody&&(t.rigidBody.setNextKinematicTranslation(rpe.divideScalar(this.pixelsPerMeter)),t.rigidBody.setNextKinematicRotation(npe))}return this.sharedGameControlGlobals.rapierWorld.step(this.events),null!==(e=this.events)&&void 0!==e&&e.drainCollisionEvents(this.handleCollisionEvents),!this.updatePositions()}dispatchCollisionEvent(e,t,r){var n;let i,s=(null===(n=this.sharedGameControlGlobals.rapierWorld)||void 0===n?void 0:n.getCollider(r))._parent;if(t.cloner)for(let a of t.cloner.children)if(a.rigidBody===s){i=a;break}e.dispatch(i),t.dispatchEvent(gpe)}updateUseWindowEvents(e){var t;null===(t=this.orbitControls)||void 0===t||t.updateUseWindowEvents(e)}generateSensorColliderDescs(e,t,r){let n=dpe.copy(e.matrixWorld).invert();e.traverseEntity(((i,s)=>{if(!1===t&&1===s)return!0;for(let t of i.dataPatched.events)if("Trigger"===t.data.type&&!0!==t.data.disabled){let s,a=new tpe(t.id,t.data,i,this.page,this.sharedAssets,this.eventManager);if(s="box"===t.data.triggerZone?epe.ColliderDesc.cuboid(...t.data.size.map((e=>e/(2*this.pixelsPerMeter)))):epe.ColliderDesc.ball(t.data.radius/this.pixelsPerMeter),s.setDensity(0).setSensor(!0).setActiveEvents(epe.ActiveEvents.COLLISION_EVENTS),ope.fromArray(t.data.position),upe.setFromEuler(ape.fromArray(t.data.rotation)),hpe.compose(ope,upe,cpe).premultiply(i.matrixWorld),r?(hpe.decompose(ope,upe,lpe),s.setActiveCollisionTypes(epe.ActiveCollisionTypes.KINEMATIC_FIXED|epe.ActiveCollisionTypes.DYNAMIC_FIXED)):(hpe.premultiply(n).decompose(ope,upe,lpe),e.rigidBody.bodyType()===epe.RigidBodyType.Dynamic||(e.rigidBody.bodyType()===epe.RigidBodyType.Fixed?s.setActiveCollisionTypes(epe.ActiveCollisionTypes.KINEMATIC_FIXED|epe.ActiveCollisionTypes.DYNAMIC_FIXED):s.setActiveCollisionTypes(epe.ActiveCollisionTypes.KINEMATIC_KINEMATIC|epe.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),ope.divideScalar(this.pixelsPerMeter),s.setTranslation(ope.x,ope.y,ope.z),s.setRotation(upe),r)r.push([s,a]);else{let t=this.sharedGameControlGlobals.rapierWorld.createCollider(s,e.rigidBody);this.sensorToTriggerEvent[t.handle]=a}}}))}checkTrigger(){let e;for(let t=0;t<this.sharedGameControlGlobals.triggers.length;t++){let[r,n,i,s]=this.sharedGameControlGlobals.triggers[t];for(let t=0;t<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;t++){let a=this.sharedGameControlGlobals.entitiesWithTransformAnim[t];if(i===a||!1===s.isValidTriggeringObject(W4.is(a)?a:a.object))continue;let o=dpe.copy(i.matrixWorld).decompose(ope,ppe,lpe).compose(ope,ppe,cpe).multiply(n),l=hpe.copy(a.matrixWorld).invert().multiply(o);r instanceof IB?e=a.bvhGeometry.boundsTree.intersectsBox(r,l):(mpe.radius=r,mpe.center.setFromMatrixPosition(l),e=a.bvhGeometry.boundsTree.intersectsSphere(mpe)),e?-1===s.currentIntersectedObjects.indexOf(a)&&(s.currentIntersectedObjects.push(a),s.dispatch(),i.dispatchEvent(vpe)):s.currentIntersectedObjects=s.currentIntersectedObjects.filter((e=>e!==a))}}}};function wpe(e){var t;let r=this._clip.duration,n=null!==(t=this._clip.start)&&void 0!==t?t:0,i=this.loop,s=this.time+e,a=this._loopCount,o=i===SN;if(0===e)return-1===a?s:o&&1===(1&a)?r-(s-n):s;if(2200===i){-1===a&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=r)s=r;else{if(!(s<0)){this.time=s;break e}s=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===a&&(e>=0?(a=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),s>=r||s<n){let t=Math.floor((s-n)/(r-n));s-=(r-n)*t,a+=Math.abs(t);let i=this.repetitions-a;if(i<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,o||(s=e>0?r:n,1===this.repetitions&&(s=r)),this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===i){let t=e<0;this._setEndings(t,!t,o)}else this._setEndings(!1,!1,o);this._loopCount=a,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:t})}}else this.time=s;if(o&&1===(1&a))return r-(s-n)}return s}var xpe,Spe=!1,_pe=class{constructor(e,t,r,n){this.scene=e,this.requestRender=t,this.updateDisplayProgress=r,this.animationInspectorState=n,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=e=>{"Empty"===e.data.type&&e.data.animations&&e.data.animations.forEach(((t,r)=>{let n=t[0]+"/";if(Array.isArray(e.identity)?n+=e.identity[0]:n+=e.uuid,this.clipIdToAction[n])return;let i=pW.parse(JSON.parse(t[2]));e.animations[r]=i;let s=this.mixer.clipAction(i,e);!1===Spe&&(Object.getPrototypeOf(s)._updateTime=wpe,Spe=!0),s.clampWhenFinished=!0,this.clipIdToAction[n]=s}))},this.mixer=new iG(e),this.scene.traverseEntity(this.addClip)}deleteClip(e,t){let r=this.scene.find(t);if(!r)return;let n=r.animations.find((t=>t.uuid===e));if(!n)return;let i=this.clipIdToAction[e];!i||(i.stop(),this.mixer.uncacheClip(n),delete this.clipIdToAction[e],r.animations=r.animations.filter((t=>t.uuid!==e)))}get isPlaying(){return Object.values(this.clipIdToAction).some((e=>e.isRunning()))}playFromInspector(e){this.mixer.stopAllAction();let t=this.clipIdToAction[e];!t||(t.play(),this.activeClip=t.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach((e=>{e.repetitions=1/0,e.loop=2201})),this.mixer.stopAllAction(),this.requestRender()}play(e){let t=e.clipId+"/"+e.object,r=this.clipIdToAction[t];if(r)return e&&(e.repeat>=0&&(r.repetitions=e.repeat+1),"pingpong"===e.direction&&0!==e.repeat&&(r.loop=SN)),r.play(),r.paused=!1,this.requestRender(),r}resumeFromInspector(e){let t=this.clipIdToAction[e];!t||(t.play(),t.paused=!1,this.requestRender())}pauseFromInspector(e){let t=this.clipIdToAction[e];!t||(t.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(e){var t;if(this.needsUpdate)this.needsUpdate=!1;else if(!1===this.isPlaying||null!==(t=this.animationInspectorState)&&void 0!==t&&t.isScrubbing)return;this.mixer.update(e/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*(this.maxFrames-1)%(this.maxFrames-1))),this.requestRender()}get maxFrames(){var e;return rhe(null!==(e=this.activeClip)&&void 0!==e?e:void 0)}setProgressFromInspector(e,t){if(!this.clipIdToAction[t])return;this.activeClip!==this.clipIdToAction[t].getClip()&&this.playFromInspector(t);let r=this.clipIdToAction[t].paused;this.clipIdToAction[t].paused=!1,this.mixer.setTime(Math.min(e/(this.maxFrames-1),.9999)*this.activeClip.duration),this.requestRender(),r&&(this.clipIdToAction[t].paused=!0)}},Cpe=new WeakMap,Epe=class extends bW{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,n){let i=new SW(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,(e=>{this.decodeDracoFile(e,t).catch(n)}),r,n)}decodeDracoFile(e,t,r,n){let i={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!r};return this.decodeGeometry(e,i).then(t)}decodeGeometry(e,t){let r=JSON.stringify(t);if(Cpe.has(e)){let t=Cpe.get(e);if(t.key===r)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let n,i=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(i,s).then((r=>(n=r,new Promise(((r,s)=>{n._callbacks[i]={resolve:r,reject:s},n.postMessage({type:"decode",id:i,taskConfig:t,buffer:e},[e])}))))).then((e=>this._createGeometry(e.geometry)));return a.catch((()=>!0)).then((()=>{n&&i&&this._releaseTask(n,i)})),Cpe.set(e,{key:r,promise:a}),a}_createGeometry(e){let t=new iF;e.index&&t.setIndex(new Xz(e.index.array,1));for(let r=0;r<e.attributes.length;r++){let n=e.attributes[r],i=n.name,s=n.array,a=n.itemSize;t.setAttribute(i,new Xz(s,a))}return t}_loadLibrary(e,t){let r=new SW(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise(((t,n)=>{r.load(e,t,void 0,n)}))}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then((t=>{let r=t[0];e||(this.decoderConfig.wasmBinary=t[1]);let n=Ape.toString(),i=["/* draco decoder */",r,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([i]))})),this.decoderPending}_getWorker(e,t){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){let e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){let r=t.data;switch(r.type){case"decode":e._callbacks[r.id].resolve(r);break;case"error":e._callbacks[r.id].reject(r);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));let r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r}))}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map((e=>e._taskLoad)))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}};function Ape(){let e,t;function r(e,t,r,n,i,s){let a=s.num_components(),o=r.num_points()*a,l=o*i.BYTES_PER_ELEMENT,c=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,i),u=e._malloc(l);t.GetAttributeDataArrayForAllPoints(r,s,c,l,u);let h=new i(e.HEAPF32.buffer,u,o).slice();return e._free(u),{name:n,array:h,itemSize:a}}onmessage=function(n){let i=n.data;switch(i.type){case"init":e=i.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":let n=i.buffer,s=i.taskConfig;t.then((e=>{let t=e.draco,a=new t.Decoder,o=new t.DecoderBuffer;o.Init(new Int8Array(n),n.byteLength);try{let e=function(e,t,n,i){let s,a,o=i.attributeIDs,l=i.attributeTypes,c=t.GetEncodedGeometryType(n);if(c===e.TRIANGULAR_MESH)s=new e.Mesh,a=t.DecodeBufferToMesh(n,s);else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");s=new e.PointCloud,a=t.DecodeBufferToPointCloud(n,s)}if(!a.ok()||0===s.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+a.error_msg());let u={index:null,attributes:[]};for(let h in o){let n,a,c=self[l[h]];if(i.useUniqueIDs)a=o[h],n=t.GetAttributeByUniqueId(s,a);else{if(a=t.GetAttributeId(s,e[o[h]]),-1===a)continue;n=t.GetAttribute(s,a)}u.attributes.push(r(e,t,s,h,c,n))}return c===e.TRIANGULAR_MESH&&(u.index=function(e,t,r){let n=3*r.num_faces(),i=4*n,s=e._malloc(i);t.GetTrianglesUInt32Array(r,i,s);let a=new Uint32Array(e.HEAPF32.buffer,s,n).slice();return e._free(s),{array:a,itemSize:1}}(e,t,s)),e.destroy(s),u}(t,a,o,s),n=e.attributes.map((e=>e.array.buffer));e.index&&n.push(e.index.array.buffer),self.postMessage({type:"decode",id:i.id,geometry:e},n)}catch(l){console.error(l),self.postMessage({type:"error",id:i.id,error:l.message})}finally{t.destroy(o),t.destroy(a)}}))}}}async function Mpe(e){if(xpe){let t,r={attributeIDs:xpe.defaultAttributeIDs,attributeTypes:xpe.defaultAttributeTypes,useUniqueIDs:!1};try{t=await xpe.decodeGeometry(new Int8Array(e).buffer,r)}catch(ca){console.error(ca)}if(t)return{index:t.index?{array:t.index.array}:void 0,attributes:Object.entries(t.attributes).map((e=>{let[t,r]=e;return{name:t,itemSize:r.itemSize,array:r.array}}))}}return null}var Tpe=class{constructor(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0],this._delay=500,this._distance=2,this._onMouseDown=e=>{let t=[e.clientX,e.clientY],r=(new Date).getTime();if(this._clickCount>0){let e=t[0]-this._lastPosition[0],r=t[1]-this._lastPosition[1];Math.sqrt(e*e+r*r)>this._distance&&(this._clickCount=0)}this._lastPosition=t,this._clickCount=r-this._lastTime>this._delay?1:this._clickCount+1,this._lastTime=r},this._onMouseUp=e=>{}}start(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;this._target&&this.stop(),this.reset(),this._delay=t,this._distance=r,this._target=e,this._target.addEventListener("pointerdown",this._onMouseDown,!1),this._target.addEventListener("pointerup",this._onMouseUp,!1)}stop(){this._target&&(this._target.removeEventListener("pointerdown",this._onMouseDown,!1),this._target.removeEventListener("pointerup",this._onMouseUp,!1),this._target=void 0)}get clickCount(){return this._clickCount}reset(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0]}},Ppe=class{constructor(e,t,r,n,i,s,a,o){this.eventId=e,this.id=t,this.data=r,this.dataEvent=n,this.object=i,this.stage=!1,this.actions=uhe(n,r.actions,s,a,o,i)}disconnect(){hhe(this.actions)}dispatchIn(){this.actions.Audio.forEach((e=>e.dispatchBasic())),this.actions.Particles.forEach((e=>e.dispatchBasic())),this.actions.Video.forEach((e=>e.dispatchBasic())),this.actions.Create.forEach((e=>e.dispatch())),this.actions.Destroy.forEach((e=>e.dispatch())),this.actions.Reset.forEach((e=>e.dispatch())),this.actions.Link.forEach((e=>e.dispatch())),this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),this.actions.Transition.forEach((e=>e.toggle())),this.actions.Animation.forEach((e=>e.play())),this.actions.SwitchCamera.forEach((e=>e.play())),this.actions.SceneTransition.forEach((e=>e.dispatch())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}dispatchOut(){this.actions.Transition.forEach((e=>{e.toggle()}))}},kpe=class extends ude{constructor(e,t){super(e),this.eventManager=t,this.breakpoints=[],this.resize=(e,t)=>{this.breakpoints.forEach((r=>{let n,i=M0.deviceToSize(r.data.size),s="horizontal"===r.dataEvent.orientation?e:t;switch(r.data.operator){case"<":n=s<i[0];break;case">":n=s>i[0];break;case"<>":n=s>i[0]&&s<i[1]}r.stage!==n&&(r.stage=n,r.stage?r.dispatchIn():r.dispatchOut())}))},this.onResizeObserver=new ResizeObserver((e=>{for(let t of e){let{width:e,height:r}=t.contentRect;this.resize(e,r)}}))}connect(){let{page:e,sharedAssets:t,domElement:r}=this.eventContext;this.onResizeObserver.observe(r);let n=r=>{var n;if(r.visible&&null!==(n=r.data)&&void 0!==n&&n.events.length)for(let{data:i,id:s}of r.data.events)i.disabled||"Resize"===i.type&&i.breakpoints.forEach((n=>{let{data:a,id:o}=n;try{let n=new Ppe(s,o,a,i,r,e,t,this.eventManager);this.breakpoints.push(n)}catch(H0){}}))};e.traverseEntity((e=>{var t;(e instanceof woe||e instanceof uoe)&&null!==(t=e.frame)&&void 0!==t&&t.traverse((e=>{n(e)})),n(e)}))}disconnect(){this.onResizeObserver.disconnect(),this.breakpoints.forEach((e=>{e.disconnect()})),this.breakpoints=[]}},Dpe=class extends ude{constructor(e,t){super(e),this.eventManager=t,this.userAPIs={},this.events=[],this.onSuccess=e=>{let{userAPIId:t}=e;this.events.forEach((e=>{e.data.userAPIId===t&&e.dispatchSuccess()}))},this.onError=e=>{let{userAPIId:t}=e;this.events.forEach((e=>{e.data.userAPIId===t&&e.dispatchError()}))},this.userAPIs=e.sharedAssets.getUserAPIs()}connect(){this.eventContext.page.traverseEntity((e=>{var t;null===(t=e.data)||void 0===t||t.events.filter((e=>"API"===e.data.type&&!e.data.disabled)).forEach((t=>{this.events.push(new Ipe(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))}))})),Object.entries(this.userAPIs).forEach((e=>{let[t,r]=e;r.on("success",this.onSuccess),r.on("error",this.onError),r.autostart&&r.callUserAPI(this.eventContext.sharedAssets)}))}disconnect(){Object.entries(this.userAPIs).forEach((e=>{let[t,r]=e;r.off("success",this.onSuccess),r.off("error",this.onError)}))}},Ipe=class{constructor(e,t,r,n,i,s){this.id=e,this.data=t,this.object=r,this.successActions=uhe(t,t.successActions,n,i,s,r),this.errorActions=uhe(t,t.errorActions,n,i,s,r)}dispatchSuccess(){this.dispatchActions(this.successActions)}dispatchError(){this.dispatchActions(this.errorActions)}dispatchActions(e){e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}},Ope=class extends ude{constructor(e,t){super(e),this.eventManager=t,this.userWebhooks={},this.events=[],this.onMessage=e=>{let{userWebhookId:t}=e;this.events.forEach((e=>{e.data.userWebhookId===t&&e.dispatch()}))},this.userWebhooks=e.sharedAssets.getUserWebhooks()}connect(){this.eventContext.page.traverseEntity((e=>{var t;null===(t=e.data)||void 0===t||t.events.filter((e=>"WEBHOOK"===e.data.type&&!e.data.disabled)).forEach((t=>{this.events.push(new Rpe(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))}))})),Object.entries(this.userWebhooks).forEach((e=>{let[t,r]=e;r.connect(),r.on("message",this.onMessage)}))}disconnect(){Object.entries(this.userWebhooks).forEach((e=>{let[t,r]=e;r.off("message",this.onMessage),r.disconnect()}))}},Rpe=class{constructor(e,t,r,n,i,s){this.id=e,this.data=t,this.object=r,this.actions=uhe(t,t.actions,n,i,s,r)}dispatch(){let e=this.actions;e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}};var Lpe=new PB(0,0,1),Npe=new PB,Bpe=new PB,zpe=new tB,Fpe=class{constructor(e,t,r,n,i){this.containerScene=e,this.raycaster=t,this.sharedAssets=r,this.requestRender=n,this.onExit=i,this.htmlInput=null,this.virtualInput=null,this.helper=new eae,this.doubleClickHandler=new Tpe,this.isDragging=!1,this.plane=new LF,this.caretInterval=0,this.planeIntersection=new PB,this.projected=new eB,this._lastIndex=0,this._isFirstDragMove=!1,this.selectionOnDragStart=0,this.onTextMaterialChanged=()=>{var e;let t=null===(e=this.virtualInput)||void 0===e?void 0:e.data;if(void 0!==this.virtualInput&&t){let e=t.material,r=function(e,t){let r=V0.fromHex(3223857),n=.8;for(let i of e.layers){if("light"===i.data.type||"displace"===i.data.type||"fresnel"===i.data.type||"matcap"===i.data.type||"texture"===i.data.type||"toon"===i.data.type||"outline"===i.data.type||"transmission"===i.data.type||"noise"===i.data.type)continue;let e="string"==typeof i.data.alpha?Number(t.getVariable(i.data.alpha)):i.data.alpha;if("color"===i.data.type&&e>.3){r=nae(i.data.color,t),n=e;break}if(("depth"===i.data.type||"gradient"===i.data.type)&&e>.3){let e=iae(i.data);r={r:e[0],g:e[1],b:e[2]},n="string"==typeof i.data.alpha?1:i.data.alpha;break}}return u(u({},r),{},{a:n})}("string"==typeof e?this.sharedAssets.data.materials[e]:e,this.sharedAssets);this.helper.setCaretColor(r)}},this.stopAnimateTextCursor=()=>{clearInterval(this.caretInterval),this.helper&&(this.helper.caretMesh.visible=!1)},this.startAnimateTextCursor=()=>{this.stopAnimateTextCursor(),this.helper&&(this.helper.caretMesh.visible=!0,this.caretInterval=setInterval((()=>{this.helper&&(this.helper.caretMesh.visible=!this.helper.caretMesh.visible),this.requestRender()}),600))},this.handleCaretUpdate=e=>{if(!this.htmlInput||!this.virtualInput)return;let t=this.helper,r="ArrowLeft"===(null===e||void 0===e?void 0:e.key)||"ArrowRight"===(null===e||void 0===e?void 0:e.key),n="ArrowUp"===(null===e||void 0===e?void 0:e.key)||"ArrowDown"===(null===e||void 0===e?void 0:e.key);this.htmlInput.selectionStart===this.htmlInput.selectionEnd?(t.setCaretPosition(this.htmlInput.selectionStart,{horizontalKeyMove:r,verticalKeyMove:n}),this.startAnimateTextCursor()):t.setSelection(this.htmlInput.selectionStart,this.htmlInput.selectionEnd),this.requestRender()},this.containerScene.add(this.helper)}createInput(){return this.htmlInput=function(){let e=document.createElement("textarea");return e.style.position="fixed",e.style.top="200px",e.style.left="400px",e.style.zIndex="-1",e.style.border="1px solid rgba(255,0,0,0.5)",e.style.width="10px",e.style.height="500px",e.style.color="white",e.style.opacity="0.5",e.style.background="transparent",e.style.display="none",e.style.margin="0px",e.style.padding="0px",e.style.boxSizing="content-box",e.style.pointerEvents="none",e}(),this.htmlInput}connect(){}disconnect(){var e;this.stopAnimateTextCursor(),this.helper.hide(),null!==(e=this.htmlInput)&&void 0!==e&&e.remove(),this.doubleClickHandler.stop()}handleMouseDown(){var e,t;if(!this.htmlInput||!this.virtualInput)return!0;this.getPointOnPlane();let r=this.doubleClickHandler.clickCount,{index:n,lineIndex:i,characterIndex:s}=null!==(e=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,r>1?"inside":"previous"))&&void 0!==e?e:{index:0,lineIndex:0,characterIndex:0};null!==(t=this.virtualInput)&&void 0!==t&&null!==(t=t.wrappedText)&&void 0!==t&&t.length&&"\n"===this.virtualInput.wrappedText[i][Math.max(0,s-1)]&&(n--,s--),this._lastIndex=n,this._isFirstDragMove=!0;let a=this.checkClickedObject();if(1===r){if(null===a)return this.onExit(this.virtualInput),!0;this.selectionOnDragStart=n,this.isDragging=!0,this.setInputSelection(n)}else a===this.virtualInput&&(2===r?this.selectClosestWord(i,s):r>2&&(this.setInputSelection(0,this.htmlInput.value.length),this.doubleClickHandler.reset()))}handleMouseUp(){this.applyRangeToTextInput(),this.isDragging=!1,this._isFirstDragMove=!1}handleMouseMove(){!this.virtualInput||(this._isFirstDragMove&&this.doubleClickHandler.clickCount>1&&(this.selectionOnDragStart=this._lastIndex,this.isDragging=!0,this.setInputSelection(this._lastIndex)),this._isFirstDragMove=!1,this.getPointOnPlane(),this.applyRangeToTextInput())}focus(e){if(this.virtualInput=e,this.updateTextInputStyles(),this.htmlInput)if(e){var t,r;let e=null===(t=this.data)||void 0===t?void 0:t.geometry.text;this.htmlInput.value="string"==typeof e?"":null!==(r=null===e||void 0===e?void 0:e.textValue.toString())&&void 0!==r?r:""}else this.htmlInput.value=""}blur(){}get data(){let{virtualInput:e}=this;if(e)return e.dataPatched}applyRangeToTextInput(){var e,t;if(!this.isDragging||!this.virtualInput||!this.htmlInput)return;let r=this.selectionOnDragStart,{index:n,lineIndex:i,characterIndex:s}=null!==(e=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,this.doubleClickHandler.clickCount>2?"inside":"previous"))&&void 0!==e?e:{index:0};void 0!==i&&void 0!==s&&"\n"===(null===(t=this.virtualInput)||void 0===t?void 0:t.wrappedText[i][s-1])&&n--,this.htmlInput.setSelectionRange(Math.min(r,n),Math.max(r,n))}checkClickedObject(){if(this.virtualInput){let e=this.raycaster.intersectObject(this.virtualInput,!1);if(e.length>0){let t=e[0];if(t.object instanceof poe)return t.object}}return null}selectClosestWord(e,t){if(!this.virtualInput)return;let r=this.virtualInput.wrappedText,n=r[e],i=t+1,s=t;" "!==n[t]&&(i=this.findNextCharOccurence(n,t,"forward"," "),s=this.findNextCharOccurence(n,t,"backward"," "),s>0&&s++,i>=n.length-1&&e===r.length-1&&i++);let a=this.helper,o=a.getGlobalIndexFromLineAndCharIndexes(r,e,s),l=a.getGlobalIndexFromLineAndCharIndexes(r,e,i);this.setInputSelection(o,l)}findNextCharOccurence(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" ",i=Math.max(0,e.length-1),s="forward"===r?i:0,a="forward"===r?1:-1,o=Math.max(Math.min(t,i),0);for(;o!==s;)if(o+=a,e.charAt(o)===n)return o;return s}getPointOnPlane(){var e;let t=null===(e=this.virtualInput)||void 0===e?void 0:e.data;if(this.virtualInput&&t&&this.raycaster.ray.intersectsPlane(this.plane)){null===this.planeIntersection&&(this.planeIntersection=new PB);let e=this.raycaster.ray.intersectPlane(this.plane,this.planeIntersection);if(e){this.planeIntersection.copy(this.virtualInput.worldToLocal(e));let r="number"==typeof t.geometry.width?t.geometry.width:1,n="number"==typeof t.geometry.height?t.geometry.height:1;this.projected.set(e.x+.5*r,e.y-.5*n)}}}updatePlane(){var e;let t=null===(e=this.virtualInput)||void 0===e?void 0:e.data;this.virtualInput&&t&&(zpe.getNormalMatrix(this.virtualInput.matrixWorld),Npe.copy(Lpe).applyMatrix3(zpe).normalize(),this.virtualInput.localToWorld(Bpe.set(0,0,t.geometry.depth)),this.plane.setFromNormalAndCoplanarPoint(Npe,Bpe))}setInputSelection(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;null!==(t=this.htmlInput)&&void 0!==t&&t.setSelectionRange(e,r),setTimeout((()=>{var e;null===(e=this.htmlInput)||void 0===e||e.focus()}))}updateTextInputStyles(){var e;let t=null===(e=this.virtualInput)||void 0===e?void 0:e.data;this.virtualInput&&t&&this.htmlInput&&(this.htmlInput.style.fontSize=t.geometry.fontSize+"px",this.htmlInput.style.letterSpacing=t.geometry.letterSpacing*t.geometry.fontSize+"px",this.htmlInput.style.lineHeight=t.geometry.fontSize*t.geometry.lineHeight+"px",this.htmlInput.style.width=t.geometry.width+"px",this.htmlInput.style.height=t.geometry.height+"px",this.htmlInput.style.textAlign=function(e){return 4===e?"justify":2===e?"right":3===e?"center":"left"}(t.geometry.horizontalAlign))}};var jpe=(e,t)=>{if("string"==typeof e){let r=t.data(e);if(r)return jpe(r.value,t)}return m2.getDisplayedValue(e)};function Upe(e,t){let r=e.text,n="";if("string"==typeof r){let e=t.variables.data(n);e&&(n=jpe(e.value,t.variables))}else n=r.textValue.toString();return n}var Vpe=class extends ude{constructor(e,t){super(e),this.eventManager=t,this._textInputs=[],this.sceneHelpers=new yV,this.helper=new eae,this._onMouseDownFocusIn=e=>{if(PZ.length>1)return;this.eventContext.updateRaycaster(e);let t=null;if(this.eventContext.raycaster)for(let r of this._textInputs)if(this.eventContext.raycaster.intersectObject(r,!0).length>0){t=r;break}this.focusOnTextInput(t),this._onCaretUpdate(),this._onMouseUp(),this.textInputManager.doubleClickHandler.start(this.eventContext.domElement),this.textInputManager.doubleClickHandler._onMouseDown(e),this._onMouseDown(e)},this.onExit=()=>{let{virtualInput:e}=this.textInputManager;if(null===e)return;let t=this.textInputManager.htmlInput;this.helper.hide(),null!==t&&void 0!==t&&t.setSelectionRange(t.value.length,t.value.length),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0);let{domElement:r}=this.eventContext;r.removeEventListener("pointerdown",this._onMouseDown,!1),r.removeEventListener("pointerup",this._onMouseUp,!1),r.removeEventListener("pointermove",this._onMouseMove,!1),window.removeEventListener("keydown",this._onKeyPress),this.textInputManager.doubleClickHandler.reset(),r.addEventListener("pointerdown",this._onMouseDownFocusIn),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers()},this._onMouseDown=e=>{this.eventContext.updateRaycaster(e),this.textInputManager.handleMouseDown(),this.textInputManager.virtualInput&&this.eventContext.raycaster.intersectObject(this.textInputManager.virtualInput,!0).length>0&&this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1)},this._onMouseUp=()=>{this.textInputManager.handleMouseUp(),this.eventManager.controlsManager.orbitControls&&!this.eventManager.controlsManager.orbitControls.enabled&&(this.eventManager.controlsManager.orbitControls.enabled=!0)},this._onMouseMove=e=>{this.eventContext.updateRaycaster(e),this.textInputManager.handleMouseMove()},this._onTextEdit=e=>{let{htmlInput:t,virtualInput:r,helper:n}=this.textInputManager;if(!t||!r)return;let i=t.value;r.textGeometry.setText(i).then((()=>{this.eventContext.requestRender()}));let s=r.data;n.update();let a=s.geometry.text;if("string"==typeof a){let e=a;this.eventContext.sharedAssets.updateVariable(e,{textValue:i})}this.textInputManager.updateTextInputStyles(),this._onCaretUpdate()},this._onCaretUpdate=e=>{this.textInputManager.handleCaretUpdate(e)},this._onKeyPress=e=>{"Escape"===e.key&&this.onExit()},this.textInputManager=new Fpe(this.sceneHelpers,e.raycaster,e.sharedAssets,e.requestRender,this.onExit)}connect(){let e=[];if(this.eventContext.scene.traverseEntity((t=>{t instanceof poe&&e.push(t)})),this._textInputs=e,0===e.length)return;let{domElement:t}=this.eventContext;t.addEventListener("pointerdown",this._onMouseDownFocusIn),this.textInputManager.connect();let r=this.textInputManager.createInput();document.body.appendChild(r),r.style.display="none",r.addEventListener("keyup",this._onCaretUpdate),r.addEventListener("keydown",this._onCaretUpdate),r.addEventListener("beforeinput",this._onCaretUpdate),r.addEventListener("paste",this._onCaretUpdate),r.addEventListener("cut",this._onCaretUpdate),r.addEventListener("select",this._onCaretUpdate),r.addEventListener("selectstart",this._onCaretUpdate)}disconnect(){let e=this.textInputManager.htmlInput,{domElement:t}=this.eventContext;t.removeEventListener("pointerdown",this._onMouseDownFocusIn),null!==e&&void 0!==e&&e.removeEventListener("keyup",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("keydown",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("beforeinput",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("paste",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("cut",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("select",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("selectstart",this._onCaretUpdate),this._textInputs.forEach((e=>{let t=Upe(e.data.geometry,this.eventContext.sharedAssets.data);e.textGeometry.setText(t)})),t.removeEventListener("pointerdown",this._onMouseDown,!1),t.removeEventListener("pointerup",this._onMouseUp,!1),t.removeEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers(),this.textInputManager.disconnect()}focusOnTextInput(e){this.textInputManager.focus(e),this.textInputManager.onTextMaterialChanged();let t=this.textInputManager.htmlInput;if(!t||null===e)return;this.textInputManager.updateTextInputStyles(),this.eventContext.renderer.sceneHelpersOnTop=this.sceneHelpers,this.eventContext.renderer.pipeline.enableHelpers(),this.textInputManager.isDragging=!1;let r=Upe(e.textGeometry.userData.parameters,this.eventContext.sharedAssets.data);t.value=r,t.setSelectionRange(0,0),this.textInputManager.helper.show(e),t.style.display="block",t.addEventListener("input",this._onTextEdit),this.textInputManager.updatePlane();let{domElement:n}=this.eventContext;n.removeEventListener("pointerdown",this._onMouseDownFocusIn),n.addEventListener("pointerdown",this._onMouseDown,!1),n.addEventListener("pointerup",this._onMouseUp,!1),n.addEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress)}},Hpe=class extends ude{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.onVoice=e=>{let{value:t,frequencies:r}=e;this.events.forEach((e=>{e.dispatch()}))}}connect(){this.openAIRealtime=this.eventContext.sharedAssets.openAIRealtime,this.openAIRealtime&&(this.eventContext.page.traverseEntity((e=>{var t;null===(t=e.data)||void 0===t||t.events.filter((e=>"AIAssistantListener"===e.data.type&&!e.data.disabled)).forEach((t=>{this.events.push(new Wpe(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))}))})),this.openAIRealtime.on("voice",this.onVoice))}disconnect(){var e;null===(e=this.openAIRealtime)||void 0===e||e.off("voice",this.onVoice)}},Wpe=class{constructor(e,t,r,n,i,s){this.id=e,this.data=t,this.object=r,this.actions=uhe(t,t.actions,n,i,s,r)}dispatch(){this.dispatchActions(this.actions)}dispatchActions(e){e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}},Gpe=class extends ude{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.onTriggerEvent=e=>{let{description:t,direction:r}=e,n=this.events.find((e=>e.data.description===t));n&&("backward"===r?n.dispatchReverse():n.dispatch())}}connect(){this.openAIRealtime=this.eventContext.sharedAssets.openAIRealtime,this.openAIRealtime&&(this.eventContext.page.traverseEntity((e=>{var t;null===(t=e.data)||void 0===t||t.events.filter((e=>"AIAssistantTrigger"===e.data.type&&!e.data.disabled)).forEach((t=>{this.events.push(new qpe(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))}))})),this.openAIRealtime.on("trigger_event",this.onTriggerEvent))}disconnect(){var e;null===(e=this.openAIRealtime)||void 0===e||e.off("trigger_event",this.onTriggerEvent)}},qpe=class{constructor(e,t,r,n,i,s){this.id=e,this.data=t,this.object=r,this.actions=uhe(t,t.actions,n,i,s,r)}dispatch(){let e=this.actions;e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}dispatchReverse(){let e=this.actions;e.Transition.forEach((e=>e.reverseFromCurrent())),e.Particles.forEach((e=>e.reverseFromCurrent())),e.Animation.forEach((e=>e.reverseFromCurrent())),e.SwitchCamera.forEach((e=>e.reverseFromCurrent())),e.Create.forEach((e=>e.dispatchStop()))}},Xpe=class{constructor(e,t,r,n,i){this.publish=e,this.controlsManager=t,this.animationControls=r,this.eventContext=n,this.sharedVariables=i,this.isEnabled=!1,this.activateCount=0,this.needsMouse=!1,this.needsRaycast=!1,this.onTouchMovePreventScroll=e=>{let t=window.parent!==window,r=document.documentElement.scrollHeight>document.documentElement.clientHeight||document.documentElement.scrollWidth>document.documentElement.clientWidth;(e.touches.length>1||this.preventTouchScroll||!1===t&&!1===r)&&e.preventDefault()},this.onMouseWheelPreventScroll=e=>{this.preventScroll&&e.preventDefault()},this.onMouseMove=e=>{this.eventContext.sharedAssets.mouseProperty=u(u({},this.getMousePosition(e)),{},{pressed:e.buttons>0})},this.onMouseDown=e=>{this.eventContext.sharedAssets.mouseProperty=u(u({},this.getMousePosition(e)),{},{pressed:!0})},this.onMouseUp=e=>{this.eventContext.sharedAssets.mouseProperty=u(u({},this.getMousePosition(e)),{},{pressed:!1})},this.getMousePosition=e=>{var t;let{domRect:r}=this.eventContext,{pageX:n,pageY:i}=(null===(t=e.touches)||void 0===t?void 0:t.length)>0?e.touches[0]:e;return{x:n-(r.left+window.scrollX),y:i-(r.top+window.scrollY)}},this.stopRaycast=e.stopRaycast,this.preventScroll=e.preventScroll,this.preventTouchScroll=e.preventTouchScroll,this.hideCursor=e.hideCursor,this.requestRender=n.requestRender}activate(){var e,t;let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEnabled)return;this.isEnabled=!0,this.initializeActionsDependentStates(),this.needsMouse&&(this.eventContext.domElement.addEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.addEventListener("pointerdown",this.onMouseDown)),this.handlers={Spline:new mde(this.eventContext),VariableChange:new Cfe(this.eventContext,this.sharedVariables,this,this.needsMouse,this.needsRaycast),API:new Dpe(this.eventContext,this),WEBHOOK:new Ope(this.eventContext,this),AIAssistantListener:new Hpe(this.eventContext,this),AIAssistantTrigger:new Gpe(this.eventContext,this),Conditional:new _de(this.eventContext,this),Start:new Sfe(this.eventContext,this),Basic:new vde(this.eventContext,this,this.needsRaycast),MouseHover:new vfe(this.eventContext,this),Scroll:new wfe(this.eventContext,this),Follow:new Zde(this.eventContext,this),DragDrop:new Ude(this.eventContext,this),LookAt:new dfe(this.eventContext),Resize:new kpe(this.eventContext,this),Textfields:new Vpe(this.eventContext,this)};let{page:n,domElement:i}=this.eventContext;this.hideCursor&&(i.style.cursor="none"),n.traverseEntity((e=>{e.addEventListener("requestRender",this.requestRender)})),Object.values(this.handlers).forEach((e=>e.connect())),i.addEventListener("wheel",this.onMouseWheelPreventScroll),i.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++,r||(null!==(e=this.eventContext.sharedAssets.openAIRealtime)&&void 0!==e&&e.connect(),null===(t=this.eventContext.sharedAssets.openAIRealtime)||void 0===t||t.start())}deactivate(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isEnabled)return;this.isEnabled=!1,this.eventContext.domElement.removeEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.removeEventListener("pointerdown",this.onMouseDown),this.eventContext.domElement.removeEventListener("pointerup",this.onMouseUp),this.eventContext.sharedAssets.mouseProperty=null,this.eventContext.sharedAssets.raycastProperty=null;let{page:r,domElement:n}=this.eventContext;if(n.style.cursor="",Object.values(this.handlers).forEach((e=>e.disconnect())),null!==(e=this.controlsManager.gameControl)&&void 0!==e&&e.disposeActions(),this.controlsManager.disconnectEvents(),r.traverseEntity((e=>{e.removeEventListener("requestRender",this.requestRender),e.destroyedInAction=!1})),n.removeEventListener("touchmove",this.onTouchMovePreventScroll),n.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode(),!t){let e=this.eventContext.sharedAssets.openAIRealtime;null!==e&&void 0!==e&&e.disconnect(),null===e||void 0===e||e.stop().then((()=>{null===e||void 0===e||e.disconnect()}))}}get isPaused(){return this.isEnabled}pause(){this.deactivate()}resume(){this.activate()}reset(){this.deactivate(!0),this.activate(!0),this.controlsManager.deactivate(),this.controlsManager.activate(this),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(e){let t=this.isEnabled;t&&this.deactivate(),this.eventContext.useWindowEvents=e,t&&this.activate()}initializeActionsDependentStates(){let e=this.eventContext.sharedAssets;e.resetDynamicVariablePlayState();let t=r=>{if("Conditional"===r.data.type&&(r.data.ifActions.forEach(t),r.data.elseActions.forEach(t)),"Conditional"===r.data.type||"SetVariable"===r.data.type)for(let e of"Conditional"===r.data.type?r.data.condition:r.data.expression)"id"in e&&Array.isArray(e.id)&&("mouse"===e.id[0]&&(this.needsMouse=!0),"raycast"===e.id[0]&&(this.needsRaycast=!0));"DynamicVariablePlay"===r.data.type&&""!==r.data.variableId&&("Play"===r.data.mode||"PlayPause"===r.data.mode||"Toggle"===r.data.mode)&&e.setDynamicVariablePlayState(r.data.variableId,"Stopped")};this.eventContext.page.traverseEntity((e=>{var r;if(null!==(r=e.data)&&void 0!==r&&r.events.length)for(let n of e.data.events)if("VariableChange"===n.data.type&&("mouseProperty"===n.data.variableId&&(this.needsMouse=!0),"raycastProperty"===n.data.variableId&&(this.needsRaycast=!0)),"Conditional"===n.data.type)for(let e of["inActions","outActions"])n.data[e].forEach(t);else if("DragDrop"===n.data.type)for(let e of["drag","drop"])n.data.dragDropActions[e].forEach(t);else if("GameControl"===n.data.type)for(let e of["idle","move","jump","run"])n.data.gameActions[e].forEach(t);else if("Resize"===n.data.type)for(let e of n.data.breakpoints)e.data.actions.forEach(t);else"LookAt"===n.data.type||"API"===n.data.type||n.data.actions.forEach(t)}))}},Ype=class{constructor(e,t,r,n,i){this._aspect=1,this.enableResponsive=!1,this._renderer=e,this._camera=t,this._frameSize=(new eB).copy(r),this._editorSize=(new eB).copy(n),this._aspect=t.aspect,this._fov=null!==i&&void 0!==i?i:t.fov}set frameSize(e){this._frameSize.copy(e)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||"PerspectiveCamera"!==this._camera.cameraType)return;let e=this._frameSize.x,t=this._frameSize.y,r=this._editorSize.y;this._aspect=e/t,t<=r&&(this._camera.zoom*=r/t),this._renderer.setViewport(0,0,e,t)}updateCamera(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this._camera)if("PerspectiveCamera"===this._camera.cameraType){let t=this._frameSize.y,r=this._editorSize.y,n=this._fov;if(e&&t>r){let e=function(e,t,r,n,i){return(e-t)/(r-t)*(i-n)+n}(t,1080,2160,1,15)/100;n*=t/r,n*=1-e}this._camera.aspect=this._aspect,this._camera.fov=n,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(e){this._camera=e,this._aspect=e.aspect,this._fov=e.fov}revert(){let e=window.innerWidth,t=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,e,t),this._renderer.setSize(e,t)),this._camera&&(this._camera.aspect=e/t,this._camera.fov=this._fov,this._camera.setViewplaneSize(e,t,this.enableResponsive),this._camera.updateProjectionMatrix())}};var Kpe=class{get sharedAssets(){return this.shared}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.shared=new Cre(e.shared,t,!0,r),this.scene=new _le(e.scene,this.sharedAssets),this.shared.setEntityOpContext({scene:this.scene,shared:this.shared})}reset(e,t){this.scene.clearScene(),this.sharedAssets.reset(e.shared),this.scene.resetAfterClear(e.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let e of this.scene.children)e instanceof uoe&&!e.uiScene&&e.personalCamera.updateState(e.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity((e=>{e instanceof Dre&&e.markGeometryAsReachable(this.shared)})),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},Qpe=class{constructor(e){let{x:t=10,y:r=10}=e;this._startTime=0;let n=document.getElementById("spe-perfs");n?this.element=n:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left="".concat(t,"px"),this.element.style.top="".concat(r,"px")}dispose(){var e;null===(e=this.element.parentElement)||void 0===e||e.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let e=performance.now()-this._startTime;this.element.innerHTML=e.toFixed(3)+" ms"}};function Zpe(e){let t;if(e.index)for(let r=0;r<e.index.array.length;r+=3)t=e.index.array[r],e.index.array[r]=e.index.array[r+2],e.index.array[r+2]=t}function Jpe(e){return e instanceof Bre?"SubdivObject":"NonParametricGeometry"===e.geometry.type?"NonParametric":"Mesh"}function $pe(e,t){let r=function(e,t){let r={};return e.traverseEntity((e=>{if(!e.visible||!(e instanceof z9)||"Mesh"!==e.type||Array.isArray(e.material)||e.states&&Object.keys(e.states).length)return;let n=e.parent;for(;n;){if(n instanceof z9&&e.states&&Object.keys(e.states).length)return;n=n.parent}let i=e.material.uuid,s=t.shared.materials[i];if(s){if(!_1.isMergable(s))return}else{var a;let r=null===(a=t.scene.objects.get(e.uuid))||void 0===a?void 0:a.data;if(r&&"material"in r&&"string"!=typeof r.material){if(!_1.isMergable(r.material))return;i=_1.getHash(r.material)}}r[i]||(r[i]={});let o=r[i][Jpe(e)];if(o){if(o.push(e),e.cloner)for(let t of e.cloner.children)o.push(t)}else if(r[i][Jpe(e)]=[e],e.cloner)for(let t of e.cloner.children)r[i][Jpe(e)].push(t)})),r}(t,e),n=function(e){let t=0;return Object.values(e).forEach((e=>{Object.values(e).forEach((e=>{let r=e.length;r>t&&(t=r)}))})),t}(r),i=new Array(n),s=0,a=new Array(n),o=0,l=new Array(n),c=0,u=new Array(n),h=0;for(let[d,f]of Object.entries(r))for(let e of Object.values(f)){if(o=0,c=0,e.forEach((e=>{e instanceof z9&&(a[o++]=e.geometry.clone(),l[c++]=e)})),c<2)continue;for(let e=0;e<c;e++)l[e].updateWorldMatrix(!0,!1),a[e].applyMatrix4(l[e].matrixWorld),l[e].matrixWorld.determinant()<0&&Zpe(a[e]);let n=h3(a.slice(0,o),!1);if(n){let e;if("SubdivObject"===d)console.warn("Turning subdiv object into mesh"),e=new yF(n,l[0].material);else e=new yF(n,l[0].material);e.castShadow=l[0].castShadow,e.receiveShadow=l[0].receiveShadow,t.add(e);let a=e=>{h=0;for(let t of e)t.children&&a(t.children),t instanceof z9&&(Array.isArray(t.material)||r[t.material.uuid]&&r[t.material.uuid][Jpe(t)]&&r[t.material.uuid][Jpe(t)].length>1||(u[h++]=t));for(let r=0;r<h;r++)t.attach(u[r])};for(let t=0;t<c;t++){let e=l[t];a(e.children),i[s++]=e}}}for(let d=0;d<s;d++)i[d].removeFromParent()}var eme=yL(AL(),1),tme=new eB;var rme=class{constructor(e){let{renderOnDemand:t,renderMode:r="auto"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._variablesCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=e=>{var t,r,n,i,s,a,o,l,c,u,h,d;if(this.time=e,this._lastTime&&(this.dt=this.time-this._lastTime),this._lastTime=this.time,null!==(t=this._perfs)&&void 0!==t&&t.start(),this._renderer)if(this._isPaused||!("manual"===this.renderMode&&!this._renderRequested||"auto"===this.renderMode&&this._skipRender)){if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&(null!==(r=this._eventManager.handlers)&&void 0!==r&&r.Start.hasVideoAction||null!==(n=this._eventManager.handlers)&&void 0!==n&&n.Basic.hasVideoAction||null!==(i=this._eventManager.handlers)&&void 0!==i&&i.Conditional.hasVideoAction)&&(this._skipRender=!1),null!==(s=this._animationControls)&&void 0!==s&&s.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,null!==(a=this._scene)&&void 0!==a&&a.traverseVisibleEntity((e=>{"ParticleSystem"===e.type&&(e.update(this.dt),this._skipRender=!1)})),this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),null!==(o=this._eventManager)&&void 0!==o&&o.isEnabled&&((null===(l=this._eventManager.handlers)||void 0===l?void 0:l.Follow).onAnimationFrameDamping(),(null===(c=this._eventManager.handlers)||void 0===c?void 0:c.LookAt).onAnimationFrameDamping(),(null===(u=this._eventManager.handlers)||void 0===u?void 0:u.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let e=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=e,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),null===(h=this._perfs)||void 0===h||h.end()}else{var f;null===(f=this._perfs)||void 0===f||f.end()}else null===(d=this._perfs)||void 0===d||d.end()},this._resize=e=>{if(this._renderer){var t,r,n,i,s,a,o,l;if(1===this._viewportMode&&this._frameView&&(this._frameView.frameSize=tme.set(this._viewportWidth,this._viewportHeight)),e){let e=this._viewportWidth,t=this._viewportHeight;this._renderer.setSize(e-1,t-1,!1),this._renderer.setSize(e,t,!1)}else this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1);if(this._camera=null===(t=this._scene)||void 0===t?void 0:t.activeCamera,null!==(r=this._scene)&&void 0!==r&&r.updateViewPlaneSize(null!==(n=null===(i=this._frameView)||void 0===i||null===(i=i.frameSize)||void 0===i?void 0:i.x)&&void 0!==n?n:this._viewportWidth,null!==(s=null===(a=this._frameView)||void 0===a||null===(a=a.frameSize)||void 0===a?void 0:a.y)&&void 0!==s?s:this._viewportHeight,null!==(o=null===(l=this._frameView)||void 0===l?void 0:l.enableResponsive)&&void 0!==o&&o),this._camera){var c,u,h,d,f;let e=null!==(c=Object.values(null!==(u=null===(h=this._data)||void 0===h?void 0:h.frames)&&void 0!==u?u:{})[0].preset)&&void 0!==c?c:"fullscreen";null!==(d=this._frameView)&&void 0!==d&&d.setCamera(this._camera),null!==(f=this._frameView)&&void 0!==f&&f.updateCamera("fullscreen"!==e),"PerspectiveCamera"===this._camera.cameraType&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()}this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect()),this._requestRenderAutoMode()}},this._debouncedResize=eZ(this._resize,10),this._onScroll=e=>{this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect())},this.canvas=e,this.renderMode=t?"auto":r,this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new Qpe({x:10,y:10})),function(e){e.addEventListener("pointerdown",OZ,!0),e.addEventListener("pointerdown",LZ,!0),e.addEventListener("pointermove",LZ,!0),e.addEventListener("pointerup",RZ,!0),e.addEventListener("pointercancel",RZ,!0),e.addEventListener("pointerleave",RZ,!0),window.addEventListener("keydown",BZ,!0),window.addEventListener("keyup",zZ,!0)}(e)}async load(e,t,r){(function(e){let t="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";e.endsWith(".spline")?console.warn(t+" The .spline files are only meant to be used by the Editor."):e.endsWith(".splinecode")||console.warn(t)})(e),this.disposed=!1;let n=await(await fetch(e,r)).arrayBuffer();await this.start(n,{variables:t})}async start(e){var t,r,n,i,s;let{interactive:a=!0,variables:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.disposed)return;let l=await async function(e,t){let[r,n]=OJ(t0.deserialize(new Uint8Array(e)));return u3(r),t&&t(r),n.result().data}(e);this._data=l;let c=function(e){let t=[];return e.scene.objects.traverse(((e,r)=>{"Mesh"===r.type&&"NonParametricGeometry"===r.geometry.type&&void 0!==r.geometry.data.draco&&t.push(r)})),t}(l);l.version&&(0,eme.default)(l.version,"1.9.59")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([c.length&&(xpe||(xpe=new Epe).setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload(),xpe.decoderPending),Vne(l)&&x9(),Nre(l)&&Q8(),u2.physicsEnabled(l.scene.objects)&&qZ(),rne(l)&&Fte(),dle(l)&&ble(),Dte(l)&&kte(),Pae(l)&&Tae(),Lfe(l)&&VZ()].filter(Boolean)),c.length&&await async function(e){for(let t of e){let e=await Mpe(t.geometry.data.draco);if(e){let r=t.geometry.data;e.index&&(r.index={array:e.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let n={};e.attributes.forEach((e=>{let{name:t,array:r,itemSize:i}=e;n[t]={array:r,itemSize:i,type:"Float32Array",normalized:!1}})),r.attributes=n,r.draco=void 0}}}(c),null!==(t=this._eventManager)&&void 0!==t&&t.deactivate(),null!==(r=this._controls)&&void 0!==r&&r.deactivate(),null===(n=this._scene)||void 0===n||n.dispose();let u=new Kpe(l);if(u.resetPersonalCameraFromDocumentData(),this._scene=u.scene,this._sharedAssetsManager=u.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let e=performance.now();$pe(l,u.scene);let t=performance.now();console.log("Merged geometries in ",t-e," ms")}Vne(l)&&this._scene.traverse((e=>{Xne(e)&&e.recomputeBoolean()})),this._sharedAssetsManager.setRequestRender((()=>{var e;this._requestRenderAutoMode(),null===(e=this._scene)||void 0===e||e.traverse((e=>{e instanceof wne&&e.pendingMediaLoad&&e.update()}))})),null===(i=this._scene)||void 0===i||i.traverse((e=>{"ParticleSystem"===e.type&&(e.wakeUp(),e.data.autoPlay?e.start():e.stop())}));let h=Object.keys(l.shared.fonts).map((e=>this._sharedAssetsManager.getFont(e).loadingPromise));if(Promise.all(h).then((()=>{u.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()})),rne(l)&&function(e){if(u2.physicsEnabled(e.scene.objects))return!0;let t=!1;return e.scene.objects.traverse(((e,r)=>{if(r.events)if(Array.isArray(r.events)){for(let n of r.events)if(!0!==n.data.disabled&&"GameControl"===n.data.type&&n.data.collisionEnabled){t=!0;break}}else for(let n of Object.values(r.events))if(!0!==n.disabled&&"GameControl"===n.type&&n.collisionEnabled){t=!0;break}})),t}(l)&&await Promise.all(h),Pae(l)){let e=[];this._scene.traverseEntity((t=>{(t instanceof woe||t instanceof uoe)&&t.uiCanvas&&e.push(t.uiCanvas)})),await Promise.all(e.map((e=>e.promise)))}if(this._scene.rewriteEventsBeforeGoToPlayMode(),Vue(this._scene.activePage,this._sharedAssetsManager),!this._renderer&&(this._renderer=new Kse({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=!0===l.scene.publish.hdTransmission,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.enableUIOverlay(),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode),l.shared.images.SplineWatermark)){let e=this._sharedAssetsManager.getImage("SplineWatermark");await e.loadPromise;let t=e.getTexture(1001);this._renderer.pipeline.setWatermark(t)}dle(l)&&this._scene.initializeSplatViewer(),void 0!==l.scene.blueNoiseTextureData&&this._renderer.pipeline.updateBlueNoiseTexture(l.scene.blueNoiseTextureData);let d=Object.values(l.frames)[0];if(this._frameView?this._frameView.setCamera(this._camera):("fullscreen"===d.preset?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=d.size[0],this._viewportHeight=d.size[1],this.canvas.style.width="".concat(this._viewportWidth,"px"),this.canvas.style.height="".concat(this._viewportHeight,"px")),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new Ype(this._renderer,this._camera,new eB(this._viewportWidth,this._viewportHeight),new eB(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=null!==(s=d.allowResponsive)&&void 0!==s&&s&&"fullscreen"===d.preset),a){let e=new cde(this._renderer,this.data.scene.publish,this._scene,(()=>this._scene.activeCamera),this._sharedAssetsManager,this._requestRenderAutoMode,!0,d);this._scene.updateMatrixWorld(!0),this._controls=new bpe(e),this._animationControls=new _pe(this._scene,this._requestRenderAutoMode),this._eventManager=new Xpe(l.scene.publish,this._controls,this._animationControls,e,l.shared.variables),this._eventManager.activate(),this._controls.activate(this._eventManager)}this._resize(),this._scene.activePage.data.postprocessing.depthOfField.enabled&&Promise.all(this._sharedAssetsManager.getImageLoadPromises()).then((()=>{this._resize(!0)})),void 0!==o&&this.setVariables(o),0===this.dt&&(this.render(performance.now()),setTimeout((()=>{var e;null===(e=this._renderer)||void 0===e||e.setAnimationLoop(this.render)}),0)),this._resizeObserverTimeout=setTimeout((()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver((()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()})),this._resizeObserver.observe(this.canvas.parentElement))}),300),document.addEventListener("scroll",this._onScroll)}setVariables(e){if(void 0!==this._data){let t=Object.entries(e);for(let[e,r]of t)this.setVariable(e,r)}}setVariable(e,t){let r=this._getVariableByName(e);if(r&&!("dynamicVariableType"in r.data)){var n;let e=t;"number"==typeof r.data.value?e="number"==typeof t?t:"boolean"==typeof t?!0===t?1:0:parseFloat(t):"boolean"==typeof r.data.value?e="number"==typeof t?!!t:"boolean"==typeof t?t:"false"!==t.toLocaleLowerCase()&&!!t:"string"!=typeof r.data.value&&void 0!==r.data.value.textValue&&(e=t.toString());let i="string"==typeof e?{textValue:e}:e;null!==(n=this._sharedAssetsManager)&&void 0!==n&&n.updateVariable(r.id,i),this.requestRender(),this._requestRenderAutoMode()}else void 0===r?console.warn("No variable named ".concat(e," was found in your Spline file. Make sure to create it from Spline editor.")):"dynamicVariableType"in r.data&&console.warn("Dynamic variables like ".concat(e," cannot be updated from code."))}getVariables(){let e={};return this._data&&this._data.shared.variables.forEach((t=>{void 0===e[t.data.name]&&(e[t.data.name]=this._getVariableValue(this._sharedAssetsManager.getVariable(t.id)))})),e}getVariable(e){let t=this._getVariableByName(e);if(t){let e=this._sharedAssetsManager.getVariable(t.id);return this._getVariableValue(e)}}_getVariableValue(e){return"string"!=typeof e&&m2.isTextValue(e)?m2.getDisplayedValue(e):e}_getVariableByName(e){if(this._data){if(this._variablesCache.has(e))return this._variablesCache.get(e);let t=this._data.shared.variables.find((t=>t.data.name===e));return t&&this._variablesCache.set(e,t),t}}findObjectById(e){var t;let r=null===(t=this._scene)||void 0===t?void 0:t.getObjectByProperty("uuid",e);return this._createProxyObject(r)}findObjectByName(e){var t;let r=null===(t=this._scene)||void 0===t?void 0:t.getObjectByName(e);return this._createProxyObject(r)}getAllObjects(){var e;let t=[];return null!==(e=this._scene)&&void 0!==e&&e.traverseEntity((e=>{if(e.uuid!==t1&&!this._scene.isInvisibleObjects(e)&&!(e instanceof uoe)){let r=this._createProxyObject(e);r&&t.push(r)}})),t}getSplineEvents(){var e;return(null===(e=this._eventManager)||void 0===e||null===(e=e.handlers)||void 0===e?void 0:e.Spline).splineEvents}emitEvent(e,t){var r;null===(r=this.findObjectById(t)||this.findObjectByName(t))||void 0===r||r.emitEvent(e)}emitEventReverse(e,t){var r;null===(r=this.findObjectById(t)||this.findObjectByName(t))||void 0===r||r.emitEventReverse(e)}addEventListener(e,t){this.canvas.addEventListener(e,t)}removeEventListener(e,t){this.canvas.removeEventListener(e,t)}setZoom(e){var t,r;(null===(t=this._controls)||void 0===t?void 0:t.orbitControls)instanceof Zfe&&(null===(r=this._controls)||void 0===r||r.orbitControls.setZoom(e))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(e,t){this._viewportWidth=e,this._viewportHeight=t,this._viewportMode=2,this._resize()}setBackgroundColor(e){var t;let{r:r,g:n,b:i,a:s}={r:0,g:0,b:0,a:1},a=new X9(r,n,i,s);try{a.setStyle(e)}catch(o){console.error("This is not a valid css color",e)}null!==(t=this._scene)&&void 0!==t&&t.activePage.setBackgroundColor(a),this._requestRenderAutoMode()}dispose(){var e,t,r,n,i,s,a;this.disposed=!0,null!==(e=this._eventManager)&&void 0!==e&&e.deactivate(),null!==(t=this._scene)&&void 0!==t&&t.dispose(),null!==(r=this._sharedAssetsManager)&&void 0!==r&&r.dispose(),this._proxyObjectCache.forEach((e=>{dq.unsubscribe(e)})),this._variablesCache.clear(),null!==(n=this._renderer)&&void 0!==n&&n.setAnimationLoop(null),null!==(i=this._renderer)&&void 0!==i&&i.dispose(),this._renderer=void 0,null!==(s=this._sharedAssetsManager)&&void 0!==s&&s.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),void 0!==this._resizeObserverTimeout&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),null!==(a=this._controls)&&void 0!==a&&a.deactivate(),this.dt=0,function(e){e.removeEventListener("pointerdown",OZ,!0),e.removeEventListener("pointerdown",LZ,!0),e.removeEventListener("pointermove",LZ,!0),e.removeEventListener("pointerup",RZ,!0),e.removeEventListener("pointercancel",RZ,!0),e.removeEventListener("pointerleave",RZ,!0),window.removeEventListener("keydown",BZ,!0),window.removeEventListener("keyup",zZ,!0)}(this.canvas),document.removeEventListener("scroll",this._onScroll)}get isStopped(){return this._isPaused}stop(){var e,t,r;this._isPaused||(null!==(e=this._renderer)&&void 0!==e&&e.setAnimationLoop(null),this._isPaused=!0,null!==(t=this._eventManager)&&void 0!==t&&t.pause(),(null===(r=this._controls)||void 0===r?void 0:r.orbitControls)&&(this._controls.orbitControls.enabled=!1))}play(){var e,t,r;!this._isPaused||(this._isPaused=!1,null!==(e=this._eventManager)&&void 0!==e&&e.resume(),null!==(t=this._controls)&&void 0!==t&&t.orbitControls&&(this._controls.orbitControls.enabled=!0),null===(r=this._renderer)||void 0===r||r.setAnimationLoop(this.render))}setGlobalEvents(e){var t;null===(t=this._eventManager)||void 0===t||t.updateUseWindowEvents(e)}get data(){return this._data}_createProxyObject(e){var t;if(null==e)return;if(this._proxyObjectCache.has(e.uuid))return this._proxyObjectCache.get(e.uuid);let r;e.traverseAncestors((e=>{e instanceof uoe&&(r=e.name)}));let n={name:e.name,uuid:e.uuid,visible:e.visible,intensity:e.intensity,position:e.position,rotation:e.rotation,scale:e.scale,type:e.data.type,page:r,parentUuid:e.parent instanceof uoe||e instanceof _le||null===(t=e.parent)||void 0===t?void 0:t.uuid,emitEvent(t){e.dispatchEvent({type:"userEvent",eventName:t})},emitEventReverse(t){e.dispatchEvent({type:"userEvent",eventName:t,reverse:!0})}},i=dq(n,((t,r)=>{var n;"object"!=typeof e[t]&&null!==(n=Object.getOwnPropertyDescriptor(e,t))&&void 0!==n&&n.writable&&(e[t]=r),this._requestRenderAutoMode(),e.updateMatrix()}));return this._proxyObjectCache.set(e.uuid,i),i}setUIWasmUrl(e){wee.skiaWasmUrl=e}},nme=r(65);function ime(e){return t=>{e.forEach((e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)}))}}const sme=["className","children","debounceTime","ignoreDimensions","parentSizeStyles","enableDebounceLeadingCall","resizeObserverPolyfill"],ame=[],ome={width:"100%",height:"100%"},lme=(0,e.forwardRef)((function(t,r){let{className:n,children:i,debounceTime:a=300,ignoreDimensions:o=ame,parentSizeStyles:l,enableDebounceLeadingCall:c=!0,resizeObserverPolyfill:h}=t,d=s(t,sme);const f=(0,e.useRef)(null),p=(0,e.useRef)(0),[m,g]=(0,e.useState)({width:0,height:0,top:0,left:0}),v=(0,e.useMemo)((()=>{const e=Array.isArray(o)?o:[o];return nme((t=>{g((r=>Object.keys(r).filter((e=>r[e]!==t[e])).every((t=>e.includes(t)))?r:t))}),a,{leading:c})}),[a,c,o]);return(0,e.useEffect)((()=>{const e=new(h||window.ResizeObserver)((e=>{e.forEach((e=>{var t;const{left:r,top:n,width:i,height:s}=null!==(t=null==e?void 0:e.contentRect)&&void 0!==t?t:{};p.current=window.requestAnimationFrame((()=>{v({width:i,height:s,top:n,left:r})}))}))}));return f.current&&e.observe(f.current),()=>{window.cancelAnimationFrame(p.current),e.disconnect(),v.cancel()}}),[v,h]),(0,bt.jsx)("div",u(u({style:u(u({},ome),l),ref:ime([r,f]),className:n},d),{},{children:i(u(u({},m),{},{ref:f.current,resize:v}))}))})),cme=["scene","style","onSplineMouseDown","onSplineMouseUp","onSplineMouseHover","onSplineKeyDown","onSplineKeyUp","onSplineStart","onSplineLookAt","onSplineFollow","onSplineScroll","onLoad","renderOnDemand","children"],ume=((0,e.forwardRef)(((t,r)=>{let{scene:n,style:i,onSplineMouseDown:a,onSplineMouseUp:o,onSplineMouseHover:l,onSplineKeyDown:c,onSplineKeyUp:h,onSplineStart:d,onSplineLookAt:f,onSplineFollow:p,onSplineScroll:m,onLoad:g,renderOnDemand:v=!0,children:y}=t,b=s(t,cme);const w=(0,e.useRef)(null),[x,S]=(0,e.useState)(!0),[_,C]=(0,e.useState)();if(_)throw _;return(0,e.useEffect)((()=>{let e;S(!0);const t=[{name:"mouseDown",cb:a},{name:"mouseUp",cb:o},{name:"mouseHover",cb:l},{name:"keyDown",cb:c},{name:"keyUp",cb:h},{name:"start",cb:d},{name:"lookAt",cb:f},{name:"follow",cb:p},{name:"scroll",cb:m}];if(w.current){async function r(){await e.load(n);for(let r of t)r.cb&&e.addEventListener(r.name,r.cb);S(!1),null==g||g(e)}e=new rme(w.current,{renderOnDemand:v}),r().catch((e=>{C(e)}))}return()=>{for(let r of t)r.cb&&e.removeEventListener(r.name,r.cb);e.dispose()}}),[n]),(0,bt.jsx)(lme,u(u({ref:r,parentSizeStyles:u({overflow:"hidden"},i),debounceTime:50},b),{},{children:()=>(0,bt.jsxs)(bt.Fragment,{children:[x&&y,(0,bt.jsx)("canvas",{ref:w,style:{display:x?"none":"block"}})]})}))})),()=>(0,bt.jsx)("div",{style:{height:"100vh"},children:(0,bt.jsx)("iframe",{src:"https://my.spline.design/3dtextcopy-b903c7dc213d1f5253767dda568a9192/",frameborder:"0",width:"100%",height:"100%"})})),hme=()=>{const{register:e,handleSubmit:t,formState:{errors:r}}=y_();return(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{children:"Settings"}),(0,bt.jsxs)("form",{onSubmit:t((e=>console.log(e))),children:[(0,bt.jsx)("input",u({},e("name",{required:"\u0130sim gerekli!"}))),r.name&&(0,bt.jsx)("p",{children:r.name.message}),(0,bt.jsx)("input",u({type:"email"},e("email",{required:"Email gerekli!"}))),r.email&&(0,bt.jsx)("p",{children:r.email.message}),(0,bt.jsx)("button",{type:"submit",children:"G\xf6nder"})]})]})},dme=(0,e.createContext)(),fme=t=>{let{children:r}=t;const[n,i]=(0,e.useState)("true"===localStorage.getItem("isAuthenticated")),[s,a]=(0,e.useState)(""),o=he();(0,e.useEffect)((()=>{(async()=>{try{var e;const t=(await KR(aR(ZR,"Password"))).docs.map((e=>u({id:e.id},e.data())));a((null===(e=t[0])||void 0===e?void 0:e.password)||"")}catch(t){console.error("Error fetching data: ",t)}})()}),[]);return(0,bt.jsx)(dme.Provider,{value:{isAuthenticated:n,login:(e,t)=>{e===s?(i(!0),localStorage.setItem("isAuthenticated","true"),o("/Yeni-Proje")):t()},logout:()=>{i(!1),localStorage.removeItem("isAuthenticated")}},children:r})};const pme=r.p+"static/media/undraw_data-trends_kv5v.d1803933f2956749a3d2f5a402b14d1c.svg",mme=()=>{const{login:t}=(0,e.useContext)(dme),[r,n]=(he(),(0,e.useState)("")),i=()=>gC.error("\u015eifre Hatal\u0131",{position:"top-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored",transition:CC});return(0,bt.jsxs)(La,{sx:{height:"100vh",display:"flex",alignItems:"center",gap:"20px",justifyContent:"center",flexDirection:"row",backgroundImage:"url(".concat(tL,")"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[(0,bt.jsx)(AC,{position:"top-center",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!1,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"colored",transition:CC}),(0,bt.jsxs)(La,{sx:{backgroundColor:"#ffffff",width:"70%",height:"80%",boxShadow:"rgba(0, 0, 0, 0.24) 0px 3px 8px",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"row",gap:"10px",padding:"10px",borderRadius:"20px"},children:[(0,bt.jsxs)(La,{sx:{width:"50%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"20px"},children:[(0,bt.jsx)("a",{href:"http://www.kabinari.com/",target:"_blank",children:(0,bt.jsx)("img",{style:{width:"200px"},src:hx,alt:"Kabinari",srcset:""})}),(0,bt.jsx)(Uh,{size:"small",value:r,onChange:e=>(e=>{n(e)})(e.target.value),inputProps:{autoComplete:"off"},label:"Password",type:"password"}),(0,bt.jsx)(Rg,{onClick:()=>{t(r,i)},variant:"contained",children:"Login"})]}),(0,bt.jsx)(La,{sx:{backgroundColor:"#5555e5",backgroundColor:"#5555e57d",width:"50%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",borderRadius:"25px"},children:(0,bt.jsx)("img",{src:pme,alt:"asd"})})]})]})},gme=Ah((0,bt.jsx)("path",{d:"M14.59 8 12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"HighlightOff");var vme=r(917);const yme=e=>{let{data:t,fetchData:r}=e;const n={width:"25%"},i=he(),s={title:"Dikkat",message:"\u0130\u015f Numaras\u0131 ".concat(t.isNumaras\u0131," olan projeyi veri taban\u0131ndan silmek istedi\u011finizden emin misiniz?"),buttons:[{label:"Evet",onClick:()=>{a(t.id),r()}},{label:"Hay\u0131r"}],closeOnEscape:!0,closeOnClickOutside:!0,keyCodeForClose:[8,32],willUnmount:()=>{},afterClose:()=>{},onClickOutside:()=>{},onKeypress:()=>{},onKeypressEscape:()=>{},overlayClassName:"overlay-custom-class-name"},a=async e=>{try{const t=oR(ZR,"Veriler",e);await function(e){return QR($O(e.firestore,cR),[new nk(e._key,WP.none())])}(t)}catch(t){console.error("Error deleting order: ",t)}};return(0,bt.jsxs)(La,{sx:{backgroundColor:"#DDDCDA",width:"80%",padding:"30px",borderRadius:"10px",borderLeft:"20px solid #1C3960","&:hover":{borderLeft:"30px solid #1C3960",cursor:"pointer"},transition:"border-left 0.2s ease-in-out",display:"flex",gap:"10px",flexDirection:"row",alignItems:"center",justifyContent:"space-between",boxShadow:" rgba(0, 0, 0, 0.24) 0px 3px 8px"},onClick:()=>i("/Proje/".concat(t.id),{state:{data:t}}),children:[(0,bt.jsxs)(La,{sx:n,children:[(0,bt.jsx)(go,{children:"M\xfc\u015fteri \u0130smi"}),(0,bt.jsx)(go,{sx:{overflowWrap:"break-word",maxWidth:"100%"},children:""==t.musteriIsmi.trim()?"Project":t.musteriIsmi})]}),(0,bt.jsxs)(La,{sx:n,children:[(0,bt.jsx)(go,{children:"\u0130\u015f Numaras\u0131"}),(0,bt.jsx)(go,{children:""==t.isNumaras\u0131.trim()?"00000":t.isNumaras\u0131})]}),(0,bt.jsxs)(La,{sx:n,children:[(0,bt.jsx)(go,{children:"Olu\u015fturma Tarihi"}),(0,bt.jsx)(go,{children:t.olusturmaTarihi})]}),(0,bt.jsx)(La,{sx:u(u({},n),{},{display:"flex",justifyContent:"flex-end"}),children:(0,bt.jsx)(gme,{sx:{fontSize:32,color:"#1C3960",":hover":{color:"#E41C3C",zIndex:9999}},onClick:e=>{e.stopPropagation(),(0,vme.ZX)(s)}})})]})},bme=()=>{const[t,r]=e.useState(!1),n=e=>()=>{r(e)},[i,s]=(0,e.useState)([]),a=async()=>{try{const e=(await KR(aR(ZR,"Veriler"))).docs.map((e=>u({id:e.id},e.data())));s(e),console.log(e),console.log(i)}catch(e){console.error("Error fetching data: ",e)}};return(0,e.useEffect)((()=>{a()}),[]),(0,bt.jsxs)(La,{sx:{bgcolor:"#DEDDDB",height:"100vh"},children:[(0,bt.jsx)(Ex,{toggleDrawer:n}),(0,bt.jsx)(dx,{open:t,toggleDrawer:n}),(0,bt.jsx)(La,{sx:{bgcolor:"#DEDDDB",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,bt.jsx)(La,{sx:{bgcolor:"#FFFFFF",borderRadius:"20px",margin:"20px",marginY:"50px",boxShadow:"rgba(50, 50, 93, 0.25) 0px 30px 60px -12px, rgba(0, 0, 0, 0.3) 0px 18px 36px -18px",minHeight:"20vh",width:"70%",padding:"20px",paddingY:"50px",display:"flex",gap:"10px",flexDirection:"column",alignItems:"center"},children:i.length>0?i.map((e=>(0,bt.jsx)(yme,{data:e,fetchData:a},e.id))):(0,bt.jsx)(go,{color:"#1C3960",children:"Y\xfckleniyor..."})})})]})},wme=["element"],xme=t=>{let{element:r}=t,n=s(t,wme);const{isAuthenticated:i}=(0,e.useContext)(dme);return i?(0,bt.jsx)(r,u({},n)):(0,bt.jsx)(Ae,{to:"/"})},Sme=()=>{const t=le(),{data:r}=t.state||{};console.log(r);const{id:n}=function(){let{matches:t}=e.useContext(se),r=t[t.length-1];return r?r.params:{}}(),[i,s]=e.useState(!1),a=e=>()=>{s(e)};return(0,bt.jsxs)(La,{sx:{bgcolor:"#DEDDDB",height:"100vh"},children:[(0,bt.jsx)(Ex,{toggleDrawer:a}),(0,bt.jsx)(dx,{open:i,toggleDrawer:a}),(0,bt.jsxs)(La,{sx:{bgcolor:"#FFFFFF",borderRadius:"20px",margin:"20px",marginY:"30px",boxShadow:"rgba(50, 50, 93, 0.25) 0px 30px 60px -12px, rgba(0, 0, 0, 0.3) 0px 18px 36px -18px",minHeight:"60vh",padding:"20px",display:"flex",flexDirection:"column"},children:[(0,bt.jsxs)(La,{sx:{display:"flex",alignItems:"center",flexDirection:"row",margin:"30px",justifyContent:"space-between"},children:[(0,bt.jsxs)(La,{sx:{display:"flex",flexDirection:"row"},children:[(0,bt.jsx)(Kh,{sx:{fontSize:"36px",color:"#A19D95"}}),(0,bt.jsx)(go,{color:"#A19D95",fontSize:24,display:"flex",alignItems:"center",marginX:"10px",children:"M\xfc\u015fteri \u0130smi"})]}),(0,bt.jsx)(Uh,{sx:{width:"60%"},id:"outlined-basic",variant:"outlined",size:"small",inputProps:{autoComplete:"off"},disabled:!0,value:r.musteriIsmi}),(0,bt.jsx)(La,{height:"50px",width:"95px"})]}),(0,bt.jsx)(Yh,{sx:{borderBottomWidth:3,backgroundColor:"#DEDDDB"}}),(0,bt.jsxs)(La,{sx:{display:"flex",flexDirection:"row",marginX:"30px",marginTop:"20px",justifyContent:"space-between"},children:[(0,bt.jsxs)(La,{sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,bt.jsx)(Qh,{sx:{fontSize:"36px",color:"#A19D95"}}),(0,bt.jsx)(go,{color:"#A19D95",fontSize:24,display:"flex",alignItems:"center",marginX:"10px",children:"\u0130\u015f Numaras\u0131"})]}),(0,bt.jsx)(Uh,{sx:{width:"60%"},id:"outlined-basic",variant:"outlined",size:"small",inputProps:{autoComplete:"off"},disabled:!0,value:r.isNumaras\u0131}),(0,bt.jsx)(La,{height:"50px",width:"95px"})]}),(0,bt.jsxs)(La,{sx:{display:"flex",flexDirection:"row",margin:"30px",justifyContent:"space-between"},children:[(0,bt.jsxs)(La,{sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,bt.jsx)(Zh,{sx:{fontSize:"36px",color:"#A19D95"}}),(0,bt.jsx)(go,{color:"#A19D95",fontSize:24,display:"flex",alignItems:"center",marginX:"10px",children:"Olu\u015fturma Tarihi"})]}),(0,bt.jsx)(Uh,{sx:{width:"60%"},id:"outlined-basic",variant:"outlined",size:"small",inputProps:{autoComplete:"off"},disabled:!0,value:r.olusturmaTarihi}),(0,bt.jsx)(La,{height:"50px",width:"140px"})]}),(0,bt.jsx)(Yh,{sx:{borderBottomWidth:3,backgroundColor:"#DEDDDB"}}),(0,bt.jsx)(eL,{"m\xfcsteriIsmi":r.musteriIsmi,data:r.data,olusturmaTarihi:r.olusturmaTarihi,"isNumaras\u0131":r.isNumaras\u0131,databaseId:r.id})]})]})};const _me=function(){return(0,bt.jsxs)(ct,{children:[" ",(0,bt.jsx)(fme,{children:(0,bt.jsxs)(Pe,{children:[(0,bt.jsx)(Me,{path:"/",element:(0,bt.jsx)(mme,{})}),(0,bt.jsx)(Me,{path:"/Yeni-Proje",element:(0,bt.jsx)(xme,{element:rL})}),(0,bt.jsx)(Me,{path:"/T\xfcm-Projeler",element:(0,bt.jsx)(xme,{element:bme})}),(0,bt.jsx)(Me,{path:"/Proje/:id",element:(0,bt.jsx)(Sme,{})}),(0,bt.jsx)(Me,{path:"/settings",element:(0,bt.jsx)(xme,{element:hme})}),(0,bt.jsx)(Me,{path:"/firebase",element:(0,bt.jsx)(xme,{element:nL})}),(0,bt.jsx)(Me,{path:"*",element:(0,bt.jsx)(ume,{})})]})})]})};n.createRoot(document.getElementById("root")).render((0,bt.jsx)(_me,{}))})()})();
//# sourceMappingURL=main.8aaba493.js.map